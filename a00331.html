<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.5"/>
<title>HyPar: src/ImmersedBoundaries/IBCreateFacetMapping.c File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script><script src="http://cdn.mathjax.org/mathjax/latest/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="doxygen_html_style.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">HyPar
   &#160;<span id="projectnumber">1.0</span>
   </div>
   <div id="projectbrief">Finite-Difference Hyperbolic-Parabolic PDE Solver on Cartesian Grids</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.5 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Structures</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>Globals</span></a></li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('a00331.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Data Structures</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Namespaces</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(9)"><span class="SelectionMark">&#160;</span>Macros</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(10)"><span class="SelectionMark">&#160;</span>Pages</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">IBCreateFacetMapping.c File Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>Create facet mapping.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &lt;stdlib.h&gt;</code><br/>
<code>#include &lt;string.h&gt;</code><br/>
<code>#include &lt;<a class="el" href="a00231_source.html">arrayfunctions.h</a>&gt;</code><br/>
<code>#include &lt;<a class="el" href="a00246_source.html">mathfunctions.h</a>&gt;</code><br/>
<code>#include &lt;<a class="el" href="a00191_source.html">immersedboundaries.h</a>&gt;</code><br/>
<code>#include &lt;<a class="el" href="a00250_source.html">mpivars.h</a>&gt;</code><br/>
</div>
<p><a href="a00331_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:ae5fc4cce9be29ebb8c3d80c534e55720"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00331.html#ae5fc4cce9be29ebb8c3d80c534e55720">isInside</a> (double x, double a, double b)</td></tr>
<tr class="separator:ae5fc4cce9be29ebb8c3d80c534e55720"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac8dd87df944e8659dedfa3171e832f44"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00331.html#ac8dd87df944e8659dedfa3171e832f44">interpNodesCoeffs</a> (void *m, double xc, double yc, double zc, double *x, double *y, double *z, int *dim, int ghosts, char *mode, int *ii, int *jj, int *kk, int *inodes, double *icoeffs)</td></tr>
<tr class="separator:ac8dd87df944e8659dedfa3171e832f44"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1eaa51b960b4fae56b2283983c7d9cf9"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00331.html#a1eaa51b960b4fae56b2283983c7d9cf9">IBCreateFacetMapping</a> (void *ib, void *m, double *X, int *dim, int ghosts)</td></tr>
<tr class="separator:a1eaa51b960b4fae56b2283983c7d9cf9"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Create facet mapping. </p>
<dl class="section author"><dt>Author</dt><dd>Debojyoti Ghosh </dd></dl>

<p>Definition in file <a class="el" href="a00331_source.html">IBCreateFacetMapping.c</a>.</p>
</div><h2 class="groupheader">Function Documentation</h2>
<a class="anchor" id="ae5fc4cce9be29ebb8c3d80c534e55720"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int isInside </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>a</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>b</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>is x inside the interval [a,b]? </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">x</td><td>the value to check for </td></tr>
    <tr><td class="paramname">a</td><td>small end of the interval </td></tr>
    <tr><td class="paramname">b</td><td>big end of the interval </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="a00331_source.html#l00014">14</a> of file <a class="el" href="a00331_source.html">IBCreateFacetMapping.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;{</div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;  <span class="keywordflow">return</span> ((x &gt;= a) &amp;&amp; (x &lt;= b));</div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ac8dd87df944e8659dedfa3171e832f44"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int interpNodesCoeffs </td>
          <td>(</td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>m</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>xc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>yc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>zc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>y</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>z</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>dim</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>ghosts</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>mode</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>ii</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>jj</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>kk</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>inodes</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>icoeffs</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Given a point in the 3D space (xc, yc, zc), this function finds the indices of the 8 grid points that define the grid cell the given point is in, as well as the trilinear interpolation coefficients for each of the surrounding grid points. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">m</td><td>MPI object of type <a class="el" href="a00207.html#a00674" title="Structure of MPI-related variables. ">MPIVariables</a> </td></tr>
    <tr><td class="paramname">xc</td><td>x-coordinate of the point </td></tr>
    <tr><td class="paramname">yc</td><td>y-coordinate of the point </td></tr>
    <tr><td class="paramname">zc</td><td>z-coordinate of the point </td></tr>
    <tr><td class="paramname">x</td><td>array of x-coordinates of the grid </td></tr>
    <tr><td class="paramname">y</td><td>array of y-coordinates of the grid </td></tr>
    <tr><td class="paramname">z</td><td>array of z-coordinates of the grid </td></tr>
    <tr><td class="paramname">dim</td><td>local dimensions of the grid </td></tr>
    <tr><td class="paramname">ghosts</td><td>number of ghost points </td></tr>
    <tr><td class="paramname">mode</td><td>"mode", i.e., <a class="el" href="a00191.html#a935394e510d17282c5697cd76a6e2667">ImmersedBoundary::mode</a> </td></tr>
    <tr><td class="paramname">ii</td><td>i-index of the surrounding node at the high end (i.e. smallest i such that x[i] &gt; xc) </td></tr>
    <tr><td class="paramname">jj</td><td>j-index of the surrounding node at the high end (i.e. smallest j such that y[j] &gt; yc) </td></tr>
    <tr><td class="paramname">kk</td><td>k-index of the surrounding node at the high end (i.e. smallest k such that z[k] &gt; zc) </td></tr>
    <tr><td class="paramname">inodes</td><td>array to store the indices of the surrounding nodes </td></tr>
    <tr><td class="paramname">icoeffs</td><td>array to store the interpolation coefficients of the surrounding nodes </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="a00331_source.html#l00028">28</a> of file <a class="el" href="a00331_source.html">IBCreateFacetMapping.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;{</div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;  <a class="code" href="a00207.html#a00674">MPIVariables</a> *mpi = (<a class="code" href="a00207.html#a00674">MPIVariables</a>*) m;</div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;</div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;  <span class="keywordtype">int</span> i, j, k, ic, jc, kc;</div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;  ic = jc = kc = -1;</div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;  </div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;  <span class="keywordtype">double</span>  xmin = 0.5 * (x[ghosts-1]         + x[ghosts]),</div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;          xmax = 0.5 * (x[dim[0]+ghosts-1]  + x[dim[0]+ghosts]),</div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;          ymin = 0.5 * (y[ghosts-1]         + y[ghosts]),</div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;          ymax = 0.5 * (y[dim[1]+ghosts-1]  + y[dim[1]+ghosts]),</div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;          zmin = 0.5 * (z[ghosts-1]         + z[ghosts]),</div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;          zmax = 0.5 * (z[dim[2]+ghosts-1]  + z[dim[2]+ghosts]);</div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;</div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;  <span class="keywordflow">for</span> (i = 0; i &lt; dim[0]+2*ghosts-1; i++) {</div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="a00331.html#ae5fc4cce9be29ebb8c3d80c534e55720">isInside</a>(xc,x[i],x[i+1])) {</div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;      ic = i;</div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;      <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;    }</div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;  }</div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;  <span class="keywordflow">if</span>      (ic &lt;= ghosts-1)        ic = ghosts;</div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (ic &gt;= dim[0]+ghosts-1) ic = dim[0]+ghosts-2;</div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;  </div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;  <span class="keywordflow">for</span> (j = 0; j &lt; dim[1]+2*ghosts-1; j++) {</div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="a00331.html#ae5fc4cce9be29ebb8c3d80c534e55720">isInside</a>(yc,y[j],y[j+1])) {</div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;      jc = j;</div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;      <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;    }</div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;  }</div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;  <span class="keywordflow">if</span>      (jc &lt;= ghosts-1)        jc = ghosts;</div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (jc &gt;= dim[1]+ghosts-1) jc = dim[1]+ghosts-2;</div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;</div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;  <span class="keywordflow">for</span> (k = 0; k &lt; dim[2]+2*ghosts-1; k++) {</div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="a00331.html#ae5fc4cce9be29ebb8c3d80c534e55720">isInside</a>(zc,z[k],z[k+1])) {</div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;      kc = k;</div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;      <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;    }</div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;  }</div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;  <span class="keywordflow">if</span>      (kc &lt;= ghosts-1)        kc = ghosts;</div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (kc &gt;= dim[2]+ghosts-1) kc = dim[2]+ghosts-2;</div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;  </div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;  <span class="keywordflow">if</span>      (!strcmp(mode,<a class="code" href="a00191.html#a6f872a36881067ae3dbd5a14042cb2d6">_IB_XY_</a>))  { kc = ghosts; zc = 0.5*(zmin+zmax); }</div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcmp(mode,<a class="code" href="a00191.html#a948cb38cc6d11f9f4c9030994e9a3367">_IB_XZ_</a>))  { jc = ghosts; yc = 0.5*(ymin+ymax); }</div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcmp(mode,<a class="code" href="a00191.html#aa2d4d0cc81beab5f62c5527941655474">_IB_YZ_</a>))  { ic = ghosts; xc = 0.5*(xmin+xmax); }</div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;  </div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;  <span class="keywordflow">if</span> (ic == -1) {</div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;    fprintf(stderr,<span class="stringliteral">&quot;Error in interpNodesCoeffs() (in ImmersedBoundaries/IBCreateFacetMapping.c) on rank %d: ic = -1.\n&quot;</span>, mpi-&gt;<a class="code" href="a00207.html#a6cfd95afd0afebd625b889fb6e58371c">rank</a>);</div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;    <span class="keywordflow">return</span>(1);</div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;  }</div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;  <span class="keywordflow">if</span> (jc == -1) {</div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;    fprintf(stderr,<span class="stringliteral">&quot;Error in interpNodesCoeffs() (in ImmersedBoundaries/IBCreateFacetMapping.c) on rank %d: jc = -1.\n&quot;</span>, mpi-&gt;<a class="code" href="a00207.html#a6cfd95afd0afebd625b889fb6e58371c">rank</a>);</div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;    <span class="keywordflow">return</span>(1);</div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;  }</div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;  <span class="keywordflow">if</span> (kc == -1) {</div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;    fprintf(stderr,<span class="stringliteral">&quot;Error in interpNodesCoeffs() (in ImmersedBoundaries/IBCreateFacetMapping.c) on rank %d: kc = -1.\n&quot;</span>, mpi-&gt;<a class="code" href="a00207.html#a6cfd95afd0afebd625b889fb6e58371c">rank</a>);</div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;    <span class="keywordflow">return</span>(1);</div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;  }</div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;  ic++;</div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;  jc++;</div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;  kc++;</div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;</div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;  <span class="keywordflow">if</span> (ii) *ii = ic;</div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;  <span class="keywordflow">if</span> (jj) *jj = jc;</div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;  <span class="keywordflow">if</span> (kk) *kk = kc;</div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;  </div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;  <span class="keywordtype">int</span> pc[<a class="code" href="a00191.html#a9e114382f922a879776df13fd2f414a5">_IB_NNODES_</a>], index[<a class="code" href="a00191.html#a0f59ba2c552bae2f35a03ce3964a2b4a">_IB_NDIMS_</a>];</div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;  index[0]=ic-1-ghosts; index[1]=jc-1-ghosts; index[2]=kc-1-ghosts; <a class="code" href="a00231.html#afbb862a2fdf5b72b1f9ace42f64b556f">_ArrayIndex1D_</a>(<a class="code" href="a00191.html#a0f59ba2c552bae2f35a03ce3964a2b4a">_IB_NDIMS_</a>,dim,index,ghosts,pc[0]);</div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;  index[0]=ic-ghosts  ; index[1]=jc-1-ghosts; index[2]=kc-1-ghosts; <a class="code" href="a00231.html#afbb862a2fdf5b72b1f9ace42f64b556f">_ArrayIndex1D_</a>(<a class="code" href="a00191.html#a0f59ba2c552bae2f35a03ce3964a2b4a">_IB_NDIMS_</a>,dim,index,ghosts,pc[1]);</div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;  index[0]=ic-1-ghosts; index[1]=jc-ghosts  ; index[2]=kc-1-ghosts; <a class="code" href="a00231.html#afbb862a2fdf5b72b1f9ace42f64b556f">_ArrayIndex1D_</a>(<a class="code" href="a00191.html#a0f59ba2c552bae2f35a03ce3964a2b4a">_IB_NDIMS_</a>,dim,index,ghosts,pc[2]);</div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;  index[0]=ic-ghosts  ; index[1]=jc-ghosts  ; index[2]=kc-1-ghosts; <a class="code" href="a00231.html#afbb862a2fdf5b72b1f9ace42f64b556f">_ArrayIndex1D_</a>(<a class="code" href="a00191.html#a0f59ba2c552bae2f35a03ce3964a2b4a">_IB_NDIMS_</a>,dim,index,ghosts,pc[3]);</div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;  index[0]=ic-1-ghosts; index[1]=jc-1-ghosts; index[2]=kc-ghosts  ; <a class="code" href="a00231.html#afbb862a2fdf5b72b1f9ace42f64b556f">_ArrayIndex1D_</a>(<a class="code" href="a00191.html#a0f59ba2c552bae2f35a03ce3964a2b4a">_IB_NDIMS_</a>,dim,index,ghosts,pc[4]);</div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;  index[0]=ic-ghosts  ; index[1]=jc-1-ghosts; index[2]=kc-ghosts  ; <a class="code" href="a00231.html#afbb862a2fdf5b72b1f9ace42f64b556f">_ArrayIndex1D_</a>(<a class="code" href="a00191.html#a0f59ba2c552bae2f35a03ce3964a2b4a">_IB_NDIMS_</a>,dim,index,ghosts,pc[5]);</div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;  index[0]=ic-1-ghosts; index[1]=jc-ghosts  ; index[2]=kc-ghosts  ; <a class="code" href="a00231.html#afbb862a2fdf5b72b1f9ace42f64b556f">_ArrayIndex1D_</a>(<a class="code" href="a00191.html#a0f59ba2c552bae2f35a03ce3964a2b4a">_IB_NDIMS_</a>,dim,index,ghosts,pc[6]);</div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;  index[0]=ic-ghosts  ; index[1]=jc-ghosts  ; index[2]=kc-ghosts  ; <a class="code" href="a00231.html#afbb862a2fdf5b72b1f9ace42f64b556f">_ArrayIndex1D_</a>(<a class="code" href="a00191.html#a0f59ba2c552bae2f35a03ce3964a2b4a">_IB_NDIMS_</a>,dim,index,ghosts,pc[7]);</div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;  <a class="code" href="a00231.html#a89e8330d9e06dd0666c50833628a125c">_ArrayCopy1D_</a>(pc,inodes,<a class="code" href="a00191.html#a9e114382f922a879776df13fd2f414a5">_IB_NNODES_</a>);</div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;  </div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;  <span class="keywordtype">double</span> coeffs[<a class="code" href="a00191.html#a9e114382f922a879776df13fd2f414a5">_IB_NNODES_</a>];</div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;  <a class="code" href="a00246.html#a04d4e04f1f9112958dca24fc68c1818a">TrilinearInterpCoeffs</a>(x[ic-1],x[ic],y[jc-1],y[jc],z[kc-1],z[kc],xc,yc,zc,&amp;coeffs[0]);</div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;  <a class="code" href="a00231.html#a89e8330d9e06dd0666c50833628a125c">_ArrayCopy1D_</a>(coeffs,icoeffs,<a class="code" href="a00191.html#a9e114382f922a879776df13fd2f414a5">_IB_NNODES_</a>);</div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;</div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;  <span class="keywordflow">return</span>(0);</div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;}</div>
<div class="ttc" id="a00331_html_ae5fc4cce9be29ebb8c3d80c534e55720"><div class="ttname"><a href="a00331.html#ae5fc4cce9be29ebb8c3d80c534e55720">isInside</a></div><div class="ttdeci">static int isInside(double x, double a, double b)</div><div class="ttdef"><b>Definition:</b> <a href="a00331_source.html#l00014">IBCreateFacetMapping.c:14</a></div></div>
<div class="ttc" id="a00191_html_aa2d4d0cc81beab5f62c5527941655474"><div class="ttname"><a href="a00191.html#aa2d4d0cc81beab5f62c5527941655474">_IB_YZ_</a></div><div class="ttdeci">#define _IB_YZ_</div><div class="ttdef"><b>Definition:</b> <a href="a00191_source.html#l00020">immersedboundaries.h:20</a></div></div>
<div class="ttc" id="a00191_html_a0f59ba2c552bae2f35a03ce3964a2b4a"><div class="ttname"><a href="a00191.html#a0f59ba2c552bae2f35a03ce3964a2b4a">_IB_NDIMS_</a></div><div class="ttdeci">#define _IB_NDIMS_</div><div class="ttdef"><b>Definition:</b> <a href="a00191_source.html#l00010">immersedboundaries.h:10</a></div></div>
<div class="ttc" id="a00231_html_afbb862a2fdf5b72b1f9ace42f64b556f"><div class="ttname"><a href="a00231.html#afbb862a2fdf5b72b1f9ace42f64b556f">_ArrayIndex1D_</a></div><div class="ttdeci">#define _ArrayIndex1D_(N, imax, i, ghost, index)</div><div class="ttdef"><b>Definition:</b> <a href="a00231_source.html#l00040">arrayfunctions.h:40</a></div></div>
<div class="ttc" id="a00246_html_a04d4e04f1f9112958dca24fc68c1818a"><div class="ttname"><a href="a00246.html#a04d4e04f1f9112958dca24fc68c1818a">TrilinearInterpCoeffs</a></div><div class="ttdeci">void TrilinearInterpCoeffs(double, double, double, double, double, double, double, double, double, double *)</div><div class="ttdef"><b>Definition:</b> <a href="a00384_source.html#l00022">TrilinearInterpolation.c:22</a></div></div>
<div class="ttc" id="a00191_html_a948cb38cc6d11f9f4c9030994e9a3367"><div class="ttname"><a href="a00191.html#a948cb38cc6d11f9f4c9030994e9a3367">_IB_XZ_</a></div><div class="ttdeci">#define _IB_XZ_</div><div class="ttdef"><b>Definition:</b> <a href="a00191_source.html#l00018">immersedboundaries.h:18</a></div></div>
<div class="ttc" id="a00231_html_a89e8330d9e06dd0666c50833628a125c"><div class="ttname"><a href="a00231.html#a89e8330d9e06dd0666c50833628a125c">_ArrayCopy1D_</a></div><div class="ttdeci">#define _ArrayCopy1D_(x, y, size)</div><div class="ttdef"><b>Definition:</b> <a href="a00231_source.html#l00319">arrayfunctions.h:319</a></div></div>
<div class="ttc" id="a00207_html_a00674"><div class="ttname"><a href="a00207.html#a00674">MPIVariables</a></div><div class="ttdoc">Structure of MPI-related variables. </div><div class="ttdef"><b>Definition:</b> <a href="a00207_source.html#l00024">mpivars_struct.h:24</a></div></div>
<div class="ttc" id="a00191_html_a6f872a36881067ae3dbd5a14042cb2d6"><div class="ttname"><a href="a00191.html#a6f872a36881067ae3dbd5a14042cb2d6">_IB_XY_</a></div><div class="ttdeci">#define _IB_XY_</div><div class="ttdef"><b>Definition:</b> <a href="a00191_source.html#l00016">immersedboundaries.h:16</a></div></div>
<div class="ttc" id="a00191_html_a9e114382f922a879776df13fd2f414a5"><div class="ttname"><a href="a00191.html#a9e114382f922a879776df13fd2f414a5">_IB_NNODES_</a></div><div class="ttdeci">#define _IB_NNODES_</div><div class="ttdef"><b>Definition:</b> <a href="a00191_source.html#l00013">immersedboundaries.h:13</a></div></div>
<div class="ttc" id="a00207_html_a6cfd95afd0afebd625b889fb6e58371c"><div class="ttname"><a href="a00207.html#a6cfd95afd0afebd625b889fb6e58371c">MPIVariables::rank</a></div><div class="ttdeci">int rank</div><div class="ttdef"><b>Definition:</b> <a href="a00207_source.html#l00025">mpivars_struct.h:25</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a1eaa51b960b4fae56b2283983c7d9cf9"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int IBCreateFacetMapping </td>
          <td>(</td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>ib</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>m</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>X</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>dim</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>ghosts</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>This function creates a "facet map", i.e., on each MPI rank, it does the following:</p>
<ul>
<li>Makes a list of facets (defining the immersed body surface) that lie within the local computational domain of this MPI rank ("local facets").</li>
<li>For each local facet, finds and stores the indices of the grid points that surround it, as well as the trilinear interpolation coefficients.</li>
<li>For each local facet, finds a "near-surface" point, i.e., a point near the surface ("near" in terms of the local grid spacing) along the outward surface normal (i.e., outside the body), and finds and stores the indices of the grid points that surround it, as well as the trilinear interpolation coefficients.</li>
</ul>
<p>Note: each MPI rank has a copy of the entire immersed body, i.e., all the facets. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ib</td><td>Immersed boundary object of type <a class="el" href="a00191.html#a00672" title="Structure containing variables for immersed boundary implementation. ">ImmersedBoundary</a> </td></tr>
    <tr><td class="paramname">m</td><td>MPI object of type <a class="el" href="a00207.html#a00674" title="Structure of MPI-related variables. ">MPIVariables</a> </td></tr>
    <tr><td class="paramname">X</td><td>Array of local spatial coordinates </td></tr>
    <tr><td class="paramname">dim</td><td>Local dimensions </td></tr>
    <tr><td class="paramname">ghosts</td><td>Number of ghost points </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="a00331_source.html#l00143">143</a> of file <a class="el" href="a00331_source.html">IBCreateFacetMapping.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;{</div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;  <a class="code" href="a00191.html#a00672">ImmersedBoundary</a>  *IB     = (<a class="code" href="a00191.html#a00672">ImmersedBoundary</a>*) ib;</div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;  <a class="code" href="a00207.html#a00674">MPIVariables</a>      *mpi    = (<a class="code" href="a00207.html#a00674">MPIVariables</a>*) m;</div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;  <a class="code" href="a00191.html#a00659">Body3D</a>            *body   = IB-&gt;<a class="code" href="a00191.html#af858f0e9bc4a6cb1c16ad2931cf4b43d">body</a>;</div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;  <span class="keywordtype">int</span>               nfacets = body-&gt;<a class="code" href="a00191.html#afd755b081f4d9ca3558ef9ca9f3c35d0">nfacets</a>, n, count, ierr;</div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;  <a class="code" href="a00191.html#a00664">Facet3D</a>           *facets = body-&gt;<a class="code" href="a00191.html#aa7bdafcc50881d7f0f4db707755698ce">surface</a>;</div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;</div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;  <span class="keywordtype">double</span>  *x = X, </div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;          *y = (x + dim[0] + 2*ghosts), </div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;          *z = (y + dim[1] + 2*ghosts);</div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;</div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;  <span class="keywordtype">double</span>  xmin = 0.5 * (x[ghosts-1]         + x[ghosts]),</div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;          xmax = 0.5 * (x[dim[0]+ghosts-1]  + x[dim[0]+ghosts]),</div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;          ymin = 0.5 * (y[ghosts-1]         + y[ghosts]),</div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;          ymax = 0.5 * (y[dim[1]+ghosts-1]  + y[dim[1]+ghosts]),</div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;          zmin = 0.5 * (z[ghosts-1]         + z[ghosts]),</div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;          zmax = 0.5 * (z[dim[2]+ghosts-1]  + z[dim[2]+ghosts]);</div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;</div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;  count = 0;</div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;  <span class="keywordflow">for</span> (n = 0; n &lt; nfacets; n++) {</div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;</div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;    <span class="comment">/* find facet centroid */</span></div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;    <span class="keywordtype">double</span> xc, yc, zc;</div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;    xc = (facets[n].<a class="code" href="a00191.html#ac75b803b570527306e1e744bfb7a604f">x1</a> + facets[n].<a class="code" href="a00191.html#adcf04f5f1964d18b332643939561da0d">x2</a> + facets[n].<a class="code" href="a00191.html#a98e99f64ddf7321e4eae52beca4b580f">x3</a>) / 3.0;</div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;    yc = (facets[n].<a class="code" href="a00191.html#ac3b72e5b77595ca2340ecf8ccfe5fd99">y1</a> + facets[n].<a class="code" href="a00191.html#a5347e514ebe985fb371754ffd2b5ff83">y2</a> + facets[n].<a class="code" href="a00191.html#a786634d3d364cf94d8eb600ce7136355">y3</a>) / 3.0;</div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;    zc = (facets[n].<a class="code" href="a00191.html#a0e1fe82df628138c8f3907ecddb514ae">z1</a> + facets[n].<a class="code" href="a00191.html#a822ab991099a420eb62b3f0e2b0021a2">z2</a> + facets[n].<a class="code" href="a00191.html#a270503fb34041aa050ec80858f7820a7">z3</a>) / 3.0;</div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;</div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;    <span class="keywordflow">if</span> (!strcmp(IB-&gt;<a class="code" href="a00191.html#a935394e510d17282c5697cd76a6e2667">mode</a>,<a class="code" href="a00191.html#a80bdbbd2624bd70748ffd44c11ffd1fb">_IB_3D_</a>)) {</div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="a00331.html#ae5fc4cce9be29ebb8c3d80c534e55720">isInside</a>(xc,xmin,xmax) &amp;&amp; <a class="code" href="a00331.html#ae5fc4cce9be29ebb8c3d80c534e55720">isInside</a>(yc,ymin,ymax) &amp;&amp; <a class="code" href="a00331.html#ae5fc4cce9be29ebb8c3d80c534e55720">isInside</a>(zc,zmin,zmax)) count++;</div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcmp(IB-&gt;<a class="code" href="a00191.html#a935394e510d17282c5697cd76a6e2667">mode</a>,<a class="code" href="a00191.html#a6f872a36881067ae3dbd5a14042cb2d6">_IB_XY_</a>)) {</div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="a00331.html#ae5fc4cce9be29ebb8c3d80c534e55720">isInside</a>(xc,xmin,xmax) &amp;&amp; <a class="code" href="a00331.html#ae5fc4cce9be29ebb8c3d80c534e55720">isInside</a>(yc,ymin,ymax)) count++;</div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcmp(IB-&gt;<a class="code" href="a00191.html#a935394e510d17282c5697cd76a6e2667">mode</a>,<a class="code" href="a00191.html#a948cb38cc6d11f9f4c9030994e9a3367">_IB_XZ_</a>)) {</div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="a00331.html#ae5fc4cce9be29ebb8c3d80c534e55720">isInside</a>(xc,xmin,xmax) &amp;&amp; <a class="code" href="a00331.html#ae5fc4cce9be29ebb8c3d80c534e55720">isInside</a>(zc,zmin,zmax)) count++;</div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcmp(IB-&gt;<a class="code" href="a00191.html#a935394e510d17282c5697cd76a6e2667">mode</a>,<a class="code" href="a00191.html#aa2d4d0cc81beab5f62c5527941655474">_IB_YZ_</a>)) {</div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="a00331.html#ae5fc4cce9be29ebb8c3d80c534e55720">isInside</a>(yc,ymin,ymax) &amp;&amp; <a class="code" href="a00331.html#ae5fc4cce9be29ebb8c3d80c534e55720">isInside</a>(zc,zmin,zmax)) count++;</div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;    }</div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;  }</div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;</div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;  <span class="keywordtype">int</span> nfacets_local = count;</div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;  <span class="keywordflow">if</span> (nfacets_local &gt; 0) {</div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;</div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;    <a class="code" href="a00191.html#a00665">FacetMap</a> *fmap = (<a class="code" href="a00191.html#a00665">FacetMap</a>*) calloc (nfacets_local, <span class="keyword">sizeof</span>(<a class="code" href="a00191.html#a00665">FacetMap</a>));</div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;    count = 0;</div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;</div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;    <span class="keywordflow">for</span> (n = 0; n &lt; nfacets; n++) {</div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;</div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;      <span class="keywordtype">double</span> xc, yc, zc;</div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;      xc = (facets[n].<a class="code" href="a00191.html#ac75b803b570527306e1e744bfb7a604f">x1</a> + facets[n].<a class="code" href="a00191.html#adcf04f5f1964d18b332643939561da0d">x2</a> + facets[n].<a class="code" href="a00191.html#a98e99f64ddf7321e4eae52beca4b580f">x3</a>) / 3.0;</div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;      yc = (facets[n].<a class="code" href="a00191.html#ac3b72e5b77595ca2340ecf8ccfe5fd99">y1</a> + facets[n].<a class="code" href="a00191.html#a5347e514ebe985fb371754ffd2b5ff83">y2</a> + facets[n].<a class="code" href="a00191.html#a786634d3d364cf94d8eb600ce7136355">y3</a>) / 3.0;</div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;      zc = (facets[n].<a class="code" href="a00191.html#a0e1fe82df628138c8f3907ecddb514ae">z1</a> + facets[n].<a class="code" href="a00191.html#a822ab991099a420eb62b3f0e2b0021a2">z2</a> + facets[n].<a class="code" href="a00191.html#a270503fb34041aa050ec80858f7820a7">z3</a>) / 3.0;</div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;</div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;      <span class="keywordtype">int</span> flag = 0;</div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;      <span class="keywordflow">if</span> (!strcmp(IB-&gt;<a class="code" href="a00191.html#a935394e510d17282c5697cd76a6e2667">mode</a>,<a class="code" href="a00191.html#a80bdbbd2624bd70748ffd44c11ffd1fb">_IB_3D_</a>)) {</div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="a00331.html#ae5fc4cce9be29ebb8c3d80c534e55720">isInside</a>(xc,xmin,xmax) &amp;&amp; <a class="code" href="a00331.html#ae5fc4cce9be29ebb8c3d80c534e55720">isInside</a>(yc,ymin,ymax) &amp;&amp; <a class="code" href="a00331.html#ae5fc4cce9be29ebb8c3d80c534e55720">isInside</a>(zc,zmin,zmax)) flag = 1;</div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;      } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcmp(IB-&gt;<a class="code" href="a00191.html#a935394e510d17282c5697cd76a6e2667">mode</a>,<a class="code" href="a00191.html#a6f872a36881067ae3dbd5a14042cb2d6">_IB_XY_</a>)) {</div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="a00331.html#ae5fc4cce9be29ebb8c3d80c534e55720">isInside</a>(xc,xmin,xmax) &amp;&amp; <a class="code" href="a00331.html#ae5fc4cce9be29ebb8c3d80c534e55720">isInside</a>(yc,ymin,ymax)) flag = 1;</div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;      } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcmp(IB-&gt;<a class="code" href="a00191.html#a935394e510d17282c5697cd76a6e2667">mode</a>,<a class="code" href="a00191.html#a948cb38cc6d11f9f4c9030994e9a3367">_IB_XZ_</a>)) {</div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="a00331.html#ae5fc4cce9be29ebb8c3d80c534e55720">isInside</a>(xc,xmin,xmax) &amp;&amp; <a class="code" href="a00331.html#ae5fc4cce9be29ebb8c3d80c534e55720">isInside</a>(zc,zmin,zmax)) flag = 1;</div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;      } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcmp(IB-&gt;<a class="code" href="a00191.html#a935394e510d17282c5697cd76a6e2667">mode</a>,<a class="code" href="a00191.html#aa2d4d0cc81beab5f62c5527941655474">_IB_YZ_</a>)) {</div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="a00331.html#ae5fc4cce9be29ebb8c3d80c534e55720">isInside</a>(yc,ymin,ymax) &amp;&amp; <a class="code" href="a00331.html#ae5fc4cce9be29ebb8c3d80c534e55720">isInside</a>(zc,zmin,zmax)) flag = 1;</div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;      }</div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;</div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;      <span class="keywordflow">if</span> (flag == 1) {</div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;        fmap[count].<a class="code" href="a00191.html#adc15fcdbb3aaff6ced4ab10162781055">facet</a> = facets + n;</div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;        fmap[count].<a class="code" href="a00191.html#a750b5d744c39a06bfb13e6eb010e35d0">index</a> = n;</div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;        </div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;        fmap[count].<a class="code" href="a00191.html#abaefdeffb1a6c37ecbbba1abe183a288">xc</a> = xc;</div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;        fmap[count].<a class="code" href="a00191.html#a31d2d6327e76038cd2aee5b972f6a9b3">yc</a> = yc;</div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;        fmap[count].<a class="code" href="a00191.html#ae4077e68c108b9ac7d51ef8560c3eebb">zc</a> = zc;</div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;</div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;        <span class="keywordtype">int</span> ic,jc, kc;</div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;</div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;        ierr = <a class="code" href="a00331.html#ac8dd87df944e8659dedfa3171e832f44">interpNodesCoeffs</a>( mpi,</div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;                                  xc, yc, zc,</div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;                                  x, y, z,</div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;                                  dim,</div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;                                  ghosts,</div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;                                  IB-&gt;<a class="code" href="a00191.html#a935394e510d17282c5697cd76a6e2667">mode</a>,</div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;                                  &amp;ic, &amp;jc, &amp;kc,</div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;                                  fmap[count].<a class="code" href="a00191.html#a849cc8a5a571348a4d50a0332d9816f8">interp_nodes</a>,</div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;                                  fmap[count].<a class="code" href="a00191.html#a4855c244bb3e3ba9b245312a375eed76">interp_coeffs</a> );</div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;        <span class="keywordflow">if</span> (ierr) {</div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;          fprintf(stderr, <span class="stringliteral">&quot;Error in IBCreateFacetMapping(): \n&quot;</span>);</div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;          fprintf(stderr, <span class="stringliteral">&quot;  interpNodesCoeffs() returned with error code %d on rank %d.\n&quot;</span>,</div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;                  ierr, mpi-&gt;<a class="code" href="a00207.html#a6cfd95afd0afebd625b889fb6e58371c">rank</a> );</div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;          <span class="keywordflow">return</span>(ierr);</div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;        }</div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;</div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;        <span class="keywordtype">double</span> dx = x[ic] - x[ic-1];</div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;        <span class="keywordtype">double</span> dy = y[jc] - y[jc-1];</div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;        <span class="keywordtype">double</span> dz = z[kc] - z[kc-1];</div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;        <span class="keywordtype">double</span> ds;</div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;        <span class="keywordflow">if</span>      (!strcmp(IB-&gt;<a class="code" href="a00191.html#a935394e510d17282c5697cd76a6e2667">mode</a>,<a class="code" href="a00191.html#a6f872a36881067ae3dbd5a14042cb2d6">_IB_XY_</a>)) ds = <a class="code" href="a00245.html#ac6afabdc09a49a433ee19d8a9486056d">min</a>(dx,dy);</div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcmp(IB-&gt;<a class="code" href="a00191.html#a935394e510d17282c5697cd76a6e2667">mode</a>,<a class="code" href="a00191.html#a948cb38cc6d11f9f4c9030994e9a3367">_IB_XZ_</a>)) ds = <a class="code" href="a00245.html#ac6afabdc09a49a433ee19d8a9486056d">min</a>(dx,dz);</div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcmp(IB-&gt;<a class="code" href="a00191.html#a935394e510d17282c5697cd76a6e2667">mode</a>,<a class="code" href="a00191.html#aa2d4d0cc81beab5f62c5527941655474">_IB_YZ_</a>)) ds = <a class="code" href="a00245.html#ac6afabdc09a49a433ee19d8a9486056d">min</a>(dy,dz);</div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;        <span class="keywordflow">else</span>                                ds = <a class="code" href="a00245.html#ab1e1ffb6aa15887fa3bda4cfdef1f53a">min3</a>(dx,dy,dz);</div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;</div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;        <span class="keywordtype">double</span> nx = fmap[count].<a class="code" href="a00191.html#adc15fcdbb3aaff6ced4ab10162781055">facet</a>-&gt;<a class="code" href="a00191.html#a74d07ed95c86939416c6a88f1daf8e1a">nx</a>;</div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;        <span class="keywordtype">double</span> ny = fmap[count].<a class="code" href="a00191.html#adc15fcdbb3aaff6ced4ab10162781055">facet</a>-&gt;<a class="code" href="a00191.html#a147a8b14bbd79c0f1a3457805e2065ba">ny</a>;</div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;        <span class="keywordtype">double</span> nz = fmap[count].<a class="code" href="a00191.html#adc15fcdbb3aaff6ced4ab10162781055">facet</a>-&gt;<a class="code" href="a00191.html#a463bf8b21578003b62221acf2e522134">nz</a>;</div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;</div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;        <span class="keywordflow">if</span> (nx == 0.0) nx += IB-&gt;<a class="code" href="a00191.html#a9ea1a8f5ef3e6d20b362385e1288c72c">delta</a>*ds;</div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;        <span class="keywordflow">if</span> (ny == 0.0) ny += IB-&gt;<a class="code" href="a00191.html#a9ea1a8f5ef3e6d20b362385e1288c72c">delta</a>*ds;</div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;        <span class="keywordflow">if</span> (nz == 0.0) nz += IB-&gt;<a class="code" href="a00191.html#a9ea1a8f5ef3e6d20b362385e1288c72c">delta</a>*ds;</div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;</div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;        <span class="keywordtype">double</span> xns = xc + <a class="code" href="a00245.html#a1e471b644e7fd684cd5dbb144e00ee81">sign</a>(nx)*ds;</div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;        <span class="keywordtype">double</span> yns = yc + <a class="code" href="a00245.html#a1e471b644e7fd684cd5dbb144e00ee81">sign</a>(ny)*ds;</div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;        <span class="keywordtype">double</span> zns = zc + <a class="code" href="a00245.html#a1e471b644e7fd684cd5dbb144e00ee81">sign</a>(nz)*ds;</div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;</div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;        fmap[count].<a class="code" href="a00191.html#a229d11aff11a7482259d1296b9b70b8a">dx</a> = xns - xc;</div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;        fmap[count].<a class="code" href="a00191.html#a9deb6f886b19d50e714d890c3c268efc">dy</a> = yns - yc;</div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;        fmap[count].<a class="code" href="a00191.html#a5a198de8c3f38514f4e55231aa69cd10">dz</a> = zns - zc;</div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;</div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;        ierr = <a class="code" href="a00331.html#ac8dd87df944e8659dedfa3171e832f44">interpNodesCoeffs</a>( mpi,</div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;                                  xns, yns, zns,</div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;                                  x, y, z,</div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;                                  dim,</div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;                                  ghosts,</div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;                                  IB-&gt;<a class="code" href="a00191.html#a935394e510d17282c5697cd76a6e2667">mode</a>,</div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;                                  NULL,NULL,NULL,</div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;                                  fmap[count].<a class="code" href="a00191.html#ae7231c0798d24ebed4aec9c288cb8d4f">interp_nodes_ns</a>,</div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;                                  fmap[count].<a class="code" href="a00191.html#a047220645840c2812b0c4b0a714ce824">interp_coeffs_ns</a> );</div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;        <span class="keywordflow">if</span> (ierr) {</div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;          fprintf(stderr, <span class="stringliteral">&quot;Error in IBCreateFacetMapping(): \n&quot;</span>);</div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;          fprintf(stderr, <span class="stringliteral">&quot;  interpNodesCoeffs() returned with error code %d on rank %d.\n&quot;</span>,</div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;                  ierr, mpi-&gt;<a class="code" href="a00207.html#a6cfd95afd0afebd625b889fb6e58371c">rank</a> );</div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;          <span class="keywordflow">return</span>(ierr);</div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;        }</div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;</div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;        count++;</div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;      }</div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;    }</div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;</div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;    IB-&gt;<a class="code" href="a00191.html#ab3583871695c8f2fc06011d14e092d09">nfacets_local</a> = nfacets_local;</div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;    IB-&gt;<a class="code" href="a00191.html#a83fe29d69e04c222af5c68e38142336c">fmap</a> = fmap;  </div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;</div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;  } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;</div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;    IB-&gt;<a class="code" href="a00191.html#ab3583871695c8f2fc06011d14e092d09">nfacets_local</a> = 0;</div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;    IB-&gt;<a class="code" href="a00191.html#a83fe29d69e04c222af5c68e38142336c">fmap</a> = NULL;</div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;</div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;  }</div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;</div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;  <span class="keywordflow">return</span>(0);</div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;}</div>
<div class="ttc" id="a00191_html_adc15fcdbb3aaff6ced4ab10162781055"><div class="ttname"><a href="a00191.html#adc15fcdbb3aaff6ced4ab10162781055">FacetMap::facet</a></div><div class="ttdeci">Facet3D * facet</div><div class="ttdef"><b>Definition:</b> <a href="a00191_source.html#l00068">immersedboundaries.h:68</a></div></div>
<div class="ttc" id="a00191_html_a229d11aff11a7482259d1296b9b70b8a"><div class="ttname"><a href="a00191.html#a229d11aff11a7482259d1296b9b70b8a">FacetMap::dx</a></div><div class="ttdeci">double dx</div><div class="ttdef"><b>Definition:</b> <a href="a00191_source.html#l00082">immersedboundaries.h:82</a></div></div>
<div class="ttc" id="a00191_html_a83fe29d69e04c222af5c68e38142336c"><div class="ttname"><a href="a00191.html#a83fe29d69e04c222af5c68e38142336c">ImmersedBoundary::fmap</a></div><div class="ttdeci">FacetMap * fmap</div><div class="ttdef"><b>Definition:</b> <a href="a00191_source.html#l00156">immersedboundaries.h:156</a></div></div>
<div class="ttc" id="a00191_html_a4855c244bb3e3ba9b245312a375eed76"><div class="ttname"><a href="a00191.html#a4855c244bb3e3ba9b245312a375eed76">FacetMap::interp_coeffs</a></div><div class="ttdeci">double interp_coeffs[_IB_NNODES_]</div><div class="ttdef"><b>Definition:</b> <a href="a00191_source.html#l00071">immersedboundaries.h:71</a></div></div>
<div class="ttc" id="a00191_html_a00672"><div class="ttname"><a href="a00191.html#a00672">ImmersedBoundary</a></div><div class="ttdoc">Structure containing variables for immersed boundary implementation. </div><div class="ttdef"><b>Definition:</b> <a href="a00191_source.html#l00153">immersedboundaries.h:153</a></div></div>
<div class="ttc" id="a00191_html_a00659"><div class="ttname"><a href="a00191.html#a00659">Body3D</a></div><div class="ttdoc">Structure defining a body. </div><div class="ttdef"><b>Definition:</b> <a href="a00191_source.html#l00100">immersedboundaries.h:100</a></div></div>
<div class="ttc" id="a00191_html_a00664"><div class="ttname"><a href="a00191.html#a00664">Facet3D</a></div><div class="ttdoc">Structure defining a facet. </div><div class="ttdef"><b>Definition:</b> <a href="a00191_source.html#l00039">immersedboundaries.h:39</a></div></div>
<div class="ttc" id="a00191_html_a00665"><div class="ttname"><a href="a00191.html#a00665">FacetMap</a></div><div class="ttdoc">Structure defining a facet map. </div><div class="ttdef"><b>Definition:</b> <a href="a00191_source.html#l00067">immersedboundaries.h:67</a></div></div>
<div class="ttc" id="a00191_html_ac75b803b570527306e1e744bfb7a604f"><div class="ttname"><a href="a00191.html#ac75b803b570527306e1e744bfb7a604f">Facet3D::x1</a></div><div class="ttdeci">double x1</div><div class="ttdef"><b>Definition:</b> <a href="a00191_source.html#l00040">immersedboundaries.h:40</a></div></div>
<div class="ttc" id="a00245_html_ab1e1ffb6aa15887fa3bda4cfdef1f53a"><div class="ttname"><a href="a00245.html#ab1e1ffb6aa15887fa3bda4cfdef1f53a">min3</a></div><div class="ttdeci">#define min3(a, b, c)</div><div class="ttdef"><b>Definition:</b> <a href="a00245_source.html#l00023">math_ops.h:23</a></div></div>
<div class="ttc" id="a00191_html_a9ea1a8f5ef3e6d20b362385e1288c72c"><div class="ttname"><a href="a00191.html#a9ea1a8f5ef3e6d20b362385e1288c72c">ImmersedBoundary::delta</a></div><div class="ttdeci">double delta</div><div class="ttdef"><b>Definition:</b> <a href="a00191_source.html#l00159">immersedboundaries.h:159</a></div></div>
<div class="ttc" id="a00191_html_a5a198de8c3f38514f4e55231aa69cd10"><div class="ttname"><a href="a00191.html#a5a198de8c3f38514f4e55231aa69cd10">FacetMap::dz</a></div><div class="ttdeci">double dz</div><div class="ttdef"><b>Definition:</b> <a href="a00191_source.html#l00082">immersedboundaries.h:82</a></div></div>
<div class="ttc" id="a00331_html_ae5fc4cce9be29ebb8c3d80c534e55720"><div class="ttname"><a href="a00331.html#ae5fc4cce9be29ebb8c3d80c534e55720">isInside</a></div><div class="ttdeci">static int isInside(double x, double a, double b)</div><div class="ttdef"><b>Definition:</b> <a href="a00331_source.html#l00014">IBCreateFacetMapping.c:14</a></div></div>
<div class="ttc" id="a00191_html_aa2d4d0cc81beab5f62c5527941655474"><div class="ttname"><a href="a00191.html#aa2d4d0cc81beab5f62c5527941655474">_IB_YZ_</a></div><div class="ttdeci">#define _IB_YZ_</div><div class="ttdef"><b>Definition:</b> <a href="a00191_source.html#l00020">immersedboundaries.h:20</a></div></div>
<div class="ttc" id="a00191_html_ab3583871695c8f2fc06011d14e092d09"><div class="ttname"><a href="a00191.html#ab3583871695c8f2fc06011d14e092d09">ImmersedBoundary::nfacets_local</a></div><div class="ttdeci">int nfacets_local</div><div class="ttdef"><b>Definition:</b> <a href="a00191_source.html#l00162">immersedboundaries.h:162</a></div></div>
<div class="ttc" id="a00191_html_a786634d3d364cf94d8eb600ce7136355"><div class="ttname"><a href="a00191.html#a786634d3d364cf94d8eb600ce7136355">Facet3D::y3</a></div><div class="ttdeci">double y3</div><div class="ttdef"><b>Definition:</b> <a href="a00191_source.html#l00040">immersedboundaries.h:40</a></div></div>
<div class="ttc" id="a00191_html_ac3b72e5b77595ca2340ecf8ccfe5fd99"><div class="ttname"><a href="a00191.html#ac3b72e5b77595ca2340ecf8ccfe5fd99">Facet3D::y1</a></div><div class="ttdeci">double y1</div><div class="ttdef"><b>Definition:</b> <a href="a00191_source.html#l00040">immersedboundaries.h:40</a></div></div>
<div class="ttc" id="a00191_html_a822ab991099a420eb62b3f0e2b0021a2"><div class="ttname"><a href="a00191.html#a822ab991099a420eb62b3f0e2b0021a2">Facet3D::z2</a></div><div class="ttdeci">double z2</div><div class="ttdef"><b>Definition:</b> <a href="a00191_source.html#l00040">immersedboundaries.h:40</a></div></div>
<div class="ttc" id="a00191_html_a9deb6f886b19d50e714d890c3c268efc"><div class="ttname"><a href="a00191.html#a9deb6f886b19d50e714d890c3c268efc">FacetMap::dy</a></div><div class="ttdeci">double dy</div><div class="ttdef"><b>Definition:</b> <a href="a00191_source.html#l00082">immersedboundaries.h:82</a></div></div>
<div class="ttc" id="a00191_html_abaefdeffb1a6c37ecbbba1abe183a288"><div class="ttname"><a href="a00191.html#abaefdeffb1a6c37ecbbba1abe183a288">FacetMap::xc</a></div><div class="ttdeci">double xc</div><div class="ttdef"><b>Definition:</b> <a href="a00191_source.html#l00075">immersedboundaries.h:75</a></div></div>
<div class="ttc" id="a00191_html_af858f0e9bc4a6cb1c16ad2931cf4b43d"><div class="ttname"><a href="a00191.html#af858f0e9bc4a6cb1c16ad2931cf4b43d">ImmersedBoundary::body</a></div><div class="ttdeci">Body3D * body</div><div class="ttdef"><b>Definition:</b> <a href="a00191_source.html#l00154">immersedboundaries.h:154</a></div></div>
<div class="ttc" id="a00191_html_a935394e510d17282c5697cd76a6e2667"><div class="ttname"><a href="a00191.html#a935394e510d17282c5697cd76a6e2667">ImmersedBoundary::mode</a></div><div class="ttdeci">char mode[_MAX_STRING_SIZE_]</div><div class="ttdef"><b>Definition:</b> <a href="a00191_source.html#l00164">immersedboundaries.h:164</a></div></div>
<div class="ttc" id="a00191_html_a80bdbbd2624bd70748ffd44c11ffd1fb"><div class="ttname"><a href="a00191.html#a80bdbbd2624bd70748ffd44c11ffd1fb">_IB_3D_</a></div><div class="ttdeci">#define _IB_3D_</div><div class="ttdef"><b>Definition:</b> <a href="a00191_source.html#l00022">immersedboundaries.h:22</a></div></div>
<div class="ttc" id="a00191_html_aa7bdafcc50881d7f0f4db707755698ce"><div class="ttname"><a href="a00191.html#aa7bdafcc50881d7f0f4db707755698ce">Body3D::surface</a></div><div class="ttdeci">Facet3D * surface</div><div class="ttdef"><b>Definition:</b> <a href="a00191_source.html#l00102">immersedboundaries.h:102</a></div></div>
<div class="ttc" id="a00191_html_a98e99f64ddf7321e4eae52beca4b580f"><div class="ttname"><a href="a00191.html#a98e99f64ddf7321e4eae52beca4b580f">Facet3D::x3</a></div><div class="ttdeci">double x3</div><div class="ttdef"><b>Definition:</b> <a href="a00191_source.html#l00040">immersedboundaries.h:40</a></div></div>
<div class="ttc" id="a00191_html_a0e1fe82df628138c8f3907ecddb514ae"><div class="ttname"><a href="a00191.html#a0e1fe82df628138c8f3907ecddb514ae">Facet3D::z1</a></div><div class="ttdeci">double z1</div><div class="ttdef"><b>Definition:</b> <a href="a00191_source.html#l00040">immersedboundaries.h:40</a></div></div>
<div class="ttc" id="a00191_html_a948cb38cc6d11f9f4c9030994e9a3367"><div class="ttname"><a href="a00191.html#a948cb38cc6d11f9f4c9030994e9a3367">_IB_XZ_</a></div><div class="ttdeci">#define _IB_XZ_</div><div class="ttdef"><b>Definition:</b> <a href="a00191_source.html#l00018">immersedboundaries.h:18</a></div></div>
<div class="ttc" id="a00191_html_a5347e514ebe985fb371754ffd2b5ff83"><div class="ttname"><a href="a00191.html#a5347e514ebe985fb371754ffd2b5ff83">Facet3D::y2</a></div><div class="ttdeci">double y2</div><div class="ttdef"><b>Definition:</b> <a href="a00191_source.html#l00040">immersedboundaries.h:40</a></div></div>
<div class="ttc" id="a00191_html_a047220645840c2812b0c4b0a714ce824"><div class="ttname"><a href="a00191.html#a047220645840c2812b0c4b0a714ce824">FacetMap::interp_coeffs_ns</a></div><div class="ttdeci">double interp_coeffs_ns[_IB_NNODES_]</div><div class="ttdef"><b>Definition:</b> <a href="a00191_source.html#l00073">immersedboundaries.h:73</a></div></div>
<div class="ttc" id="a00191_html_ae7231c0798d24ebed4aec9c288cb8d4f"><div class="ttname"><a href="a00191.html#ae7231c0798d24ebed4aec9c288cb8d4f">FacetMap::interp_nodes_ns</a></div><div class="ttdeci">int interp_nodes_ns[_IB_NNODES_]</div><div class="ttdef"><b>Definition:</b> <a href="a00191_source.html#l00072">immersedboundaries.h:72</a></div></div>
<div class="ttc" id="a00191_html_a74d07ed95c86939416c6a88f1daf8e1a"><div class="ttname"><a href="a00191.html#a74d07ed95c86939416c6a88f1daf8e1a">Facet3D::nx</a></div><div class="ttdeci">double nx</div><div class="ttdef"><b>Definition:</b> <a href="a00191_source.html#l00040">immersedboundaries.h:40</a></div></div>
<div class="ttc" id="a00191_html_a849cc8a5a571348a4d50a0332d9816f8"><div class="ttname"><a href="a00191.html#a849cc8a5a571348a4d50a0332d9816f8">FacetMap::interp_nodes</a></div><div class="ttdeci">int interp_nodes[_IB_NNODES_]</div><div class="ttdef"><b>Definition:</b> <a href="a00191_source.html#l00070">immersedboundaries.h:70</a></div></div>
<div class="ttc" id="a00191_html_a463bf8b21578003b62221acf2e522134"><div class="ttname"><a href="a00191.html#a463bf8b21578003b62221acf2e522134">Facet3D::nz</a></div><div class="ttdeci">double nz</div><div class="ttdef"><b>Definition:</b> <a href="a00191_source.html#l00040">immersedboundaries.h:40</a></div></div>
<div class="ttc" id="a00191_html_a750b5d744c39a06bfb13e6eb010e35d0"><div class="ttname"><a href="a00191.html#a750b5d744c39a06bfb13e6eb010e35d0">FacetMap::index</a></div><div class="ttdeci">int index</div><div class="ttdef"><b>Definition:</b> <a href="a00191_source.html#l00069">immersedboundaries.h:69</a></div></div>
<div class="ttc" id="a00191_html_adcf04f5f1964d18b332643939561da0d"><div class="ttname"><a href="a00191.html#adcf04f5f1964d18b332643939561da0d">Facet3D::x2</a></div><div class="ttdeci">double x2</div><div class="ttdef"><b>Definition:</b> <a href="a00191_source.html#l00040">immersedboundaries.h:40</a></div></div>
<div class="ttc" id="a00191_html_a270503fb34041aa050ec80858f7820a7"><div class="ttname"><a href="a00191.html#a270503fb34041aa050ec80858f7820a7">Facet3D::z3</a></div><div class="ttdeci">double z3</div><div class="ttdef"><b>Definition:</b> <a href="a00191_source.html#l00040">immersedboundaries.h:40</a></div></div>
<div class="ttc" id="a00191_html_afd755b081f4d9ca3558ef9ca9f3c35d0"><div class="ttname"><a href="a00191.html#afd755b081f4d9ca3558ef9ca9f3c35d0">Body3D::nfacets</a></div><div class="ttdeci">int nfacets</div><div class="ttdef"><b>Definition:</b> <a href="a00191_source.html#l00101">immersedboundaries.h:101</a></div></div>
<div class="ttc" id="a00191_html_a31d2d6327e76038cd2aee5b972f6a9b3"><div class="ttname"><a href="a00191.html#a31d2d6327e76038cd2aee5b972f6a9b3">FacetMap::yc</a></div><div class="ttdeci">double yc</div><div class="ttdef"><b>Definition:</b> <a href="a00191_source.html#l00075">immersedboundaries.h:75</a></div></div>
<div class="ttc" id="a00331_html_ac8dd87df944e8659dedfa3171e832f44"><div class="ttname"><a href="a00331.html#ac8dd87df944e8659dedfa3171e832f44">interpNodesCoeffs</a></div><div class="ttdeci">static int interpNodesCoeffs(void *m, double xc, double yc, double zc, double *x, double *y, double *z, int *dim, int ghosts, char *mode, int *ii, int *jj, int *kk, int *inodes, double *icoeffs)</div><div class="ttdef"><b>Definition:</b> <a href="a00331_source.html#l00028">IBCreateFacetMapping.c:28</a></div></div>
<div class="ttc" id="a00245_html_a1e471b644e7fd684cd5dbb144e00ee81"><div class="ttname"><a href="a00245.html#a1e471b644e7fd684cd5dbb144e00ee81">sign</a></div><div class="ttdeci">#define sign(a)</div><div class="ttdef"><b>Definition:</b> <a href="a00245_source.html#l00054">math_ops.h:54</a></div></div>
<div class="ttc" id="a00191_html_ae4077e68c108b9ac7d51ef8560c3eebb"><div class="ttname"><a href="a00191.html#ae4077e68c108b9ac7d51ef8560c3eebb">FacetMap::zc</a></div><div class="ttdeci">double zc</div><div class="ttdef"><b>Definition:</b> <a href="a00191_source.html#l00075">immersedboundaries.h:75</a></div></div>
<div class="ttc" id="a00207_html_a00674"><div class="ttname"><a href="a00207.html#a00674">MPIVariables</a></div><div class="ttdoc">Structure of MPI-related variables. </div><div class="ttdef"><b>Definition:</b> <a href="a00207_source.html#l00024">mpivars_struct.h:24</a></div></div>
<div class="ttc" id="a00191_html_a147a8b14bbd79c0f1a3457805e2065ba"><div class="ttname"><a href="a00191.html#a147a8b14bbd79c0f1a3457805e2065ba">Facet3D::ny</a></div><div class="ttdeci">double ny</div><div class="ttdef"><b>Definition:</b> <a href="a00191_source.html#l00040">immersedboundaries.h:40</a></div></div>
<div class="ttc" id="a00191_html_a6f872a36881067ae3dbd5a14042cb2d6"><div class="ttname"><a href="a00191.html#a6f872a36881067ae3dbd5a14042cb2d6">_IB_XY_</a></div><div class="ttdeci">#define _IB_XY_</div><div class="ttdef"><b>Definition:</b> <a href="a00191_source.html#l00016">immersedboundaries.h:16</a></div></div>
<div class="ttc" id="a00245_html_ac6afabdc09a49a433ee19d8a9486056d"><div class="ttname"><a href="a00245.html#ac6afabdc09a49a433ee19d8a9486056d">min</a></div><div class="ttdeci">#define min(a, b)</div><div class="ttdef"><b>Definition:</b> <a href="a00245_source.html#l00014">math_ops.h:14</a></div></div>
<div class="ttc" id="a00207_html_a6cfd95afd0afebd625b889fb6e58371c"><div class="ttname"><a href="a00207.html#a6cfd95afd0afebd625b889fb6e58371c">MPIVariables::rank</a></div><div class="ttdeci">int rank</div><div class="ttdef"><b>Definition:</b> <a href="a00207_source.html#l00025">mpivars_struct.h:25</a></div></div>
</div><!-- fragment -->
</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- Start of StatCounter Code for Default Guide -->
<script type="text/javascript">
var sc_project=10897352; 
var sc_invisible=1; 
var sc_security="83042f57"; 
var scJsHost = (("https:" == document.location.protocol) ?
"https://secure." : "http://www.");
document.write("<sc"+"ript type='text/javascript' src='" +
scJsHost+
"statcounter.com/counter/counter.js'></"+"script>");
</script>
<noscript><div class="statcounter"><a title="website
statistics" href="http://statcounter.com/"
target="_blank"><img class="statcounter"
src="//c.statcounter.com/10897352/0/83042f57/1/"
alt="website statistics"></a></div></noscript>
<!-- End of StatCounter Code for Default Guide -->
