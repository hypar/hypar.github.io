<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>HyPar: doc/Examples.md Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<!-- Generated by Doxygen 1.6.1 -->
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li><a href="main.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="annotated.html"><span>Data&nbsp;Structures</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div class="tabs">
    <ul>
      <li><a href="files.html"><span>File&nbsp;List</span></a></li>
      <li><a href="globals.html"><span>Globals</span></a></li>
    </ul>
  </div>
<h1>doc/Examples.md</h1><a href="a00031.html">Go to the documentation of this file.</a><div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 <a class="code" href="a00031.html#a60f502575a2e782807ea78c05f76ae03">Examples</a>
<a name="l00002"></a><a class="code" href="a00031.html#a3e3ad7937eeeba9f55cc34549af86134">00002</a> ========
<a name="l00003"></a>00003 
<a name="l00004"></a>00004 \subpage basic_examples :
<a name="l00005"></a>00005 Some basic examples that are simulated <span class="keyword">using</span> <a class="code" href="a00015.html" title="Structure containing all solver-specific variables and functions.">HyPar</a>. They 
<a name="l00006"></a>00006 all <a class="code" href="a00063.html#aa62d35257af3497101065692a222b8d8">use</a> <span class="keyword">explicit</span> time integration, and \b <span class="keywordflow">do</span> \b not require <a class="code" href="a00015.html" title="Structure containing all solver-specific variables and functions.">HyPar</a> to be compiled
<a name="l00007"></a>00007 with <a class="code" href="a00032.html#a74efd4099e297716dbf2fa701e90b65e">PETSc</a>. Most of them can be <a class="code" href="a00031.html#ad832968f40196d5feb1af9475c981b45">run</a> on one or a small number of processors.
<a name="l00008"></a>00008 
<a name="l00009"></a>00009 \subpage <a class="code" href="a00031.html#a93ed18fea13689603ac820fae45977d1">petsc_examples</a> : 
<a name="l00010"></a>00010 Some examples that <a class="code" href="a00063.html#aa62d35257af3497101065692a222b8d8">use</a> implicit or semi-implicit (IMEX) time
<a name="l00011"></a>00011 integration methods implemented in <a class="code" href="a00032.html#a74efd4099e297716dbf2fa701e90b65e">PETSc</a>. To <a class="code" href="a00031.html#ad832968f40196d5feb1af9475c981b45">run</a> them, <a class="code" href="a00015.html" title="Structure containing all solver-specific variables and functions.">HyPar</a> needs to be compiled \b with \b <a class="code" href="a00032.html#a74efd4099e297716dbf2fa701e90b65e">PETSc</a>.
<a name="l00012"></a>00012 
<a name="l00013"></a>00013 \subpage <a class="code" href="a00031.html#adce7dbbe4ce9816c5e3eb703768dbb9e">ib_examples</a> : <a class="code" href="a00031.html#a60f502575a2e782807ea78c05f76ae03">Examples</a> that <a class="code" href="a00063.html#aa62d35257af3497101065692a222b8d8">use</a> the immersed boundary method to simulate various geometries.
<a name="l00014"></a>00014 
<a name="l00015"></a>00015 \<a class="code" href="a00032.html#a23a77f360d9ab0a90b11ff01314b6526">page</a> basic_examples Basic <a class="code" href="a00031.html#a60f502575a2e782807ea78c05f76ae03">Examples</a>
<a name="l00016"></a>00016 
<a name="l00017"></a>00017 The following are some basic examples that are simulated using <a class="code" href="a00015.html" title="Structure containing all solver-specific variables and functions.">HyPar</a>. They 
<a name="l00018"></a>00018 all <a class="code" href="a00063.html#aa62d35257af3497101065692a222b8d8">use</a> explicit time integration, and \b do \b not require <a class="code" href="a00015.html" title="Structure containing all solver-specific variables and functions.">HyPar</a> to be compiled
<a name="l00019"></a>00019 with <a class="code" href="a00032.html#a74efd4099e297716dbf2fa701e90b65e">PETSc</a>.
<a name="l00020"></a>00020 
<a name="l00021"></a>00021 \subpage linear_adv_sine \n
<a name="l00022"></a>00022 \subpage linear_adv_disc \n
<a name="l00023"></a>00023 \subpage linear_diff_sine 
<a name="l00024"></a>00024 
<a name="l00025"></a>00025 \subpage sod_shock_tube  \n
<a name="l00026"></a>00026 \subpage lax_shock_tube \n
<a name="l00027"></a>00027 \subpage shu_osher \n
<a name="l00028"></a>00028 \subpage sod_shock_tube_wgrav
<a name="l00029"></a>00029 
<a name="l00030"></a>00030 \subpage sw_dambreak
<a name="l00031"></a>00031 
<a name="l00032"></a>00032 \subpage linear_adv_gauss \n
<a name="l00033"></a>00033 \subpage linear_diff_sine2d
<a name="l00034"></a>00034 
<a name="l00035"></a>00035 \subpage euler2d_riemann4 \n
<a name="l00036"></a>00036 \subpage euler2d_riemann6 \n
<a name="l00037"></a>00037 \subpage euler2d_radexp \n
<a name="l00038"></a>00038 \subpage euler2d_vortex
<a name="l00039"></a>00039 
<a name="l00040"></a>00040 \subpage euler2d_igwave \n
<a name="l00041"></a>00041 \subpage euler2d_rtb
<a name="l00042"></a>00042 
<a name="l00043"></a>00043 \subpage navstok2d_ldsc \n
<a name="l00044"></a>00044 \subpage navstok2d_flatplate
<a name="l00045"></a>00045 
<a name="l00046"></a>00046 \subpage sw_circdambreak \n
<a name="l00047"></a>00047 \subpage sw_latbelt
<a name="l00048"></a>00048 
<a name="l00049"></a>00049 \subpage linear_adv_3dgauss
<a name="l00050"></a>00050 
<a name="l00051"></a>00051 \subpage ns3d_isoturb \n
<a name="l00052"></a>00052 \subpage ns3d_bubble
<a name="l00053"></a>00053 
<a name="l00054"></a>00054 \subpage numa3d_bubble
<a name="l00055"></a>00055 
<a name="l00056"></a>00056 \<a class="code" href="a00032.html#a23a77f360d9ab0a90b11ff01314b6526">page</a> linear_adv_sine 1<a class="code" href="a00031.html#add034d002483743ecf892648b0a4b6cc">D</a> Linear Advection - Sine Wave
<a name="l00057"></a>00057 
<a name="l00058"></a>00058 <a class="code" href="a00031.html#af7342acc7b7299a81e83b43ed11b9f84">Location</a>: \b hypar/<a class="code" href="a00031.html#a60f502575a2e782807ea78c05f76ae03">Examples</a>/1<a class="code" href="a00031.html#add034d002483743ecf892648b0a4b6cc">D</a>/LinearAdvection/SineWave
<a name="l00059"></a>00059           (This directory contains all the input <a class="code" href="a00064.html#a5d3fb946f2b43ba02e668023ecf2c74b">files</a> needed
<a name="l00060"></a>00060           to <a class="code" href="a00031.html#ad832968f40196d5feb1af9475c981b45">run</a> this case. If there is a \a Run.m, <a class="code" href="a00031.html#ad832968f40196d5feb1af9475c981b45">run</a> it in
<a name="l00061"></a>00061           MATLAB to quickly set <a class="code" href="a00031.html#a3e3ad7937eeeba9f55cc34549af86134">up</a>, <a class="code" href="a00031.html#ad832968f40196d5feb1af9475c981b45">run</a>, and visualize the 
<a name="l00062"></a>00062           <a class="code" href="a00032.html#aff6369b7fb5859bb002145c1c010f831">example</a>).
<a name="l00063"></a>00063 
<a name="l00064"></a>00064 Governing <a class="code" href="a00031.html#a6e2d32e81b7ad98679f4247b1488afa6">equations</a>: 1<a class="code" href="a00031.html#add034d002483743ecf892648b0a4b6cc">D</a> Linear Advection Equation (linearadr.h)
<a name="l00065"></a>00065 
<a name="l00066"></a>00066 References:
<a name="l00067"></a>00067   + Ghosh, <a class="code" href="a00031.html#add034d002483743ecf892648b0a4b6cc">D</a>., <a class="code" href="a00031.html#a8e0c6ca2af52afc4e94932b3a2cc8643">Baeder</a>, J. D., &quot;Compact Reconstruction Schemes with 
<a name="l00068"></a>00068     Weighted ENO Limiting for Hyperbolic Conservation <a class="code" href="a00031.html#a5cb55711f770183c414bd58e6c53afeb">Laws</a>&quot;, 
<a name="l00069"></a>00069     SIAM Journal on Scientific <a class="code" href="a00031.html#af3b8db132626a78f6dc2af1f6f79cf13">Computing</a>, 34 (3), 2012, A1678–A1706
<a name="l00070"></a>00070 
<a name="l00071"></a>00071 <a class="code" href="a00031.html#a948095327123305f3fdf2b293b55381e">Domain</a>: \f$0 \le x &lt; 1\f$, \a &quot;periodic&quot; (<span class="preprocessor">#_PERIODIC_)</span>
<a name="l00072"></a>00072 <span class="preprocessor"></span>        boundary <a class="code" href="a00063.html#a07bca284db2938db7ad469438892ca47">conditions</a>
<a name="l00073"></a>00073 
<a name="l00074"></a>00074 Initial solution: \f$u\left(x,0\right) = \sin\left(2\pi x\right)\f$
<a name="l00075"></a>00075 
<a name="l00076"></a>00076 Numerical <a class="code" href="a00033.html#a1610bc0f5a3c1062419d67e161327d37">Method</a>:
<a name="l00077"></a>00077  + Spatial <a class="code" href="a00033.html#a006f5ed6c12ae3d4f8e840cb181a05ca">discretization</a> (hyperbolic): 5th order CRWENO (<a class="code" href="a00041.html#a33b1e24c12129941b0027a83c543a654" title="5th order CRWENO reconstruction (component-wise) on a uniform grid">Interp1PrimFifthOrderCRWENO</a>())
<a name="l00078"></a>00078  + Time integration: SSPRK3 (<a class="code" href="a00061.html#aca6ebec6e6998f0c509bb38fa91f3321">TimeRK</a>(), #<a class="code" href="a00061.html#a97e67bb275d6a2dad40b184579559f82">_RK_SSP3_</a>)
<a name="l00079"></a>00079 
<a name="l00080"></a>00080 Input <a class="code" href="a00064.html#a5d3fb946f2b43ba02e668023ecf2c74b">files</a> <a class="code" href="a00032.html#af7a1b4a66a5b6f9ac8eebf2c23b51e9e">required</a>:
<a name="l00081"></a>00081 ---------------------
<a name="l00082"></a>00082 
<a name="l00083"></a>00083 \b solver.inp
<a name="l00084"></a>00084 \include 1D/LinearAdvection/SineWave/solver.inp
<a name="l00085"></a>00085 
<a name="l00086"></a>00086 \b boundary.inp
<a name="l00087"></a>00087 \include 1D/LinearAdvection/SineWave/boundary.inp
<a name="l00088"></a>00088 
<a name="l00089"></a>00089 \b physics.inp
<a name="l00090"></a>00090 \include 1D/LinearAdvection/SineWave/physics.inp
<a name="l00091"></a>00091 
<a name="l00092"></a>00092 \b lusolver.inp (optional)
<a name="l00093"></a>00093 \include 1D/LinearAdvection/SineWave/lusolver.inp
<a name="l00094"></a>00094 
<a name="l00095"></a>00095 \b weno.inp (optional)
<a name="l00096"></a>00096 \include 1D/LinearAdvection/SineWave/weno.inp
<a name="l00097"></a>00097 
<a name="l00098"></a>00098 To generate \b initial.inp, compile and run the 
<a name="l00099"></a>00099 following code in the run directory. \b <a class="code" href="a00032.html#a86616b1951d3af95df5b7115dd30438f">Note</a>: if the
<a name="l00100"></a>00100 final time is an integer multiple of the time period,
<a name="l00101"></a>00101 the file \b initial.inp can also be <a class="code" href="a00032.html#aa2f9253c1a63124e53d64db71f7e7c16">used</a> as the exact
<a name="l00102"></a>00102 solution \b exact.inp (i.<a class="code" href="a00032.html#a35b3e91c83139b35bbacfaa59a58afd1">e</a>. create a sym link called 
<a name="l00103"></a>00103 \a exact.inp pointing to \a initial.inp, or just <a class="code" href="a00063.html#af77238a13603775a1f60ae9206d86600">copy</a>
<a name="l00104"></a>00104 \a initial.inp to \a exact.inp).
<a name="l00105"></a>00105 \include 1D/LinearAdvection/SineWave/aux/init.c
<a name="l00106"></a>00106 
<a name="l00107"></a>00107 Output:
<a name="l00108"></a>00108 -------
<a name="l00109"></a>00109 After running the code, there should be 11 output
<a name="l00110"></a>00110 <a class="code" href="a00064.html#a5d3fb946f2b43ba02e668023ecf2c74b">files</a> \b op_00000.<a class="code" href="a00031.html#a96b9dfbebc4ecd57a32426075fb0c3f2">dat</a>, \b op_00001.<a class="code" href="a00031.html#a96b9dfbebc4ecd57a32426075fb0c3f2">dat</a>, ... \b op_00010.<a class="code" href="a00031.html#a96b9dfbebc4ecd57a32426075fb0c3f2">dat</a>; 
<a name="l00111"></a><a class="code" href="a00031.html#a8cd17c591e0a3ddb47accc7152bce7e4">00111</a> the first one is the solution at \f<a class="code" href="a00031.html#a8cd17c591e0a3ddb47accc7152bce7e4">$t</a>=0\f$ and the <span class="keyword">final</span> one
<a name="l00112"></a>00112 is the solution at \f$t=1\f$. Since #<a class="code" href="a00015.html#a4e93cb107e180ef982b74cef7726b70f">HyPar::op_overwrite</a> is
<a name="l00113"></a>00113 <span class="keyword">set</span> to \a no in \b solver.inp, separate <a class="code" href="a00064.html#a5d3fb946f2b43ba02e668023ecf2c74b">files</a> are written
<a name="l00114"></a>00114 <span class="keywordflow">for</span> solutions at each output time. All the <a class="code" href="a00064.html#a5d3fb946f2b43ba02e668023ecf2c74b">files</a> are ASCII 
<a name="l00115"></a>00115 <a class="code" href="a00031.html#a314f90bacf496961ff4bfef89fea32c0">text</a> (#<a class="code" href="a00015.html#a51a3b8c19b86e9e1df5be02b05a6613c">HyPar::op_file_format</a> is <span class="keyword">set</span> to \a <a class="code" href="a00031.html#a314f90bacf496961ff4bfef89fea32c0">text</a> in \b solver.inp).
<a name="l00116"></a><a class="code" href="a00031.html#a3c3f941ca00d3a46c402ac279bc0b44e">00116</a> In these <a class="code" href="a00064.html#a5d3fb946f2b43ba02e668023ecf2c74b">files</a>, the first column is grid <a class="code" href="a00031.html#a3c3f941ca00d3a46c402ac279bc0b44e">index</a>, the second column 
<a name="l00117"></a>00117 is x-<a class="code" href="a00031.html#a4bcdcf216e3145a6cd9b40485ae7160f">coordinate</a>, and the third column is the solution.
<a name="l00118"></a>00118 
<a name="l00119"></a><a class="code" href="a00031.html#ac71d8a4e2847ef13524ec70ed9f5d7d4">00119</a> Solutions at <a class="code" href="a00031.html#ac71d8a4e2847ef13524ec70ed9f5d7d4">t</a>=0,0.5,1: The following figure is obtained 
<a name="l00120"></a>00120 <a class="code" href="a00032.html#a124150da8eed3d9f42e9361cc143ed7e">by</a> plotting \a op_00000.dat (initial), \a op_00005.dat (t=0.5),
<a name="l00121"></a>00121 and \a op_00010.dat (<span class="keyword">final</span>). 
<a name="l00122"></a>00122 @image html Solution_1DLinearAdvSine.png
<a name="l00123"></a>00123 
<a name="l00124"></a>00124 Since the exact solution is available at the <span class="keyword">final</span> time 
<a name="l00125"></a>00125 (\a exact.inp is a <a class="code" href="a00063.html#af77238a13603775a1f60ae9206d86600">copy</a> of \a initial.inp), the numerical 
<a name="l00126"></a><a class="code" href="a00031.html#a33ca5fac0002baea0232773cd8578277">00126</a> errors are calculated and reported on <a class="code" href="a00031.html#a33ca5fac0002baea0232773cd8578277">screen</a> (see below)
<a name="l00127"></a>00127 as well as \b errors.dat:
<a name="l00128"></a>00128 \include 1D/LinearAdvection/SineWave/errors.dat
<a name="l00129"></a>00129 The numbers are: number of grid points (#<a class="code" href="a00015.html#aa989ebb755986852177779cdf7bd8c85">HyPar::dim_global</a>), 
<a name="l00130"></a>00130 number of processors (#<a class="code" href="a00019.html#a0be0f30a83bc3f3d9f6ee3a36bbf2716">MPIVariables::iproc</a>),
<a name="l00131"></a>00131 time step size (#<a class="code" href="a00015.html#a03e28be41881b703c836edbfe9b51b17">HyPar::dt</a>),
<a name="l00132"></a>00132 L1, L2, and L-infinity errors (#<a class="code" href="a00015.html#aa40f27cb2afa2db0f0468962be8b3679">HyPar::error</a>),
<a name="l00133"></a>00133 solver wall time (seconds) (i.e., not accounting <span class="keywordflow">for</span> initialization,
<a name="l00134"></a>00134 and cleaning up),
<a name="l00135"></a>00135 and total wall time.
<a name="l00136"></a>00136 
<a name="l00137"></a>00137 Since #<a class="code" href="a00015.html#ac92c34fe456d92c694eacd2231f5a7b1">HyPar::ConservationCheck</a> is <span class="keyword">set</span> to \a yes in \b solver.inp,
<a name="l00138"></a>00138 the code checks <span class="keywordflow">for</span> conservation error and prints it to <a class="code" href="a00031.html#a33ca5fac0002baea0232773cd8578277">screen</a>, as well
<a name="l00139"></a>00139 as the file \b conservation.dat:
<a name="l00140"></a>00140 \include 1D/LinearAdvection/SineWave/conservation.dat
<a name="l00141"></a>00141 The numbers are: number of grid points (#<a class="code" href="a00015.html#aa989ebb755986852177779cdf7bd8c85">HyPar::dim_global</a>),
<a name="l00142"></a>00142 number of processors (#<a class="code" href="a00019.html#a0be0f30a83bc3f3d9f6ee3a36bbf2716">MPIVariables::iproc</a>),
<a name="l00143"></a>00143 time step size (#<a class="code" href="a00015.html#a03e28be41881b703c836edbfe9b51b17">HyPar::dt</a>),
<a name="l00144"></a>00144 and conservation error (#<a class="code" href="a00015.html#a965363cd64ce50ae17705dfb285dd0ab">HyPar::ConservationError</a>).
<a name="l00145"></a>00145 
<a name="l00146"></a>00146 Expected screen output:
<a name="l00147"></a>00147 \include 1D/LinearAdvection/SineWave/output.log
<a name="l00148"></a>00148 
<a name="l00149"></a>00149 
<a name="l00150"></a>00150 \<a class="code" href="a00032.html#a23a77f360d9ab0a90b11ff01314b6526">page</a> linear_adv_disc 1D Linear Advection - Discontinuous Waves
<a name="l00151"></a>00151 
<a name="l00152"></a>00152 <a class="code" href="a00031.html#af7342acc7b7299a81e83b43ed11b9f84">Location</a>: \b hypar/<a class="code" href="a00031.html#a60f502575a2e782807ea78c05f76ae03">Examples</a>/1D/LinearAdvection/DiscontinuousWaves
<a name="l00153"></a>00153           (This directory contains all the input files needed
<a name="l00154"></a>00154           to run <span class="keyword">this</span> <span class="keywordflow">case</span>. If there is a \a Run.m, run it in
<a name="l00155"></a>00155           MATLAB to quickly <span class="keyword">set</span> up, run, and visualize the 
<a name="l00156"></a>00156           <a class="code" href="a00032.html#aff6369b7fb5859bb002145c1c010f831">example</a>).
<a name="l00157"></a>00157 
<a name="l00158"></a>00158 Governing <a class="code" href="a00031.html#a6e2d32e81b7ad98679f4247b1488afa6">equations</a>: 1D Linear Advection Equation (linearadr.h)
<a name="l00159"></a>00159 
<a name="l00160"></a>00160 References:
<a name="l00161"></a>00161   + Ghosh, D., Baeder, J. D., &quot;Compact Reconstruction Schemes with 
<a name="l00162"></a>00162     Weighted ENO Limiting for Hyperbolic Conservation Laws&quot;, 
<a name="l00163"></a>00163     SIAM Journal on Scientific Computing, 34 (3), 2012, A1678–A1706
<a name="l00164"></a>00164 
<a name="l00165"></a>00165 <a class="code" href="a00031.html#a948095327123305f3fdf2b293b55381e">Domain</a>: \f$-1 \le x \le 1\f$, \a &quot;periodic&quot; (<span class="preprocessor">#_PERIODIC_)</span>
<a name="l00166"></a>00166 <span class="preprocessor"></span>        boundary <a class="code" href="a00063.html#a07bca284db2938db7ad469438892ca47">conditions</a>
<a name="l00167"></a>00167 
<a name="l00168"></a>00168 Initial solution:
<a name="l00169"></a>00169   \f{<a class="code" href="a00033.html#ac3f62e1b06188678336543688cb7709e">equation</a>}{
<a name="l00170"></a>00170     u\left(x,0\right) = \left\{\begin{array}{lc} 
<a name="l00171"></a>00171                           \exp\left(-\log\left(2\right)\frac{\left(x+7\right)^2}{0.0009}\right) &amp; -0.8\le x \le -0.6 \\
<a name="l00172"></a>00172                           1 &amp; -0.4\le x \le -0.2 \\
<a name="l00173"></a>00173                           1 - \left|10\left(x-0.1\right)\right| &amp; 0\le x \le 0.2 \\
<a name="l00174"></a>00174                           \sqrt{1-100\left(x-0.5\right)^2} &amp; 0.4\le x \le 0.6 \\
<a name="l00175"></a>00175                           0 &amp; {\rm otherwise}
<a name="l00176"></a>00176                         \end{array}\right.
<a name="l00177"></a>00177   \f}
<a name="l00178"></a>00178 
<a name="l00179"></a>00179 Numerical <a class="code" href="a00033.html#a1610bc0f5a3c1062419d67e161327d37">Method</a>:
<a name="l00180"></a>00180  + Spatial <a class="code" href="a00033.html#a006f5ed6c12ae3d4f8e840cb181a05ca">discretization</a> (hyperbolic): 5th order CRWENO (<a class="code" href="a00041.html#a33b1e24c12129941b0027a83c543a654" title="5th order CRWENO reconstruction (component-wise) on a uniform grid">Interp1PrimFifthOrderCRWENO</a>())
<a name="l00181"></a>00181  + Time integration: SSPRK3 (<a class="code" href="a00061.html#aca6ebec6e6998f0c509bb38fa91f3321">TimeRK</a>(), #<a class="code" href="a00061.html#a97e67bb275d6a2dad40b184579559f82">_RK_SSP3_</a>)
<a name="l00182"></a>00182 
<a name="l00183"></a>00183 Input files <a class="code" href="a00032.html#af7a1b4a66a5b6f9ac8eebf2c23b51e9e">required</a>:
<a name="l00184"></a>00184 ---------------------
<a name="l00185"></a>00185 
<a name="l00186"></a>00186 \b solver.inp
<a name="l00187"></a>00187 \include 1D/LinearAdvection/DiscontinuousWaves/solver.inp
<a name="l00188"></a>00188 
<a name="l00189"></a>00189 \b boundary.inp
<a name="l00190"></a>00190 \include 1D/LinearAdvection/DiscontinuousWaves/boundary.inp
<a name="l00191"></a>00191 
<a name="l00192"></a>00192 \b physics.inp
<a name="l00193"></a>00193 \include 1D/LinearAdvection/DiscontinuousWaves/physics.inp
<a name="l00194"></a>00194 
<a name="l00195"></a>00195 \b lusolver.inp (optional)
<a name="l00196"></a>00196 \include 1D/LinearAdvection/DiscontinuousWaves/lusolver.inp
<a name="l00197"></a>00197 
<a name="l00198"></a>00198 \b weno.inp (optional)
<a name="l00199"></a>00199 \include 1D/LinearAdvection/DiscontinuousWaves/weno.inp
<a name="l00200"></a>00200 
<a name="l00201"></a>00201 To generate \b initial.inp, compile and run the 
<a name="l00202"></a>00202 following code in the run directory. \b <a class="code" href="a00032.html#a86616b1951d3af95df5b7115dd30438f">Note</a>: if the
<a name="l00203"></a>00203 final time is an integer multiple of the time period,
<a name="l00204"></a>00204 the file \b initial.inp can also be <a class="code" href="a00032.html#aa2f9253c1a63124e53d64db71f7e7c16">used</a> as the exact
<a name="l00205"></a>00205 solution \b exact.inp (i.<a class="code" href="a00032.html#a35b3e91c83139b35bbacfaa59a58afd1">e</a>. create a sym link called 
<a name="l00206"></a>00206 \a exact.inp pointing to \a initial.inp, or just <a class="code" href="a00063.html#af77238a13603775a1f60ae9206d86600">copy</a>
<a name="l00207"></a>00207 \a initial.inp to \a exact.inp).
<a name="l00208"></a>00208 \include 1D/LinearAdvection/DiscontinuousWaves/aux/init.c
<a name="l00209"></a>00209 
<a name="l00210"></a>00210 Output:
<a name="l00211"></a>00211 -------
<a name="l00212"></a>00212 After running the code, there should be two solution output
<a name="l00213"></a>00213 files \b op_00000.<a class="code" href="a00031.html#a96b9dfbebc4ecd57a32426075fb0c3f2">dat</a> and \b op_00001.<a class="code" href="a00031.html#a96b9dfbebc4ecd57a32426075fb0c3f2">dat</a>; the first one is
<a name="l00214"></a>00214 the initial solution, and the latter is the <span class="keyword">final</span> solution.
<a name="l00215"></a>00215 Both these files are ASCII <a class="code" href="a00031.html#a314f90bacf496961ff4bfef89fea32c0">text</a> (#<a class="code" href="a00015.html#a51a3b8c19b86e9e1df5be02b05a6613c">HyPar::op_file_format</a> is
<a name="l00216"></a>00216 <span class="keyword">set</span> to \a <a class="code" href="a00031.html#a314f90bacf496961ff4bfef89fea32c0">text</a> in \b solver.inp).
<a name="l00217"></a>00217 
<a name="l00218"></a>00218 Final solution at t=2.0: The following figure is obtained 
<a name="l00219"></a>00219 <a class="code" href="a00032.html#a124150da8eed3d9f42e9361cc143ed7e">by</a> plotting \a op_00000.dat (initial) and \a op_00001.dat
<a name="l00220"></a>00220 (<span class="keyword">final</span>). In both these files, the first column is grid 
<a name="l00221"></a>00221 index, the second column is x-coordinate, and the third 
<a name="l00222"></a>00222 column is the solution.
<a name="l00223"></a>00223 @image html Solution_1DLinearAdvDisc.png
<a name="l00224"></a>00224 
<a name="l00225"></a>00225 Expected screen output:
<a name="l00226"></a>00226 \include 1D/LinearAdvection/DiscontinuousWaves/output.log
<a name="l00227"></a>00227 
<a name="l00228"></a>00228 \<a class="code" href="a00032.html#a23a77f360d9ab0a90b11ff01314b6526">page</a> linear_diff_sine 1D Linear Diffusion - Sine Wave
<a name="l00229"></a>00229 
<a name="l00230"></a>00230 <a class="code" href="a00031.html#af7342acc7b7299a81e83b43ed11b9f84">Location</a>: \b hypar/<a class="code" href="a00031.html#a60f502575a2e782807ea78c05f76ae03">Examples</a>/1D/LinearDiffusion/SineWave
<a name="l00231"></a>00231           (This directory contains all the input files needed
<a name="l00232"></a>00232           to run <span class="keyword">this</span> <span class="keywordflow">case</span>. If there is a \a Run.m, run it in
<a name="l00233"></a>00233           MATLAB to quickly <span class="keyword">set</span> up, run, and visualize the 
<a name="l00234"></a>00234           <a class="code" href="a00032.html#aff6369b7fb5859bb002145c1c010f831">example</a>).
<a name="l00235"></a>00235 
<a name="l00236"></a>00236 Governing <a class="code" href="a00031.html#a6e2d32e81b7ad98679f4247b1488afa6">equations</a>: 1D Linear Diffusion Equation (linearadr.h)
<a name="l00237"></a>00237 
<a name="l00238"></a>00238 <a class="code" href="a00031.html#a948095327123305f3fdf2b293b55381e">Domain</a>: \f$0 \le x &lt; 1\f$, \a &quot;periodic&quot; (<span class="preprocessor">#_PERIODIC_) </span>
<a name="l00239"></a>00239 <span class="preprocessor"></span>        boundary <a class="code" href="a00063.html#a07bca284db2938db7ad469438892ca47">conditions</a>
<a name="l00240"></a>00240 
<a name="l00241"></a>00241 Initial solution: \f$u\left(x,0\right) = \sin\left(2\pi x\right)\f$
<a name="l00242"></a>00242 
<a name="l00243"></a>00243 Numerical <a class="code" href="a00033.html#a1610bc0f5a3c1062419d67e161327d37">Method</a>:
<a name="l00244"></a>00244   + Spatial <a class="code" href="a00033.html#a006f5ed6c12ae3d4f8e840cb181a05ca">discretization</a> (parabolic): 2nd order (<a class="code" href="a00041.html#ae8bfe856abd743f5af925dc03e708ee3" title="2nd order component-wise interpolation of the 2nd primitive on a uniform grid">Interp2PrimSecondOrder</a>()),
<a name="l00245"></a>00245                                         conservative (<a class="code" href="a00033.html#a62d59663e168051efcb7306776473ecb">ParabolicFunctionCons1Stage</a>())
<a name="l00246"></a>00246   + Time integration: SSPRK3 (<a class="code" href="a00061.html#aca6ebec6e6998f0c509bb38fa91f3321">TimeRK</a>(), #<a class="code" href="a00061.html#a97e67bb275d6a2dad40b184579559f82">_RK_SSP3_</a>)
<a name="l00247"></a>00247 
<a name="l00248"></a>00248 Input files <a class="code" href="a00032.html#af7a1b4a66a5b6f9ac8eebf2c23b51e9e">required</a>:
<a name="l00249"></a>00249 ---------------------
<a name="l00250"></a>00250 
<a name="l00251"></a>00251 \b solver.inp
<a name="l00252"></a>00252 \include 1D/LinearDiffusion/SineWave/solver.inp
<a name="l00253"></a>00253 
<a name="l00254"></a>00254 \b boundary.inp
<a name="l00255"></a>00255 \include 1D/LinearDiffusion/SineWave/boundary.inp
<a name="l00256"></a>00256 
<a name="l00257"></a>00257 \b physics.inp
<a name="l00258"></a>00258 \include 1D/LinearDiffusion/SineWave/physics.inp
<a name="l00259"></a>00259 
<a name="l00260"></a>00260 To generate \b initial.inp (initial solution) and 
<a name="l00261"></a>00261 \b exact.inp (exact solution), compile and run the 
<a name="l00262"></a>00262 following code in the run directory. 
<a name="l00263"></a>00263 \include 1D/LinearDiffusion/SineWave/aux/exact.c
<a name="l00264"></a>00264 
<a name="l00265"></a>00265 Output:
<a name="l00266"></a>00266 -------
<a name="l00267"></a>00267 After running the code, there should be 11 output
<a name="l00268"></a>00268 files \b op_00000.<a class="code" href="a00031.html#a96b9dfbebc4ecd57a32426075fb0c3f2">dat</a>, \b op_00001.<a class="code" href="a00031.html#a96b9dfbebc4ecd57a32426075fb0c3f2">dat</a>, ... \b op_00010.<a class="code" href="a00031.html#a96b9dfbebc4ecd57a32426075fb0c3f2">dat</a>; 
<a name="l00269"></a>00269 the first one is the solution at \f$t=0\f$ and the <span class="keyword">final</span> one
<a name="l00270"></a>00270 is the solution at \f$t=10\f$. Since #<a class="code" href="a00015.html#a4e93cb107e180ef982b74cef7726b70f">HyPar::op_overwrite</a> is
<a name="l00271"></a>00271 <span class="keyword">set</span> to \a no in \b solver.inp, separate files are written
<a name="l00272"></a>00272 <span class="keywordflow">for</span> solutions at each output time. All the files are ASCII 
<a name="l00273"></a>00273 <a class="code" href="a00031.html#a314f90bacf496961ff4bfef89fea32c0">text</a> (#<a class="code" href="a00015.html#a51a3b8c19b86e9e1df5be02b05a6613c">HyPar::op_file_format</a> is <span class="keyword">set</span> to \a <a class="code" href="a00031.html#a314f90bacf496961ff4bfef89fea32c0">text</a> in \b solver.inp).
<a name="l00274"></a>00274 In these files, the first column is grid index, the second column 
<a name="l00275"></a>00275 is x-coordinate, and the third column is the solution.
<a name="l00276"></a>00276 
<a name="l00277"></a>00277 Solutions at t=0,2,4,6,8,10: The following figure is obtained 
<a name="l00278"></a>00278 <a class="code" href="a00032.html#a124150da8eed3d9f42e9361cc143ed7e">by</a> plotting \a op_00000.dat (t=0, initial), \a op_00002.dat (t=2),
<a name="l00279"></a>00279 \a op_00004.dat (t=4), \a op_00006.dat (t=6), \a op_00008.dat 
<a name="l00280"></a>00280 (t=8) and \a op_00010.dat (t=10, <span class="keyword">final</span>). 
<a name="l00281"></a>00281 @image html Solution_1DLinearDiffSine.png
<a name="l00282"></a>00282 
<a name="l00283"></a>00283 Since the exact solution is available at the <span class="keyword">final</span> time 
<a name="l00284"></a>00284 , the numerical 
<a name="l00285"></a>00285 errors are calculated and reported on <a class="code" href="a00031.html#a33ca5fac0002baea0232773cd8578277">screen</a> (see below)
<a name="l00286"></a>00286 as well as \b errors.dat:
<a name="l00287"></a>00287 \include 1D/LinearDiffusion/SineWave/errors.dat
<a name="l00288"></a>00288 The numbers are: number of grid points (#<a class="code" href="a00015.html#aa989ebb755986852177779cdf7bd8c85">HyPar::dim_global</a>), 
<a name="l00289"></a>00289 number of processors (#<a class="code" href="a00019.html#a0be0f30a83bc3f3d9f6ee3a36bbf2716">MPIVariables::iproc</a>),
<a name="l00290"></a>00290 time step size (#<a class="code" href="a00015.html#a03e28be41881b703c836edbfe9b51b17">HyPar::dt</a>),
<a name="l00291"></a>00291 L1, L2, and L-infinity errors (#<a class="code" href="a00015.html#aa40f27cb2afa2db0f0468962be8b3679">HyPar::error</a>),
<a name="l00292"></a>00292 solver wall time (seconds) (i.e., not accounting <span class="keywordflow">for</span> initialization,
<a name="l00293"></a>00293 and cleaning up),
<a name="l00294"></a>00294 and total wall time.
<a name="l00295"></a>00295 
<a name="l00296"></a>00296 Expected screen output:
<a name="l00297"></a>00297 \include 1D/LinearDiffusion/SineWave/output.log
<a name="l00298"></a>00298 
<a name="l00299"></a>00299 
<a name="l00300"></a>00300 
<a name="l00301"></a>00301 \<a class="code" href="a00032.html#a23a77f360d9ab0a90b11ff01314b6526">page</a> sod_shock_tube 1D Euler Equations - Sod Shock Tube
<a name="l00302"></a>00302 
<a name="l00303"></a>00303 <a class="code" href="a00032.html#a591948d4155a6a69747cfda925ae1cb4">Description</a>: 
<a name="l00304"></a>00304 -------------------
<a name="l00305"></a>00305 
<a name="l00306"></a>00306 <a class="code" href="a00031.html#af7342acc7b7299a81e83b43ed11b9f84">Location</a>: \b hypar/<a class="code" href="a00031.html#a60f502575a2e782807ea78c05f76ae03">Examples</a>/1D/<a class="code" href="a00005.html" title="Structure containing variables and parameters specific to the 1D Euler equations...">Euler1D</a>/SodShockTube 
<a name="l00307"></a>00307           (This directory contains all the input files needed
<a name="l00308"></a>00308           to run <span class="keyword">this</span> <span class="keywordflow">case</span>. If there is a \a Run.m, run it in
<a name="l00309"></a>00309           MATLAB to quickly <span class="keyword">set</span> up, run, and visualize the 
<a name="l00310"></a>00310           <a class="code" href="a00032.html#aff6369b7fb5859bb002145c1c010f831">example</a>).
<a name="l00311"></a>00311 
<a name="l00312"></a>00312 Governing <a class="code" href="a00031.html#a6e2d32e81b7ad98679f4247b1488afa6">equations</a>: 1D Euler <a class="code" href="a00031.html#a6e2d32e81b7ad98679f4247b1488afa6">equations</a> (euler1d.h)
<a name="l00313"></a>00313 
<a name="l00314"></a>00314 References: 
<a name="l00315"></a>00315   + G.A. Sod, &quot;A survey of several finite difference methods 
<a name="l00316"></a>00316     for systems of nonlinear hyperbolic conservation laws,&quot; 
<a name="l00317"></a>00317     J. Comput. Phys., 27, 1 (1978).
<a name="l00318"></a>00318   + C. B. Laney, &quot;Computational Gasdynamics&quot;, Cambridge 
<a name="l00319"></a>00319     University Press, 1998.
<a name="l00320"></a>00320 
<a name="l00321"></a>00321 <a class="code" href="a00031.html#a948095327123305f3fdf2b293b55381e">Domain</a>: \f$0 \le x \le 1.0\f$, \a &quot;extrapolate&quot; (<span class="preprocessor">#_EXTRAPOLATE_) </span>
<a name="l00322"></a>00322 <span class="preprocessor"></span>        boundary <a class="code" href="a00063.html#a07bca284db2938db7ad469438892ca47">conditions</a>
<a name="l00323"></a>00323 
<a name="l00324"></a>00324 Initial Solution:
<a name="l00325"></a>00325   + \f$ 0 \le x &lt; 0.5\f$: \f$\rho = 1, u = 0, p = 1\f$
<a name="l00326"></a>00326   + \f$ 0.5 \le x \le 1\f$: \f$\rho = 0.125, u = 0, p = 0.1\f$
<a name="l00327"></a>00327 
<a name="l00328"></a>00328 Numerical <a class="code" href="a00033.html#a1610bc0f5a3c1062419d67e161327d37">Method</a>:
<a name="l00329"></a>00329  + Spatial <a class="code" href="a00033.html#a006f5ed6c12ae3d4f8e840cb181a05ca">discretization</a> (hyperbolic): Characteristic-based 5th order WENO (<a class="code" href="a00041.html#abf3b032fdc8c0e84b86909db9e0b93c3" title="5th order WENO reconstruction (characteristic-based) on a uniform grid">Interp1PrimFifthOrderWENOChar</a>())
<a name="l00330"></a>00330  + Time integration: RK4 (<a class="code" href="a00061.html#aca6ebec6e6998f0c509bb38fa91f3321">TimeRK</a>(), #<a class="code" href="a00061.html#a47de987716954223b3c26bb842b21bf8">_RK_44_</a>)
<a name="l00331"></a>00331 
<a name="l00332"></a>00332 Input files <a class="code" href="a00032.html#af7a1b4a66a5b6f9ac8eebf2c23b51e9e">required</a>:
<a name="l00333"></a>00333 --------------------
<a name="l00334"></a>00334 \b solver.inp:
<a name="l00335"></a>00335 \include 1D/<a class="code" href="a00005.html" title="Structure containing variables and parameters specific to the 1D Euler equations...">Euler1D</a>/SodShockTube/solver.inp
<a name="l00336"></a>00336 
<a name="l00337"></a>00337 \b boundary.inp
<a name="l00338"></a>00338 \include 1D/<a class="code" href="a00005.html" title="Structure containing variables and parameters specific to the 1D Euler equations...">Euler1D</a>/SodShockTube/boundary.inp
<a name="l00339"></a>00339 
<a name="l00340"></a>00340 \b physics.inp
<a name="l00341"></a>00341 \include 1D/<a class="code" href="a00005.html" title="Structure containing variables and parameters specific to the 1D Euler equations...">Euler1D</a>/SodShockTube/physics.inp
<a name="l00342"></a>00342 
<a name="l00343"></a>00343 To generate \b initial.inp, compile and run the 
<a name="l00344"></a>00344 following code in the run directory:
<a name="l00345"></a>00345 \include 1D/<a class="code" href="a00005.html" title="Structure containing variables and parameters specific to the 1D Euler equations...">Euler1D</a>/SodShockTube/aux/init.c
<a name="l00346"></a>00346 
<a name="l00347"></a>00347 Output:
<a name="l00348"></a>00348 -------
<a name="l00349"></a>00349 After running the code, there should be two solution output
<a name="l00350"></a>00350 files \b op_00000.<a class="code" href="a00031.html#a96b9dfbebc4ecd57a32426075fb0c3f2">dat</a> and \b op_00001.<a class="code" href="a00031.html#a96b9dfbebc4ecd57a32426075fb0c3f2">dat</a>; the first one is
<a name="l00351"></a>00351 the initial solution, and the latter is the <span class="keyword">final</span> solution.
<a name="l00352"></a>00352 Both these files are ASCII <a class="code" href="a00031.html#a314f90bacf496961ff4bfef89fea32c0">text</a> (#<a class="code" href="a00015.html#a51a3b8c19b86e9e1df5be02b05a6613c">HyPar::op_file_format</a> is
<a name="l00353"></a>00353 <span class="keyword">set</span> to \a <a class="code" href="a00031.html#a314f90bacf496961ff4bfef89fea32c0">text</a> in \b solver.inp).
<a name="l00354"></a>00354 In these files, the first column is grid index, the second 
<a name="l00355"></a>00355 column is x-coordinate, and the remaining columns are the 
<a name="l00356"></a>00356 solution components.
<a name="l00357"></a>00357 
<a name="l00358"></a>00358 Final solution at t=0.2: The following figure is obtained 
<a name="l00359"></a>00359 <a class="code" href="a00032.html#a124150da8eed3d9f42e9361cc143ed7e">by</a> plotting \a op_00001.dat. <a class="code" href="a00032.html#a86616b1951d3af95df5b7115dd30438f">Note</a> that the output is in
<a name="l00360"></a>00360 <a class="code" href="a00064.html#a0bc2e5eea004e13e7e0d14dc8493fa5f">terms</a> of the conserved variables, <a class="code" href="a00063.html#aa012087f27f6c70b31284d8d3fb32dc5">so</a> they have to converted
<a name="l00361"></a>00361 to the primitive variables (density, <a class="code" href="a00032.html#a19f4bd496612921d5231e400a3c27ed4">velocity</a>, and <a class="code" href="a00032.html#a58d87a94271c7f86a36fafc7117fe0b0">pressure</a>).
<a name="l00362"></a>00362 @image html Solution_1DSodShockTube.png
<a name="l00363"></a>00363 
<a name="l00364"></a>00364 Expected screen output:
<a name="l00365"></a>00365 \include 1D/<a class="code" href="a00005.html" title="Structure containing variables and parameters specific to the 1D Euler equations...">Euler1D</a>/SodShockTube/output.log
<a name="l00366"></a>00366 
<a name="l00367"></a>00367 \<a class="code" href="a00032.html#a23a77f360d9ab0a90b11ff01314b6526">page</a> lax_shock_tube 1D Euler Equations - Lax Shock Tube
<a name="l00368"></a>00368 
<a name="l00369"></a>00369 <a class="code" href="a00032.html#a591948d4155a6a69747cfda925ae1cb4">Description</a>: 
<a name="l00370"></a>00370 -------------------
<a name="l00371"></a>00371 
<a name="l00372"></a>00372 <a class="code" href="a00031.html#af7342acc7b7299a81e83b43ed11b9f84">Location</a>: \b hypar/<a class="code" href="a00031.html#a60f502575a2e782807ea78c05f76ae03">Examples</a>/1D/<a class="code" href="a00005.html" title="Structure containing variables and parameters specific to the 1D Euler equations...">Euler1D</a>/LaxShockTube 
<a name="l00373"></a>00373           (This directory contains all the input files needed
<a name="l00374"></a>00374           to run <span class="keyword">this</span> <span class="keywordflow">case</span>. If there is a \a Run.m, run it in
<a name="l00375"></a>00375           MATLAB to quickly <span class="keyword">set</span> up, run, and visualize the 
<a name="l00376"></a>00376           example).
<a name="l00377"></a>00377 
<a name="l00378"></a>00378 Governing <a class="code" href="a00031.html#a6e2d32e81b7ad98679f4247b1488afa6">equations</a>: 1D Euler <a class="code" href="a00031.html#a6e2d32e81b7ad98679f4247b1488afa6">equations</a> (euler1d.h)
<a name="l00379"></a>00379 
<a name="l00380"></a>00380 References: 
<a name="l00381"></a>00381   + P.D. Lax, &quot;Weak solutions of nonlinear hyperbolic
<a name="l00382"></a>00382     <a class="code" href="a00031.html#a6e2d32e81b7ad98679f4247b1488afa6">equations</a> and their numerical computation,&quot; Comm.
<a name="l00383"></a>00383     Pure App. Math., 7, 159 (1954).
<a name="l00384"></a>00384   + C. B. Laney, &quot;Computational Gasdynamics&quot;, Cambridge 
<a name="l00385"></a>00385     University Press, 1998.
<a name="l00386"></a>00386 
<a name="l00387"></a>00387 <a class="code" href="a00031.html#a948095327123305f3fdf2b293b55381e">Domain</a>: \f$0 \le x \le 1.0\f$, \a &quot;extrapolate&quot; (<span class="preprocessor">#_EXTRAPOLATE_) </span>
<a name="l00388"></a>00388 <span class="preprocessor"></span>        boundary <a class="code" href="a00063.html#a07bca284db2938db7ad469438892ca47">conditions</a>
<a name="l00389"></a>00389 
<a name="l00390"></a>00390 Initial Solution:
<a name="l00391"></a>00391   + \f$ 0 \le x &lt; 0.5\f$: \f$\rho = 0.445, \rho u = 0.311, <a class="code" href="a00032.html#a35b3e91c83139b35bbacfaa59a58afd1">e</a> = 8.928\f$
<a name="l00392"></a>00392   + \f$ 0.5 \le x \le 1\f$: \f$\rho = 0.5, \rho u = 0, <a class="code" href="a00032.html#a35b3e91c83139b35bbacfaa59a58afd1">e</a> = 1.4275\f$
<a name="l00393"></a>00393 
<a name="l00394"></a>00394 Numerical <a class="code" href="a00033.html#a1610bc0f5a3c1062419d67e161327d37">Method</a>:
<a name="l00395"></a>00395  + Spatial <a class="code" href="a00033.html#a006f5ed6c12ae3d4f8e840cb181a05ca">discretization</a> (hyperbolic): Characteristic-based 5th order WENO (<a class="code" href="a00041.html#abf3b032fdc8c0e84b86909db9e0b93c3" title="5th order WENO reconstruction (characteristic-based) on a uniform grid">Interp1PrimFifthOrderWENOChar</a>())
<a name="l00396"></a>00396  + Time integration: RK4 (<a class="code" href="a00061.html#aca6ebec6e6998f0c509bb38fa91f3321">TimeRK</a>(), #<a class="code" href="a00061.html#a47de987716954223b3c26bb842b21bf8">_RK_44_</a>)
<a name="l00397"></a>00397 
<a name="l00398"></a>00398 Input files <a class="code" href="a00032.html#af7a1b4a66a5b6f9ac8eebf2c23b51e9e">required</a>:
<a name="l00399"></a>00399 --------------------
<a name="l00400"></a>00400 \b solver.inp:
<a name="l00401"></a>00401 \include 1D/<a class="code" href="a00005.html" title="Structure containing variables and parameters specific to the 1D Euler equations...">Euler1D</a>/LaxShockTube/solver.inp
<a name="l00402"></a>00402 
<a name="l00403"></a>00403 \b boundary.inp
<a name="l00404"></a>00404 \include 1D/<a class="code" href="a00005.html" title="Structure containing variables and parameters specific to the 1D Euler equations...">Euler1D</a>/LaxShockTube/boundary.inp
<a name="l00405"></a>00405 
<a name="l00406"></a>00406 \b physics.inp
<a name="l00407"></a>00407 \include 1D/<a class="code" href="a00005.html" title="Structure containing variables and parameters specific to the 1D Euler equations...">Euler1D</a>/LaxShockTube/physics.inp
<a name="l00408"></a>00408 
<a name="l00409"></a>00409 \b weno.inp (optional)
<a name="l00410"></a>00410 \include 1D/<a class="code" href="a00005.html" title="Structure containing variables and parameters specific to the 1D Euler equations...">Euler1D</a>/LaxShockTube/weno.inp
<a name="l00411"></a>00411 
<a name="l00412"></a>00412 To generate \b initial.inp, compile and run the 
<a name="l00413"></a>00413 following code in the run directory:
<a name="l00414"></a>00414 \include 1D/<a class="code" href="a00005.html" title="Structure containing variables and parameters specific to the 1D Euler equations...">Euler1D</a>/LaxShockTube/aux/init.c
<a name="l00415"></a>00415 
<a name="l00416"></a>00416 Output:
<a name="l00417"></a>00417 -------
<a name="l00418"></a>00418 <a class="code" href="a00032.html#a86616b1951d3af95df5b7115dd30438f">Note</a> that \b iproc = 2 in \b solver.inp, <a class="code" href="a00063.html#aa012087f27f6c70b31284d8d3fb32dc5">so</a> run this with
<a name="l00419"></a>00419 2 MPI ranks (or change \b iproc to 1). After running the code, 
<a name="l00420"></a>00420 there should be two solution output files \b op_00000.<a class="code" href="a00031.html#a96b9dfbebc4ecd57a32426075fb0c3f2">dat</a> and 
<a name="l00421"></a>00421 \b op_00001.<a class="code" href="a00031.html#a96b9dfbebc4ecd57a32426075fb0c3f2">dat</a>; the first one is the initial solution, and the 
<a name="l00422"></a>00422 latter is the <span class="keyword">final</span> solution. Both these files are ASCII <a class="code" href="a00031.html#a314f90bacf496961ff4bfef89fea32c0">text</a> 
<a name="l00423"></a>00423 (#<a class="code" href="a00015.html#a51a3b8c19b86e9e1df5be02b05a6613c">HyPar::op_file_format</a> is <span class="keyword">set</span> to \a <a class="code" href="a00031.html#a314f90bacf496961ff4bfef89fea32c0">text</a> in \b solver.inp).
<a name="l00424"></a>00424 In these files, the first column is grid index, the second 
<a name="l00425"></a>00425 column is x-coordinate, and the remaining columns are the 
<a name="l00426"></a>00426 solution components.
<a name="l00427"></a>00427 
<a name="l00428"></a>00428 Final solution at t=0.08: The following figure is obtained 
<a name="l00429"></a>00429 <a class="code" href="a00032.html#a124150da8eed3d9f42e9361cc143ed7e">by</a> plotting \a op_00001.dat. <a class="code" href="a00032.html#a86616b1951d3af95df5b7115dd30438f">Note</a> that the output is in
<a name="l00430"></a>00430 <a class="code" href="a00064.html#a0bc2e5eea004e13e7e0d14dc8493fa5f">terms</a> of the conserved variables, <a class="code" href="a00063.html#aa012087f27f6c70b31284d8d3fb32dc5">so</a> they have to converted
<a name="l00431"></a>00431 to the primitive variables (density, <a class="code" href="a00032.html#a19f4bd496612921d5231e400a3c27ed4">velocity</a>, and <a class="code" href="a00032.html#a58d87a94271c7f86a36fafc7117fe0b0">pressure</a>).
<a name="l00432"></a>00432 @image html Solution_1DLaxShockTube.png
<a name="l00433"></a>00433 
<a name="l00434"></a>00434 Since #<a class="code" href="a00015.html#ac92c34fe456d92c694eacd2231f5a7b1">HyPar::ConservationCheck</a> is <span class="keyword">set</span> to \a yes in \b solver.inp,
<a name="l00435"></a>00435 the code checks <span class="keywordflow">for</span> conservation error and prints it to screen, as well
<a name="l00436"></a>00436 as the file \b conservation.dat:
<a name="l00437"></a>00437 \include 1D/<a class="code" href="a00005.html" title="Structure containing variables and parameters specific to the 1D Euler equations...">Euler1D</a>/LaxShockTube/conservation.dat
<a name="l00438"></a>00438 The numbers are: number of grid points (#<a class="code" href="a00015.html#aa989ebb755986852177779cdf7bd8c85">HyPar::dim_global</a>),
<a name="l00439"></a>00439 number of processors (#<a class="code" href="a00019.html#a0be0f30a83bc3f3d9f6ee3a36bbf2716">MPIVariables::iproc</a>),
<a name="l00440"></a>00440 time step size (#<a class="code" href="a00015.html#a03e28be41881b703c836edbfe9b51b17">HyPar::dt</a>),
<a name="l00441"></a>00441 and conservation error (#<a class="code" href="a00015.html#a965363cd64ce50ae17705dfb285dd0ab">HyPar::ConservationError</a>) for 
<a name="l00442"></a>00442 each component.
<a name="l00443"></a>00443 
<a name="l00444"></a>00444 Expected screen output:
<a name="l00445"></a>00445 \include 1D/<a class="code" href="a00005.html" title="Structure containing variables and parameters specific to the 1D Euler equations...">Euler1D</a>/LaxShockTube/output.log
<a name="l00446"></a>00446 
<a name="l00447"></a>00447 
<a name="l00448"></a>00448 \<a class="code" href="a00032.html#a23a77f360d9ab0a90b11ff01314b6526">page</a> shu_osher 1D Euler Equations - Shu-Osher Problem
<a name="l00449"></a>00449 
<a name="l00450"></a>00450 <a class="code" href="a00032.html#a591948d4155a6a69747cfda925ae1cb4">Description</a>: 
<a name="l00451"></a>00451 ------------
<a name="l00452"></a>00452 
<a name="l00453"></a>00453 <a class="code" href="a00031.html#af7342acc7b7299a81e83b43ed11b9f84">Location</a>: \b hypar/<a class="code" href="a00031.html#a60f502575a2e782807ea78c05f76ae03">Examples</a>/1D/<a class="code" href="a00005.html" title="Structure containing variables and parameters specific to the 1D Euler equations...">Euler1D</a>/ShuOsherProblem 
<a name="l00454"></a>00454           (This directory contains all the input files needed
<a name="l00455"></a>00455           to run this case. If there is a \a Run.m, run it in
<a name="l00456"></a>00456           MATLAB to quickly set up, run, and visualize the 
<a name="l00457"></a>00457           example).
<a name="l00458"></a>00458 
<a name="l00459"></a>00459 Governing <a class="code" href="a00031.html#a6e2d32e81b7ad98679f4247b1488afa6">equations</a>: 1D Euler <a class="code" href="a00031.html#a6e2d32e81b7ad98679f4247b1488afa6">equations</a> (euler1d.h)
<a name="l00460"></a>00460 
<a name="l00461"></a>00461 References: 
<a name="l00462"></a>00462   + C.-W. Shu and S. Osher, &quot;Efficient implementation of
<a name="l00463"></a>00463     essentially non-oscillatory schemes ,II,&quot; J. Comput.
<a name="l00464"></a>00464     Phys., 83 (1989), pp. 32–78
<a name="l00465"></a>00465 
<a name="l00466"></a>00466 <a class="code" href="a00031.html#a948095327123305f3fdf2b293b55381e">Domain</a>: \f$-5 \le x \le 5\f$, \a &quot;extrapolate&quot; (<span class="preprocessor">#_EXTRAPOLATE_) </span>
<a name="l00467"></a>00467 <span class="preprocessor"></span>        boundary <a class="code" href="a00063.html#a07bca284db2938db7ad469438892ca47">conditions</a>
<a name="l00468"></a>00468 
<a name="l00469"></a>00469 Initial Solution:
<a name="l00470"></a>00470   + \f$ -5 \le x &lt; -4\f$: \f$\rho = 27/7, u = 4\sqrt{35}/7, p = 31/3\f$
<a name="l00471"></a>00471   + \f$ -4 \le x \le 5\f$: \f$\rho = 1 + 0.2\sin\left(5x\right), u = 0, p = 1\f$
<a name="l00472"></a>00472 
<a name="l00473"></a>00473 Numerical <a class="code" href="a00033.html#a1610bc0f5a3c1062419d67e161327d37">Method</a>:
<a name="l00474"></a>00474  + Spatial <a class="code" href="a00033.html#a006f5ed6c12ae3d4f8e840cb181a05ca">discretization</a> (hyperbolic): Characteristic-based 5th order WENO (<a class="code" href="a00041.html#abf3b032fdc8c0e84b86909db9e0b93c3" title="5th order WENO reconstruction (characteristic-based) on a uniform grid">Interp1PrimFifthOrderWENOChar</a>())
<a name="l00475"></a>00475  + Time integration: RK4 (<a class="code" href="a00061.html#aca6ebec6e6998f0c509bb38fa91f3321">TimeRK</a>(), #<a class="code" href="a00061.html#a47de987716954223b3c26bb842b21bf8">_RK_44_</a>)
<a name="l00476"></a>00476 
<a name="l00477"></a>00477 Input files <a class="code" href="a00032.html#af7a1b4a66a5b6f9ac8eebf2c23b51e9e">required</a>:
<a name="l00478"></a>00478 --------------------
<a name="l00479"></a>00479 \b solver.inp:
<a name="l00480"></a>00480 \include 1D/<a class="code" href="a00005.html" title="Structure containing variables and parameters specific to the 1D Euler equations...">Euler1D</a>/ShuOsherProblem/solver.inp
<a name="l00481"></a>00481 
<a name="l00482"></a>00482 \b boundary.inp
<a name="l00483"></a>00483 \include 1D/<a class="code" href="a00005.html" title="Structure containing variables and parameters specific to the 1D Euler equations...">Euler1D</a>/ShuOsherProblem/boundary.inp
<a name="l00484"></a>00484 
<a name="l00485"></a>00485 \b physics.inp
<a name="l00486"></a>00486 \include 1D/<a class="code" href="a00005.html" title="Structure containing variables and parameters specific to the 1D Euler equations...">Euler1D</a>/ShuOsherProblem/physics.inp
<a name="l00487"></a>00487 
<a name="l00488"></a>00488 \b weno.inp (optional)
<a name="l00489"></a>00489 \include 1D/<a class="code" href="a00005.html" title="Structure containing variables and parameters specific to the 1D Euler equations...">Euler1D</a>/ShuOsherProblem/weno.inp
<a name="l00490"></a>00490 
<a name="l00491"></a>00491 To generate \b initial.inp, compile and run the 
<a name="l00492"></a>00492 following code in the run directory:
<a name="l00493"></a>00493 \include 1D/<a class="code" href="a00005.html" title="Structure containing variables and parameters specific to the 1D Euler equations...">Euler1D</a>/ShuOsherProblem/aux/init.c
<a name="l00494"></a>00494 
<a name="l00495"></a>00495 Output:
<a name="l00496"></a>00496 -------
<a name="l00497"></a>00497 After running the code, 
<a name="l00498"></a>00498 there should be two solution output files \b op_00000.<a class="code" href="a00031.html#a96b9dfbebc4ecd57a32426075fb0c3f2">dat</a> and 
<a name="l00499"></a>00499 \b op_00001.<a class="code" href="a00031.html#a96b9dfbebc4ecd57a32426075fb0c3f2">dat</a>; the first one is the initial solution, and the 
<a name="l00500"></a>00500 latter is the <span class="keyword">final</span> solution. Both these files are ASCII <a class="code" href="a00031.html#a314f90bacf496961ff4bfef89fea32c0">text</a> 
<a name="l00501"></a>00501 (#<a class="code" href="a00015.html#a51a3b8c19b86e9e1df5be02b05a6613c">HyPar::op_file_format</a> is <span class="keyword">set</span> to \a <a class="code" href="a00031.html#a314f90bacf496961ff4bfef89fea32c0">text</a> in \b solver.inp).
<a name="l00502"></a>00502 In these files, the first column is grid index, the second 
<a name="l00503"></a>00503 column is x-coordinate, and the remaining columns are the 
<a name="l00504"></a>00504 solution components.
<a name="l00505"></a>00505 
<a name="l00506"></a>00506 Final solution at t=1.8: The following figure is obtained 
<a name="l00507"></a>00507 <a class="code" href="a00032.html#a124150da8eed3d9f42e9361cc143ed7e">by</a> plotting \a op_00001.dat. <a class="code" href="a00032.html#a86616b1951d3af95df5b7115dd30438f">Note</a> that the output is in
<a name="l00508"></a>00508 <a class="code" href="a00064.html#a0bc2e5eea004e13e7e0d14dc8493fa5f">terms</a> of the conserved variables, <a class="code" href="a00063.html#aa012087f27f6c70b31284d8d3fb32dc5">so</a> they have to converted
<a name="l00509"></a>00509 to the primitive variables (density, <a class="code" href="a00032.html#a19f4bd496612921d5231e400a3c27ed4">velocity</a>, and <a class="code" href="a00032.html#a58d87a94271c7f86a36fafc7117fe0b0">pressure</a>).
<a name="l00510"></a>00510 @image html Solution_1DShuOsherProblem.png
<a name="l00511"></a>00511 
<a name="l00512"></a>00512 Since #<a class="code" href="a00015.html#ac92c34fe456d92c694eacd2231f5a7b1">HyPar::ConservationCheck</a> is <span class="keyword">set</span> to \a yes in \b solver.inp,
<a name="l00513"></a>00513 the code checks <span class="keywordflow">for</span> conservation error and prints it to screen, as well
<a name="l00514"></a>00514 as the file \b conservation.dat:
<a name="l00515"></a>00515 \include 1D/<a class="code" href="a00005.html" title="Structure containing variables and parameters specific to the 1D Euler equations...">Euler1D</a>/ShuOsherProblem/conservation.dat
<a name="l00516"></a>00516 The numbers are: number of grid points (#<a class="code" href="a00015.html#aa989ebb755986852177779cdf7bd8c85">HyPar::dim_global</a>),
<a name="l00517"></a>00517 number of processors (#<a class="code" href="a00019.html#a0be0f30a83bc3f3d9f6ee3a36bbf2716">MPIVariables::iproc</a>),
<a name="l00518"></a>00518 time step size (#<a class="code" href="a00015.html#a03e28be41881b703c836edbfe9b51b17">HyPar::dt</a>),
<a name="l00519"></a>00519 and conservation error (#<a class="code" href="a00015.html#a965363cd64ce50ae17705dfb285dd0ab">HyPar::ConservationError</a>) for 
<a name="l00520"></a>00520 each component.
<a name="l00521"></a>00521 
<a name="l00522"></a>00522 Expected screen output:
<a name="l00523"></a>00523 \include 1D/<a class="code" href="a00005.html" title="Structure containing variables and parameters specific to the 1D Euler equations...">Euler1D</a>/ShuOsherProblem/output.log
<a name="l00524"></a>00524 
<a name="l00525"></a>00525 
<a name="l00526"></a>00526 \<a class="code" href="a00032.html#a23a77f360d9ab0a90b11ff01314b6526">page</a> sod_shock_tube_wgrav 1D Euler Equations - Sod Shock Tube with Gravitational Force
<a name="l00527"></a>00527 
<a name="l00528"></a>00528 <a class="code" href="a00032.html#a591948d4155a6a69747cfda925ae1cb4">Description</a>: 
<a name="l00529"></a>00529 -------------------
<a name="l00530"></a>00530 
<a name="l00531"></a>00531 <a class="code" href="a00031.html#af7342acc7b7299a81e83b43ed11b9f84">Location</a>: \b hypar/<a class="code" href="a00031.html#a60f502575a2e782807ea78c05f76ae03">Examples</a>/1D/<a class="code" href="a00005.html" title="Structure containing variables and parameters specific to the 1D Euler equations...">Euler1D</a>/SodShockTubeWithGravity 
<a name="l00532"></a>00532           (This directory contains all the input files needed
<a name="l00533"></a>00533           to run this case. If there is a \a Run.m, run it in
<a name="l00534"></a>00534           MATLAB to quickly set up, run, and visualize the 
<a name="l00535"></a>00535           example).
<a name="l00536"></a>00536 
<a name="l00537"></a>00537 Governing <a class="code" href="a00031.html#a6e2d32e81b7ad98679f4247b1488afa6">equations</a>: 1D Euler <a class="code" href="a00031.html#a6e2d32e81b7ad98679f4247b1488afa6">equations</a> (euler1d.h)
<a name="l00538"></a>00538 
<a name="l00539"></a>00539 References: 
<a name="l00540"></a>00540   + Xing, Y., Shu, C.-W., &quot;High Order Well-Balanced WENO Scheme
<a name="l00541"></a>00541     for the Gas Dynamics Equations Under Gravitational Fields&quot;,
<a name="l00542"></a>00542     Journal of Scientific Computing, 54, 2013, pp. 645-662.
<a name="l00543"></a>00543 
<a name="l00544"></a>00544 <a class="code" href="a00031.html#a948095327123305f3fdf2b293b55381e">Domain</a>: \f$0 \le x \le 1.0\f$, \a &quot;slip-wall&quot; (<span class="preprocessor">#_SLIP_WALL_) </span>
<a name="l00545"></a>00545 <span class="preprocessor"></span>        boundary <a class="code" href="a00063.html#a07bca284db2938db7ad469438892ca47">conditions</a> (wall <a class="code" href="a00032.html#a19f4bd496612921d5231e400a3c27ed4">velocity</a> is zero), with 
<a name="l00546"></a>00546         \b uniform \b gravitational \b force \f$g=1\f$.
<a name="l00547"></a>00547 
<a name="l00548"></a>00548 Initial Solution:
<a name="l00549"></a>00549   + \f$ 0 \le x &lt; 0.5\f$: \f$\rho = 1, u = 0, p = 1\f$
<a name="l00550"></a>00550   + \f$ 0.5 \le x \le 1\f$: \f$\rho = 0.125, u = 0, p = 0.1\f$
<a name="l00551"></a>00551 
<a name="l00552"></a>00552 Numerical <a class="code" href="a00033.html#a1610bc0f5a3c1062419d67e161327d37">Method</a>:
<a name="l00553"></a>00553  + Spatial <a class="code" href="a00033.html#a006f5ed6c12ae3d4f8e840cb181a05ca">discretization</a> (hyperbolic): Characteristic-based 5th order CRWENO (<a class="code" href="a00041.html#ae2b27971cc952cf3b4959128bef6174b" title="5th order CRWENO reconstruction (characteristic-based) on a uniform grid">Interp1PrimFifthOrderCRWENOChar</a>())
<a name="l00554"></a>00554  + Time integration: RK4 (<a class="code" href="a00061.html#aca6ebec6e6998f0c509bb38fa91f3321">TimeRK</a>(), #<a class="code" href="a00061.html#a47de987716954223b3c26bb842b21bf8">_RK_44_</a>)
<a name="l00555"></a>00555 
<a name="l00556"></a>00556 Input files <a class="code" href="a00032.html#af7a1b4a66a5b6f9ac8eebf2c23b51e9e">required</a>:
<a name="l00557"></a>00557 --------------------
<a name="l00558"></a>00558 \b solver.inp:
<a name="l00559"></a>00559 \include 1D/<a class="code" href="a00005.html" title="Structure containing variables and parameters specific to the 1D Euler equations...">Euler1D</a>/SodShockTubeWithGravity/solver.inp
<a name="l00560"></a>00560 
<a name="l00561"></a>00561 \b boundary.inp
<a name="l00562"></a>00562 \include 1D/<a class="code" href="a00005.html" title="Structure containing variables and parameters specific to the 1D Euler equations...">Euler1D</a>/SodShockTubeWithGravity/boundary.inp
<a name="l00563"></a>00563 
<a name="l00564"></a>00564 \b physics.inp
<a name="l00565"></a>00565 \include 1D/<a class="code" href="a00005.html" title="Structure containing variables and parameters specific to the 1D Euler equations...">Euler1D</a>/SodShockTubeWithGravity/physics.inp
<a name="l00566"></a>00566 
<a name="l00567"></a>00567 To generate \b initial.inp, compile and run the 
<a name="l00568"></a>00568 following code in the run directory:
<a name="l00569"></a>00569 \include 1D/<a class="code" href="a00005.html" title="Structure containing variables and parameters specific to the 1D Euler equations...">Euler1D</a>/SodShockTubeWithGravity/aux/init.c
<a name="l00570"></a>00570 
<a name="l00571"></a>00571 Output:
<a name="l00572"></a>00572 -------
<a name="l00573"></a>00573 After running the code, there should be two solution output
<a name="l00574"></a>00574 files \b op_00000.<a class="code" href="a00031.html#a96b9dfbebc4ecd57a32426075fb0c3f2">dat</a> and \b op_00001.<a class="code" href="a00031.html#a96b9dfbebc4ecd57a32426075fb0c3f2">dat</a>; the first one is
<a name="l00575"></a>00575 the initial solution, and the latter is the <span class="keyword">final</span> solution.
<a name="l00576"></a>00576 Both these files are ASCII <a class="code" href="a00031.html#a314f90bacf496961ff4bfef89fea32c0">text</a> (#<a class="code" href="a00015.html#a51a3b8c19b86e9e1df5be02b05a6613c">HyPar::op_file_format</a> is
<a name="l00577"></a>00577 <span class="keyword">set</span> to \a <a class="code" href="a00031.html#a314f90bacf496961ff4bfef89fea32c0">text</a> in \b solver.inp).
<a name="l00578"></a>00578 In these files, the first column is grid index, the second 
<a name="l00579"></a>00579 column is x-coordinate, and the remaining columns are the 
<a name="l00580"></a>00580 solution components.
<a name="l00581"></a>00581 
<a name="l00582"></a>00582 Final solution at t=0.2: The following figure is obtained 
<a name="l00583"></a>00583 <a class="code" href="a00032.html#a124150da8eed3d9f42e9361cc143ed7e">by</a> plotting \a op_00001.dat. <a class="code" href="a00032.html#a86616b1951d3af95df5b7115dd30438f">Note</a> that the output is in
<a name="l00584"></a>00584 <a class="code" href="a00064.html#a0bc2e5eea004e13e7e0d14dc8493fa5f">terms</a> of the conserved variables, <a class="code" href="a00063.html#aa012087f27f6c70b31284d8d3fb32dc5">so</a> they have to converted
<a name="l00585"></a>00585 to the primitive variables (density, <a class="code" href="a00032.html#a19f4bd496612921d5231e400a3c27ed4">velocity</a>, and <a class="code" href="a00032.html#a58d87a94271c7f86a36fafc7117fe0b0">pressure</a>).
<a name="l00586"></a>00586 @image html Solution_1DSodShockTubeWithGravity.png
<a name="l00587"></a>00587 
<a name="l00588"></a>00588 Expected screen output:
<a name="l00589"></a>00589 \include 1D/<a class="code" href="a00005.html" title="Structure containing variables and parameters specific to the 1D Euler equations...">Euler1D</a>/SodShockTubeWithGravity/output.log
<a name="l00590"></a>00590 
<a name="l00591"></a>00591 \<a class="code" href="a00032.html#a23a77f360d9ab0a90b11ff01314b6526">page</a> sw_dambreak 1D Shallow Water Equations - Dam Breaking over Rectangular Bump
<a name="l00592"></a>00592 
<a name="l00593"></a>00593 <a class="code" href="a00031.html#af7342acc7b7299a81e83b43ed11b9f84">Location</a>: \b hypar/<a class="code" href="a00031.html#a60f502575a2e782807ea78c05f76ae03">Examples</a>/1D/<a class="code" href="a00026.html" title="Structure containing variables and parameters specific to the 1D Shallow Water equations...">ShallowWater1D</a>/DamBreakingRectangularBump
<a name="l00594"></a>00594           (This directory contains all the input files needed
<a name="l00595"></a>00595           to run <span class="keyword">this</span> <span class="keywordflow">case</span>. If there is a \a Run.m, run it in
<a name="l00596"></a>00596           MATLAB to quickly <span class="keyword">set</span> up, run, and visualize the 
<a name="l00597"></a>00597           example).
<a name="l00598"></a>00598 
<a name="l00599"></a>00599 Governing <a class="code" href="a00031.html#a6e2d32e81b7ad98679f4247b1488afa6">equations</a>: 1D Shallow Water Equations (shallowwater1d.h)
<a name="l00600"></a>00600 
<a name="l00601"></a>00601 References:
<a name="l00602"></a>00602   + Xing, Y., Shu, C.-W., &quot;High order finite difference WENO
<a name="l00603"></a>00603     schemes with the exact conservation property for the shallow
<a name="l00604"></a>00604     water <a class="code" href="a00031.html#a6e2d32e81b7ad98679f4247b1488afa6">equations</a>&quot;, Journal of Computational Physics, 208, 2005,
<a name="l00605"></a>00605     pp. 206-227 (section 4.4).
<a name="l00606"></a>00606 
<a name="l00607"></a>00607 <a class="code" href="a00031.html#a948095327123305f3fdf2b293b55381e">Domain</a>: \f$ 0 \le x \le 1500\f$, \a &quot;extrapolate&quot; (<span class="preprocessor">#_EXTRAPOLATE_)</span>
<a name="l00608"></a>00608 <span class="preprocessor"></span>        boundary <a class="code" href="a00063.html#a07bca284db2938db7ad469438892ca47">conditions</a>
<a name="l00609"></a>00609 
<a name="l00610"></a>00610 Initial solution:
<a name="l00611"></a>00611 \f{<a class="code" href="a00033.html#ac3f62e1b06188678336543688cb7709e">equation</a>}{
<a name="l00612"></a>00612   h\left(x\right) = \left\{\begin{array}{lc} 20 - b\left(x\right) &amp; x &lt;= 750 \\ 15 - b\left(x\right) &amp; {\rm otherwise}\end{array}\right., u\left(x\right) = 0
<a name="l00613"></a>00613 \f}
<a name="l00614"></a>00614 where \f$b\left(x\right) = \left\{\begin{array}{lc} 8 &amp; \left|x-750.0\right| \le 1500/8 \\  0 &amp; {\rm  otherwise} \end{array}\right.\f$ is the bottom topography.
<a name="l00615"></a>00615 
<a name="l00616"></a>00616 Numerical <a class="code" href="a00033.html#a1610bc0f5a3c1062419d67e161327d37">Method</a>:
<a name="l00617"></a>00617  + Spatial <a class="code" href="a00033.html#a006f5ed6c12ae3d4f8e840cb181a05ca">discretization</a> (hyperbolic): Characteristic-based 5th order WENO (<a class="code" href="a00041.html#abf3b032fdc8c0e84b86909db9e0b93c3" title="5th order WENO reconstruction (characteristic-based) on a uniform grid">Interp1PrimFifthOrderWENOChar</a>())
<a name="l00618"></a>00618  + Time integration: RK4 (<a class="code" href="a00061.html#aca6ebec6e6998f0c509bb38fa91f3321">TimeRK</a>(), #<a class="code" href="a00061.html#a47de987716954223b3c26bb842b21bf8">_RK_44_</a>)
<a name="l00619"></a>00619 
<a name="l00620"></a>00620 Input files <a class="code" href="a00032.html#af7a1b4a66a5b6f9ac8eebf2c23b51e9e">required</a>:
<a name="l00621"></a>00621 ---------------------
<a name="l00622"></a>00622 
<a name="l00623"></a>00623 <a class="code" href="a00032.html#a86616b1951d3af95df5b7115dd30438f">Note</a>: in <a class="code" href="a00032.html#acd2d71c0bebc6551f6d5d3c2870a9baa">addition</a> to the usual input files that <a class="code" href="a00015.html" title="Structure containing all solver-specific variables and functions.">HyPar</a> needs, this
<a name="l00624"></a>00624 physical <a class="code" href="a00033.html#ac4336de6d1835c2fc39662f53e2f6e2e">model</a> needs the following input file(s):
<a name="l00625"></a>00625 + \b topography.inp : file containing the bottom topography (same
<a name="l00626"></a>00626   format as \b initial.inp).
<a name="l00627"></a>00627 
<a name="l00628"></a>00628 \b solver.inp
<a name="l00629"></a>00629 \include 1D/<a class="code" href="a00026.html" title="Structure containing variables and parameters specific to the 1D Shallow Water equations...">ShallowWater1D</a>/DamBreakingRectangularBump/solver.inp
<a name="l00630"></a>00630 
<a name="l00631"></a>00631 \b boundary.inp
<a name="l00632"></a>00632 \include 1D/<a class="code" href="a00026.html" title="Structure containing variables and parameters specific to the 1D Shallow Water equations...">ShallowWater1D</a>/DamBreakingRectangularBump/boundary.inp
<a name="l00633"></a>00633 
<a name="l00634"></a>00634 \b physics.inp
<a name="l00635"></a>00635 \include 1D/<a class="code" href="a00026.html" title="Structure containing variables and parameters specific to the 1D Shallow Water equations...">ShallowWater1D</a>/DamBreakingRectangularBump/physics.inp
<a name="l00636"></a>00636 
<a name="l00637"></a>00637 \b weno.inp (optional)
<a name="l00638"></a>00638 \include 1D/<a class="code" href="a00026.html" title="Structure containing variables and parameters specific to the 1D Shallow Water equations...">ShallowWater1D</a>/DamBreakingRectangularBump/weno.inp
<a name="l00639"></a>00639 
<a name="l00640"></a>00640 To generate \b initial.inp and \b topography.inp, compile and run the 
<a name="l00641"></a>00641 following code in the run directory.
<a name="l00642"></a>00642 \include 1D/<a class="code" href="a00026.html" title="Structure containing variables and parameters specific to the 1D Shallow Water equations...">ShallowWater1D</a>/DamBreakingRectangularBump/aux/init.c
<a name="l00643"></a>00643 
<a name="l00644"></a>00644 Output:
<a name="l00645"></a>00645 -------
<a name="l00646"></a>00646 After running the code, there should be 5 solution output files
<a name="l00647"></a>00647 \b op_00000.<a class="code" href="a00031.html#a96b9dfbebc4ecd57a32426075fb0c3f2">dat</a>, ..., \b op_00004.<a class="code" href="a00031.html#a96b9dfbebc4ecd57a32426075fb0c3f2">dat</a>; the first one is the solution 
<a name="l00648"></a>00648 at \f$t=0\f$ and the <span class="keyword">final</span> one is the solution at \f$t=60\f$. Since
<a name="l00649"></a>00649 <span class="preprocessor">#HyPar::op_overwrite is set to \a no in \b solver.inp, separate files </span>
<a name="l00650"></a>00650 <span class="preprocessor"></span>are written <span class="keywordflow">for</span> solutions at each output time. All the files are ASCII
<a name="l00651"></a>00651 <a class="code" href="a00031.html#a314f90bacf496961ff4bfef89fea32c0">text</a> (#<a class="code" href="a00015.html#a51a3b8c19b86e9e1df5be02b05a6613c">HyPar::op_file_format</a> is <span class="keyword">set</span> to \a <a class="code" href="a00031.html#a314f90bacf496961ff4bfef89fea32c0">text</a> in \b solver.inp).
<a name="l00652"></a>00652 In these files, the first column is grid index, the second column 
<a name="l00653"></a>00653 is x-coordinate, and the third and fourth columns are the two 
<a name="l00654"></a>00654 solution components.
<a name="l00655"></a>00655 
<a name="l00656"></a>00656 In <a class="code" href="a00032.html#acd2d71c0bebc6551f6d5d3c2870a9baa">addition</a> to the usual output files, the shallow water physics 
<a name="l00657"></a>00657 module writes out the following files:
<a name="l00658"></a>00658 + \b topography_00000.dat, ..., \b topography_00004.dat: These files
<a name="l00659"></a>00659   share the same format as the solution output files \b op_*.dat 
<a name="l00660"></a>00660   and contains the topography \f$b\left(x\right)\f$.
<a name="l00661"></a>00661 
<a name="l00662"></a>00662 
<a name="l00663"></a>00663 Solutions at t=0,15,30,45,60: The following figure is obtained 
<a name="l00664"></a>00664 <a class="code" href="a00032.html#a124150da8eed3d9f42e9361cc143ed7e">by</a> plotting \a op_00000.dat (initial), \a op_00005.dat (t=0.5),
<a name="l00665"></a>00665 and \a op_00010.dat (<span class="keyword">final</span>). \b <a class="code" href="a00032.html#a86616b1951d3af95df5b7115dd30438f">Note</a>: the figure plots 
<a name="l00666"></a>00666 \f$h\left(x\right)+b\left(x\right)\f$, i.e., it adds the third
<a name="l00667"></a>00667 column in \b op_*.dat and the third column in \b topography_*.dat.
<a name="l00668"></a>00668 @image html Solution_1DSWDamBreak.png
<a name="l00669"></a>00669 
<a name="l00670"></a>00670 Expected screen output:
<a name="l00671"></a>00671 \include 1D/<a class="code" href="a00026.html" title="Structure containing variables and parameters specific to the 1D Shallow Water equations...">ShallowWater1D</a>/DamBreakingRectangularBump/output.log
<a name="l00672"></a>00672 
<a name="l00673"></a>00673 
<a name="l00674"></a>00674 \<a class="code" href="a00032.html#a23a77f360d9ab0a90b11ff01314b6526">page</a> linear_adv_gauss 2D Linear Advection - Gaussian Pulse
<a name="l00675"></a>00675 
<a name="l00676"></a>00676 <a class="code" href="a00031.html#af7342acc7b7299a81e83b43ed11b9f84">Location</a>: \b hypar/<a class="code" href="a00031.html#a60f502575a2e782807ea78c05f76ae03">Examples</a>/2D/LinearAdvection/GaussianPulse
<a name="l00677"></a>00677           (This directory contains all the input files needed
<a name="l00678"></a>00678           to run <span class="keyword">this</span> <span class="keywordflow">case</span>. If there is a \a Run.m, run it in
<a name="l00679"></a>00679           MATLAB to quickly <span class="keyword">set</span> up, run, and visualize the 
<a name="l00680"></a>00680           example).
<a name="l00681"></a>00681 
<a name="l00682"></a>00682 Governing equations: 2D Linear Advection Equation (linearadr.h)
<a name="l00683"></a>00683 
<a name="l00684"></a>00684 <a class="code" href="a00031.html#a948095327123305f3fdf2b293b55381e">Domain</a>: \f$-6 \le x &lt; 6, -3 \le y &lt; 3\f$, \a &quot;periodic&quot; (<span class="preprocessor">#_PERIODIC_)</span>
<a name="l00685"></a>00685 <span class="preprocessor"></span>        boundary <a class="code" href="a00063.html#a07bca284db2938db7ad469438892ca47">conditions</a> on all boundaries.
<a name="l00686"></a>00686 
<a name="l00687"></a>00687 Initial solution: \f$u\left(x,y,0\right) = u_0\left(x,y\right)= \exp\left[-\left(\frac{x^2}{2}+\frac{y^2}{2}\right)\right]\f$\n
<a name="l00688"></a>00688 Exact solution: \f$u\left(x,y,t\right) = u_0\left(x-a_xt,y-a_yt\right)\f$.
<a name="l00689"></a>00689 
<a name="l00690"></a>00690 Numerical <a class="code" href="a00033.html#a1610bc0f5a3c1062419d67e161327d37">Method</a>:
<a name="l00691"></a>00691  + Spatial <a class="code" href="a00033.html#a006f5ed6c12ae3d4f8e840cb181a05ca">discretization</a> (hyperbolic): 5th order CRWENO (<a class="code" href="a00041.html#a33b1e24c12129941b0027a83c543a654" title="5th order CRWENO reconstruction (component-wise) on a uniform grid">Interp1PrimFifthOrderCRWENO</a>())
<a name="l00692"></a>00692  + Time integration: SSPRK3 (<a class="code" href="a00061.html#aca6ebec6e6998f0c509bb38fa91f3321">TimeRK</a>(), #<a class="code" href="a00061.html#a97e67bb275d6a2dad40b184579559f82">_RK_SSP3_</a>)
<a name="l00693"></a>00693 
<a name="l00694"></a>00694 Input files <a class="code" href="a00032.html#af7a1b4a66a5b6f9ac8eebf2c23b51e9e">required</a>:
<a name="l00695"></a>00695 ---------------------
<a name="l00696"></a>00696 
<a name="l00697"></a>00697 \b solver.inp
<a name="l00698"></a>00698 \include 2D/LinearAdvection/GaussianPulse/solver.inp
<a name="l00699"></a>00699 
<a name="l00700"></a>00700 \b boundary.inp
<a name="l00701"></a>00701 \include 2D/LinearAdvection/GaussianPulse/boundary.inp
<a name="l00702"></a>00702 
<a name="l00703"></a>00703 \b physics.inp (specifies \f$a_x\f$ and \f$a_y\f$)
<a name="l00704"></a>00704 \include 2D/LinearAdvection/GaussianPulse/physics.inp
<a name="l00705"></a>00705 
<a name="l00706"></a>00706 \b lusolver.inp (optional)
<a name="l00707"></a>00707 \include 2D/LinearAdvection/GaussianPulse/lusolver.inp
<a name="l00708"></a>00708 
<a name="l00709"></a>00709 \b weno.inp (optional)
<a name="l00710"></a>00710 \include 2D/LinearAdvection/GaussianPulse/weno.inp
<a name="l00711"></a>00711 
<a name="l00712"></a>00712 To generate \b initial.inp, compile and run the 
<a name="l00713"></a>00713 following code in the run directory. \b <a class="code" href="a00032.html#a86616b1951d3af95df5b7115dd30438f">Note</a>: if the
<a name="l00714"></a>00714 final time is an integer multiple of the time period,
<a name="l00715"></a>00715 the file \b initial.inp can also be <a class="code" href="a00032.html#aa2f9253c1a63124e53d64db71f7e7c16">used</a> as the exact
<a name="l00716"></a>00716 solution \b exact.inp (i.<a class="code" href="a00032.html#a35b3e91c83139b35bbacfaa59a58afd1">e</a>. create a sym link called 
<a name="l00717"></a>00717 \a exact.inp pointing to \a initial.inp, or just <a class="code" href="a00063.html#af77238a13603775a1f60ae9206d86600">copy</a>
<a name="l00718"></a>00718 \a initial.inp to \a exact.inp).
<a name="l00719"></a>00719 \include 2D/LinearAdvection/GaussianPulse/aux/init.c
<a name="l00720"></a>00720 
<a name="l00721"></a>00721 Output:
<a name="l00722"></a>00722 -------
<a name="l00723"></a>00723 <a class="code" href="a00032.html#a86616b1951d3af95df5b7115dd30438f">Note</a> that \b iproc is set to 
<a name="l00724"></a>00724 
<a name="l00725"></a>00725       4 2
<a name="l00726"></a>00726 
<a name="l00727"></a>00727 in \b solver.inp (i.<a class="code" href="a00032.html#a35b3e91c83139b35bbacfaa59a58afd1">e</a>., 4 processors along \a x, and 2
<a name="l00728"></a>00728 processors along \a y). <a class="code" href="a00032.html#ae9d9a95320de64ce7cd52f941a72f34a">Thus</a>, this example should be run
<a name="l00729"></a>00729 with 8 MPI ranks (or change \b iproc).
<a name="l00730"></a>00730 
<a name="l00731"></a>00731 After running the code, there should be 21 output
<a name="l00732"></a>00732 files \b op_00000.<a class="code" href="a00031.html#a96b9dfbebc4ecd57a32426075fb0c3f2">dat</a>, \b op_00001.<a class="code" href="a00031.html#a96b9dfbebc4ecd57a32426075fb0c3f2">dat</a>, ... \b op_00020.<a class="code" href="a00031.html#a96b9dfbebc4ecd57a32426075fb0c3f2">dat</a>; 
<a name="l00733"></a>00733 the first one is the solution at \f$t=0\f$ and the <span class="keyword">final</span> one
<a name="l00734"></a>00734 is the solution at \f$t=12\f$. Since #<a class="code" href="a00015.html#a4e93cb107e180ef982b74cef7726b70f">HyPar::op_overwrite</a> is
<a name="l00735"></a>00735 <span class="keyword">set</span> to \a no in \b solver.inp, separate files are written
<a name="l00736"></a>00736 <span class="keywordflow">for</span> solutions at each output time. 
<a name="l00737"></a>00737   
<a name="l00738"></a>00738 <span class="preprocessor">#HyPar::op_file_format is set to \a tecplot2d in \b solver.inp, and</span>
<a name="l00739"></a>00739 <span class="preprocessor"></span>thus, all the files are in a format that Tecplot (http:<span class="comment">//www.tecplot.com/)</span>
<a name="l00740"></a>00740 or other visualization software supporting the Tecplot format 
<a name="l00741"></a>00741 (<a class="code" href="a00032.html#a35b3e91c83139b35bbacfaa59a58afd1">e</a>.g. VisIt - https:<span class="comment">//wci.llnl.gov/simulation/computer-codes/visit/)</span>
<a name="l00742"></a>00742 can read. In these files, the first two lines are the Tecplot headers, 
<a name="l00743"></a>00743 after which the data is written out as: the first two columns are grid indices, 
<a name="l00744"></a>00744 the next two columns are x and y coordinates, and the <span class="keyword">final</span> column is the 
<a name="l00745"></a>00745 solution.  #<a class="code" href="a00015.html#a51a3b8c19b86e9e1df5be02b05a6613c">HyPar::op_file_format</a> can be <span class="keyword">set</span> to \a <a class="code" href="a00031.html#a314f90bacf496961ff4bfef89fea32c0">text</a> to <span class="keyword">get</span> the solution
<a name="l00746"></a>00746 files in plain <a class="code" href="a00031.html#a314f90bacf496961ff4bfef89fea32c0">text</a> format (which can be read in and visualized in
<a name="l00747"></a>00747 MATLAB <span class="keywordflow">for</span> example).
<a name="l00748"></a>00748 
<a name="l00749"></a>00749 The following animation was generated from the solution files:
<a name="l00750"></a>00750 @image html Solution_2DLinearAdvGauss.gif
<a name="l00751"></a>00751 
<a name="l00752"></a>00752 Since the exact solution is available at the <span class="keyword">final</span> time 
<a name="l00753"></a>00753 (\a exact.inp is a <a class="code" href="a00063.html#af77238a13603775a1f60ae9206d86600">copy</a> of \a initial.inp), the numerical 
<a name="l00754"></a>00754 errors are calculated and reported on screen (see below)
<a name="l00755"></a>00755 as well as \b errors.dat:
<a name="l00756"></a>00756 \include 2D/LinearAdvection/GaussianPulse/errors.dat
<a name="l00757"></a>00757 The numbers are: number of grid points in each dimension (#<a class="code" href="a00015.html#aa989ebb755986852177779cdf7bd8c85">HyPar::dim_global</a>), 
<a name="l00758"></a>00758 number of processors in each dimension (#<a class="code" href="a00019.html#a0be0f30a83bc3f3d9f6ee3a36bbf2716">MPIVariables::iproc</a>),
<a name="l00759"></a>00759 time step size (#<a class="code" href="a00015.html#a03e28be41881b703c836edbfe9b51b17">HyPar::dt</a>),
<a name="l00760"></a>00760 L1, L2, and L-infinity errors (#<a class="code" href="a00015.html#aa40f27cb2afa2db0f0468962be8b3679">HyPar::error</a>),
<a name="l00761"></a>00761 solver wall time (seconds) (i.e., not accounting <span class="keywordflow">for</span> initialization,
<a name="l00762"></a>00762 and cleaning up),
<a name="l00763"></a>00763 and total wall time.
<a name="l00764"></a>00764 
<a name="l00765"></a>00765 Since #<a class="code" href="a00015.html#ac92c34fe456d92c694eacd2231f5a7b1">HyPar::ConservationCheck</a> is <span class="keyword">set</span> to \a yes in \b solver.inp,
<a name="l00766"></a>00766 the code checks <span class="keywordflow">for</span> conservation error and prints it to screen, as well
<a name="l00767"></a>00767 as the file \b conservation.dat:
<a name="l00768"></a>00768 \include 2D/LinearAdvection/GaussianPulse/conservation.dat
<a name="l00769"></a>00769 The numbers are: number of grid points in each dimension (#<a class="code" href="a00015.html#aa989ebb755986852177779cdf7bd8c85">HyPar::dim_global</a>),
<a name="l00770"></a>00770 number of processors in each dimension (#<a class="code" href="a00019.html#a0be0f30a83bc3f3d9f6ee3a36bbf2716">MPIVariables::iproc</a>),
<a name="l00771"></a>00771 time step size (#<a class="code" href="a00015.html#a03e28be41881b703c836edbfe9b51b17">HyPar::dt</a>),
<a name="l00772"></a>00772 and conservation error (#<a class="code" href="a00015.html#a965363cd64ce50ae17705dfb285dd0ab">HyPar::ConservationError</a>).
<a name="l00773"></a>00773 
<a name="l00774"></a>00774 Expected screen output:
<a name="l00775"></a>00775 \include 2D/LinearAdvection/GaussianPulse/output.log
<a name="l00776"></a>00776 
<a name="l00777"></a>00777 
<a name="l00778"></a>00778 \<a class="code" href="a00032.html#a23a77f360d9ab0a90b11ff01314b6526">page</a> linear_diff_sine2d 2D Linear Diffusion - Sine Wave
<a name="l00779"></a>00779 
<a name="l00780"></a>00780 <a class="code" href="a00031.html#af7342acc7b7299a81e83b43ed11b9f84">Location</a>: \b hypar/<a class="code" href="a00031.html#a60f502575a2e782807ea78c05f76ae03">Examples</a>/2D/LinearDiffusion/SineWave
<a name="l00781"></a>00781           (This directory contains all the input files needed
<a name="l00782"></a>00782           to run <span class="keyword">this</span> <span class="keywordflow">case</span>. If there is a \a Run.m, run it in
<a name="l00783"></a>00783           MATLAB to quickly <span class="keyword">set</span> up, run, and visualize the 
<a name="l00784"></a>00784           example).
<a name="l00785"></a>00785 
<a name="l00786"></a>00786 Governing equations: 2D Linear Diffusion Equation (linearadr.h)
<a name="l00787"></a>00787 
<a name="l00788"></a>00788 <a class="code" href="a00031.html#a948095327123305f3fdf2b293b55381e">Domain</a>: \f$0 \le x,y &lt; 1\f$, \a <span class="stringliteral">&quot;periodic&quot;</span> (#<a class="code" href="a00037.html#a65ffa4253dee762c65092abcf04ecdee">_PERIODIC_</a>)
<a name="l00789"></a>00789         boundary <a class="code" href="a00063.html#a07bca284db2938db7ad469438892ca47">conditions</a> on all boundaries.
<a name="l00790"></a>00790 
<a name="l00791"></a>00791 Initial solution: \f$u\left(x,y,0\right) = u_0\left(x,y\right)= \sin\left(2\pi x\right)\sin\left(2\pi y\right)\f$\n
<a name="l00792"></a>00792 Exact solution: \f$u\left(x,y,t\right) = \exp\left[-\pi^2 \left(4\nu_x + 4\nu_y\right) t\right] u0\left(x,y\right)\f$.
<a name="l00793"></a>00793 
<a name="l00794"></a>00794 Numerical <a class="code" href="a00033.html#a1610bc0f5a3c1062419d67e161327d37">Method</a>:
<a name="l00795"></a>00795  + Spatial discretization (parabolic): 2nd order (<a class="code" href="a00041.html#ae8bfe856abd743f5af925dc03e708ee3" title="2nd order component-wise interpolation of the 2nd primitive on a uniform grid">Interp2PrimSecondOrder</a>()), 
<a name="l00796"></a>00796                                        conservative (<a class="code" href="a00033.html#a62d59663e168051efcb7306776473ecb">ParabolicFunctionCons1Stage</a>())
<a name="l00797"></a>00797  + Time integration: SSPRK3 (<a class="code" href="a00061.html#aca6ebec6e6998f0c509bb38fa91f3321">TimeRK</a>(), #<a class="code" href="a00061.html#a97e67bb275d6a2dad40b184579559f82">_RK_SSP3_</a>)
<a name="l00798"></a>00798 
<a name="l00799"></a>00799 Input files <a class="code" href="a00032.html#af7a1b4a66a5b6f9ac8eebf2c23b51e9e">required</a>:
<a name="l00800"></a>00800 ---------------------
<a name="l00801"></a>00801 
<a name="l00802"></a>00802 \b solver.inp
<a name="l00803"></a>00803 \include 2D/LinearDiffusion/SineWave/solver.inp
<a name="l00804"></a>00804 
<a name="l00805"></a>00805 \b boundary.inp
<a name="l00806"></a>00806 \include 2D/LinearDiffusion/SineWave/boundary.inp
<a name="l00807"></a>00807 
<a name="l00808"></a>00808 \b physics.inp (specifies \f$\nu_x\f$ and \f$\nu_y\f$)
<a name="l00809"></a>00809 \include 2D/LinearDiffusion/SineWave/physics.inp
<a name="l00810"></a>00810 
<a name="l00811"></a>00811 To generate \b initial.inp (initial solution) and 
<a name="l00812"></a>00812 \b exact.inp (exact solution), compile and run the 
<a name="l00813"></a>00813 following code in the run directory. 
<a name="l00814"></a>00814 \include 2D/LinearDiffusion/SineWave/aux/exact.c
<a name="l00815"></a>00815 
<a name="l00816"></a>00816 Output:
<a name="l00817"></a>00817 -------
<a name="l00818"></a>00818 <a class="code" href="a00032.html#a86616b1951d3af95df5b7115dd30438f">Note</a> that \b iproc is <span class="keyword">set</span> to 
<a name="l00819"></a>00819 
<a name="l00820"></a>00820       2 2
<a name="l00821"></a>00821 
<a name="l00822"></a>00822 in \b solver.inp (i.e., 2 processors along \a x, and 2
<a name="l00823"></a>00823 processors along \a y). <a class="code" href="a00032.html#ae9d9a95320de64ce7cd52f941a72f34a">Thus</a>, <span class="keyword">this</span> example should be run
<a name="l00824"></a>00824 with 4 MPI ranks (or change \b iproc).
<a name="l00825"></a>00825 
<a name="l00826"></a>00826 After running the code, there should be 11 output
<a name="l00827"></a>00827 files \b op_00000.dat, \b op_00001.dat, ... \b op_00010.dat; 
<a name="l00828"></a>00828 the first one is the solution at \f$t=0\f$ and the <span class="keyword">final</span> one
<a name="l00829"></a>00829 is the solution at \f$t=10\f$. Since #<a class="code" href="a00015.html#a4e93cb107e180ef982b74cef7726b70f">HyPar::op_overwrite</a> is
<a name="l00830"></a>00830 <span class="keyword">set</span> to \a no in \b solver.inp, separate files are written
<a name="l00831"></a>00831 <span class="keywordflow">for</span> solutions at each output time. 
<a name="l00832"></a>00832   
<a name="l00833"></a>00833 <span class="preprocessor">#HyPar::op_file_format is set to \a tecplot2d in \b solver.inp, and</span>
<a name="l00834"></a>00834 <span class="preprocessor"></span>thus, all the files are in a format that Tecplot (http:<span class="comment">//www.tecplot.com/)</span>
<a name="l00835"></a>00835 or other visualization software supporting the Tecplot format 
<a name="l00836"></a>00836 (<a class="code" href="a00032.html#a35b3e91c83139b35bbacfaa59a58afd1">e</a>.g. VisIt - https:<span class="comment">//wci.llnl.gov/simulation/computer-codes/visit/)</span>
<a name="l00837"></a>00837 can read. In these files, the first two lines are the Tecplot headers, 
<a name="l00838"></a>00838 after which the data is written out as: the first two columns are grid indices, 
<a name="l00839"></a>00839 the next two columns are x and y coordinates, and the <span class="keyword">final</span> column is the 
<a name="l00840"></a>00840 solution.  #<a class="code" href="a00015.html#a51a3b8c19b86e9e1df5be02b05a6613c">HyPar::op_file_format</a> can be <span class="keyword">set</span> to \a <a class="code" href="a00031.html#a314f90bacf496961ff4bfef89fea32c0">text</a> to <span class="keyword">get</span> the solution
<a name="l00841"></a>00841 files in plain <a class="code" href="a00031.html#a314f90bacf496961ff4bfef89fea32c0">text</a> format (which can be read in and visualized in
<a name="l00842"></a>00842 MATLAB <span class="keywordflow">for</span> example).
<a name="l00843"></a>00843 
<a name="l00844"></a>00844 The following animation was generated from the solution files:
<a name="l00845"></a>00845 @image html Solution_2DLinearDiffSine.gif
<a name="l00846"></a>00846 
<a name="l00847"></a>00847 Since the exact solution is available at the <span class="keyword">final</span> time 
<a name="l00848"></a>00848 , the numerical 
<a name="l00849"></a>00849 errors are calculated and reported on screen (see below)
<a name="l00850"></a>00850 as well as \b errors.dat:
<a name="l00851"></a>00851 \include 2D/LinearDiffusion/SineWave/errors.dat
<a name="l00852"></a>00852 The numbers are: number of grid points in each dimension (#<a class="code" href="a00015.html#aa989ebb755986852177779cdf7bd8c85">HyPar::dim_global</a>), 
<a name="l00853"></a>00853 number of processors in each dimension (#<a class="code" href="a00019.html#a0be0f30a83bc3f3d9f6ee3a36bbf2716">MPIVariables::iproc</a>),
<a name="l00854"></a>00854 time step size (#<a class="code" href="a00015.html#a03e28be41881b703c836edbfe9b51b17">HyPar::dt</a>),
<a name="l00855"></a>00855 L1, L2, and L-infinity errors (#<a class="code" href="a00015.html#aa40f27cb2afa2db0f0468962be8b3679">HyPar::error</a>),
<a name="l00856"></a>00856 solver wall time (seconds) (i.e., not accounting <span class="keywordflow">for</span> initialization,
<a name="l00857"></a>00857 and cleaning up),
<a name="l00858"></a>00858 and total wall time.
<a name="l00859"></a>00859 
<a name="l00860"></a>00860 Expected screen output:
<a name="l00861"></a>00861 \include 2D/LinearDiffusion/SineWave/output.log
<a name="l00862"></a>00862 
<a name="l00863"></a>00863 
<a name="l00864"></a>00864 \<a class="code" href="a00032.html#a23a77f360d9ab0a90b11ff01314b6526">page</a> euler2d_riemann4 2D Euler Equations - Riemann Problem Case 4
<a name="l00865"></a>00865 
<a name="l00866"></a>00866 <a class="code" href="a00031.html#af7342acc7b7299a81e83b43ed11b9f84">Location</a>: \b hypar/<a class="code" href="a00031.html#a60f502575a2e782807ea78c05f76ae03">Examples</a>/2D/<a class="code" href="a00021.html" title="Structure containing variables and parameters specific to the 2D Navier Stokes equations...">NavierStokes2D</a>/Riemann2DCase4
<a name="l00867"></a>00867           (This directory contains all the input files needed
<a name="l00868"></a>00868           to run <span class="keyword">this</span> <span class="keywordflow">case</span>. If there is a \a Run.m, run it in
<a name="l00869"></a>00869           MATLAB to quickly <span class="keyword">set</span> up, run, and visualize the 
<a name="l00870"></a>00870           example).
<a name="l00871"></a>00871 
<a name="l00872"></a>00872 Governing equations: 2D Euler Equations (navierstokes2d.h - By <span class="keywordflow">default</span>,
<a name="l00873"></a>00873                      #<a class="code" href="a00021.html#a3b92a4b98cedf64473b3c13dfa7674b4">NavierStokes2D::Re</a> is <span class="keyword">set</span> to \b -1 which makes the
<a name="l00874"></a>00874                      code skip the parabolic <a class="code" href="a00064.html#a0bc2e5eea004e13e7e0d14dc8493fa5f">terms</a>, i.e., the 2D Euler
<a name="l00875"></a>00875                      equations are solved.)
<a name="l00876"></a>00876 
<a name="l00877"></a>00877 Reference:
<a name="l00878"></a>00878   + P. Lax and X.-D. Liu, <span class="stringliteral">&quot;Solution of two-dimensional Riemann</span>
<a name="l00879"></a>00879 <span class="stringliteral">    problems of gas dynamics by positive schemes,&quot;</span> SIAM J Sci 
<a name="l00880"></a>00880     Comp 19 (1998), 319–340.
<a name="l00881"></a>00881 
<a name="l00882"></a>00882 Domain: \f$-0.5 \le x,y \le 0.5\f$, \a <span class="stringliteral">&quot;extrapolate&quot;</span> (#<a class="code" href="a00037.html#a53da239cc00a2394faa0637dad4d0a0c">_EXTRAPOLATE_</a>)
<a name="l00883"></a>00883         boundary <a class="code" href="a00063.html#a07bca284db2938db7ad469438892ca47">conditions</a>.
<a name="l00884"></a>00884 
<a name="l00885"></a>00885 Initial solution: see \b Case \b 4 in the reference.
<a name="l00886"></a>00886 
<a name="l00887"></a>00887 Numerical method:
<a name="l00888"></a>00888  + Spatial discretization (hyperbolic): Characteristic-based 5th order WENO (<a class="code" href="a00041.html#abf3b032fdc8c0e84b86909db9e0b93c3" title="5th order WENO reconstruction (characteristic-based) on a uniform grid">Interp1PrimFifthOrderWENOChar</a>())
<a name="l00889"></a>00889  + Time integration: SSPRK3 (<a class="code" href="a00061.html#aca6ebec6e6998f0c509bb38fa91f3321">TimeRK</a>(), #<a class="code" href="a00061.html#a97e67bb275d6a2dad40b184579559f82">_RK_SSP3_</a>)
<a name="l00890"></a>00890 
<a name="l00891"></a>00891 Input files <a class="code" href="a00032.html#af7a1b4a66a5b6f9ac8eebf2c23b51e9e">required</a>:
<a name="l00892"></a>00892 ---------------------
<a name="l00893"></a>00893 
<a name="l00894"></a>00894 \b solver.inp
<a name="l00895"></a>00895 \include 2D/<a class="code" href="a00021.html" title="Structure containing variables and parameters specific to the 2D Navier Stokes equations...">NavierStokes2D</a>/Riemann2DCase4/solver.inp
<a name="l00896"></a>00896 
<a name="l00897"></a>00897 \b boundary.inp
<a name="l00898"></a>00898 \include 2D/<a class="code" href="a00021.html" title="Structure containing variables and parameters specific to the 2D Navier Stokes equations...">NavierStokes2D</a>/Riemann2DCase4/boundary.inp
<a name="l00899"></a>00899 
<a name="l00900"></a>00900 \b physics.inp
<a name="l00901"></a>00901 \include 2D/<a class="code" href="a00021.html" title="Structure containing variables and parameters specific to the 2D Navier Stokes equations...">NavierStokes2D</a>/Riemann2DCase4/physics.inp
<a name="l00902"></a>00902 
<a name="l00903"></a>00903 \b weno.inp (optional)
<a name="l00904"></a>00904 \include 2D/<a class="code" href="a00021.html" title="Structure containing variables and parameters specific to the 2D Navier Stokes equations...">NavierStokes2D</a>/Riemann2DCase4/weno.inp
<a name="l00905"></a>00905 
<a name="l00906"></a>00906 To generate \b initial.inp, compile and run the 
<a name="l00907"></a>00907 following code in the run directory.
<a name="l00908"></a>00908 \include 2D/<a class="code" href="a00021.html" title="Structure containing variables and parameters specific to the 2D Navier Stokes equations...">NavierStokes2D</a>/Riemann2DCase4/aux/init.c
<a name="l00909"></a>00909 
<a name="l00910"></a>00910 Output:
<a name="l00911"></a>00911 -------
<a name="l00912"></a>00912 <a class="code" href="a00032.html#a86616b1951d3af95df5b7115dd30438f">Note</a> that \b iproc is <span class="keyword">set</span> to 
<a name="l00913"></a>00913 
<a name="l00914"></a>00914       2 2
<a name="l00915"></a>00915 
<a name="l00916"></a>00916 in \b solver.inp (i.e., 2 processors along \a x, and 2
<a name="l00917"></a>00917 processors along \a y). <a class="code" href="a00032.html#ae9d9a95320de64ce7cd52f941a72f34a">Thus</a>, <span class="keyword">this</span> example should be run
<a name="l00918"></a>00918 with 4 MPI ranks (or change \b iproc).
<a name="l00919"></a>00919 
<a name="l00920"></a>00920 After running the code, there should be 11 output
<a name="l00921"></a>00921 files \b op_00000.dat, \b op_00001.dat, ... \b op_00010.dat; 
<a name="l00922"></a>00922 the first one is the solution at \f$t=0\f$ and the <span class="keyword">final</span> one
<a name="l00923"></a>00923 is the solution at \f$t=0.25\f$. Since #<a class="code" href="a00015.html#a4e93cb107e180ef982b74cef7726b70f">HyPar::op_overwrite</a> is
<a name="l00924"></a>00924 <span class="keyword">set</span> to \a no in \b solver.inp, separate files are written
<a name="l00925"></a>00925 <span class="keywordflow">for</span> solutions at each output time. 
<a name="l00926"></a>00926   
<a name="l00927"></a>00927 <span class="preprocessor">#HyPar::op_file_format is set to \a tecplot2d in \b solver.inp, and</span>
<a name="l00928"></a>00928 <span class="preprocessor"></span>thus, all the files are in a format that Tecplot (http:<span class="comment">//www.tecplot.com/)</span>
<a name="l00929"></a>00929 or other visualization software supporting the Tecplot format 
<a name="l00930"></a>00930 (<a class="code" href="a00032.html#a35b3e91c83139b35bbacfaa59a58afd1">e</a>.g. VisIt - https:<span class="comment">//wci.llnl.gov/simulation/computer-codes/visit/)</span>
<a name="l00931"></a>00931 can read. In these files, the first two lines are the Tecplot headers, 
<a name="l00932"></a>00932 after which the data is written out as: the first two columns are grid indices, 
<a name="l00933"></a>00933 the next two columns are x and y coordinates, and the remaining columns are the 
<a name="l00934"></a>00934 solution components.  #<a class="code" href="a00015.html#a51a3b8c19b86e9e1df5be02b05a6613c">HyPar::op_file_format</a> can be <span class="keyword">set</span> to \a <a class="code" href="a00031.html#a314f90bacf496961ff4bfef89fea32c0">text</a> to <span class="keyword">get</span> the solution
<a name="l00935"></a>00935 files in plain <a class="code" href="a00031.html#a314f90bacf496961ff4bfef89fea32c0">text</a> format (which can be read in and visualized in
<a name="l00936"></a>00936 MATLAB <span class="keywordflow">for</span> example).
<a name="l00937"></a>00937 
<a name="l00938"></a>00938 The following plot shows the density contours at the <span class="keyword">final</span> time t=0.25, 
<a name="l00939"></a>00939 obtained from plotting \b op_00010.dat:
<a name="l00940"></a>00940 @image html Solution_2DNavStokRiemann4.png
<a name="l00941"></a>00941 
<a name="l00942"></a>00942 Since #<a class="code" href="a00015.html#ac92c34fe456d92c694eacd2231f5a7b1">HyPar::ConservationCheck</a> is <span class="keyword">set</span> to \a yes in \b solver.inp,
<a name="l00943"></a>00943 the code checks <span class="keywordflow">for</span> conservation error and prints it to screen, as well
<a name="l00944"></a>00944 as the file \b conservation.dat:
<a name="l00945"></a>00945 \include 2D/<a class="code" href="a00021.html" title="Structure containing variables and parameters specific to the 2D Navier Stokes equations...">NavierStokes2D</a>/Riemann2DCase4/conservation.dat
<a name="l00946"></a>00946 The numbers are: number of grid points in each dimension (#<a class="code" href="a00015.html#aa989ebb755986852177779cdf7bd8c85">HyPar::dim_global</a>),
<a name="l00947"></a>00947 number of processors in each dimension (#<a class="code" href="a00019.html#a0be0f30a83bc3f3d9f6ee3a36bbf2716">MPIVariables::iproc</a>),
<a name="l00948"></a>00948 time step size (#<a class="code" href="a00015.html#a03e28be41881b703c836edbfe9b51b17">HyPar::dt</a>),
<a name="l00949"></a>00949 and conservation error (#<a class="code" href="a00015.html#a965363cd64ce50ae17705dfb285dd0ab">HyPar::ConservationError</a>) <span class="keywordflow">for each</span> component.
<a name="l00950"></a>00950 
<a name="l00951"></a>00951 Expected screen output:
<a name="l00952"></a>00952 \include 2D/<a class="code" href="a00021.html" title="Structure containing variables and parameters specific to the 2D Navier Stokes equations...">NavierStokes2D</a>/Riemann2DCase4/output.log
<a name="l00953"></a>00953 
<a name="l00954"></a>00954 
<a name="l00955"></a>00955 \<a class="code" href="a00032.html#a23a77f360d9ab0a90b11ff01314b6526">page</a> euler2d_riemann6 2D Euler Equations - Riemann Problem Case 6
<a name="l00956"></a>00956 
<a name="l00957"></a>00957 <a class="code" href="a00031.html#af7342acc7b7299a81e83b43ed11b9f84">Location</a>: \b hypar/<a class="code" href="a00031.html#a60f502575a2e782807ea78c05f76ae03">Examples</a>/2D/<a class="code" href="a00021.html" title="Structure containing variables and parameters specific to the 2D Navier Stokes equations...">NavierStokes2D</a>/Riemann2DCase6
<a name="l00958"></a>00958           (This directory contains all the input files needed
<a name="l00959"></a>00959           to run <span class="keyword">this</span> <span class="keywordflow">case</span>. If there is a \a Run.m, run it in
<a name="l00960"></a>00960           MATLAB to quickly <span class="keyword">set</span> up, run, and visualize the 
<a name="l00961"></a>00961           example).
<a name="l00962"></a>00962 
<a name="l00963"></a>00963 Governing equations: 2D Euler Equations (navierstokes2d.h - By <span class="keywordflow">default</span>,
<a name="l00964"></a>00964                      #<a class="code" href="a00021.html#a3b92a4b98cedf64473b3c13dfa7674b4">NavierStokes2D::Re</a> is <span class="keyword">set</span> to \b -1 which makes the
<a name="l00965"></a>00965                      code skip the parabolic terms, i.e., the 2D Euler
<a name="l00966"></a>00966                      equations are solved.)
<a name="l00967"></a>00967 
<a name="l00968"></a>00968 Reference:
<a name="l00969"></a>00969   + P. Lax and X.-D. Liu, <span class="stringliteral">&quot;Solution of two-dimensional Riemann</span>
<a name="l00970"></a>00970 <span class="stringliteral">    problems of gas dynamics by positive schemes,&quot;</span> SIAM J Sci 
<a name="l00971"></a>00971     Comp 19 (1998), 319–340.
<a name="l00972"></a>00972 
<a name="l00973"></a>00973 Domain: \f$-0.5 \le x,y \le 0.5\f$, \a <span class="stringliteral">&quot;extrapolate&quot;</span> (#<a class="code" href="a00037.html#a53da239cc00a2394faa0637dad4d0a0c">_EXTRAPOLATE_</a>)
<a name="l00974"></a>00974         boundary <a class="code" href="a00063.html#a07bca284db2938db7ad469438892ca47">conditions</a>.
<a name="l00975"></a>00975 
<a name="l00976"></a>00976 Initial solution: see \b Case \b 6 in the reference.
<a name="l00977"></a>00977 
<a name="l00978"></a>00978 Numerical method:
<a name="l00979"></a>00979  + Spatial discretization (hyperbolic): Characteristic-based 3rd order MUSCL (<a class="code" href="a00041.html#a985d08c4fb9bcb71875c697f9e00d6eb" title="3rd order MUSCL scheme with Koren&amp;#39;s limiter (characteristic-based) on a uniform...">Interp1PrimThirdOrderMUSCLChar</a>())
<a name="l00980"></a>00980  + Time integration: SSPRK3 (<a class="code" href="a00061.html#aca6ebec6e6998f0c509bb38fa91f3321">TimeRK</a>(), #<a class="code" href="a00061.html#a97e67bb275d6a2dad40b184579559f82">_RK_SSP3_</a>)
<a name="l00981"></a>00981 
<a name="l00982"></a>00982 Input files <a class="code" href="a00032.html#af7a1b4a66a5b6f9ac8eebf2c23b51e9e">required</a>:
<a name="l00983"></a>00983 ---------------------
<a name="l00984"></a>00984 
<a name="l00985"></a>00985 \b solver.inp
<a name="l00986"></a>00986 \include 2D/<a class="code" href="a00021.html" title="Structure containing variables and parameters specific to the 2D Navier Stokes equations...">NavierStokes2D</a>/Riemann2DCase6/solver.inp
<a name="l00987"></a>00987 
<a name="l00988"></a>00988 \b boundary.inp
<a name="l00989"></a>00989 \include 2D/<a class="code" href="a00021.html" title="Structure containing variables and parameters specific to the 2D Navier Stokes equations...">NavierStokes2D</a>/Riemann2DCase6/boundary.inp
<a name="l00990"></a>00990 
<a name="l00991"></a>00991 \b physics.inp
<a name="l00992"></a>00992 \include 2D/<a class="code" href="a00021.html" title="Structure containing variables and parameters specific to the 2D Navier Stokes equations...">NavierStokes2D</a>/Riemann2DCase6/physics.inp
<a name="l00993"></a>00993 
<a name="l00994"></a>00994 To generate \b initial.inp, compile and run the 
<a name="l00995"></a>00995 following code in the run directory.
<a name="l00996"></a>00996 \include 2D/<a class="code" href="a00021.html" title="Structure containing variables and parameters specific to the 2D Navier Stokes equations...">NavierStokes2D</a>/Riemann2DCase6/aux/init.c
<a name="l00997"></a>00997 
<a name="l00998"></a>00998 Output:
<a name="l00999"></a>00999 -------
<a name="l01000"></a>01000 <a class="code" href="a00032.html#a86616b1951d3af95df5b7115dd30438f">Note</a> that \b iproc is <span class="keyword">set</span> to 
<a name="l01001"></a>01001 
<a name="l01002"></a>01002       2 2
<a name="l01003"></a>01003 
<a name="l01004"></a>01004 in \b solver.inp (i.e., 2 processors along \a x, and 2
<a name="l01005"></a>01005 processors along \a y). <a class="code" href="a00032.html#ae9d9a95320de64ce7cd52f941a72f34a">Thus</a>, <span class="keyword">this</span> example should be run
<a name="l01006"></a>01006 with 4 MPI ranks (or change \b iproc).
<a name="l01007"></a>01007 
<a name="l01008"></a>01008 After running the code, there should be 11 output
<a name="l01009"></a>01009 files \b op_00000.dat, \b op_00001.dat, ... \b op_00010.dat; 
<a name="l01010"></a>01010 the first one is the solution at \f$t=0\f$ and the <span class="keyword">final</span> one
<a name="l01011"></a>01011 is the solution at \f$t=0.3\f$. Since #<a class="code" href="a00015.html#a4e93cb107e180ef982b74cef7726b70f">HyPar::op_overwrite</a> is
<a name="l01012"></a>01012 <span class="keyword">set</span> to \a no in \b solver.inp, separate files are written
<a name="l01013"></a>01013 <span class="keywordflow">for</span> solutions at each output time. 
<a name="l01014"></a>01014   
<a name="l01015"></a>01015 <span class="preprocessor">#HyPar::op_file_format is set to \a tecplot2d in \b solver.inp, and</span>
<a name="l01016"></a>01016 <span class="preprocessor"></span>thus, all the files are in a format that Tecplot (http:<span class="comment">//www.tecplot.com/)</span>
<a name="l01017"></a>01017 or other visualization software supporting the Tecplot format 
<a name="l01018"></a>01018 (<a class="code" href="a00032.html#a35b3e91c83139b35bbacfaa59a58afd1">e</a>.g. VisIt - https:<span class="comment">//wci.llnl.gov/simulation/computer-codes/visit/)</span>
<a name="l01019"></a>01019 can read. In these files, the first two lines are the Tecplot headers, 
<a name="l01020"></a>01020 after which the data is written out as: the first two columns are grid indices, 
<a name="l01021"></a>01021 the next two columns are x and y coordinates, and the remaining columns are the 
<a name="l01022"></a>01022 solution components.  #<a class="code" href="a00015.html#a51a3b8c19b86e9e1df5be02b05a6613c">HyPar::op_file_format</a> can be <span class="keyword">set</span> to \a <a class="code" href="a00031.html#a314f90bacf496961ff4bfef89fea32c0">text</a> to <span class="keyword">get</span> the solution
<a name="l01023"></a>01023 files in plain <a class="code" href="a00031.html#a314f90bacf496961ff4bfef89fea32c0">text</a> format (which can be read in and visualized in
<a name="l01024"></a>01024 MATLAB <span class="keywordflow">for</span> example).
<a name="l01025"></a>01025 
<a name="l01026"></a>01026 The following plot shows the density contours at the <span class="keyword">final</span> time t=0.3, 
<a name="l01027"></a>01027 obtained from plotting \b op_00010.dat:
<a name="l01028"></a>01028 @image html Solution_2DNavStokRiemann6.png
<a name="l01029"></a>01029 
<a name="l01030"></a>01030 Expected screen output:
<a name="l01031"></a>01031 \include 2D/<a class="code" href="a00021.html" title="Structure containing variables and parameters specific to the 2D Navier Stokes equations...">NavierStokes2D</a>/Riemann2DCase6/output.log
<a name="l01032"></a>01032 
<a name="l01033"></a>01033 
<a name="l01034"></a>01034 \<a class="code" href="a00032.html#a23a77f360d9ab0a90b11ff01314b6526">page</a> euler2d_radexp 2D Euler Equations - Radial Expansion Wave
<a name="l01035"></a>01035 
<a name="l01036"></a>01036 <a class="code" href="a00031.html#af7342acc7b7299a81e83b43ed11b9f84">Location</a>: \b hypar/<a class="code" href="a00031.html#a60f502575a2e782807ea78c05f76ae03">Examples</a>/2D/<a class="code" href="a00021.html" title="Structure containing variables and parameters specific to the 2D Navier Stokes equations...">NavierStokes2D</a>/RadialExpansionWave
<a name="l01037"></a>01037           (This directory contains all the input files needed
<a name="l01038"></a>01038           to run <span class="keyword">this</span> <span class="keywordflow">case</span>. If there is a \a Run.m, run it in
<a name="l01039"></a>01039           MATLAB to quickly <span class="keyword">set</span> up, run, and visualize the 
<a name="l01040"></a>01040           example).
<a name="l01041"></a>01041 
<a name="l01042"></a>01042 Governing equations: 2D Euler Equations (navierstokes2d.h - By <span class="keywordflow">default</span>,
<a name="l01043"></a>01043                      #<a class="code" href="a00021.html#a3b92a4b98cedf64473b3c13dfa7674b4">NavierStokes2D::Re</a> is <span class="keyword">set</span> to \b -1 which makes the
<a name="l01044"></a>01044                      code skip the parabolic terms, i.e., the 2D Euler
<a name="l01045"></a>01045                      equations are solved.)
<a name="l01046"></a>01046 
<a name="l01047"></a>01047 Reference: http:<span class="comment">//www.as.dlr.de/hiocfd/case_c1.5.html</span>
<a name="l01048"></a>01048 
<a name="l01049"></a>01049 <a class="code" href="a00031.html#a948095327123305f3fdf2b293b55381e">Domain</a>: \f$-0.4 \le x,y \le 0.4\f$, \a <span class="stringliteral">&quot;extrapolate&quot;</span> (#<a class="code" href="a00037.html#a53da239cc00a2394faa0637dad4d0a0c">_EXTRAPOLATE_</a>)
<a name="l01050"></a>01050         boundary <a class="code" href="a00063.html#a07bca284db2938db7ad469438892ca47">conditions</a> (supersonic outflow).
<a name="l01051"></a>01051 
<a name="l01052"></a>01052 Initial solution: see reference above.
<a name="l01053"></a>01053 
<a name="l01054"></a>01054 Numerical method:
<a name="l01055"></a>01055  + Spatial discretization (hyperbolic): Characteristic-based 3rd order WENO (<a class="code" href="a00041.html#abf3b032fdc8c0e84b86909db9e0b93c3" title="5th order WENO reconstruction (characteristic-based) on a uniform grid">Interp1PrimFifthOrderWENOChar</a>())
<a name="l01056"></a>01056  + Time integration: SSPRK3 (<a class="code" href="a00061.html#aca6ebec6e6998f0c509bb38fa91f3321">TimeRK</a>(), #<a class="code" href="a00061.html#a97e67bb275d6a2dad40b184579559f82">_RK_SSP3_</a>)
<a name="l01057"></a>01057 
<a name="l01058"></a>01058 Input files <a class="code" href="a00032.html#af7a1b4a66a5b6f9ac8eebf2c23b51e9e">required</a>:
<a name="l01059"></a>01059 ---------------------
<a name="l01060"></a>01060 
<a name="l01061"></a>01061 \b solver.inp
<a name="l01062"></a>01062 \include 2D/<a class="code" href="a00021.html" title="Structure containing variables and parameters specific to the 2D Navier Stokes equations...">NavierStokes2D</a>/RadialExpansionWave/solver.inp
<a name="l01063"></a>01063 
<a name="l01064"></a>01064 \b boundary.inp
<a name="l01065"></a>01065 \include 2D/<a class="code" href="a00021.html" title="Structure containing variables and parameters specific to the 2D Navier Stokes equations...">NavierStokes2D</a>/RadialExpansionWave/boundary.inp
<a name="l01066"></a>01066 
<a name="l01067"></a>01067 \b physics.inp
<a name="l01068"></a>01068 \include 2D/<a class="code" href="a00021.html" title="Structure containing variables and parameters specific to the 2D Navier Stokes equations...">NavierStokes2D</a>/RadialExpansionWave/physics.inp
<a name="l01069"></a>01069 
<a name="l01070"></a>01070 \b weno.inp (optional)
<a name="l01071"></a>01071 \include 2D/<a class="code" href="a00021.html" title="Structure containing variables and parameters specific to the 2D Navier Stokes equations...">NavierStokes2D</a>/RadialExpansionWave/weno.inp
<a name="l01072"></a>01072 
<a name="l01073"></a>01073 To generate \b initial.inp, compile and run the 
<a name="l01074"></a>01074 following code in the run directory.
<a name="l01075"></a>01075 \include 2D/<a class="code" href="a00021.html" title="Structure containing variables and parameters specific to the 2D Navier Stokes equations...">NavierStokes2D</a>/RadialExpansionWave/aux/init.c
<a name="l01076"></a>01076 
<a name="l01077"></a>01077 Output:
<a name="l01078"></a>01078 -------
<a name="l01079"></a>01079 <a class="code" href="a00032.html#a86616b1951d3af95df5b7115dd30438f">Note</a> that \b iproc is <span class="keyword">set</span> to 
<a name="l01080"></a>01080 
<a name="l01081"></a>01081       2 2
<a name="l01082"></a>01082 
<a name="l01083"></a>01083 in \b solver.inp (i.e., 2 processors along \a x, and 2
<a name="l01084"></a>01084 processors along \a y). <a class="code" href="a00032.html#ae9d9a95320de64ce7cd52f941a72f34a">Thus</a>, <span class="keyword">this</span> example should be run
<a name="l01085"></a>01085 with 4 MPI ranks (or change \b iproc).
<a name="l01086"></a>01086 
<a name="l01087"></a>01087 After running the code, there should be 11 output
<a name="l01088"></a>01088 files \b op_00000.dat, \b op_00001.dat, ... \b op_00010.dat; 
<a name="l01089"></a>01089 the first one is the solution at \f$t=0\f$ and the <span class="keyword">final</span> one
<a name="l01090"></a>01090 is the solution at \f$t=1\f$. Since #<a class="code" href="a00015.html#a4e93cb107e180ef982b74cef7726b70f">HyPar::op_overwrite</a> is
<a name="l01091"></a>01091 <span class="keyword">set</span> to \a no in \b solver.inp, separate files are written
<a name="l01092"></a>01092 <span class="keywordflow">for</span> solutions at each output time. 
<a name="l01093"></a>01093   
<a name="l01094"></a>01094 <span class="preprocessor">#HyPar::op_file_format is set to \a tecplot2d in \b solver.inp, and</span>
<a name="l01095"></a>01095 <span class="preprocessor"></span>thus, all the files are in a format that Tecplot (http:<span class="comment">//www.tecplot.com/)</span>
<a name="l01096"></a>01096 or other visualization software supporting the Tecplot format 
<a name="l01097"></a>01097 (<a class="code" href="a00032.html#a35b3e91c83139b35bbacfaa59a58afd1">e</a>.g. VisIt - https:<span class="comment">//wci.llnl.gov/simulation/computer-codes/visit/)</span>
<a name="l01098"></a>01098 can read. In these files, the first two lines are the Tecplot headers, 
<a name="l01099"></a>01099 after which the data is written out as: the first two columns are grid indices, 
<a name="l01100"></a>01100 the next two columns are x and y coordinates, and the remaining columns are the 
<a name="l01101"></a>01101 solution components.  #<a class="code" href="a00015.html#a51a3b8c19b86e9e1df5be02b05a6613c">HyPar::op_file_format</a> can be <span class="keyword">set</span> to \a <a class="code" href="a00031.html#a314f90bacf496961ff4bfef89fea32c0">text</a> to <span class="keyword">get</span> the solution
<a name="l01102"></a>01102 files in plain <a class="code" href="a00031.html#a314f90bacf496961ff4bfef89fea32c0">text</a> format (which can be read in and visualized in
<a name="l01103"></a>01103 MATLAB <span class="keywordflow">for</span> example).
<a name="l01104"></a>01104 
<a name="l01105"></a>01105 The following plot shows the density contours at the <span class="keyword">final</span> time t=1, 
<a name="l01106"></a>01106 obtained from plotting \b op_00010.dat:
<a name="l01107"></a>01107 @image html Solution_2DNavStokRadialExpansion.png
<a name="l01108"></a>01108 
<a name="l01109"></a>01109 Expected screen output:
<a name="l01110"></a>01110 \include 2D/<a class="code" href="a00021.html" title="Structure containing variables and parameters specific to the 2D Navier Stokes equations...">NavierStokes2D</a>/RadialExpansionWave/output.log
<a name="l01111"></a>01111 
<a name="l01112"></a>01112 
<a name="l01113"></a>01113 \<a class="code" href="a00032.html#a23a77f360d9ab0a90b11ff01314b6526">page</a> euler2d_vortex 2D Euler Equations - Isentropic Vortex Convection
<a name="l01114"></a>01114 
<a name="l01115"></a>01115 <a class="code" href="a00031.html#af7342acc7b7299a81e83b43ed11b9f84">Location</a>: \b hypar/<a class="code" href="a00031.html#a60f502575a2e782807ea78c05f76ae03">Examples</a>/2D/<a class="code" href="a00021.html" title="Structure containing variables and parameters specific to the 2D Navier Stokes equations...">NavierStokes2D</a>/InviscidVortexConvection
<a name="l01116"></a>01116           (This directory contains all the input files needed
<a name="l01117"></a>01117           to run <span class="keyword">this</span> <span class="keywordflow">case</span>. If there is a \a Run.m, run it in
<a name="l01118"></a>01118           MATLAB to quickly <span class="keyword">set</span> up, run, and visualize the 
<a name="l01119"></a>01119           example).
<a name="l01120"></a>01120 
<a name="l01121"></a>01121 Governing equations: 2D Euler Equations (navierstokes2d.h - By <span class="keywordflow">default</span>,
<a name="l01122"></a>01122                      #<a class="code" href="a00021.html#a3b92a4b98cedf64473b3c13dfa7674b4">NavierStokes2D::Re</a> is <span class="keyword">set</span> to \b -1 which makes the
<a name="l01123"></a>01123                      code skip the parabolic terms, i.e., the 2D Euler
<a name="l01124"></a>01124                      equations are solved.)
<a name="l01125"></a>01125 
<a name="l01126"></a>01126 Reference: C.-W. Shu, <span class="stringliteral">&quot;Essentially Non-oscillatory and Weighted Essentially </span>
<a name="l01127"></a>01127 <span class="stringliteral">           Non-oscillatory Schemes for Hyperbolic Conservation Laws&quot;</span>, 
<a name="l01128"></a>01128            ICASE Report 97-65, 1997
<a name="l01129"></a>01129 
<a name="l01130"></a>01130 <a class="code" href="a00031.html#a948095327123305f3fdf2b293b55381e">Domain</a>: \f$0 \le x,y \le 10\f$, \a <span class="stringliteral">&quot;periodic&quot;</span> (#<a class="code" href="a00037.html#a65ffa4253dee762c65092abcf04ecdee">_PERIODIC_</a>)
<a name="l01131"></a>01131         boundary <a class="code" href="a00063.html#a07bca284db2938db7ad469438892ca47">conditions</a>.
<a name="l01132"></a>01132 
<a name="l01133"></a>01133 Initial solution: The freestream flow is given <a class="code" href="a00032.html#a124150da8eed3d9f42e9361cc143ed7e">by</a>
<a name="l01134"></a>01134 \f{<a class="code" href="a00033.html#ac3f62e1b06188678336543688cb7709e">equation</a>}{
<a name="l01135"></a>01135   \rho_\infty = 1,\ u_\infty = 0.1,\ v_\infty = 0,\ p_\infty = 1
<a name="l01136"></a>01136 \f}
<a name="l01137"></a>01137 and a vortex is introduced, <a class="code" href="a00032.html#aa18752ebe19b49b626048c92d4586801">specified</a> as
<a name="l01138"></a>01138 \f{align}{
<a name="l01139"></a>01139 \rho &amp;= \left[ 1 - \frac{\left(\gamma-1\right)b^2}{8\gamma\pi^2} <a class="code" href="a00032.html#a35b3e91c83139b35bbacfaa59a58afd1">e</a>^{1-r^2} \right]^{\frac{1}{\gamma-1}},\ p = \rho^\gamma, \\
<a name="l01140"></a>01140 u &amp;= u_\infty - \frac{b}{2\pi} <a class="code" href="a00032.html#a35b3e91c83139b35bbacfaa59a58afd1">e</a>^{\frac{1}{2}\left(1-r^2\right)} \left(y-y_c\right),\ v = v_\infty + \frac{b}{2\pi} <a class="code" href="a00032.html#a35b3e91c83139b35bbacfaa59a58afd1">e</a>^{\frac{1}{2}\left(1-r^2\right)} \left(x-x_c\right),
<a name="l01141"></a>01141 \f}
<a name="l01142"></a>01142 where \f$b=0.5\f$ is the vortex strength and \f$r = \left[(x-x_c)^2 + (y-y_c)^2 \right]^{1/2}\f$ is the distance from the vortex center \f$\left(x_c,y_c\right) = \left(5,5\right)\f$.
<a name="l01143"></a>01143 
<a name="l01144"></a>01144 Numerical method:
<a name="l01145"></a>01145  + Spatial <a class="code" href="a00033.html#a006f5ed6c12ae3d4f8e840cb181a05ca">discretization</a> (hyperbolic): 5th order CRWENO (<a class="code" href="a00041.html#a33b1e24c12129941b0027a83c543a654" title="5th order CRWENO reconstruction (component-wise) on a uniform grid">Interp1PrimFifthOrderCRWENO</a>())
<a name="l01146"></a>01146  + Time integration: SSPRK3 (<a class="code" href="a00061.html#aca6ebec6e6998f0c509bb38fa91f3321">TimeRK</a>(), #<a class="code" href="a00061.html#a97e67bb275d6a2dad40b184579559f82">_RK_SSP3_</a>)
<a name="l01147"></a>01147 
<a name="l01148"></a>01148 Input files <a class="code" href="a00032.html#af7a1b4a66a5b6f9ac8eebf2c23b51e9e">required</a>:
<a name="l01149"></a>01149 ---------------------
<a name="l01150"></a>01150 
<a name="l01151"></a>01151 \b solver.inp
<a name="l01152"></a>01152 \include 2D/<a class="code" href="a00021.html" title="Structure containing variables and parameters specific to the 2D Navier Stokes equations...">NavierStokes2D</a>/InviscidVortexConvection/solver.inp
<a name="l01153"></a>01153 
<a name="l01154"></a>01154 \b boundary.inp
<a name="l01155"></a>01155 \include 2D/<a class="code" href="a00021.html" title="Structure containing variables and parameters specific to the 2D Navier Stokes equations...">NavierStokes2D</a>/InviscidVortexConvection/boundary.inp
<a name="l01156"></a>01156 
<a name="l01157"></a>01157 \b physics.inp
<a name="l01158"></a>01158 \include 2D/<a class="code" href="a00021.html" title="Structure containing variables and parameters specific to the 2D Navier Stokes equations...">NavierStokes2D</a>/InviscidVortexConvection/physics.inp
<a name="l01159"></a>01159 
<a name="l01160"></a>01160 \b weno.inp (optional)
<a name="l01161"></a>01161 \include 2D/<a class="code" href="a00021.html" title="Structure containing variables and parameters specific to the 2D Navier Stokes equations...">NavierStokes2D</a>/InviscidVortexConvection/weno.inp
<a name="l01162"></a>01162 
<a name="l01163"></a>01163 \b lusolver.inp (optional)
<a name="l01164"></a>01164 \include 2D/<a class="code" href="a00021.html" title="Structure containing variables and parameters specific to the 2D Navier Stokes equations...">NavierStokes2D</a>/InviscidVortexConvection/lusolver.inp
<a name="l01165"></a>01165 
<a name="l01166"></a>01166 To generate \b initial.inp (initial solution) and \b exact.inp
<a name="l01167"></a>01167 (exact solution), compile and run the following code in the run 
<a name="l01168"></a>01168 directory.
<a name="l01169"></a>01169 \include 2D/<a class="code" href="a00021.html" title="Structure containing variables and parameters specific to the 2D Navier Stokes equations...">NavierStokes2D</a>/InviscidVortexConvection/aux/exact.c
<a name="l01170"></a>01170 
<a name="l01171"></a>01171 Output:
<a name="l01172"></a>01172 -------
<a name="l01173"></a>01173 <a class="code" href="a00032.html#a86616b1951d3af95df5b7115dd30438f">Note</a> that \b iproc is set to 
<a name="l01174"></a>01174 
<a name="l01175"></a>01175       2 2
<a name="l01176"></a>01176 
<a name="l01177"></a>01177 in \b solver.inp (i.<a class="code" href="a00032.html#a35b3e91c83139b35bbacfaa59a58afd1">e</a>., 2 processors along \a x, and 2
<a name="l01178"></a>01178 processors along \a y). <a class="code" href="a00032.html#ae9d9a95320de64ce7cd52f941a72f34a">Thus</a>, this example should be run
<a name="l01179"></a>01179 with 4 MPI ranks (or change \b iproc).
<a name="l01180"></a>01180 
<a name="l01181"></a>01181 After running the code, there should be 11 output
<a name="l01182"></a>01182 files \b op_00000.<a class="code" href="a00031.html#a96b9dfbebc4ecd57a32426075fb0c3f2">dat</a>, \b op_00001.<a class="code" href="a00031.html#a96b9dfbebc4ecd57a32426075fb0c3f2">dat</a>, ... \b op_00010.<a class="code" href="a00031.html#a96b9dfbebc4ecd57a32426075fb0c3f2">dat</a>; 
<a name="l01183"></a>01183 the first one is the solution at \f$t=0\f$ and the <span class="keyword">final</span> one
<a name="l01184"></a>01184 is the solution at \f$t=20\f$. Since #<a class="code" href="a00015.html#a4e93cb107e180ef982b74cef7726b70f">HyPar::op_overwrite</a> is
<a name="l01185"></a>01185 <span class="keyword">set</span> to \a no in \b solver.inp, separate files are written
<a name="l01186"></a>01186 <span class="keywordflow">for</span> solutions at each output time. 
<a name="l01187"></a>01187   
<a name="l01188"></a>01188 <span class="preprocessor">#HyPar::op_file_format is set to \a tecplot2d in \b solver.inp, and</span>
<a name="l01189"></a>01189 <span class="preprocessor"></span>thus, all the files are in a format that Tecplot (http:<span class="comment">//www.tecplot.com/)</span>
<a name="l01190"></a>01190 or other visualization software supporting the Tecplot format 
<a name="l01191"></a>01191 (<a class="code" href="a00032.html#a35b3e91c83139b35bbacfaa59a58afd1">e</a>.g. VisIt - https:<span class="comment">//wci.llnl.gov/simulation/computer-codes/visit/)</span>
<a name="l01192"></a>01192 can read. In these files, the first two lines are the Tecplot headers, 
<a name="l01193"></a>01193 after which the data is written out as: the first two columns are grid indices, 
<a name="l01194"></a>01194 the next two columns are x and y coordinates, and the remaining columns are the 
<a name="l01195"></a>01195 solution components.  #<a class="code" href="a00015.html#a51a3b8c19b86e9e1df5be02b05a6613c">HyPar::op_file_format</a> can be <span class="keyword">set</span> to \a <a class="code" href="a00031.html#a314f90bacf496961ff4bfef89fea32c0">text</a> to <span class="keyword">get</span> the solution
<a name="l01196"></a>01196 files in plain <a class="code" href="a00031.html#a314f90bacf496961ff4bfef89fea32c0">text</a> format (which can be read in and visualized in
<a name="l01197"></a>01197 MATLAB <span class="keywordflow">for</span> example).
<a name="l01198"></a>01198 
<a name="l01199"></a>01199 The following plot shows the density contours at the <span class="keyword">final</span> time t=1, 
<a name="l01200"></a>01200 obtained from plotting \b op_00010.dat:
<a name="l01201"></a>01201 @image html Solution_2DNavStokVortex.gif
<a name="l01202"></a>01202 
<a name="l01203"></a>01203 Since the exact solution is available at the <span class="keyword">final</span> time 
<a name="l01204"></a>01204 (\a exact.inp is a <a class="code" href="a00063.html#af77238a13603775a1f60ae9206d86600">copy</a> of \a initial.inp), the numerical 
<a name="l01205"></a>01205 errors are calculated and reported on screen (see below)
<a name="l01206"></a>01206 as well as \b errors.dat:
<a name="l01207"></a>01207 \include 2D/<a class="code" href="a00021.html" title="Structure containing variables and parameters specific to the 2D Navier Stokes equations...">NavierStokes2D</a>/InviscidVortexConvection/errors.dat
<a name="l01208"></a>01208 The numbers are: number of grid points in each dimension (#<a class="code" href="a00015.html#aa989ebb755986852177779cdf7bd8c85">HyPar::dim_global</a>), 
<a name="l01209"></a>01209 number of processors in each dimension (#<a class="code" href="a00019.html#a0be0f30a83bc3f3d9f6ee3a36bbf2716">MPIVariables::iproc</a>),
<a name="l01210"></a>01210 time step size (#<a class="code" href="a00015.html#a03e28be41881b703c836edbfe9b51b17">HyPar::dt</a>),
<a name="l01211"></a>01211 L1, L2, and L-infinity errors (#<a class="code" href="a00015.html#aa40f27cb2afa2db0f0468962be8b3679">HyPar::error</a>),
<a name="l01212"></a>01212 solver wall time (seconds) (i.e., not accounting <span class="keywordflow">for</span> initialization,
<a name="l01213"></a>01213 and cleaning up),
<a name="l01214"></a>01214 and total wall time.
<a name="l01215"></a>01215 
<a name="l01216"></a>01216 Since #<a class="code" href="a00015.html#ac92c34fe456d92c694eacd2231f5a7b1">HyPar::ConservationCheck</a> is <span class="keyword">set</span> to \a yes in \b solver.inp,
<a name="l01217"></a>01217 the code checks <span class="keywordflow">for</span> conservation error and prints it to screen, as well
<a name="l01218"></a>01218 as the file \b conservation.dat:
<a name="l01219"></a>01219 \include 2D/<a class="code" href="a00021.html" title="Structure containing variables and parameters specific to the 2D Navier Stokes equations...">NavierStokes2D</a>/InviscidVortexConvection/conservation.dat
<a name="l01220"></a>01220 The numbers are: number of grid points in each dimension (#<a class="code" href="a00015.html#aa989ebb755986852177779cdf7bd8c85">HyPar::dim_global</a>),
<a name="l01221"></a>01221 number of processors in each dimension (#<a class="code" href="a00019.html#a0be0f30a83bc3f3d9f6ee3a36bbf2716">MPIVariables::iproc</a>),
<a name="l01222"></a>01222 time step size (#<a class="code" href="a00015.html#a03e28be41881b703c836edbfe9b51b17">HyPar::dt</a>),
<a name="l01223"></a>01223 and conservation error (#<a class="code" href="a00015.html#a965363cd64ce50ae17705dfb285dd0ab">HyPar::ConservationError</a>) of each component.
<a name="l01224"></a>01224 
<a name="l01225"></a>01225 Expected screen output:
<a name="l01226"></a>01226 \include 2D/<a class="code" href="a00021.html" title="Structure containing variables and parameters specific to the 2D Navier Stokes equations...">NavierStokes2D</a>/InviscidVortexConvection/output.log
<a name="l01227"></a>01227 
<a name="l01228"></a>01228 
<a name="l01229"></a>01229 \<a class="code" href="a00032.html#a23a77f360d9ab0a90b11ff01314b6526">page</a> euler2d_igwave 2D Euler Equations (with gravitational force) - Inertia-Gravity Waves
<a name="l01230"></a>01230 
<a name="l01231"></a>01231 <a class="code" href="a00031.html#af7342acc7b7299a81e83b43ed11b9f84">Location</a>: \b hypar/<a class="code" href="a00031.html#a60f502575a2e782807ea78c05f76ae03">Examples</a>/2D/<a class="code" href="a00021.html" title="Structure containing variables and parameters specific to the 2D Navier Stokes equations...">NavierStokes2D</a>/InertiaGravityWave
<a name="l01232"></a>01232           (This directory contains all the input files needed
<a name="l01233"></a>01233           to run <span class="keyword">this</span> <span class="keywordflow">case</span>. If there is a \a Run.m, run it in
<a name="l01234"></a>01234           MATLAB to quickly <span class="keyword">set</span> up, run, and visualize the 
<a name="l01235"></a>01235           example).
<a name="l01236"></a>01236 
<a name="l01237"></a>01237 Governing equations: 2D Euler Equations (navierstokes2d.h - By <span class="keywordflow">default</span>,
<a name="l01238"></a>01238                      #<a class="code" href="a00021.html#a3b92a4b98cedf64473b3c13dfa7674b4">NavierStokes2D::Re</a> is <span class="keyword">set</span> to \b -1 which makes the
<a name="l01239"></a>01239                      code skip the parabolic terms, i.e., the 2D Euler
<a name="l01240"></a>01240                      equations are solved.)
<a name="l01241"></a>01241 
<a name="l01242"></a>01242 Reference:
<a name="l01243"></a>01243   + W. C. Skamarock and J. B. Klemp, <span class="stringliteral">&quot;Efficiency and accuracy of </span>
<a name="l01244"></a>01244 <span class="stringliteral">    the Klemp-Wilhelmson timesplitting technique&quot;</span>, Monthly Weather 
<a name="l01245"></a>01245     Review, 122 (1994), pp. 2623–2630.
<a name="l01246"></a>01246   + Giraldo, F.X., Restelli, M., <span class="stringliteral">&quot;A study of spectral element and</span>
<a name="l01247"></a>01247 <span class="stringliteral">    discontinuous Galerkin methods for the Navier–Stokes equations</span>
<a name="l01248"></a>01248 <span class="stringliteral">    in nonhydrostatic mesoscale atmospheric modeling: Equation sets</span>
<a name="l01249"></a>01249 <span class="stringliteral">    and test cases&quot;</span>, J. Comput. Phys., 227, 2008, 3849--3877, 
<a name="l01250"></a>01250     (Section 3.1).
<a name="l01251"></a>01251 
<a name="l01252"></a>01252 <a class="code" href="a00031.html#a948095327123305f3fdf2b293b55381e">Domain</a>: \f$0 \le x \le 300,000\,m, 0 \le y \le 10,000\,m\f$, \a <span class="stringliteral">&quot;periodic&quot;</span> (#<a class="code" href="a00037.html#a65ffa4253dee762c65092abcf04ecdee">_PERIODIC_</a>)
<a name="l01253"></a>01253         boundary <a class="code" href="a00063.html#a07bca284db2938db7ad469438892ca47">conditions</a> along \f$x\f$, <span class="stringliteral">&quot;slip-wall&quot;</span> (#<a class="code" href="a00037.html#af3a9f3ba15bc914ed0a88295aee147e8">_SLIP_WALL_</a>) boundary <a class="code" href="a00063.html#a07bca284db2938db7ad469438892ca47">conditions</a> along \f$y\f$.
<a name="l01254"></a>01254 
<a name="l01255"></a>01255 Initial solution: See references above.
<a name="l01256"></a>01256 
<a name="l01257"></a>01257 Other parameters (all dimensional quantities are in SI units):
<a name="l01258"></a>01258   + Specific heat ratio \f$\gamma = 1.4\f$ (#<a class="code" href="a00021.html#a72f9e01745b3a8203067ab84aefc9aea">NavierStokes2D::gamma</a>)
<a name="l01259"></a>01259   + Universal gas constant \f$R = 287.058\f$ (#<a class="code" href="a00021.html#a228eb5e837a644887ac6e7bab3f42485">NavierStokes2D::R</a>)
<a name="l01260"></a>01260   + Gravitational force per unit mass \f$g = 9.8\f$ along \a y-axis (#<a class="code" href="a00021.html#adf08e308b453bd2d4e117576e493ed03">NavierStokes2D::grav_y</a>)
<a name="l01261"></a>01261   + Reference density (at zero altitude) \f$\rho_{ref} = 1.1612055171196529\f$ (#<a class="code" href="a00021.html#a1e6f66261d19a1c1c272e8808bd2657b">NavierStokes2D::rho0</a>)
<a name="l01262"></a>01262   + Reference <a class="code" href="a00032.html#a58d87a94271c7f86a36fafc7117fe0b0">pressure</a> (at zero altitude) \f$P_{ref} = 100000\f$ (#<a class="code" href="a00021.html#a8be9de5ac626cddcd15c5ec181619694">NavierStokes2D::p0</a>)
<a name="l01263"></a>01263   + Hydrostatic balance type 3 (#<a class="code" href="a00021.html#a2e01ef077b0fedaea9e286ccdf2fe259">NavierStokes2D::HB</a>)
<a name="l01264"></a>01264   + Brunt-Vaisala frequency 0.01 (#<a class="code" href="a00021.html#aa79c64518f6e9127d9b201bacd398174">NavierStokes2D::N_bv</a>)
<a name="l01265"></a>01265 
<a name="l01266"></a>01266 Numerical method:
<a name="l01267"></a>01267  + Spatial discretization (hyperbolic): 5th order WENO (<a class="code" href="a00041.html#af2195885ad055989a1b2b11655843343" title="5th order WENO reconstruction (component-wise) on a uniform grid">Interp1PrimFifthOrderWENO</a>())
<a name="l01268"></a>01268  + Time integration: SSPRK3 (<a class="code" href="a00061.html#aca6ebec6e6998f0c509bb38fa91f3321">TimeRK</a>(), #<a class="code" href="a00061.html#a97e67bb275d6a2dad40b184579559f82">_RK_SSP3_</a>)
<a name="l01269"></a>01269 
<a name="l01270"></a>01270 Input files <a class="code" href="a00032.html#af7a1b4a66a5b6f9ac8eebf2c23b51e9e">required</a>:
<a name="l01271"></a>01271 ---------------------
<a name="l01272"></a>01272 
<a name="l01273"></a>01273 \b solver.inp
<a name="l01274"></a>01274 \include 2D/<a class="code" href="a00021.html" title="Structure containing variables and parameters specific to the 2D Navier Stokes equations...">NavierStokes2D</a>/InertiaGravityWave/solver.inp
<a name="l01275"></a>01275 
<a name="l01276"></a>01276 \b boundary.inp
<a name="l01277"></a>01277 \include 2D/<a class="code" href="a00021.html" title="Structure containing variables and parameters specific to the 2D Navier Stokes equations...">NavierStokes2D</a>/InertiaGravityWave/boundary.inp
<a name="l01278"></a>01278 
<a name="l01279"></a>01279 \b physics.inp
<a name="l01280"></a>01280 \include 2D/<a class="code" href="a00021.html" title="Structure containing variables and parameters specific to the 2D Navier Stokes equations...">NavierStokes2D</a>/InertiaGravityWave/physics.inp
<a name="l01281"></a>01281 
<a name="l01282"></a>01282 \b weno.inp (optional)
<a name="l01283"></a>01283 \include 2D/<a class="code" href="a00021.html" title="Structure containing variables and parameters specific to the 2D Navier Stokes equations...">NavierStokes2D</a>/InertiaGravityWave/weno.inp
<a name="l01284"></a>01284 \b <a class="code" href="a00032.html#a86616b1951d3af95df5b7115dd30438f">Note</a>: \a no_limiting is set to 1, i.<a class="code" href="a00032.html#a35b3e91c83139b35bbacfaa59a58afd1">e</a>., since this is a 
<a name="l01285"></a>01285 smooth problem, WENO limiting is turned off, and the spatial
<a name="l01286"></a>01286 discretization uses a 5th order polynomial.
<a name="l01287"></a>01287 
<a name="l01288"></a>01288 To generate \b initial.inp (initial solution), compile 
<a name="l01289"></a>01289 and run the following code in the run directory.
<a name="l01290"></a>01290 \include 2D/<a class="code" href="a00021.html" title="Structure containing variables and parameters specific to the 2D Navier Stokes equations...">NavierStokes2D</a>/InertiaGravityWave/aux/init.c
<a name="l01291"></a>01291 
<a name="l01292"></a>01292 Output:
<a name="l01293"></a>01293 -------
<a name="l01294"></a>01294 <a class="code" href="a00032.html#a86616b1951d3af95df5b7115dd30438f">Note</a> that \b iproc is set to 
<a name="l01295"></a>01295 
<a name="l01296"></a>01296       12 1
<a name="l01297"></a>01297 
<a name="l01298"></a>01298 in \b solver.inp (i.e., 12 processors along \a x, and 1
<a name="l01299"></a>01299 processor along \a y). <a class="code" href="a00032.html#ae9d9a95320de64ce7cd52f941a72f34a">Thus</a>, this example should be run
<a name="l01300"></a>01300 with 12 MPI ranks (or change \b iproc).
<a name="l01301"></a>01301 
<a name="l01302"></a>01302 After running the code, there should be 26 output
<a name="l01303"></a>01303 files \b op_00000.bin, \b op_00001.bin, ... \b op_00025.bin; 
<a name="l01304"></a>01304 the first one is the solution at \f$t=0s\f$ and the final one
<a name="l01305"></a>01305 is the solution at \f$t=3000s\f$. Since <span class="preprocessor">#HyPar::op_overwrite is</span>
<a name="l01306"></a>01306 <span class="preprocessor"></span><span class="keyword">set</span> to \a no in \b solver.inp, separate files are written
<a name="l01307"></a>01307 <span class="keywordflow">for</span> solutions at each output time. 
<a name="l01308"></a>01308   
<a name="l01309"></a>01309 <span class="preprocessor">#HyPar::op_file_format is set to \a binary in \b solver.inp, and</span>
<a name="l01310"></a>01310 <span class="preprocessor"></span>thus, all the files are written out in the binary format, see 
<a name="l01311"></a>01311 <a class="code" href="a00042.html#a067f454c26d85d6cfb4d7d878b3783c9">WriteBinary</a>(). The binary file contains the conserved variables
<a name="l01312"></a>01312 \f$\left(\rho, \rho u, \rho v, e\right)\f$. The following code
<a name="l01313"></a>01313 converts these variables to the primitive variables of interest
<a name="l01314"></a>01314 to atmospheric flows \f$\left(\rho, u, v, p, \theta\right)\f$.
<a name="l01315"></a>01315 It also writes out the hydrostatically balanced quantities 
<a name="l01316"></a>01316 \f$\left(\rho_0,\pi_0, \theta_0\right)\f$ <span class="keywordflow">for</span> <span class="keyword">this</span> <span class="keywordflow">case</span> that
<a name="l01317"></a>01317 can be <a class="code" href="a00032.html#aa2f9253c1a63124e53d64db71f7e7c16">used</a> to compute and plot the temperature and density
<a name="l01318"></a>01318 perturbations. These variables are then written to either
<a name="l01319"></a>01319 a tecplot2d or <a class="code" href="a00031.html#a314f90bacf496961ff4bfef89fea32c0">text</a> file.
<a name="l01320"></a>01320 (compile and run it in the run directory):
<a name="l01321"></a>01321 \include 2D/<a class="code" href="a00021.html" title="Structure containing variables and parameters specific to the 2D Navier Stokes equations...">NavierStokes2D</a>/InertiaGravityWave/aux/PostProcess.c
<a name="l01322"></a>01322 
<a name="l01323"></a>01323 The following plot shows the potential temperature perturbation
<a name="l01324"></a>01324 contours at the <span class="keyword">final</span> time t=3000. It was plotted <span class="keyword">using</span> VisIt
<a name="l01325"></a>01325 (https:<span class="comment">//wci.llnl.gov/simulation/computer-codes/visit/) with </span>
<a name="l01326"></a>01326 tecplot2d format chosen in the above postprocessing code.
<a name="l01327"></a>01327 @image html Solution_2DNavStokIGWave.png
<a name="l01328"></a>01328 
<a name="l01329"></a>01329 If the postprocessing code above was <a class="code" href="a00032.html#aa2f9253c1a63124e53d64db71f7e7c16">used</a> to write out files in 
<a name="l01330"></a>01330 <a class="code" href="a00031.html#a314f90bacf496961ff4bfef89fea32c0">text</a> format, the following MATLAB script can be <a class="code" href="a00032.html#aa2f9253c1a63124e53d64db71f7e7c16">used</a> to generate 
<a name="l01331"></a>01331 plots and visualize the solution:
<a name="l01332"></a>01332 \include 2D/<a class="code" href="a00021.html" title="Structure containing variables and parameters specific to the 2D Navier Stokes equations...">NavierStokes2D</a>/InertiaGravityWave/PlotSolution.m
<a name="l01333"></a>01333 
<a name="l01334"></a>01334 Expected screen output:
<a name="l01335"></a>01335 \include 2D/<a class="code" href="a00021.html" title="Structure containing variables and parameters specific to the 2D Navier Stokes equations...">NavierStokes2D</a>/InertiaGravityWave/output.log
<a name="l01336"></a>01336 
<a name="l01337"></a>01337 
<a name="l01338"></a>01338 
<a name="l01339"></a>01339 \<a class="code" href="a00032.html#a23a77f360d9ab0a90b11ff01314b6526">page</a> euler2d_rtb 2D Euler Equations (with gravitational force) - Rising Thermal Bubble
<a name="l01340"></a>01340 
<a name="l01341"></a>01341 <a class="code" href="a00031.html#af7342acc7b7299a81e83b43ed11b9f84">Location</a>: \b hypar/<a class="code" href="a00031.html#a60f502575a2e782807ea78c05f76ae03">Examples</a>/2D/<a class="code" href="a00021.html" title="Structure containing variables and parameters specific to the 2D Navier Stokes equations...">NavierStokes2D</a>/RisingThermalBubble
<a name="l01342"></a>01342           (This directory contains all the input files needed
<a name="l01343"></a>01343           to run <span class="keyword">this</span> <span class="keywordflow">case</span>. If there is a \a Run.m, run it in
<a name="l01344"></a>01344           MATLAB to quickly <span class="keyword">set</span> up, run, and visualize the 
<a name="l01345"></a>01345           example).
<a name="l01346"></a>01346 
<a name="l01347"></a>01347 Governing equations: 2D Euler Equations (navierstokes2d.h - By <span class="keywordflow">default</span>,
<a name="l01348"></a>01348                      #<a class="code" href="a00021.html#a3b92a4b98cedf64473b3c13dfa7674b4">NavierStokes2D::Re</a> is <span class="keyword">set</span> to \b -1 which makes the
<a name="l01349"></a>01349                      code skip the parabolic terms, i.e., the 2D Euler
<a name="l01350"></a>01350                      equations are solved.)
<a name="l01351"></a>01351 
<a name="l01352"></a>01352 Reference:
<a name="l01353"></a>01353   + Giraldo, F.X., Restelli, M., <span class="stringliteral">&quot;A study of spectral element and</span>
<a name="l01354"></a>01354 <span class="stringliteral">    discontinuous Galerkin methods for the Navier–Stokes equations</span>
<a name="l01355"></a>01355 <span class="stringliteral">    in nonhydrostatic mesoscale atmospheric modeling: Equation sets</span>
<a name="l01356"></a>01356 <span class="stringliteral">    and test cases&quot;</span>, J. Comput. Phys., 227, 2008, 3849--3877, 
<a name="l01357"></a>01357     (Section 3.2).
<a name="l01358"></a>01358 
<a name="l01359"></a>01359 Domain: \f$0 \le x,y \le 1000\,m\f$, 
<a name="l01360"></a>01360         <span class="stringliteral">&quot;slip-wall&quot;</span> (#<a class="code" href="a00037.html#af3a9f3ba15bc914ed0a88295aee147e8">_SLIP_WALL_</a>) boundary <a class="code" href="a00063.html#a07bca284db2938db7ad469438892ca47">conditions</a> on all sides.
<a name="l01361"></a>01361 
<a name="l01362"></a>01362 Initial solution: See references above.
<a name="l01363"></a>01363 
<a name="l01364"></a>01364 Other parameters (all dimensional quantities are in SI units):
<a name="l01365"></a>01365   + Specific heat ratio \f$\gamma = 1.4\f$ (#<a class="code" href="a00021.html#a72f9e01745b3a8203067ab84aefc9aea">NavierStokes2D::gamma</a>)
<a name="l01366"></a>01366   + Universal gas constant \f$R = 287.058\f$ (#<a class="code" href="a00021.html#a228eb5e837a644887ac6e7bab3f42485">NavierStokes2D::R</a>)
<a name="l01367"></a>01367   + Gravitational force per unit mass \f$g = 9.8\f$ along \a y-axis (#<a class="code" href="a00021.html#adf08e308b453bd2d4e117576e493ed03">NavierStokes2D::grav_y</a>)
<a name="l01368"></a>01368   + Reference density (at zero altitude) \f$\rho_{ref} = 1.1612055171196529\f$ (#<a class="code" href="a00021.html#a1e6f66261d19a1c1c272e8808bd2657b">NavierStokes2D::rho0</a>)
<a name="l01369"></a>01369   + Reference <a class="code" href="a00032.html#a58d87a94271c7f86a36fafc7117fe0b0">pressure</a> (at zero altitude) \f$P_{ref} = 100000\f$ (#<a class="code" href="a00021.html#a8be9de5ac626cddcd15c5ec181619694">NavierStokes2D::p0</a>)
<a name="l01370"></a>01370   + Hydrostatic balance type 2 (#<a class="code" href="a00021.html#a2e01ef077b0fedaea9e286ccdf2fe259">NavierStokes2D::HB</a>)
<a name="l01371"></a>01371 
<a name="l01372"></a>01372 Numerical method:
<a name="l01373"></a>01373  + Spatial discretization (hyperbolic): 5th order WENO (<a class="code" href="a00041.html#af2195885ad055989a1b2b11655843343" title="5th order WENO reconstruction (component-wise) on a uniform grid">Interp1PrimFifthOrderWENO</a>())
<a name="l01374"></a>01374  + Time integration: SSPRK3 (<a class="code" href="a00061.html#aca6ebec6e6998f0c509bb38fa91f3321">TimeRK</a>(), <span class="preprocessor">#_RK_SSP3_)</span>
<a name="l01375"></a>01375 <span class="preprocessor"></span>
<a name="l01376"></a>01376 Input files <a class="code" href="a00032.html#af7a1b4a66a5b6f9ac8eebf2c23b51e9e">required</a>:
<a name="l01377"></a>01377 ---------------------
<a name="l01378"></a>01378 
<a name="l01379"></a>01379 \b solver.inp
<a name="l01380"></a>01380 \include 2D/<a class="code" href="a00021.html" title="Structure containing variables and parameters specific to the 2D Navier Stokes equations...">NavierStokes2D</a>/RisingThermalBubble/solver.inp
<a name="l01381"></a>01381 
<a name="l01382"></a>01382 \b boundary.inp
<a name="l01383"></a>01383 \include 2D/<a class="code" href="a00021.html" title="Structure containing variables and parameters specific to the 2D Navier Stokes equations...">NavierStokes2D</a>/RisingThermalBubble/boundary.inp
<a name="l01384"></a>01384 
<a name="l01385"></a>01385 \b physics.inp
<a name="l01386"></a>01386 \include 2D/<a class="code" href="a00021.html" title="Structure containing variables and parameters specific to the 2D Navier Stokes equations...">NavierStokes2D</a>/RisingThermalBubble/physics.inp
<a name="l01387"></a>01387 
<a name="l01388"></a>01388 \b weno.inp (optional)
<a name="l01389"></a>01389 \include 2D/<a class="code" href="a00021.html" title="Structure containing variables and parameters specific to the 2D Navier Stokes equations...">NavierStokes2D</a>/RisingThermalBubble/weno.inp
<a name="l01390"></a>01390 
<a name="l01391"></a>01391 To generate \b initial.inp (initial solution), compile 
<a name="l01392"></a>01392 and run the following code in the run directory.
<a name="l01393"></a>01393 \include 2D/<a class="code" href="a00021.html" title="Structure containing variables and parameters specific to the 2D Navier Stokes equations...">NavierStokes2D</a>/RisingThermalBubble/aux/init.c
<a name="l01394"></a>01394 
<a name="l01395"></a>01395 Output:
<a name="l01396"></a>01396 -------
<a name="l01397"></a>01397 <a class="code" href="a00032.html#a86616b1951d3af95df5b7115dd30438f">Note</a> that \b iproc is <span class="keyword">set</span> to 
<a name="l01398"></a>01398 
<a name="l01399"></a>01399       4 3
<a name="l01400"></a>01400 
<a name="l01401"></a>01401 in \b solver.inp (i.e., 4 processors along \a x, and 3
<a name="l01402"></a>01402 processor along \a y). Thus, <span class="keyword">this</span> example should be run
<a name="l01403"></a>01403 with 12 MPI ranks (or change \b iproc).
<a name="l01404"></a>01404 
<a name="l01405"></a>01405 After running the code, there should be 41 output
<a name="l01406"></a>01406 files \b op_00000.bin, \b op_00001.bin, ... \b op_00040.bin; 
<a name="l01407"></a>01407 the first one is the solution at \f$t=0s\f$ and the <span class="keyword">final</span> one
<a name="l01408"></a>01408 is the solution at \f$t=700s\f$. Since #<a class="code" href="a00015.html#a4e93cb107e180ef982b74cef7726b70f">HyPar::op_overwrite</a> is
<a name="l01409"></a>01409 <span class="keyword">set</span> to \a no in \b solver.inp, separate files are written
<a name="l01410"></a>01410 <span class="keywordflow">for</span> solutions at each output time. 
<a name="l01411"></a>01411   
<a name="l01412"></a>01412 <span class="preprocessor">#HyPar::op_file_format is set to \a binary in \b solver.inp, and</span>
<a name="l01413"></a>01413 <span class="preprocessor"></span>thus, all the files are written out in the binary format, see 
<a name="l01414"></a>01414 <a class="code" href="a00042.html#a067f454c26d85d6cfb4d7d878b3783c9">WriteBinary</a>(). The binary file contains the conserved variables
<a name="l01415"></a>01415 \f$\left(\rho, \rho u, \rho v, e\right)\f$. The following code
<a name="l01416"></a>01416 converts these variables to the primitive variables of interest
<a name="l01417"></a>01417 to atmospheric flows \f$\left(\rho, u, v, p, \theta\right)\f$.
<a name="l01418"></a>01418 It also writes out the hydrostatically balanced quantities 
<a name="l01419"></a>01419 \f$\left(\rho_0,\pi_0, \theta_0\right)\f$ <span class="keywordflow">for</span> <span class="keyword">this</span> <span class="keywordflow">case</span> that
<a name="l01420"></a>01420 can be <a class="code" href="a00032.html#aa2f9253c1a63124e53d64db71f7e7c16">used</a> to compute and plot the temperature and density
<a name="l01421"></a>01421 perturbations. These variables are then written to either
<a name="l01422"></a>01422 a tecplot2d or <a class="code" href="a00031.html#a314f90bacf496961ff4bfef89fea32c0">text</a> file.
<a name="l01423"></a>01423 (compile and run it in the run directory):
<a name="l01424"></a>01424 \include 2D/<a class="code" href="a00021.html" title="Structure containing variables and parameters specific to the 2D Navier Stokes equations...">NavierStokes2D</a>/RisingThermalBubble/aux/PostProcess.c
<a name="l01425"></a>01425 
<a name="l01426"></a>01426 The following plot shows the potential temperature perturbation
<a name="l01427"></a>01427 contours at the <span class="keyword">final</span> time t=700s. It was plotted <span class="keyword">using</span> VisIt
<a name="l01428"></a>01428 (https:<span class="comment">//wci.llnl.gov/simulation/computer-codes/visit/) with </span>
<a name="l01429"></a>01429 tecplot2d format chosen in the above postprocessing code.
<a name="l01430"></a>01430 @image html Solution_2DNavStokRTB.png
<a name="l01431"></a>01431 
<a name="l01432"></a>01432 The following animation was created <span class="keyword">using</span> all the <span class="keyword">transient</span> files:
<a name="l01433"></a>01433 @image html Solution_2DNavStokRTB.gif
<a name="l01434"></a>01434 
<a name="l01435"></a>01435 If the postprocessing code above was <a class="code" href="a00032.html#aa2f9253c1a63124e53d64db71f7e7c16">used</a> to write out files in 
<a name="l01436"></a>01436 <a class="code" href="a00031.html#a314f90bacf496961ff4bfef89fea32c0">text</a> format, the following MATLAB script can be <a class="code" href="a00032.html#aa2f9253c1a63124e53d64db71f7e7c16">used</a> to generate 
<a name="l01437"></a>01437 plots and visualize the solution:
<a name="l01438"></a>01438 \include 2D/<a class="code" href="a00021.html" title="Structure containing variables and parameters specific to the 2D Navier Stokes equations...">NavierStokes2D</a>/RisingThermalBubble/PlotSolution.m
<a name="l01439"></a>01439 
<a name="l01440"></a>01440 Expected screen output:
<a name="l01441"></a>01441 \include 2D/<a class="code" href="a00021.html" title="Structure containing variables and parameters specific to the 2D Navier Stokes equations...">NavierStokes2D</a>/RisingThermalBubble/output.log
<a name="l01442"></a>01442 
<a name="l01443"></a>01443 
<a name="l01444"></a>01444 \<a class="code" href="a00032.html#a23a77f360d9ab0a90b11ff01314b6526">page</a> navstok2d_ldsc 2D Navier-Stokes Equations -  Lid-Driven Square Cavity
<a name="l01445"></a>01445 
<a name="l01446"></a>01446 <a class="code" href="a00031.html#af7342acc7b7299a81e83b43ed11b9f84">Location</a>: \b hypar/<a class="code" href="a00031.html#a60f502575a2e782807ea78c05f76ae03">Examples</a>/2D/<a class="code" href="a00021.html" title="Structure containing variables and parameters specific to the 2D Navier Stokes equations...">NavierStokes2D</a>/LidDrivenCavity
<a name="l01447"></a>01447           (This directory contains all the input files needed
<a name="l01448"></a>01448           to run <span class="keyword">this</span> <span class="keywordflow">case</span>. If there is a \a Run.m, run it in
<a name="l01449"></a>01449           MATLAB to quickly <span class="keyword">set</span> up, run, and visualize the 
<a name="l01450"></a>01450           example).
<a name="l01451"></a>01451 
<a name="l01452"></a>01452 Governing equations: 2D Navier-Stokes Equations (navierstokes2d.h)
<a name="l01453"></a>01453 
<a name="l01454"></a>01454 Reference: 
<a name="l01455"></a>01455 + Erturk, E., Corke, T.C., and Gokcol, C., &quot;Numerical Solutions of
<a name="l01456"></a>01456   2-D Steady Incompressible Driven Cavity Flow at High Reynolds Numbers&quot;,
<a name="l01457"></a>01457   International Journal for Numerical Methods in Fluids, 48, 2005,
<a name="l01458"></a>01458   http:<span class="comment">//dx.doi.org/10.1002/fld.953.</span>
<a name="l01459"></a>01459 + Ghia, U., Ghia, K.N., Shin, C.T., &quot;High-Re Solutions for Incompressible
<a name="l01460"></a>01460   Flow using the Navier-Stokes Equations and a Multigrid <a class="code" href="a00033.html#a1610bc0f5a3c1062419d67e161327d37">Method</a>&quot;, Journal
<a name="l01461"></a>01461   of Computational Physics, 48, 1982, http:<span class="comment">//dx.doi.org/10.1016/0021-9991(82)90058-4.</span>
<a name="l01462"></a>01462 
<a name="l01463"></a>01463 <a class="code" href="a00032.html#a86616b1951d3af95df5b7115dd30438f">Note</a> that this is an incompressible problem being solved here using the compressible
<a name="l01464"></a>01464 Navier-Stokes equations in terms of non-dimensional flow variables. The density and 
<a name="l01465"></a>01465 <a class="code" href="a00032.html#a58d87a94271c7f86a36fafc7117fe0b0">pressure</a> are taken such that the speed of sound is 1.0, and the flow velocities 
<a name="l01466"></a>01466 <a class="code" href="a00032.html#aa18752ebe19b49b626048c92d4586801">specified</a> in the initial and boundary <a class="code" href="a00063.html#a07bca284db2938db7ad469438892ca47">conditions</a> correspond to a characteristic 
<a name="l01467"></a>01467 Mach number of 0.1 (thus, they are 0.1 times the values in the above reference).
<a name="l01468"></a>01468 
<a name="l01469"></a>01469 <a class="code" href="a00031.html#a948095327123305f3fdf2b293b55381e">Domain</a>: \f$0 \le x, y \le 1\f$
<a name="l01470"></a>01470 
<a name="l01471"></a>01471 Boundary <a class="code" href="a00063.html#a07bca284db2938db7ad469438892ca47">conditions</a>:
<a name="l01472"></a>01472 + No-slip wall BC on \f$x=0,1, 0 \le y \le 1\f$ (<span class="preprocessor">#_NOSLIP_WALL_ with 0 wall velocity).</span>
<a name="l01473"></a>01473 <span class="preprocessor"></span>+ No-slip wall BC on \f$y=0, 0 \le x \le 1\f$ (#<a class="code" href="a00037.html#affb6a9c452f92435e738bd59b9c98935">_NOSLIP_WALL_</a> with 0 wall <a class="code" href="a00032.html#a19f4bd496612921d5231e400a3c27ed4">velocity</a>).
<a name="l01474"></a>01474 + Moving no-slip wall BC on \f$y=1, 0 \le x \le 1\f$ (#<a class="code" href="a00037.html#affb6a9c452f92435e738bd59b9c98935">_NOSLIP_WALL_</a> with <a class="code" href="a00032.html#aa18752ebe19b49b626048c92d4586801">specified</a> 
<a name="l01475"></a>01475   wall <a class="code" href="a00032.html#a19f4bd496612921d5231e400a3c27ed4">velocity</a> of 0.1 in the x-direction).
<a name="l01476"></a>01476 
<a name="l01477"></a>01477 Initial solution: \f$\rho=1, p=1/\gamma\f$. The velocities are <a class="code" href="a00032.html#aa18752ebe19b49b626048c92d4586801">specified</a> according to 
<a name="l01478"></a>01478 the references above, but scaled <a class="code" href="a00032.html#a124150da8eed3d9f42e9361cc143ed7e">by</a> a factor of 0.1 to ensure that the characteristic
<a name="l01479"></a>01479 Mach number is 0.1.
<a name="l01480"></a>01480 
<a name="l01481"></a>01481 Other parameters:
<a name="l01482"></a>01482   + \f$\gamma = 1.4\f$ (#<a class="code" href="a00021.html#a72f9e01745b3a8203067ab84aefc9aea">NavierStokes2D::gamma</a>)
<a name="l01483"></a>01483   + \f$Re = \frac {\rho u L } {\mu} = 100, 1000, 3200\f$ (Reynolds number) (#<a class="code" href="a00021.html#a3b92a4b98cedf64473b3c13dfa7674b4">NavierStokes2D::Re</a>), 
<a name="l01484"></a>01484     where \f$L=1\f$ is the cavity length and width.
<a name="l01485"></a>01485   + \f$Pr = 0.72\f$ (Prandtl number) (#<a class="code" href="a00021.html#af0f6e03342b9eb912e25f94ce0249a2c">NavierStokes2D::Pr</a>)
<a name="l01486"></a>01486   + \f$M_\infty = 0.1\f$ (characteristic Mach number) (#<a class="code" href="a00021.html#aa5f774fe7b4f69be5e085f1988ef2a6d">NavierStokes2D::Minf</a>)
<a name="l01487"></a>01487 
<a name="l01488"></a>01488 \b <a class="code" href="a00032.html#a86616b1951d3af95df5b7115dd30438f">Note</a>: Pressure is taken as \f$1/\gamma\f$ in the above <a class="code" href="a00063.html#aa012087f27f6c70b31284d8d3fb32dc5">so</a> that the freestream 
<a name="l01489"></a>01489 speed of sound is 1.
<a name="l01490"></a>01490 
<a name="l01491"></a>01491 Numerical method:
<a name="l01492"></a>01492  + Spatial <a class="code" href="a00033.html#a006f5ed6c12ae3d4f8e840cb181a05ca">discretization</a> (hyperbolic): 5th order upwind (<a class="code" href="a00041.html#aea7c973ffe0c37bca0703c1bf6175aaa" title="5th order upwind reconstruction (component-wise) on a uniform grid">Interp1PrimFifthOrderUpwind</a>())
<a name="l01493"></a>01493  + Spatial discretization (parabolic) : 4th order (<a class="code" href="a00038.html#a08c28e6bc4493172df7b7867e1f3d815">FirstDerivativeFourthOrderCentral</a>()) 
<a name="l01494"></a>01494                                         non-conservative 2-stage (<a class="code" href="a00104.html#a9f5c8ed9c587aa71c9f75209222ad67c">ParabolicFunctionNC2Stage</a>())
<a name="l01495"></a>01495  + Time integration: 4th order, 4-stage Runge-Kutta (TimeRK(), #<a class="code" href="a00061.html#a47de987716954223b3c26bb842b21bf8">_RK_44_</a>)
<a name="l01496"></a>01496 
<a name="l01497"></a>01497 Input files <a class="code" href="a00032.html#af7a1b4a66a5b6f9ac8eebf2c23b51e9e">required</a>:
<a name="l01498"></a>01498 ---------------------
<a name="l01499"></a>01499 
<a name="l01500"></a>01500 \b solver.inp
<a name="l01501"></a>01501 \include 2D/<a class="code" href="a00021.html" title="Structure containing variables and parameters specific to the 2D Navier Stokes equations...">NavierStokes2D</a>/LidDrivenCavity/solver.inp
<a name="l01502"></a>01502 
<a name="l01503"></a>01503 \b boundary.inp
<a name="l01504"></a>01504 \include 2D/<a class="code" href="a00021.html" title="Structure containing variables and parameters specific to the 2D Navier Stokes equations...">NavierStokes2D</a>/LidDrivenCavity/boundary.inp
<a name="l01505"></a>01505 
<a name="l01506"></a>01506 \b physics.inp (\b <a class="code" href="a00032.html#a86616b1951d3af95df5b7115dd30438f">Note</a>: this file specifies \f$Re = 3200\f$,
<a name="l01507"></a>01507 change \a Re here for other Reynolds numbers.)
<a name="l01508"></a>01508 \include 2D/<a class="code" href="a00021.html" title="Structure containing variables and parameters specific to the 2D Navier Stokes equations...">NavierStokes2D</a>/LidDrivenCavity/physics.inp
<a name="l01509"></a>01509 
<a name="l01510"></a>01510 To generate \b initial.inp (initial solution), compile 
<a name="l01511"></a>01511 and run the following code in the run directory.
<a name="l01512"></a>01512 \include 2D/<a class="code" href="a00021.html" title="Structure containing variables and parameters specific to the 2D Navier Stokes equations...">NavierStokes2D</a>/LidDrivenCavity/aux/init.c
<a name="l01513"></a>01513 
<a name="l01514"></a>01514 Output:
<a name="l01515"></a>01515 -------
<a name="l01516"></a>01516 <a class="code" href="a00032.html#a86616b1951d3af95df5b7115dd30438f">Note</a> that \b iproc is set to 
<a name="l01517"></a>01517 
<a name="l01518"></a>01518       2 2
<a name="l01519"></a>01519 
<a name="l01520"></a>01520 in \b solver.inp (i.e., 2 processors along \a x, and 2
<a name="l01521"></a>01521 processor along \a y). Thus, this example should be run
<a name="l01522"></a>01522 with 4 MPI ranks (or change \b iproc).
<a name="l01523"></a>01523 
<a name="l01524"></a>01524 After running the code, there should be one output file
<a name="l01525"></a>01525 \b op.<a class="code" href="a00031.html#a96b9dfbebc4ecd57a32426075fb0c3f2">dat</a>, since #<a class="code" href="a00015.html" title="Structure containing all solver-specific variables and functions.">HyPar</a>::op_overwrite is set to \a yes in \b solver.inp.
<a name="l01526"></a>01526 Since #<a class="code" href="a00015.html" title="Structure containing all solver-specific variables and functions.">HyPar</a>::op_file_format is set to \a tecplot2d in \b solver.inp,
<a name="l01527"></a>01527 this file is in the ASCII Tecplot format and can be viewed in any
<a name="l01528"></a>01528 software that supports this format (e.g. VisIt).
<a name="l01529"></a>01529 
<a name="l01530"></a>01530 Following plots show the streamlines (colored <a class="code" href="a00032.html#a124150da8eed3d9f42e9361cc143ed7e">by</a> the <a class="code" href="a00032.html#a19f4bd496612921d5231e400a3c27ed4">velocity</a> magnitude)
<a name="l01531"></a>01531 for the solutions with Reynolds number 100, 1000, and 3200, respectively.
<a name="l01532"></a>01532 @image html Solution_2DNavStokLDSC_Re0100.png
<a name="l01533"></a>01533 @image html Solution_2DNavStokLDSC_Re1000.png
<a name="l01534"></a>01534 @image html Solution_2DNavStokLDSC_Re3200.png
<a name="l01535"></a>01535 
<a name="l01536"></a>01536 Expected screen output (for Reynolds number 3200):
<a name="l01537"></a>01537 \include 2D/<a class="code" href="a00021.html" title="Structure containing variables and parameters specific to the 2D Navier Stokes equations...">NavierStokes2D</a>/LidDrivenCavity/output.log
<a name="l01538"></a>01538 
<a name="l01539"></a>01539 
<a name="l01540"></a>01540 \<a class="code" href="a00032.html#a23a77f360d9ab0a90b11ff01314b6526">page</a> navstok2d_flatplate 2D Navier-Stokes Equations -  Laminar Flow over Flat Plate
<a name="l01541"></a>01541 
<a name="l01542"></a>01542 <a class="code" href="a00031.html#af7342acc7b7299a81e83b43ed11b9f84">Location</a>: \b hypar/<a class="code" href="a00031.html#a60f502575a2e782807ea78c05f76ae03">Examples</a>/2D/<a class="code" href="a00021.html" title="Structure containing variables and parameters specific to the 2D Navier Stokes equations...">NavierStokes2D</a>/FlatPlateLaminar/UniformGrid
<a name="l01543"></a>01543           (This directory contains all the input files needed
<a name="l01544"></a>01544           to run this case. If there is a \a Run.m, run it in
<a name="l01545"></a>01545           MATLAB to quickly set up, run, and visualize the 
<a name="l01546"></a>01546           example).
<a name="l01547"></a>01547 
<a name="l01548"></a>01548 Governing equations: 2D Euler Equations (navierstokes2d.h)
<a name="l01549"></a>01549 
<a name="l01550"></a>01550 Reference: 
<a name="l01551"></a>01551 + Hirsch, <span class="stringliteral">&quot;Numerical Computation of Internal &amp; External Flows&quot;</span>,
<a name="l01552"></a>01552   Volume 1 (Fundamentals of Computational Fluid Dynamics), 2nd 
<a name="l01553"></a>01553   Edition, Elsevier, Section 12.3.2 (<a class="code" href="a00032.html#a23a77f360d9ab0a90b11ff01314b6526">page</a> 618-625).
<a name="l01554"></a>01554 
<a name="l01555"></a>01555 <a class="code" href="a00031.html#a948095327123305f3fdf2b293b55381e">Domain</a>: \f$-0.25 \le x \le 1\f$, \f$0 \le y \le 0.25\f$
<a name="l01556"></a>01556 
<a name="l01557"></a>01557 Boundary <a class="code" href="a00063.html#a07bca284db2938db7ad469438892ca47">conditions</a>:
<a name="l01558"></a>01558 + Symmetry BC on \f$y=0, -0.25 \le x &lt; 0\f$ (imposed through <span class="stringliteral">&quot;slip-wall&quot;</span> 
<a name="l01559"></a>01559   #<a class="code" href="a00037.html#af3a9f3ba15bc914ed0a88295aee147e8">_SLIP_WALL_</a> with 0 wall <a class="code" href="a00032.html#a19f4bd496612921d5231e400a3c27ed4">velocity</a>).
<a name="l01560"></a>01560 + No-slip wall BC on \f$y=0, 0 \le x \le 1\f$ (#<a class="code" href="a00037.html#affb6a9c452f92435e738bd59b9c98935">_NOSLIP_WALL_</a> with 0
<a name="l01561"></a>01561   wall <a class="code" href="a00032.html#a19f4bd496612921d5231e400a3c27ed4">velocity</a>).
<a name="l01562"></a>01562 + Subsonic outflow on \f$y=0.25\f$ (#<a class="code" href="a00037.html#adeb38801d1b832ce3eee3ebc1eed6263">_SUBSONIC_OUTFLOW_</a>) with <a class="code" href="a00032.html#a58d87a94271c7f86a36fafc7117fe0b0">pressure</a>
<a name="l01563"></a>01563   \f$p=1/\gamma\f$.
<a name="l01564"></a>01564 + Subsonic inflow on \f$x=0\f$ (#<a class="code" href="a00037.html#adba2024137894c96339af50efabe3771">_SUBSONIC_INFLOW_</a>) with density \f$\rho=1\f$,
<a name="l01565"></a>01565   and <a class="code" href="a00032.html#a19f4bd496612921d5231e400a3c27ed4">velocity</a> \f$(u,v) = (0.3,0)\f$.
<a name="l01566"></a>01566 + Subsonic outflow on \f$x=1\f$ (#<a class="code" href="a00037.html#adeb38801d1b832ce3eee3ebc1eed6263">_SUBSONIC_OUTFLOW_</a>) with <a class="code" href="a00032.html#a58d87a94271c7f86a36fafc7117fe0b0">pressure</a>
<a name="l01567"></a>01567   \f$p=1/\gamma\f$.
<a name="l01568"></a>01568 
<a name="l01569"></a>01569 Initial solution: Uniform flow with \f$\rho=1, u=0.3, v=0, p=1/\gamma\f$.
<a name="l01570"></a>01570 
<a name="l01571"></a>01571 Other parameters:
<a name="l01572"></a>01572   + \f$\gamma = 1.4\f$ (#<a class="code" href="a00021.html" title="Structure containing variables and parameters specific to the 2D Navier Stokes equations...">NavierStokes2D</a>::gamma)
<a name="l01573"></a>01573   + \f$Re = \frac {\rho u L } {\mu} = 100,000\f$ (Reynolds number) (#<a class="code" href="a00021.html#a3b92a4b98cedf64473b3c13dfa7674b4">NavierStokes2D::Re</a>), 
<a name="l01574"></a>01574     where \f$L=1\f$ is the plate length .
<a name="l01575"></a>01575   + \f$Pr = 0.72\f$ (Prandtl number) (#<a class="code" href="a00021.html#af0f6e03342b9eb912e25f94ce0249a2c">NavierStokes2D::Pr</a>)
<a name="l01576"></a>01576   + \f$M_\infty = 0.3\f$ (freestream Mach number) (#<a class="code" href="a00021.html#aa5f774fe7b4f69be5e085f1988ef2a6d">NavierStokes2D::Minf</a>)
<a name="l01577"></a>01577 
<a name="l01578"></a>01578 \b <a class="code" href="a00032.html#a86616b1951d3af95df5b7115dd30438f">Note</a>: Pressure is taken as \f$1/\gamma\f$ in the above <a class="code" href="a00063.html#aa012087f27f6c70b31284d8d3fb32dc5">so</a> that the freestream 
<a name="l01579"></a>01579 speed of sound is 1.
<a name="l01580"></a>01580 
<a name="l01581"></a>01581 Numerical method:
<a name="l01582"></a>01582  + Spatial <a class="code" href="a00033.html#a006f5ed6c12ae3d4f8e840cb181a05ca">discretization</a> (hyperbolic): 5th order WENO (<a class="code" href="a00041.html#af2195885ad055989a1b2b11655843343" title="5th order WENO reconstruction (component-wise) on a uniform grid">Interp1PrimFifthOrderWENO</a>())
<a name="l01583"></a>01583  + Spatial discretization (parabolic) : 4th order (<a class="code" href="a00038.html#a08c28e6bc4493172df7b7867e1f3d815">FirstDerivativeFourthOrderCentral</a>()) 
<a name="l01584"></a>01584                                         non-conservative 2-stage (<a class="code" href="a00104.html#a9f5c8ed9c587aa71c9f75209222ad67c">ParabolicFunctionNC2Stage</a>())
<a name="l01585"></a>01585  + Time integration: SSPRK3 (TimeRK(), #<a class="code" href="a00061.html#a97e67bb275d6a2dad40b184579559f82">_RK_SSP3_</a>)
<a name="l01586"></a>01586 
<a name="l01587"></a>01587 This is a steady state problem - the solution converges to a steady laminar flow over a 
<a name="l01588"></a>01588 flat plate, and the residuals decrease with time. The skin friction coefficient is given <a class="code" href="a00032.html#a124150da8eed3d9f42e9361cc143ed7e">by</a>
<a name="l01589"></a>01589 \f{<a class="code" href="a00033.html#ac3f62e1b06188678336543688cb7709e">equation</a>}{
<a name="l01590"></a>01590   c_f = \frac {0.664} {\sqrt{Re_x}}, Re_x = \frac {\rho u x} {\mu}
<a name="l01591"></a>01591 \f}
<a name="l01592"></a>01592 (Blasius solution).
<a name="l01593"></a>01593 
<a name="l01594"></a>01594 Input files <a class="code" href="a00032.html#af7a1b4a66a5b6f9ac8eebf2c23b51e9e">required</a>:
<a name="l01595"></a>01595 ---------------------
<a name="l01596"></a>01596 
<a name="l01597"></a>01597 \b solver.inp
<a name="l01598"></a>01598 \include 2D/<a class="code" href="a00021.html" title="Structure containing variables and parameters specific to the 2D Navier Stokes equations...">NavierStokes2D</a>/FlatPlateLaminar/UniformGrid/solver.inp
<a name="l01599"></a>01599 
<a name="l01600"></a>01600 \b boundary.inp
<a name="l01601"></a>01601 \include 2D/<a class="code" href="a00021.html" title="Structure containing variables and parameters specific to the 2D Navier Stokes equations...">NavierStokes2D</a>/FlatPlateLaminar/UniformGrid/boundary.inp
<a name="l01602"></a>01602 
<a name="l01603"></a>01603 \b physics.inp
<a name="l01604"></a>01604 \include 2D/<a class="code" href="a00021.html" title="Structure containing variables and parameters specific to the 2D Navier Stokes equations...">NavierStokes2D</a>/FlatPlateLaminar/UniformGrid/physics.inp
<a name="l01605"></a>01605 
<a name="l01606"></a>01606 \b weno.inp (optional)
<a name="l01607"></a>01607 \include 2D/<a class="code" href="a00021.html" title="Structure containing variables and parameters specific to the 2D Navier Stokes equations...">NavierStokes2D</a>/FlatPlateLaminar/UniformGrid/weno.inp
<a name="l01608"></a>01608 
<a name="l01609"></a>01609 To generate \b initial.inp (initial solution), compile 
<a name="l01610"></a>01610 and run the following code in the run directory.
<a name="l01611"></a>01611 \include 2D/<a class="code" href="a00021.html" title="Structure containing variables and parameters specific to the 2D Navier Stokes equations...">NavierStokes2D</a>/FlatPlateLaminar/UniformGrid/aux/init.c
<a name="l01612"></a>01612 
<a name="l01613"></a>01613 Output:
<a name="l01614"></a>01614 -------
<a name="l01615"></a>01615 <a class="code" href="a00032.html#a86616b1951d3af95df5b7115dd30438f">Note</a> that \b iproc is <span class="keyword">set</span> to 
<a name="l01616"></a>01616 
<a name="l01617"></a>01617       2 4
<a name="l01618"></a>01618 
<a name="l01619"></a>01619 in \b solver.inp (i.e., 2 processors along \a x, and 4
<a name="l01620"></a>01620 processor along \a y). Thus, <span class="keyword">this</span> example should be run
<a name="l01621"></a>01621 with 8 MPI ranks (or change \b iproc).
<a name="l01622"></a>01622 
<a name="l01623"></a>01623 After running the code, there should be one output file
<a name="l01624"></a>01624 \b op.bin, since #<a class="code" href="a00015.html#a4e93cb107e180ef982b74cef7726b70f">HyPar::op_overwrite</a> is <span class="keyword">set</span> to \a yes in \b solver.inp.
<a name="l01625"></a>01625   
<a name="l01626"></a>01626 <span class="preprocessor">#HyPar::op_file_format is set to \a binary in \b solver.inp, and</span>
<a name="l01627"></a>01627 <span class="preprocessor"></span>thus, all the files are written out in the binary format, see 
<a name="l01628"></a>01628 <a class="code" href="a00042.html#a067f454c26d85d6cfb4d7d878b3783c9">WriteBinary</a>(). The binary file contains the conserved variables
<a name="l01629"></a>01629 \f$\left(\rho, \rho u, \rho v, e\right)\f$. The following two codes
<a name="l01630"></a>01630 are available to convert the binary output file:
<a name="l01631"></a>01631 + \b hypar/Extras/BinaryToTecplot.c - convert binary output file to 
<a name="l01632"></a>01632   Tecplot file (works only <span class="keywordflow">for</span> 2D and 3D).
<a name="l01633"></a>01633 + \b hypar/Extras/BinaryToText.c - convert binary output file to
<a name="l01634"></a>01634   an ASCII <a class="code" href="a00031.html#a314f90bacf496961ff4bfef89fea32c0">text</a> file (to visualize in, <span class="keywordflow">for</span> example, MATLAB).
<a name="l01635"></a>01635 
<a name="l01636"></a>01636 The following plot was obtained <a class="code" href="a00032.html#a124150da8eed3d9f42e9361cc143ed7e">by</a> converting the binary file to the 
<a name="l01637"></a>01637 Tecplot format, and <span class="keyword">using</span> VisIt to plot it (it shows the density 
<a name="l01638"></a>01638 and <a class="code" href="a00032.html#a19f4bd496612921d5231e400a3c27ed4">velocity</a>):
<a name="l01639"></a>01639 @image html Solution_2DNavStokFlatPlate.png
<a name="l01640"></a>01640 The following plot shows a magnified view of the boundary layer:
<a name="l01641"></a>01641 @image html Solution_2DNavStokFlatPlateMagnified.png
<a name="l01642"></a>01642 
<a name="l01643"></a>01643 The following file computes the skin friction as a function of the 
<a name="l01644"></a>01644 Reynolds number and writes to to a <a class="code" href="a00031.html#a314f90bacf496961ff4bfef89fea32c0">text</a> file \b SkinFriction.<a class="code" href="a00031.html#a96b9dfbebc4ecd57a32426075fb0c3f2">dat</a> with 4 
<a name="l01645"></a>01645 columns: Reynolds number, computed skin friction coefficient, exact skin 
<a name="l01646"></a>01646 friction coefficient (\f$0.664/\sqrt{Re_x}\f$), and normal <a class="code" href="a00032.html#a19f4bd496612921d5231e400a3c27ed4">velocity</a> gradient 
<a name="l01647"></a>01647 on the plate surface (\f$\left.\partial u/\partial y\right|_{y=0}\f$). 
<a name="l01648"></a>01648 Compile and run it in the run directory.
<a name="l01649"></a>01649 \include 2D/<a class="code" href="a00021.html" title="Structure containing variables and parameters specific to the 2D Navier Stokes equations...">NavierStokes2D</a>/FlatPlateLaminar/UniformGrid/aux/SkinFriction.c
<a name="l01650"></a>01650 The following figure showing the exact and computed skin friction coefficients
<a name="l01651"></a>01651 was obtained <a class="code" href="a00032.html#a124150da8eed3d9f42e9361cc143ed7e">by</a> plotting \b SkinFriction.dat:
<a name="l01652"></a>01652 @image html Solution_2DNavStokFlatPlateSkinFriction.png
<a name="l01653"></a>01653 
<a name="l01654"></a>01654 Expected screen output:
<a name="l01655"></a>01655 \include 2D/<a class="code" href="a00021.html" title="Structure containing variables and parameters specific to the 2D Navier Stokes equations...">NavierStokes2D</a>/FlatPlateLaminar/UniformGrid/output.log
<a name="l01656"></a>01656 
<a name="l01657"></a>01657 
<a name="l01658"></a>01658 \<a class="code" href="a00032.html#a23a77f360d9ab0a90b11ff01314b6526">page</a> sw_circdambreak 2D Shallow Water Equations - Circular Dam Break
<a name="l01659"></a>01659 
<a name="l01660"></a>01660 <a class="code" href="a00031.html#af7342acc7b7299a81e83b43ed11b9f84">Location</a>: \b hypar/<a class="code" href="a00031.html#a60f502575a2e782807ea78c05f76ae03">Examples</a>/2D/<a class="code" href="a00027.html" title="Structure containing variables and parameters specific to the 2D Shallow Water equations...">ShallowWater2D</a>/CircularDamBreak
<a name="l01661"></a>01661           (This directory contains all the input files needed
<a name="l01662"></a>01662           to run <span class="keyword">this</span> <span class="keywordflow">case</span>. If there is a \a Run.m, run it in
<a name="l01663"></a>01663           MATLAB to quickly <span class="keyword">set</span> up, run, and visualize the 
<a name="l01664"></a>01664           example).
<a name="l01665"></a>01665 
<a name="l01666"></a>01666 Governing equations: 2D Shallow Water Equations (shallowwater2d.h)
<a name="l01667"></a>01667 
<a name="l01668"></a>01668 References:
<a name="l01669"></a>01669   + Delis, Katsaounis, &quot;Numerical solution of the two-dimensional
<a name="l01670"></a>01670     shallow water equations <a class="code" href="a00032.html#a124150da8eed3d9f42e9361cc143ed7e">by</a> the application of relaxation methods&quot;, 
<a name="l01671"></a>01671     Applied Mathematical Modelling, 29 (2005), pp. 754-783 (Section 6.3).
<a name="l01672"></a>01672 
<a name="l01673"></a>01673 <a class="code" href="a00031.html#a948095327123305f3fdf2b293b55381e">Domain</a>: \f$0 \le x,y \le 50 \f$, \a &quot;extrapolate&quot; (<span class="preprocessor">#_EXTRAPOLATE_) boundary</span>
<a name="l01674"></a>01674 <span class="preprocessor"></span>        <a class="code" href="a00063.html#a07bca284db2938db7ad469438892ca47">conditions</a> everywhere
<a name="l01675"></a>01675 
<a name="l01676"></a>01676 Initial solution:
<a name="l01677"></a>01677 \f{<a class="code" href="a00033.html#ac3f62e1b06188678336543688cb7709e">equation</a>}{
<a name="l01678"></a>01678   h\left(x,y\right) = \left\{\begin{array}{cc}10 &amp; r \le 11.0\\1 &amp; {\rm otherwise}\end{array}\right., u\left(x,y\right) = 0.
<a name="l01679"></a>01679 \f}
<a name="l01680"></a>01680 with the bottom topography as \f$b\left(x,y\right) = 0\f$, and 
<a name="l01681"></a>01681 \f$r^2=\left(x-25\right)^2+\left(y-25\right)^2\f$.
<a name="l01682"></a>01682 
<a name="l01683"></a>01683 Other parameters:
<a name="l01684"></a>01684  + \f$g=9.8\f$ (#<a class="code" href="a00027.html#ab30c765b9be1b7776c97c899a12a66bb">ShallowWater2D::g</a>)
<a name="l01685"></a>01685 
<a name="l01686"></a>01686 Numerical Method:
<a name="l01687"></a>01687   + Spatial discretization (hyperbolic): 5th order WENO (<a class="code" href="a00041.html#af2195885ad055989a1b2b11655843343" title="5th order WENO reconstruction (component-wise) on a uniform grid">Interp1PrimFifthOrderWENO</a>())
<a name="l01688"></a>01688   + Time integration: RK4 (TimeRK(), #<a class="code" href="a00061.html#a47de987716954223b3c26bb842b21bf8">_RK_44_</a>)
<a name="l01689"></a>01689 
<a name="l01690"></a>01690 Input files <a class="code" href="a00032.html#af7a1b4a66a5b6f9ac8eebf2c23b51e9e">required</a>:
<a name="l01691"></a>01691 ---------------------
<a name="l01692"></a>01692 
<a name="l01693"></a>01693 <a class="code" href="a00032.html#a86616b1951d3af95df5b7115dd30438f">Note</a>: in <a class="code" href="a00032.html#acd2d71c0bebc6551f6d5d3c2870a9baa">addition</a> to the usual input files that <a class="code" href="a00015.html" title="Structure containing all solver-specific variables and functions.">HyPar</a> needs, this
<a name="l01694"></a>01694 physical <a class="code" href="a00033.html#ac4336de6d1835c2fc39662f53e2f6e2e">model</a> needs the following input file(s):
<a name="l01695"></a>01695 + \b topography.inp : file containing the bottom topography (same
<a name="l01696"></a>01696   format as \b initial.inp).
<a name="l01697"></a>01697 
<a name="l01698"></a>01698 However, this case has a constant (zero) bottom topography, and thus
<a name="l01699"></a>01699 this file can be skipped.
<a name="l01700"></a>01700 
<a name="l01701"></a>01701 \b solver.inp
<a name="l01702"></a>01702 \include 2D/<a class="code" href="a00027.html" title="Structure containing variables and parameters specific to the 2D Shallow Water equations...">ShallowWater2D</a>/CircularDamBreak/solver.inp
<a name="l01703"></a>01703 
<a name="l01704"></a>01704 \b boundary.inp
<a name="l01705"></a>01705 \include 2D/<a class="code" href="a00027.html" title="Structure containing variables and parameters specific to the 2D Shallow Water equations...">ShallowWater2D</a>/CircularDamBreak/boundary.inp
<a name="l01706"></a>01706 
<a name="l01707"></a>01707 \b physics.inp
<a name="l01708"></a>01708 \include 2D/<a class="code" href="a00027.html" title="Structure containing variables and parameters specific to the 2D Shallow Water equations...">ShallowWater2D</a>/CircularDamBreak/physics.inp
<a name="l01709"></a>01709 
<a name="l01710"></a>01710 \b weno.inp (optional)
<a name="l01711"></a>01711 \include 2D/<a class="code" href="a00027.html" title="Structure containing variables and parameters specific to the 2D Shallow Water equations...">ShallowWater2D</a>/CircularDamBreak/weno.inp
<a name="l01712"></a>01712 
<a name="l01713"></a>01713 To generate \b initial.inp and \b topography.inp, compile and run the 
<a name="l01714"></a>01714 following code in the run directory (note: topography.inp can be skipped
<a name="l01715"></a>01715 since this case involves a uniform topography).
<a name="l01716"></a>01716 \include 2D/<a class="code" href="a00027.html" title="Structure containing variables and parameters specific to the 2D Shallow Water equations...">ShallowWater2D</a>/CircularDamBreak/aux/init.c
<a name="l01717"></a>01717 
<a name="l01718"></a>01718 Output:
<a name="l01719"></a>01719 -------
<a name="l01720"></a>01720 <a class="code" href="a00032.html#a86616b1951d3af95df5b7115dd30438f">Note</a> that \b iproc is set to 
<a name="l01721"></a>01721 
<a name="l01722"></a>01722       2 2
<a name="l01723"></a>01723 
<a name="l01724"></a>01724 in \b solver.inp (i.e., 2 processors along \a x, and 2
<a name="l01725"></a>01725 processors along \a y). Thus, this example should be run
<a name="l01726"></a>01726 with 4 MPI ranks (or change \b iproc).
<a name="l01727"></a>01727 
<a name="l01728"></a>01728 After running the code, there should be 6 solution output files
<a name="l01729"></a>01729 \b op_00000.<a class="code" href="a00031.html#a96b9dfbebc4ecd57a32426075fb0c3f2">dat</a>, ..., \b op_00005.<a class="code" href="a00031.html#a96b9dfbebc4ecd57a32426075fb0c3f2">dat</a>; the first one is the solution 
<a name="l01730"></a>01730 at \f$t=0\f$ and the <span class="keyword">final</span> one is the solution at \f$t=0.69\f$. Since
<a name="l01731"></a>01731 <span class="preprocessor">#HyPar::op_overwrite is set to \a no in \b solver.inp, separate files </span>
<a name="l01732"></a>01732 <span class="preprocessor"></span>are written <span class="keywordflow">for</span> solutions at each output time. 
<a name="l01733"></a>01733 
<a name="l01734"></a>01734 <span class="preprocessor">#HyPar::op_file_format is set to \a text in \b solver.inp, and</span>
<a name="l01735"></a>01735 <span class="preprocessor"></span>thus, all the files are in plain <a class="code" href="a00031.html#a314f90bacf496961ff4bfef89fea32c0">text</a> (ASCII) format. In these files, 
<a name="l01736"></a>01736 the data is written out as: the first two columns are grid indices, the 
<a name="l01737"></a>01737 next two columns are the x and y coordinates, and the remaining columns 
<a name="l01738"></a>01738 are the three solution components.
<a name="l01739"></a>01739 <span class="preprocessor">#HyPar::op_file_format can also be set to \a tecplot2d to get the solution</span>
<a name="l01740"></a>01740 <span class="preprocessor"></span>files in the Tecplot format (that can be read <span class="keyword">using</span> any visualization 
<a name="l01741"></a>01741 software that supports Tecplot format).
<a name="l01742"></a>01742 
<a name="l01743"></a>01743 In <a class="code" href="a00032.html#acd2d71c0bebc6551f6d5d3c2870a9baa">addition</a> to the usual output files, the shallow water physics 
<a name="l01744"></a>01744 module writes out the following files:
<a name="l01745"></a>01745 + \b topography_00000.dat, ..., \b topography_00005.dat: These files
<a name="l01746"></a>01746   share the same format as the solution output files \b op_*.dat 
<a name="l01747"></a>01747   and contains the topography \f$b\left(x\right)\f$ (<span class="keywordflow">for</span> <span class="keyword">this</span> example,
<a name="l01748"></a>01748   they <span class="keywordflow">do</span> not matter since the topography is flat).
<a name="l01749"></a>01749 
<a name="l01750"></a>01750 The following plot shows the <span class="keyword">final</span> solution (water height):
<a name="l01751"></a>01751 @image html Solution_2DShallowWater_CircDamBreak.png
<a name="l01752"></a>01752 It was obtained <a class="code" href="a00032.html#a124150da8eed3d9f42e9361cc143ed7e">by</a> using the following MATLAB code to plot \b op_00005.<a class="code" href="a00031.html#a96b9dfbebc4ecd57a32426075fb0c3f2">dat</a>:
<a name="l01753"></a>01753 \include 2D/<a class="code" href="a00027.html" title="Structure containing variables and parameters specific to the 2D Shallow Water equations...">ShallowWater2D</a>/CircularDamBreak/PlotSolution.m
<a name="l01754"></a>01754 
<a name="l01755"></a>01755 Expected screen output:
<a name="l01756"></a>01756 \include 2D/<a class="code" href="a00027.html" title="Structure containing variables and parameters specific to the 2D Shallow Water equations...">ShallowWater2D</a>/CircularDamBreak/output.log
<a name="l01757"></a>01757 
<a name="l01758"></a>01758 
<a name="l01759"></a>01759 \<a class="code" href="a00032.html#a23a77f360d9ab0a90b11ff01314b6526">page</a> sw_latbelt 2D Shallow Water Equations - Latitude Belt Flow
<a name="l01760"></a>01760 
<a name="l01761"></a>01761 <a class="code" href="a00031.html#af7342acc7b7299a81e83b43ed11b9f84">Location</a>: \b hypar/<a class="code" href="a00031.html#a60f502575a2e782807ea78c05f76ae03">Examples</a>/2D/<a class="code" href="a00027.html" title="Structure containing variables and parameters specific to the 2D Shallow Water equations...">ShallowWater2D</a>/LatitudeBeltFlow
<a name="l01762"></a>01762           (This directory contains all the input files needed
<a name="l01763"></a>01763           to run this case. If there is a \a Run.m, run it in
<a name="l01764"></a>01764           MATLAB to quickly set up, run, and visualize the 
<a name="l01765"></a>01765           example).
<a name="l01766"></a>01766 
<a name="l01767"></a>01767 Governing equations: 2D Shallow Water Equations (shallowwater2d.h)
<a name="l01768"></a>01768 
<a name="l01769"></a>01769 References:
<a name="l01770"></a>01770  + Zhu, Et. al., <span class="stringliteral">&quot;Variational Data Assimilation with a Variable Resolution</span>
<a name="l01771"></a>01771 <span class="stringliteral">   Finite-Element Shallow-Water Equations Model&quot;</span>, Monthly Weather Review,
<a name="l01772"></a>01772    122, 1994, pp. 946--965.\n
<a name="l01773"></a>01773    Govering equations and approximation of Coriolis forces: Eqns (2.1)-(2.4)\n
<a name="l01774"></a>01774    Problem definition: Eqns. (4.1)-(4.3)
<a name="l01775"></a>01775 
<a name="l01776"></a>01776 <a class="code" href="a00031.html#a948095327123305f3fdf2b293b55381e">Domain</a>: \f$0 \le x \le 6,000,000\,{\rm m}, 0\le y \le 4,400,000\,{\rm m}\f$, 
<a name="l01777"></a>01777         \a <span class="stringliteral">&quot;periodic&quot;</span> (#<a class="code" href="a00037.html#a65ffa4253dee762c65092abcf04ecdee">_PERIODIC_</a>) boundaries along \a x, 
<a name="l01778"></a>01778         \a <span class="stringliteral">&quot;slip wall&quot;</span> (#<a class="code" href="a00037.html#a6cd5a586de4ae1a3b73884d62f76bdee">_SW_SLIP_WALL_</a>) boundaries along \a y.
<a name="l01779"></a>01779 
<a name="l01780"></a>01780 Initial solution: See equations (4.1) and (4.2) in reference,
<a name="l01781"></a>01781                   constant (zero) bottom topography
<a name="l01782"></a>01782 
<a name="l01783"></a>01783 Other parameters:
<a name="l01784"></a>01784  + \f$g=10\f$ (<span class="preprocessor">#ShallowWater2D::g)</span>
<a name="l01785"></a>01785 <span class="preprocessor"></span> + \f$\hat{f}=0.0001\f$ (#<a class="code" href="a00027.html#acc808f03e31ad5612b724fe23dea05ab">ShallowWater2D::fhat</a>)
<a name="l01786"></a>01786  + \f$\beta = 1.5\times 10^{-11}\f$ (#<a class="code" href="a00027.html#a9424343761f8c4f4c1afe8f5b6bf471b">ShallowWater2D::beta</a>)
<a name="l01787"></a>01787  + \f$D=4400000\f$ (#<a class="code" href="a00027.html#ad8657a5ec76e12f3066fb4b4eb75ace9">ShallowWater2D::D</a>)
<a name="l01788"></a>01788 
<a name="l01789"></a>01789 Numerical Method:
<a name="l01790"></a>01790   + Spatial discretization (hyperbolic): 5th order WENO (<a class="code" href="a00041.html#af2195885ad055989a1b2b11655843343" title="5th order WENO reconstruction (component-wise) on a uniform grid">Interp1PrimFifthOrderWENO</a>())
<a name="l01791"></a>01791   + Time integration: RK4 (TimeRK(), <span class="preprocessor">#_RK_44_)</span>
<a name="l01792"></a>01792 <span class="preprocessor"></span>
<a name="l01793"></a>01793 Input files <a class="code" href="a00032.html#af7a1b4a66a5b6f9ac8eebf2c23b51e9e">required</a>:
<a name="l01794"></a>01794 ---------------------
<a name="l01795"></a>01795 
<a name="l01796"></a>01796 <a class="code" href="a00032.html#a86616b1951d3af95df5b7115dd30438f">Note</a>: in <a class="code" href="a00032.html#acd2d71c0bebc6551f6d5d3c2870a9baa">addition</a> to the usual input files that <a class="code" href="a00015.html" title="Structure containing all solver-specific variables and functions.">HyPar</a> needs, <span class="keyword">this</span>
<a name="l01797"></a>01797 physical <a class="code" href="a00033.html#ac4336de6d1835c2fc39662f53e2f6e2e">model</a> needs the following input file(s):
<a name="l01798"></a>01798 + \b topography.inp : file containing the bottom topography (same
<a name="l01799"></a>01799   format as \b initial.inp).
<a name="l01800"></a>01800 
<a name="l01801"></a>01801 However, this case has a constant (zero) bottom topography, and thus
<a name="l01802"></a>01802 this file can be skipped.
<a name="l01803"></a>01803 
<a name="l01804"></a>01804 \b solver.inp
<a name="l01805"></a>01805 \include 2D/<a class="code" href="a00027.html" title="Structure containing variables and parameters specific to the 2D Shallow Water equations...">ShallowWater2D</a>/LatitudeBeltFlow/solver.inp
<a name="l01806"></a>01806 
<a name="l01807"></a>01807 \b boundary.inp
<a name="l01808"></a>01808 \include 2D/<a class="code" href="a00027.html" title="Structure containing variables and parameters specific to the 2D Shallow Water equations...">ShallowWater2D</a>/LatitudeBeltFlow/boundary.inp
<a name="l01809"></a>01809 
<a name="l01810"></a>01810 \b physics.inp
<a name="l01811"></a>01811 \include 2D/<a class="code" href="a00027.html" title="Structure containing variables and parameters specific to the 2D Shallow Water equations...">ShallowWater2D</a>/LatitudeBeltFlow/physics.inp
<a name="l01812"></a>01812 
<a name="l01813"></a>01813 \b weno.inp (optional)
<a name="l01814"></a>01814 \include 2D/<a class="code" href="a00027.html" title="Structure containing variables and parameters specific to the 2D Shallow Water equations...">ShallowWater2D</a>/LatitudeBeltFlow/weno.inp
<a name="l01815"></a>01815 
<a name="l01816"></a>01816 To generate \b initial.inp and \b topography.inp, compile and run the 
<a name="l01817"></a>01817 following code in the run directory (note: topography.inp can be skipped
<a name="l01818"></a>01818 since this case involves a uniform topography).
<a name="l01819"></a>01819 \include 2D/<a class="code" href="a00027.html" title="Structure containing variables and parameters specific to the 2D Shallow Water equations...">ShallowWater2D</a>/LatitudeBeltFlow/aux/init.c
<a name="l01820"></a>01820 
<a name="l01821"></a>01821 Output:
<a name="l01822"></a>01822 -------
<a name="l01823"></a>01823 <a class="code" href="a00032.html#a86616b1951d3af95df5b7115dd30438f">Note</a> that \b iproc is set to 
<a name="l01824"></a>01824 
<a name="l01825"></a>01825       2 2
<a name="l01826"></a>01826 
<a name="l01827"></a>01827 in \b solver.inp (i.e., 2 processors along \a x, and 2
<a name="l01828"></a>01828 processors along \a y). Thus, this example should be run
<a name="l01829"></a>01829 with 4 MPI ranks (or change \b iproc).
<a name="l01830"></a>01830 
<a name="l01831"></a>01831 After running the code, there should be 101 solution output files
<a name="l01832"></a>01832 \b op_00000.<a class="code" href="a00031.html#a96b9dfbebc4ecd57a32426075fb0c3f2">dat</a>, ..., \b op_00100.<a class="code" href="a00031.html#a96b9dfbebc4ecd57a32426075fb0c3f2">dat</a>; the first one is the solution 
<a name="l01833"></a>01833 at \f$t=0\f$ and the <span class="keyword">final</span> one is the solution at \f$t=360000\f$. Since
<a name="l01834"></a>01834 <span class="preprocessor">#HyPar::op_overwrite is set to \a no in \b solver.inp, separate files </span>
<a name="l01835"></a>01835 <span class="preprocessor"></span>are written <span class="keywordflow">for</span> solutions at each output time. 
<a name="l01836"></a>01836 
<a name="l01837"></a>01837 <span class="preprocessor">#HyPar::op_file_format is set to \a text in \b solver.inp, and</span>
<a name="l01838"></a>01838 <span class="preprocessor"></span>thus, all the files are in plain <a class="code" href="a00031.html#a314f90bacf496961ff4bfef89fea32c0">text</a> (ASCII) format. In these files, 
<a name="l01839"></a>01839 the data is written out as: the first two columns are grid indices, the 
<a name="l01840"></a>01840 next two columns are the x and y coordinates, and the remaining columns 
<a name="l01841"></a>01841 are the three solution components.
<a name="l01842"></a>01842 <span class="preprocessor">#HyPar::op_file_format can also be set to \a tecplot2d to get the solution</span>
<a name="l01843"></a>01843 <span class="preprocessor"></span>files in the Tecplot format (that can be read <span class="keyword">using</span> any visualization 
<a name="l01844"></a>01844 software that supports Tecplot format).
<a name="l01845"></a>01845 
<a name="l01846"></a>01846 The following plot shows an animation of the solution: 
<a name="l01847"></a>01847 @image html Solution_2DShallowWater_LatitudeBelt.gif
<a name="l01848"></a>01848 It was obtained <a class="code" href="a00032.html#a124150da8eed3d9f42e9361cc143ed7e">by</a> <span class="keyword">using</span> the following MATLAB code:
<a name="l01849"></a>01849 \include 2D/<a class="code" href="a00027.html" title="Structure containing variables and parameters specific to the 2D Shallow Water equations...">ShallowWater2D</a>/LatitudeBeltFlow/PlotSolution.m
<a name="l01850"></a>01850 
<a name="l01851"></a>01851 Since #<a class="code" href="a00015.html#ac92c34fe456d92c694eacd2231f5a7b1">HyPar::ConservationCheck</a> is <span class="keyword">set</span> to \a yes in \b solver.inp,
<a name="l01852"></a>01852 the code checks <span class="keywordflow">for</span> conservation error and prints it to screen, as well
<a name="l01853"></a>01853 as the file \b conservation.dat:
<a name="l01854"></a>01854 \include 2D/<a class="code" href="a00027.html" title="Structure containing variables and parameters specific to the 2D Shallow Water equations...">ShallowWater2D</a>/LatitudeBeltFlow/conservation.dat
<a name="l01855"></a>01855 The numbers are: number of grid points in each dimension (#<a class="code" href="a00015.html#aa989ebb755986852177779cdf7bd8c85">HyPar::dim_global</a>),
<a name="l01856"></a>01856 number of processors in each dimension (#<a class="code" href="a00019.html#a0be0f30a83bc3f3d9f6ee3a36bbf2716">MPIVariables::iproc</a>),
<a name="l01857"></a>01857 time step size (#<a class="code" href="a00015.html#a03e28be41881b703c836edbfe9b51b17">HyPar::dt</a>),
<a name="l01858"></a>01858 and conservation error of each component(#<a class="code" href="a00015.html#a965363cd64ce50ae17705dfb285dd0ab">HyPar::ConservationError</a>).
<a name="l01859"></a>01859 Note that that conservation error <span class="keywordflow">for</span> the water height is zero to machine 
<a name="l01860"></a>01860 precision (the non-zero conservation <span class="stringliteral">&quot;error&quot;</span> <span class="keywordflow">for</span> the momentum components
<a name="l01861"></a>01861 is due to the non-zero source term - Coriolis force).
<a name="l01862"></a>01862 
<a name="l01863"></a>01863 Expected screen output:
<a name="l01864"></a>01864 \include 2D/<a class="code" href="a00027.html" title="Structure containing variables and parameters specific to the 2D Shallow Water equations...">ShallowWater2D</a>/LatitudeBeltFlow/output.log
<a name="l01865"></a>01865 
<a name="l01866"></a>01866 
<a name="l01867"></a>01867 \<a class="code" href="a00032.html#a23a77f360d9ab0a90b11ff01314b6526">page</a> linear_adv_3dgauss 3D Linear Advection - Gaussian Pulse
<a name="l01868"></a>01868 
<a name="l01869"></a>01869 <a class="code" href="a00031.html#af7342acc7b7299a81e83b43ed11b9f84">Location</a>: \b hypar/<a class="code" href="a00031.html#a60f502575a2e782807ea78c05f76ae03">Examples</a>/3D/LinearAdvection/GaussianPulse
<a name="l01870"></a>01870           (This directory contains all the input files needed
<a name="l01871"></a>01871           to run <span class="keyword">this</span> <span class="keywordflow">case</span>. If there is a \a Run.m, run it in
<a name="l01872"></a>01872           MATLAB to quickly <span class="keyword">set</span> up, run, and visualize the 
<a name="l01873"></a>01873           example).
<a name="l01874"></a>01874 
<a name="l01875"></a>01875 Governing equations: 3D Linear Advection Equation (linearadr.h)
<a name="l01876"></a>01876 
<a name="l01877"></a>01877 <a class="code" href="a00031.html#a948095327123305f3fdf2b293b55381e">Domain</a>: \f$-3 \le x,y,z &lt; 3\f$, \a &quot;periodic&quot; (<span class="preprocessor">#_PERIODIC_)</span>
<a name="l01878"></a>01878 <span class="preprocessor"></span>        boundary <a class="code" href="a00063.html#a07bca284db2938db7ad469438892ca47">conditions</a> on all boundaries.
<a name="l01879"></a>01879 
<a name="l01880"></a>01880 Initial solution: \f$u\left(x,y,0\right) = u_0\left(x,y\right)= \exp\left[-\left(\frac{x^2}{2}+\frac{y^2}{2}+\frac{z^2}{2}\right)\right]\f$\n
<a name="l01881"></a>01881 Exact solution: \f$u\left(x,y,t\right) = u_0\left(x-a_xt,y-a_yt,z-a_zt\right)\f$.
<a name="l01882"></a>01882 
<a name="l01883"></a>01883 Numerical Method:
<a name="l01884"></a>01884  + Spatial <a class="code" href="a00033.html#a006f5ed6c12ae3d4f8e840cb181a05ca">discretization</a> (hyperbolic): 5th order CRWENO (<a class="code" href="a00041.html#a33b1e24c12129941b0027a83c543a654" title="5th order CRWENO reconstruction (component-wise) on a uniform grid">Interp1PrimFifthOrderCRWENO</a>())
<a name="l01885"></a>01885  + Time integration: RK4 (TimeRK(), #<a class="code" href="a00061.html#a47de987716954223b3c26bb842b21bf8">_RK_44_</a>)
<a name="l01886"></a>01886 
<a name="l01887"></a>01887 Input files <a class="code" href="a00032.html#af7a1b4a66a5b6f9ac8eebf2c23b51e9e">required</a>:
<a name="l01888"></a>01888 ---------------------
<a name="l01889"></a>01889 
<a name="l01890"></a>01890 \b solver.inp
<a name="l01891"></a>01891 \include 3D/LinearAdvection/GaussianPulse/solver.inp
<a name="l01892"></a>01892 
<a name="l01893"></a>01893 \b boundary.inp
<a name="l01894"></a>01894 \include 3D/LinearAdvection/GaussianPulse/boundary.inp
<a name="l01895"></a>01895 
<a name="l01896"></a>01896 \b physics.inp (specifies \f$a_x\f$, \f$a_y\f$, and \f$a_z\f$)
<a name="l01897"></a>01897 \include 3D/LinearAdvection/GaussianPulse/physics.inp
<a name="l01898"></a>01898 
<a name="l01899"></a>01899 \b lusolver.inp (optional)
<a name="l01900"></a>01900 \include 3D/LinearAdvection/GaussianPulse/lusolver.inp
<a name="l01901"></a>01901 
<a name="l01902"></a>01902 \b weno.inp (optional)
<a name="l01903"></a>01903 \include 3D/LinearAdvection/GaussianPulse/weno.inp
<a name="l01904"></a>01904 
<a name="l01905"></a>01905 To generate \b initial.inp, compile and run the 
<a name="l01906"></a>01906 following code in the run directory. \b <a class="code" href="a00032.html#a86616b1951d3af95df5b7115dd30438f">Note</a>: if the
<a name="l01907"></a>01907 final time is an integer multiple of the time period,
<a name="l01908"></a>01908 the file \b initial.inp can also be <a class="code" href="a00032.html#aa2f9253c1a63124e53d64db71f7e7c16">used</a> as the exact
<a name="l01909"></a>01909 solution \b exact.inp (i.e. create a sym link called 
<a name="l01910"></a>01910 \a exact.inp pointing to \a initial.inp, or just <a class="code" href="a00063.html#af77238a13603775a1f60ae9206d86600">copy</a>
<a name="l01911"></a>01911 \a initial.inp to \a exact.inp).
<a name="l01912"></a>01912 \include 3D/LinearAdvection/GaussianPulse/aux/init.c
<a name="l01913"></a>01913 
<a name="l01914"></a>01914 Output:
<a name="l01915"></a>01915 -------
<a name="l01916"></a>01916 <a class="code" href="a00032.html#a86616b1951d3af95df5b7115dd30438f">Note</a> that \b iproc is set to 
<a name="l01917"></a>01917 
<a name="l01918"></a>01918       2 2 2
<a name="l01919"></a>01919 
<a name="l01920"></a>01920 in \b solver.inp (i.e., 2 processors along \a x, \a y, and \a z).
<a name="l01921"></a>01921 Thus, this example should be run with 8 MPI ranks (or change \b iproc).
<a name="l01922"></a>01922 
<a name="l01923"></a>01923 After running the code, there should be 11 output
<a name="l01924"></a>01924 files \b op_00000.bin, \b op_00001.bin, ... \b op_00010.bin; 
<a name="l01925"></a>01925 the first one is the solution at \f$t=0\f$ and the <span class="keyword">final</span> one
<a name="l01926"></a>01926 is the solution at \f$t=6\f$. Since #<a class="code" href="a00015.html#a4e93cb107e180ef982b74cef7726b70f">HyPar::op_overwrite</a> is
<a name="l01927"></a>01927 <span class="keyword">set</span> to \a no in \b solver.inp, separate files are written
<a name="l01928"></a>01928 <span class="keywordflow">for</span> solutions at each output time. 
<a name="l01929"></a>01929   
<a name="l01930"></a>01930 All the files are binary (#<a class="code" href="a00015.html#a51a3b8c19b86e9e1df5be02b05a6613c">HyPar::op_file_format</a> is <span class="keyword">set</span> to \a binary in \b solver.inp).
<a name="l01931"></a>01931 The code \b hypar/Extras/BinaryToTecplot.c can be <a class="code" href="a00032.html#aa2f9253c1a63124e53d64db71f7e7c16">used</a> to convert the binary
<a name="l01932"></a>01932 solution files to 3D Tecplot files that can be visualized in any software
<a name="l01933"></a>01933 supporting the Tecplot format. Similarly, the code \b hypar/Extras/BinaryToText.c 
<a name="l01934"></a>01934 can be <a class="code" href="a00032.html#aa2f9253c1a63124e53d64db71f7e7c16">used</a> to convert the binary solution files to ASCII <a class="code" href="a00031.html#a314f90bacf496961ff4bfef89fea32c0">text</a> files with the 
<a name="l01935"></a>01935 following data layout: the first three columns are grid indices, the next three
<a name="l01936"></a>01936 columns are x, y, and z coordinates, and the last column is the solution \a u.
<a name="l01937"></a>01937 
<a name="l01938"></a>01938 The following animation was generated from the solution <a class="code" href="a00064.html#a5d3fb946f2b43ba02e668023ecf2c74b">files</a> 
<a name="l01939"></a>01939 (after converting to Tecplot format and plotting the iso-surface
<a name="l01940"></a>01940 in VisIt):
<a name="l01941"></a>01941 @image html Solution_3DLinearAdvGauss.gif
<a name="l01942"></a>01942 
<a name="l01943"></a>01943 Since the exact solution is available at the final time 
<a name="l01944"></a>01944 (\a exact.inp is a <a class="code" href="a00063.html#af77238a13603775a1f60ae9206d86600">copy</a> of \a initial.inp), the numerical 
<a name="l01945"></a>01945 errors are calculated and reported on screen (see below)
<a name="l01946"></a>01946 as well as \b errors.<a class="code" href="a00031.html#a96b9dfbebc4ecd57a32426075fb0c3f2">dat</a>:
<a name="l01947"></a>01947 \include 3D/LinearAdvection/GaussianPulse/errors.<a class="code" href="a00031.html#a96b9dfbebc4ecd57a32426075fb0c3f2">dat</a>
<a name="l01948"></a>01948 The numbers are: number of grid points in each dimension (#<a class="code" href="a00015.html" title="Structure containing all solver-specific variables and functions.">HyPar</a>::dim_global), 
<a name="l01949"></a>01949 number of processors in each dimension (#<a class="code" href="a00019.html" title="Structure of MPI-related variables.">MPIVariables</a>::iproc),
<a name="l01950"></a>01950 time step size (#<a class="code" href="a00015.html" title="Structure containing all solver-specific variables and functions.">HyPar</a>::dt),
<a name="l01951"></a>01951 L1, L2, and L-infinity errors (#<a class="code" href="a00015.html" title="Structure containing all solver-specific variables and functions.">HyPar</a>::error),
<a name="l01952"></a>01952 solver wall time (seconds) (i.e., not accounting for initialization,
<a name="l01953"></a>01953 and cleaning up),
<a name="l01954"></a>01954 and total wall time.
<a name="l01955"></a>01955 
<a name="l01956"></a>01956 Since #<a class="code" href="a00015.html" title="Structure containing all solver-specific variables and functions.">HyPar</a>::ConservationCheck is set to \a yes in \b solver.inp,
<a name="l01957"></a>01957 the code checks for conservation error and prints it to screen, as well
<a name="l01958"></a>01958 as the file \b conservation.<a class="code" href="a00031.html#a96b9dfbebc4ecd57a32426075fb0c3f2">dat</a>:
<a name="l01959"></a>01959 \include 3D/LinearAdvection/GaussianPulse/conservation.<a class="code" href="a00031.html#a96b9dfbebc4ecd57a32426075fb0c3f2">dat</a>
<a name="l01960"></a>01960 The numbers are: number of grid points in each dimension (#<a class="code" href="a00015.html" title="Structure containing all solver-specific variables and functions.">HyPar</a>::dim_global),
<a name="l01961"></a>01961 number of processors in each dimension (#<a class="code" href="a00019.html" title="Structure of MPI-related variables.">MPIVariables</a>::iproc),
<a name="l01962"></a>01962 time step size (#<a class="code" href="a00015.html" title="Structure containing all solver-specific variables and functions.">HyPar</a>::dt),
<a name="l01963"></a>01963 and conservation error (#<a class="code" href="a00015.html" title="Structure containing all solver-specific variables and functions.">HyPar</a>::ConservationError).
<a name="l01964"></a>01964 
<a name="l01965"></a>01965 Expected screen output:
<a name="l01966"></a>01966 \include 3D/LinearAdvection/GaussianPulse/output.log
<a name="l01967"></a>01967 
<a name="l01968"></a>01968 
<a name="l01969"></a>01969 \<a class="code" href="a00032.html#a23a77f360d9ab0a90b11ff01314b6526">page</a> ns3d_isoturb 3D Navier-Stokes Equations - Isotropic Turbulence Decay
<a name="l01970"></a>01970 
<a name="l01971"></a>01971 <a class="code" href="a00031.html#af7342acc7b7299a81e83b43ed11b9f84">Location</a>: \b hypar/<a class="code" href="a00031.html#a60f502575a2e782807ea78c05f76ae03">Examples</a>/3D/<a class="code" href="a00022.html" title="Structure containing variables and parameters specific to the 3D Navier Stokes equations...">NavierStokes3D</a>/DNS_IsotropicTurbulenceDecay
<a name="l01972"></a>01972           (This directory contains all the input files needed
<a name="l01973"></a>01973           to run this case. If there is a \a Run.m, run it in
<a name="l01974"></a>01974           MATLAB to quickly set up, run, and visualize the 
<a name="l01975"></a>01975           example).
<a name="l01976"></a>01976 
<a name="l01977"></a>01977 Governing equations: 3D Navier-Stokes Equations (navierstokes3d.h)
<a name="l01978"></a>01978 
<a name="l01979"></a>01979 <a class="code" href="a00031.html#a948095327123305f3fdf2b293b55381e">Domain</a>: \f$0 \le x,y,z &lt; 2\pi\f$, <span class="stringliteral">&quot;periodic&quot;</span> (#<a class="code" href="a00037.html#a65ffa4253dee762c65092abcf04ecdee">_PERIODIC_</a>) boundaries 
<a name="l01980"></a>01980         everywhere.
<a name="l01981"></a>01981 
<a name="l01982"></a>01982 Initial solution: Isotropic turbulent flow - The initial solution is 
<a name="l01983"></a>01983 <a class="code" href="a00032.html#aa18752ebe19b49b626048c92d4586801">specified</a> in the Fourier space (with an energy
<a name="l01984"></a>01984 distribution similar to that of turbulent flow), and then transformed
<a name="l01985"></a>01985 to the physical space through an inverse transform.
<a name="l01986"></a>01986 
<a name="l01987"></a>01987 Other parameters:
<a name="l01988"></a>01988   + \f$\gamma = 1.4\f$ (#<a class="code" href="a00022.html" title="Structure containing variables and parameters specific to the 3D Navier Stokes equations...">NavierStokes3D</a>::gamma)
<a name="l01989"></a>01989   + \f$Re = \frac {\rho u L } {\mu} = 333.33\f$ (#<a class="code" href="a00022.html#a3b92a4b98cedf64473b3c13dfa7674b4">NavierStokes3D::Re</a>)
<a name="l01990"></a>01990   + \f$Pr = 0.72\f$ (Prandtl number) (#<a class="code" href="a00022.html#af0f6e03342b9eb912e25f94ce0249a2c">NavierStokes3D::Pr</a>)
<a name="l01991"></a>01991   + \f$M_\infty = 0.3\f$ (turbulence fluctuation Mach number) (#<a class="code" href="a00022.html#aa5f774fe7b4f69be5e085f1988ef2a6d">NavierStokes3D::Minf</a>)
<a name="l01992"></a>01992 
<a name="l01993"></a>01993 Numerical Method:
<a name="l01994"></a>01994  + Spatial discretization (hyperbolic): 5th order CRWENO (<a class="code" href="a00041.html#a33b1e24c12129941b0027a83c543a654" title="5th order CRWENO reconstruction (component-wise) on a uniform grid">Interp1PrimFifthOrderCRWENO</a>())
<a name="l01995"></a>01995  + Spatial <a class="code" href="a00033.html#a006f5ed6c12ae3d4f8e840cb181a05ca">discretization</a> (parabolic) : 4th order (<a class="code" href="a00038.html#a08c28e6bc4493172df7b7867e1f3d815">FirstDerivativeFourthOrderCentral</a>()) 
<a name="l01996"></a>01996                                         non-conservative 2-stage (<a class="code" href="a00104.html#a9f5c8ed9c587aa71c9f75209222ad67c">ParabolicFunctionNC2Stage</a>())
<a name="l01997"></a>01997  + Time integration: RK4 (TimeRK(), #<a class="code" href="a00061.html#a47de987716954223b3c26bb842b21bf8">_RK_44_</a>)
<a name="l01998"></a>01998 
<a name="l01999"></a>01999 Input files <a class="code" href="a00032.html#af7a1b4a66a5b6f9ac8eebf2c23b51e9e">required</a>:
<a name="l02000"></a>02000 ---------------------
<a name="l02001"></a>02001 
<a name="l02002"></a>02002 \b solver.inp
<a name="l02003"></a>02003 \include 3D/<a class="code" href="a00022.html" title="Structure containing variables and parameters specific to the 3D Navier Stokes equations...">NavierStokes3D</a>/DNS_IsotropicTurbulenceDecay/solver.inp
<a name="l02004"></a>02004 
<a name="l02005"></a>02005 \b boundary.inp
<a name="l02006"></a>02006 \include 3D/<a class="code" href="a00022.html" title="Structure containing variables and parameters specific to the 3D Navier Stokes equations...">NavierStokes3D</a>/DNS_IsotropicTurbulenceDecay/boundary.inp
<a name="l02007"></a>02007 
<a name="l02008"></a>02008 \b physics.inp
<a name="l02009"></a>02009 \include 3D/<a class="code" href="a00022.html" title="Structure containing variables and parameters specific to the 3D Navier Stokes equations...">NavierStokes3D</a>/DNS_IsotropicTurbulenceDecay/physics.inp
<a name="l02010"></a>02010 
<a name="l02011"></a>02011 \b weno.inp (optional)
<a name="l02012"></a>02012 \include 3D/<a class="code" href="a00022.html" title="Structure containing variables and parameters specific to the 3D Navier Stokes equations...">NavierStokes3D</a>/DNS_IsotropicTurbulenceDecay/weno.inp
<a name="l02013"></a>02013 
<a name="l02014"></a>02014 \b lusolver.inp (optional)
<a name="l02015"></a>02015 \include 3D/<a class="code" href="a00022.html" title="Structure containing variables and parameters specific to the 3D Navier Stokes equations...">NavierStokes3D</a>/DNS_IsotropicTurbulenceDecay/lusolver.inp
<a name="l02016"></a>02016 
<a name="l02017"></a>02017 To generate \b initial.inp (initial solution), compile 
<a name="l02018"></a>02018 and run the following code in the run directory.
<a name="l02019"></a>02019 \b <a class="code" href="a00032.html#a86616b1951d3af95df5b7115dd30438f">Note</a>: this code requires the \b FFTW library installed (http:<span class="comment">//www.fftw.org/).</span>
<a name="l02020"></a>02020 To compile:
<a name="l02021"></a>02021 
<a name="l02022"></a>02022     gcc -I/path/to/fftw3.h -L/path/to/libfftw3.a -lfftw3 init.c
<a name="l02023"></a>02023 
<a name="l02024"></a>02024 (see the FFTW website on <a class="code" href="a00033.html#a01b034bd2577d902357ab456b3eb49ab">ways</a> to install it).
<a name="l02025"></a>02025 \include 3D/<a class="code" href="a00022.html" title="Structure containing variables and parameters specific to the 3D Navier Stokes equations...">NavierStokes3D</a>/DNS_IsotropicTurbulenceDecay/aux/init.c
<a name="l02026"></a>02026 
<a name="l02027"></a>02027 Output:
<a name="l02028"></a>02028 -------
<a name="l02029"></a>02029 <a class="code" href="a00032.html#a86616b1951d3af95df5b7115dd30438f">Note</a> that \b iproc is set to 
<a name="l02030"></a>02030 
<a name="l02031"></a>02031       2 2 1
<a name="l02032"></a>02032 
<a name="l02033"></a>02033 in \b solver.inp (i.e., 2 processors along \a x, 2
<a name="l02034"></a>02034 processors along \a y, and 1 processor along \a z). Thus, 
<a name="l02035"></a>02035 this example should be run with 4 MPI ranks (or change \b iproc).
<a name="l02036"></a>02036 
<a name="l02037"></a>02037 After running the code, there should be 11 output
<a name="l02038"></a>02038 files \b op_00000.bin, \b op_00001.bin, ... \b op_00010.bin; 
<a name="l02039"></a>02039 the first one is the solution at \f$t=0\f$ and the <span class="keyword">final</span> one
<a name="l02040"></a>02040 is the solution at \f$t=5\f$. Since #<a class="code" href="a00015.html#a4e93cb107e180ef982b74cef7726b70f">HyPar::op_overwrite</a> is
<a name="l02041"></a>02041 <span class="keyword">set</span> to \a no in \b solver.inp, separate files are written
<a name="l02042"></a>02042 <span class="keywordflow">for</span> solutions at each output time. All the files are binary
<a name="l02043"></a>02043 (#<a class="code" href="a00015.html#a51a3b8c19b86e9e1df5be02b05a6613c">HyPar::op_file_format</a> is <span class="keyword">set</span> to \a binary in \b solver.inp).
<a name="l02044"></a>02044 
<a name="l02045"></a>02045 To generate compute the energy spectrum from a given solution, compile 
<a name="l02046"></a>02046 and run the following code in the run directory. This code wants to read 
<a name="l02047"></a>02047 a file called \b op.bin, <a class="code" href="a00063.html#aa012087f27f6c70b31284d8d3fb32dc5">so</a> make a symbolic link with that name pointing
<a name="l02048"></a>02048 to the solution file whose energy spectrum is to be computed. (If #<a class="code" href="a00015.html#a4e93cb107e180ef982b74cef7726b70f">HyPar::op_overwrite</a>
<a name="l02049"></a>02049 is <span class="keyword">set</span> to \a yes in \b solver.inp, then the solution file itself is called 
<a name="l02050"></a>02050 \b op.bin). Also note that the solution must be in binary format
<a name="l02051"></a>02051 (#<a class="code" href="a00015.html#a51a3b8c19b86e9e1df5be02b05a6613c">HyPar::op_file_format</a> must be \a binary in \b solver.inp). It will write out a 
<a name="l02052"></a>02052 ASCII <a class="code" href="a00031.html#a314f90bacf496961ff4bfef89fea32c0">text</a> file \b spectrum.dat with two columns: \f$k\f$ and \f$E\left(k\right)\f$.
<a name="l02053"></a>02053 \b <a class="code" href="a00032.html#a86616b1951d3af95df5b7115dd30438f">Note</a>: <span class="keyword">this</span> code requires the \b FFTW library installed (http:<span class="comment">//www.fftw.org/).</span>
<a name="l02054"></a>02054 To compile:
<a name="l02055"></a>02055 
<a name="l02056"></a>02056     gcc -I/path/to/fftw3.h -L/path/to/libfftw3.a -lfftw3 fourier.c
<a name="l02057"></a>02057 
<a name="l02058"></a>02058 (see the FFTW website on <a class="code" href="a00033.html#a01b034bd2577d902357ab456b3eb49ab">ways</a> to install it). 
<a name="l02059"></a>02059 \include 3D/<a class="code" href="a00022.html" title="Structure containing variables and parameters specific to the 3D Navier Stokes equations...">NavierStokes3D</a>/DNS_IsotropicTurbulenceDecay/aux/fourier.c
<a name="l02060"></a>02060 
<a name="l02061"></a>02061 The following figure shows the initial and <span class="keyword">final</span> (t=5) energy spectra:
<a name="l02062"></a>02062 @image html Solution_3DNavStok_IsoTurb_Spectrum.png
<a name="l02063"></a>02063 
<a name="l02064"></a>02064 The following file computes the kinetic energy as a function of time
<a name="l02065"></a>02065 from the solution files. It writes out an ASCII <a class="code" href="a00031.html#a314f90bacf496961ff4bfef89fea32c0">text</a> file \b energy.dat
<a name="l02066"></a>02066 with two colums: time and kinetic energy.
<a name="l02067"></a>02067 \include 3D/<a class="code" href="a00022.html" title="Structure containing variables and parameters specific to the 3D Navier Stokes equations...">NavierStokes3D</a>/DNS_IsotropicTurbulenceDecay/aux/kineticenergy.c
<a name="l02068"></a>02068 
<a name="l02069"></a>02069 The following figure shows the kinetic energy decay:
<a name="l02070"></a>02070 @image html Solution_3DNavStok_IsoTurb_Energy.png
<a name="l02071"></a>02071 
<a name="l02072"></a>02072 The code \b hypar/Extras/BinaryToTecplot.c can be <a class="code" href="a00032.html#aa2f9253c1a63124e53d64db71f7e7c16">used</a> to convert the binary
<a name="l02073"></a>02073 solution files to 3D Tecplot files that can be visualized in any software
<a name="l02074"></a>02074 supporting the Tecplot format. Similarly, the code \b hypar/Extras/BinaryToText.c 
<a name="l02075"></a>02075 can be <a class="code" href="a00032.html#aa2f9253c1a63124e53d64db71f7e7c16">used</a> to convert the binary solution files to ASCII <a class="code" href="a00031.html#a314f90bacf496961ff4bfef89fea32c0">text</a> files with the 
<a name="l02076"></a>02076 following data layout: the first three columns are grid indices, the next three
<a name="l02077"></a>02077 columns are x, y, and z coordinates, and the remaining columns are the solution
<a name="l02078"></a>02078 components (\f$\rho, \rho u, \rho v, \rho w, e\f$).
<a name="l02079"></a>02079 
<a name="l02080"></a>02080 The following figure shows the density iso-surface colored <a class="code" href="a00032.html#a124150da8eed3d9f42e9361cc143ed7e">by</a> the <span class="keyword">internal</span> energy
<a name="l02081"></a>02081 (plotted in ParaView after converting the binary solution to a Tecplot file):
<a name="l02082"></a>02082 @image html Solution_3DNavStok_IsoTurb.png
<a name="l02083"></a>02083 
<a name="l02084"></a>02084 Expected screen output:
<a name="l02085"></a>02085 \include 3D/<a class="code" href="a00022.html" title="Structure containing variables and parameters specific to the 3D Navier Stokes equations...">NavierStokes3D</a>/DNS_IsotropicTurbulenceDecay/output.log
<a name="l02086"></a>02086 
<a name="l02087"></a>02087 
<a name="l02088"></a>02088 
<a name="l02089"></a>02089 \<a class="code" href="a00032.html#a23a77f360d9ab0a90b11ff01314b6526">page</a> ns3d_bubble 3D Navier-Stokes Equations - Rising Thermal Bubble
<a name="l02090"></a>02090 
<a name="l02091"></a>02091 <a class="code" href="a00031.html#af7342acc7b7299a81e83b43ed11b9f84">Location</a>: \b hypar/<a class="code" href="a00031.html#a60f502575a2e782807ea78c05f76ae03">Examples</a>/3D/<a class="code" href="a00022.html" title="Structure containing variables and parameters specific to the 3D Navier Stokes equations...">NavierStokes3D</a>/RisingThermalBubble_Config1
<a name="l02092"></a>02092           (This directory contains all the input files needed
<a name="l02093"></a>02093           to run this case. If there is a \a Run.m, run it in
<a name="l02094"></a>02094           MATLAB to quickly set up, run, and visualize the 
<a name="l02095"></a>02095           example).
<a name="l02096"></a>02096 
<a name="l02097"></a>02097 Governing equations: 3D Navier-Stokes Equations (navierstokes3d.h)
<a name="l02098"></a>02098 
<a name="l02099"></a>02099 <a class="code" href="a00031.html#a948095327123305f3fdf2b293b55381e">Domain</a>: \f$0 \le x,y,z &lt; 1000\,{\rm m}\f$, \a <span class="stringliteral">&quot;slip-wall&quot;</span> (#<a class="code" href="a00037.html#af3a9f3ba15bc914ed0a88295aee147e8">_SLIP_WALL_</a>) boundaries 
<a name="l02100"></a>02100         everywhere, with zero wall <a class="code" href="a00032.html#a19f4bd496612921d5231e400a3c27ed4">velocity</a>.
<a name="l02101"></a>02101 
<a name="l02102"></a>02102 Reference:
<a name="l02103"></a>02103   + Kelly, J. F., Giraldo, F. X., <span class="stringliteral">&quot;Continuous and discontinuous Galerkin methods for a scalable</span>
<a name="l02104"></a>02104 <span class="stringliteral">  three-dimensional nonhydrostatic atmospheric model: Limited-area mode&quot;</span>, J. Comput. Phys., 231,
<a name="l02105"></a>02105   2012, pp. 7988-8008 (see section 5.1.2).
<a name="l02106"></a>02106   + Giraldo, F. X., Kelly, J. F., Constantinescu, E. M., <span class="stringliteral">&quot;Implicit-Explicit Formulations of a</span>
<a name="l02107"></a>02107 <span class="stringliteral">  Three-Dimensional Nonhydrostatic Unified Model of the Atmosphere (NUMA)&quot;</span>, SIAM J. Sci. Comput., 
<a name="l02108"></a>02108   35 (5), 2013, pp. B1162-B1194 (see section 4.1).
<a name="l02109"></a>02109 
<a name="l02110"></a>02110 Initial solution: A warm bubble in cool ambient atmosphere. <a class="code" href="a00032.html#a86616b1951d3af95df5b7115dd30438f">Note</a> that in <span class="keyword">this</span> example, the
<a name="l02111"></a>02111 gravitational forces and rising of the bubble is along the \a y-axis.
<a name="l02112"></a>02112 
<a name="l02113"></a>02113 Other parameters (all dimensional quantities are in SI units):
<a name="l02114"></a>02114   + Specific heat ratio \f$\gamma = 1.4\f$ (#<a class="code" href="a00022.html" title="Structure containing variables and parameters specific to the 3D Navier Stokes equations...">NavierStokes3D</a>::gamma)
<a name="l02115"></a>02115   + Universal gas constant \f$R = 287.058\f$ (#<a class="code" href="a00022.html" title="Structure containing variables and parameters specific to the 3D Navier Stokes equations...">NavierStokes3D</a>::R)
<a name="l02116"></a>02116   + Gravitational force per unit mass \f$g = 9.8\f$ along \a y-axis (#<a class="code" href="a00022.html" title="Structure containing variables and parameters specific to the 3D Navier Stokes equations...">NavierStokes3D</a>::grav_y)
<a name="l02117"></a>02117   + Reference density (at zero altitude) \f$\rho_{ref} = 1.1612055171196529\f$ (#<a class="code" href="a00022.html#a1e6f66261d19a1c1c272e8808bd2657b">NavierStokes3D::rho0</a>)
<a name="l02118"></a>02118   + Reference <a class="code" href="a00032.html#a58d87a94271c7f86a36fafc7117fe0b0">pressure</a> (at zero altitude) \f$P_{ref} = 100000\f$ (#<a class="code" href="a00022.html#a8be9de5ac626cddcd15c5ec181619694">NavierStokes3D::p0</a>)
<a name="l02119"></a>02119   + Hydrostatic balance type 2 (#<a class="code" href="a00022.html#a2e01ef077b0fedaea9e286ccdf2fe259">NavierStokes3D::HB</a>)
<a name="l02120"></a>02120 
<a name="l02121"></a>02121 Numerical Method:
<a name="l02122"></a>02122  + Spatial discretization (hyperbolic): 5th order WENO (<a class="code" href="a00041.html#af2195885ad055989a1b2b11655843343" title="5th order WENO reconstruction (component-wise) on a uniform grid">Interp1PrimFifthOrderWENO</a>())
<a name="l02123"></a>02123  + Time integration: SSP RK3 (TimeRK(), <span class="preprocessor">#_RK_SSP3_)</span>
<a name="l02124"></a>02124 <span class="preprocessor"></span>
<a name="l02125"></a>02125 Input files <a class="code" href="a00032.html#af7a1b4a66a5b6f9ac8eebf2c23b51e9e">required</a>:
<a name="l02126"></a>02126 ---------------------
<a name="l02127"></a>02127 
<a name="l02128"></a>02128 \b solver.inp
<a name="l02129"></a>02129 \include 3D/<a class="code" href="a00022.html" title="Structure containing variables and parameters specific to the 3D Navier Stokes equations...">NavierStokes3D</a>/RisingThermalBubble_Config1/solver.inp
<a name="l02130"></a>02130 
<a name="l02131"></a>02131 \b boundary.inp
<a name="l02132"></a>02132 \include 3D/<a class="code" href="a00022.html" title="Structure containing variables and parameters specific to the 3D Navier Stokes equations...">NavierStokes3D</a>/RisingThermalBubble_Config1/boundary.inp
<a name="l02133"></a>02133 
<a name="l02134"></a>02134 \b physics.inp
<a name="l02135"></a>02135 \include 3D/<a class="code" href="a00022.html" title="Structure containing variables and parameters specific to the 3D Navier Stokes equations...">NavierStokes3D</a>/RisingThermalBubble_Config1/physics.inp
<a name="l02136"></a>02136 
<a name="l02137"></a>02137 \b weno.inp (optional)
<a name="l02138"></a>02138 \include 3D/<a class="code" href="a00022.html" title="Structure containing variables and parameters specific to the 3D Navier Stokes equations...">NavierStokes3D</a>/RisingThermalBubble_Config1/weno.inp
<a name="l02139"></a>02139 
<a name="l02140"></a>02140 To generate \b initial.inp (initial solution), compile 
<a name="l02141"></a>02141 and run the following code in the run directory.
<a name="l02142"></a>02142 \include 3D/<a class="code" href="a00022.html" title="Structure containing variables and parameters specific to the 3D Navier Stokes equations...">NavierStokes3D</a>/RisingThermalBubble_Config1/aux/init.c
<a name="l02143"></a>02143 
<a name="l02144"></a>02144 Output:
<a name="l02145"></a>02145 -------
<a name="l02146"></a>02146 <a class="code" href="a00032.html#a86616b1951d3af95df5b7115dd30438f">Note</a> that \b iproc is <span class="keyword">set</span> to 
<a name="l02147"></a>02147 
<a name="l02148"></a>02148       4 4 4
<a name="l02149"></a>02149 
<a name="l02150"></a>02150 in \b solver.inp (i.e., 4 processors along \a x, 4
<a name="l02151"></a>02151 processors along \a y, and 4 processor along \a z). Thus, 
<a name="l02152"></a>02152 <span class="keyword">this</span> example should be run with 64 MPI ranks (or change \b iproc).
<a name="l02153"></a>02153 
<a name="l02154"></a>02154 After running the code, there should be 11 output
<a name="l02155"></a>02155 files \b op_00000.bin, \b op_00001.bin, ... \b op_00010.bin; 
<a name="l02156"></a>02156 the first one is the solution at \f$t=0\f$ and the <span class="keyword">final</span> one
<a name="l02157"></a>02157 is the solution at \f$t=200\,{\rm s}\f$. Since #<a class="code" href="a00015.html#a4e93cb107e180ef982b74cef7726b70f">HyPar::op_overwrite</a> is
<a name="l02158"></a>02158 <span class="keyword">set</span> to \a no in \b solver.inp, separate files are written
<a name="l02159"></a>02159 <span class="keywordflow">for</span> solutions at each output time. All the files are binary
<a name="l02160"></a>02160 (#<a class="code" href="a00015.html#a51a3b8c19b86e9e1df5be02b05a6613c">HyPar::op_file_format</a> is <span class="keyword">set</span> to \a binary in \b solver.inp).
<a name="l02161"></a>02161 
<a name="l02162"></a>02162 The following code (&lt;B&gt;<a class="code" href="a00031.html#a60f502575a2e782807ea78c05f76ae03">Examples</a>/3D/<a class="code" href="a00022.html" title="Structure containing variables and parameters specific to the 3D Navier Stokes equations...">NavierStokes3D</a>/RisingThermalBubble_Config1/aux/PostProcess.c&lt;/B&gt;)
<a name="l02163"></a>02163 can be <a class="code" href="a00032.html#aa2f9253c1a63124e53d64db71f7e7c16">used</a> to convert the binary solution file (with conserved variables 
<a name="l02164"></a>02164 \f$\rho,\rho u,\rho v,\rho w,e\f$) to Tecplot or plain <a class="code" href="a00031.html#a314f90bacf496961ff4bfef89fea32c0">text</a> files with the primitive
<a name="l02165"></a>02165 and reference variables \f$\rho,u,v,w,P,\theta,\rho_0,P_0,\pi,\theta_0\f$ where the
<a name="l02166"></a>02166 subscript \f$0\f$ indicates the hydrostatic mean <a class="code" href="a00032.html#aadd5786eddf29a076126f4201bb7c244">value</a>.
<a name="l02167"></a>02167 \include 3D/<a class="code" href="a00022.html" title="Structure containing variables and parameters specific to the 3D Navier Stokes equations...">NavierStokes3D</a>/RisingThermalBubble_Config1/aux/PostProcess.c
<a name="l02168"></a>02168 
<a name="l02169"></a>02169 The following figure shows the potential temperature iso-surface for the initial
<a name="l02170"></a>02170 and final solutions (plotted in VisIt):
<a name="l02171"></a>02171 @image html Solution_3DNavStok_Bubble3D.png
<a name="l02172"></a>02172 
<a name="l02173"></a>02173 The file \b Extras/ExtractSlice.c can be <a class="code" href="a00032.html#aa2f9253c1a63124e53d64db71f7e7c16">used</a> to extract a slice perpendicular to any dimension
<a name="l02174"></a>02174 at a <a class="code" href="a00032.html#aa18752ebe19b49b626048c92d4586801">specified</a> location along that dimension. The extract slice is written out in the same
<a name="l02175"></a>02175 binary format as the original solutions files (with the same names op_xxxxx.bin) in a 
<a name="l02176"></a>02176 subdirectory called \b slices (\b <a class="code" href="a00032.html#a86616b1951d3af95df5b7115dd30438f">Note</a>: make the subdirectory called \a slices before running
<a name="l02177"></a>02177 this code). The following code (&lt;B&gt;<a class="code" href="a00031.html#a60f502575a2e782807ea78c05f76ae03">Examples</a>/3D/<a class="code" href="a00022.html" title="Structure containing variables and parameters specific to the 3D Navier Stokes equations...">NavierStokes3D</a>/RisingThermalBubble_Config1/aux/PostProcessSlice.c&lt;/B&gt;)
<a name="l02178"></a>02178 can then be <a class="code" href="a00032.html#aa2f9253c1a63124e53d64db71f7e7c16">used</a> (in the \b slices subdirectory) to convert the binary slice solution file (with conserved variables 
<a name="l02179"></a>02179 \f$\rho,\rho u,\rho v,\rho w,e\f$) to Tecplot or plain <a class="code" href="a00031.html#a314f90bacf496961ff4bfef89fea32c0">text</a> files with the primitive
<a name="l02180"></a>02180 and reference variables \f$\rho,u,v,w,P,\theta,\rho_0,P_0,\pi,\theta_0\f$.
<a name="l02181"></a>02181 \b <a class="code" href="a00032.html#a86616b1951d3af95df5b7115dd30438f">Note</a> that it needs the relevant \b solver.inp and \b physics.inp that can be created
<a name="l02182"></a>02182 as follows:
<a name="l02183"></a>02183 + Copy the original solver.inp and physics.inp to the slices subdirectory.
<a name="l02184"></a>02184 + In solver.inp, set \b ndims as \b 2, and remove the component of \b size and \b iproc 
<a name="l02185"></a>02185   corresponding to the dimension being eliminated while extracting the slices (in this case,
<a name="l02186"></a>02186   it is \a z or the 3rd component).
<a name="l02187"></a>02187 + In physics.inp, remove the component of \b gravity corresponding to the dimension perpendicular
<a name="l02188"></a>02188   to the slice.
<a name="l02189"></a>02189 
<a name="l02190"></a>02190 \include 3D/<a class="code" href="a00022.html" title="Structure containing variables and parameters specific to the 3D Navier Stokes equations...">NavierStokes3D</a>/RisingThermalBubble_Config1/aux/PostProcessSlice.c
<a name="l02191"></a>02191 
<a name="l02192"></a>02192 The following figure shows the potential temperature \f$\theta\f$ along a slice at \f$z=500\,{\rm m}\f$ 
<a name="l02193"></a>02193 (plotted in VisIt):
<a name="l02194"></a>02194 @image html Solution_3DNavStok_Bubble.gif
<a name="l02195"></a>02195 
<a name="l02196"></a>02196 Expected screen output:
<a name="l02197"></a>02197 \include 3D/<a class="code" href="a00022.html" title="Structure containing variables and parameters specific to the 3D Navier Stokes equations...">NavierStokes3D</a>/RisingThermalBubble_Config1/output.log
<a name="l02198"></a>02198 
<a name="l02199"></a>02199 
<a name="l02200"></a>02200 
<a name="l02201"></a>02201 \<a class="code" href="a00032.html#a23a77f360d9ab0a90b11ff01314b6526">page</a> numa3d_bubble 3D NUMA (Nonhydrostatic Unified Model of the Atmosphere) Equations - Rising Thermal Bubble
<a name="l02202"></a>02202 
<a name="l02203"></a>02203 <a class="code" href="a00031.html#af7342acc7b7299a81e83b43ed11b9f84">Location</a>: \b hypar/<a class="code" href="a00031.html#a60f502575a2e782807ea78c05f76ae03">Examples</a>/3D/NUMA/RisingThermalBubble
<a name="l02204"></a>02204           (This directory contains all the input files needed
<a name="l02205"></a>02205           to run <span class="keyword">this</span> <span class="keywordflow">case</span>. If there is a \a Run.m, run it in
<a name="l02206"></a>02206           MATLAB to quickly <span class="keyword">set</span> up, run, and visualize the 
<a name="l02207"></a>02207           example).
<a name="l02208"></a>02208 
<a name="l02209"></a>02209 Governing equations: 3D NUMA (Nonhydrostatic Unified Model of the Atmosphere) Equations (numa3d.h)
<a name="l02210"></a>02210 
<a name="l02211"></a>02211 <a class="code" href="a00031.html#a948095327123305f3fdf2b293b55381e">Domain</a>: \f$0 \le x,y,z &lt; 1000\,{\rm m}\f$, \a <span class="stringliteral">&quot;numa-nfbc&quot;</span> (#<a class="code" href="a00037.html#af6add2fbe449fa25b80c01abd7564574">_NO_FLUX_BC_</a>) boundaries 
<a name="l02212"></a>02212         everywhere.
<a name="l02213"></a>02213 
<a name="l02214"></a>02214 Reference:
<a name="l02215"></a>02215   + Kelly, J. F., Giraldo, F. X., <span class="stringliteral">&quot;Continuous and discontinuous Galerkin methods for a scalable</span>
<a name="l02216"></a>02216 <span class="stringliteral">  three-dimensional nonhydrostatic atmospheric model: Limited-area mode&quot;</span>, J. Comput. Phys., 231,
<a name="l02217"></a>02217   2012, pp. 7988-8008 (see section 5.1.2).
<a name="l02218"></a>02218   + Giraldo, F. X., Kelly, J. F., Constantinescu, E. M., <span class="stringliteral">&quot;Implicit-Explicit Formulations of a</span>
<a name="l02219"></a>02219 <span class="stringliteral">  Three-Dimensional Nonhydrostatic Unified Model of the Atmosphere (NUMA)&quot;</span>, SIAM J. Sci. Comput., 
<a name="l02220"></a>02220   35 (5), 2013, pp. B1162-B1194 (see section 4.1).
<a name="l02221"></a>02221 
<a name="l02222"></a>02222 Initial solution: A warm bubble in cool ambient atmosphere.
<a name="l02223"></a>02223 
<a name="l02224"></a>02224 Other parameters (all dimensional quantities are in SI units):
<a name="l02225"></a>02225   + Specific heat ratio \f$\gamma = 1.4\f$ (#<a class="code" href="a00024.html">Numa3D</a>::gamma)
<a name="l02226"></a>02226   + Universal gas constant \f$R = 287.058\f$ (#<a class="code" href="a00024.html">Numa3D</a>::R)
<a name="l02227"></a>02227   + Gravitational force per unit mass \f$g = 9.8\f$ (#<a class="code" href="a00024.html">Numa3D</a>::g)
<a name="l02228"></a>02228   + Angular speed of earth \f$\Omega = 0\f$ (#<a class="code" href="a00024.html">Numa3D</a>::Omega)
<a name="l02229"></a>02229   + Reference <a class="code" href="a00032.html#a58d87a94271c7f86a36fafc7117fe0b0">pressure</a> (at zero altitude) \f$P_{ref} = 100000\f$ (#<a class="code" href="a00024.html#ad2988f8045b70fe0950d361d8814faa6">Numa3D::Pref</a>)
<a name="l02230"></a>02230   + Reference temperature (at zero altitude) \f$T_{ref} = 300\f$ (#<a class="code" href="a00024.html#abfc9a78d9685d39295be4f8cfefed2f2">Numa3D::Tref</a>)
<a name="l02231"></a>02231 
<a name="l02232"></a>02232 Numerical Method:
<a name="l02233"></a>02233  + Spatial discretization (hyperbolic): 5th order WENO (<a class="code" href="a00041.html#af2195885ad055989a1b2b11655843343" title="5th order WENO reconstruction (component-wise) on a uniform grid">Interp1PrimFifthOrderWENO</a>())
<a name="l02234"></a>02234  + Time integration: RK4 (TimeRK(), #<a class="code" href="a00061.html#a47de987716954223b3c26bb842b21bf8">_RK_44_</a>)
<a name="l02235"></a>02235 
<a name="l02236"></a>02236 Input files <a class="code" href="a00032.html#af7a1b4a66a5b6f9ac8eebf2c23b51e9e">required</a>:
<a name="l02237"></a>02237 ---------------------
<a name="l02238"></a>02238 
<a name="l02239"></a>02239 \b solver.inp
<a name="l02240"></a>02240 \include 3D/NUMA/RisingThermalBubble/solver.inp
<a name="l02241"></a>02241 
<a name="l02242"></a>02242 \b boundary.inp
<a name="l02243"></a>02243 \include 3D/NUMA/RisingThermalBubble/boundary.inp
<a name="l02244"></a>02244 
<a name="l02245"></a>02245 \b physics.inp
<a name="l02246"></a>02246 \include 3D/NUMA/RisingThermalBubble/physics.inp
<a name="l02247"></a>02247 
<a name="l02248"></a>02248 \b weno.inp (optional)
<a name="l02249"></a>02249 \include 3D/NUMA/RisingThermalBubble/weno.inp
<a name="l02250"></a>02250 
<a name="l02251"></a>02251 To generate \b initial.inp (initial solution), compile 
<a name="l02252"></a>02252 and run the following code in the run directory.
<a name="l02253"></a>02253 \include 3D/NUMA/RisingThermalBubble/aux/init.c
<a name="l02254"></a>02254 
<a name="l02255"></a>02255 Output:
<a name="l02256"></a>02256 -------
<a name="l02257"></a>02257 <a class="code" href="a00032.html#a86616b1951d3af95df5b7115dd30438f">Note</a> that \b iproc is set to 
<a name="l02258"></a>02258 
<a name="l02259"></a>02259       2 2 2
<a name="l02260"></a>02260 
<a name="l02261"></a>02261 in \b solver.inp (i.e., 2 processors along \a x, 2
<a name="l02262"></a>02262 processors along \a y, and 2 processor along \a z). Thus, 
<a name="l02263"></a>02263 this example should be run with 8 MPI ranks (or change \b iproc).
<a name="l02264"></a>02264 
<a name="l02265"></a>02265 After running the code, there should be 41 output
<a name="l02266"></a>02266 files \b op_00000.bin, \b op_00001.bin, ... \b op_00040.bin; 
<a name="l02267"></a>02267 the first one is the solution at \f$t=0\f$ and the <span class="keyword">final</span> one
<a name="l02268"></a>02268 is the solution at \f$t=200\,{\rm s}\f$. Since #<a class="code" href="a00015.html#a4e93cb107e180ef982b74cef7726b70f">HyPar::op_overwrite</a> is
<a name="l02269"></a>02269 <span class="keyword">set</span> to \a no in \b solver.inp, separate files are written
<a name="l02270"></a>02270 <span class="keywordflow">for</span> solutions at each output time. All the files are binary
<a name="l02271"></a>02271 (#<a class="code" href="a00015.html#a51a3b8c19b86e9e1df5be02b05a6613c">HyPar::op_file_format</a> is <span class="keyword">set</span> to \a binary in \b solver.inp).
<a name="l02272"></a>02272 
<a name="l02273"></a>02273 The code \b hypar/Extras/BinaryToTecplot.c can be <a class="code" href="a00032.html#aa2f9253c1a63124e53d64db71f7e7c16">used</a> to convert the binary
<a name="l02274"></a>02274 solution files to 3D Tecplot files that can be visualized in any software
<a name="l02275"></a>02275 supporting the Tecplot format. Similarly, the code \b hypar/Extras/BinaryToText.c 
<a name="l02276"></a>02276 can be <a class="code" href="a00032.html#aa2f9253c1a63124e53d64db71f7e7c16">used</a> to convert the binary solution files to ASCII <a class="code" href="a00031.html#a314f90bacf496961ff4bfef89fea32c0">text</a> files with the 
<a name="l02277"></a>02277 following data layout: the first three columns are grid indices, the next three
<a name="l02278"></a>02278 columns are x, y, and z coordinates, and the remaining columns are the solution
<a name="l02279"></a>02279 components (\f$\rho{<span class="stringliteral">&apos;}, \rho u, \rho v, \rho w, \Theta{&apos;</span>}\f$).
<a name="l02280"></a>02280 
<a name="l02281"></a>02281 The following figure shows the density pertubation iso-surface <span class="keywordflow">for</span> the initial
<a name="l02282"></a>02282 and <span class="keyword">final</span> solutions (plotted in VisIt):
<a name="l02283"></a>02283 @image html Solution_3DNUMA_Bubble3D.png
<a name="l02284"></a>02284 
<a name="l02285"></a>02285 The code \b hypar/Extras/ExtractSlice.c can be <a class="code" href="a00032.html#aa2f9253c1a63124e53d64db71f7e7c16">used</a> to extract a slice along at a <a class="code" href="a00032.html#aa18752ebe19b49b626048c92d4586801">specified</a> location
<a name="l02286"></a>02286 along any of the <a class="code" href="a00033.html#adcc0e6de361772764b238180e552533e">dimensions</a> (\b <a class="code" href="a00032.html#a86616b1951d3af95df5b7115dd30438f">Note</a>: make a subdirectory \a slices before using this).
<a name="l02287"></a>02287 It will write out 2D slice solutions in binary format in the \a slices subdirectory
<a name="l02288"></a>02288 with the same names as the original solution files. The codes \b hypar/Extras/BinaryToTecplot.c
<a name="l02289"></a>02289 and \b hypar/Extras/BinaryToText.c can then be <a class="code" href="a00032.html#aa2f9253c1a63124e53d64db71f7e7c16">used</a> to convert these to <a class="code" href="a00031.html#a314f90bacf496961ff4bfef89fea32c0">text</a> or Tecplot
<a name="l02290"></a>02290 formats for visualization. (\b <a class="code" href="a00032.html#a86616b1951d3af95df5b7115dd30438f">Note</a>: A <a class="code" href="a00063.html#af77238a13603775a1f60ae9206d86600">copy</a> of the original \a solver.inp is <a class="code" href="a00032.html#af7a1b4a66a5b6f9ac8eebf2c23b51e9e">required</a> in the \a slices subdirectory
<a name="l02291"></a>02291 with \b ndims reduced <a class="code" href="a00032.html#a124150da8eed3d9f42e9361cc143ed7e">by</a> 1, and \b size and \b iproc with the appropriate component removed such that
<a name="l02292"></a>02292 they have 2 components.)
<a name="l02293"></a>02293 
<a name="l02294"></a>02294 The following figure shows the density pertubation along a slice at \f$y=500\,{\rm m}\f$ 
<a name="l02295"></a>02295 (plotted in VisIt):
<a name="l02296"></a>02296 @image html Solution_3DNUMA_Bubble.gif
<a name="l02297"></a>02297 
<a name="l02298"></a>02298 Expected screen output:
<a name="l02299"></a>02299 \include 3D/NUMA/RisingThermalBubble/output.log
<a name="l02300"></a>02300 
<a name="l02301"></a>02301 
<a name="l02302"></a>02302 
<a name="l02303"></a>02303 \<a class="code" href="a00032.html#a23a77f360d9ab0a90b11ff01314b6526">page</a> <a class="code" href="a00031.html#a93ed18fea13689603ac820fae45977d1">petsc_examples</a> <a class="code" href="a00032.html#a74efd4099e297716dbf2fa701e90b65e">PETSc</a> <a class="code" href="a00031.html#a60f502575a2e782807ea78c05f76ae03">Examples</a>
<a name="l02304"></a>02304 
<a name="l02305"></a>02305 The following are some examples that <a class="code" href="a00063.html#aa62d35257af3497101065692a222b8d8">use</a> <span class="keyword">explicit</span>, implicit or semi-implicit (IMEX) time
<a name="l02306"></a>02306 integration methods implemented in <a class="code" href="a00032.html#a74efd4099e297716dbf2fa701e90b65e">PETSc</a> (https:<span class="comment">//www.mcs.anl.gov/petsc/). To run them, </span>
<a name="l02307"></a>02307 <a class="code" href="a00015.html" title="Structure containing all solver-specific variables and functions.">HyPar</a> needs to be compiled \b with \b <a class="code" href="a00032.html#a74efd4099e297716dbf2fa701e90b65e">PETSc</a>. Familiarity with <span class="keyword">using</span> <a class="code" href="a00032.html#a74efd4099e297716dbf2fa701e90b65e">PETSc</a> is assumed.
<a name="l02308"></a>02308 
<a name="l02309"></a>02309 \b <a class="code" href="a00032.html#a86616b1951d3af95df5b7115dd30438f">Note</a>: 
<a name="l02310"></a>02310 + In general, any example or simulation can use <a class="code" href="a00032.html#a74efd4099e297716dbf2fa701e90b65e">PETSc</a> time-integrators (assuming
<a name="l02311"></a>02311   <a class="code" href="a00015.html" title="Structure containing all solver-specific variables and functions.">HyPar</a> is compiled with <a class="code" href="a00032.html#a74efd4099e297716dbf2fa701e90b65e">PETSc</a>) <a class="code" href="a00032.html#a124150da8eed3d9f42e9361cc143ed7e">by</a> <a class="code" href="a00032.html#aa8a31735113a81ccfa37219e606349cd">specifying</a> the PETSc <a class="code" href="a00032.html#a1426fe6e3e8b577fe9305ad03d40e6ba">inputs</a> through a 
<a name="l02312"></a>02312   &lt;B&gt;.petscrc&lt;/B&gt; file, similar to the ones in the examples below. 
<a name="l02313"></a>02313   The following file is an example of a .petscrc file (with explanatory comments). 
<a name="l02314"></a>02314   - &lt;B&gt;hypar/<a class="code" href="a00031.html#a60f502575a2e782807ea78c05f76ae03">Examples</a>/PETScInputs/.petscrc_Example&lt;/B&gt; 
<a name="l02315"></a>02315 + The PETSc example directories have a file &lt;B&gt;.petscrc&lt;/B&gt; and a sym link \b petscrc
<a name="l02316"></a>02316 pointing to .petscrc. The file .petscrc is the actual input file; \a petscrc is needed to generate
<a name="l02317"></a>02317 <span class="keyword">this</span> documentation because Doxygen does not seem to include files with names starting with a dot!
<a name="l02318"></a>02318 + The <a class="code" href="a00032.html#a1426fe6e3e8b577fe9305ad03d40e6ba">inputs</a> in the .petscrc files (any lines not starting with a #) can also be <a class="code" href="a00032.html#aa18752ebe19b49b626048c92d4586801">specified</a> in the
<a name="l02319"></a>02319 command line, <span class="keywordflow">for</span> example, 
<a name="l02320"></a>02320     
<a name="l02321"></a>02321     /path/to/hypar/bin/<a class="code" href="a00015.html" title="Structure containing all solver-specific variables and functions.">HyPar</a> -use-petscts -ts_type rk -ts_rk_type 4 ...
<a name="l02322"></a>02322 
<a name="l02323"></a>02323 
<a name="l02324"></a>02324 Explicit time integration:
<a name="l02325"></a>02325 --------------------------
<a name="l02326"></a>02326 \subpage linear_adv_sine_petsc \n
<a name="l02327"></a>02327 \subpage linear_adv_disc_petsc (with local truncation error-based adaptive time-step)
<a name="l02328"></a>02328 
<a name="l02329"></a>02329 Implicit time integration:
<a name="l02330"></a>02330 --------------------------
<a name="l02331"></a>02331 \subpage linear_diff_sine_petsc \n
<a name="l02332"></a>02332 \subpage linear_diff_sine2d_petsc (with local truncation error-based adaptive time-step) \n
<a name="l02333"></a>02333 \subpage euler2d_vortex_petsc \n
<a name="l02334"></a>02334 \subpage navstok2d_flatplate_petsc
<a name="l02335"></a>02335 
<a name="l02336"></a>02336 Implicit-Explicit (IMEX) time integration:
<a name="l02337"></a>02337 ------------------------------------------
<a name="l02338"></a>02338 \subpage euler2d_low_mach_vortex_petsc \n
<a name="l02339"></a>02339 \subpage euler2d_igwave_petsc \n
<a name="l02340"></a>02340 \subpage euler2d_rtb_petsc_imex (with local truncation error-based adaptive time-step) \n
<a name="l02341"></a>02341 \subpage ns2d_ldsc_petsc_imex \n
<a name="l02342"></a>02342 \subpage ns3d_bubble_petsc
<a name="l02343"></a>02343 
<a name="l02344"></a>02344 
<a name="l02345"></a>02345 \<a class="code" href="a00032.html#a23a77f360d9ab0a90b11ff01314b6526">page</a> linear_adv_sine_petsc 1D Linear Advection - Sine Wave
<a name="l02346"></a>02346 
<a name="l02347"></a>02347 <a class="code" href="a00031.html#af7342acc7b7299a81e83b43ed11b9f84">Location</a>: \b hypar/<a class="code" href="a00031.html#a60f502575a2e782807ea78c05f76ae03">Examples</a>/1D/LinearAdvection/SineWave_PETSc
<a name="l02348"></a>02348           (This directory contains all the input files needed
<a name="l02349"></a>02349           to run <span class="keyword">this</span> <span class="keywordflow">case</span>. If there is a \a Run.m, run it in
<a name="l02350"></a>02350           MATLAB to quickly <span class="keyword">set</span> up, run, and visualize the 
<a name="l02351"></a>02351           example).
<a name="l02352"></a>02352 
<a name="l02353"></a>02353 Governing equations: 1D Linear Advection Equation (linearadr.h)
<a name="l02354"></a>02354 
<a name="l02355"></a>02355 References:
<a name="l02356"></a>02356   + Ghosh, D., Baeder, J. D., <span class="stringliteral">&quot;Compact Reconstruction Schemes with </span>
<a name="l02357"></a>02357 <span class="stringliteral">    Weighted ENO Limiting for Hyperbolic Conservation Laws&quot;</span>, 
<a name="l02358"></a>02358     SIAM Journal on Scientific Computing, 34 (3), 2012, A1678–A1706
<a name="l02359"></a>02359 
<a name="l02360"></a>02360 <a class="code" href="a00031.html#a948095327123305f3fdf2b293b55381e">Domain</a>: \f$0 \le x &lt; 1\f$, \a <span class="stringliteral">&quot;periodic&quot;</span> (#<a class="code" href="a00037.html#a65ffa4253dee762c65092abcf04ecdee">_PERIODIC_</a>)
<a name="l02361"></a>02361         boundary <a class="code" href="a00063.html#a07bca284db2938db7ad469438892ca47">conditions</a>
<a name="l02362"></a>02362 
<a name="l02363"></a>02363 Initial solution: \f$u\left(x,0\right) = \sin\left(2\pi x\right)\f$
<a name="l02364"></a>02364 
<a name="l02365"></a>02365 Numerical Method:
<a name="l02366"></a>02366  + Spatial discretization (hyperbolic): 5th order CRWENO (<a class="code" href="a00041.html#a33b1e24c12129941b0027a83c543a654" title="5th order CRWENO reconstruction (component-wise) on a uniform grid">Interp1PrimFifthOrderCRWENO</a>())
<a name="l02367"></a>02367  + Time integration: PETSc (<a class="code" href="a00039.html#a4dc9b9ce6ce776b7901fa2a6c9c9c1cf" title="Integrate in time with PETSc.">SolvePETSc</a>()) 
<a name="l02368"></a>02368     - Method <span class="keyword">class</span>: &lt;B&gt;Runge-Kutta&lt;/B&gt; (TSRK - http:<span class="comment">//www.mcs.anl.gov/petsc/petsc-current/docs/manualpages/TS/TSRK.html)</span>
<a name="l02369"></a>02369     - Specific method: &lt;B&gt;Classical 4th-order RK&lt;/B&gt; (TSRK4 - http:<span class="comment">//www.mcs.anl.gov/petsc/petsc-current/docs/manualpages/TS/TSRK4.html#TSRK4)</span>
<a name="l02370"></a>02370 
<a name="l02371"></a>02371 Input files <a class="code" href="a00032.html#af7a1b4a66a5b6f9ac8eebf2c23b51e9e">required</a>:
<a name="l02372"></a>02372 ---------------------
<a name="l02373"></a>02373 
<a name="l02374"></a>02374 &lt;B&gt;.petscrc&lt;/B&gt;
<a name="l02375"></a>02375 \include 1D/LinearAdvection/SineWave_PETSc/petscrc
<a name="l02376"></a>02376 
<a name="l02377"></a>02377 \b solver.inp
<a name="l02378"></a>02378 \include 1D/LinearAdvection/SineWave_PETSc/solver.inp
<a name="l02379"></a>02379 
<a name="l02380"></a>02380 \b boundary.inp
<a name="l02381"></a>02381 \include 1D/LinearAdvection/SineWave_PETSc/boundary.inp
<a name="l02382"></a>02382 
<a name="l02383"></a>02383 \b physics.inp
<a name="l02384"></a>02384 \include 1D/LinearAdvection/SineWave_PETSc/physics.inp
<a name="l02385"></a>02385 
<a name="l02386"></a>02386 \b lusolver.inp (optional)
<a name="l02387"></a>02387 \include 1D/LinearAdvection/SineWave_PETSc/lusolver.inp
<a name="l02388"></a>02388 
<a name="l02389"></a>02389 \b weno.inp (optional)
<a name="l02390"></a>02390 \include 1D/LinearAdvection/SineWave_PETSc/weno.inp
<a name="l02391"></a>02391 
<a name="l02392"></a>02392 To generate \b initial.inp, compile and run the 
<a name="l02393"></a>02393 following code in the run directory. \b <a class="code" href="a00032.html#a86616b1951d3af95df5b7115dd30438f">Note</a>: <span class="keywordflow">if</span> the
<a name="l02394"></a>02394 <span class="keyword">final</span> time is an integer multiple of the time period,
<a name="l02395"></a>02395 the file \b initial.inp can also be <a class="code" href="a00032.html#aa2f9253c1a63124e53d64db71f7e7c16">used</a> as the exact
<a name="l02396"></a>02396 solution \b exact.inp (i.e. create a sym link called 
<a name="l02397"></a>02397 \a exact.inp pointing to \a initial.inp, or just <a class="code" href="a00063.html#af77238a13603775a1f60ae9206d86600">copy</a>
<a name="l02398"></a>02398 \a initial.inp to \a exact.inp).
<a name="l02399"></a>02399 \include 1D/LinearAdvection/SineWave_PETSc/aux/init.c
<a name="l02400"></a>02400 
<a name="l02401"></a>02401 Output:
<a name="l02402"></a>02402 -------
<a name="l02403"></a>02403 After running the code, there should be 11 output
<a name="l02404"></a>02404 files \b op_00000.dat, \b op_00001.dat, ... \b op_00010.dat; 
<a name="l02405"></a>02405 the first one is the solution at \f$t=0\f$ and the <span class="keyword">final</span> one
<a name="l02406"></a>02406 is the solution at \f$t=1\f$. Since #<a class="code" href="a00015.html#a4e93cb107e180ef982b74cef7726b70f">HyPar::op_overwrite</a> is
<a name="l02407"></a>02407 <span class="keyword">set</span> to \a no in \b solver.inp, separate files are written
<a name="l02408"></a>02408 <span class="keywordflow">for</span> solutions at each output time. All the files are ASCII 
<a name="l02409"></a>02409 <a class="code" href="a00031.html#a314f90bacf496961ff4bfef89fea32c0">text</a> (#<a class="code" href="a00015.html#a51a3b8c19b86e9e1df5be02b05a6613c">HyPar::op_file_format</a> is <span class="keyword">set</span> to \a <a class="code" href="a00031.html#a314f90bacf496961ff4bfef89fea32c0">text</a> in \b solver.inp).
<a name="l02410"></a>02410 In these files, the first column is grid index, the second column 
<a name="l02411"></a>02411 is x-coordinate, and the third column is the solution.
<a name="l02412"></a>02412 
<a name="l02413"></a>02413 Solutions at t=0,0.5,1: The following figure is obtained 
<a name="l02414"></a>02414 <a class="code" href="a00032.html#a124150da8eed3d9f42e9361cc143ed7e">by</a> plotting \a op_00000.dat (initial), \a op_00005.dat (t=0.5),
<a name="l02415"></a>02415 and \a op_00010.dat (<span class="keyword">final</span>). 
<a name="l02416"></a>02416 @image html Solution_1DLinearAdvSinePETSc.png
<a name="l02417"></a>02417 
<a name="l02418"></a>02418 Since the exact solution is available at the <span class="keyword">final</span> time 
<a name="l02419"></a>02419 (\a exact.inp is a <a class="code" href="a00063.html#af77238a13603775a1f60ae9206d86600">copy</a> of \a initial.inp), the numerical 
<a name="l02420"></a>02420 errors are calculated and reported on <a class="code" href="a00031.html#a33ca5fac0002baea0232773cd8578277">screen</a> (see below)
<a name="l02421"></a>02421 as well as \b errors.dat:
<a name="l02422"></a>02422 \include 1D/LinearAdvection/SineWave_PETSc/errors.dat
<a name="l02423"></a>02423 The numbers are: number of grid points (#<a class="code" href="a00015.html#aa989ebb755986852177779cdf7bd8c85">HyPar::dim_global</a>), 
<a name="l02424"></a>02424 number of processors (#<a class="code" href="a00019.html#a0be0f30a83bc3f3d9f6ee3a36bbf2716">MPIVariables::iproc</a>),
<a name="l02425"></a>02425 time step size (#<a class="code" href="a00015.html#a03e28be41881b703c836edbfe9b51b17">HyPar::dt</a>),
<a name="l02426"></a>02426 L1, L2, and L-infinity errors (#<a class="code" href="a00015.html#aa40f27cb2afa2db0f0468962be8b3679">HyPar::error</a>),
<a name="l02427"></a>02427 solver wall time (seconds) (i.e., not accounting <span class="keywordflow">for</span> initialization,
<a name="l02428"></a>02428 and cleaning up),
<a name="l02429"></a>02429 and total wall time.
<a name="l02430"></a>02430 
<a name="l02431"></a>02431 Expected screen output:
<a name="l02432"></a>02432 \include 1D/LinearAdvection/SineWave_PETSc/output.log
<a name="l02433"></a>02433 
<a name="l02434"></a>02434 
<a name="l02435"></a>02435 \<a class="code" href="a00032.html#a23a77f360d9ab0a90b11ff01314b6526">page</a> linear_adv_disc_petsc 1D Linear Advection - Discontinuous Waves
<a name="l02436"></a>02436 
<a name="l02437"></a>02437 <a class="code" href="a00031.html#af7342acc7b7299a81e83b43ed11b9f84">Location</a>: \b hypar/<a class="code" href="a00031.html#a60f502575a2e782807ea78c05f76ae03">Examples</a>/1D/LinearAdvection/DiscontinuousWaves_PETSc
<a name="l02438"></a>02438           (This directory contains all the input files needed
<a name="l02439"></a>02439           to run <span class="keyword">this</span> <span class="keywordflow">case</span>. If there is a \a Run.m, run it in
<a name="l02440"></a>02440           MATLAB to quickly <span class="keyword">set</span> up, run, and visualize the 
<a name="l02441"></a>02441           example).
<a name="l02442"></a>02442 
<a name="l02443"></a>02443 Governing equations: 1D Linear Advection Equation (linearadr.h)
<a name="l02444"></a>02444 
<a name="l02445"></a>02445 References:
<a name="l02446"></a>02446   + Ghosh, D., Baeder, J. D., &quot;Compact Reconstruction Schemes with 
<a name="l02447"></a>02447     Weighted ENO Limiting for Hyperbolic Conservation Laws&quot;, 
<a name="l02448"></a>02448     SIAM Journal on Scientific Computing, 34 (3), 2012, A1678–A1706
<a name="l02449"></a>02449 
<a name="l02450"></a>02450 <a class="code" href="a00031.html#a948095327123305f3fdf2b293b55381e">Domain</a>: \f$-1 \le x \le 1\f$, \a &quot;periodic&quot; (<span class="preprocessor">#_PERIODIC_)</span>
<a name="l02451"></a>02451 <span class="preprocessor"></span>        boundary <a class="code" href="a00063.html#a07bca284db2938db7ad469438892ca47">conditions</a>
<a name="l02452"></a>02452 
<a name="l02453"></a>02453 Initial solution:
<a name="l02454"></a>02454   \f{<a class="code" href="a00033.html#ac3f62e1b06188678336543688cb7709e">equation</a>}{
<a name="l02455"></a>02455     u\left(x,0\right) = \left\{\begin{array}{lc} 
<a name="l02456"></a>02456                           \exp\left(-\log\left(2\right)\frac{\left(x+7\right)^2}{0.0009}\right) &amp; -0.8\le x \le -0.6 \\
<a name="l02457"></a>02457                           1 &amp; -0.4\le x \le -0.2 \\
<a name="l02458"></a>02458                           1 - \left|10\left(x-0.1\right)\right| &amp; 0\le x \le 0.2 \\
<a name="l02459"></a>02459                           \sqrt{1-100\left(x-0.5\right)^2} &amp; 0.4\le x \le 0.6 \\
<a name="l02460"></a>02460                           0 &amp; {\rm otherwise}
<a name="l02461"></a>02461                         \end{array}\right.
<a name="l02462"></a>02462   \f}
<a name="l02463"></a>02463 
<a name="l02464"></a>02464 Numerical Method:
<a name="l02465"></a>02465  + Spatial <a class="code" href="a00033.html#a006f5ed6c12ae3d4f8e840cb181a05ca">discretization</a> (hyperbolic): 5th order CRWENO (<a class="code" href="a00041.html#a33b1e24c12129941b0027a83c543a654" title="5th order CRWENO reconstruction (component-wise) on a uniform grid">Interp1PrimFifthOrderCRWENO</a>())
<a name="l02466"></a>02466  + Time integration: PETSc (<a class="code" href="a00039.html#a4dc9b9ce6ce776b7901fa2a6c9c9c1cf" title="Integrate in time with PETSc.">SolvePETSc</a>()) 
<a name="l02467"></a>02467     - Method class: &lt;B&gt;Runge-Kutta&lt;/B&gt; (TSRK - http:<span class="comment">//www.mcs.anl.gov/petsc/petsc-current/docs/manualpages/TS/TSRK.html)</span>
<a name="l02468"></a>02468     - Specific method: &lt;B&gt;Dormand-Prince&lt;/B&gt; (TSRK5DP - http:<span class="comment">//www.mcs.anl.gov/petsc/petsc-current/docs/manualpages/TS/TSRK5DP.html#TSRK5DP)</span>
<a name="l02469"></a>02469 
<a name="l02470"></a>02470 Input files <a class="code" href="a00032.html#af7a1b4a66a5b6f9ac8eebf2c23b51e9e">required</a>:
<a name="l02471"></a>02471 ---------------------
<a name="l02472"></a>02472 
<a name="l02473"></a>02473 &lt;B&gt;.petscrc&lt;/B&gt;
<a name="l02474"></a>02474 \include 1D/LinearAdvection/DiscontinuousWaves_PETSc/petscrc
<a name="l02475"></a>02475 
<a name="l02476"></a>02476 \b solver.inp
<a name="l02477"></a>02477 \include 1D/LinearAdvection/DiscontinuousWaves_PETSc/solver.inp
<a name="l02478"></a>02478 
<a name="l02479"></a>02479 \b boundary.inp
<a name="l02480"></a>02480 \include 1D/LinearAdvection/DiscontinuousWaves_PETSc/boundary.inp
<a name="l02481"></a>02481 
<a name="l02482"></a>02482 \b physics.inp
<a name="l02483"></a>02483 \include 1D/LinearAdvection/DiscontinuousWaves_PETSc/physics.inp
<a name="l02484"></a>02484 
<a name="l02485"></a>02485 \b lusolver.inp (optional)
<a name="l02486"></a>02486 \include 1D/LinearAdvection/DiscontinuousWaves_PETSc/lusolver.inp
<a name="l02487"></a>02487 
<a name="l02488"></a>02488 \b weno.inp (optional)
<a name="l02489"></a>02489 \include 1D/LinearAdvection/DiscontinuousWaves_PETSc/weno.inp
<a name="l02490"></a>02490 
<a name="l02491"></a>02491 To generate \b initial.inp, compile and run the 
<a name="l02492"></a>02492 following code in the run directory. \b <a class="code" href="a00032.html#a86616b1951d3af95df5b7115dd30438f">Note</a>: if the
<a name="l02493"></a>02493 final time is an integer multiple of the time period,
<a name="l02494"></a>02494 the file \b initial.inp can also be <a class="code" href="a00032.html#aa2f9253c1a63124e53d64db71f7e7c16">used</a> as the exact
<a name="l02495"></a>02495 solution \b exact.inp (i.e. create a sym link called 
<a name="l02496"></a>02496 \a exact.inp pointing to \a initial.inp, or just <a class="code" href="a00063.html#af77238a13603775a1f60ae9206d86600">copy</a>
<a name="l02497"></a>02497 \a initial.inp to \a exact.inp).
<a name="l02498"></a>02498 \include 1D/LinearAdvection/DiscontinuousWaves_PETSc/aux/init.c
<a name="l02499"></a>02499 
<a name="l02500"></a>02500 Output:
<a name="l02501"></a>02501 -------
<a name="l02502"></a>02502 After running the code, there should be two solution output
<a name="l02503"></a>02503 files \b op_00000.<a class="code" href="a00031.html#a96b9dfbebc4ecd57a32426075fb0c3f2">dat</a> and \b op_00001.<a class="code" href="a00031.html#a96b9dfbebc4ecd57a32426075fb0c3f2">dat</a>; the first one is
<a name="l02504"></a>02504 the initial solution, and the latter is the <span class="keyword">final</span> solution.
<a name="l02505"></a>02505 Both these files are ASCII <a class="code" href="a00031.html#a314f90bacf496961ff4bfef89fea32c0">text</a> (#<a class="code" href="a00015.html#a51a3b8c19b86e9e1df5be02b05a6613c">HyPar::op_file_format</a> is
<a name="l02506"></a>02506 <span class="keyword">set</span> to \a <a class="code" href="a00031.html#a314f90bacf496961ff4bfef89fea32c0">text</a> in \b solver.inp).
<a name="l02507"></a>02507 
<a name="l02508"></a>02508 Final solution at t=2.0: The following figure is obtained 
<a name="l02509"></a>02509 <a class="code" href="a00032.html#a124150da8eed3d9f42e9361cc143ed7e">by</a> plotting \a op_00000.dat (initial) and \a op_00001.dat
<a name="l02510"></a>02510 (<span class="keyword">final</span>). In both these files, the first column is grid 
<a name="l02511"></a>02511 index, the second column is x-coordinate, and the third 
<a name="l02512"></a>02512 column is the solution.
<a name="l02513"></a>02513 @image html Solution_1DLinearAdvDiscPETSc.png
<a name="l02514"></a>02514 
<a name="l02515"></a>02515 Expected screen output:
<a name="l02516"></a>02516 \include 1D/LinearAdvection/DiscontinuousWaves_PETSc/output.log
<a name="l02517"></a>02517 
<a name="l02518"></a>02518 
<a name="l02519"></a>02519 \<a class="code" href="a00032.html#a23a77f360d9ab0a90b11ff01314b6526">page</a> linear_diff_sine_petsc 1D Linear Diffusion - Sine Wave
<a name="l02520"></a>02520 
<a name="l02521"></a>02521 <a class="code" href="a00031.html#af7342acc7b7299a81e83b43ed11b9f84">Location</a>: \b hypar/<a class="code" href="a00031.html#a60f502575a2e782807ea78c05f76ae03">Examples</a>/1D/LinearDiffusion/SineWave_PETSc
<a name="l02522"></a>02522           (This directory contains all the input files needed
<a name="l02523"></a>02523           to run <span class="keyword">this</span> <span class="keywordflow">case</span>. If there is a \a Run.m, run it in
<a name="l02524"></a>02524           MATLAB to quickly <span class="keyword">set</span> up, run, and visualize the 
<a name="l02525"></a>02525           example).
<a name="l02526"></a>02526 
<a name="l02527"></a>02527 Governing equations: 1D Linear Diffusion Equation (linearadr.h)
<a name="l02528"></a>02528 
<a name="l02529"></a>02529 <a class="code" href="a00031.html#a948095327123305f3fdf2b293b55381e">Domain</a>: \f$0 \le x &lt; 1\f$, \a &quot;periodic&quot; (<span class="preprocessor">#_PERIODIC_) </span>
<a name="l02530"></a>02530 <span class="preprocessor"></span>        boundary <a class="code" href="a00063.html#a07bca284db2938db7ad469438892ca47">conditions</a>
<a name="l02531"></a>02531 
<a name="l02532"></a>02532 Initial solution: \f$u\left(x,0\right) = \sin\left(2\pi x\right)\f$
<a name="l02533"></a>02533 
<a name="l02534"></a>02534 Numerical Method:
<a name="l02535"></a>02535   + Spatial <a class="code" href="a00033.html#a006f5ed6c12ae3d4f8e840cb181a05ca">discretization</a> (parabolic): 2nd order (<a class="code" href="a00041.html#ae8bfe856abd743f5af925dc03e708ee3" title="2nd order component-wise interpolation of the 2nd primitive on a uniform grid">Interp2PrimSecondOrder</a>()),
<a name="l02536"></a>02536                                         conservative (<a class="code" href="a00033.html#a62d59663e168051efcb7306776473ecb">ParabolicFunctionCons1Stage</a>())
<a name="l02537"></a>02537   + Time integration: PETSc (<a class="code" href="a00039.html#a4dc9b9ce6ce776b7901fa2a6c9c9c1cf" title="Integrate in time with PETSc.">SolvePETSc</a>()) - &lt;B&gt;Crank-Nicholson&lt;/B&gt; (TSCN - http:<span class="comment">//www.mcs.anl.gov/petsc/petsc-current/docs/manualpages/TS/TSCN.html)</span>
<a name="l02538"></a>02538 
<a name="l02539"></a>02539 Input files <a class="code" href="a00032.html#af7a1b4a66a5b6f9ac8eebf2c23b51e9e">required</a>:
<a name="l02540"></a>02540 ---------------------
<a name="l02541"></a>02541 
<a name="l02542"></a>02542 &lt;B&gt;.petscrc&lt;/B&gt;
<a name="l02543"></a>02543 \include 1D/LinearDiffusion/SineWave_PETSc/petscrc
<a name="l02544"></a>02544 
<a name="l02545"></a>02545 \b solver.inp
<a name="l02546"></a>02546 \include 1D/LinearDiffusion/SineWave_PETSc/solver.inp
<a name="l02547"></a>02547 
<a name="l02548"></a>02548 \b boundary.inp
<a name="l02549"></a>02549 \include 1D/LinearDiffusion/SineWave_PETSc/boundary.inp
<a name="l02550"></a>02550 
<a name="l02551"></a>02551 \b physics.inp
<a name="l02552"></a>02552 \include 1D/LinearDiffusion/SineWave_PETSc/physics.inp
<a name="l02553"></a>02553 
<a name="l02554"></a>02554 To generate \b initial.inp (initial solution) and 
<a name="l02555"></a>02555 \b exact.inp (exact solution), compile and run the 
<a name="l02556"></a>02556 following code in the run directory. 
<a name="l02557"></a>02557 \include 1D/LinearDiffusion/SineWave_PETSc/aux/exact.c
<a name="l02558"></a>02558 
<a name="l02559"></a>02559 Output:
<a name="l02560"></a>02560 -------
<a name="l02561"></a>02561 After running the code, there should be 6 output
<a name="l02562"></a>02562 files \b op_00000.<a class="code" href="a00031.html#a96b9dfbebc4ecd57a32426075fb0c3f2">dat</a>, \b op_00001.<a class="code" href="a00031.html#a96b9dfbebc4ecd57a32426075fb0c3f2">dat</a>, ... \b op_00005.<a class="code" href="a00031.html#a96b9dfbebc4ecd57a32426075fb0c3f2">dat</a>; 
<a name="l02563"></a>02563 the first one is the solution at \f$t=0\f$ and the <span class="keyword">final</span> one
<a name="l02564"></a>02564 is the solution at \f$t=10\f$. Since #<a class="code" href="a00015.html#a4e93cb107e180ef982b74cef7726b70f">HyPar::op_overwrite</a> is
<a name="l02565"></a>02565 <span class="keyword">set</span> to \a no in \b solver.inp, separate files are written
<a name="l02566"></a>02566 <span class="keywordflow">for</span> solutions at each output time. All the files are ASCII 
<a name="l02567"></a>02567 <a class="code" href="a00031.html#a314f90bacf496961ff4bfef89fea32c0">text</a> (#<a class="code" href="a00015.html#a51a3b8c19b86e9e1df5be02b05a6613c">HyPar::op_file_format</a> is <span class="keyword">set</span> to \a <a class="code" href="a00031.html#a314f90bacf496961ff4bfef89fea32c0">text</a> in \b solver.inp).
<a name="l02568"></a>02568 In these files, the first column is grid index, the second column 
<a name="l02569"></a>02569 is x-coordinate, and the third column is the solution.
<a name="l02570"></a>02570 
<a name="l02571"></a>02571 Solutions at t=0,2,4,6,8,10: The following figure is obtained 
<a name="l02572"></a>02572 <a class="code" href="a00032.html#a124150da8eed3d9f42e9361cc143ed7e">by</a> plotting the solution files.
<a name="l02573"></a>02573 @image html Solution_1DLinearDiffSinePETSc.png
<a name="l02574"></a>02574 
<a name="l02575"></a>02575 Since the exact solution is available at the <span class="keyword">final</span> time 
<a name="l02576"></a>02576 , the numerical 
<a name="l02577"></a>02577 errors are calculated and reported on <a class="code" href="a00031.html#a33ca5fac0002baea0232773cd8578277">screen</a> (see below)
<a name="l02578"></a>02578 as well as \b errors.dat:
<a name="l02579"></a>02579 \include 1D/LinearDiffusion/SineWave_PETSc/errors.dat
<a name="l02580"></a>02580 The numbers are: number of grid points (#<a class="code" href="a00015.html#aa989ebb755986852177779cdf7bd8c85">HyPar::dim_global</a>), 
<a name="l02581"></a>02581 number of processors (#<a class="code" href="a00019.html#a0be0f30a83bc3f3d9f6ee3a36bbf2716">MPIVariables::iproc</a>),
<a name="l02582"></a>02582 time step size (#<a class="code" href="a00015.html#a03e28be41881b703c836edbfe9b51b17">HyPar::dt</a>),
<a name="l02583"></a>02583 L1, L2, and L-infinity errors (#<a class="code" href="a00015.html#aa40f27cb2afa2db0f0468962be8b3679">HyPar::error</a>),
<a name="l02584"></a>02584 solver wall time (seconds) (i.e., not accounting <span class="keywordflow">for</span> initialization,
<a name="l02585"></a>02585 and cleaning up),
<a name="l02586"></a>02586 and total wall time.
<a name="l02587"></a>02587 
<a name="l02588"></a>02588 Expected screen output:
<a name="l02589"></a>02589 \include 1D/LinearDiffusion/SineWave_PETSc/output.log
<a name="l02590"></a>02590 
<a name="l02591"></a>02591 
<a name="l02592"></a>02592 \<a class="code" href="a00032.html#a23a77f360d9ab0a90b11ff01314b6526">page</a> linear_diff_sine2d_petsc 2D Linear Diffusion - Sine Wave
<a name="l02593"></a>02593 
<a name="l02594"></a>02594 <a class="code" href="a00031.html#af7342acc7b7299a81e83b43ed11b9f84">Location</a>: \b hypar/<a class="code" href="a00031.html#a60f502575a2e782807ea78c05f76ae03">Examples</a>/2D/LinearDiffusion/SineWave_PETSc
<a name="l02595"></a>02595           (This directory contains all the input files needed
<a name="l02596"></a>02596           to run <span class="keyword">this</span> <span class="keywordflow">case</span>. If there is a \a Run.m, run it in
<a name="l02597"></a>02597           MATLAB to quickly <span class="keyword">set</span> up, run, and visualize the 
<a name="l02598"></a>02598           example).
<a name="l02599"></a>02599 
<a name="l02600"></a>02600 Governing equations: 2D Linear Diffusion Equation (linearadr.h)
<a name="l02601"></a>02601 
<a name="l02602"></a>02602 <a class="code" href="a00031.html#a948095327123305f3fdf2b293b55381e">Domain</a>: \f$0 \le x,y &lt; 1\f$, \a &quot;periodic&quot; (<span class="preprocessor">#_PERIODIC_)</span>
<a name="l02603"></a>02603 <span class="preprocessor"></span>        boundary <a class="code" href="a00063.html#a07bca284db2938db7ad469438892ca47">conditions</a> on all boundaries.
<a name="l02604"></a>02604 
<a name="l02605"></a>02605 Initial solution: \f$u\left(x,y,0\right) = u_0\left(x,y\right)= \sin\left(2\pi x\right)\sin\left(2\pi y\right)\f$\n
<a name="l02606"></a>02606 Exact solution: \f$u\left(x,y,t\right) = \exp\left[-\pi^2 \left(4\nu_x + 4\nu_y\right) t\right] u0\left(x,y\right)\f$.
<a name="l02607"></a>02607 
<a name="l02608"></a>02608 Numerical Method:
<a name="l02609"></a>02609  + Spatial <a class="code" href="a00033.html#a006f5ed6c12ae3d4f8e840cb181a05ca">discretization</a> (parabolic): 2nd order (<a class="code" href="a00041.html#ae8bfe856abd743f5af925dc03e708ee3" title="2nd order component-wise interpolation of the 2nd primitive on a uniform grid">Interp2PrimSecondOrder</a>()), 
<a name="l02610"></a>02610                                        conservative (<a class="code" href="a00033.html#a62d59663e168051efcb7306776473ecb">ParabolicFunctionCons1Stage</a>())
<a name="l02611"></a>02611  + Time integration: PETSc (<a class="code" href="a00039.html#a4dc9b9ce6ce776b7901fa2a6c9c9c1cf" title="Integrate in time with PETSc.">SolvePETSc</a>()) 
<a name="l02612"></a>02612    - Method Class: &lt;B&gt;Additive Runge-Kutta method&lt;/B&gt; (TSARKIMEX - http:<span class="comment">//www.mcs.anl.gov/petsc/petsc-current/docs/manualpages/TS/TSARKIMEX.html) -</span>
<a name="l02613"></a>02613      Although the ARK methods are semi-implicit (IMEX), here they are <a class="code" href="a00032.html#aa2f9253c1a63124e53d64db71f7e7c16">used</a> in the <span class="stringliteral">&quot;fully implicit&quot;</span> mode, i.e., the implicit 
<a name="l02614"></a>02614      method is <a class="code" href="a00032.html#aa2f9253c1a63124e53d64db71f7e7c16">used</a> to solve the complete <a class="code" href="a00033.html#ac3f62e1b06188678336543688cb7709e">equation</a> (<a class="code" href="a00032.html#a86616b1951d3af95df5b7115dd30438f">Note</a> the flag \b -ts_arkimex_fully_implicit in &lt;B&gt;.petscrc&lt;/B&gt;).
<a name="l02615"></a>02615    - Specific method: &lt;B&gt;Kennedy-Carpenter ARK4&lt;/B&gt; (TSARKIMEX4 - http:<span class="comment">//www.mcs.anl.gov/petsc/petsc-current/docs/manualpages/TS/TSARKIMEX4.html)</span>
<a name="l02616"></a>02616 
<a name="l02617"></a>02617 
<a name="l02618"></a>02618 Input files <a class="code" href="a00032.html#af7a1b4a66a5b6f9ac8eebf2c23b51e9e">required</a>:
<a name="l02619"></a>02619 ---------------------
<a name="l02620"></a>02620 
<a name="l02621"></a>02621 &lt;B&gt;.petscrc&lt;/B&gt;
<a name="l02622"></a>02622 \include 2D/LinearDiffusion/SineWave_PETSc/petscrc
<a name="l02623"></a>02623 
<a name="l02624"></a>02624 \b solver.inp
<a name="l02625"></a>02625 \include 2D/LinearDiffusion/SineWave_PETSc/solver.inp
<a name="l02626"></a>02626 
<a name="l02627"></a>02627 \b boundary.inp
<a name="l02628"></a>02628 \include 2D/LinearDiffusion/SineWave_PETSc/boundary.inp
<a name="l02629"></a>02629 
<a name="l02630"></a>02630 \b physics.inp (specifies \f$\nu_x\f$ and \f$\nu_y\f$)
<a name="l02631"></a>02631 \include 2D/LinearDiffusion/SineWave_PETSc/physics.inp
<a name="l02632"></a>02632 
<a name="l02633"></a>02633 To generate \b initial.inp (initial solution) and 
<a name="l02634"></a>02634 \b exact.inp (exact solution), compile and run the 
<a name="l02635"></a>02635 following code in the run directory. 
<a name="l02636"></a>02636 \include 2D/LinearDiffusion/SineWave_PETSc/aux/exact.c
<a name="l02637"></a>02637 
<a name="l02638"></a>02638 Output:
<a name="l02639"></a>02639 -------
<a name="l02640"></a>02640 <a class="code" href="a00032.html#a86616b1951d3af95df5b7115dd30438f">Note</a> that \b iproc is set to 
<a name="l02641"></a>02641 
<a name="l02642"></a>02642       2 2
<a name="l02643"></a>02643 
<a name="l02644"></a>02644 in \b solver.inp (i.e., 2 processors along \a x, and 2
<a name="l02645"></a>02645 processors along \a y). Thus, this example should be run
<a name="l02646"></a>02646 with 4 MPI ranks (or change \b iproc).
<a name="l02647"></a>02647 
<a name="l02648"></a>02648 After running the code, there should be 2 output
<a name="l02649"></a>02649 files: \b op_00000.<a class="code" href="a00031.html#a96b9dfbebc4ecd57a32426075fb0c3f2">dat</a> (initial solution at t=0) and 
<a name="l02650"></a>02650 \b op_00001.<a class="code" href="a00031.html#a96b9dfbebc4ecd57a32426075fb0c3f2">dat</a> (final solution at t=10). Since #<a class="code" href="a00015.html" title="Structure containing all solver-specific variables and functions.">HyPar</a>::op_overwrite is
<a name="l02651"></a>02651 set to \a no in \b solver.inp, separate files are written
<a name="l02652"></a>02652 for solutions at each output time. 
<a name="l02653"></a>02653   
<a name="l02654"></a>02654 #<a class="code" href="a00015.html" title="Structure containing all solver-specific variables and functions.">HyPar</a>::op_file_format is set to \a tecplot2d in \b solver.inp, and
<a name="l02655"></a>02655 thus, all the files are in a format that Tecplot (http:<span class="comment">//www.tecplot.com/)</span>
<a name="l02656"></a>02656 or other visualization software supporting the Tecplot format 
<a name="l02657"></a>02657 (e.g. VisIt - https:<span class="comment">//wci.llnl.gov/simulation/computer-codes/visit/)</span>
<a name="l02658"></a>02658 can read. In these files, the first two lines are the Tecplot headers, 
<a name="l02659"></a>02659 after which the data is written out as: the first two columns are grid indices, 
<a name="l02660"></a>02660 the next two columns are x and y coordinates, and the final column is the 
<a name="l02661"></a>02661 solution.  #<a class="code" href="a00015.html" title="Structure containing all solver-specific variables and functions.">HyPar</a>::op_file_format can be set to \a <a class="code" href="a00031.html#a314f90bacf496961ff4bfef89fea32c0">text</a> to get the solution
<a name="l02662"></a>02662 files in plain <a class="code" href="a00031.html#a314f90bacf496961ff4bfef89fea32c0">text</a> format (which can be read in and visualized in
<a name="l02663"></a>02663 MATLAB for example).
<a name="l02664"></a>02664 
<a name="l02665"></a>02665 The following plots show the initial and final solutions:
<a name="l02666"></a>02666 @image html Solution_2DLinearDiffSinePETSc.png
<a name="l02667"></a>02667 
<a name="l02668"></a>02668 Since the exact solution is available at the final time 
<a name="l02669"></a>02669 , the numerical 
<a name="l02670"></a>02670 errors are calculated and reported on screen (see below)
<a name="l02671"></a>02671 as well as \b errors.<a class="code" href="a00031.html#a96b9dfbebc4ecd57a32426075fb0c3f2">dat</a>:
<a name="l02672"></a>02672 \include 2D/LinearDiffusion/SineWave_PETSc/errors.<a class="code" href="a00031.html#a96b9dfbebc4ecd57a32426075fb0c3f2">dat</a>
<a name="l02673"></a>02673 The numbers are: number of grid points in each dimension (#<a class="code" href="a00015.html" title="Structure containing all solver-specific variables and functions.">HyPar</a>::dim_global), 
<a name="l02674"></a>02674 number of processors in each dimension (#<a class="code" href="a00019.html" title="Structure of MPI-related variables.">MPIVariables</a>::iproc),
<a name="l02675"></a>02675 time step size (#<a class="code" href="a00015.html" title="Structure containing all solver-specific variables and functions.">HyPar</a>::dt),
<a name="l02676"></a>02676 L1, L2, and L-infinity errors (#<a class="code" href="a00015.html" title="Structure containing all solver-specific variables and functions.">HyPar</a>::error),
<a name="l02677"></a>02677 solver wall time (seconds) (i.e., not accounting for initialization,
<a name="l02678"></a>02678 and cleaning up),
<a name="l02679"></a>02679 and total wall time.
<a name="l02680"></a>02680 
<a name="l02681"></a>02681 Expected screen output:
<a name="l02682"></a>02682 \include 2D/LinearDiffusion/SineWave_PETSc/output.log
<a name="l02683"></a>02683 
<a name="l02684"></a>02684 
<a name="l02685"></a>02685 \<a class="code" href="a00032.html#a23a77f360d9ab0a90b11ff01314b6526">page</a> euler2d_rtb_petsc_imex 2D Euler Equations (with gravitational force) - Rising Thermal Bubble
<a name="l02686"></a>02686 
<a name="l02687"></a>02687 <a class="code" href="a00031.html#af7342acc7b7299a81e83b43ed11b9f84">Location</a>: \b hypar/<a class="code" href="a00031.html#a60f502575a2e782807ea78c05f76ae03">Examples</a>/2D/<a class="code" href="a00021.html" title="Structure containing variables and parameters specific to the 2D Navier Stokes equations...">NavierStokes2D</a>/RisingThermalBubble_PETSc_IMEX
<a name="l02688"></a>02688           (This directory contains all the input files needed
<a name="l02689"></a>02689           to run this case. If there is a \a Run.m, run it in
<a name="l02690"></a>02690           MATLAB to quickly set up, run, and visualize the 
<a name="l02691"></a>02691           example).
<a name="l02692"></a>02692 
<a name="l02693"></a>02693 Governing equations: 2D Euler Equations (navierstokes2d.h - By default,
<a name="l02694"></a>02694                      #<a class="code" href="a00021.html" title="Structure containing variables and parameters specific to the 2D Navier Stokes equations...">NavierStokes2D</a>::Re is set to \b -1 which makes the
<a name="l02695"></a>02695                      code skip the parabolic terms, i.e., the 2D Euler
<a name="l02696"></a>02696                      equations are solved.)
<a name="l02697"></a>02697 
<a name="l02698"></a>02698 Reference:
<a name="l02699"></a>02699   + Giraldo, F.X., Restelli, M., <span class="stringliteral">&quot;A study of spectral element and</span>
<a name="l02700"></a>02700 <span class="stringliteral">    discontinuous Galerkin methods for the Navier–Stokes equations</span>
<a name="l02701"></a>02701 <span class="stringliteral">    in nonhydrostatic mesoscale atmospheric modeling: Equation sets</span>
<a name="l02702"></a>02702 <span class="stringliteral">    and test cases&quot;</span>, J. Comput. Phys., 227, 2008, 3849--3877, 
<a name="l02703"></a>02703     (Section 3.2).
<a name="l02704"></a>02704 
<a name="l02705"></a>02705 The problem is solved here using &lt;B&gt;implicit-explicit (IMEX)&lt;/B&gt; time
<a name="l02706"></a>02706 integration, where the hyperbolic <a class="code" href="a00064.html#ae94fb13b2c09c2f8b5cdbb2fbe99cad7">flux</a> is partitioned into its entropy
<a name="l02707"></a>02707 and acoustic components with the former integrated explicitly and the
<a name="l02708"></a>02708 latter integrated implicitly. See the following reference:
<a name="l02709"></a>02709 + Ghosh, D., Constantinescu, E. M., <span class="stringliteral">&quot;Semi-Implicit Time Integration of </span>
<a name="l02710"></a>02710 <span class="stringliteral">  Atmospheric Flows with Characteristic-Based Flux Partitioning&quot;</span>, SIAM 
<a name="l02711"></a>02711   Journal on Scientific Computing, 38 (3), 2016, A1848-A1875, 
<a name="l02712"></a>02712   http:<span class="comment">//dx.doi.org/10.1137/15M1044369.</span>
<a name="l02713"></a>02713 
<a name="l02714"></a>02714 <a class="code" href="a00031.html#a948095327123305f3fdf2b293b55381e">Domain</a>: \f$0 \le x,y \le 1000\,m\f$, 
<a name="l02715"></a>02715         <span class="stringliteral">&quot;slip-wall&quot;</span> (#<a class="code" href="a00037.html#af3a9f3ba15bc914ed0a88295aee147e8">_SLIP_WALL_</a>) boundary <a class="code" href="a00063.html#a07bca284db2938db7ad469438892ca47">conditions</a> on all sides.
<a name="l02716"></a>02716 
<a name="l02717"></a>02717 Initial solution: See references above.
<a name="l02718"></a>02718 
<a name="l02719"></a>02719 Other parameters (all dimensional quantities are in SI units):
<a name="l02720"></a>02720   + Specific heat ratio \f$\gamma = 1.4\f$ (#<a class="code" href="a00021.html" title="Structure containing variables and parameters specific to the 2D Navier Stokes equations...">NavierStokes2D</a>::gamma)
<a name="l02721"></a>02721   + Universal gas constant \f$R = 287.058\f$ (#<a class="code" href="a00021.html" title="Structure containing variables and parameters specific to the 2D Navier Stokes equations...">NavierStokes2D</a>::R)
<a name="l02722"></a>02722   + Gravitational force per unit mass \f$g = 9.8\f$ along \a y-axis (#<a class="code" href="a00021.html" title="Structure containing variables and parameters specific to the 2D Navier Stokes equations...">NavierStokes2D</a>::grav_y)
<a name="l02723"></a>02723   + Reference density (at zero altitude) \f$\rho_{ref} = 1.1612055171196529\f$ (#<a class="code" href="a00021.html#a1e6f66261d19a1c1c272e8808bd2657b">NavierStokes2D::rho0</a>)
<a name="l02724"></a>02724   + Reference <a class="code" href="a00032.html#a58d87a94271c7f86a36fafc7117fe0b0">pressure</a> (at zero altitude) \f$P_{ref} = 100000\f$ (#<a class="code" href="a00021.html#a8be9de5ac626cddcd15c5ec181619694">NavierStokes2D::p0</a>)
<a name="l02725"></a>02725   + Hydrostatic balance type 2 (#<a class="code" href="a00021.html#a2e01ef077b0fedaea9e286ccdf2fe259">NavierStokes2D::HB</a>)
<a name="l02726"></a>02726 
<a name="l02727"></a>02727 Numerical method:
<a name="l02728"></a>02728  + Spatial discretization (hyperbolic): 5th order WENO (<a class="code" href="a00041.html#af2195885ad055989a1b2b11655843343" title="5th order WENO reconstruction (component-wise) on a uniform grid">Interp1PrimFifthOrderWENO</a>())
<a name="l02729"></a>02729  + Time integration: PETSc (<a class="code" href="a00039.html#a4dc9b9ce6ce776b7901fa2a6c9c9c1cf" title="Integrate in time with PETSc.">SolvePETSc</a>()) 
<a name="l02730"></a>02730    - Method Class: &lt;B&gt;Additive Runge-Kutta method&lt;/B&gt; (TSARKIMEX - http:<span class="comment">//www.mcs.anl.gov/petsc/petsc-current/docs/manualpages/TS/TSARKIMEX.html)</span>
<a name="l02731"></a>02731    - Specific method: &lt;B&gt;Kennedy-Carpenter ARK4&lt;/B&gt; (TSARKIMEX4 - http:<span class="comment">//www.mcs.anl.gov/petsc/petsc-current/docs/manualpages/TS/TSARKIMEX4.html)</span>
<a name="l02732"></a>02732 
<a name="l02733"></a>02733 
<a name="l02734"></a>02734 Input files <a class="code" href="a00032.html#af7a1b4a66a5b6f9ac8eebf2c23b51e9e">required</a>:
<a name="l02735"></a>02735 ---------------------
<a name="l02736"></a>02736 
<a name="l02737"></a>02737 &lt;B&gt;.petscrc&lt;/B&gt;
<a name="l02738"></a>02738 \include 2D/<a class="code" href="a00021.html" title="Structure containing variables and parameters specific to the 2D Navier Stokes equations...">NavierStokes2D</a>/RisingThermalBubble_PETSc_IMEX/petscrc
<a name="l02739"></a>02739 
<a name="l02740"></a>02740 \b solver.inp
<a name="l02741"></a>02741 \include 2D/<a class="code" href="a00021.html" title="Structure containing variables and parameters specific to the 2D Navier Stokes equations...">NavierStokes2D</a>/RisingThermalBubble_PETSc_IMEX/solver.inp
<a name="l02742"></a>02742 
<a name="l02743"></a>02743 \b boundary.inp
<a name="l02744"></a>02744 \include 2D/<a class="code" href="a00021.html" title="Structure containing variables and parameters specific to the 2D Navier Stokes equations...">NavierStokes2D</a>/RisingThermalBubble_PETSc_IMEX/boundary.inp
<a name="l02745"></a>02745 
<a name="l02746"></a>02746 \b physics.inp
<a name="l02747"></a>02747 \include 2D/<a class="code" href="a00021.html" title="Structure containing variables and parameters specific to the 2D Navier Stokes equations...">NavierStokes2D</a>/RisingThermalBubble_PETSc_IMEX/physics.inp
<a name="l02748"></a>02748 
<a name="l02749"></a>02749 \b weno.inp (optional)
<a name="l02750"></a>02750 \include 2D/<a class="code" href="a00021.html" title="Structure containing variables and parameters specific to the 2D Navier Stokes equations...">NavierStokes2D</a>/RisingThermalBubble_PETSc_IMEX/weno.inp
<a name="l02751"></a>02751 
<a name="l02752"></a>02752 To generate \b initial.inp (initial solution), compile 
<a name="l02753"></a>02753 and run the following code in the run directory.
<a name="l02754"></a>02754 \include 2D/<a class="code" href="a00021.html" title="Structure containing variables and parameters specific to the 2D Navier Stokes equations...">NavierStokes2D</a>/RisingThermalBubble_PETSc_IMEX/aux/init.c
<a name="l02755"></a>02755 
<a name="l02756"></a>02756 Output:
<a name="l02757"></a>02757 -------
<a name="l02758"></a>02758 <a class="code" href="a00032.html#a86616b1951d3af95df5b7115dd30438f">Note</a> that \b iproc is set to 
<a name="l02759"></a>02759 
<a name="l02760"></a>02760       1 1
<a name="l02761"></a>02761 
<a name="l02762"></a>02762 in \b solver.inp (i.e., 1 processor along \a x, and 1
<a name="l02763"></a>02763 processor along \a y). Thus, this example should be run
<a name="l02764"></a>02764 with 1 MPI rank (or change \b iproc).
<a name="l02765"></a>02765 
<a name="l02766"></a>02766 After running the code, there should be a output
<a name="l02767"></a>02767 file \b op.bin (final solution),  
<a name="l02768"></a>02768 since <span class="preprocessor">#HyPar::op_overwrite is set to \a yes in \b solver.inp.</span>
<a name="l02769"></a>02769 <span class="preprocessor"></span>  
<a name="l02770"></a>02770 <span class="preprocessor">#HyPar::op_file_format is set to \a binary in \b solver.inp, and</span>
<a name="l02771"></a>02771 <span class="preprocessor"></span>thus, the file is written out in the binary format, see 
<a name="l02772"></a>02772 <a class="code" href="a00042.html#a067f454c26d85d6cfb4d7d878b3783c9">WriteBinary</a>(). The binary file contains the conserved variables
<a name="l02773"></a>02773 \f$\left(\rho, \rho u, \rho v, e\right)\f$. The following code
<a name="l02774"></a>02774 converts these variables to the primitive variables of interest
<a name="l02775"></a>02775 to atmospheric flows \f$\left(\rho, u, v, p, \theta\right)\f$.
<a name="l02776"></a>02776 It also writes out the hydrostatically balanced quantities 
<a name="l02777"></a>02777 \f$\left(\rho_0,\pi_0, \theta_0\right)\f$ <span class="keywordflow">for</span> <span class="keyword">this</span> <span class="keywordflow">case</span> that
<a name="l02778"></a>02778 can be <a class="code" href="a00032.html#aa2f9253c1a63124e53d64db71f7e7c16">used</a> to compute and plot the temperature and density
<a name="l02779"></a>02779 perturbations. These variables are then written to either
<a name="l02780"></a>02780 a tecplot2d or <a class="code" href="a00031.html#a314f90bacf496961ff4bfef89fea32c0">text</a> file.
<a name="l02781"></a>02781 (compile and run it in the run directory):
<a name="l02782"></a>02782 \include 2D/<a class="code" href="a00021.html" title="Structure containing variables and parameters specific to the 2D Navier Stokes equations...">NavierStokes2D</a>/RisingThermalBubble_PETSc_IMEX/aux/PostProcess.c
<a name="l02783"></a>02783 
<a name="l02784"></a>02784 The following plot shows the potential temperature perturbation
<a name="l02785"></a>02785 contours at the <span class="keyword">final</span> time t=200s. 
<a name="l02786"></a>02786 @image html Solution_2DNavStokRTBPETSc.png
<a name="l02787"></a>02787 It was plotted <a class="code" href="a00032.html#a124150da8eed3d9f42e9361cc143ed7e">by</a> <span class="keyword">using</span> the 
<a name="l02788"></a>02788 above postprocessing code to write the solution in <a class="code" href="a00031.html#a314f90bacf496961ff4bfef89fea32c0">text</a> format
<a name="l02789"></a>02789 and <span class="keyword">using</span> the following MATLAB script:
<a name="l02790"></a>02790 \include 2D/<a class="code" href="a00021.html" title="Structure containing variables and parameters specific to the 2D Navier Stokes equations...">NavierStokes2D</a>/RisingThermalBubble_PETSc_IMEX/PlotSolution.m
<a name="l02791"></a>02791 
<a name="l02792"></a>02792 The file &lt;B&gt;function_counts.dat&lt;/B&gt; reports the computational expense
<a name="l02793"></a>02793 (in terms of the number of function counts):
<a name="l02794"></a>02794 \include 2D/<a class="code" href="a00021.html" title="Structure containing variables and parameters specific to the 2D Navier Stokes equations...">NavierStokes2D</a>/RisingThermalBubble_PETSc_IMEX/function_counts.dat
<a name="l02795"></a>02795 The numbers are, respectively,
<a name="l02796"></a>02796 + Time iterations
<a name="l02797"></a>02797 + Number of times the hyperbolic term was evaluated
<a name="l02798"></a>02798 + Number of times the parabolic term was evaluated
<a name="l02799"></a>02799 + Number of times the source term was evaluated
<a name="l02800"></a>02800 + Number of calls to the <span class="keyword">explicit</span> right-hand-side function (<a class="code" href="a00046.html#ac7d9b0a219eb22bfd37482b741bd79c9">PetscRHSFunctionIMEX</a>() or <a class="code" href="a00046.html#ac67533553372ed2b44b32d095c775f5c">PetscRHSFunctionExpl</a>())
<a name="l02801"></a>02801 + Number of calls to the implicit right-hand-side function (<a class="code" href="a00046.html#a9d093c3140369a1178dd5b9589a926b1">PetscIFunctionIMEX</a>() or <a class="code" href="a00046.html#a91eb21ee4374b79a74f413d926344d7e">PetscRHSFunctionImpl</a>())
<a name="l02802"></a>02802 + Number of calls to the Jacobian (<a class="code" href="a00046.html#a82aacb94c1481144ce3e43d40d1f04d4">PetscIJacobianIMEX</a>() or <a class="code" href="a00046.html#a3d6a695a879ec54937525109ac912355">PetscIJacobian</a>())
<a name="l02803"></a>02803 + Number of calls to the matrix-free Jacobian function (<a class="code" href="a00046.html#a8778c346e27f42f0583c63909c2ea544">PetscJacobianFunctionIMEX_Linear</a>(), <a class="code" href="a00046.html#a4edf057726501be3e8fe54e16fafe07b">PetscJacobianFunctionIMEX_JFNK</a>(), <a class="code" href="a00046.html#a68f5a93a79d56fcb964224f649af4ac9">PetscJacobianFunction_JFNK</a>(), or <a class="code" href="a00046.html#abed41de2efef801be98f8338aa2672f2">PetscJacobianFunction_Linear</a>()).
<a name="l02804"></a>02804 
<a name="l02805"></a>02805 Expected screen output:
<a name="l02806"></a>02806 \include 2D/<a class="code" href="a00021.html" title="Structure containing variables and parameters specific to the 2D Navier Stokes equations...">NavierStokes2D</a>/RisingThermalBubble_PETSc_IMEX/output.log
<a name="l02807"></a>02807 
<a name="l02808"></a>02808 
<a name="l02809"></a>02809 \<a class="code" href="a00032.html#a23a77f360d9ab0a90b11ff01314b6526">page</a> navstok2d_flatplate_petsc 2D Navier-Stokes Equations -  Laminar Flow over Flat Plate
<a name="l02810"></a>02810 
<a name="l02811"></a>02811 <a class="code" href="a00031.html#af7342acc7b7299a81e83b43ed11b9f84">Location</a>: \b hypar/<a class="code" href="a00031.html#a60f502575a2e782807ea78c05f76ae03">Examples</a>/2D/<a class="code" href="a00021.html" title="Structure containing variables and parameters specific to the 2D Navier Stokes equations...">NavierStokes2D</a>/FlatPlateLaminar_PETSc_Implicit
<a name="l02812"></a>02812           (This directory contains all the input files needed
<a name="l02813"></a>02813           to run <span class="keyword">this</span> <span class="keywordflow">case</span>. If there is a \a Run.m, run it in
<a name="l02814"></a>02814           MATLAB to quickly <span class="keyword">set</span> up, run, and visualize the 
<a name="l02815"></a>02815           example).
<a name="l02816"></a>02816 
<a name="l02817"></a>02817 Governing equations: 2D Euler Equations (navierstokes2d.h)
<a name="l02818"></a>02818 
<a name="l02819"></a>02819 Reference: 
<a name="l02820"></a>02820 + Hirsch, &quot;Numerical Computation of Internal &amp; External Flows&quot;,
<a name="l02821"></a>02821   Volume 1 (Fundamentals of Computational Fluid Dynamics), 2nd 
<a name="l02822"></a>02822   Edition, Elsevier, Section 12.3.2 (<a class="code" href="a00032.html#a23a77f360d9ab0a90b11ff01314b6526">page</a> 618-625).
<a name="l02823"></a>02823 
<a name="l02824"></a>02824 <a class="code" href="a00031.html#a948095327123305f3fdf2b293b55381e">Domain</a>: \f$-0.25 \le x \le 1\f$, \f$0 \le y \le 0.25\f$
<a name="l02825"></a>02825 
<a name="l02826"></a>02826 Boundary <a class="code" href="a00063.html#a07bca284db2938db7ad469438892ca47">conditions</a>:
<a name="l02827"></a>02827 + Symmetry BC on \f$y=0, -0.25 \le x &lt; 0\f$ (imposed through &quot;slip-wall&quot; 
<a name="l02828"></a>02828   <span class="preprocessor">#_SLIP_WALL_ with 0 wall velocity).</span>
<a name="l02829"></a>02829 <span class="preprocessor"></span>+ No-slip wall BC on \f$y=0, 0 \le x \le 1\f$ (#<a class="code" href="a00037.html#affb6a9c452f92435e738bd59b9c98935">_NOSLIP_WALL_</a> with 0
<a name="l02830"></a>02830   wall <a class="code" href="a00032.html#a19f4bd496612921d5231e400a3c27ed4">velocity</a>).
<a name="l02831"></a>02831 + Subsonic outflow on \f$y=0.25\f$ (#<a class="code" href="a00037.html#adeb38801d1b832ce3eee3ebc1eed6263">_SUBSONIC_OUTFLOW_</a>) with <a class="code" href="a00032.html#a58d87a94271c7f86a36fafc7117fe0b0">pressure</a>
<a name="l02832"></a>02832   \f$p=1/\gamma\f$.
<a name="l02833"></a>02833 + Subsonic inflow on \f$x=0\f$ (<span class="preprocessor">#_SUBSONIC_INFLOW_) with density \f$\rho=1\f$,</span>
<a name="l02834"></a>02834 <span class="preprocessor"></span>  and <a class="code" href="a00032.html#a19f4bd496612921d5231e400a3c27ed4">velocity</a> \f$(u,v) = (0.3,0)\f$.
<a name="l02835"></a>02835 + Subsonic outflow on \f$x=1\f$ (#<a class="code" href="a00037.html#adeb38801d1b832ce3eee3ebc1eed6263">_SUBSONIC_OUTFLOW_</a>) with <a class="code" href="a00032.html#a58d87a94271c7f86a36fafc7117fe0b0">pressure</a>
<a name="l02836"></a>02836   \f$p=1/\gamma\f$.
<a name="l02837"></a>02837 
<a name="l02838"></a>02838 Initial solution: Uniform flow with \f$\rho=1, u=0.3, v=0, p=1/\gamma\f$.
<a name="l02839"></a>02839 
<a name="l02840"></a>02840 Other parameters:
<a name="l02841"></a>02841   + \f$\gamma = 1.4\f$ (#<a class="code" href="a00021.html#a72f9e01745b3a8203067ab84aefc9aea">NavierStokes2D::gamma</a>)
<a name="l02842"></a>02842   + \f$Re = \frac {\rho u L } {\mu} = 100,000\f$ (Reynolds number) (#<a class="code" href="a00021.html#a3b92a4b98cedf64473b3c13dfa7674b4">NavierStokes2D::Re</a>), 
<a name="l02843"></a>02843     where \f$L=1\f$ is the plate length .
<a name="l02844"></a>02844   + \f$Pr = 0.72\f$ (Prandtl number) (#<a class="code" href="a00021.html#af0f6e03342b9eb912e25f94ce0249a2c">NavierStokes2D::Pr</a>)
<a name="l02845"></a>02845   + \f$M_\infty = 0.3\f$ (freestream Mach number) (#<a class="code" href="a00021.html#aa5f774fe7b4f69be5e085f1988ef2a6d">NavierStokes2D::Minf</a>)
<a name="l02846"></a>02846 
<a name="l02847"></a>02847 \b <a class="code" href="a00032.html#a86616b1951d3af95df5b7115dd30438f">Note</a>: Pressure is taken as \f$1/\gamma\f$ in the above <a class="code" href="a00063.html#aa012087f27f6c70b31284d8d3fb32dc5">so</a> that the freestream 
<a name="l02848"></a>02848 speed of sound is 1.
<a name="l02849"></a>02849 
<a name="l02850"></a>02850 Numerical method:
<a name="l02851"></a>02851  + Spatial <a class="code" href="a00033.html#a006f5ed6c12ae3d4f8e840cb181a05ca">discretization</a> (hyperbolic): 5th order WENO (<a class="code" href="a00041.html#af2195885ad055989a1b2b11655843343" title="5th order WENO reconstruction (component-wise) on a uniform grid">Interp1PrimFifthOrderWENO</a>())
<a name="l02852"></a>02852  + Spatial discretization (parabolic) : 4th order (<a class="code" href="a00038.html#a08c28e6bc4493172df7b7867e1f3d815">FirstDerivativeFourthOrderCentral</a>()) 
<a name="l02853"></a>02853                                         non-conservative 2-stage (<a class="code" href="a00104.html#a9f5c8ed9c587aa71c9f75209222ad67c">ParabolicFunctionNC2Stage</a>())
<a name="l02854"></a>02854  + Time integration: PETSc (<a class="code" href="a00039.html#a4dc9b9ce6ce776b7901fa2a6c9c9c1cf" title="Integrate in time with PETSc.">SolvePETSc</a>()) 
<a name="l02855"></a>02855    - Method Class: &lt;B&gt;Additive Runge-Kutta method&lt;/B&gt; (TSARKIMEX - http:<span class="comment">//www.mcs.anl.gov/petsc/petsc-current/docs/manualpages/TS/TSARKIMEX.html) -</span>
<a name="l02856"></a>02856      Although the ARK methods are semi-implicit (IMEX), here they are <a class="code" href="a00032.html#aa2f9253c1a63124e53d64db71f7e7c16">used</a> in the <span class="stringliteral">&quot;fully implicit&quot;</span> mode, i.e., the implicit 
<a name="l02857"></a>02857      method is <a class="code" href="a00032.html#aa2f9253c1a63124e53d64db71f7e7c16">used</a> to solve the complete <a class="code" href="a00033.html#ac3f62e1b06188678336543688cb7709e">equation</a> (<a class="code" href="a00032.html#a86616b1951d3af95df5b7115dd30438f">Note</a> the flag \b -ts_arkimex_fully_implicit in &lt;B&gt;.petscrc&lt;/B&gt;).
<a name="l02858"></a>02858    - Specific method: &lt;B&gt;ARK2e&lt;/B&gt; (TSARKIMEX2E - http:<span class="comment">//www.mcs.anl.gov/petsc/petsc-current/docs/manualpages/TS/TSARKIMEX2E.html)</span>
<a name="l02859"></a>02859 
<a name="l02860"></a>02860 This is a steady state problem - the solution converges to a steady laminar flow over a 
<a name="l02861"></a>02861 flat plate, and the residuals decrease with time. The skin friction coefficient is given <a class="code" href="a00032.html#a124150da8eed3d9f42e9361cc143ed7e">by</a>
<a name="l02862"></a>02862 \f{<a class="code" href="a00033.html#ac3f62e1b06188678336543688cb7709e">equation</a>}{
<a name="l02863"></a>02863   c_f = \frac {0.664} {\sqrt{Re_x}}, Re_x = \frac {\rho u x} {\mu}
<a name="l02864"></a>02864 \f}
<a name="l02865"></a>02865 (Blasius solution).
<a name="l02866"></a>02866 
<a name="l02867"></a>02867 Input files <a class="code" href="a00032.html#af7a1b4a66a5b6f9ac8eebf2c23b51e9e">required</a>:
<a name="l02868"></a>02868 ---------------------
<a name="l02869"></a>02869 
<a name="l02870"></a>02870 &lt;B&gt;.petscrc&lt;/B&gt;
<a name="l02871"></a>02871 \include 2D/<a class="code" href="a00021.html" title="Structure containing variables and parameters specific to the 2D Navier Stokes equations...">NavierStokes2D</a>/FlatPlateLaminar_PETSc_Implicit/petscrc
<a name="l02872"></a>02872 
<a name="l02873"></a>02873 \b solver.inp
<a name="l02874"></a>02874 \include 2D/<a class="code" href="a00021.html" title="Structure containing variables and parameters specific to the 2D Navier Stokes equations...">NavierStokes2D</a>/FlatPlateLaminar_PETSc_Implicit/solver.inp
<a name="l02875"></a>02875 
<a name="l02876"></a>02876 \b boundary.inp
<a name="l02877"></a>02877 \include 2D/<a class="code" href="a00021.html" title="Structure containing variables and parameters specific to the 2D Navier Stokes equations...">NavierStokes2D</a>/FlatPlateLaminar_PETSc_Implicit/boundary.inp
<a name="l02878"></a>02878 
<a name="l02879"></a>02879 \b physics.inp
<a name="l02880"></a>02880 \include 2D/<a class="code" href="a00021.html" title="Structure containing variables and parameters specific to the 2D Navier Stokes equations...">NavierStokes2D</a>/FlatPlateLaminar_PETSc_Implicit/physics.inp
<a name="l02881"></a>02881 
<a name="l02882"></a>02882 \b weno.inp (optional)
<a name="l02883"></a>02883 \include 2D/<a class="code" href="a00021.html" title="Structure containing variables and parameters specific to the 2D Navier Stokes equations...">NavierStokes2D</a>/FlatPlateLaminar_PETSc_Implicit/weno.inp
<a name="l02884"></a>02884 
<a name="l02885"></a>02885 To generate \b initial.inp (initial solution), compile 
<a name="l02886"></a>02886 and run the following code in the run directory.
<a name="l02887"></a>02887 \include 2D/<a class="code" href="a00021.html" title="Structure containing variables and parameters specific to the 2D Navier Stokes equations...">NavierStokes2D</a>/FlatPlateLaminar_PETSc_Implicit/aux/init.c
<a name="l02888"></a>02888 
<a name="l02889"></a>02889 Output:
<a name="l02890"></a>02890 -------
<a name="l02891"></a>02891 <a class="code" href="a00032.html#a86616b1951d3af95df5b7115dd30438f">Note</a> that \b iproc is <span class="keyword">set</span> to 
<a name="l02892"></a>02892 
<a name="l02893"></a>02893       2 3
<a name="l02894"></a>02894 
<a name="l02895"></a>02895 in \b solver.inp (i.e., 2 processor along \a x, and 3
<a name="l02896"></a>02896 processor along \a y). Thus, <span class="keyword">this</span> example should be run
<a name="l02897"></a>02897 with 6 MPI ranks (or change \b iproc).
<a name="l02898"></a>02898 
<a name="l02899"></a>02899 After running the code, there should be one output file
<a name="l02900"></a>02900 \b op.bin, since #<a class="code" href="a00015.html#a4e93cb107e180ef982b74cef7726b70f">HyPar::op_overwrite</a> is <span class="keyword">set</span> to \a yes in \b solver.inp.
<a name="l02901"></a>02901   
<a name="l02902"></a>02902 <span class="preprocessor">#HyPar::op_file_format is set to \a binary in \b solver.inp, and</span>
<a name="l02903"></a>02903 <span class="preprocessor"></span>thus, all the files are written out in the binary format, see 
<a name="l02904"></a>02904 <a class="code" href="a00042.html#a067f454c26d85d6cfb4d7d878b3783c9">WriteBinary</a>(). The binary file contains the conserved variables
<a name="l02905"></a>02905 \f$\left(\rho, \rho u, \rho v, e\right)\f$. The following two codes
<a name="l02906"></a>02906 are available to convert the binary output file:
<a name="l02907"></a>02907 + \b hypar/Extras/BinaryToTecplot.c - convert binary output file to 
<a name="l02908"></a>02908   Tecplot file (works only <span class="keywordflow">for</span> 2D and 3D).
<a name="l02909"></a>02909 + \b hypar/Extras/BinaryToText.c - convert binary output file to
<a name="l02910"></a>02910   an ASCII <a class="code" href="a00031.html#a314f90bacf496961ff4bfef89fea32c0">text</a> file (to visualize in, <span class="keywordflow">for</span> example, MATLAB).
<a name="l02911"></a>02911 
<a name="l02912"></a>02912 The following plot was obtained <a class="code" href="a00032.html#a124150da8eed3d9f42e9361cc143ed7e">by</a> converting the binary file to the 
<a name="l02913"></a>02913 Tecplot format, and <span class="keyword">using</span> VisIt to plot it (it shows the density 
<a name="l02914"></a>02914 and <a class="code" href="a00032.html#a19f4bd496612921d5231e400a3c27ed4">velocity</a>):
<a name="l02915"></a>02915 @image html Solution_2DNavStokFlatPlate.png
<a name="l02916"></a>02916 The following plot shows a magnified view of the boundary layer:
<a name="l02917"></a>02917 @image html Solution_2DNavStokFlatPlateMagnified.png
<a name="l02918"></a>02918 
<a name="l02919"></a>02919 The following file computes the skin friction as a function of the 
<a name="l02920"></a>02920 Reynolds number and writes to to a <a class="code" href="a00031.html#a314f90bacf496961ff4bfef89fea32c0">text</a> file \b SkinFriction.<a class="code" href="a00031.html#a96b9dfbebc4ecd57a32426075fb0c3f2">dat</a> with 4 
<a name="l02921"></a>02921 columns: Reynolds number, computed skin friction coefficient, exact skin 
<a name="l02922"></a>02922 friction coefficient (\f$0.664/\sqrt{Re_x}\f$), and normal <a class="code" href="a00032.html#a19f4bd496612921d5231e400a3c27ed4">velocity</a> gradient 
<a name="l02923"></a>02923 on the plate surface (\f$\left.\partial u/\partial y\right|_{y=0}\f$). 
<a name="l02924"></a>02924 Compile and run it in the run directory.
<a name="l02925"></a>02925 \include 2D/<a class="code" href="a00021.html" title="Structure containing variables and parameters specific to the 2D Navier Stokes equations...">NavierStokes2D</a>/FlatPlateLaminar_PETSc_Implicit/aux/SkinFriction.c
<a name="l02926"></a>02926 The following figure showing the exact and computed skin friction coefficients
<a name="l02927"></a>02927 was obtained <a class="code" href="a00032.html#a124150da8eed3d9f42e9361cc143ed7e">by</a> plotting \b SkinFriction.dat:
<a name="l02928"></a>02928 @image html Solution_2DNavStokFlatPlateSkinFrictionPETSc.png
<a name="l02929"></a>02929 
<a name="l02930"></a>02930 The file &lt;B&gt;function_counts.dat&lt;/B&gt; reports the computational expense
<a name="l02931"></a>02931 (in terms of the number of function counts):
<a name="l02932"></a>02932 \include 2D/<a class="code" href="a00021.html" title="Structure containing variables and parameters specific to the 2D Navier Stokes equations...">NavierStokes2D</a>/FlatPlateLaminar_PETSc_Implicit/function_counts.dat
<a name="l02933"></a>02933 The numbers are, respectively,
<a name="l02934"></a>02934 + Time iterations
<a name="l02935"></a>02935 + Number of times the hyperbolic term was evaluated
<a name="l02936"></a>02936 + Number of times the parabolic term was evaluated
<a name="l02937"></a>02937 + Number of times the source term was evaluated
<a name="l02938"></a>02938 + Number of calls to the <span class="keyword">explicit</span> right-hand-side function (<a class="code" href="a00046.html#ac7d9b0a219eb22bfd37482b741bd79c9">PetscRHSFunctionIMEX</a>() or <a class="code" href="a00046.html#ac67533553372ed2b44b32d095c775f5c">PetscRHSFunctionExpl</a>())
<a name="l02939"></a>02939 + Number of calls to the implicit right-hand-side function (<a class="code" href="a00046.html#a9d093c3140369a1178dd5b9589a926b1">PetscIFunctionIMEX</a>() or <a class="code" href="a00046.html#a91eb21ee4374b79a74f413d926344d7e">PetscRHSFunctionImpl</a>())
<a name="l02940"></a>02940 + Number of calls to the Jacobian (<a class="code" href="a00046.html#a82aacb94c1481144ce3e43d40d1f04d4">PetscIJacobianIMEX</a>() or <a class="code" href="a00046.html#a3d6a695a879ec54937525109ac912355">PetscIJacobian</a>())
<a name="l02941"></a>02941 + Number of calls to the matrix-free Jacobian function (<a class="code" href="a00046.html#a8778c346e27f42f0583c63909c2ea544">PetscJacobianFunctionIMEX_Linear</a>(), <a class="code" href="a00046.html#a4edf057726501be3e8fe54e16fafe07b">PetscJacobianFunctionIMEX_JFNK</a>(), <a class="code" href="a00046.html#a68f5a93a79d56fcb964224f649af4ac9">PetscJacobianFunction_JFNK</a>(), or <a class="code" href="a00046.html#abed41de2efef801be98f8338aa2672f2">PetscJacobianFunction_Linear</a>()).
<a name="l02942"></a>02942 
<a name="l02943"></a>02943 Expected screen output:
<a name="l02944"></a>02944 \include 2D/<a class="code" href="a00021.html" title="Structure containing variables and parameters specific to the 2D Navier Stokes equations...">NavierStokes2D</a>/FlatPlateLaminar_PETSc_Implicit/output.log
<a name="l02945"></a>02945 
<a name="l02946"></a>02946 \<a class="code" href="a00032.html#a23a77f360d9ab0a90b11ff01314b6526">page</a> ns2d_ldsc_petsc_imex 2D Navier-Stokes Equations -  Lid-Driven Square Cavity
<a name="l02947"></a>02947 
<a name="l02948"></a>02948 <a class="code" href="a00031.html#af7342acc7b7299a81e83b43ed11b9f84">Location</a>: \b hypar/<a class="code" href="a00031.html#a60f502575a2e782807ea78c05f76ae03">Examples</a>/2D/<a class="code" href="a00021.html" title="Structure containing variables and parameters specific to the 2D Navier Stokes equations...">NavierStokes2D</a>/LidDrivenCavity_PETSc_IMEX
<a name="l02949"></a>02949           (This directory contains all the input files needed
<a name="l02950"></a>02950           to run <span class="keyword">this</span> <span class="keywordflow">case</span>. If there is a \a Run.m, run it in
<a name="l02951"></a>02951           MATLAB to quickly <span class="keyword">set</span> up, run, and visualize the 
<a name="l02952"></a>02952           example).
<a name="l02953"></a>02953 
<a name="l02954"></a>02954 Governing equations: 2D Navier-Stokes Equations (navierstokes2d.h)
<a name="l02955"></a>02955 
<a name="l02956"></a>02956 Reference: 
<a name="l02957"></a>02957 + Erturk, E., Corke, T.C., and Gokcol, C., &quot;Numerical Solutions of
<a name="l02958"></a>02958   2-D Steady Incompressible Driven Cavity Flow at High Reynolds Numbers&quot;,
<a name="l02959"></a>02959   International Journal for Numerical Methods in Fluids, 48, 2005,
<a name="l02960"></a>02960   http:<span class="comment">//dx.doi.org/10.1002/fld.953.</span>
<a name="l02961"></a>02961 + Ghia, U., Ghia, K.N., Shin, C.T., &quot;High-Re Solutions for Incompressible
<a name="l02962"></a>02962   Flow using the Navier-Stokes Equations and a Multigrid Method&quot;, Journal
<a name="l02963"></a>02963   of Computational Physics, 48, 1982, http:<span class="comment">//dx.doi.org/10.1016/0021-9991(82)90058-4.</span>
<a name="l02964"></a>02964 
<a name="l02965"></a>02965 <a class="code" href="a00032.html#a86616b1951d3af95df5b7115dd30438f">Note</a> that this is an incompressible problem being solved here using the compressible
<a name="l02966"></a>02966 Navier-Stokes equations in terms of non-dimensional flow variables. The density and 
<a name="l02967"></a>02967 <a class="code" href="a00032.html#a58d87a94271c7f86a36fafc7117fe0b0">pressure</a> are taken such that the speed of sound is 1.0, and the flow velocities 
<a name="l02968"></a>02968 <a class="code" href="a00032.html#aa18752ebe19b49b626048c92d4586801">specified</a> in the initial and boundary <a class="code" href="a00063.html#a07bca284db2938db7ad469438892ca47">conditions</a> correspond to a characteristic 
<a name="l02969"></a>02969 Mach number of 0.1 (thus, they are 0.1 times the values in the above reference).
<a name="l02970"></a>02970 
<a name="l02971"></a>02971 The problem is solved here using &lt;B&gt;implicit-explicit (IMEX)&lt;/B&gt; time
<a name="l02972"></a>02972 integration, where the hyperbolic <a class="code" href="a00064.html#ae94fb13b2c09c2f8b5cdbb2fbe99cad7">flux</a> is partitioned into its entropy
<a name="l02973"></a>02973 and acoustic components with the former integrated explicitly and the
<a name="l02974"></a>02974 latter integrated implicitly. See:
<a name="l02975"></a>02975 + Ghosh, D., Constantinescu, E. M., &quot;Semi-Implicit Time Integration of 
<a name="l02976"></a>02976   Atmospheric Flows with Characteristic-Based Flux Partitioning&quot;, SIAM 
<a name="l02977"></a>02977   Journal on Scientific Computing, 38 (3), 2016, A1848-A1875, 
<a name="l02978"></a>02978   http:<span class="comment">//dx.doi.org/10.1137/15M1044369.</span>
<a name="l02979"></a>02979 
<a name="l02980"></a>02980 <a class="code" href="a00031.html#a948095327123305f3fdf2b293b55381e">Domain</a>: \f$0 \le x, y \le 1\f$
<a name="l02981"></a>02981 
<a name="l02982"></a>02982 Boundary <a class="code" href="a00063.html#a07bca284db2938db7ad469438892ca47">conditions</a>:
<a name="l02983"></a>02983 + No-slip wall BC on \f$x=0,1, 0 \le y \le 1\f$ (<span class="preprocessor">#_NOSLIP_WALL_ with 0 wall velocity).</span>
<a name="l02984"></a>02984 <span class="preprocessor"></span>+ No-slip wall BC on \f$y=0, 0 \le x \le 1\f$ (#<a class="code" href="a00037.html#affb6a9c452f92435e738bd59b9c98935">_NOSLIP_WALL_</a> with 0 wall <a class="code" href="a00032.html#a19f4bd496612921d5231e400a3c27ed4">velocity</a>).
<a name="l02985"></a>02985 + Moving no-slip wall BC on \f$y=1, 0 \le x \le 1\f$ (#<a class="code" href="a00037.html#affb6a9c452f92435e738bd59b9c98935">_NOSLIP_WALL_</a> with <a class="code" href="a00032.html#aa18752ebe19b49b626048c92d4586801">specified</a> 
<a name="l02986"></a>02986   wall <a class="code" href="a00032.html#a19f4bd496612921d5231e400a3c27ed4">velocity</a> of 0.1 in the x-direction).
<a name="l02987"></a>02987 
<a name="l02988"></a>02988 Initial solution: \f$\rho=1, p=1/\gamma\f$. The velocities are <a class="code" href="a00032.html#aa18752ebe19b49b626048c92d4586801">specified</a> according to 
<a name="l02989"></a>02989 the references above, but scaled <a class="code" href="a00032.html#a124150da8eed3d9f42e9361cc143ed7e">by</a> a factor of 0.1 to ensure that the characteristic
<a name="l02990"></a>02990 Mach number is 0.1.
<a name="l02991"></a>02991 
<a name="l02992"></a>02992 Other parameters:
<a name="l02993"></a>02993   + \f$\gamma = 1.4\f$ (#<a class="code" href="a00021.html#a72f9e01745b3a8203067ab84aefc9aea">NavierStokes2D::gamma</a>)
<a name="l02994"></a>02994   + \f$Re = \frac {\rho u L } {\mu} = 3200\f$ (Reynolds number) (#<a class="code" href="a00021.html#a3b92a4b98cedf64473b3c13dfa7674b4">NavierStokes2D::Re</a>), 
<a name="l02995"></a>02995     where \f$L=1\f$ is the cavity length and width.
<a name="l02996"></a>02996   + \f$Pr = 0.72\f$ (Prandtl number) (#<a class="code" href="a00021.html#af0f6e03342b9eb912e25f94ce0249a2c">NavierStokes2D::Pr</a>)
<a name="l02997"></a>02997   + \f$M_\infty = 0.1\f$ (characteristic Mach number) (#<a class="code" href="a00021.html#aa5f774fe7b4f69be5e085f1988ef2a6d">NavierStokes2D::Minf</a>)
<a name="l02998"></a>02998 
<a name="l02999"></a>02999 \b <a class="code" href="a00032.html#a86616b1951d3af95df5b7115dd30438f">Note</a>: Pressure is taken as \f$1/\gamma\f$ in the above <a class="code" href="a00063.html#aa012087f27f6c70b31284d8d3fb32dc5">so</a> that the freestream 
<a name="l03000"></a>03000 speed of sound is 1.
<a name="l03001"></a>03001 
<a name="l03002"></a>03002 Numerical method:
<a name="l03003"></a>03003  + Spatial <a class="code" href="a00033.html#a006f5ed6c12ae3d4f8e840cb181a05ca">discretization</a> (hyperbolic): 5th order upwind (<a class="code" href="a00041.html#aea7c973ffe0c37bca0703c1bf6175aaa" title="5th order upwind reconstruction (component-wise) on a uniform grid">Interp1PrimFifthOrderUpwind</a>())
<a name="l03004"></a>03004  + Spatial discretization (parabolic) : 4th order (<a class="code" href="a00038.html#a08c28e6bc4493172df7b7867e1f3d815">FirstDerivativeFourthOrderCentral</a>()) 
<a name="l03005"></a>03005                                         non-conservative 2-stage (<a class="code" href="a00104.html#a9f5c8ed9c587aa71c9f75209222ad67c">ParabolicFunctionNC2Stage</a>())
<a name="l03006"></a>03006  + Time integration: PETSc (<a class="code" href="a00039.html#a4dc9b9ce6ce776b7901fa2a6c9c9c1cf" title="Integrate in time with PETSc.">SolvePETSc</a>()) 
<a name="l03007"></a>03007    - Method Class: &lt;B&gt;Additive Runge-Kutta method&lt;/B&gt; (TSARKIMEX - http:<span class="comment">//www.mcs.anl.gov/petsc/petsc-current/docs/manualpages/TS/TSARKIMEX.html)</span>
<a name="l03008"></a>03008    - Specific method: &lt;B&gt;Kennedy-Carpenter ARK4&lt;/B&gt; (TSARKIMEX4 - http:<span class="comment">//www.mcs.anl.gov/petsc/petsc-current/docs/manualpages/TS/TSARKIMEX4.html)</span>
<a name="l03009"></a>03009 
<a name="l03010"></a>03010 Input files <a class="code" href="a00032.html#af7a1b4a66a5b6f9ac8eebf2c23b51e9e">required</a>:
<a name="l03011"></a>03011 ---------------------
<a name="l03012"></a>03012 
<a name="l03013"></a>03013 &lt;B&gt;.petscrc&lt;/B&gt;
<a name="l03014"></a>03014 \include 2D/<a class="code" href="a00021.html" title="Structure containing variables and parameters specific to the 2D Navier Stokes equations...">NavierStokes2D</a>/LidDrivenCavity_PETSc_IMEX/petscrc
<a name="l03015"></a>03015 
<a name="l03016"></a>03016 \b solver.inp
<a name="l03017"></a>03017 \include 2D/<a class="code" href="a00021.html" title="Structure containing variables and parameters specific to the 2D Navier Stokes equations...">NavierStokes2D</a>/LidDrivenCavity_PETSc_IMEX/solver.inp
<a name="l03018"></a>03018 
<a name="l03019"></a>03019 \b boundary.inp
<a name="l03020"></a>03020 \include 2D/<a class="code" href="a00021.html" title="Structure containing variables and parameters specific to the 2D Navier Stokes equations...">NavierStokes2D</a>/LidDrivenCavity_PETSc_IMEX/boundary.inp
<a name="l03021"></a>03021 
<a name="l03022"></a>03022 \b physics.inp (\b <a class="code" href="a00032.html#a86616b1951d3af95df5b7115dd30438f">Note</a>: this file specifies \f$Re = 3200\f$,
<a name="l03023"></a>03023 change \a Re here for other Reynolds numbers.)
<a name="l03024"></a>03024 \include 2D/<a class="code" href="a00021.html" title="Structure containing variables and parameters specific to the 2D Navier Stokes equations...">NavierStokes2D</a>/LidDrivenCavity_PETSc_IMEX/physics.inp
<a name="l03025"></a>03025 
<a name="l03026"></a>03026 To generate \b initial.inp (initial solution), compile 
<a name="l03027"></a>03027 and run the following code in the run directory.
<a name="l03028"></a>03028 \include 2D/<a class="code" href="a00021.html" title="Structure containing variables and parameters specific to the 2D Navier Stokes equations...">NavierStokes2D</a>/LidDrivenCavity_PETSc_IMEX/aux/init.c
<a name="l03029"></a>03029 
<a name="l03030"></a>03030 Output:
<a name="l03031"></a>03031 -------
<a name="l03032"></a>03032 <a class="code" href="a00032.html#a86616b1951d3af95df5b7115dd30438f">Note</a> that \b iproc is set to 
<a name="l03033"></a>03033 
<a name="l03034"></a>03034       2 2
<a name="l03035"></a>03035 
<a name="l03036"></a>03036 in \b solver.inp (i.e., 2 processors along \a x, and 2
<a name="l03037"></a>03037 processor along \a y). Thus, this example should be run
<a name="l03038"></a>03038 with 4 MPI ranks (or change \b iproc).
<a name="l03039"></a>03039 
<a name="l03040"></a>03040 After running the code, there should be one output file
<a name="l03041"></a>03041 \b op.<a class="code" href="a00031.html#a96b9dfbebc4ecd57a32426075fb0c3f2">dat</a>, since #<a class="code" href="a00015.html" title="Structure containing all solver-specific variables and functions.">HyPar</a>::op_overwrite is set to \a yes in \b solver.inp.
<a name="l03042"></a>03042 Since #<a class="code" href="a00015.html" title="Structure containing all solver-specific variables and functions.">HyPar</a>::op_file_format is set to \a tecplot2d in \b solver.inp,
<a name="l03043"></a>03043 this file is in the ASCII Tecplot format and can be viewed in any
<a name="l03044"></a>03044 software that supports this format (e.g. VisIt).
<a name="l03045"></a>03045 
<a name="l03046"></a>03046 The following plot shows the streamlines (colored <a class="code" href="a00032.html#a124150da8eed3d9f42e9361cc143ed7e">by</a> the <a class="code" href="a00032.html#a19f4bd496612921d5231e400a3c27ed4">velocity</a> magnitude):
<a name="l03047"></a>03047 @image html Solution_2DNavStokLDSC_Re3200_PETSc_IMEX.png
<a name="l03048"></a>03048 
<a name="l03049"></a>03049 The file &lt;B&gt;function_counts.<a class="code" href="a00031.html#a96b9dfbebc4ecd57a32426075fb0c3f2">dat</a>&lt;/B&gt; reports the computational expense
<a name="l03050"></a>03050 (in terms of the number of function counts):
<a name="l03051"></a>03051 \include 2D/<a class="code" href="a00021.html" title="Structure containing variables and parameters specific to the 2D Navier Stokes equations...">NavierStokes2D</a>/LidDrivenCavity_PETSc_IMEX/function_counts.<a class="code" href="a00031.html#a96b9dfbebc4ecd57a32426075fb0c3f2">dat</a>
<a name="l03052"></a>03052 The numbers are, respectively,
<a name="l03053"></a>03053 + Time iterations
<a name="l03054"></a>03054 + Number of times the hyperbolic term was evaluated
<a name="l03055"></a>03055 + Number of times the parabolic term was evaluated
<a name="l03056"></a>03056 + Number of times the source term was evaluated
<a name="l03057"></a>03057 + Number of calls to the explicit right-hand-side function (<a class="code" href="a00046.html#ac7d9b0a219eb22bfd37482b741bd79c9">PetscRHSFunctionIMEX</a>() or <a class="code" href="a00046.html#ac67533553372ed2b44b32d095c775f5c">PetscRHSFunctionExpl</a>())
<a name="l03058"></a>03058 + Number of calls to the implicit right-hand-side function (<a class="code" href="a00046.html#a9d093c3140369a1178dd5b9589a926b1">PetscIFunctionIMEX</a>() or <a class="code" href="a00046.html#a91eb21ee4374b79a74f413d926344d7e">PetscRHSFunctionImpl</a>())
<a name="l03059"></a>03059 + Number of calls to the Jacobian (<a class="code" href="a00046.html#a82aacb94c1481144ce3e43d40d1f04d4">PetscIJacobianIMEX</a>() or <a class="code" href="a00046.html#a3d6a695a879ec54937525109ac912355">PetscIJacobian</a>())
<a name="l03060"></a>03060 + Number of calls to the matrix-free Jacobian function (<a class="code" href="a00046.html#a8778c346e27f42f0583c63909c2ea544">PetscJacobianFunctionIMEX_Linear</a>(), <a class="code" href="a00046.html#a4edf057726501be3e8fe54e16fafe07b">PetscJacobianFunctionIMEX_JFNK</a>(), <a class="code" href="a00046.html#a68f5a93a79d56fcb964224f649af4ac9">PetscJacobianFunction_JFNK</a>(), or <a class="code" href="a00046.html#abed41de2efef801be98f8338aa2672f2">PetscJacobianFunction_Linear</a>()).
<a name="l03061"></a>03061 
<a name="l03062"></a>03062 Expected screen output (for Reynolds number 3200):
<a name="l03063"></a>03063 \include 2D/<a class="code" href="a00021.html" title="Structure containing variables and parameters specific to the 2D Navier Stokes equations...">NavierStokes2D</a>/LidDrivenCavity_PETSc_IMEX/output.log
<a name="l03064"></a>03064 
<a name="l03065"></a>03065 
<a name="l03066"></a>03066 
<a name="l03067"></a>03067 
<a name="l03068"></a>03068 \<a class="code" href="a00032.html#a23a77f360d9ab0a90b11ff01314b6526">page</a> ns3d_bubble_petsc 3D Navier-Stokes Equations - Rising Thermal Bubble
<a name="l03069"></a>03069 
<a name="l03070"></a>03070 <a class="code" href="a00031.html#af7342acc7b7299a81e83b43ed11b9f84">Location</a>: \b hypar/<a class="code" href="a00031.html#a60f502575a2e782807ea78c05f76ae03">Examples</a>/3D/<a class="code" href="a00022.html" title="Structure containing variables and parameters specific to the 3D Navier Stokes equations...">NavierStokes3D</a>/RisingThermalBubble_Config1_PETSc_IMEX
<a name="l03071"></a>03071           (This directory contains all the input files needed
<a name="l03072"></a>03072           to run this case. If there is a \a Run.m, run it in
<a name="l03073"></a>03073           MATLAB to quickly set up, run, and visualize the 
<a name="l03074"></a>03074           example).
<a name="l03075"></a>03075 
<a name="l03076"></a>03076 Governing equations: 3D Navier-Stokes Equations (navierstokes3d.h)
<a name="l03077"></a>03077 
<a name="l03078"></a>03078 <a class="code" href="a00031.html#a948095327123305f3fdf2b293b55381e">Domain</a>: \f$0 \le x,y,z &lt; 1000\,{\rm m}\f$, \a <span class="stringliteral">&quot;slip-wall&quot;</span> (#<a class="code" href="a00037.html#af3a9f3ba15bc914ed0a88295aee147e8">_SLIP_WALL_</a>) boundaries 
<a name="l03079"></a>03079         everywhere, with zero wall <a class="code" href="a00032.html#a19f4bd496612921d5231e400a3c27ed4">velocity</a>.
<a name="l03080"></a>03080 
<a name="l03081"></a>03081 Reference:
<a name="l03082"></a>03082   + Kelly, J. F., Giraldo, F. X., <span class="stringliteral">&quot;Continuous and discontinuous Galerkin methods for a scalable</span>
<a name="l03083"></a>03083 <span class="stringliteral">  three-dimensional nonhydrostatic atmospheric model: Limited-area mode&quot;</span>, J. Comput. Phys., 231,
<a name="l03084"></a>03084   2012, pp. 7988-8008 (see section 5.1.2).
<a name="l03085"></a>03085   + Giraldo, F. X., Kelly, J. F., Constantinescu, E. M., <span class="stringliteral">&quot;Implicit-Explicit Formulations of a</span>
<a name="l03086"></a>03086 <span class="stringliteral">  Three-Dimensional Nonhydrostatic Unified Model of the Atmosphere (NUMA)&quot;</span>, SIAM J. Sci. Comput., 
<a name="l03087"></a>03087   35 (5), 2013, pp. B1162-B1194 (see section 4.1).
<a name="l03088"></a>03088 
<a name="l03089"></a>03089 The problem is solved here using &lt;B&gt;implicit-<span class="keyword">explicit</span> (IMEX)&lt;/B&gt; time
<a name="l03090"></a>03090 integration, where the hyperbolic <a class="code" href="a00064.html#ae94fb13b2c09c2f8b5cdbb2fbe99cad7">flux</a> is partitioned into its entropy
<a name="l03091"></a>03091 and acoustic components with the former integrated explicitly and the
<a name="l03092"></a>03092 latter integrated implicitly. See the following reference:
<a name="l03093"></a>03093 + Ghosh, D., Constantinescu, E. M., <span class="stringliteral">&quot;Semi-Implicit Time Integration of </span>
<a name="l03094"></a>03094 <span class="stringliteral">  Atmospheric Flows with Characteristic-Based Flux Partitioning&quot;</span>, SIAM 
<a name="l03095"></a>03095   Journal on Scientific Computing, 38 (3), 2016, A1848-A1875, 
<a name="l03096"></a>03096   http:<span class="comment">//dx.doi.org/10.1137/15M1044369.</span>
<a name="l03097"></a>03097 
<a name="l03098"></a>03098 Initial solution: A warm bubble in cool ambient atmosphere. <a class="code" href="a00032.html#a86616b1951d3af95df5b7115dd30438f">Note</a> that in <span class="keyword">this</span> example, the
<a name="l03099"></a>03099 gravitational forces and rising of the bubble is along the \a y-axis.
<a name="l03100"></a>03100 
<a name="l03101"></a>03101 Other parameters (all dimensional quantities are in SI units):
<a name="l03102"></a>03102   + Specific heat ratio \f$\gamma = 1.4\f$ (#<a class="code" href="a00022.html" title="Structure containing variables and parameters specific to the 3D Navier Stokes equations...">NavierStokes3D</a>::gamma)
<a name="l03103"></a>03103   + Universal gas constant \f$R = 287.058\f$ (#<a class="code" href="a00022.html" title="Structure containing variables and parameters specific to the 3D Navier Stokes equations...">NavierStokes3D</a>::R)
<a name="l03104"></a>03104   + Gravitational force per unit mass \f$g = 9.8\f$ along \a y-axis (#<a class="code" href="a00022.html" title="Structure containing variables and parameters specific to the 3D Navier Stokes equations...">NavierStokes3D</a>::grav_y)
<a name="l03105"></a>03105   + Reference density (at zero altitude) \f$\rho_{ref} = 1.1612055171196529\f$ (#<a class="code" href="a00022.html#a1e6f66261d19a1c1c272e8808bd2657b">NavierStokes3D::rho0</a>)
<a name="l03106"></a>03106   + Reference <a class="code" href="a00032.html#a58d87a94271c7f86a36fafc7117fe0b0">pressure</a> (at zero altitude) \f$P_{ref} = 100000\f$ (#<a class="code" href="a00022.html#a8be9de5ac626cddcd15c5ec181619694">NavierStokes3D::p0</a>)
<a name="l03107"></a>03107   + Hydrostatic balance type 2 (#<a class="code" href="a00022.html#a2e01ef077b0fedaea9e286ccdf2fe259">NavierStokes3D::HB</a>)
<a name="l03108"></a>03108 
<a name="l03109"></a>03109 Numerical Method:
<a name="l03110"></a>03110  + Spatial discretization (hyperbolic): 5th order WENO (<a class="code" href="a00041.html#af2195885ad055989a1b2b11655843343" title="5th order WENO reconstruction (component-wise) on a uniform grid">Interp1PrimFifthOrderWENO</a>())
<a name="l03111"></a>03111  + Time integration: PETSc (<a class="code" href="a00039.html#a4dc9b9ce6ce776b7901fa2a6c9c9c1cf" title="Integrate in time with PETSc.">SolvePETSc</a>()) 
<a name="l03112"></a>03112    - Method Class: &lt;B&gt;Additive Runge-Kutta method&lt;/B&gt; (TSARKIMEX - http:<span class="comment">//www.mcs.anl.gov/petsc/petsc-current/docs/manualpages/TS/TSARKIMEX.html)</span>
<a name="l03113"></a>03113    - Specific method: &lt;B&gt;ARK 2e&lt;/B&gt; (TSARKIMEX2E - http:<span class="comment">//www.mcs.anl.gov/petsc/petsc-current/docs/manualpages/TS/TSARKIMEX2E.html)</span>
<a name="l03114"></a>03114 
<a name="l03115"></a>03115 Input files <a class="code" href="a00032.html#af7a1b4a66a5b6f9ac8eebf2c23b51e9e">required</a>:
<a name="l03116"></a>03116 ---------------------
<a name="l03117"></a>03117 
<a name="l03118"></a>03118 &lt;B&gt;.petscrc&lt;/B&gt;
<a name="l03119"></a>03119 \include 3D/<a class="code" href="a00022.html" title="Structure containing variables and parameters specific to the 3D Navier Stokes equations...">NavierStokes3D</a>/RisingThermalBubble_Config1_PETSc_IMEX/petscrc
<a name="l03120"></a>03120 
<a name="l03121"></a>03121 \b solver.inp
<a name="l03122"></a>03122 \include 3D/<a class="code" href="a00022.html" title="Structure containing variables and parameters specific to the 3D Navier Stokes equations...">NavierStokes3D</a>/RisingThermalBubble_Config1_PETSc_IMEX/solver.inp
<a name="l03123"></a>03123 
<a name="l03124"></a>03124 \b boundary.inp
<a name="l03125"></a>03125 \include 3D/<a class="code" href="a00022.html" title="Structure containing variables and parameters specific to the 3D Navier Stokes equations...">NavierStokes3D</a>/RisingThermalBubble_Config1_PETSc_IMEX/boundary.inp
<a name="l03126"></a>03126 
<a name="l03127"></a>03127 \b physics.inp
<a name="l03128"></a>03128 \include 3D/<a class="code" href="a00022.html" title="Structure containing variables and parameters specific to the 3D Navier Stokes equations...">NavierStokes3D</a>/RisingThermalBubble_Config1_PETSc_IMEX/physics.inp
<a name="l03129"></a>03129 
<a name="l03130"></a>03130 \b weno.inp (optional)
<a name="l03131"></a>03131 \include 3D/<a class="code" href="a00022.html" title="Structure containing variables and parameters specific to the 3D Navier Stokes equations...">NavierStokes3D</a>/RisingThermalBubble_Config1_PETSc_IMEX/weno.inp
<a name="l03132"></a>03132 
<a name="l03133"></a>03133 To generate \b initial.inp (initial solution), compile 
<a name="l03134"></a>03134 and run the following code in the run directory.
<a name="l03135"></a>03135 \include 3D/<a class="code" href="a00022.html" title="Structure containing variables and parameters specific to the 3D Navier Stokes equations...">NavierStokes3D</a>/RisingThermalBubble_Config1_PETSc_IMEX/aux/init.c
<a name="l03136"></a>03136 
<a name="l03137"></a>03137 Output:
<a name="l03138"></a>03138 -------
<a name="l03139"></a>03139 <a class="code" href="a00032.html#a86616b1951d3af95df5b7115dd30438f">Note</a> that \b iproc is set to 
<a name="l03140"></a>03140 
<a name="l03141"></a>03141       4 4 4
<a name="l03142"></a>03142 
<a name="l03143"></a>03143 in \b solver.inp (i.e., 4 processors along \a x, 4
<a name="l03144"></a>03144 processors along \a y, and 4 processor along \a z). Thus, 
<a name="l03145"></a>03145 this example should be run with 64 MPI ranks (or change \b iproc).
<a name="l03146"></a>03146 
<a name="l03147"></a>03147 After running the code, there should be 11 output
<a name="l03148"></a>03148 files \b op_00000.bin, \b op_00001.bin, ... \b op_00010.bin; 
<a name="l03149"></a>03149 the first one is the solution at \f$t=0\f$ and the final one
<a name="l03150"></a>03150 is the solution at \f$t=200\,{\rm s}\f$. Since #<a class="code" href="a00015.html#a4e93cb107e180ef982b74cef7726b70f">HyPar::op_overwrite</a> is
<a name="l03151"></a>03151 <span class="keyword">set</span> to \a no in \b solver.inp, separate files are written
<a name="l03152"></a>03152 <span class="keywordflow">for</span> solutions at each output time. All the files are binary
<a name="l03153"></a>03153 (#<a class="code" href="a00015.html#a51a3b8c19b86e9e1df5be02b05a6613c">HyPar::op_file_format</a> is <span class="keyword">set</span> to \a binary in \b solver.inp).
<a name="l03154"></a>03154 
<a name="l03155"></a>03155 The following code (&lt;B&gt;<a class="code" href="a00031.html#a60f502575a2e782807ea78c05f76ae03">Examples</a>/3D/<a class="code" href="a00022.html" title="Structure containing variables and parameters specific to the 3D Navier Stokes equations...">NavierStokes3D</a>/RisingThermalBubble_Config1_PETSc_IMEX/aux/PostProcess.c&lt;/B&gt;)
<a name="l03156"></a>03156 can be <a class="code" href="a00032.html#aa2f9253c1a63124e53d64db71f7e7c16">used</a> to convert the binary solution file (with conserved variables 
<a name="l03157"></a>03157 \f$\rho,\rho u,\rho v,\rho w,e\f$) to Tecplot or plain <a class="code" href="a00031.html#a314f90bacf496961ff4bfef89fea32c0">text</a> files with the primitive
<a name="l03158"></a>03158 and reference variables \f$\rho,u,v,w,P,\theta,\rho_0,P_0,\pi,\theta_0\f$ where the
<a name="l03159"></a>03159 subscript \f$0\f$ indicates the hydrostatic mean <a class="code" href="a00032.html#aadd5786eddf29a076126f4201bb7c244">value</a>.
<a name="l03160"></a>03160 \include 3D/<a class="code" href="a00022.html" title="Structure containing variables and parameters specific to the 3D Navier Stokes equations...">NavierStokes3D</a>/RisingThermalBubble_Config1_PETSc_IMEX/aux/PostProcess.c
<a name="l03161"></a>03161 
<a name="l03162"></a>03162 The following figure shows the potential temperature iso-surface for the initial
<a name="l03163"></a>03163 and final solutions (plotted in VisIt):
<a name="l03164"></a>03164 @image html Solution_3DNavStok_Bubble3D_PETSc.png
<a name="l03165"></a>03165 
<a name="l03166"></a>03166 The file \b Extras/ExtractSlice.c can be <a class="code" href="a00032.html#aa2f9253c1a63124e53d64db71f7e7c16">used</a> to extract a slice perpendicular to any dimension
<a name="l03167"></a>03167 at a <a class="code" href="a00032.html#aa18752ebe19b49b626048c92d4586801">specified</a> location along that dimension. The extract slice is written out in the same
<a name="l03168"></a>03168 binary format as the original solutions files (with the same names op_xxxxx.bin) in a 
<a name="l03169"></a>03169 subdirectory called \b slices (\b <a class="code" href="a00032.html#a86616b1951d3af95df5b7115dd30438f">Note</a>: make the subdirectory called \a slices before running
<a name="l03170"></a>03170 this code). The following code (&lt;B&gt;<a class="code" href="a00031.html#a60f502575a2e782807ea78c05f76ae03">Examples</a>/3D/<a class="code" href="a00022.html" title="Structure containing variables and parameters specific to the 3D Navier Stokes equations...">NavierStokes3D</a>/RisingThermalBubble_Config1_PETSc_IMEX/aux/PostProcessSlice.c&lt;/B&gt;)
<a name="l03171"></a>03171 can then be <a class="code" href="a00032.html#aa2f9253c1a63124e53d64db71f7e7c16">used</a> (in the \b slices subdirectory) to convert the binary slice solution file (with conserved variables 
<a name="l03172"></a>03172 \f$\rho,\rho u,\rho v,\rho w,e\f$) to Tecplot or plain <a class="code" href="a00031.html#a314f90bacf496961ff4bfef89fea32c0">text</a> files with the primitive
<a name="l03173"></a>03173 and reference variables \f$\rho,u,v,w,P,\theta,\rho_0,P_0,\pi,\theta_0\f$.
<a name="l03174"></a>03174 \b <a class="code" href="a00032.html#a86616b1951d3af95df5b7115dd30438f">Note</a> that it needs the relevant \b solver.inp and \b physics.inp that can be created
<a name="l03175"></a>03175 as follows:
<a name="l03176"></a>03176 + Copy the original solver.inp and physics.inp to the slices subdirectory.
<a name="l03177"></a>03177 + In solver.inp, set \b ndims as \b 2, and remove the component of \b size and \b iproc 
<a name="l03178"></a>03178   corresponding to the dimension being eliminated while extracting the slices (in this case,
<a name="l03179"></a>03179   it is \a z or the 3rd component).
<a name="l03180"></a>03180 + In physics.inp, remove the component of \b gravity corresponding to the dimension perpendicular
<a name="l03181"></a>03181   to the slice.
<a name="l03182"></a>03182 
<a name="l03183"></a>03183 \include 3D/<a class="code" href="a00022.html" title="Structure containing variables and parameters specific to the 3D Navier Stokes equations...">NavierStokes3D</a>/RisingThermalBubble_Config1_PETSc_IMEX/aux/PostProcessSlice.c
<a name="l03184"></a>03184 
<a name="l03185"></a>03185 The following figure shows the potential temperature \f$\theta\f$ along a slice at \f$z=500\,{\rm m}\f$ 
<a name="l03186"></a>03186 (plotted in VisIt):
<a name="l03187"></a>03187 @image html Solution_3DNavStok_Bubble_PETSc.gif
<a name="l03188"></a>03188 
<a name="l03189"></a>03189 The file &lt;B&gt;function_counts.dat&lt;/B&gt; reports the computational expense
<a name="l03190"></a>03190 (in terms of the number of function counts):
<a name="l03191"></a>03191 \include 3D/<a class="code" href="a00022.html" title="Structure containing variables and parameters specific to the 3D Navier Stokes equations...">NavierStokes3D</a>/RisingThermalBubble_Config1_PETSc_IMEX/function_counts.dat
<a name="l03192"></a>03192 The numbers are, respectively,
<a name="l03193"></a>03193 + Time iterations
<a name="l03194"></a>03194 + Number of times the hyperbolic term was evaluated
<a name="l03195"></a>03195 + Number of times the parabolic term was evaluated
<a name="l03196"></a>03196 + Number of times the source term was evaluated
<a name="l03197"></a>03197 + Number of calls to the <span class="keyword">explicit</span> right-hand-side function (<a class="code" href="a00046.html#ac7d9b0a219eb22bfd37482b741bd79c9">PetscRHSFunctionIMEX</a>() or <a class="code" href="a00046.html#ac67533553372ed2b44b32d095c775f5c">PetscRHSFunctionExpl</a>())
<a name="l03198"></a>03198 + Number of calls to the implicit right-hand-side function (<a class="code" href="a00046.html#a9d093c3140369a1178dd5b9589a926b1">PetscIFunctionIMEX</a>() or <a class="code" href="a00046.html#a91eb21ee4374b79a74f413d926344d7e">PetscRHSFunctionImpl</a>())
<a name="l03199"></a>03199 + Number of calls to the Jacobian (<a class="code" href="a00046.html#a82aacb94c1481144ce3e43d40d1f04d4">PetscIJacobianIMEX</a>() or <a class="code" href="a00046.html#a3d6a695a879ec54937525109ac912355">PetscIJacobian</a>())
<a name="l03200"></a>03200 + Number of calls to the matrix-free Jacobian function (<a class="code" href="a00046.html#a8778c346e27f42f0583c63909c2ea544">PetscJacobianFunctionIMEX_Linear</a>(), <a class="code" href="a00046.html#a4edf057726501be3e8fe54e16fafe07b">PetscJacobianFunctionIMEX_JFNK</a>(), <a class="code" href="a00046.html#a68f5a93a79d56fcb964224f649af4ac9">PetscJacobianFunction_JFNK</a>(), or <a class="code" href="a00046.html#abed41de2efef801be98f8338aa2672f2">PetscJacobianFunction_Linear</a>()).
<a name="l03201"></a>03201 
<a name="l03202"></a>03202 Expected screen output:
<a name="l03203"></a>03203 \include 3D/<a class="code" href="a00022.html" title="Structure containing variables and parameters specific to the 3D Navier Stokes equations...">NavierStokes3D</a>/RisingThermalBubble_Config1_PETSc_IMEX/output.log
<a name="l03204"></a>03204 
<a name="l03205"></a>03205 
<a name="l03206"></a>03206 \<a class="code" href="a00032.html#a23a77f360d9ab0a90b11ff01314b6526">page</a> euler2d_vortex_petsc 2D Euler Equations - Isentropic Vortex Convection
<a name="l03207"></a>03207 
<a name="l03208"></a>03208 <a class="code" href="a00031.html#af7342acc7b7299a81e83b43ed11b9f84">Location</a>: \b hypar/<a class="code" href="a00031.html#a60f502575a2e782807ea78c05f76ae03">Examples</a>/2D/<a class="code" href="a00021.html" title="Structure containing variables and parameters specific to the 2D Navier Stokes equations...">NavierStokes2D</a>/InviscidVortexConvection_PETSc_Implicit
<a name="l03209"></a>03209           (This directory contains all the input files needed
<a name="l03210"></a>03210           to run <span class="keyword">this</span> <span class="keywordflow">case</span>. If there is a \a Run.m, run it in
<a name="l03211"></a>03211           MATLAB to quickly <span class="keyword">set</span> up, run, and visualize the 
<a name="l03212"></a>03212           example).
<a name="l03213"></a>03213 
<a name="l03214"></a>03214 Governing equations: 2D Euler Equations (navierstokes2d.h - By <span class="keywordflow">default</span>,
<a name="l03215"></a>03215                      #<a class="code" href="a00021.html#a3b92a4b98cedf64473b3c13dfa7674b4">NavierStokes2D::Re</a> is <span class="keyword">set</span> to \b -1 which makes the
<a name="l03216"></a>03216                      code skip the parabolic terms, i.e., the 2D Euler
<a name="l03217"></a>03217                      equations are solved.)
<a name="l03218"></a>03218 
<a name="l03219"></a>03219 Reference: C.-W. Shu, <span class="stringliteral">&quot;Essentially Non-oscillatory and Weighted Essentially </span>
<a name="l03220"></a>03220 <span class="stringliteral">           Non-oscillatory Schemes for Hyperbolic Conservation Laws&quot;</span>, 
<a name="l03221"></a>03221            ICASE Report 97-65, 1997
<a name="l03222"></a>03222 
<a name="l03223"></a>03223 <a class="code" href="a00031.html#a948095327123305f3fdf2b293b55381e">Domain</a>: \f$0 \le x,y \le 10\f$, \a <span class="stringliteral">&quot;periodic&quot;</span> (#<a class="code" href="a00037.html#a65ffa4253dee762c65092abcf04ecdee">_PERIODIC_</a>)
<a name="l03224"></a>03224         boundary <a class="code" href="a00063.html#a07bca284db2938db7ad469438892ca47">conditions</a>.
<a name="l03225"></a>03225 
<a name="l03226"></a>03226 Initial solution: The freestream flow is given <a class="code" href="a00032.html#a124150da8eed3d9f42e9361cc143ed7e">by</a>
<a name="l03227"></a>03227 \f{<a class="code" href="a00033.html#ac3f62e1b06188678336543688cb7709e">equation</a>}{
<a name="l03228"></a>03228   \rho_\infty = 1,\ u_\infty = 0.5,\ v_\infty = 0,\ p_\infty = 1
<a name="l03229"></a>03229 \f}
<a name="l03230"></a>03230 and a vortex is introduced, <a class="code" href="a00032.html#aa18752ebe19b49b626048c92d4586801">specified</a> as
<a name="l03231"></a>03231 \f{align}{
<a name="l03232"></a>03232 \rho &amp;= \left[ 1 - \frac{\left(\gamma-1\right)b^2}{8\gamma\pi^2} e^{1-r^2} \right]^{\frac{1}{\gamma-1}},\ p = \rho^\gamma, \\
<a name="l03233"></a>03233 u &amp;= u_\infty - \frac{b}{2\pi} e^{\frac{1}{2}\left(1-r^2\right)} \left(y-y_c\right),\ v = v_\infty + \frac{b}{2\pi} e^{\frac{1}{2}\left(1-r^2\right)} \left(x-x_c\right),
<a name="l03234"></a>03234 \f}
<a name="l03235"></a>03235 where \f$b=0.5\f$ is the vortex strength and \f$r = \left[(x-x_c)^2 + (y-y_c)^2 \right]^{1/2}\f$ is the distance from the vortex center \f$\left(x_c,y_c\right) = \left(5,5\right)\f$.
<a name="l03236"></a>03236 
<a name="l03237"></a>03237 Numerical method:
<a name="l03238"></a>03238  + Spatial <a class="code" href="a00033.html#a006f5ed6c12ae3d4f8e840cb181a05ca">discretization</a> (hyperbolic): 5th order compact upwind (<a class="code" href="a00041.html#a3ac2a77b9fa5a50499c285e49cf91344" title="5th order compact upwind reconstruction (component-wise) on a uniform grid">Interp1PrimFifthOrderCompactUpwind</a>())
<a name="l03239"></a>03239  + Time integration: PETSc (<a class="code" href="a00039.html#a4dc9b9ce6ce776b7901fa2a6c9c9c1cf" title="Integrate in time with PETSc.">SolvePETSc</a>()) - &lt;B&gt;Crank-Nicholson&lt;/B&gt; (TSCN - http:<span class="comment">//www.mcs.anl.gov/petsc/petsc-current/docs/manualpages/TS/TSCN.html)</span>
<a name="l03240"></a>03240 
<a name="l03241"></a>03241 Input files <a class="code" href="a00032.html#af7a1b4a66a5b6f9ac8eebf2c23b51e9e">required</a>:
<a name="l03242"></a>03242 ---------------------
<a name="l03243"></a>03243 
<a name="l03244"></a>03244 &lt;B&gt;.petscrc&lt;/B&gt;
<a name="l03245"></a>03245 \include 2D/<a class="code" href="a00021.html" title="Structure containing variables and parameters specific to the 2D Navier Stokes equations...">NavierStokes2D</a>/InviscidVortexConvection_PETSc_Implicit/petscrc
<a name="l03246"></a>03246 
<a name="l03247"></a>03247 \b solver.inp
<a name="l03248"></a>03248 \include 2D/<a class="code" href="a00021.html" title="Structure containing variables and parameters specific to the 2D Navier Stokes equations...">NavierStokes2D</a>/InviscidVortexConvection_PETSc_Implicit/solver.inp
<a name="l03249"></a>03249 
<a name="l03250"></a>03250 \b boundary.inp
<a name="l03251"></a>03251 \include 2D/<a class="code" href="a00021.html" title="Structure containing variables and parameters specific to the 2D Navier Stokes equations...">NavierStokes2D</a>/InviscidVortexConvection_PETSc_Implicit/boundary.inp
<a name="l03252"></a>03252 
<a name="l03253"></a>03253 \b physics.inp
<a name="l03254"></a>03254 \include 2D/<a class="code" href="a00021.html" title="Structure containing variables and parameters specific to the 2D Navier Stokes equations...">NavierStokes2D</a>/InviscidVortexConvection_PETSc_Implicit/physics.inp
<a name="l03255"></a>03255 
<a name="l03256"></a>03256 \b lusolver.inp (optional)
<a name="l03257"></a>03257 \include 2D/<a class="code" href="a00021.html" title="Structure containing variables and parameters specific to the 2D Navier Stokes equations...">NavierStokes2D</a>/InviscidVortexConvection_PETSc_Implicit/lusolver.inp
<a name="l03258"></a>03258 
<a name="l03259"></a>03259 To generate \b initial.inp (initial solution) and \b exact.inp
<a name="l03260"></a>03260 (exact solution), compile and run the following code in the run 
<a name="l03261"></a>03261 directory.
<a name="l03262"></a>03262 \include 2D/<a class="code" href="a00021.html" title="Structure containing variables and parameters specific to the 2D Navier Stokes equations...">NavierStokes2D</a>/InviscidVortexConvection_PETSc_Implicit/aux/exact.c
<a name="l03263"></a>03263 
<a name="l03264"></a>03264 Output:
<a name="l03265"></a>03265 -------
<a name="l03266"></a>03266 <a class="code" href="a00032.html#a86616b1951d3af95df5b7115dd30438f">Note</a> that \b iproc is set to 
<a name="l03267"></a>03267 
<a name="l03268"></a>03268       2 2
<a name="l03269"></a>03269 
<a name="l03270"></a>03270 in \b solver.inp (i.e., 2 processors along \a x, and 2
<a name="l03271"></a>03271 processors along \a y). Thus, this example should be run
<a name="l03272"></a>03272 with 4 MPI ranks (or change \b iproc).
<a name="l03273"></a>03273 
<a name="l03274"></a>03274 After running the code, there should be 11 output
<a name="l03275"></a>03275 files \b op_00000.<a class="code" href="a00031.html#a96b9dfbebc4ecd57a32426075fb0c3f2">dat</a>, \b op_00001.<a class="code" href="a00031.html#a96b9dfbebc4ecd57a32426075fb0c3f2">dat</a>, ... \b op_00010.<a class="code" href="a00031.html#a96b9dfbebc4ecd57a32426075fb0c3f2">dat</a>; 
<a name="l03276"></a>03276 the first one is the solution at \f$t=0\f$ and the <span class="keyword">final</span> one
<a name="l03277"></a>03277 is the solution at \f$t=20\f$. Since #<a class="code" href="a00015.html#a4e93cb107e180ef982b74cef7726b70f">HyPar::op_overwrite</a> is
<a name="l03278"></a>03278 <span class="keyword">set</span> to \a no in \b solver.inp, separate files are written
<a name="l03279"></a>03279 <span class="keywordflow">for</span> solutions at each output time. 
<a name="l03280"></a>03280   
<a name="l03281"></a>03281 <span class="preprocessor">#HyPar::op_file_format is set to \a tecplot2d in \b solver.inp, and</span>
<a name="l03282"></a>03282 <span class="preprocessor"></span>thus, all the files are in a format that Tecplot (http:<span class="comment">//www.tecplot.com/)</span>
<a name="l03283"></a>03283 or other visualization software supporting the Tecplot format 
<a name="l03284"></a>03284 (e.g. VisIt - https:<span class="comment">//wci.llnl.gov/simulation/computer-codes/visit/)</span>
<a name="l03285"></a>03285 can read. In these files, the first two lines are the Tecplot headers, 
<a name="l03286"></a>03286 after which the data is written out as: the first two columns are grid indices, 
<a name="l03287"></a>03287 the next two columns are x and y coordinates, and the remaining columns are the 
<a name="l03288"></a>03288 solution components.  #<a class="code" href="a00015.html#a51a3b8c19b86e9e1df5be02b05a6613c">HyPar::op_file_format</a> can be <span class="keyword">set</span> to \a <a class="code" href="a00031.html#a314f90bacf496961ff4bfef89fea32c0">text</a> to <span class="keyword">get</span> the solution
<a name="l03289"></a>03289 files in plain <a class="code" href="a00031.html#a314f90bacf496961ff4bfef89fea32c0">text</a> format (which can be read in and visualized in
<a name="l03290"></a>03290 MATLAB <span class="keywordflow">for</span> example).
<a name="l03291"></a>03291 
<a name="l03292"></a>03292 The following plot shows the density contours at the <span class="keyword">final</span> time t=1, 
<a name="l03293"></a>03293 obtained from plotting \b op_00010.dat:
<a name="l03294"></a>03294 @image html Solution_2DNavStokVortexPETSc.gif
<a name="l03295"></a>03295 
<a name="l03296"></a>03296 Since the exact solution is available at the <span class="keyword">final</span> time 
<a name="l03297"></a>03297 (\a exact.inp is a <a class="code" href="a00063.html#af77238a13603775a1f60ae9206d86600">copy</a> of \a initial.inp), the numerical 
<a name="l03298"></a>03298 errors are calculated and reported on screen (see below)
<a name="l03299"></a>03299 as well as \b errors.dat:
<a name="l03300"></a>03300 \include 2D/<a class="code" href="a00021.html" title="Structure containing variables and parameters specific to the 2D Navier Stokes equations...">NavierStokes2D</a>/InviscidVortexConvection_PETSc_Implicit/errors.dat
<a name="l03301"></a>03301 The numbers are: number of grid points in each dimension (#<a class="code" href="a00015.html#aa989ebb755986852177779cdf7bd8c85">HyPar::dim_global</a>), 
<a name="l03302"></a>03302 number of processors in each dimension (#<a class="code" href="a00019.html#a0be0f30a83bc3f3d9f6ee3a36bbf2716">MPIVariables::iproc</a>),
<a name="l03303"></a>03303 time step size (#<a class="code" href="a00015.html#a03e28be41881b703c836edbfe9b51b17">HyPar::dt</a>),
<a name="l03304"></a>03304 L1, L2, and L-infinity errors (#<a class="code" href="a00015.html#aa40f27cb2afa2db0f0468962be8b3679">HyPar::error</a>),
<a name="l03305"></a>03305 solver wall time (seconds) (i.e., not accounting <span class="keywordflow">for</span> initialization,
<a name="l03306"></a>03306 and cleaning up),
<a name="l03307"></a>03307 and total wall time.
<a name="l03308"></a>03308 
<a name="l03309"></a>03309 Since #<a class="code" href="a00015.html#ac92c34fe456d92c694eacd2231f5a7b1">HyPar::ConservationCheck</a> is <span class="keyword">set</span> to \a yes in \b solver.inp,
<a name="l03310"></a>03310 the code checks <span class="keywordflow">for</span> conservation error and prints it to screen, as well
<a name="l03311"></a>03311 as the file \b conservation.dat:
<a name="l03312"></a>03312 \include 2D/<a class="code" href="a00021.html" title="Structure containing variables and parameters specific to the 2D Navier Stokes equations...">NavierStokes2D</a>/InviscidVortexConvection_PETSc_Implicit/conservation.dat
<a name="l03313"></a>03313 The numbers are: number of grid points in each dimension (#<a class="code" href="a00015.html#aa989ebb755986852177779cdf7bd8c85">HyPar::dim_global</a>),
<a name="l03314"></a>03314 number of processors in each dimension (#<a class="code" href="a00019.html#a0be0f30a83bc3f3d9f6ee3a36bbf2716">MPIVariables::iproc</a>),
<a name="l03315"></a>03315 time step size (#<a class="code" href="a00015.html#a03e28be41881b703c836edbfe9b51b17">HyPar::dt</a>),
<a name="l03316"></a>03316 and conservation error (#<a class="code" href="a00015.html#a965363cd64ce50ae17705dfb285dd0ab">HyPar::ConservationError</a>) of each component.
<a name="l03317"></a>03317 \b <a class="code" href="a00032.html#a86616b1951d3af95df5b7115dd30438f">Note</a> that the conservation error depends on the accuracy with which the 
<a name="l03318"></a>03318 implicit systems are solved. Since the systems are solved with relaxed tolerances
<a name="l03319"></a>03319 here (see \a ksp_atol, \a ksp_rtol, \a snes_atol, \a snes_rtol in &lt;B&gt;.petscrc&lt;/B&gt;),
<a name="l03320"></a>03320 the conservation error is zero within round-off.
<a name="l03321"></a>03321 
<a name="l03322"></a>03322 The file &lt;B&gt;function_counts.dat&lt;/B&gt; reports the computational expense
<a name="l03323"></a>03323 (in terms of the number of function counts):
<a name="l03324"></a>03324 \include 2D/<a class="code" href="a00021.html" title="Structure containing variables and parameters specific to the 2D Navier Stokes equations...">NavierStokes2D</a>/InviscidVortexConvection_PETSc_Implicit/function_counts.dat
<a name="l03325"></a>03325 The numbers are, respectively,
<a name="l03326"></a>03326 + Time iterations
<a name="l03327"></a>03327 + Number of times the hyperbolic term was evaluated
<a name="l03328"></a>03328 + Number of times the parabolic term was evaluated
<a name="l03329"></a>03329 + Number of times the source term was evaluated
<a name="l03330"></a>03330 + Number of calls to the <span class="keyword">explicit</span> right-hand-side function (<a class="code" href="a00046.html#ac7d9b0a219eb22bfd37482b741bd79c9">PetscRHSFunctionIMEX</a>() or <a class="code" href="a00046.html#ac67533553372ed2b44b32d095c775f5c">PetscRHSFunctionExpl</a>())
<a name="l03331"></a>03331 + Number of calls to the implicit right-hand-side function (<a class="code" href="a00046.html#a9d093c3140369a1178dd5b9589a926b1">PetscIFunctionIMEX</a>() or <a class="code" href="a00046.html#a91eb21ee4374b79a74f413d926344d7e">PetscRHSFunctionImpl</a>())
<a name="l03332"></a>03332 + Number of calls to the Jacobian (<a class="code" href="a00046.html#a82aacb94c1481144ce3e43d40d1f04d4">PetscIJacobianIMEX</a>() or <a class="code" href="a00046.html#a3d6a695a879ec54937525109ac912355">PetscIJacobian</a>())
<a name="l03333"></a>03333 + Number of calls to the matrix-free Jacobian function (<a class="code" href="a00046.html#a8778c346e27f42f0583c63909c2ea544">PetscJacobianFunctionIMEX_Linear</a>(), <a class="code" href="a00046.html#a4edf057726501be3e8fe54e16fafe07b">PetscJacobianFunctionIMEX_JFNK</a>(), <a class="code" href="a00046.html#a68f5a93a79d56fcb964224f649af4ac9">PetscJacobianFunction_JFNK</a>(), or <a class="code" href="a00046.html#abed41de2efef801be98f8338aa2672f2">PetscJacobianFunction_Linear</a>()).
<a name="l03334"></a>03334 
<a name="l03335"></a>03335 Expected screen output:
<a name="l03336"></a>03336 \include 2D/<a class="code" href="a00021.html" title="Structure containing variables and parameters specific to the 2D Navier Stokes equations...">NavierStokes2D</a>/InviscidVortexConvection_PETSc_Implicit/output.log
<a name="l03337"></a>03337 
<a name="l03338"></a>03338 
<a name="l03339"></a>03339 \<a class="code" href="a00032.html#a23a77f360d9ab0a90b11ff01314b6526">page</a> euler2d_low_mach_vortex_petsc 2D Euler Equations - Low-Mach Isentropic Vortex Convection
<a name="l03340"></a>03340 
<a name="l03341"></a>03341 <a class="code" href="a00031.html#af7342acc7b7299a81e83b43ed11b9f84">Location</a>: \b hypar/<a class="code" href="a00031.html#a60f502575a2e782807ea78c05f76ae03">Examples</a>/2D/<a class="code" href="a00021.html" title="Structure containing variables and parameters specific to the 2D Navier Stokes equations...">NavierStokes2D</a>/LowMachVortexConvection_PETSc_IMEX
<a name="l03342"></a>03342           (This directory contains all the input files needed
<a name="l03343"></a>03343           to run <span class="keyword">this</span> <span class="keywordflow">case</span>. If there is a \a Run.m, run it in
<a name="l03344"></a>03344           MATLAB to quickly <span class="keyword">set</span> up, run, and visualize the 
<a name="l03345"></a>03345           example).
<a name="l03346"></a>03346 
<a name="l03347"></a>03347 Governing equations: 2D Euler Equations (navierstokes2d.h - By <span class="keywordflow">default</span>,
<a name="l03348"></a>03348                      #<a class="code" href="a00021.html#a3b92a4b98cedf64473b3c13dfa7674b4">NavierStokes2D::Re</a> is <span class="keyword">set</span> to \b -1 which makes the
<a name="l03349"></a>03349                      code skip the parabolic terms, i.e., the 2D Euler
<a name="l03350"></a>03350                      equations are solved.)
<a name="l03351"></a>03351 
<a name="l03352"></a>03352 Reference: Ghosh, D., Constantinescu, E. M., <span class="stringliteral">&quot;Semi-Implicit Time Integration of </span>
<a name="l03353"></a>03353 <span class="stringliteral">           Atmospheric Flows with Characteristic-Based Flux Partitioning&quot;</span>, SIAM 
<a name="l03354"></a>03354            Journal on Scientific Computing, 38 (3), 2016, A1848-A1875, 
<a name="l03355"></a>03355            http:<span class="comment">//dx.doi.org/10.1137/15M1044369.</span>
<a name="l03356"></a>03356 
<a name="l03357"></a>03357 The problem is solved here using &lt;B&gt;implicit-explicit (IMEX)&lt;/B&gt; time
<a name="l03358"></a>03358 integration, where the hyperbolic <a class="code" href="a00064.html#ae94fb13b2c09c2f8b5cdbb2fbe99cad7">flux</a> is partitioned into its entropy
<a name="l03359"></a>03359 and acoustic components with the former integrated explicitly and the
<a name="l03360"></a>03360 latter integrated implicitly. See the above reference.
<a name="l03361"></a>03361 
<a name="l03362"></a>03362 Domain: \f$0 \le x,y \le 10\f$, \a <span class="stringliteral">&quot;periodic&quot;</span> (#<a class="code" href="a00037.html#a65ffa4253dee762c65092abcf04ecdee">_PERIODIC_</a>)
<a name="l03363"></a>03363         boundary <a class="code" href="a00063.html#a07bca284db2938db7ad469438892ca47">conditions</a>.
<a name="l03364"></a>03364 
<a name="l03365"></a>03365 Initial solution: The freestream flow is given <a class="code" href="a00032.html#a124150da8eed3d9f42e9361cc143ed7e">by</a>
<a name="l03366"></a>03366 \f{<a class="code" href="a00033.html#ac3f62e1b06188678336543688cb7709e">equation</a>}{
<a name="l03367"></a>03367   \rho_\infty = 1,\ u_\infty = 0.1,\ v_\infty = 0,\ p_\infty = 1
<a name="l03368"></a>03368 \f}
<a name="l03369"></a>03369 and a vortex is introduced, <a class="code" href="a00032.html#aa18752ebe19b49b626048c92d4586801">specified</a> as
<a name="l03370"></a>03370 \f{align}{
<a name="l03371"></a>03371 \rho &amp;= \left[ 1 - \frac{\left(\gamma-1\right)b^2}{8\gamma\pi^2} e^{1-r^2} \right]^{\frac{1}{\gamma-1}},\ p = \rho^\gamma, \\
<a name="l03372"></a>03372 u &amp;= u_\infty - \frac{b}{2\pi} e^{\frac{1}{2}\left(1-r^2\right)} \left(y-y_c\right),\ v = v_\infty + \frac{b}{2\pi} e^{\frac{1}{2}\left(1-r^2\right)} \left(x-x_c\right),
<a name="l03373"></a>03373 \f}
<a name="l03374"></a>03374 where \f$b=0.5\f$ is the vortex strength and \f$r = \left[(x-x_c)^2 + (y-y_c)^2 \right]^{1/2}\f$ is the distance from the vortex center \f$\left(x_c,y_c\right) = \left(5,5\right)\f$.
<a name="l03375"></a>03375 
<a name="l03376"></a>03376 Numerical method:
<a name="l03377"></a>03377  + Spatial <a class="code" href="a00033.html#a006f5ed6c12ae3d4f8e840cb181a05ca">discretization</a> (hyperbolic): 5th order upwind (<a class="code" href="a00041.html#aea7c973ffe0c37bca0703c1bf6175aaa" title="5th order upwind reconstruction (component-wise) on a uniform grid">Interp1PrimFifthOrderUpwind</a>())
<a name="l03378"></a>03378  + Time integration: PETSc (<a class="code" href="a00039.html#a4dc9b9ce6ce776b7901fa2a6c9c9c1cf" title="Integrate in time with PETSc.">SolvePETSc</a>()) 
<a name="l03379"></a>03379    - Method Class: &lt;B&gt;Additive Runge-Kutta method&lt;/B&gt; (TSARKIMEX - http:<span class="comment">//www.mcs.anl.gov/petsc/petsc-current/docs/manualpages/TS/TSARKIMEX.html)</span>
<a name="l03380"></a>03380    - Specific method: &lt;B&gt;Kennedy-Carpenter ARK4&lt;/B&gt; (TSARKIMEX4 - http:<span class="comment">//www.mcs.anl.gov/petsc/petsc-current/docs/manualpages/TS/TSARKIMEX4.html)</span>
<a name="l03381"></a>03381 
<a name="l03382"></a>03382 Input files <a class="code" href="a00032.html#af7a1b4a66a5b6f9ac8eebf2c23b51e9e">required</a>:
<a name="l03383"></a>03383 ---------------------
<a name="l03384"></a>03384 
<a name="l03385"></a>03385 &lt;B&gt;.petscrc&lt;/B&gt;
<a name="l03386"></a>03386 \include 2D/<a class="code" href="a00021.html" title="Structure containing variables and parameters specific to the 2D Navier Stokes equations...">NavierStokes2D</a>/LowMachVortexConvection_PETSc_IMEX/petscrc
<a name="l03387"></a>03387 
<a name="l03388"></a>03388 \b solver.inp
<a name="l03389"></a>03389 \include 2D/<a class="code" href="a00021.html" title="Structure containing variables and parameters specific to the 2D Navier Stokes equations...">NavierStokes2D</a>/LowMachVortexConvection_PETSc_IMEX/solver.inp
<a name="l03390"></a>03390 
<a name="l03391"></a>03391 \b boundary.inp
<a name="l03392"></a>03392 \include 2D/<a class="code" href="a00021.html" title="Structure containing variables and parameters specific to the 2D Navier Stokes equations...">NavierStokes2D</a>/LowMachVortexConvection_PETSc_IMEX/boundary.inp
<a name="l03393"></a>03393 
<a name="l03394"></a>03394 \b physics.inp
<a name="l03395"></a>03395 \include 2D/<a class="code" href="a00021.html" title="Structure containing variables and parameters specific to the 2D Navier Stokes equations...">NavierStokes2D</a>/LowMachVortexConvection_PETSc_IMEX/physics.inp
<a name="l03396"></a>03396 
<a name="l03397"></a>03397 To generate \b initial.inp (initial solution) and \b exact.inp (exact solution), 
<a name="l03398"></a>03398 compile and run the following code in the run 
<a name="l03399"></a>03399 directory:
<a name="l03400"></a>03400 \include 2D/<a class="code" href="a00021.html" title="Structure containing variables and parameters specific to the 2D Navier Stokes equations...">NavierStokes2D</a>/LowMachVortexConvection_PETSc_IMEX/aux/exact.c
<a name="l03401"></a>03401 
<a name="l03402"></a>03402 Output:
<a name="l03403"></a>03403 -------
<a name="l03404"></a>03404 <a class="code" href="a00032.html#a86616b1951d3af95df5b7115dd30438f">Note</a> that \b iproc is set to 
<a name="l03405"></a>03405 
<a name="l03406"></a>03406       2 2
<a name="l03407"></a>03407 
<a name="l03408"></a>03408 in \b solver.inp (i.e., 2 processors along \a x, and 2
<a name="l03409"></a>03409 processors along \a y). Thus, this example should be run
<a name="l03410"></a>03410 with 4 MPI ranks (or change \b iproc).
<a name="l03411"></a>03411 
<a name="l03412"></a>03412 After running the code, there should be 11 output
<a name="l03413"></a>03413 files \b op_00000.<a class="code" href="a00031.html#a96b9dfbebc4ecd57a32426075fb0c3f2">dat</a>, \b op_00001.<a class="code" href="a00031.html#a96b9dfbebc4ecd57a32426075fb0c3f2">dat</a>, ... \b op_00010.<a class="code" href="a00031.html#a96b9dfbebc4ecd57a32426075fb0c3f2">dat</a>; 
<a name="l03414"></a>03414 the first one is the solution at \f$t=0\f$ and the <span class="keyword">final</span> one
<a name="l03415"></a>03415 is the solution at \f$t=100\f$. Since #<a class="code" href="a00015.html#a4e93cb107e180ef982b74cef7726b70f">HyPar::op_overwrite</a> is
<a name="l03416"></a>03416 <span class="keyword">set</span> to \a no in \b solver.inp, separate files are written
<a name="l03417"></a>03417 <span class="keywordflow">for</span> solutions at each output time. 
<a name="l03418"></a>03418   
<a name="l03419"></a>03419 <span class="preprocessor">#HyPar::op_file_format is set to \a tecplot2d in \b solver.inp, and</span>
<a name="l03420"></a>03420 <span class="preprocessor"></span>thus, all the files are in a format that Tecplot (http:<span class="comment">//www.tecplot.com/)</span>
<a name="l03421"></a>03421 or other visualization software supporting the Tecplot format 
<a name="l03422"></a>03422 (e.g. VisIt - https:<span class="comment">//wci.llnl.gov/simulation/computer-codes/visit/)</span>
<a name="l03423"></a>03423 can read. In these files, the first two lines are the Tecplot headers, 
<a name="l03424"></a>03424 after which the data is written out as: the first two columns are grid indices, 
<a name="l03425"></a>03425 the next two columns are x and y coordinates, and the remaining columns are the 
<a name="l03426"></a>03426 solution components.  #<a class="code" href="a00015.html#a51a3b8c19b86e9e1df5be02b05a6613c">HyPar::op_file_format</a> can be <span class="keyword">set</span> to \a <a class="code" href="a00031.html#a314f90bacf496961ff4bfef89fea32c0">text</a> to <span class="keyword">get</span> the solution
<a name="l03427"></a>03427 files in plain <a class="code" href="a00031.html#a314f90bacf496961ff4bfef89fea32c0">text</a> format (which can be read in and visualized in
<a name="l03428"></a>03428 MATLAB <span class="keywordflow">for</span> example).
<a name="l03429"></a>03429 
<a name="l03430"></a>03430 The following plot shows the density contours at the <span class="keyword">final</span> time t=1, 
<a name="l03431"></a>03431 obtained from plotting \b op_00010.dat:
<a name="l03432"></a>03432 @image html Solution_2DNavStokLowMachVortexPETSc.gif
<a name="l03433"></a>03433 
<a name="l03434"></a>03434 Since the exact solution is available at the <span class="keyword">final</span> time 
<a name="l03435"></a>03435 (\a exact.inp is a <a class="code" href="a00063.html#af77238a13603775a1f60ae9206d86600">copy</a> of \a initial.inp), the numerical 
<a name="l03436"></a>03436 errors are calculated and reported on screen (see below)
<a name="l03437"></a>03437 as well as \b errors.dat:
<a name="l03438"></a>03438 \include 2D/<a class="code" href="a00021.html" title="Structure containing variables and parameters specific to the 2D Navier Stokes equations...">NavierStokes2D</a>/LowMachVortexConvection_PETSc_IMEX/errors.dat
<a name="l03439"></a>03439 The numbers are: number of grid points in each dimension (#<a class="code" href="a00015.html#aa989ebb755986852177779cdf7bd8c85">HyPar::dim_global</a>), 
<a name="l03440"></a>03440 number of processors in each dimension (#<a class="code" href="a00019.html#a0be0f30a83bc3f3d9f6ee3a36bbf2716">MPIVariables::iproc</a>),
<a name="l03441"></a>03441 time step size (#<a class="code" href="a00015.html#a03e28be41881b703c836edbfe9b51b17">HyPar::dt</a>),
<a name="l03442"></a>03442 L1, L2, and L-infinity errors (#<a class="code" href="a00015.html#aa40f27cb2afa2db0f0468962be8b3679">HyPar::error</a>),
<a name="l03443"></a>03443 solver wall time (seconds) (i.e., not accounting <span class="keywordflow">for</span> initialization,
<a name="l03444"></a>03444 and cleaning up),
<a name="l03445"></a>03445 and total wall time.
<a name="l03446"></a>03446 
<a name="l03447"></a>03447 Since #<a class="code" href="a00015.html#ac92c34fe456d92c694eacd2231f5a7b1">HyPar::ConservationCheck</a> is <span class="keyword">set</span> to \a yes in \b solver.inp,
<a name="l03448"></a>03448 the code checks <span class="keywordflow">for</span> conservation error and prints it to screen, as well
<a name="l03449"></a>03449 as the file \b conservation.dat:
<a name="l03450"></a>03450 \include 2D/<a class="code" href="a00021.html" title="Structure containing variables and parameters specific to the 2D Navier Stokes equations...">NavierStokes2D</a>/LowMachVortexConvection_PETSc_IMEX/conservation.dat
<a name="l03451"></a>03451 The numbers are: number of grid points in each dimension (#<a class="code" href="a00015.html#aa989ebb755986852177779cdf7bd8c85">HyPar::dim_global</a>),
<a name="l03452"></a>03452 number of processors in each dimension (#<a class="code" href="a00019.html#a0be0f30a83bc3f3d9f6ee3a36bbf2716">MPIVariables::iproc</a>),
<a name="l03453"></a>03453 time step size (#<a class="code" href="a00015.html#a03e28be41881b703c836edbfe9b51b17">HyPar::dt</a>),
<a name="l03454"></a>03454 and conservation error (#<a class="code" href="a00015.html#a965363cd64ce50ae17705dfb285dd0ab">HyPar::ConservationError</a>) of each component.
<a name="l03455"></a>03455 \b <a class="code" href="a00032.html#a86616b1951d3af95df5b7115dd30438f">Note</a> that the conservation error depends on the accuracy with which the 
<a name="l03456"></a>03456 implicit systems are solved (see \a ksp_atol, \a ksp_rtol, \a snes_atol, 
<a name="l03457"></a>03457 \a snes_rtol in &lt;B&gt;.petscrc&lt;/B&gt;).
<a name="l03458"></a>03458 
<a name="l03459"></a>03459 The file &lt;B&gt;function_counts.dat&lt;/B&gt; reports the computational expense
<a name="l03460"></a>03460 (in terms of the number of function counts):
<a name="l03461"></a>03461 \include 2D/<a class="code" href="a00021.html" title="Structure containing variables and parameters specific to the 2D Navier Stokes equations...">NavierStokes2D</a>/LowMachVortexConvection_PETSc_IMEX/function_counts.dat
<a name="l03462"></a>03462 The numbers are, respectively,
<a name="l03463"></a>03463 + Time iterations
<a name="l03464"></a>03464 + Number of times the hyperbolic term was evaluated
<a name="l03465"></a>03465 + Number of times the parabolic term was evaluated
<a name="l03466"></a>03466 + Number of times the source term was evaluated
<a name="l03467"></a>03467 + Number of calls to the <span class="keyword">explicit</span> right-hand-side function (<a class="code" href="a00046.html#ac7d9b0a219eb22bfd37482b741bd79c9">PetscRHSFunctionIMEX</a>() or <a class="code" href="a00046.html#ac67533553372ed2b44b32d095c775f5c">PetscRHSFunctionExpl</a>())
<a name="l03468"></a>03468 + Number of calls to the implicit right-hand-side function (<a class="code" href="a00046.html#a9d093c3140369a1178dd5b9589a926b1">PetscIFunctionIMEX</a>() or <a class="code" href="a00046.html#a91eb21ee4374b79a74f413d926344d7e">PetscRHSFunctionImpl</a>())
<a name="l03469"></a>03469 + Number of calls to the Jacobian (<a class="code" href="a00046.html#a82aacb94c1481144ce3e43d40d1f04d4">PetscIJacobianIMEX</a>() or <a class="code" href="a00046.html#a3d6a695a879ec54937525109ac912355">PetscIJacobian</a>())
<a name="l03470"></a>03470 + Number of calls to the matrix-free Jacobian function (<a class="code" href="a00046.html#a8778c346e27f42f0583c63909c2ea544">PetscJacobianFunctionIMEX_Linear</a>(), <a class="code" href="a00046.html#a4edf057726501be3e8fe54e16fafe07b">PetscJacobianFunctionIMEX_JFNK</a>(), <a class="code" href="a00046.html#a68f5a93a79d56fcb964224f649af4ac9">PetscJacobianFunction_JFNK</a>(), or <a class="code" href="a00046.html#abed41de2efef801be98f8338aa2672f2">PetscJacobianFunction_Linear</a>()).
<a name="l03471"></a>03471 
<a name="l03472"></a>03472 Expected screen output:
<a name="l03473"></a>03473 \include 2D/<a class="code" href="a00021.html" title="Structure containing variables and parameters specific to the 2D Navier Stokes equations...">NavierStokes2D</a>/LowMachVortexConvection_PETSc_IMEX/output.log
<a name="l03474"></a>03474 
<a name="l03475"></a>03475 
<a name="l03476"></a>03476 \<a class="code" href="a00032.html#a23a77f360d9ab0a90b11ff01314b6526">page</a> euler2d_igwave_petsc 2D Euler Equations (with gravitational force) - Inertia-Gravity Waves
<a name="l03477"></a>03477 
<a name="l03478"></a>03478 <a class="code" href="a00031.html#af7342acc7b7299a81e83b43ed11b9f84">Location</a>: \b hypar/<a class="code" href="a00031.html#a60f502575a2e782807ea78c05f76ae03">Examples</a>/2D/<a class="code" href="a00021.html" title="Structure containing variables and parameters specific to the 2D Navier Stokes equations...">NavierStokes2D</a>/InertiaGravityWave_PETSc_IMEX
<a name="l03479"></a>03479           (This directory contains all the input files needed
<a name="l03480"></a>03480           to run <span class="keyword">this</span> <span class="keywordflow">case</span>. If there is a \a Run.m, run it in
<a name="l03481"></a>03481           MATLAB to quickly <span class="keyword">set</span> up, run, and visualize the 
<a name="l03482"></a>03482           example).
<a name="l03483"></a>03483 
<a name="l03484"></a>03484 Governing equations: 2D Euler Equations (navierstokes2d.h - By <span class="keywordflow">default</span>,
<a name="l03485"></a>03485                      #<a class="code" href="a00021.html#a3b92a4b98cedf64473b3c13dfa7674b4">NavierStokes2D::Re</a> is <span class="keyword">set</span> to \b -1 which makes the
<a name="l03486"></a>03486                      code skip the parabolic terms, i.e., the 2D Euler
<a name="l03487"></a>03487                      equations are solved.)
<a name="l03488"></a>03488 
<a name="l03489"></a>03489 Reference:
<a name="l03490"></a>03490   + W. C. Skamarock and J. B. Klemp, <span class="stringliteral">&quot;Efficiency and accuracy of </span>
<a name="l03491"></a>03491 <span class="stringliteral">    the Klemp-Wilhelmson timesplitting technique&quot;</span>, Monthly Weather 
<a name="l03492"></a>03492     Review, 122 (1994), pp. 2623–2630.
<a name="l03493"></a>03493   + Giraldo, F.X., Restelli, M., <span class="stringliteral">&quot;A study of spectral element and</span>
<a name="l03494"></a>03494 <span class="stringliteral">    discontinuous Galerkin methods for the Navier–Stokes equations</span>
<a name="l03495"></a>03495 <span class="stringliteral">    in nonhydrostatic mesoscale atmospheric modeling: Equation sets</span>
<a name="l03496"></a>03496 <span class="stringliteral">    and test cases&quot;</span>, J. Comput. Phys., 227, 2008, 3849--3877, 
<a name="l03497"></a>03497     (Section 3.1).
<a name="l03498"></a>03498 
<a name="l03499"></a>03499 The problem is solved here using &lt;B&gt;implicit-explicit (IMEX)&lt;/B&gt; time
<a name="l03500"></a>03500 integration, where the hyperbolic <a class="code" href="a00064.html#ae94fb13b2c09c2f8b5cdbb2fbe99cad7">flux</a> is partitioned into its entropy
<a name="l03501"></a>03501 and acoustic components with the former integrated explicitly and the
<a name="l03502"></a>03502 latter integrated implicitly. See the following reference:
<a name="l03503"></a>03503 + Ghosh, D., Constantinescu, E. M., <span class="stringliteral">&quot;Semi-Implicit Time Integration of </span>
<a name="l03504"></a>03504 <span class="stringliteral">  Atmospheric Flows with Characteristic-Based Flux Partitioning&quot;</span>, SIAM 
<a name="l03505"></a>03505   Journal on Scientific Computing, 38 (3), 2016, A1848-A1875, 
<a name="l03506"></a>03506   http:<span class="comment">//dx.doi.org/10.1137/15M1044369.</span>
<a name="l03507"></a>03507 
<a name="l03508"></a>03508 <a class="code" href="a00031.html#a948095327123305f3fdf2b293b55381e">Domain</a>: \f$0 \le x \le 300,000\,m, 0 \le y \le 10,000\,m\f$, \a <span class="stringliteral">&quot;periodic&quot;</span> (#<a class="code" href="a00037.html#a65ffa4253dee762c65092abcf04ecdee">_PERIODIC_</a>)
<a name="l03509"></a>03509         boundary <a class="code" href="a00063.html#a07bca284db2938db7ad469438892ca47">conditions</a> along \f$x\f$, <span class="stringliteral">&quot;slip-wall&quot;</span> (#<a class="code" href="a00037.html#af3a9f3ba15bc914ed0a88295aee147e8">_SLIP_WALL_</a>) boundary <a class="code" href="a00063.html#a07bca284db2938db7ad469438892ca47">conditions</a> along \f$y\f$.
<a name="l03510"></a>03510 
<a name="l03511"></a>03511 Initial solution: See references above.
<a name="l03512"></a>03512 
<a name="l03513"></a>03513 Other parameters (all dimensional quantities are in SI units):
<a name="l03514"></a>03514   + Specific heat ratio \f$\gamma = 1.4\f$ (#<a class="code" href="a00021.html#a72f9e01745b3a8203067ab84aefc9aea">NavierStokes2D::gamma</a>)
<a name="l03515"></a>03515   + Universal gas constant \f$R = 287.058\f$ (#<a class="code" href="a00021.html#a228eb5e837a644887ac6e7bab3f42485">NavierStokes2D::R</a>)
<a name="l03516"></a>03516   + Gravitational force per unit mass \f$g = 9.8\f$ along \a y-axis (#<a class="code" href="a00021.html#adf08e308b453bd2d4e117576e493ed03">NavierStokes2D::grav_y</a>)
<a name="l03517"></a>03517   + Reference density (at zero altitude) \f$\rho_{ref} = 1.1612055171196529\f$ (#<a class="code" href="a00021.html#a1e6f66261d19a1c1c272e8808bd2657b">NavierStokes2D::rho0</a>)
<a name="l03518"></a>03518   + Reference <a class="code" href="a00032.html#a58d87a94271c7f86a36fafc7117fe0b0">pressure</a> (at zero altitude) \f$P_{ref} = 100000\f$ (#<a class="code" href="a00021.html#a8be9de5ac626cddcd15c5ec181619694">NavierStokes2D::p0</a>)
<a name="l03519"></a>03519   + Hydrostatic balance type 3 (#<a class="code" href="a00021.html#a2e01ef077b0fedaea9e286ccdf2fe259">NavierStokes2D::HB</a>)
<a name="l03520"></a>03520   + Brunt-Vaisala frequency 0.01 (#<a class="code" href="a00021.html#aa79c64518f6e9127d9b201bacd398174">NavierStokes2D::N_bv</a>)
<a name="l03521"></a>03521 
<a name="l03522"></a>03522 Numerical method:
<a name="l03523"></a>03523  + Spatial discretization (hyperbolic): 5th order compact upwind (<a class="code" href="a00041.html#a3ac2a77b9fa5a50499c285e49cf91344" title="5th order compact upwind reconstruction (component-wise) on a uniform grid">Interp1PrimFifthOrderCompactUpwind</a>())
<a name="l03524"></a>03524  + Time integration: <a class="code" href="a00032.html#a74efd4099e297716dbf2fa701e90b65e">PETSc</a> (<a class="code" href="a00039.html#a4dc9b9ce6ce776b7901fa2a6c9c9c1cf" title="Integrate in time with PETSc.">SolvePETSc</a>()) 
<a name="l03525"></a>03525    - Method Class: &lt;B&gt;Additive Runge-Kutta method&lt;/B&gt; (TSARKIMEX - http:<span class="comment">//www.mcs.anl.gov/petsc/petsc-current/docs/manualpages/TS/TSARKIMEX.html)</span>
<a name="l03526"></a>03526    - Specific method: &lt;B&gt;Kennedy-Carpenter ARK4&lt;/B&gt; (TSARKIMEX4 - http:<span class="comment">//www.mcs.anl.gov/petsc/petsc-current/docs/manualpages/TS/TSARKIMEX4.html)</span>
<a name="l03527"></a>03527 
<a name="l03528"></a>03528 
<a name="l03529"></a>03529 Input files <a class="code" href="a00032.html#af7a1b4a66a5b6f9ac8eebf2c23b51e9e">required</a>:
<a name="l03530"></a>03530 ---------------------
<a name="l03531"></a>03531 
<a name="l03532"></a>03532 &lt;B&gt;.petscrc&lt;/B&gt;
<a name="l03533"></a>03533 \include 2D/<a class="code" href="a00021.html" title="Structure containing variables and parameters specific to the 2D Navier Stokes equations...">NavierStokes2D</a>/InertiaGravityWave_PETSc_IMEX/petscrc
<a name="l03534"></a>03534 
<a name="l03535"></a>03535 \b solver.inp
<a name="l03536"></a>03536 \include 2D/<a class="code" href="a00021.html" title="Structure containing variables and parameters specific to the 2D Navier Stokes equations...">NavierStokes2D</a>/InertiaGravityWave_PETSc_IMEX/solver.inp
<a name="l03537"></a>03537 
<a name="l03538"></a>03538 \b boundary.inp
<a name="l03539"></a>03539 \include 2D/<a class="code" href="a00021.html" title="Structure containing variables and parameters specific to the 2D Navier Stokes equations...">NavierStokes2D</a>/InertiaGravityWave_PETSc_IMEX/boundary.inp
<a name="l03540"></a>03540 
<a name="l03541"></a>03541 \b physics.inp
<a name="l03542"></a>03542 \include 2D/<a class="code" href="a00021.html" title="Structure containing variables and parameters specific to the 2D Navier Stokes equations...">NavierStokes2D</a>/InertiaGravityWave_PETSc_IMEX/physics.inp
<a name="l03543"></a>03543 
<a name="l03544"></a>03544 To generate \b initial.inp (initial solution), compile 
<a name="l03545"></a>03545 and run the following code in the run directory.
<a name="l03546"></a>03546 \include 2D/<a class="code" href="a00021.html" title="Structure containing variables and parameters specific to the 2D Navier Stokes equations...">NavierStokes2D</a>/InertiaGravityWave_PETSc_IMEX/aux/init.c
<a name="l03547"></a>03547 
<a name="l03548"></a>03548 Output:
<a name="l03549"></a>03549 -------
<a name="l03550"></a>03550 <a class="code" href="a00032.html#a86616b1951d3af95df5b7115dd30438f">Note</a> that \b iproc is <span class="keyword">set</span> to 
<a name="l03551"></a>03551 
<a name="l03552"></a>03552       12 1
<a name="l03553"></a>03553 
<a name="l03554"></a>03554 in \b solver.inp (i.e., 12 processors along \a x, and 1
<a name="l03555"></a>03555 processor along \a y). Thus, <span class="keyword">this</span> example should be run
<a name="l03556"></a>03556 with 12 MPI ranks (or change \b iproc).
<a name="l03557"></a>03557 
<a name="l03558"></a>03558 After running the code, there should be 16 output
<a name="l03559"></a>03559 files \b op_00000.bin, \b op_00001.bin, ... \b op_00015.bin; 
<a name="l03560"></a>03560 the first one is the solution at \f$t=0s\f$ and the <span class="keyword">final</span> one
<a name="l03561"></a>03561 is the solution at \f$t=3000s\f$. Since #<a class="code" href="a00015.html#a4e93cb107e180ef982b74cef7726b70f">HyPar::op_overwrite</a> is
<a name="l03562"></a>03562 <span class="keyword">set</span> to \a no in \b solver.inp, separate files are written
<a name="l03563"></a>03563 <span class="keywordflow">for</span> solutions at each output time. 
<a name="l03564"></a>03564   
<a name="l03565"></a>03565 <span class="preprocessor">#HyPar::op_file_format is set to \a binary in \b solver.inp, and</span>
<a name="l03566"></a>03566 <span class="preprocessor"></span>thus, all the files are written out in the binary format, see 
<a name="l03567"></a>03567 <a class="code" href="a00042.html#a067f454c26d85d6cfb4d7d878b3783c9">WriteBinary</a>(). The binary file contains the conserved variables
<a name="l03568"></a>03568 \f$\left(\rho, \rho u, \rho v, e\right)\f$. The following code
<a name="l03569"></a>03569 converts these variables to the primitive variables of interest
<a name="l03570"></a>03570 to atmospheric flows \f$\left(\rho, u, v, p, \theta\right)\f$.
<a name="l03571"></a>03571 It also writes out the hydrostatically balanced quantities 
<a name="l03572"></a>03572 \f$\left(\rho_0,\pi_0, \theta_0\right)\f$ <span class="keywordflow">for</span> <span class="keyword">this</span> <span class="keywordflow">case</span> that
<a name="l03573"></a>03573 can be <a class="code" href="a00032.html#aa2f9253c1a63124e53d64db71f7e7c16">used</a> to compute and plot the temperature and density
<a name="l03574"></a>03574 perturbations. These variables are then written to either
<a name="l03575"></a>03575 a tecplot2d or <a class="code" href="a00031.html#a314f90bacf496961ff4bfef89fea32c0">text</a> file.
<a name="l03576"></a>03576 (compile and run it in the run directory):
<a name="l03577"></a>03577 \include 2D/<a class="code" href="a00021.html" title="Structure containing variables and parameters specific to the 2D Navier Stokes equations...">NavierStokes2D</a>/InertiaGravityWave_PETSc_IMEX/aux/PostProcess.c
<a name="l03578"></a>03578 
<a name="l03579"></a>03579 The following plot shows the potential temperature perturbation
<a name="l03580"></a>03580 contours at the <span class="keyword">final</span> time t=3000. It was plotted <span class="keyword">using</span> VisIt
<a name="l03581"></a>03581 (https:<span class="comment">//wci.llnl.gov/simulation/computer-codes/visit/) with </span>
<a name="l03582"></a>03582 tecplot2d format chosen in the above postprocessing code.
<a name="l03583"></a>03583 @image html Solution_2DNavStokIGWavePETSc.png
<a name="l03584"></a>03584 
<a name="l03585"></a>03585 The file &lt;B&gt;function_counts.dat&lt;/B&gt; reports the computational expense
<a name="l03586"></a>03586 (in terms of the number of function counts):
<a name="l03587"></a>03587 \include 2D/<a class="code" href="a00021.html" title="Structure containing variables and parameters specific to the 2D Navier Stokes equations...">NavierStokes2D</a>/InertiaGravityWave_PETSc_IMEX/function_counts.dat
<a name="l03588"></a>03588 The numbers are, respectively,
<a name="l03589"></a>03589 + Time iterations
<a name="l03590"></a>03590 + Number of times the hyperbolic term was evaluated
<a name="l03591"></a>03591 + Number of times the parabolic term was evaluated
<a name="l03592"></a>03592 + Number of times the source term was evaluated
<a name="l03593"></a>03593 + Number of calls to the <span class="keyword">explicit</span> right-hand-side function (<a class="code" href="a00046.html#ac7d9b0a219eb22bfd37482b741bd79c9">PetscRHSFunctionIMEX</a>() or <a class="code" href="a00046.html#ac67533553372ed2b44b32d095c775f5c">PetscRHSFunctionExpl</a>())
<a name="l03594"></a>03594 + Number of calls to the implicit right-hand-side function (<a class="code" href="a00046.html#a9d093c3140369a1178dd5b9589a926b1">PetscIFunctionIMEX</a>() or <a class="code" href="a00046.html#a91eb21ee4374b79a74f413d926344d7e">PetscRHSFunctionImpl</a>())
<a name="l03595"></a>03595 + Number of calls to the Jacobian (<a class="code" href="a00046.html#a82aacb94c1481144ce3e43d40d1f04d4">PetscIJacobianIMEX</a>() or <a class="code" href="a00046.html#a3d6a695a879ec54937525109ac912355">PetscIJacobian</a>())
<a name="l03596"></a>03596 + Number of calls to the matrix-free Jacobian function (<a class="code" href="a00046.html#a8778c346e27f42f0583c63909c2ea544">PetscJacobianFunctionIMEX_Linear</a>(), <a class="code" href="a00046.html#a4edf057726501be3e8fe54e16fafe07b">PetscJacobianFunctionIMEX_JFNK</a>(), <a class="code" href="a00046.html#a68f5a93a79d56fcb964224f649af4ac9">PetscJacobianFunction_JFNK</a>(), or <a class="code" href="a00046.html#abed41de2efef801be98f8338aa2672f2">PetscJacobianFunction_Linear</a>()).
<a name="l03597"></a>03597 
<a name="l03598"></a>03598 Expected screen output:
<a name="l03599"></a>03599 \include 2D/<a class="code" href="a00021.html" title="Structure containing variables and parameters specific to the 2D Navier Stokes equations...">NavierStokes2D</a>/InertiaGravityWave_PETSc_IMEX/output.log
<a name="l03600"></a>03600 
<a name="l03601"></a>03601 
<a name="l03602"></a>03602 
<a name="l03603"></a>03603 \<a class="code" href="a00032.html#a23a77f360d9ab0a90b11ff01314b6526">page</a> <a class="code" href="a00031.html#adce7dbbe4ce9816c5e3eb703768dbb9e">ib_examples</a> Immersed Boundaries <a class="code" href="a00031.html#a60f502575a2e782807ea78c05f76ae03">Examples</a>
<a name="l03604"></a>03604 
<a name="l03605"></a>03605 The following are some examples are use the immersed boundary methodology to solve the PDE in the presence of
<a name="l03606"></a>03606 various geometries. To use the immersed boundary implementation in <a class="code" href="a00015.html" title="Structure containing all solver-specific variables and functions.">HyPar</a>, an STL (https:<span class="comment">//en.wikipedia.org/wiki/STL_%28file_format%29) </span>
<a name="l03607"></a>03607 representation of the immersed body is necessary. <a class="code" href="a00032.html#a86616b1951d3af95df5b7115dd30438f">Note</a>:
<a name="l03608"></a>03608 + The immersed boundary method is \b only implemented <span class="keywordflow">for</span> 3-dimensional simulations (#<a class="code" href="a00015.html#a484873c74138512e41bc50d17b7d955a">HyPar::ndims</a> = 3).
<a name="l03609"></a>03609 + It can be <a class="code" href="a00032.html#aa2f9253c1a63124e53d64db71f7e7c16">used</a> with only those physical models that define an immersed boundary implementation (#<a class="code" href="a00015.html#a0d9d4a968c52356bd63f45ad76112245">HyPar::IBFunction</a>()), <span class="keywordflow">for</span>
<a name="l03610"></a>03610   example, the 3D Navier-Stokes equations (<a class="code" href="a00284.html#a7420691d461963f76073899aa8f55e0e">NavierStokes3DImmersedBoundary</a>()).
<a name="l03611"></a>03611 
<a name="l03612"></a>03612 3D Navier-Stokes Equations:
<a name="l03613"></a>03613 ---------------------------
<a name="l03614"></a>03614 
<a name="l03615"></a>03615 \subpage ns3d_cylinder_steady_incompressible_viscous \n
<a name="l03616"></a>03616 \subpage ns3d_cylinder_unsteady_incompressible_viscous
<a name="l03617"></a>03617 
<a name="l03618"></a>03618 \subpage ns3d_shock_cylinder_interaction
<a name="l03619"></a>03619 
<a name="l03620"></a>03620 \subpage ns3d_sphere_steady_incompressible_viscous
<a name="l03621"></a>03621 
<a name="l03622"></a>03622 \<a class="code" href="a00032.html#a23a77f360d9ab0a90b11ff01314b6526">page</a> ns3d_cylinder_steady_incompressible_viscous Steady, incompressible, viscous flow around a cylinder
<a name="l03623"></a>03623 
<a name="l03624"></a>03624 <a class="code" href="a00031.html#af7342acc7b7299a81e83b43ed11b9f84">Location</a>: \b hypar/<a class="code" href="a00031.html#a60f502575a2e782807ea78c05f76ae03">Examples</a>/3D/<a class="code" href="a00022.html" title="Structure containing variables and parameters specific to the 3D Navier Stokes equations...">NavierStokes3D</a>/2D_Cylinder/Steady_Viscous_Incompressible
<a name="l03625"></a>03625 
<a name="l03626"></a>03626 Governing equations: 3D Navier-Stokes Equations (navierstokes3d.h)
<a name="l03627"></a>03627 
<a name="l03628"></a>03628 <a class="code" href="a00031.html#a948095327123305f3fdf2b293b55381e">Domain</a>: The domain consists of a fine uniform grid around the cylinder defined <a class="code" href="a00032.html#a124150da8eed3d9f42e9361cc143ed7e">by</a> [-2,6] X [-2,2],
<a name="l03629"></a>03629         and a stretched grid beyond <span class="keyword">this</span> zone.
<a name="l03630"></a>03630 \b <a class="code" href="a00032.html#a86616b1951d3af95df5b7115dd30438f">Note</a>: This is a 2D flow simulated <span class="keyword">using</span> a 3-dimensional setup <a class="code" href="a00032.html#a124150da8eed3d9f42e9361cc143ed7e">by</a> taking the length of the
<a name="l03631"></a>03631          domain along \a z to be very small and with only 3 grid points (the domain size along \a z
<a name="l03632"></a>03632          \b must \b be smaller than the cylinder length).
<a name="l03633"></a>03633 
<a name="l03634"></a>03634 Geometry: A cylinder of radius 1.0 centered at (0,0)
<a name="l03635"></a>03635           (\b hypar/<a class="code" href="a00031.html#a60f502575a2e782807ea78c05f76ae03">Examples</a>/STLGeometries/cylinder.stl)
<a name="l03636"></a>03636 
<a name="l03637"></a>03637 The following images shows the grid and the cylinder:
<a name="l03638"></a>03638 @image html Domain3D_Cylinder.png
<a name="l03639"></a>03639 @image html Domain2D_Cylinder.png
<a name="l03640"></a>03640 
<a name="l03641"></a>03641 Boundary <a class="code" href="a00063.html#a07bca284db2938db7ad469438892ca47">conditions</a>:
<a name="l03642"></a>03642   + xmin: Subsonic inflow #<a class="code" href="a00037.html#adba2024137894c96339af50efabe3771">_SUBSONIC_INFLOW_</a>
<a name="l03643"></a>03643   + xmax: Subsonic outflow #<a class="code" href="a00037.html#adeb38801d1b832ce3eee3ebc1eed6263">_SUBSONIC_OUTFLOW_</a>
<a name="l03644"></a>03644   + ymin and ymax: Subsonic <span class="stringliteral">&quot;ambivalent&quot;</span> #<a class="code" href="a00037.html#aac7250bf34e60e7df688d3cf7355855c">_SUBSONIC_AMBIVALENT_</a>
<a name="l03645"></a>03645   + zmin and zmax: Periodic #<a class="code" href="a00037.html#a65ffa4253dee762c65092abcf04ecdee">_PERIODIC_</a> (to simulate a 2D flow in the x-y plane)
<a name="l03646"></a>03646 
<a name="l03647"></a>03647 Reference:
<a name="l03648"></a>03648   + Taneda, S., <span class="stringliteral">&quot;Experimental Investigation of the Wakes behind Cylinders and Plates at Low </span>
<a name="l03649"></a>03649 <span class="stringliteral">    Reynolds Numbers,&quot;</span> Journal of the Physical Society of Japan, Vol. 11, 302–307, 1956. 
<a name="l03650"></a>03650   + Dennis, S. C. R., Chang, G.-Z., <span class="stringliteral">&quot;Numerical solutions for steady flow past a circular</span>
<a name="l03651"></a>03651 <span class="stringliteral">    cylinder at Reynolds numbers up to 100&quot;</span>, Journal of Fluid Mechanics, 42 (3), 1970,
<a name="l03652"></a>03652     pp. 471-489.
<a name="l03653"></a>03653 
<a name="l03654"></a>03654 Initial solution: \f$\rho=1, u=0.1, v=w=0, p=1/\gamma\f$ everywhere in the domain.
<a name="l03655"></a>03655 
<a name="l03656"></a>03656 Other parameters (all dimensional quantities are in SI units):
<a name="l03657"></a>03657   + Specific heat ratio \f$\gamma = 1.4\f$ (#<a class="code" href="a00022.html#a72f9e01745b3a8203067ab84aefc9aea">NavierStokes3D::gamma</a>)
<a name="l03658"></a>03658   + Freestream Mach number \f$M_{\infty} = 0.1\f$ (#<a class="code" href="a00022.html#aa5f774fe7b4f69be5e085f1988ef2a6d">NavierStokes3D::Minf</a>)
<a name="l03659"></a>03659   + Prandlt number \f$Pr = 0.72\f$ (#<a class="code" href="a00022.html#af0f6e03342b9eb912e25f94ce0249a2c">NavierStokes3D::Pr</a>)
<a name="l03660"></a>03660   + Reynolds number \f$Re = \frac {\rho u L } {\mu} = 10,15,20\f$ (#<a class="code" href="a00022.html#a3b92a4b98cedf64473b3c13dfa7674b4">NavierStokes3D::Re</a>) (\b <a class="code" href="a00032.html#a86616b1951d3af95df5b7115dd30438f">Note</a>: 
<a name="l03661"></a>03661     since the diameter of the cylinder is 2.0, the cylinder-diameter-based Reynolds number is 
<a name="l03662"></a>03662     \f$Re_D = 2Re = 20,30,40\f$.
<a name="l03663"></a>03663 
<a name="l03664"></a>03664 Numerical Method:
<a name="l03665"></a>03665  + Spatial discretization (hyperbolic): 5th order WENO (<a class="code" href="a00041.html#af2195885ad055989a1b2b11655843343" title="5th order WENO reconstruction (component-wise) on a uniform grid">Interp1PrimFifthOrderWENO</a>())
<a name="l03666"></a>03666  + Spatial discretization (parabolic) : 4th order (<a class="code" href="a00038.html#a08c28e6bc4493172df7b7867e1f3d815">FirstDerivativeFourthOrderCentral</a>()) 
<a name="l03667"></a>03667                                         non-conservative 2-stage (<a class="code" href="a00285.html#afddc08f58a2046af9ebcc82d06efccb5">NavierStokes3DParabolicFunction</a>())
<a name="l03668"></a>03668  + Time integration: RK4 (TimeRK(), #<a class="code" href="a00061.html#a47de987716954223b3c26bb842b21bf8">_RK_44_</a>)
<a name="l03669"></a>03669 
<a name="l03670"></a>03670 Input files <a class="code" href="a00032.html#af7a1b4a66a5b6f9ac8eebf2c23b51e9e">required</a>:
<a name="l03671"></a>03671 ---------------------
<a name="l03672"></a>03672 
<a name="l03673"></a>03673 These files are all located in: \b hypar/<a class="code" href="a00031.html#a60f502575a2e782807ea78c05f76ae03">Examples</a>/3D/<a class="code" href="a00022.html" title="Structure containing variables and parameters specific to the 3D Navier Stokes equations...">NavierStokes3D</a>/2D_Cylinder/Steady_Viscous_Incompressible/
<a name="l03674"></a>03674 
<a name="l03675"></a>03675 \b solver.inp
<a name="l03676"></a>03676 \include 3D/<a class="code" href="a00022.html" title="Structure containing variables and parameters specific to the 3D Navier Stokes equations...">NavierStokes3D</a>/2D_Cylinder/Steady_Viscous_Incompressible/solver.inp
<a name="l03677"></a>03677 
<a name="l03678"></a>03678 \b boundary.inp
<a name="l03679"></a>03679 \include 3D/<a class="code" href="a00022.html" title="Structure containing variables and parameters specific to the 3D Navier Stokes equations...">NavierStokes3D</a>/2D_Cylinder/Steady_Viscous_Incompressible/boundary.inp
<a name="l03680"></a>03680 
<a name="l03681"></a>03681 \b physics.inp : The following file specifies a Reynolds number
<a name="l03682"></a>03682 of 10 (corresponding to \f$Re_D\f$ of 20). To try other Reynolds 
<a name="l03683"></a>03683 numbers, change it here.
<a name="l03684"></a>03684 \include 3D/<a class="code" href="a00022.html" title="Structure containing variables and parameters specific to the 3D Navier Stokes equations...">NavierStokes3D</a>/2D_Cylinder/Steady_Viscous_Incompressible/physics.inp
<a name="l03685"></a>03685 
<a name="l03686"></a>03686 \b cylinder.stl : the filename <span class="stringliteral">&quot;cylinder.stl&quot;</span> \b must match
<a name="l03687"></a>03687 the input for \a immersed_body in \a solver.inp.\n
<a name="l03688"></a>03688 Located at \b hypar/<a class="code" href="a00031.html#a60f502575a2e782807ea78c05f76ae03">Examples</a>/STLGeometries/cylinder.stl
<a name="l03689"></a>03689 
<a name="l03690"></a>03690 To generate \b initial.inp (initial solution), compile 
<a name="l03691"></a>03691 and run the following code in the run directory.
<a name="l03692"></a>03692 \include 3D/<a class="code" href="a00022.html" title="Structure containing variables and parameters specific to the 3D Navier Stokes equations...">NavierStokes3D</a>/2D_Cylinder/Steady_Viscous_Incompressible/aux/init.c
<a name="l03693"></a>03693 
<a name="l03694"></a>03694 Output:
<a name="l03695"></a>03695 -------
<a name="l03696"></a>03696 
<a name="l03697"></a>03697 <a class="code" href="a00032.html#a86616b1951d3af95df5b7115dd30438f">Note</a> that \b iproc is set to 
<a name="l03698"></a>03698 
<a name="l03699"></a>03699       2 2 1
<a name="l03700"></a>03700 
<a name="l03701"></a>03701 in \b solver.inp (i.e., 2 processors along \a x, 2
<a name="l03702"></a>03702 processors along \a y, and 1 processor along \a z). Thus, 
<a name="l03703"></a>03703 this example should be run with 4 MPI ranks (or change \b iproc).
<a name="l03704"></a>03704 
<a name="l03705"></a>03705 After running the code, there should be one output file
<a name="l03706"></a>03706 \b op.bin, since #HyPar::op_overwrite is set to \a yes in \b solver.inp.
<a name="l03707"></a>03707 #HyPar::op_file_format is set to \a binary in \b solver.inp, and
<a name="l03708"></a>03708 thus, all the files are written out in the binary format, see 
<a name="l03709"></a>03709 <a class="code" href="a00042.html#a067f454c26d85d6cfb4d7d878b3783c9">WriteBinary</a>(). The binary file contains the conserved variables
<a name="l03710"></a>03710 \f$\left(\rho, \rho u, \rho v, e\right)\f$. The following two codes
<a name="l03711"></a>03711 are available to convert the binary output file:
<a name="l03712"></a>03712 + \b hypar/Extras/BinaryToTecplot.c - convert binary output file to 
<a name="l03713"></a>03713   Tecplot file.
<a name="l03714"></a>03714 + \b hypar/Extras/BinaryToText.c - convert binary output file to
<a name="l03715"></a>03715   an ASCII <a class="code" href="a00031.html#a314f90bacf496961ff4bfef89fea32c0">text</a> file (to visualize in, for example, MATLAB).
<a name="l03716"></a>03716 
<a name="l03717"></a>03717 The file \b Extras/ExtractSlice.c can be <a class="code" href="a00032.html#aa2f9253c1a63124e53d64db71f7e7c16">used</a> to extract a slice perpendicular to any dimension
<a name="l03718"></a>03718 at a <a class="code" href="a00032.html#aa18752ebe19b49b626048c92d4586801">specified</a> location along that dimension. The extracted slice is written out in the same
<a name="l03719"></a>03719 binary format as the original solutions files (with the same names op_xxxxx.bin) in a 
<a name="l03720"></a>03720 subdirectory called \b slices (\b <a class="code" href="a00032.html#a86616b1951d3af95df5b7115dd30438f">Note</a>: make the subdirectory called \a slices before running
<a name="l03721"></a>03721 this code). The codes Extras/BinaryToTecplot.c and Extras/BinaryToText.c
<a name="l03722"></a>03722 can then be <a class="code" href="a00032.html#aa2f9253c1a63124e53d64db71f7e7c16">used</a> (in the \b slices subdirectory) to convert the binary slice solution file
<a name="l03723"></a>03723 to Tecplot or plain <a class="code" href="a00031.html#a314f90bacf496961ff4bfef89fea32c0">text</a> files.
<a name="l03724"></a>03724 \b <a class="code" href="a00032.html#a86616b1951d3af95df5b7115dd30438f">Note</a> that it needs the relevant \b solver.inp that can be created as follows:
<a name="l03725"></a>03725 + Copy the original solver.inp to the slices subdirectory.
<a name="l03726"></a>03726 + In solver.inp, set \b ndims as \b 2, and remove the component of \b size and \b iproc 
<a name="l03727"></a>03727   corresponding to the dimension being eliminated while extracting the slices (in this case,
<a name="l03728"></a>03728   it is \a z or the 3rd component).
<a name="l03729"></a>03729 
<a name="l03730"></a>03730 The following figure shows the flow (density and streamlines) at \f$Re_D=20\f$:
<a name="l03731"></a>03731 @image html Solution_3DNavStokCylinder_ReD020.png
<a name="l03732"></a>03732 The parameter \a Re can be changed to 20 in \a physics.inp to run this simulation for
<a name="l03733"></a>03733 \f$Re_D=40\f$, and following figure shows the solution:
<a name="l03734"></a>03734 @image html Solution_3DNavStokCylinder_ReD040.png
<a name="l03735"></a>03735 
<a name="l03736"></a>03736 The following plot shows the wake length (\f$L/D\f$) as a function of the Reynolds
<a name="l03737"></a>03737 number (\f$Re_D\f$) for the computed solutions and experimental results reported
<a name="l03738"></a>03738 in the reference above:
<a name="l03739"></a>03739 @image html Solution_3DNavStokCylinder_WL.png
<a name="l03740"></a>03740 
<a name="l03741"></a>03741 In <a class="code" href="a00032.html#acd2d71c0bebc6551f6d5d3c2870a9baa">addition</a> to the <a class="code" href="a00157.html#a3c04138a5bfe5d72780bb7e82a18e627" title="Main driver.">main</a> solution, the code also writes out a file with the aerodynamic
<a name="l03742"></a>03742 forces on the immersed body. This file is called \a surface.<a class="code" href="a00031.html#a96b9dfbebc4ecd57a32426075fb0c3f2">dat</a> (if #HyPar::op_overwrite
<a name="l03743"></a>03743 is <span class="stringliteral">&quot;yes&quot;</span>) or \a surface_nnnnn.<a class="code" href="a00031.html#a96b9dfbebc4ecd57a32426075fb0c3f2">dat</a> (if #HyPar::op_overwrite is <span class="stringliteral">&quot;no&quot;</span>, <span class="stringliteral">&quot;nnnnn&quot;</span> is a numerical
<a name="l03744"></a>03744 index) (in this example, the file \b surface.<a class="code" href="a00031.html#a96b9dfbebc4ecd57a32426075fb0c3f2">dat</a> is written out). This is an ASCII file in 
<a name="l03745"></a>03745 the Tecplot format, where the immersed body and the forces on it are represented using the 
<a name="l03746"></a>03746 <span class="stringliteral">&quot;FETRIANGLE&quot;</span> type. The following image shows the surface <a class="code" href="a00032.html#a58d87a94271c7f86a36fafc7117fe0b0">pressure</a> on the cylinder (front-view):
<a name="l03747"></a>03747 @image html IBSurface_3DNavStokCylinder.png
<a name="l03748"></a>03748 Since this is a 2D simulation, the <a class="code" href="a00032.html#aadd5786eddf29a076126f4201bb7c244">value</a> of the surface <a class="code" href="a00032.html#a58d87a94271c7f86a36fafc7117fe0b0">pressure</a> on the end-surfaces of the 
<a name="l03749"></a>03749 cylinder (zmin and zmax) are not physically relevant.
<a name="l03750"></a>03750 
<a name="l03751"></a>03751 Expected screen output (for \f$Re_D = 20\f$):
<a name="l03752"></a>03752 \include 3D/<a class="code" href="a00022.html" title="Structure containing variables and parameters specific to the 3D Navier Stokes equations...">NavierStokes3D</a>/2D_Cylinder/Steady_Viscous_Incompressible/output.log
<a name="l03753"></a>03753 
<a name="l03754"></a>03754   
<a name="l03755"></a>03755 \<a class="code" href="a00032.html#a23a77f360d9ab0a90b11ff01314b6526">page</a> ns3d_cylinder_unsteady_incompressible_viscous Unsteady, incompressible, viscous flow around a cylinder (vortex shedding)
<a name="l03756"></a>03756 
<a name="l03757"></a>03757 <a class="code" href="a00031.html#af7342acc7b7299a81e83b43ed11b9f84">Location</a>: \b hypar/<a class="code" href="a00031.html#a60f502575a2e782807ea78c05f76ae03">Examples</a>/3D/<a class="code" href="a00022.html" title="Structure containing variables and parameters specific to the 3D Navier Stokes equations...">NavierStokes3D</a>/2D_Cylinder/Unsteady_Viscous_Incompressible
<a name="l03758"></a>03758 
<a name="l03759"></a>03759 Governing equations: 3D Navier-Stokes Equations (navierstokes3d.h)
<a name="l03760"></a>03760 
<a name="l03761"></a>03761 <a class="code" href="a00031.html#a948095327123305f3fdf2b293b55381e">Domain</a>: The domain consists of a fine uniform grid around the cylinder defined <a class="code" href="a00032.html#a124150da8eed3d9f42e9361cc143ed7e">by</a> [-4,12] X [-2,2],
<a name="l03762"></a>03762         and a stretched grid beyond this zone.
<a name="l03763"></a>03763 \b <a class="code" href="a00032.html#a86616b1951d3af95df5b7115dd30438f">Note</a>: This is a 2D flow simulated using a 3-dimensional setup <a class="code" href="a00032.html#a124150da8eed3d9f42e9361cc143ed7e">by</a> taking the length of the
<a name="l03764"></a>03764          domain along \a z to be very small and with only 3 grid points (the domain size along \a z
<a name="l03765"></a>03765          \b must \b be smaller than the cylinder length).
<a name="l03766"></a>03766 
<a name="l03767"></a>03767 Geometry: A cylinder of radius 1.0 centered at (0,0)
<a name="l03768"></a>03768           (\b hypar/<a class="code" href="a00031.html#a60f502575a2e782807ea78c05f76ae03">Examples</a>/STLGeometries/cylinder.stl)
<a name="l03769"></a>03769 
<a name="l03770"></a>03770 The following images shows the grid and the cylinder:
<a name="l03771"></a>03771 @image html Domain3D_Cylinder2.png
<a name="l03772"></a>03772 @image html Domain2D_Cylinder2.png
<a name="l03773"></a>03773 
<a name="l03774"></a>03774 Boundary <a class="code" href="a00063.html#a07bca284db2938db7ad469438892ca47">conditions</a>:
<a name="l03775"></a>03775   + xmin: Subsonic inflow #<a class="code" href="a00037.html#adba2024137894c96339af50efabe3771">_SUBSONIC_INFLOW_</a>
<a name="l03776"></a>03776   + xmax: Subsonic outflow #<a class="code" href="a00037.html#adeb38801d1b832ce3eee3ebc1eed6263">_SUBSONIC_OUTFLOW_</a>
<a name="l03777"></a>03777   + ymin and ymax: Subsonic <span class="stringliteral">&quot;ambivalent&quot;</span> #<a class="code" href="a00037.html#aac7250bf34e60e7df688d3cf7355855c">_SUBSONIC_AMBIVALENT_</a>
<a name="l03778"></a>03778   + zmin and zmax: Periodic #<a class="code" href="a00037.html#a65ffa4253dee762c65092abcf04ecdee">_PERIODIC_</a> (to simulate a 2D flow in the x-y plane)
<a name="l03779"></a>03779 
<a name="l03780"></a>03780 Reference:
<a name="l03781"></a>03781   + Taneda, S., <span class="stringliteral">&quot;Experimental Investigation of the Wakes behind Cylinders and Plates at Low </span>
<a name="l03782"></a>03782 <span class="stringliteral">    Reynolds Numbers,&quot;</span> Journal of the Physical Society of Japan, Vol. 11, 302–307, 1956. 
<a name="l03783"></a>03783 
<a name="l03784"></a>03784 Initial solution: \f$\rho=1, u=0.1, v=w=0, p=1/\gamma\f$ everywhere in the domain.
<a name="l03785"></a>03785 
<a name="l03786"></a>03786 Other parameters (all dimensional quantities are in SI units):
<a name="l03787"></a>03787   + Specific heat ratio \f$\gamma = 1.4\f$ (#<a class="code" href="a00022.html" title="Structure containing variables and parameters specific to the 3D Navier Stokes equations...">NavierStokes3D</a>::gamma)
<a name="l03788"></a>03788   + Freestream Mach number \f$M_{\infty} = 0.1\f$ (#<a class="code" href="a00022.html#aa5f774fe7b4f69be5e085f1988ef2a6d">NavierStokes3D::Minf</a>)
<a name="l03789"></a>03789   + Prandlt number \f$Pr = 0.72\f$ (#<a class="code" href="a00022.html#af0f6e03342b9eb912e25f94ce0249a2c">NavierStokes3D::Pr</a>)
<a name="l03790"></a>03790   + Reynolds number \f$Re = \frac {\rho u L } {\mu} = 50\f$ (#<a class="code" href="a00022.html#a3b92a4b98cedf64473b3c13dfa7674b4">NavierStokes3D::Re</a>) (\b <a class="code" href="a00032.html#a86616b1951d3af95df5b7115dd30438f">Note</a>: 
<a name="l03791"></a>03791     since the diameter of the cylinder is 2.0, the cylinder-diameter-based Reynolds number is 
<a name="l03792"></a>03792     \f$Re_D = 2Re = 100\f$.
<a name="l03793"></a>03793 
<a name="l03794"></a>03794 Numerical Method:
<a name="l03795"></a>03795  + Spatial discretization (hyperbolic): 5th order WENO (<a class="code" href="a00041.html#af2195885ad055989a1b2b11655843343" title="5th order WENO reconstruction (component-wise) on a uniform grid">Interp1PrimFifthOrderWENO</a>())
<a name="l03796"></a>03796  + Spatial discretization (parabolic) : 4th order (<a class="code" href="a00038.html#a08c28e6bc4493172df7b7867e1f3d815">FirstDerivativeFourthOrderCentral</a>()) 
<a name="l03797"></a>03797                                         non-conservative 2-stage (<a class="code" href="a00285.html#afddc08f58a2046af9ebcc82d06efccb5">NavierStokes3DParabolicFunction</a>())
<a name="l03798"></a>03798  + Time integration: RK4 (TimeRK(), #<a class="code" href="a00061.html#a47de987716954223b3c26bb842b21bf8">_RK_44_</a>)
<a name="l03799"></a>03799 
<a name="l03800"></a>03800 Input files <a class="code" href="a00032.html#af7a1b4a66a5b6f9ac8eebf2c23b51e9e">required</a>:
<a name="l03801"></a>03801 ---------------------
<a name="l03802"></a>03802 
<a name="l03803"></a>03803 These files are all located in: \b hypar/<a class="code" href="a00031.html#a60f502575a2e782807ea78c05f76ae03">Examples</a>/3D/<a class="code" href="a00022.html" title="Structure containing variables and parameters specific to the 3D Navier Stokes equations...">NavierStokes3D</a>/2D_Cylinder/Unsteady_Viscous_Incompressible/
<a name="l03804"></a>03804 
<a name="l03805"></a>03805 \b solver.inp
<a name="l03806"></a>03806 \include 3D/<a class="code" href="a00022.html" title="Structure containing variables and parameters specific to the 3D Navier Stokes equations...">NavierStokes3D</a>/2D_Cylinder/Unsteady_Viscous_Incompressible/solver.inp
<a name="l03807"></a>03807 
<a name="l03808"></a>03808 \b boundary.inp
<a name="l03809"></a>03809 \include 3D/<a class="code" href="a00022.html" title="Structure containing variables and parameters specific to the 3D Navier Stokes equations...">NavierStokes3D</a>/2D_Cylinder/Unsteady_Viscous_Incompressible/boundary.inp
<a name="l03810"></a>03810 
<a name="l03811"></a>03811 \b physics.inp
<a name="l03812"></a>03812 \include 3D/<a class="code" href="a00022.html" title="Structure containing variables and parameters specific to the 3D Navier Stokes equations...">NavierStokes3D</a>/2D_Cylinder/Unsteady_Viscous_Incompressible/physics.inp
<a name="l03813"></a>03813 
<a name="l03814"></a>03814 \b cylinder.stl : the filename <span class="stringliteral">&quot;cylinder.stl&quot;</span> \b must match
<a name="l03815"></a>03815 the input for \a immersed_body in \a solver.inp.\n
<a name="l03816"></a>03816 Located at \b hypar/<a class="code" href="a00031.html#a60f502575a2e782807ea78c05f76ae03">Examples</a>/STLGeometries/cylinder.stl
<a name="l03817"></a>03817 
<a name="l03818"></a>03818 To generate \b initial.inp (initial solution), compile 
<a name="l03819"></a>03819 and run the following code in the run directory.
<a name="l03820"></a>03820 \include 3D/<a class="code" href="a00022.html" title="Structure containing variables and parameters specific to the 3D Navier Stokes equations...">NavierStokes3D</a>/2D_Cylinder/Unsteady_Viscous_Incompressible/aux/init.c
<a name="l03821"></a>03821 
<a name="l03822"></a>03822 Output:
<a name="l03823"></a>03823 -------
<a name="l03824"></a>03824 
<a name="l03825"></a>03825 <a class="code" href="a00032.html#a86616b1951d3af95df5b7115dd30438f">Note</a> that \b iproc is set to 
<a name="l03826"></a>03826 
<a name="l03827"></a>03827       4 2 1
<a name="l03828"></a>03828 
<a name="l03829"></a>03829 in \b solver.inp (i.e., 4 processors along \a x, 2
<a name="l03830"></a>03830 processors along \a y, and 1 processor along \a z). Thus, 
<a name="l03831"></a>03831 this example should be run with 8 MPI ranks (or change \b iproc).
<a name="l03832"></a>03832 
<a name="l03833"></a>03833 After running the code, there should be 401 solution files \b op_00000.bin, 
<a name="l03834"></a>03834 \b op_00001.bin, ..., \b op_00400.bin. Since #HyPar::op_overwrite is set to 
<a name="l03835"></a>03835 \a no in \b solver.inp, separate files are written for solutions at each
<a name="l03836"></a>03836 output time.
<a name="l03837"></a>03837 #HyPar::op_file_format is set to \a binary in \b solver.inp, and
<a name="l03838"></a>03838 thus, all the files are written out in the binary format, see 
<a name="l03839"></a>03839 <a class="code" href="a00042.html#a067f454c26d85d6cfb4d7d878b3783c9">WriteBinary</a>(). The binary file contains the conserved variables
<a name="l03840"></a>03840 \f$\left(\rho, \rho u, \rho v, e\right)\f$. The following two codes
<a name="l03841"></a>03841 are available to convert the binary output file:
<a name="l03842"></a>03842 + \b hypar/Extras/BinaryToTecplot.c - convert binary output file to 
<a name="l03843"></a>03843   Tecplot file.
<a name="l03844"></a>03844 + \b hypar/Extras/BinaryToText.c - convert binary output file to
<a name="l03845"></a>03845   an ASCII <a class="code" href="a00031.html#a314f90bacf496961ff4bfef89fea32c0">text</a> file (to visualize in, for example, MATLAB).
<a name="l03846"></a>03846 
<a name="l03847"></a>03847 The file \b Extras/ExtractSlice.c can be <a class="code" href="a00032.html#aa2f9253c1a63124e53d64db71f7e7c16">used</a> to extract a slice perpendicular to any dimension
<a name="l03848"></a>03848 at a <a class="code" href="a00032.html#aa18752ebe19b49b626048c92d4586801">specified</a> location along that dimension. The extracted slice is written out in the same
<a name="l03849"></a>03849 binary format as the original solutions files (with the same names op_xxxxx.bin) in a 
<a name="l03850"></a>03850 subdirectory called \b slices (\b <a class="code" href="a00032.html#a86616b1951d3af95df5b7115dd30438f">Note</a>: make the subdirectory called \a slices before running
<a name="l03851"></a>03851 this code). The codes Extras/BinaryToTecplot.c and Extras/BinaryToText.c
<a name="l03852"></a>03852 can then be <a class="code" href="a00032.html#aa2f9253c1a63124e53d64db71f7e7c16">used</a> (in the \b slices subdirectory) to convert the binary slice solution file
<a name="l03853"></a>03853 to Tecplot or plain <a class="code" href="a00031.html#a314f90bacf496961ff4bfef89fea32c0">text</a> files.
<a name="l03854"></a>03854 \b <a class="code" href="a00032.html#a86616b1951d3af95df5b7115dd30438f">Note</a> that it needs the relevant \b solver.inp that can be created as follows:
<a name="l03855"></a>03855 + Copy the original solver.inp to the slices subdirectory.
<a name="l03856"></a>03856 + In solver.inp, set \b ndims as \b 2, and remove the component of \b size and \b iproc 
<a name="l03857"></a>03857   corresponding to the dimension being eliminated while extracting the slices (in this case,
<a name="l03858"></a>03858   it is \a z or the 3rd component).
<a name="l03859"></a>03859 
<a name="l03860"></a>03860 The following animation shows the vorticity magnitude and has been created <a class="code" href="a00032.html#a124150da8eed3d9f42e9361cc143ed7e">by</a>
<a name="l03861"></a>03861 plotting op_00301.bin through op_00400.bin, and shows the vortex shedding:
<a name="l03862"></a>03862 @image html Solution_3DNavStokCylinder_Shedding.gif
<a name="l03863"></a>03863 
<a name="l03864"></a>03864 Expected screen output:
<a name="l03865"></a>03865 \include 3D/<a class="code" href="a00022.html" title="Structure containing variables and parameters specific to the 3D Navier Stokes equations...">NavierStokes3D</a>/2D_Cylinder/Unsteady_Viscous_Incompressible/output.log
<a name="l03866"></a>03866 
<a name="l03867"></a>03867   
<a name="l03868"></a>03868 \<a class="code" href="a00032.html#a23a77f360d9ab0a90b11ff01314b6526">page</a> ns3d_shock_cylinder_interaction Inviscid Shock-Cylinder Interaction 
<a name="l03869"></a>03869 
<a name="l03870"></a>03870 <a class="code" href="a00031.html#af7342acc7b7299a81e83b43ed11b9f84">Location</a>: \b hypar/<a class="code" href="a00031.html#a60f502575a2e782807ea78c05f76ae03">Examples</a>/3D/<a class="code" href="a00022.html" title="Structure containing variables and parameters specific to the 3D Navier Stokes equations...">NavierStokes3D</a>/2D_Shock_Cylinder_Interaction
<a name="l03871"></a>03871 
<a name="l03872"></a>03872 Governing equations: 3D Navier-Stokes Equations (navierstokes3d.h - <a class="code" href="a00032.html#a124150da8eed3d9f42e9361cc143ed7e">by</a> default
<a name="l03873"></a>03873                      #<a class="code" href="a00022.html" title="Structure containing variables and parameters specific to the 3D Navier Stokes equations...">NavierStokes3D</a>::Re is set to \b -1 which makes the
<a name="l03874"></a>03874                      code skip the parabolic terms, i.e., the 3D Euler
<a name="l03875"></a>03875                      equations are solved.)
<a name="l03876"></a>03876 
<a name="l03877"></a>03877 <a class="code" href="a00031.html#a948095327123305f3fdf2b293b55381e">Domain</a>: \f$-2.5 \le x \le 7.5\f$, \f$-5 \le y \le 5\f$
<a name="l03878"></a>03878 \b <a class="code" href="a00032.html#a86616b1951d3af95df5b7115dd30438f">Note</a>: This is a 2D flow simulated using a 3-dimensional setup <a class="code" href="a00032.html#a124150da8eed3d9f42e9361cc143ed7e">by</a> taking the length of the
<a name="l03879"></a>03879          domain along \a z to be very small and with only 3 grid points (the domain size along \a z
<a name="l03880"></a>03880          \b must \b be smaller than the cylinder length).
<a name="l03881"></a>03881 
<a name="l03882"></a>03882 Geometry: A cylinder of radius 1.0 centered at (0,0)
<a name="l03883"></a>03883           (\b hypar/<a class="code" href="a00031.html#a60f502575a2e782807ea78c05f76ae03">Examples</a>/STLGeometries/cylinder.stl)
<a name="l03884"></a>03884 
<a name="l03885"></a>03885 Boundary <a class="code" href="a00063.html#a07bca284db2938db7ad469438892ca47">conditions</a>:
<a name="l03886"></a>03886   + xmin: Subsonic inflow #<a class="code" href="a00037.html#adba2024137894c96339af50efabe3771">_SUBSONIC_INFLOW_</a> (with post-shock flow <a class="code" href="a00063.html#a07bca284db2938db7ad469438892ca47">conditions</a>)
<a name="l03887"></a>03887   + xmax: Supersonic inflow #<a class="code" href="a00037.html#a5a9ba63c6c48e0831e379e03a72c0047">_SUPERSONIC_OUTFLOW_</a> (with pre-shock flow <a class="code" href="a00063.html#a07bca284db2938db7ad469438892ca47">conditions</a>)
<a name="l03888"></a>03888   + ymin and ymax: Slip walls #<a class="code" href="a00037.html#af3a9f3ba15bc914ed0a88295aee147e8">_SLIP_WALL_</a>
<a name="l03889"></a>03889   + zmin and zmax: Periodic #<a class="code" href="a00037.html#a65ffa4253dee762c65092abcf04ecdee">_PERIODIC_</a> (to simulate a 2D flow in the x-y plane)
<a name="l03890"></a>03890 
<a name="l03891"></a>03891 Reference:
<a name="l03892"></a>03892 + O. Boiron, G. Chiavassa, R. Donat, A high-resolution penalization method for large Mach number 
<a name="l03893"></a>03893   flows in the presence of obstacles, Computers &amp; Fluids, 38 (2009), pp. 703-714, Section 5.1
<a name="l03894"></a>03894 
<a name="l03895"></a>03895 Initial solution: see reference
<a name="l03896"></a>03896 
<a name="l03897"></a>03897 Other parameters (all dimensional quantities are in SI units):
<a name="l03898"></a>03898   + Specific heat ratio \f$\gamma = 1.4\f$ (#<a class="code" href="a00022.html" title="Structure containing variables and parameters specific to the 3D Navier Stokes equations...">NavierStokes3D</a>::gamma)
<a name="l03899"></a>03899 
<a name="l03900"></a>03900 Numerical Method:
<a name="l03901"></a>03901  + Spatial discretization (hyperbolic): 5th order WENO (<a class="code" href="a00041.html#af2195885ad055989a1b2b11655843343" title="5th order WENO reconstruction (component-wise) on a uniform grid">Interp1PrimFifthOrderWENO</a>())
<a name="l03902"></a>03902  + Time integration: RK4 (TimeRK(), #<a class="code" href="a00061.html#a47de987716954223b3c26bb842b21bf8">_RK_44_</a>)
<a name="l03903"></a>03903 
<a name="l03904"></a>03904 Input files <a class="code" href="a00032.html#af7a1b4a66a5b6f9ac8eebf2c23b51e9e">required</a>:
<a name="l03905"></a>03905 ---------------------
<a name="l03906"></a>03906 
<a name="l03907"></a>03907 These files are all located in: \b hypar/<a class="code" href="a00031.html#a60f502575a2e782807ea78c05f76ae03">Examples</a>/3D/<a class="code" href="a00022.html" title="Structure containing variables and parameters specific to the 3D Navier Stokes equations...">NavierStokes3D</a>/2D_Shock_Cylinder_Interaction/
<a name="l03908"></a>03908 
<a name="l03909"></a>03909 \b solver.inp
<a name="l03910"></a>03910 \include 3D/<a class="code" href="a00022.html" title="Structure containing variables and parameters specific to the 3D Navier Stokes equations...">NavierStokes3D</a>/2D_Shock_Cylinder_Interaction/solver.inp
<a name="l03911"></a>03911 
<a name="l03912"></a>03912 \b boundary.inp
<a name="l03913"></a>03913 \include 3D/<a class="code" href="a00022.html" title="Structure containing variables and parameters specific to the 3D Navier Stokes equations...">NavierStokes3D</a>/2D_Shock_Cylinder_Interaction/boundary.inp
<a name="l03914"></a>03914 
<a name="l03915"></a>03915 \b physics.inp
<a name="l03916"></a>03916 \include 3D/<a class="code" href="a00022.html" title="Structure containing variables and parameters specific to the 3D Navier Stokes equations...">NavierStokes3D</a>/2D_Shock_Cylinder_Interaction/physics.inp
<a name="l03917"></a>03917 
<a name="l03918"></a>03918 \b cylinder.stl : the filename <span class="stringliteral">&quot;cylinder.stl&quot;</span> \b must match
<a name="l03919"></a>03919 the input for \a immersed_body in \a solver.inp.\n
<a name="l03920"></a>03920 Located at \b hypar/<a class="code" href="a00031.html#a60f502575a2e782807ea78c05f76ae03">Examples</a>/STLGeometries/cylinder.stl
<a name="l03921"></a>03921 
<a name="l03922"></a>03922 To generate \b initial.inp (initial solution), compile 
<a name="l03923"></a>03923 and run the following code in the run directory.
<a name="l03924"></a>03924 \include 3D/<a class="code" href="a00022.html" title="Structure containing variables and parameters specific to the 3D Navier Stokes equations...">NavierStokes3D</a>/2D_Shock_Cylinder_Interaction/aux/init.c
<a name="l03925"></a>03925 
<a name="l03926"></a>03926 Output:
<a name="l03927"></a>03927 -------
<a name="l03928"></a>03928 
<a name="l03929"></a>03929 <a class="code" href="a00032.html#a86616b1951d3af95df5b7115dd30438f">Note</a> that \b iproc is set to 
<a name="l03930"></a>03930 
<a name="l03931"></a>03931       2 2 1
<a name="l03932"></a>03932 
<a name="l03933"></a>03933 in \b solver.inp (i.e., 2 processors along \a x, 2
<a name="l03934"></a>03934 processors along \a y, and 1 processor along \a z). Thus, 
<a name="l03935"></a>03935 this example should be run with 4 MPI ranks (or change \b iproc).
<a name="l03936"></a>03936 
<a name="l03937"></a>03937 After running the code, there should be 81 solution files \b op_00000.bin 
<a name="l03938"></a>03938 (initial solution), 
<a name="l03939"></a>03939 \b op_00001.bin, ..., \b op_00080.bin (solution at t=2). 
<a name="l03940"></a>03940 Since #HyPar::op_overwrite is set to 
<a name="l03941"></a>03941 \a no in \b solver.inp, separate files are written for solutions at each
<a name="l03942"></a>03942 output time.
<a name="l03943"></a>03943 #HyPar::op_file_format is set to \a binary in \b solver.inp, and
<a name="l03944"></a>03944 thus, all the files are written out in the binary format, see 
<a name="l03945"></a>03945 <a class="code" href="a00042.html#a067f454c26d85d6cfb4d7d878b3783c9">WriteBinary</a>(). The binary file contains the conserved variables
<a name="l03946"></a>03946 \f$\left(\rho, \rho u, \rho v, e\right)\f$. The following two codes
<a name="l03947"></a>03947 are available to convert the binary output file:
<a name="l03948"></a>03948 + \b hypar/Extras/BinaryToTecplot.c - convert binary output file to 
<a name="l03949"></a>03949   Tecplot file.
<a name="l03950"></a>03950 + \b hypar/Extras/BinaryToText.c - convert binary output file to
<a name="l03951"></a>03951   an ASCII <a class="code" href="a00031.html#a314f90bacf496961ff4bfef89fea32c0">text</a> file (to visualize in, for example, MATLAB).
<a name="l03952"></a>03952 
<a name="l03953"></a>03953 The file \b Extras/ExtractSlice.c can be <a class="code" href="a00032.html#aa2f9253c1a63124e53d64db71f7e7c16">used</a> to extract a slice perpendicular to any dimension
<a name="l03954"></a>03954 at a <a class="code" href="a00032.html#aa18752ebe19b49b626048c92d4586801">specified</a> location along that dimension. The extracted slice is written out in the same
<a name="l03955"></a>03955 binary format as the original solutions files (with the same names op_xxxxx.bin) in a 
<a name="l03956"></a>03956 subdirectory called \b slices (\b <a class="code" href="a00032.html#a86616b1951d3af95df5b7115dd30438f">Note</a>: make the subdirectory called \a slices before running
<a name="l03957"></a>03957 this code). The codes Extras/BinaryToTecplot.c and Extras/BinaryToText.c
<a name="l03958"></a>03958 can then be <a class="code" href="a00032.html#aa2f9253c1a63124e53d64db71f7e7c16">used</a> (in the \b slices subdirectory) to convert the binary slice solution file
<a name="l03959"></a>03959 to Tecplot or plain <a class="code" href="a00031.html#a314f90bacf496961ff4bfef89fea32c0">text</a> files.
<a name="l03960"></a>03960 \b <a class="code" href="a00032.html#a86616b1951d3af95df5b7115dd30438f">Note</a> that it needs the relevant \b solver.inp that can be created as follows:
<a name="l03961"></a>03961 + Copy the original solver.inp to the slices subdirectory.
<a name="l03962"></a>03962 + In solver.inp, set \b ndims as \b 2, and remove the component of \b size and \b iproc 
<a name="l03963"></a>03963   corresponding to the dimension being eliminated while extracting the slices (in this case,
<a name="l03964"></a>03964   it is \a z or the 3rd component).
<a name="l03965"></a>03965 
<a name="l03966"></a>03966 The following plot shows the density contours for the final solution (t=2):
<a name="l03967"></a>03967 @image html Solution_3DNavStokShockCyl_Density.png
<a name="l03968"></a>03968 and the following is the numerical Schlieren image (contour plot of \f$\|\nabla\rho\|_2\f$):
<a name="l03969"></a>03969 @image html Solution_3DNavStokShockCyl_Schlieren.png
<a name="l03970"></a>03970 @image html Solution_3DNavStokShockCyl_Schlieren2.png
<a name="l03971"></a>03971 
<a name="l03972"></a>03972 Expected screen output:
<a name="l03973"></a>03973 \include 3D/<a class="code" href="a00022.html" title="Structure containing variables and parameters specific to the 3D Navier Stokes equations...">NavierStokes3D</a>/2D_Shock_Cylinder_Interaction/output.log
<a name="l03974"></a>03974 
<a name="l03975"></a>03975   
<a name="l03976"></a>03976 \<a class="code" href="a00032.html#a23a77f360d9ab0a90b11ff01314b6526">page</a> ns3d_sphere_steady_incompressible_viscous Steady, incompressible, viscous flow around a sphere
<a name="l03977"></a>03977 
<a name="l03978"></a>03978 <a class="code" href="a00031.html#af7342acc7b7299a81e83b43ed11b9f84">Location</a>: \b hypar/<a class="code" href="a00031.html#a60f502575a2e782807ea78c05f76ae03">Examples</a>/3D/<a class="code" href="a00022.html" title="Structure containing variables and parameters specific to the 3D Navier Stokes equations...">NavierStokes3D</a>/Sphere/Steady_Viscous_Incompressible
<a name="l03979"></a>03979 
<a name="l03980"></a>03980 Governing equations: 3D Navier-Stokes Equations (navierstokes3d.h)
<a name="l03981"></a>03981 
<a name="l03982"></a>03982 <a class="code" href="a00031.html#a948095327123305f3fdf2b293b55381e">Domain</a>: The domain consists of a fine uniform grid around the sphere defined <a class="code" href="a00032.html#a124150da8eed3d9f42e9361cc143ed7e">by</a> [-2,6] X [-2,2] X [-2,2],
<a name="l03983"></a>03983         and a stretched grid beyond this zone.
<a name="l03984"></a>03984 
<a name="l03985"></a>03985 Geometry: A sphere of radius 0.5 centered at (0,0)
<a name="l03986"></a>03986           (\b hypar/<a class="code" href="a00031.html#a60f502575a2e782807ea78c05f76ae03">Examples</a>/STLGeometries/sphere.stl)
<a name="l03987"></a>03987 
<a name="l03988"></a>03988 The following image shows the sphere:
<a name="l03989"></a>03989 @image html Surface3D_Sphere.png
<a name="l03990"></a>03990 
<a name="l03991"></a>03991 The following images shows the grid and the sphere:
<a name="l03992"></a>03992 @image html Domain3D_Sphere1.png
<a name="l03993"></a>03993 @image html Domain3D_Sphere2.png
<a name="l03994"></a>03994 
<a name="l03995"></a>03995 Boundary <a class="code" href="a00063.html#a07bca284db2938db7ad469438892ca47">conditions</a>:
<a name="l03996"></a>03996   + xmin: Subsonic inflow #<a class="code" href="a00037.html#adba2024137894c96339af50efabe3771">_SUBSONIC_INFLOW_</a>
<a name="l03997"></a>03997   + xmax: Subsonic outflow #<a class="code" href="a00037.html#adeb38801d1b832ce3eee3ebc1eed6263">_SUBSONIC_OUTFLOW_</a>
<a name="l03998"></a>03998   + ymin and ymax: Subsonic <span class="stringliteral">&quot;ambivalent&quot;</span> #<a class="code" href="a00037.html#aac7250bf34e60e7df688d3cf7355855c">_SUBSONIC_AMBIVALENT_</a>
<a name="l03999"></a>03999   + zmin and zmax: Subsonic <span class="stringliteral">&quot;ambivalent&quot;</span> #<a class="code" href="a00037.html#aac7250bf34e60e7df688d3cf7355855c">_SUBSONIC_AMBIVALENT_</a>
<a name="l04000"></a>04000 
<a name="l04001"></a>04001 Reference:
<a name="l04002"></a>04002   + Taneda, S., “Experimental Investigation of Wake behind a Sphere at Low Reynolds Numbers,” 
<a name="l04003"></a>04003     Journal of the Physical Society of Japan, Vol. 11, 1956.
<a name="l04004"></a>04004   + Johnson, T.A. and Patel, V.C., “Flow Past a Sphere up to a Reynolds Number of 300,” 
<a name="l04005"></a>04005     Journal of Fluid Mechanics, Vol. 378, 1999.
<a name="l04006"></a>04006 
<a name="l04007"></a>04007 Initial solution: \f$\rho=1, u=0.1, v=w=0, p=1/\gamma\f$ everywhere in the domain.
<a name="l04008"></a>04008 
<a name="l04009"></a>04009 Other parameters (all dimensional quantities are in SI units):
<a name="l04010"></a>04010   + Specific heat ratio \f$\gamma = 1.4\f$ (#<a class="code" href="a00022.html" title="Structure containing variables and parameters specific to the 3D Navier Stokes equations...">NavierStokes3D</a>::gamma)
<a name="l04011"></a>04011   + Freestream Mach number \f$M_{\infty} = 0.1\f$ (#<a class="code" href="a00022.html#aa5f774fe7b4f69be5e085f1988ef2a6d">NavierStokes3D::Minf</a>)
<a name="l04012"></a>04012   + Prandlt number \f$Pr = 0.72\f$ (#<a class="code" href="a00022.html#af0f6e03342b9eb912e25f94ce0249a2c">NavierStokes3D::Pr</a>)
<a name="l04013"></a>04013   + Reynolds number \f$Re = \frac {\rho u L } {\mu} = 100\f$ (#<a class="code" href="a00022.html#a3b92a4b98cedf64473b3c13dfa7674b4">NavierStokes3D::Re</a>) 
<a name="l04014"></a>04014     (\b <a class="code" href="a00032.html#a86616b1951d3af95df5b7115dd30438f">Note</a>: since the diameter of the sphere is 1.0, the diameter-based Reynolds number 
<a name="l04015"></a>04015     is the same as the <a class="code" href="a00032.html#aa18752ebe19b49b626048c92d4586801">specified</a> Reynolds number \f$Re_D = Re = 100\f$).
<a name="l04016"></a>04016 
<a name="l04017"></a>04017 Numerical Method:
<a name="l04018"></a>04018  + Spatial <a class="code" href="a00033.html#a006f5ed6c12ae3d4f8e840cb181a05ca">discretization</a> (hyperbolic): 5th order WENO (<a class="code" href="a00041.html#af2195885ad055989a1b2b11655843343" title="5th order WENO reconstruction (component-wise) on a uniform grid">Interp1PrimFifthOrderWENO</a>())
<a name="l04019"></a>04019  + Spatial discretization (parabolic) : 4th order (<a class="code" href="a00038.html#a08c28e6bc4493172df7b7867e1f3d815">FirstDerivativeFourthOrderCentral</a>()) 
<a name="l04020"></a>04020                                         non-conservative 2-stage (<a class="code" href="a00285.html#afddc08f58a2046af9ebcc82d06efccb5">NavierStokes3DParabolicFunction</a>())
<a name="l04021"></a>04021  + Time integration: RK4 (TimeRK(), #<a class="code" href="a00061.html#a47de987716954223b3c26bb842b21bf8">_RK_44_</a>)
<a name="l04022"></a>04022 
<a name="l04023"></a>04023 Input files <a class="code" href="a00032.html#af7a1b4a66a5b6f9ac8eebf2c23b51e9e">required</a>:
<a name="l04024"></a>04024 ---------------------
<a name="l04025"></a>04025 
<a name="l04026"></a>04026 These files are all located in: \b hypar/<a class="code" href="a00031.html#a60f502575a2e782807ea78c05f76ae03">Examples</a>/3D/<a class="code" href="a00022.html" title="Structure containing variables and parameters specific to the 3D Navier Stokes equations...">NavierStokes3D</a>/Sphere/Steady_Viscous_Incompressible/
<a name="l04027"></a>04027 
<a name="l04028"></a>04028 \b solver.inp
<a name="l04029"></a>04029 \include 3D/<a class="code" href="a00022.html" title="Structure containing variables and parameters specific to the 3D Navier Stokes equations...">NavierStokes3D</a>/Sphere/Steady_Viscous_Incompressible/solver.inp
<a name="l04030"></a>04030 
<a name="l04031"></a>04031 \b boundary.inp
<a name="l04032"></a>04032 \include 3D/<a class="code" href="a00022.html" title="Structure containing variables and parameters specific to the 3D Navier Stokes equations...">NavierStokes3D</a>/Sphere/Steady_Viscous_Incompressible/boundary.inp
<a name="l04033"></a>04033 
<a name="l04034"></a>04034 \b physics.inp : The following file specifies a Reynolds number
<a name="l04035"></a>04035 of 100. To try other Reynolds numbers, change it here.
<a name="l04036"></a>04036 \include 3D/<a class="code" href="a00022.html" title="Structure containing variables and parameters specific to the 3D Navier Stokes equations...">NavierStokes3D</a>/Sphere/Steady_Viscous_Incompressible/physics.inp
<a name="l04037"></a>04037 
<a name="l04038"></a>04038 \b sphere.stl : the filename <span class="stringliteral">&quot;sphere.stl&quot;</span> \b must match
<a name="l04039"></a>04039 the input for \a immersed_body in \a solver.inp.\n
<a name="l04040"></a>04040 Located at \b hypar/<a class="code" href="a00031.html#a60f502575a2e782807ea78c05f76ae03">Examples</a>/STLGeometries/sphere.stl
<a name="l04041"></a>04041 
<a name="l04042"></a>04042 To generate \b initial.inp (initial solution), compile 
<a name="l04043"></a>04043 and run the following code in the run directory.
<a name="l04044"></a>04044 \include 3D/<a class="code" href="a00022.html" title="Structure containing variables and parameters specific to the 3D Navier Stokes equations...">NavierStokes3D</a>/Sphere/Steady_Viscous_Incompressible/aux/init.c
<a name="l04045"></a>04045 
<a name="l04046"></a>04046 Output:
<a name="l04047"></a>04047 -------
<a name="l04048"></a>04048 
<a name="l04049"></a>04049 <a class="code" href="a00032.html#a86616b1951d3af95df5b7115dd30438f">Note</a> that \b iproc is set to 
<a name="l04050"></a>04050 
<a name="l04051"></a>04051       2 2 2
<a name="l04052"></a>04052 
<a name="l04053"></a>04053 in \b solver.inp (i.e., 2 processors along \a x, 2
<a name="l04054"></a>04054 processors along \a y, and 2 processor along \a z). Thus, 
<a name="l04055"></a>04055 this example should be run with 8 MPI ranks (or change \b iproc).
<a name="l04056"></a>04056 
<a name="l04057"></a>04057 After running the code, there should be one output file
<a name="l04058"></a>04058 \b op.bin, since #HyPar::op_overwrite is set to \a yes in \b solver.inp.
<a name="l04059"></a>04059 #HyPar::op_file_format is set to \a binary in \b solver.inp, and
<a name="l04060"></a>04060 thus, all the files are written out in the binary format, see 
<a name="l04061"></a>04061 <a class="code" href="a00042.html#a067f454c26d85d6cfb4d7d878b3783c9">WriteBinary</a>(). The binary file contains the conserved variables
<a name="l04062"></a>04062 \f$\left(\rho, \rho u, \rho v, e\right)\f$. The following two codes
<a name="l04063"></a>04063 are available to convert the binary output file:
<a name="l04064"></a>04064 + \b hypar/Extras/BinaryToTecplot.c - convert binary output file to 
<a name="l04065"></a>04065   Tecplot file.
<a name="l04066"></a>04066 + \b hypar/Extras/BinaryToText.c - convert binary output file to
<a name="l04067"></a>04067   an ASCII <a class="code" href="a00031.html#a314f90bacf496961ff4bfef89fea32c0">text</a> file (to visualize in, for example, MATLAB).
<a name="l04068"></a>04068 
<a name="l04069"></a>04069 The following figure shows the flow (<a class="code" href="a00032.html#a58d87a94271c7f86a36fafc7117fe0b0">pressure</a> and streamlines) at \f$Re_D=100\f$:
<a name="l04070"></a>04070 @image html Solution_3DNavStokSphere_ReD100.png
<a name="l04071"></a>04071 
<a name="l04072"></a>04072 In <a class="code" href="a00032.html#acd2d71c0bebc6551f6d5d3c2870a9baa">addition</a> to the <a class="code" href="a00157.html#a3c04138a5bfe5d72780bb7e82a18e627" title="Main driver.">main</a> solution, the code also writes out a file with the aerodynamic
<a name="l04073"></a>04073 forces on the immersed body. This file is called \a surface.<a class="code" href="a00031.html#a96b9dfbebc4ecd57a32426075fb0c3f2">dat</a> (if #HyPar::op_overwrite
<a name="l04074"></a>04074 is <span class="stringliteral">&quot;yes&quot;</span>) or \a surface_nnnnn.<a class="code" href="a00031.html#a96b9dfbebc4ecd57a32426075fb0c3f2">dat</a> (if #HyPar::op_overwrite is <span class="stringliteral">&quot;no&quot;</span>, <span class="stringliteral">&quot;nnnnn&quot;</span> is a numerical
<a name="l04075"></a>04075 index) (in this example, the file \b surface.<a class="code" href="a00031.html#a96b9dfbebc4ecd57a32426075fb0c3f2">dat</a> is written out). This is an ASCII file in 
<a name="l04076"></a>04076 the Tecplot format, where the immersed body and the forces on it are represented using the 
<a name="l04077"></a>04077 <span class="stringliteral">&quot;FETRIANGLE&quot;</span> type. The following image shows the surface <a class="code" href="a00032.html#a58d87a94271c7f86a36fafc7117fe0b0">pressure</a> on the sphere (front-view):
<a name="l04078"></a>04078 @image html IBSurface_3DNavStokSphere.png
<a name="l04079"></a>04079 
<a name="l04080"></a>04080 Expected screen output:
<a name="l04081"></a>04081 \include 3D/<a class="code" href="a00022.html" title="Structure containing variables and parameters specific to the 3D Navier Stokes equations...">NavierStokes3D</a>/Sphere/Steady_Viscous_Incompressible/output.log
</pre></div></div>
<!-- Start of StatCounter Code for Default Guide -->
<script type="text/javascript">
var sc_project=10897352; 
var sc_invisible=1; 
var sc_security="83042f57"; 
var scJsHost = (("https:" == document.location.protocol) ?
"https://secure." : "http://www.");
document.write("<sc"+"ript type='text/javascript' src='" +
scJsHost+
"statcounter.com/counter/counter.js'></"+"script>");
</script>
<noscript><div class="statcounter"><a title="website
statistics" href="http://statcounter.com/"
target="_blank"><img class="statcounter"
src="//c.statcounter.com/10897352/0/83042f57/1/"
alt="website statistics"></a></div></noscript>
<!-- End of StatCounter Code for Default Guide -->
