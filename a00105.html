<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.5"/>
<title>HyPar: include/interpolation.h File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script><script src="http://cdn.mathjax.org/mathjax/latest/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="doxygen_html_style.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">HyPar
   &#160;<span id="projectnumber">1.0</span>
   </div>
   <div id="projectbrief">Finite-Difference Hyperbolic-Parabolic PDE Solver on Cartesian Grids</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.5 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Structures</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>Globals</span></a></li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('a00105.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Data Structures</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Namespaces</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Macros</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Pages</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#nested-classes">Data Structures</a> &#124;
<a href="#define-members">Macros</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">interpolation.h File Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>Definitions for the functions computing the interpolated value of the primitive at the cell interfaces from the cell-centered values.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &quot;<a class="el" href="a00137_source.html">basic.h</a>&quot;</code><br/>
</div>
<p><a href="a00105_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="nested-classes"></a>
Data Structures</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00118.html">MUSCLParameters</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Structure of variables/parameters needed by the MUSCL scheme.  <a href="a00118.html#details">More...</a><br/></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a00523"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00105.html#a00523">WENOParameters</a></td></tr>
<tr class="memdesc:a00523"><td class="mdescLeft">&#160;</td><td class="mdescRight">Structure of variables/parameters needed by the WENO-type scheme.  <a href="a00105.html#a00523">More...</a><br/></td></tr>
<tr class="separator:a00523"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a00503"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00105.html#a00503">CompactScheme</a></td></tr>
<tr class="memdesc:a00503"><td class="mdescLeft">&#160;</td><td class="mdescRight">Structure of variables/parameters needed by the compact schemes.  <a href="a00105.html#a00503">More...</a><br/></td></tr>
<tr class="separator:a00503"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:a19cc54d502757bfed14b373b443f144c"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00105.html#a19cc54d502757bfed14b373b443f144c">_FIRST_ORDER_UPWIND_</a>&#160;&#160;&#160;&quot;1&quot;</td></tr>
<tr class="separator:a19cc54d502757bfed14b373b443f144c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a89694dcc7c48314c98b9636759bb8bee"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00105.html#a89694dcc7c48314c98b9636759bb8bee">_SECOND_ORDER_CENTRAL_</a>&#160;&#160;&#160;&quot;2&quot;</td></tr>
<tr class="separator:a89694dcc7c48314c98b9636759bb8bee"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a32a14b9aa17be670a383e3d539da2afa"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00105.html#a32a14b9aa17be670a383e3d539da2afa">_SECOND_ORDER_MUSCL_</a>&#160;&#160;&#160;&quot;muscl2&quot;</td></tr>
<tr class="separator:a32a14b9aa17be670a383e3d539da2afa"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a21f7f383e497570fcb71c43f243539d3"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00105.html#a21f7f383e497570fcb71c43f243539d3">_THIRD_ORDER_MUSCL_</a>&#160;&#160;&#160;&quot;muscl3&quot;</td></tr>
<tr class="separator:a21f7f383e497570fcb71c43f243539d3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7bc4a755992e5f68efe365591b7a2c02"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00105.html#a7bc4a755992e5f68efe365591b7a2c02">_FIFTH_ORDER_UPWIND_</a>&#160;&#160;&#160;&quot;upw5&quot;</td></tr>
<tr class="separator:a7bc4a755992e5f68efe365591b7a2c02"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae832e2314ee85139cec9df4ea82aafa2"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00105.html#ae832e2314ee85139cec9df4ea82aafa2">_FIFTH_ORDER_COMPACT_UPWIND_</a>&#160;&#160;&#160;&quot;cupw5&quot;</td></tr>
<tr class="separator:ae832e2314ee85139cec9df4ea82aafa2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acfeff1b158131390b7129f4a857b15ff"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00105.html#acfeff1b158131390b7129f4a857b15ff">_FIFTH_ORDER_WENO_</a>&#160;&#160;&#160;&quot;weno5&quot;</td></tr>
<tr class="separator:acfeff1b158131390b7129f4a857b15ff"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a175a82b8ae2b24c0ba51e1b1dd68c0e5"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00105.html#a175a82b8ae2b24c0ba51e1b1dd68c0e5">_FIFTH_ORDER_CRWENO_</a>&#160;&#160;&#160;&quot;crweno5&quot;</td></tr>
<tr class="separator:a175a82b8ae2b24c0ba51e1b1dd68c0e5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6d34f5e8aae80a0d2a27ea20368dfef1"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00105.html#a6d34f5e8aae80a0d2a27ea20368dfef1">_FIFTH_ORDER_HCWENO_</a>&#160;&#160;&#160;&quot;hcweno5&quot;</td></tr>
<tr class="separator:a6d34f5e8aae80a0d2a27ea20368dfef1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa7752b40155314f9f2c063d4d9d8339d"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00105.html#aa7752b40155314f9f2c063d4d9d8339d">_CHARACTERISTIC_</a>&#160;&#160;&#160;&quot;characteristic&quot;</td></tr>
<tr class="separator:aa7752b40155314f9f2c063d4d9d8339d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac1f614645aa891fde12c0ce4354de45d"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00105.html#ac1f614645aa891fde12c0ce4354de45d">_COMPONENTS_</a>&#160;&#160;&#160;&quot;components&quot;</td></tr>
<tr class="separator:ac1f614645aa891fde12c0ce4354de45d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a248926a53714d93eb513eb0faea501ce"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00105.html#a248926a53714d93eb513eb0faea501ce">_WENO_OPTIMAL_WEIGHT_1_</a>&#160;&#160;&#160;0.1</td></tr>
<tr class="separator:a248926a53714d93eb513eb0faea501ce"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6670756d96f1f523cee16eed544d053d"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00105.html#a6670756d96f1f523cee16eed544d053d">_WENO_OPTIMAL_WEIGHT_2_</a>&#160;&#160;&#160;0.6</td></tr>
<tr class="separator:a6670756d96f1f523cee16eed544d053d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1040ac7b0b8a805ee3888c9534dc0933"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00105.html#a1040ac7b0b8a805ee3888c9534dc0933">_WENO_OPTIMAL_WEIGHT_3_</a>&#160;&#160;&#160;0.3</td></tr>
<tr class="separator:a1040ac7b0b8a805ee3888c9534dc0933"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a231fd73854e7a1db484a2d3ef05d3325"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00105.html#a231fd73854e7a1db484a2d3ef05d3325">_CRWENO_OPTIMAL_WEIGHT_1_</a>&#160;&#160;&#160;0.2</td></tr>
<tr class="separator:a231fd73854e7a1db484a2d3ef05d3325"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac6c34db3ed9438f08e64dec775065b0a"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00105.html#ac6c34db3ed9438f08e64dec775065b0a">_CRWENO_OPTIMAL_WEIGHT_2_</a>&#160;&#160;&#160;0.5</td></tr>
<tr class="separator:ac6c34db3ed9438f08e64dec775065b0a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a997c514e872a0a80e59ad19ef3d2746a"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00105.html#a997c514e872a0a80e59ad19ef3d2746a">_CRWENO_OPTIMAL_WEIGHT_3_</a>&#160;&#160;&#160;0.3</td></tr>
<tr class="separator:a997c514e872a0a80e59ad19ef3d2746a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9584e7fc4d65e4dea714697c890cba92"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00105.html#a9584e7fc4d65e4dea714697c890cba92">_WENOWeights_v_JS_</a>(w1, w2, w3, c1, c2, c3, m3, m2, m1, p1, p2, weno, N)</td></tr>
<tr class="separator:a9584e7fc4d65e4dea714697c890cba92"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a094028d92064eae70f8f31dd4332e547"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00105.html#a094028d92064eae70f8f31dd4332e547">_WENOWeights_v_M_</a>(w1, w2, w3, c1, c2, c3, m3, m2, m1, p1, p2, weno, N)</td></tr>
<tr class="separator:a094028d92064eae70f8f31dd4332e547"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1203c5f21fa26563cf62429e09db8646"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00105.html#a1203c5f21fa26563cf62429e09db8646">_WENOWeights_v_Z_</a>(w1, w2, w3, c1, c2, c3, m3, m2, m1, p1, p2, weno, N)</td></tr>
<tr class="separator:a1203c5f21fa26563cf62429e09db8646"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad98f4bd3af977c9a0bc686ba4e6bb15e"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00105.html#ad98f4bd3af977c9a0bc686ba4e6bb15e">_WENOWeights_v_YC_</a>(w1, w2, w3, c1, c2, c3, m3, m2, m1, p1, p2, weno, N)</td></tr>
<tr class="separator:ad98f4bd3af977c9a0bc686ba4e6bb15e"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a0a067c9c4745556845b9bcb7f049b59b"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00105.html#a0a067c9c4745556845b9bcb7f049b59b">Interp1PrimFirstOrderUpwind</a> (double *, double *, double *, double *, int, int, void *, void *, int)</td></tr>
<tr class="memdesc:a0a067c9c4745556845b9bcb7f049b59b"><td class="mdescLeft">&#160;</td><td class="mdescRight">1st order upwind reconstruction (component-wise) on a uniform grid  <a href="#a0a067c9c4745556845b9bcb7f049b59b">More...</a><br/></td></tr>
<tr class="separator:a0a067c9c4745556845b9bcb7f049b59b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a697d5c94aa331054c5286492e7fa39c7"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00105.html#a697d5c94aa331054c5286492e7fa39c7">Interp1PrimSecondOrderCentral</a> (double *, double *, double *, double *, int, int, void *, void *, int)</td></tr>
<tr class="memdesc:a697d5c94aa331054c5286492e7fa39c7"><td class="mdescLeft">&#160;</td><td class="mdescRight">2nd order central reconstruction (component-wise) on a uniform grid  <a href="#a697d5c94aa331054c5286492e7fa39c7">More...</a><br/></td></tr>
<tr class="separator:a697d5c94aa331054c5286492e7fa39c7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a25df96c0eccca13167d28045d187db36"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00105.html#a25df96c0eccca13167d28045d187db36">Interp1PrimSecondOrderMUSCL</a> (double *, double *, double *, double *, int, int, void *, void *, int)</td></tr>
<tr class="memdesc:a25df96c0eccca13167d28045d187db36"><td class="mdescLeft">&#160;</td><td class="mdescRight">2nd order MUSCL scheme (component-wise) on a uniform grid  <a href="#a25df96c0eccca13167d28045d187db36">More...</a><br/></td></tr>
<tr class="separator:a25df96c0eccca13167d28045d187db36"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae7eb6a81a164ca0fa2ace3cab2697847"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00105.html#ae7eb6a81a164ca0fa2ace3cab2697847">Interp1PrimThirdOrderMUSCL</a> (double *, double *, double *, double *, int, int, void *, void *, int)</td></tr>
<tr class="memdesc:ae7eb6a81a164ca0fa2ace3cab2697847"><td class="mdescLeft">&#160;</td><td class="mdescRight">3rd order MUSCL scheme with Koren's limiter (component-wise) on a uniform grid  <a href="#ae7eb6a81a164ca0fa2ace3cab2697847">More...</a><br/></td></tr>
<tr class="separator:ae7eb6a81a164ca0fa2ace3cab2697847"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aea7c973ffe0c37bca0703c1bf6175aaa"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00105.html#aea7c973ffe0c37bca0703c1bf6175aaa">Interp1PrimFifthOrderUpwind</a> (double *, double *, double *, double *, int, int, void *, void *, int)</td></tr>
<tr class="memdesc:aea7c973ffe0c37bca0703c1bf6175aaa"><td class="mdescLeft">&#160;</td><td class="mdescRight">5th order upwind reconstruction (component-wise) on a uniform grid  <a href="#aea7c973ffe0c37bca0703c1bf6175aaa">More...</a><br/></td></tr>
<tr class="separator:aea7c973ffe0c37bca0703c1bf6175aaa"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3ac2a77b9fa5a50499c285e49cf91344"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00105.html#a3ac2a77b9fa5a50499c285e49cf91344">Interp1PrimFifthOrderCompactUpwind</a> (double *, double *, double *, double *, int, int, void *, void *, int)</td></tr>
<tr class="memdesc:a3ac2a77b9fa5a50499c285e49cf91344"><td class="mdescLeft">&#160;</td><td class="mdescRight">5th order compact upwind reconstruction (component-wise) on a uniform grid  <a href="#a3ac2a77b9fa5a50499c285e49cf91344">More...</a><br/></td></tr>
<tr class="separator:a3ac2a77b9fa5a50499c285e49cf91344"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af2195885ad055989a1b2b11655843343"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00105.html#af2195885ad055989a1b2b11655843343">Interp1PrimFifthOrderWENO</a> (double *, double *, double *, double *, int, int, void *, void *, int)</td></tr>
<tr class="memdesc:af2195885ad055989a1b2b11655843343"><td class="mdescLeft">&#160;</td><td class="mdescRight">5th order WENO reconstruction (component-wise) on a uniform grid  <a href="#af2195885ad055989a1b2b11655843343">More...</a><br/></td></tr>
<tr class="separator:af2195885ad055989a1b2b11655843343"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a33b1e24c12129941b0027a83c543a654"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00105.html#a33b1e24c12129941b0027a83c543a654">Interp1PrimFifthOrderCRWENO</a> (double *, double *, double *, double *, int, int, void *, void *, int)</td></tr>
<tr class="memdesc:a33b1e24c12129941b0027a83c543a654"><td class="mdescLeft">&#160;</td><td class="mdescRight">5th order CRWENO reconstruction (component-wise) on a uniform grid  <a href="#a33b1e24c12129941b0027a83c543a654">More...</a><br/></td></tr>
<tr class="separator:a33b1e24c12129941b0027a83c543a654"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad9c611137cfce1c622c2e9838fb523c8"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00105.html#ad9c611137cfce1c622c2e9838fb523c8">Interp1PrimFifthOrderHCWENO</a> (double *, double *, double *, double *, int, int, void *, void *, int)</td></tr>
<tr class="memdesc:ad9c611137cfce1c622c2e9838fb523c8"><td class="mdescLeft">&#160;</td><td class="mdescRight">5th order hybrid compact-WENO reconstruction (component-wise) on a uniform grid  <a href="#ad9c611137cfce1c622c2e9838fb523c8">More...</a><br/></td></tr>
<tr class="separator:ad9c611137cfce1c622c2e9838fb523c8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a759e07ba8a484c2c6971fc7c6a81a95a"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00105.html#a759e07ba8a484c2c6971fc7c6a81a95a">Interp1PrimFirstOrderUpwindChar</a> (double *, double *, double *, double *, int, int, void *, void *, int)</td></tr>
<tr class="memdesc:a759e07ba8a484c2c6971fc7c6a81a95a"><td class="mdescLeft">&#160;</td><td class="mdescRight">1st order upwind reconstruction (characteristic-based) on a uniform grid  <a href="#a759e07ba8a484c2c6971fc7c6a81a95a">More...</a><br/></td></tr>
<tr class="separator:a759e07ba8a484c2c6971fc7c6a81a95a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a963c82116a2a1d6084af3d519b61b896"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00105.html#a963c82116a2a1d6084af3d519b61b896">Interp1PrimSecondOrderCentralChar</a> (double *, double *, double *, double *, int, int, void *, void *, int)</td></tr>
<tr class="memdesc:a963c82116a2a1d6084af3d519b61b896"><td class="mdescLeft">&#160;</td><td class="mdescRight">2nd order central reconstruction (characteristic-based) on a uniform grid  <a href="#a963c82116a2a1d6084af3d519b61b896">More...</a><br/></td></tr>
<tr class="separator:a963c82116a2a1d6084af3d519b61b896"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9cde00a0c916f0cda162b1c03d3f7b6b"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00105.html#a9cde00a0c916f0cda162b1c03d3f7b6b">Interp1PrimSecondOrderMUSCLChar</a> (double *, double *, double *, double *, int, int, void *, void *, int)</td></tr>
<tr class="memdesc:a9cde00a0c916f0cda162b1c03d3f7b6b"><td class="mdescLeft">&#160;</td><td class="mdescRight">2nd order MUSCL scheme (characteristic-based) on a uniform grid  <a href="#a9cde00a0c916f0cda162b1c03d3f7b6b">More...</a><br/></td></tr>
<tr class="separator:a9cde00a0c916f0cda162b1c03d3f7b6b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a985d08c4fb9bcb71875c697f9e00d6eb"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00105.html#a985d08c4fb9bcb71875c697f9e00d6eb">Interp1PrimThirdOrderMUSCLChar</a> (double *, double *, double *, double *, int, int, void *, void *, int)</td></tr>
<tr class="memdesc:a985d08c4fb9bcb71875c697f9e00d6eb"><td class="mdescLeft">&#160;</td><td class="mdescRight">3rd order MUSCL scheme with Koren's limiter (characteristic-based) on a uniform grid  <a href="#a985d08c4fb9bcb71875c697f9e00d6eb">More...</a><br/></td></tr>
<tr class="separator:a985d08c4fb9bcb71875c697f9e00d6eb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ade9ece6e934d70cdf29090494440f505"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00105.html#ade9ece6e934d70cdf29090494440f505">Interp1PrimFifthOrderUpwindChar</a> (double *, double *, double *, double *, int, int, void *, void *, int)</td></tr>
<tr class="memdesc:ade9ece6e934d70cdf29090494440f505"><td class="mdescLeft">&#160;</td><td class="mdescRight">5th order upwind reconstruction (characteristic-based) on a uniform grid  <a href="#ade9ece6e934d70cdf29090494440f505">More...</a><br/></td></tr>
<tr class="separator:ade9ece6e934d70cdf29090494440f505"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a28b8d3ce17676cec19de4f91f989042d"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00105.html#a28b8d3ce17676cec19de4f91f989042d">Interp1PrimFifthOrderCompactUpwindChar</a> (double *, double *, double *, double *, int, int, void *, void *, int)</td></tr>
<tr class="memdesc:a28b8d3ce17676cec19de4f91f989042d"><td class="mdescLeft">&#160;</td><td class="mdescRight">5th order compact upwind reconstruction (characteristic-based) on a uniform grid  <a href="#a28b8d3ce17676cec19de4f91f989042d">More...</a><br/></td></tr>
<tr class="separator:a28b8d3ce17676cec19de4f91f989042d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abf3b032fdc8c0e84b86909db9e0b93c3"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00105.html#abf3b032fdc8c0e84b86909db9e0b93c3">Interp1PrimFifthOrderWENOChar</a> (double *, double *, double *, double *, int, int, void *, void *, int)</td></tr>
<tr class="memdesc:abf3b032fdc8c0e84b86909db9e0b93c3"><td class="mdescLeft">&#160;</td><td class="mdescRight">5th order WENO reconstruction (characteristic-based) on a uniform grid  <a href="#abf3b032fdc8c0e84b86909db9e0b93c3">More...</a><br/></td></tr>
<tr class="separator:abf3b032fdc8c0e84b86909db9e0b93c3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae2b27971cc952cf3b4959128bef6174b"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00105.html#ae2b27971cc952cf3b4959128bef6174b">Interp1PrimFifthOrderCRWENOChar</a> (double *, double *, double *, double *, int, int, void *, void *, int)</td></tr>
<tr class="memdesc:ae2b27971cc952cf3b4959128bef6174b"><td class="mdescLeft">&#160;</td><td class="mdescRight">5th order CRWENO reconstruction (characteristic-based) on a uniform grid  <a href="#ae2b27971cc952cf3b4959128bef6174b">More...</a><br/></td></tr>
<tr class="separator:ae2b27971cc952cf3b4959128bef6174b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a91fbe118c8c01fe1d5efa3cea4930589"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00105.html#a91fbe118c8c01fe1d5efa3cea4930589">Interp1PrimFifthOrderHCWENOChar</a> (double *, double *, double *, double *, int, int, void *, void *, int)</td></tr>
<tr class="memdesc:a91fbe118c8c01fe1d5efa3cea4930589"><td class="mdescLeft">&#160;</td><td class="mdescRight">5th order hybrid compact-WENO reconstruction (characteristic-based) on a uniform grid  <a href="#a91fbe118c8c01fe1d5efa3cea4930589">More...</a><br/></td></tr>
<tr class="separator:a91fbe118c8c01fe1d5efa3cea4930589"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae8bfe856abd743f5af925dc03e708ee3"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00105.html#ae8bfe856abd743f5af925dc03e708ee3">Interp2PrimSecondOrder</a> (double *, double *, int, void *, void *)</td></tr>
<tr class="memdesc:ae8bfe856abd743f5af925dc03e708ee3"><td class="mdescLeft">&#160;</td><td class="mdescRight">2nd order component-wise interpolation of the 2nd primitive on a uniform grid  <a href="#ae8bfe856abd743f5af925dc03e708ee3">More...</a><br/></td></tr>
<tr class="separator:ae8bfe856abd743f5af925dc03e708ee3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a249ae68fb7394160a7a709220b684acb"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00105.html#a249ae68fb7394160a7a709220b684acb">InterpSetLimiterVar</a> (double *, double *, double *, int, void *, void *)</td></tr>
<tr class="separator:a249ae68fb7394160a7a709220b684acb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a22e0ae19117192cae9978a7a741d15a5"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00105.html#a22e0ae19117192cae9978a7a741d15a5">MUSCLInitialize</a> (void *, void *)</td></tr>
<tr class="separator:a22e0ae19117192cae9978a7a741d15a5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aecbe557b2ccc254cdbbd312fc91717be"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00105.html#aecbe557b2ccc254cdbbd312fc91717be">WENOInitialize</a> (void *, void *, char *, char *)</td></tr>
<tr class="separator:aecbe557b2ccc254cdbbd312fc91717be"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a37dd034f5e9eb221bd3fd51cc8d1b0f4"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00105.html#a37dd034f5e9eb221bd3fd51cc8d1b0f4">WENOCleanup</a> (void *)</td></tr>
<tr class="separator:a37dd034f5e9eb221bd3fd51cc8d1b0f4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af255a582e14c5820cf12f9f95b4e28fd"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00105.html#af255a582e14c5820cf12f9f95b4e28fd">CompactSchemeInitialize</a> (void *, void *, char *)</td></tr>
<tr class="separator:af255a582e14c5820cf12f9f95b4e28fd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acfaa225472f09e2ade88945e909d5893"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00105.html#acfaa225472f09e2ade88945e909d5893">CompactSchemeCleanup</a> (void *)</td></tr>
<tr class="separator:acfaa225472f09e2ade88945e909d5893"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Definitions for the functions computing the interpolated value of the primitive at the cell interfaces from the cell-centered values. </p>
<dl class="section author"><dt>Author</dt><dd>Debojyoti Ghosh </dd></dl>

<p>Definition in file <a class="el" href="a00105_source.html">interpolation.h</a>.</p>
</div><hr/><h2 class="groupheader">Data Structure Documentation</h2>
<a name="a00523" id="a00523"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct WENOParameters</td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="textblock"><p>Structure of variables/parameters needed by the WENO-type scheme. </p>
<p>This structure contains the variables/parameters needed by the WENO-type scheme (<a class="el" href="a00105.html#acfeff1b158131390b7129f4a857b15ff">_FIFTH_ORDER_WENO_</a>, <a class="el" href="a00105.html#a175a82b8ae2b24c0ba51e1b1dd68c0e5">_FIFTH_ORDER_CRWENO_</a>, <a class="el" href="a00105.html#a6d34f5e8aae80a0d2a27ea20368dfef1">_FIFTH_ORDER_HCWENO_</a>). </p>

<p>Definition at line <a class="el" href="a00105_source.html#l00175">175</a> of file <a class="el" href="a00105_source.html">interpolation.h</a>.</p>
</div><table class="fieldtable">
<tr><th colspan="3">Data Fields</th></tr>
<tr><td class="fieldtype">
<a class="anchor" id="af370a2df117483b6f752da8889a89bb0"></a>int</td>
<td class="fieldname">
mapped</td>
<td class="fielddoc">
<p>Use mapped weights? (Henrick, Aslam, J. Comput. Phys., 2005) </p>
</td></tr>
<tr><td class="fieldtype">
<a class="anchor" id="af3c02b1dce05b28870fa1994c40cd1f2"></a>int</td>
<td class="fieldname">
borges</td>
<td class="fielddoc">
<p>Use Borges' implementation of weights? (Borges, et. al, J. Comput. Phys., 2008) </p>
</td></tr>
<tr><td class="fieldtype">
<a class="anchor" id="a8470a9f95ece04985a5031e745042b7e"></a>int</td>
<td class="fieldname">
yc</td>
<td class="fielddoc">
<p>Use Yamaleev-Carpenter implementation of weights? (Yamaleev, Carpenter, J. Comput. Phys., 2009) </p>
</td></tr>
<tr><td class="fieldtype">
<a class="anchor" id="a20e793c98bd33aef1cbbafcf3df48a55"></a>int</td>
<td class="fieldname">
no_limiting</td>
<td class="fielddoc">
<p>Remove limiting -&gt; 5th order polynomial interpolation (freeze the WENO weights to the optimal coefficients) </p>
</td></tr>
<tr><td class="fieldtype">
<a class="anchor" id="a974b448c3d0a13d483d36ef15de369b5"></a>double</td>
<td class="fieldname">
eps</td>
<td class="fielddoc">
<p>epsilon parameter </p>
</td></tr>
<tr><td class="fieldtype">
<a class="anchor" id="aace2d484b0e3651abd108f04803d316c"></a>double</td>
<td class="fieldname">
p</td>
<td class="fielddoc">
<p>p parameter </p>
</td></tr>
<tr><td class="fieldtype">
<a class="anchor" id="a2687e4b3cb5da7dbd00e565343f66c6c"></a>double</td>
<td class="fieldname">
tol</td>
<td class="fielddoc">
<p>a general tolerance parameter </p>
</td></tr>
<tr><td class="fieldtype">
<a class="anchor" id="af77cf650495294f69237f94cc237cba3"></a>double</td>
<td class="fieldname">
rc</td>
<td class="fielddoc">
<p>Parameter for the hybrid compact-WENO scheme </p>
</td></tr>
<tr><td class="fieldtype">
<a class="anchor" id="adf147b14a64e08756e9e30868e943da8"></a>double</td>
<td class="fieldname">
xi</td>
<td class="fielddoc">
<p>Parameter for the hybrid compact-WENO scheme </p>
</td></tr>
<tr><td class="fieldtype">
<a class="anchor" id="a3ee56e3d8244b3d4582f1396a79f9791"></a>double *</td>
<td class="fieldname">
w1</td>
<td class="fielddoc">
<p>Array to save the first WENO weight </p>
</td></tr>
<tr><td class="fieldtype">
<a class="anchor" id="a31eb3c1fcb3bc85ab4fa156325a1f849"></a>double *</td>
<td class="fieldname">
w2</td>
<td class="fielddoc">
<p>Array to save the second WENO weight </p>
</td></tr>
<tr><td class="fieldtype">
<a class="anchor" id="aabd83eb3f8a7e3bb9f79a4a943bbd508"></a>double *</td>
<td class="fieldname">
w3</td>
<td class="fielddoc">
<p>Array to save the third WENO weight </p>
</td></tr>
<tr><td class="fieldtype">
<a class="anchor" id="ad0c30ee1add42468a6d7c022f2efdf70"></a>int *</td>
<td class="fieldname">
offset</td>
<td class="fielddoc">
<p>Array containing the offset information for the WENO weights </p>
</td></tr>
<tr><td class="fieldtype">
<a class="anchor" id="a439227feff9d7f55384e8780cfc2eb82"></a>int</td>
<td class="fieldname">
size</td>
<td class="fielddoc">
<p>Size of the WENO weights array </p>
</td></tr>
</table>

</div>
</div>
<a name="a00503" id="a00503"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct CompactScheme</td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="textblock"><p>Structure of variables/parameters needed by the compact schemes. </p>
<p>This structure contains the variables/parameters needed by a compact scheme (<a class="el" href="a00105.html#ae832e2314ee85139cec9df4ea82aafa2">_FIFTH_ORDER_COMPACT_UPWIND_</a>, <a class="el" href="a00105.html#a175a82b8ae2b24c0ba51e1b1dd68c0e5">_FIFTH_ORDER_CRWENO_</a>, <a class="el" href="a00105.html#a6d34f5e8aae80a0d2a27ea20368dfef1">_FIFTH_ORDER_HCWENO_</a>). </p>

<p>Definition at line <a class="el" href="a00105_source.html#l00437">437</a> of file <a class="el" href="a00105_source.html">interpolation.h</a>.</p>
</div><table class="fieldtable">
<tr><th colspan="3">Data Fields</th></tr>
<tr><td class="fieldtype">
<a class="anchor" id="ac900805a486cbb8489e3c176ed6e0d8e"></a>double *</td>
<td class="fieldname">
A</td>
<td class="fielddoc">
<p>Array to save the sub-diagonal of the tridiagonal system resulting from the fifth-order CRWENO scheme </p>
</td></tr>
<tr><td class="fieldtype">
<a class="anchor" id="ad36954709307649365515214a02ab06d"></a>double *</td>
<td class="fieldname">
B</td>
<td class="fielddoc">
<p>Array to save the diagonal of the tridiagonal system resulting from the fifth-order CRWENO scheme </p>
</td></tr>
<tr><td class="fieldtype">
<a class="anchor" id="a0a26ce8d1878aac6ddc87e3f6290e039"></a>double *</td>
<td class="fieldname">
C</td>
<td class="fielddoc">
<p>Array to save the super-diagonal of the tridiagonal system resulting from the fifth-order CRWENO scheme </p>
</td></tr>
<tr><td class="fieldtype">
<a class="anchor" id="ac06de847603f5cfaec085f6fe500f3c8"></a>double *</td>
<td class="fieldname">
R</td>
<td class="fielddoc">
<p>Array to save the right-hand-side of the tridiagonal system resulting from the fifth-order CRWENO scheme </p>
</td></tr>
<tr><td class="fieldtype">
<a class="anchor" id="aba3b15034da676474db917f9f5533085"></a>double *</td>
<td class="fieldname">
sendbuf</td>
<td class="fielddoc">
<p>Buffer array to send data across processors </p>
</td></tr>
<tr><td class="fieldtype">
<a class="anchor" id="afc23e46e08649e112e8d64d780cea5cb"></a>double *</td>
<td class="fieldname">
recvbuf</td>
<td class="fielddoc">
<p>Buffer array to receive data across processors </p>
</td></tr>
</table>

</div>
</div>
<h2 class="groupheader">Macro Definition Documentation</h2>
<a class="anchor" id="a19cc54d502757bfed14b373b443f144c"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define _FIRST_ORDER_UPWIND_&#160;&#160;&#160;&quot;1&quot;</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>First order upwind scheme: <a class="el" href="a00105.html#a0a067c9c4745556845b9bcb7f049b59b" title="1st order upwind reconstruction (component-wise) on a uniform grid ">Interp1PrimFirstOrderUpwind()</a>, <a class="el" href="a00105.html#a759e07ba8a484c2c6971fc7c6a81a95a" title="1st order upwind reconstruction (characteristic-based) on a uniform grid ">Interp1PrimFirstOrderUpwindChar()</a> </p>

<p>Definition at line <a class="el" href="a00105_source.html#l00012">12</a> of file <a class="el" href="a00105_source.html">interpolation.h</a>.</p>

</div>
</div>
<a class="anchor" id="a89694dcc7c48314c98b9636759bb8bee"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define _SECOND_ORDER_CENTRAL_&#160;&#160;&#160;&quot;2&quot;</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Second order central scheme: <a class="el" href="a00105.html#a697d5c94aa331054c5286492e7fa39c7" title="2nd order central reconstruction (component-wise) on a uniform grid ">Interp1PrimSecondOrderCentral()</a>, <a class="el" href="a00105.html#a963c82116a2a1d6084af3d519b61b896" title="2nd order central reconstruction (characteristic-based) on a uniform grid ">Interp1PrimSecondOrderCentralChar()</a> </p>

<p>Definition at line <a class="el" href="a00105_source.html#l00014">14</a> of file <a class="el" href="a00105_source.html">interpolation.h</a>.</p>

</div>
</div>
<a class="anchor" id="a32a14b9aa17be670a383e3d539da2afa"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define _SECOND_ORDER_MUSCL_&#160;&#160;&#160;&quot;muscl2&quot;</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Second order MUSCL scheme: <a class="el" href="a00105.html#a25df96c0eccca13167d28045d187db36" title="2nd order MUSCL scheme (component-wise) on a uniform grid ">Interp1PrimSecondOrderMUSCL()</a>, <a class="el" href="a00105.html#a9cde00a0c916f0cda162b1c03d3f7b6b" title="2nd order MUSCL scheme (characteristic-based) on a uniform grid ">Interp1PrimSecondOrderMUSCLChar()</a> </p>

<p>Definition at line <a class="el" href="a00105_source.html#l00016">16</a> of file <a class="el" href="a00105_source.html">interpolation.h</a>.</p>

</div>
</div>
<a class="anchor" id="a21f7f383e497570fcb71c43f243539d3"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define _THIRD_ORDER_MUSCL_&#160;&#160;&#160;&quot;muscl3&quot;</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Third order MUSCL scheme with Koren's limiter: <a class="el" href="a00105.html#ae7eb6a81a164ca0fa2ace3cab2697847" title="3rd order MUSCL scheme with Koren&#39;s limiter (component-wise) on a uniform grid ">Interp1PrimThirdOrderMUSCL()</a>, <a class="el" href="a00105.html#a985d08c4fb9bcb71875c697f9e00d6eb" title="3rd order MUSCL scheme with Koren&#39;s limiter (characteristic-based) on a uniform grid ...">Interp1PrimThirdOrderMUSCLChar()</a> </p>

<p>Definition at line <a class="el" href="a00105_source.html#l00018">18</a> of file <a class="el" href="a00105_source.html">interpolation.h</a>.</p>

</div>
</div>
<a class="anchor" id="a7bc4a755992e5f68efe365591b7a2c02"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define _FIFTH_ORDER_UPWIND_&#160;&#160;&#160;&quot;upw5&quot;</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Fifth order upwind scheme: <a class="el" href="a00105.html#aea7c973ffe0c37bca0703c1bf6175aaa" title="5th order upwind reconstruction (component-wise) on a uniform grid ">Interp1PrimFifthOrderUpwind()</a>, <a class="el" href="a00105.html#ade9ece6e934d70cdf29090494440f505" title="5th order upwind reconstruction (characteristic-based) on a uniform grid ">Interp1PrimFifthOrderUpwindChar()</a> </p>

<p>Definition at line <a class="el" href="a00105_source.html#l00020">20</a> of file <a class="el" href="a00105_source.html">interpolation.h</a>.</p>

</div>
</div>
<a class="anchor" id="ae832e2314ee85139cec9df4ea82aafa2"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define _FIFTH_ORDER_COMPACT_UPWIND_&#160;&#160;&#160;&quot;cupw5&quot;</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Fifth order compact upwind scheme: <a class="el" href="a00105.html#a3ac2a77b9fa5a50499c285e49cf91344" title="5th order compact upwind reconstruction (component-wise) on a uniform grid ">Interp1PrimFifthOrderCompactUpwind()</a>, <a class="el" href="a00105.html#a28b8d3ce17676cec19de4f91f989042d" title="5th order compact upwind reconstruction (characteristic-based) on a uniform grid ">Interp1PrimFifthOrderCompactUpwindChar()</a> </p>

<p>Definition at line <a class="el" href="a00105_source.html#l00022">22</a> of file <a class="el" href="a00105_source.html">interpolation.h</a>.</p>

</div>
</div>
<a class="anchor" id="acfeff1b158131390b7129f4a857b15ff"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define _FIFTH_ORDER_WENO_&#160;&#160;&#160;&quot;weno5&quot;</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Fifth order Weighted Essentially Non-Oscillatory (WENO) scheme: <a class="el" href="a00105.html#af2195885ad055989a1b2b11655843343" title="5th order WENO reconstruction (component-wise) on a uniform grid ">Interp1PrimFifthOrderWENO()</a>, <a class="el" href="a00105.html#abf3b032fdc8c0e84b86909db9e0b93c3" title="5th order WENO reconstruction (characteristic-based) on a uniform grid ">Interp1PrimFifthOrderWENOChar()</a> </p>

<p>Definition at line <a class="el" href="a00105_source.html#l00024">24</a> of file <a class="el" href="a00105_source.html">interpolation.h</a>.</p>

</div>
</div>
<a class="anchor" id="a175a82b8ae2b24c0ba51e1b1dd68c0e5"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define _FIFTH_ORDER_CRWENO_&#160;&#160;&#160;&quot;crweno5&quot;</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Fifth order Compact Reconstruction Weighted Essentially Non-Oscillatory (CRWENO) scheme: <a class="el" href="a00105.html#a33b1e24c12129941b0027a83c543a654" title="5th order CRWENO reconstruction (component-wise) on a uniform grid ">Interp1PrimFifthOrderCRWENO()</a>, <a class="el" href="a00105.html#ae2b27971cc952cf3b4959128bef6174b" title="5th order CRWENO reconstruction (characteristic-based) on a uniform grid ">Interp1PrimFifthOrderCRWENOChar()</a> </p>

<p>Definition at line <a class="el" href="a00105_source.html#l00026">26</a> of file <a class="el" href="a00105_source.html">interpolation.h</a>.</p>

</div>
</div>
<a class="anchor" id="a6d34f5e8aae80a0d2a27ea20368dfef1"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define _FIFTH_ORDER_HCWENO_&#160;&#160;&#160;&quot;hcweno5&quot;</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Fifth order hybrid compact-WENO scheme: <a class="el" href="a00105.html#ad9c611137cfce1c622c2e9838fb523c8" title="5th order hybrid compact-WENO reconstruction (component-wise) on a uniform grid ">Interp1PrimFifthOrderHCWENO()</a>, <a class="el" href="a00105.html#a91fbe118c8c01fe1d5efa3cea4930589" title="5th order hybrid compact-WENO reconstruction (characteristic-based) on a uniform grid ...">Interp1PrimFifthOrderHCWENOChar()</a> </p>

<p>Definition at line <a class="el" href="a00105_source.html#l00028">28</a> of file <a class="el" href="a00105_source.html">interpolation.h</a>.</p>

</div>
</div>
<a class="anchor" id="aa7752b40155314f9f2c063d4d9d8339d"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define _CHARACTERISTIC_&#160;&#160;&#160;&quot;characteristic&quot;</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Characteristic-based interpolation of vectors (Physical model must define left and right eigenvectors) </p>

<p>Definition at line <a class="el" href="a00105_source.html#l00031">31</a> of file <a class="el" href="a00105_source.html">interpolation.h</a>.</p>

</div>
</div>
<a class="anchor" id="ac1f614645aa891fde12c0ce4354de45d"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define _COMPONENTS_&#160;&#160;&#160;&quot;components&quot;</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Component-wise interpolation of vectors </p>

<p>Definition at line <a class="el" href="a00105_source.html#l00032">32</a> of file <a class="el" href="a00105_source.html">interpolation.h</a>.</p>

</div>
</div>
<a class="anchor" id="a248926a53714d93eb513eb0faea501ce"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define _WENO_OPTIMAL_WEIGHT_1_&#160;&#160;&#160;0.1</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Optimal value for the first fifth-order WENO weight </p>

<p>Definition at line <a class="el" href="a00105_source.html#l00208">208</a> of file <a class="el" href="a00105_source.html">interpolation.h</a>.</p>

</div>
</div>
<a class="anchor" id="a6670756d96f1f523cee16eed544d053d"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define _WENO_OPTIMAL_WEIGHT_2_&#160;&#160;&#160;0.6</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Optimal value for the second fifth-order WENO weight </p>

<p>Definition at line <a class="el" href="a00105_source.html#l00210">210</a> of file <a class="el" href="a00105_source.html">interpolation.h</a>.</p>

</div>
</div>
<a class="anchor" id="a1040ac7b0b8a805ee3888c9534dc0933"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define _WENO_OPTIMAL_WEIGHT_3_&#160;&#160;&#160;0.3</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Optimal value for the third fifth-order WENO weight </p>

<p>Definition at line <a class="el" href="a00105_source.html#l00212">212</a> of file <a class="el" href="a00105_source.html">interpolation.h</a>.</p>

</div>
</div>
<a class="anchor" id="a231fd73854e7a1db484a2d3ef05d3325"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define _CRWENO_OPTIMAL_WEIGHT_1_&#160;&#160;&#160;0.2</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Optimal value for the first fifth-order CRWENO weight </p>

<p>Definition at line <a class="el" href="a00105_source.html#l00214">214</a> of file <a class="el" href="a00105_source.html">interpolation.h</a>.</p>

</div>
</div>
<a class="anchor" id="ac6c34db3ed9438f08e64dec775065b0a"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define _CRWENO_OPTIMAL_WEIGHT_2_&#160;&#160;&#160;0.5</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Optimal value for the second fifth-order CRWENO weight </p>

<p>Definition at line <a class="el" href="a00105_source.html#l00216">216</a> of file <a class="el" href="a00105_source.html">interpolation.h</a>.</p>

</div>
</div>
<a class="anchor" id="a997c514e872a0a80e59ad19ef3d2746a"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define _CRWENO_OPTIMAL_WEIGHT_3_&#160;&#160;&#160;0.3</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Optimal value for the third fifth-order CRWENO weight </p>

<p>Definition at line <a class="el" href="a00105_source.html#l00218">218</a> of file <a class="el" href="a00105_source.html">interpolation.h</a>.</p>

</div>
</div>
<a class="anchor" id="a9584e7fc4d65e4dea714697c890cba92"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define _WENOWeights_v_JS_</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">w1, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">w2, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">w3, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">c1, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">c2, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">c3, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">m3, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">m2, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">m1, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">p1, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">p2, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">weno, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">N&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<b>Value:</b><div class="fragment"><div class="line">{ \</div>
<div class="line">    int idx; \</div>
<div class="line">    <span class="comment">/* calculate smoothness indicators and the WENO weights */</span>\</div>
<div class="line">    double b1, b2, b3, a1, a2, a3, a_sum_inv; \</div>
<div class="line">    for (idx=0; idx&lt;N; idx++) { \</div>
<div class="line">      b1 = thirteen_by_twelve*(m3[idx]-2*m2[idx]+m1[idx])*(m3[idx]-2*m2[idx]+m1[idx]) \</div>
<div class="line">           + one_fourth*(m3[idx]-4*m2[idx]+3*m1[idx])*(m3[idx]-4*m2[idx]+3*m1[idx]);  \</div>
<div class="line">      a1 = c1 / ( (b1+weno-&gt;eps) * (b1+weno-&gt;eps) );  \</div>
<div class="line">      b2 = thirteen_by_twelve*(m2[idx]-2*m1[idx]+p1[idx])*(m2[idx]-2*m1[idx]+p1[idx]) \</div>
<div class="line">           + one_fourth*(m2[idx]-p1[idx])*(m2[idx]-p1[idx]);                \</div>
<div class="line">      a2 = c2 / ( (b2+weno-&gt;eps) * (b2+weno-&gt;eps) );  \</div>
<div class="line">      b3 = thirteen_by_twelve*(m1[idx]-2*p1[idx]+p2[idx])*(m1[idx]-2*p1[idx]+p2[idx]) \</div>
<div class="line">           + one_fourth*(3*m1[idx]-4*p1[idx]+p2[idx])*(3*m1[idx]-4*p1[idx]+p2[idx]);  \</div>
<div class="line">      a3 = c3 / ( (b3+weno-&gt;eps) * (b3+weno-&gt;eps) );  \</div>
<div class="line">      a_sum_inv = 1.0 / (a1 + a2 + a3); \</div>
<div class="line">      w1[idx] = a1 * a_sum_inv; \</div>
<div class="line">      w2[idx] = a2 * a_sum_inv; \</div>
<div class="line">      w3[idx] = a3 * a_sum_inv; \</div>
<div class="line">    } \</div>
<div class="line">  }</div>
</div><!-- fragment --><p>Compute the WENO weights according the the Jiang &amp; Shu formulation: </p>
<p class="formulaDsp">
\begin{equation} \omega_k = \frac {a_k} {\sum_{j=1}^3 a_j },\ a_k = \frac {c_k} {\left(\beta_k+\epsilon\right)^p},\ k = 1,2,3, \end{equation}
</p>
<p> where \(c_k\) are the optimal weights, \(p\) is hardcoded to \(2\), and \(\epsilon\) is an input parameter (<a class="el" href="a00105.html#a974b448c3d0a13d483d36ef15de369b5">WENOParameters::eps</a>) (typically \(10^{-6}\)). The smoothness indicators \(\beta_k\) are given by: </p>
<p class="formulaDsp">
\begin{eqnarray} \beta_1 &amp;=&amp; \frac{13}{12} \left(f_{j-2}-2f_{j-1}+f_j\right)^2 + \frac{1}{4}\left(f_{j-2}-4f_{j-1}+3f_j\right)^2 \\ \beta_2 &amp;=&amp; \frac{13}{12} \left(f_{j-1}-2f_j+f_{j+1}\right)^2 + \frac{1}{4}\left(f_{j-1}-f_{j+1}\right)^2 \\ \beta_3 &amp;=&amp; \frac{13}{12} \left(f_j-2f_{j+1}+f_{j+2}\right)^2 + \frac{1}{4}\left(3f_j-4f_{j+1}+f_{j+2}\right)^2 \end{eqnarray}
</p>
<p><b>Notes:</b> </p>
<ul>
<li>This macro computes the weights for one variable along one grid line.</li>
</ul>
<p><b>Arguments:</b> </p>
<ul>
<li><em>w1</em>, <em>w2</em>,<em>w3</em> are the nonlinear WENO weights.</li>
<li><em>c1</em>, <em>c2</em>,<em>c3</em> are optimal coefficients.</li>
<li><em>m3</em>, <em>m2</em>,<em>m1</em>,<em>p1</em>,<em>p2</em> are the function values at stencil points corresponding to the interface j+1/2: j-2,j-1,j,j+1,j+2</li>
<li><em>weno</em> is an object of type <a class="el" href="a00105.html#a00523" title="Structure of variables/parameters needed by the WENO-type scheme. ">WENOParameters</a> containing parameters for the WENO method.</li>
</ul>
<p><b>Reference:</b> </p>
<ul>
<li>Jiang, Shu, J. Comput. Phys., 1996. <a href="http://dx.doi.org/10.1006/jcph.1996.0130">http://dx.doi.org/10.1006/jcph.1996.0130</a> </li>
</ul>

<p>Definition at line <a class="el" href="a00105_source.html#l00245">245</a> of file <a class="el" href="a00105_source.html">interpolation.h</a>.</p>

</div>
</div>
<a class="anchor" id="a094028d92064eae70f8f31dd4332e547"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define _WENOWeights_v_M_</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">w1, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">w2, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">w3, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">c1, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">c2, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">c3, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">m3, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">m2, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">m1, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">p1, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">p2, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">weno, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">N&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<b>Value:</b><div class="fragment"><div class="line">{ \</div>
<div class="line">    int idx; \</div>
<div class="line">    <span class="comment">/* calculate smoothness indicators and the WENO weights */</span>\</div>
<div class="line">    double b1, b2, b3, a1, a2, a3, a_sum_inv; \</div>
<div class="line">    for (idx=0; idx&lt;N; idx++) { \</div>
<div class="line">      b1 = thirteen_by_twelve*(m3[idx]-2*m2[idx]+m1[idx])*(m3[idx]-2*m2[idx]+m1[idx]) \</div>
<div class="line">           + one_fourth*(m3[idx]-4*m2[idx]+3*m1[idx])*(m3[idx]-4*m2[idx]+3*m1[idx]);  \</div>
<div class="line">      a1 = c1 / ( (b1+weno-&gt;eps) * (b1+weno-&gt;eps) );  \</div>
<div class="line">      b2 = thirteen_by_twelve*(m2[idx]-2*m1[idx]+p1[idx])*(m2[idx]-2*m1[idx]+p1[idx]) \</div>
<div class="line">           + one_fourth*(m2[idx]-p1[idx])*(m2[idx]-p1[idx]);                \</div>
<div class="line">      a2 = c2 / ( (b2+weno-&gt;eps) * (b2+weno-&gt;eps) );  \</div>
<div class="line">      b3 = thirteen_by_twelve*(m1[idx]-2*p1[idx]+p2[idx])*(m1[idx]-2*p1[idx]+p2[idx]) \</div>
<div class="line">           + one_fourth*(3*m1[idx]-4*p1[idx]+p2[idx])*(3*m1[idx]-4*p1[idx]+p2[idx]);  \</div>
<div class="line">      a3 = c3 / ( (b3+weno-&gt;eps) * (b3+weno-&gt;eps) );  \</div>
<div class="line">      a_sum_inv = 1.0 / (a1 + a2 + a3); \</div>
<div class="line">      w1[idx] = a1 * a_sum_inv; \</div>
<div class="line">      w2[idx] = a2 * a_sum_inv; \</div>
<div class="line">      w3[idx] = a3 * a_sum_inv; \</div>
<div class="line">      a1 = w1[idx] * (c1 + c1*c1 - 3*c1*w1[idx] + w1[idx]*w1[idx]) / (c1*c1 + w1[idx]*(1.0-2.0*c1)); \</div>
<div class="line">      a2 = w2[idx] * (c2 + c2*c2 - 3*c2*w2[idx] + w2[idx]*w2[idx]) / (c2*c2 + w2[idx]*(1.0-2.0*c2)); \</div>
<div class="line">      a3 = w3[idx] * (c3 + c3*c3 - 3*c3*w3[idx] + w3[idx]*w3[idx]) / (c3*c3 + w3[idx]*(1.0-2.0*c3)); \</div>
<div class="line">      a_sum_inv = 1.0 / (a1 + a2 + a3); \</div>
<div class="line">      w1[idx] = a1 * a_sum_inv; \</div>
<div class="line">      w2[idx] = a2 * a_sum_inv; \</div>
<div class="line">      w3[idx] = a3 * a_sum_inv; \</div>
<div class="line">    } \</div>
<div class="line">  }</div>
</div><!-- fragment --><p>Compute the WENO weights according the the Mapped-WENO formulation: </p>
<p class="formulaDsp">
\begin{eqnarray} \omega_k &amp;=&amp; \frac {a_k} {\sum_{j=1}^3 a_j },\ a_k = \frac {\tilde{\omega}_k \left( c_k + c_k^2 - 3c_k\tilde{\omega}_k + \tilde{\omega}_k^2\right)} {c_k^2 + \tilde{\omega}_k\left(1-2c_k\right)}, \\ \tilde{\omega}_k &amp;=&amp; \frac {\tilde{a}_k} {\sum_{j=1}^3 \tilde{a}_j },\ \tilde{a}_k = \frac {c_k} {\left(\beta_k+\epsilon\right)^p},\ k = 1,2,3, \end{eqnarray}
</p>
<p> where \(c_k\) are the optimal weights, \(p\) is hardcoded to \(2\), and \(\epsilon\) is an input parameter (<a class="el" href="a00105.html#a974b448c3d0a13d483d36ef15de369b5">WENOParameters::eps</a>) (typically \(10^{-6}\)). The smoothness indicators \(\beta_k\) are given by: </p>
<p class="formulaDsp">
\begin{eqnarray} \beta_1 &amp;=&amp; \frac{13}{12} \left(f_{j-2}-2f_{j-1}+f_j\right)^2 + \frac{1}{4}\left(f_{j-2}-4f_{j-1}+3f_j\right)^2 \\ \beta_2 &amp;=&amp; \frac{13}{12} \left(f_{j-1}-2f_j+f_{j+1}\right)^2 + \frac{1}{4}\left(f_{j-1}-f_{j+1}\right)^2 \\ \beta_3 &amp;=&amp; \frac{13}{12} \left(f_j-2f_{j+1}+f_{j+2}\right)^2 + \frac{1}{4}\left(3f_j-4f_{j+1}+f_{j+2}\right)^2 \end{eqnarray}
</p>
<p><b>Notes:</b> </p>
<ul>
<li>This macro computes the weights for one variable along one grid line.</li>
</ul>
<p><b>Arguments:-</b> </p>
<ul>
<li><em>w1</em>, <em>w2</em>,<em>w3</em> are the nonlinear WENO weights.</li>
<li><em>c1</em>, <em>c2</em>,<em>c3</em> are optimal coefficients.</li>
<li><em>m3</em>, <em>m2</em>,<em>m1</em>,<em>p1</em>,<em>p2</em> are the function values at stencil points corresponding to the interface j+1/2: j-2,j-1,j,j+1,j+2</li>
<li><em>weno</em> is an object of type <a class="el" href="a00105.html#a00523" title="Structure of variables/parameters needed by the WENO-type scheme. ">WENOParameters</a> containing parameters for the WENO method.</li>
<li><em>N</em> is the number of interfaces along the grid line on which this WENO-type reconstruction is happening.</li>
</ul>
<p><b>Reference:</b> </p>
<ul>
<li>Henrick, Aslam, Powers, J. Comput. Phys., 2005. <a href="http://dx.doi.org/10.1016/j.jcp.2005.01.023">http://dx.doi.org/10.1016/j.jcp.2005.01.023</a> </li>
</ul>

<p>Definition at line <a class="el" href="a00105_source.html#l00294">294</a> of file <a class="el" href="a00105_source.html">interpolation.h</a>.</p>

</div>
</div>
<a class="anchor" id="a1203c5f21fa26563cf62429e09db8646"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define _WENOWeights_v_Z_</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">w1, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">w2, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">w3, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">c1, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">c2, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">c3, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">m3, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">m2, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">m1, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">p1, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">p2, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">weno, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">N&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<b>Value:</b><div class="fragment"><div class="line">{ \</div>
<div class="line">    int idx; \</div>
<div class="line">    <span class="comment">/* calculate smoothness indicators and the WENO weights */</span>\</div>
<div class="line">    double b1, b2, b3, a1, a2, a3, a_sum_inv, tau; \</div>
<div class="line">    for (idx=0; idx&lt;N; idx++) { \</div>
<div class="line">      b1 = thirteen_by_twelve*(m3[idx]-2*m2[idx]+m1[idx])*(m3[idx]-2*m2[idx]+m1[idx]) \</div>
<div class="line">           + one_fourth*(m3[idx]-4*m2[idx]+3*m1[idx])*(m3[idx]-4*m2[idx]+3*m1[idx]);  \</div>
<div class="line">      b2 = thirteen_by_twelve*(m2[idx]-2*m1[idx]+p1[idx])*(m2[idx]-2*m1[idx]+p1[idx]) \</div>
<div class="line">           + one_fourth*(m2[idx]-p1[idx])*(m2[idx]-p1[idx]);                \</div>
<div class="line">      b3 = thirteen_by_twelve*(m1[idx]-2*p1[idx]+p2[idx])*(m1[idx]-2*p1[idx]+p2[idx]) \</div>
<div class="line">           + one_fourth*(3*m1[idx]-4*p1[idx]+p2[idx])*(3*m1[idx]-4*p1[idx]+p2[idx]);  \</div>
<div class="line">      tau = <a class="code" href="a00147.html#adf1be5ccbb7a2522b4f3a64043c72880">absolute</a>(b3 - b1);  \</div>
<div class="line">      a1 = c1 * (1.0 + (tau/(b1+weno-&gt;eps)) * (tau/(b1+weno-&gt;eps)) );  \</div>
<div class="line">      a2 = c2 * (1.0 + (tau/(b2+weno-&gt;eps)) * (tau/(b2+weno-&gt;eps)) );  \</div>
<div class="line">      a3 = c3 * (1.0 + (tau/(b3+weno-&gt;eps)) * (tau/(b3+weno-&gt;eps)) );  \</div>
<div class="line">      a_sum_inv = 1.0 / (a1 + a2 + a3); \</div>
<div class="line">      w1[idx] = a1 * a_sum_inv; \</div>
<div class="line">      w2[idx] = a2 * a_sum_inv; \</div>
<div class="line">      w3[idx] = a3 * a_sum_inv; \</div>
<div class="line">    } \</div>
<div class="line">  }</div>
<div class="ttc" id="a00147_html_adf1be5ccbb7a2522b4f3a64043c72880"><div class="ttname"><a href="a00147.html#adf1be5ccbb7a2522b4f3a64043c72880">absolute</a></div><div class="ttdeci">#define absolute(a)</div><div class="ttdef"><b>Definition:</b> <a href="a00147_source.html#l00033">mathfunctions.h:33</a></div></div>
</div><!-- fragment --><p>Compute the WENO weights according the the WENO-Z formulation: </p>
<p class="formulaDsp">
\begin{equation} \omega_k = \frac {a_k} {\sum_{j=1}^3 a_j },\ a_k = c_k \left( 1 + \frac{\tau_5}{\beta_k+\epsilon} \right)^p,\ k = 1,2,3, \end{equation}
</p>
<p> where \(c_k\) are the optimal weights, \(p\) is hardcoded to \(2\), and \(\epsilon\) is an input parameter (<a class="el" href="a00105.html#a974b448c3d0a13d483d36ef15de369b5">WENOParameters::eps</a>) (typically \(10^{-6}\)). The smoothness indicators \(\beta_k\) are given by: </p>
<p class="formulaDsp">
\begin{eqnarray} \beta_1 &amp;=&amp; \frac{13}{12} \left(f_{j-2}-2f_{j-1}+f_j\right)^2 + \frac{1}{4}\left(f_{j-2}-4f_{j-1}+3f_j\right)^2 \\ \beta_2 &amp;=&amp; \frac{13}{12} \left(f_{j-1}-2f_j+f_{j+1}\right)^2 + \frac{1}{4}\left(f_{j-1}-f_{j+1}\right)^2 \\ \beta_3 &amp;=&amp; \frac{13}{12} \left(f_j-2f_{j+1}+f_{j+2}\right)^2 + \frac{1}{4}\left(3f_j-4f_{j+1}+f_{j+2}\right)^2, \end{eqnarray}
</p>
<p> and \(\tau_5 = \left|\beta_1 - \beta_3 \right|\).</p>
<p><b>Notes:</b> </p>
<ul>
<li>This macro computes the weights for one variable along one grid line.</li>
</ul>
<p><b>Arguments:</b> </p>
<ul>
<li><em>w1</em>, <em>w2</em>,<em>w3</em> are the nonlinear WENO weights.<br/>
</li>
<li><em>c1</em>, <em>c2</em>,<em>c3</em> are optimal coefficients.</li>
<li><em>m3</em>, <em>m2</em>,<em>m1</em>,<em>p1</em>,<em>p2</em> are the function values at stencil points corresponding to the interface j+1/2: j-2,j-1,j,j+1,j+2</li>
<li><em>weno</em> is an object of type <a class="el" href="a00105.html#a00523" title="Structure of variables/parameters needed by the WENO-type scheme. ">WENOParameters</a> containing parameters for the WENO method.</li>
<li><em>N</em> is the number of interfaces along the grid line on which this WENO-type reconstruction is happening.</li>
</ul>
<p><b>Reference:</b> </p>
<ul>
<li>Borges, et. al., An improved weighted essentially non-oscillatory scheme for hyperbolic conservation laws, J. Comput. Phys., 2008. <a href="http://dx.doi.org/10.1016/j.jcp.2007.11.038">http://dx.doi.org/10.1016/j.jcp.2007.11.038</a></li>
<li>Castro, M., Costa, B., Don, W. S., High order weighted essentially non-oscillatory WENO-Z schemes for hyperbolic conservation laws, J. Comput. Phys., 2011. <a href="http://dx.doi.org/10.1016/j.jcp.2010.11.028">http://dx.doi.org/10.1016/j.jcp.2010.11.028</a> </li>
</ul>

<p>Definition at line <a class="el" href="a00105_source.html#l00353">353</a> of file <a class="el" href="a00105_source.html">interpolation.h</a>.</p>

</div>
</div>
<a class="anchor" id="ad98f4bd3af977c9a0bc686ba4e6bb15e"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define _WENOWeights_v_YC_</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">w1, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">w2, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">w3, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">c1, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">c2, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">c3, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">m3, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">m2, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">m1, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">p1, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">p2, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">weno, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">N&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<b>Value:</b><div class="fragment"><div class="line">{ \</div>
<div class="line">    int idx; \</div>
<div class="line">    <span class="comment">/* calculate smoothness indicators and the WENO weights */</span>\</div>
<div class="line">    double b1, b2, b3, a1, a2, a3, a_sum_inv, tau; \</div>
<div class="line">    for (idx=0; idx&lt;N; idx++) { \</div>
<div class="line">      b1 = thirteen_by_twelve*(m3[idx]-2*m2[idx]+m1[idx])*(m3[idx]-2*m2[idx]+m1[idx]) \</div>
<div class="line">           + one_fourth*(m3[idx]-4*m2[idx]+3*m1[idx])*(m3[idx]-4*m2[idx]+3*m1[idx]);  \</div>
<div class="line">      b2 = thirteen_by_twelve*(m2[idx]-2*m1[idx]+p1[idx])*(m2[idx]-2*m1[idx]+p1[idx]) \</div>
<div class="line">           + one_fourth*(m2[idx]-p1[idx])*(m2[idx]-p1[idx]);                \</div>
<div class="line">      b3 = thirteen_by_twelve*(m1[idx]-2*p1[idx]+p2[idx])*(m1[idx]-2*p1[idx]+p2[idx]) \</div>
<div class="line">           + one_fourth*(3*m1[idx]-4*p1[idx]+p2[idx])*(3*m1[idx]-4*p1[idx]+p2[idx]);  \</div>
<div class="line">      tau = (m3[idx]-4*m2[idx]+6*m1[idx]-4*p1[idx]+p2[idx])*(m3[idx]-4*m2[idx]+6*m1[idx]-4*p1[idx]+p2[idx]);  \</div>
<div class="line">      a1 = c1 * (1.0 + (tau/(b1+weno-&gt;eps)) * (tau/(b1+weno-&gt;eps)) );  \</div>
<div class="line">      a2 = c2 * (1.0 + (tau/(b2+weno-&gt;eps)) * (tau/(b2+weno-&gt;eps)) );  \</div>
<div class="line">      a3 = c3 * (1.0 + (tau/(b3+weno-&gt;eps)) * (tau/(b3+weno-&gt;eps)) );  \</div>
<div class="line">      a_sum_inv = 1.0 / (a1 + a2 + a3); \</div>
<div class="line">      w1[idx] = a1 * a_sum_inv; \</div>
<div class="line">      w2[idx] = a2 * a_sum_inv; \</div>
<div class="line">      w3[idx] = a3 * a_sum_inv; \</div>
<div class="line">    } \</div>
<div class="line">  }</div>
</div><!-- fragment --><p>Compute the WENO weights according the the ESWENO formulation of Yamaleev &amp; Carpenter. Note that only the formulation for the nonlinear weights is adopted and implemented here, not the ESWENO scheme as a whole. </p>
<p class="formulaDsp">
\begin{equation} \omega_k = \frac {a_k} {\sum_{j=1}^3 a_j },\ a_k = c_k \left( 1 + \frac{\tau_5}{\beta_k+\epsilon} \right)^p,\ k = 1,2,3, \end{equation}
</p>
<p> where \(c_k\) are the optimal weights, \(p\) is hardcoded to \(2\), and \(\epsilon\) is an input parameter (<a class="el" href="a00105.html#a974b448c3d0a13d483d36ef15de369b5">WENOParameters::eps</a>) (typically \(10^{-6}\)). The smoothness indicators \(\beta_k\) are given by: </p>
<p class="formulaDsp">
\begin{eqnarray} \beta_1 &amp;=&amp; \frac{13}{12} \left(f_{j-2}-2f_{j-1}+f_j\right)^2 + \frac{1}{4}\left(f_{j-2}-4f_{j-1}+3f_j\right)^2 \\ \beta_2 &amp;=&amp; \frac{13}{12} \left(f_{j-1}-2f_j+f_{j+1}\right)^2 + \frac{1}{4}\left(f_{j-1}-f_{j+1}\right)^2 \\ \beta_3 &amp;=&amp; \frac{13}{12} \left(f_j-2f_{j+1}+f_{j+2}\right)^2 + \frac{1}{4}\left(3f_j-4f_{j+1}+f_{j+2}\right)^2, \end{eqnarray}
</p>
<p> and \(\tau_5 = \left( f_{j-2}-4f_{j-1}+6f_j-4f_{j+1}+f_{j+2} \right)^2\).</p>
<p><b>Notes:</b> </p>
<ul>
<li>This macro computes the weights for one variable along one grid line.</li>
</ul>
<p><b>Arguments:</b> </p>
<ul>
<li><em>w1</em>, <em>w2</em>,<em>w3</em> are the nonlinear WENO weights.<br/>
</li>
<li><em>c1</em>, <em>c2</em>,<em>c3</em> are optimal coefficients.<br/>
</li>
<li><em>m3</em>, <em>m2</em>,<em>m1</em>,<em>p1</em>,<em>p2</em> are the function values at stencil points corresponding to the interface j+1/2: j-2,j-1,j,j+1,j+2<br/>
</li>
<li><em>weno</em> is an object of type <a class="el" href="a00105.html#a00523" title="Structure of variables/parameters needed by the WENO-type scheme. ">WENOParameters</a> containing parameters for the WENO method.<br/>
</li>
<li><em>N</em> is the number of interfaces along the grid line on which this WENO-type reconstruction is happening.<br/>
 <b>Reference:</b> <ul>
<li>Yamaleev, Carpenter, A systematic methodology for constructing high-order energy stable WENO schemes, J. Comput. Phys., 2009. <a href="http://dx.doi.org/10.1016/j.jcp.2009.03.002">http://dx.doi.org/10.1016/j.jcp.2009.03.002</a> </li>
</ul>
</li>
</ul>

<p>Definition at line <a class="el" href="a00105_source.html#l00406">406</a> of file <a class="el" href="a00105_source.html">interpolation.h</a>.</p>

</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a class="anchor" id="a0a067c9c4745556845b9bcb7f049b59b"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int Interp1PrimFirstOrderUpwind </td>
          <td>(</td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>fI</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>fC</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>u</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>upw</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>dir</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>s</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>m</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>uflag</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>1st order upwind reconstruction (component-wise) on a uniform grid </p>
<p>Component-wise interpolation of the first primitive at the cell interfaces using the first-order upwind scheme</p>
<p>Computes the interpolated values of the first primitive of a function \({\bf f}\left({\bf u}\right)\) at the interfaces from the cell-centered values of the function using the 1st order upwind scheme on a uniform grid. The first primitive is defined as a function \({\bf h}\left({\bf u}\right)\) that satisfies: </p>
<p class="formulaDsp">
\begin{equation} {\bf f}\left({\bf u}\left(x\right)\right) = \frac{1}{\Delta x} \int_{x-\Delta x/2}^{x+\Delta x/2} {\bf h}\left({\bf u}\left(\zeta\right)\right)d\zeta, \end{equation}
</p>
<p> where \(x\) is the spatial coordinate along the dimension of the interpolation. This function computes the 1st order upwind numerical approximation \(\hat{\bf f}_{j+1/2} \approx {\bf h}_{j+1/2}\) as: </p>
<p class="formulaDsp">
\begin{equation} \hat{\bf f}_{j+1/2} = \left\{\begin{array}{cc} {\bf f}_{j} &amp; {\rm upw} &gt; 0 \\ {\bf f}_{j+1} &amp; {\rm upw} \le 0 \end{array}\right.. \end{equation}
</p>
<p><b>Implementation</b> <b>Notes:</b> </p>
<ul>
<li>The scalar interpolation method is applied to the vector function in a component-wise manner.</li>
<li>The function computes the interpolant for the entire grid in one call. It loops over all the grid lines along the interpolation direction and carries out the 1D interpolation along these grid lines.</li>
<li>Location of cell-centers and cell interfaces along the spatial dimension of the interpolation is shown in the following figure: <div class="image">
<img src="chap1_1Ddomain.png" alt="chap1_1Ddomain.png"/>
</div>
 </li>
</ul>
<p><b>Function</b> <b>arguments:</b> </p>
<table class="doxtable">
<tr>
<th>Argument </th><th>Type </th><th>Explanation  </th></tr>
<tr>
<td>fI </td><td>double* </td><td>Array to hold the computed interpolant at the grid interfaces. This array must have the same layout as the solution, but with <b>no</b> <b>ghost</b> <b>points</b>. Its size should be the same as u in all dimensions, except dir (the dimension along which to interpolate) along which it should be larger by 1 (number of interfaces is 1 more than the number of interior cell centers). </td></tr>
<tr>
<td>fC </td><td>double* </td><td>Array with the cell-centered values of the flux function \({\bf f}\left({\bf u}\right)\). This array must have the same layout and size as the solution, <b>with</b> <b>ghost</b> <b>points</b>. </td></tr>
<tr>
<td>u </td><td>double* </td><td>The solution array \({\bf u}\) (with ghost points). If the interpolation is characteristic based, this is needed to compute the eigendecomposition. For a multidimensional problem, the layout is as follows: u is a contiguous 1D array of size (nvars*dim[0]*dim[1]*...*dim[D-1]) corresponding to the multi-dimensional solution, with the following ordering - nvars, dim[0], dim[1], ..., dim[D-1], where nvars is the number of solution components (<a class="el" href="a00115.html#ae8f6d2fd6490d3153cb4133bf183a404">HyPar::nvars</a>), dim is the local size (<a class="el" href="a00115.html#a38e0371f331cecbe63a77fa03e202afe">HyPar::dim_local</a>), D is the number of spatial dimensions. </td></tr>
<tr>
<td>x </td><td>double* </td><td>The grid array (with ghost points). This is used only by non-uniform-grid interpolation methods. For multidimensional problems, the layout is as follows: x is a contiguous 1D array of size (dim[0]+dim[1]+...+dim[D-1]), with the spatial coordinates along dim[0] stored from 0,...,dim[0]-1, the spatial coordinates along dim[1] stored along dim[0],...,dim[0]+dim[1]-1, and so forth. </td></tr>
<tr>
<td>upw </td><td>int </td><td>Upwinding direction: if positive, a left-biased interpolant will be computed; if negative, a right-biased interpolant will be computed. If the interpolation method is central, then this has no effect. </td></tr>
<tr>
<td>dir </td><td>int </td><td>Spatial dimension along which to interpolate (eg: 0 for 1D; 0 or 1 for 2D; 0,1 or 2 for 3D) </td></tr>
<tr>
<td>s </td><td>void* </td><td>Solver object of type <a class="el" href="a00115.html" title="Structure containing all solver-specific variables and functions. ">HyPar</a>: the following variables are needed - <a class="el" href="a00115.html#aafc992b5fa79d5a4036024615d03bce6">HyPar::ghosts</a>, <a class="el" href="a00115.html#a484873c74138512e41bc50d17b7d955a">HyPar::ndims</a>, <a class="el" href="a00115.html#ae8f6d2fd6490d3153cb4133bf183a404">HyPar::nvars</a>, <a class="el" href="a00115.html#a38e0371f331cecbe63a77fa03e202afe">HyPar::dim_local</a>. </td></tr>
<tr>
<td>m </td><td>void* </td><td>MPI object of type <a class="el" href="a00117.html#a00516" title="Structure of MPI-related variables. ">MPIVariables</a>: this is needed only by compact interpolation method that need to solve a global implicit system across MPI ranks. </td></tr>
<tr>
<td>uflag </td><td>int </td><td>A flag indicating if the function being interpolated \({\bf f}\) is the solution itself \({\bf u}\) (if 1, \({\bf f}\left({\bf u}\right) \equiv {\bf u}\)). </td></tr>
</table>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">fI</td><td>Array of interpolated function values at the interfaces </td></tr>
    <tr><td class="paramname">fC</td><td>Array of cell-centered values of the function \({\bf f}\left({\bf u}\right)\) </td></tr>
    <tr><td class="paramname">u</td><td>Array of cell-centered values of the solution \({\bf u}\) </td></tr>
    <tr><td class="paramname">x</td><td>Grid coordinates </td></tr>
    <tr><td class="paramname">upw</td><td>Upwind direction (left or right biased) </td></tr>
    <tr><td class="paramname">dir</td><td>Spatial dimension along which to interpolation </td></tr>
    <tr><td class="paramname">s</td><td>Object of type <a class="el" href="a00115.html" title="Structure containing all solver-specific variables and functions. ">HyPar</a> containing solver-related variables </td></tr>
    <tr><td class="paramname">m</td><td>Object of type <a class="el" href="a00117.html#a00516" title="Structure of MPI-related variables. ">MPIVariables</a> containing MPI-related variables </td></tr>
    <tr><td class="paramname">uflag</td><td>Flag to indicate if \(f(u) \equiv u\), i.e, if the solution is being reconstructed </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="a00232_source.html#l00061">61</a> of file <a class="el" href="a00232_source.html">Interp1PrimFirstOrderUpwind.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;{</div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;  <a class="code" href="a00115.html">HyPar</a>         *solver = (<a class="code" href="a00115.html">HyPar</a>*)        s;</div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;</div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;  <span class="keywordtype">int</span> ghosts = solver-&gt;<a class="code" href="a00115.html#aafc992b5fa79d5a4036024615d03bce6">ghosts</a>;</div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;  <span class="keywordtype">int</span> ndims  = solver-&gt;<a class="code" href="a00115.html#a484873c74138512e41bc50d17b7d955a">ndims</a>;</div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;  <span class="keywordtype">int</span> nvars  = solver-&gt;<a class="code" href="a00115.html#ae8f6d2fd6490d3153cb4133bf183a404">nvars</a>;</div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;  <span class="keywordtype">int</span> *dim   = solver-&gt;<a class="code" href="a00115.html#a38e0371f331cecbe63a77fa03e202afe">dim_local</a>;</div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;</div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;  <span class="comment">/* create index and bounds for the outer loop, i.e., to loop over all 1D lines along</span></div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;<span class="comment">     dimension &quot;dir&quot;                                                                    */</span></div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;  <span class="keywordtype">int</span> indexC[ndims], indexI[ndims], index_outer[ndims], bounds_outer[ndims], bounds_inter[ndims];</div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;  <a class="code" href="a00136.html#a89e8330d9e06dd0666c50833628a125c">_ArrayCopy1D_</a>(dim,bounds_outer,ndims); bounds_outer[dir] =  1;</div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;  <a class="code" href="a00136.html#a89e8330d9e06dd0666c50833628a125c">_ArrayCopy1D_</a>(dim,bounds_inter,ndims); bounds_inter[dir] += 1;</div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;  <span class="keywordtype">int</span> N_outer; <a class="code" href="a00136.html#abc65e9c6a51b875f46fdb054a0ecf604">_ArrayProduct1D_</a>(bounds_outer,ndims,N_outer);</div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;</div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;  <span class="keywordtype">int</span> i;</div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;<span class="preprocessor">#pragma omp parallel for schedule(auto) default(shared) private(i,index_outer,indexC,indexI)</span></div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;<span class="preprocessor"></span>  <span class="keywordflow">for</span> (i=0; i&lt;N_outer; i++) {</div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;    <a class="code" href="a00136.html#a03f49e4d44ae8aca85cb04cfe91e4ce4">_ArrayIndexnD_</a>(ndims,i,bounds_outer,index_outer,0);</div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;    <a class="code" href="a00136.html#a89e8330d9e06dd0666c50833628a125c">_ArrayCopy1D_</a>(index_outer,indexC,ndims);</div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;    <a class="code" href="a00136.html#a89e8330d9e06dd0666c50833628a125c">_ArrayCopy1D_</a>(index_outer,indexI,ndims);</div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;    <span class="keywordflow">for</span> (indexI[dir] = 0; indexI[dir] &lt; dim[dir]+1; indexI[dir]++) {</div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;      indexC[dir] = (upw &gt; 0 ? indexI[dir]-1 : indexI[dir]);</div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;      <span class="keywordtype">int</span> p; <a class="code" href="a00136.html#afbb862a2fdf5b72b1f9ace42f64b556f">_ArrayIndex1D_</a>(ndims,bounds_inter,indexI,0     ,p);</div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;      <span class="keywordtype">int</span> q; <a class="code" href="a00136.html#afbb862a2fdf5b72b1f9ace42f64b556f">_ArrayIndex1D_</a>(ndims,dim         ,indexC,ghosts,q);</div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;      <span class="keywordtype">int</span> v; <span class="keywordflow">for</span> (v=0; v&lt;nvars; v++)  fI[p*nvars+v] = fC[q*nvars+v];</div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;    }</div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;  }</div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;</div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;  <span class="keywordflow">return</span>(0);</div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;}</div>
<div class="ttc" id="a00115_html_a484873c74138512e41bc50d17b7d955a"><div class="ttname"><a href="a00115.html#a484873c74138512e41bc50d17b7d955a">HyPar::ndims</a></div><div class="ttdeci">int ndims</div><div class="ttdef"><b>Definition:</b> <a href="a00143_source.html#l00026">hypar.h:26</a></div></div>
<div class="ttc" id="a00115_html_aafc992b5fa79d5a4036024615d03bce6"><div class="ttname"><a href="a00115.html#aafc992b5fa79d5a4036024615d03bce6">HyPar::ghosts</a></div><div class="ttdeci">int ghosts</div><div class="ttdef"><b>Definition:</b> <a href="a00143_source.html#l00044">hypar.h:44</a></div></div>
<div class="ttc" id="a00115_html"><div class="ttname"><a href="a00115.html">HyPar</a></div><div class="ttdoc">Structure containing all solver-specific variables and functions. </div><div class="ttdef"><b>Definition:</b> <a href="a00143_source.html#l00023">hypar.h:23</a></div></div>
<div class="ttc" id="a00115_html_ae8f6d2fd6490d3153cb4133bf183a404"><div class="ttname"><a href="a00115.html#ae8f6d2fd6490d3153cb4133bf183a404">HyPar::nvars</a></div><div class="ttdeci">int nvars</div><div class="ttdef"><b>Definition:</b> <a href="a00143_source.html#l00029">hypar.h:29</a></div></div>
<div class="ttc" id="a00136_html_a89e8330d9e06dd0666c50833628a125c"><div class="ttname"><a href="a00136.html#a89e8330d9e06dd0666c50833628a125c">_ArrayCopy1D_</a></div><div class="ttdeci">#define _ArrayCopy1D_(x, y, size)</div><div class="ttdef"><b>Definition:</b> <a href="a00136_source.html#l00318">arrayfunctions.h:318</a></div></div>
<div class="ttc" id="a00115_html_a38e0371f331cecbe63a77fa03e202afe"><div class="ttname"><a href="a00115.html#a38e0371f331cecbe63a77fa03e202afe">HyPar::dim_local</a></div><div class="ttdeci">int * dim_local</div><div class="ttdef"><b>Definition:</b> <a href="a00143_source.html#l00035">hypar.h:35</a></div></div>
<div class="ttc" id="a00136_html_a03f49e4d44ae8aca85cb04cfe91e4ce4"><div class="ttname"><a href="a00136.html#a03f49e4d44ae8aca85cb04cfe91e4ce4">_ArrayIndexnD_</a></div><div class="ttdeci">#define _ArrayIndexnD_(N, index, imax, i, ghost)</div><div class="ttdef"><b>Definition:</b> <a href="a00136_source.html#l00020">arrayfunctions.h:20</a></div></div>
<div class="ttc" id="a00136_html_abc65e9c6a51b875f46fdb054a0ecf604"><div class="ttname"><a href="a00136.html#abc65e9c6a51b875f46fdb054a0ecf604">_ArrayProduct1D_</a></div><div class="ttdeci">#define _ArrayProduct1D_(x, size, p)</div><div class="ttdef"><b>Definition:</b> <a href="a00136_source.html#l00376">arrayfunctions.h:376</a></div></div>
<div class="ttc" id="a00136_html_afbb862a2fdf5b72b1f9ace42f64b556f"><div class="ttname"><a href="a00136.html#afbb862a2fdf5b72b1f9ace42f64b556f">_ArrayIndex1D_</a></div><div class="ttdeci">#define _ArrayIndex1D_(N, imax, i, ghost, index)</div><div class="ttdef"><b>Definition:</b> <a href="a00136_source.html#l00039">arrayfunctions.h:39</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a697d5c94aa331054c5286492e7fa39c7"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int Interp1PrimSecondOrderCentral </td>
          <td>(</td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>fI</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>fC</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>u</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>upw</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>dir</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>s</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>m</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>uflag</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>2nd order central reconstruction (component-wise) on a uniform grid </p>
<p>Component-wise interpolation of the first primitive at the cell interfaces using the second-order central scheme</p>
<p>Computes the interpolated values of the first primitive of a function \({\bf f}\left({\bf u}\right)\) at the interfaces from the cell-centered values of the function using the 2nd order central scheme on a uniform grid. The first primitive is defined as a function \({\bf h}\left({\bf u}\right)\) that satisfies: </p>
<p class="formulaDsp">
\begin{equation} {\bf f}\left({\bf u}\left(x\right)\right) = \frac{1}{\Delta x} \int_{x-\Delta x/2}^{x+\Delta x/2} {\bf h}\left({\bf u}\left(\zeta\right)\right)d\zeta, \end{equation}
</p>
<p> where \(x\) is the spatial coordinate along the dimension of the interpolation. This function computes the 2nd order central numerical approximation \(\hat{\bf f}_{j+1/2} \approx {\bf h}_{j+1/2}\) as: </p>
<p class="formulaDsp">
\begin{equation} \hat{\bf f}_{j+1/2} = \frac{1}{2}\left( {\bf f}_{j} + {\bf f}_{j+1} \right). \end{equation}
</p>
<p><b>Implementation</b> <b>Notes:</b> </p>
<ul>
<li>The scalar interpolation method is applied to the vector function in a component-wise manner.</li>
<li>Since this is a central scheme, the input argument <b>upw</b> has no effect.</li>
<li>The function computes the interpolant for the entire grid in one call. It loops over all the grid lines along the interpolation direction and carries out the 1D interpolation along these grid lines.</li>
<li>Location of cell-centers and cell interfaces along the spatial dimension of the interpolation is shown in the following figure: <div class="image">
<img src="chap1_1Ddomain.png" alt="chap1_1Ddomain.png"/>
</div>
 </li>
</ul>
<p><b>Function</b> <b>arguments:</b> </p>
<table class="doxtable">
<tr>
<th>Argument </th><th>Type </th><th>Explanation  </th></tr>
<tr>
<td>fI </td><td>double* </td><td>Array to hold the computed interpolant at the grid interfaces. This array must have the same layout as the solution, but with <b>no</b> <b>ghost</b> <b>points</b>. Its size should be the same as u in all dimensions, except dir (the dimension along which to interpolate) along which it should be larger by 1 (number of interfaces is 1 more than the number of interior cell centers). </td></tr>
<tr>
<td>fC </td><td>double* </td><td>Array with the cell-centered values of the flux function \({\bf f}\left({\bf u}\right)\). This array must have the same layout and size as the solution, <b>with</b> <b>ghost</b> <b>points</b>. </td></tr>
<tr>
<td>u </td><td>double* </td><td>The solution array \({\bf u}\) (with ghost points). If the interpolation is characteristic based, this is needed to compute the eigendecomposition. For a multidimensional problem, the layout is as follows: u is a contiguous 1D array of size (nvars*dim[0]*dim[1]*...*dim[D-1]) corresponding to the multi-dimensional solution, with the following ordering - nvars, dim[0], dim[1], ..., dim[D-1], where nvars is the number of solution components (<a class="el" href="a00115.html#ae8f6d2fd6490d3153cb4133bf183a404">HyPar::nvars</a>), dim is the local size (<a class="el" href="a00115.html#a38e0371f331cecbe63a77fa03e202afe">HyPar::dim_local</a>), D is the number of spatial dimensions. </td></tr>
<tr>
<td>x </td><td>double* </td><td>The grid array (with ghost points). This is used only by non-uniform-grid interpolation methods. For multidimensional problems, the layout is as follows: x is a contiguous 1D array of size (dim[0]+dim[1]+...+dim[D-1]), with the spatial coordinates along dim[0] stored from 0,...,dim[0]-1, the spatial coordinates along dim[1] stored along dim[0],...,dim[0]+dim[1]-1, and so forth. </td></tr>
<tr>
<td>upw </td><td>int </td><td>Upwinding direction: if positive, a left-biased interpolant will be computed; if negative, a right-biased interpolant will be computed. If the interpolation method is central, then this has no effect. </td></tr>
<tr>
<td>dir </td><td>int </td><td>Spatial dimension along which to interpolate (eg: 0 for 1D; 0 or 1 for 2D; 0,1 or 2 for 3D) </td></tr>
<tr>
<td>s </td><td>void* </td><td>Solver object of type <a class="el" href="a00115.html" title="Structure containing all solver-specific variables and functions. ">HyPar</a>: the following variables are needed - <a class="el" href="a00115.html#aafc992b5fa79d5a4036024615d03bce6">HyPar::ghosts</a>, <a class="el" href="a00115.html#a484873c74138512e41bc50d17b7d955a">HyPar::ndims</a>, <a class="el" href="a00115.html#ae8f6d2fd6490d3153cb4133bf183a404">HyPar::nvars</a>, <a class="el" href="a00115.html#a38e0371f331cecbe63a77fa03e202afe">HyPar::dim_local</a>. </td></tr>
<tr>
<td>m </td><td>void* </td><td>MPI object of type <a class="el" href="a00117.html#a00516" title="Structure of MPI-related variables. ">MPIVariables</a>: this is needed only by compact interpolation method that need to solve a global implicit system across MPI ranks. </td></tr>
<tr>
<td>uflag </td><td>int </td><td>A flag indicating if the function being interpolated \({\bf f}\) is the solution itself \({\bf u}\) (if 1, \({\bf f}\left({\bf u}\right) \equiv {\bf u}\)). </td></tr>
</table>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">fI</td><td>Array of interpolated function values at the interfaces </td></tr>
    <tr><td class="paramname">fC</td><td>Array of cell-centered values of the function \({\bf f}\left({\bf u}\right)\) </td></tr>
    <tr><td class="paramname">u</td><td>Array of cell-centered values of the solution \({\bf u}\) </td></tr>
    <tr><td class="paramname">x</td><td>Grid coordinates </td></tr>
    <tr><td class="paramname">upw</td><td>Upwind direction (left or right biased) </td></tr>
    <tr><td class="paramname">dir</td><td>Spatial dimension along which to interpolation </td></tr>
    <tr><td class="paramname">s</td><td>Object of type <a class="el" href="a00115.html" title="Structure containing all solver-specific variables and functions. ">HyPar</a> containing solver-related variables </td></tr>
    <tr><td class="paramname">m</td><td>Object of type <a class="el" href="a00117.html#a00516" title="Structure of MPI-related variables. ">MPIVariables</a> containing MPI-related variables </td></tr>
    <tr><td class="paramname">uflag</td><td>Flag to indicate if \(f(u) \equiv u\), i.e, if the solution is being reconstructed </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="a00234_source.html#l00062">62</a> of file <a class="el" href="a00234_source.html">Interp1PrimSecondOrderCentral.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;{</div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;  <a class="code" href="a00115.html">HyPar</a>         *solver = (<a class="code" href="a00115.html">HyPar</a>*)        s;</div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;</div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;  <span class="keywordtype">int</span> ghosts = solver-&gt;<a class="code" href="a00115.html#aafc992b5fa79d5a4036024615d03bce6">ghosts</a>;</div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;  <span class="keywordtype">int</span> ndims  = solver-&gt;<a class="code" href="a00115.html#a484873c74138512e41bc50d17b7d955a">ndims</a>;</div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;  <span class="keywordtype">int</span> nvars  = solver-&gt;<a class="code" href="a00115.html#ae8f6d2fd6490d3153cb4133bf183a404">nvars</a>;</div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;  <span class="keywordtype">int</span> *dim   = solver-&gt;<a class="code" href="a00115.html#a38e0371f331cecbe63a77fa03e202afe">dim_local</a>;</div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;</div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;  <span class="comment">/* create index and bounds for the outer loop, i.e., to loop over all 1D lines along</span></div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;<span class="comment">     dimension &quot;dir&quot;                                                                    */</span></div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;  <span class="keywordtype">int</span> indexL[ndims], indexR[ndims], indexI[ndims], index_outer[ndims], bounds_outer[ndims], bounds_inter[ndims];</div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;  <a class="code" href="a00136.html#a89e8330d9e06dd0666c50833628a125c">_ArrayCopy1D_</a>(dim,bounds_outer,ndims); bounds_outer[dir] =  1;</div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;  <a class="code" href="a00136.html#a89e8330d9e06dd0666c50833628a125c">_ArrayCopy1D_</a>(dim,bounds_inter,ndims); bounds_inter[dir] += 1;</div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;  <span class="keywordtype">int</span> N_outer; <a class="code" href="a00136.html#abc65e9c6a51b875f46fdb054a0ecf604">_ArrayProduct1D_</a>(bounds_outer,ndims,N_outer);</div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;</div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;  <span class="keywordtype">int</span> i;</div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;<span class="preprocessor">#pragma omp parallel for schedule(auto) default(shared) private(i,index_outer,indexL,indexR,indexI)</span></div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;<span class="preprocessor"></span>  <span class="keywordflow">for</span> (i=0; i&lt;N_outer; i++) {</div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;    <a class="code" href="a00136.html#a03f49e4d44ae8aca85cb04cfe91e4ce4">_ArrayIndexnD_</a>(ndims,i,bounds_outer,index_outer,0);</div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;    <a class="code" href="a00136.html#a89e8330d9e06dd0666c50833628a125c">_ArrayCopy1D_</a>(index_outer,indexL,ndims);</div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;    <a class="code" href="a00136.html#a89e8330d9e06dd0666c50833628a125c">_ArrayCopy1D_</a>(index_outer,indexR,ndims);</div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;    <a class="code" href="a00136.html#a89e8330d9e06dd0666c50833628a125c">_ArrayCopy1D_</a>(index_outer,indexI,ndims);</div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;    <span class="keywordflow">for</span> (indexI[dir] = 0; indexI[dir] &lt; dim[dir]+1; indexI[dir]++) {</div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;      indexL[dir] = indexI[dir]-1;</div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;      indexR[dir] = indexI[dir];</div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;      <span class="keywordtype">int</span> p;  <a class="code" href="a00136.html#afbb862a2fdf5b72b1f9ace42f64b556f">_ArrayIndex1D_</a>(ndims,bounds_inter,indexI,0     ,p);</div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;      <span class="keywordtype">int</span> qL; <a class="code" href="a00136.html#afbb862a2fdf5b72b1f9ace42f64b556f">_ArrayIndex1D_</a>(ndims,dim         ,indexL,ghosts,qL);</div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;      <span class="keywordtype">int</span> qR; <a class="code" href="a00136.html#afbb862a2fdf5b72b1f9ace42f64b556f">_ArrayIndex1D_</a>(ndims,dim         ,indexR,ghosts,qR);</div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;      <span class="keywordtype">int</span> v; <span class="keywordflow">for</span> (v=0; v&lt;nvars; v++)  fI[p*nvars+v] = 0.5*(fC[qL*nvars+v]+fC[qR*nvars+v]);</div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;    }</div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;  }</div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;</div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;  <span class="keywordflow">return</span>(0);</div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;}</div>
<div class="ttc" id="a00115_html_a484873c74138512e41bc50d17b7d955a"><div class="ttname"><a href="a00115.html#a484873c74138512e41bc50d17b7d955a">HyPar::ndims</a></div><div class="ttdeci">int ndims</div><div class="ttdef"><b>Definition:</b> <a href="a00143_source.html#l00026">hypar.h:26</a></div></div>
<div class="ttc" id="a00115_html_aafc992b5fa79d5a4036024615d03bce6"><div class="ttname"><a href="a00115.html#aafc992b5fa79d5a4036024615d03bce6">HyPar::ghosts</a></div><div class="ttdeci">int ghosts</div><div class="ttdef"><b>Definition:</b> <a href="a00143_source.html#l00044">hypar.h:44</a></div></div>
<div class="ttc" id="a00115_html"><div class="ttname"><a href="a00115.html">HyPar</a></div><div class="ttdoc">Structure containing all solver-specific variables and functions. </div><div class="ttdef"><b>Definition:</b> <a href="a00143_source.html#l00023">hypar.h:23</a></div></div>
<div class="ttc" id="a00115_html_ae8f6d2fd6490d3153cb4133bf183a404"><div class="ttname"><a href="a00115.html#ae8f6d2fd6490d3153cb4133bf183a404">HyPar::nvars</a></div><div class="ttdeci">int nvars</div><div class="ttdef"><b>Definition:</b> <a href="a00143_source.html#l00029">hypar.h:29</a></div></div>
<div class="ttc" id="a00136_html_a89e8330d9e06dd0666c50833628a125c"><div class="ttname"><a href="a00136.html#a89e8330d9e06dd0666c50833628a125c">_ArrayCopy1D_</a></div><div class="ttdeci">#define _ArrayCopy1D_(x, y, size)</div><div class="ttdef"><b>Definition:</b> <a href="a00136_source.html#l00318">arrayfunctions.h:318</a></div></div>
<div class="ttc" id="a00115_html_a38e0371f331cecbe63a77fa03e202afe"><div class="ttname"><a href="a00115.html#a38e0371f331cecbe63a77fa03e202afe">HyPar::dim_local</a></div><div class="ttdeci">int * dim_local</div><div class="ttdef"><b>Definition:</b> <a href="a00143_source.html#l00035">hypar.h:35</a></div></div>
<div class="ttc" id="a00136_html_a03f49e4d44ae8aca85cb04cfe91e4ce4"><div class="ttname"><a href="a00136.html#a03f49e4d44ae8aca85cb04cfe91e4ce4">_ArrayIndexnD_</a></div><div class="ttdeci">#define _ArrayIndexnD_(N, index, imax, i, ghost)</div><div class="ttdef"><b>Definition:</b> <a href="a00136_source.html#l00020">arrayfunctions.h:20</a></div></div>
<div class="ttc" id="a00136_html_abc65e9c6a51b875f46fdb054a0ecf604"><div class="ttname"><a href="a00136.html#abc65e9c6a51b875f46fdb054a0ecf604">_ArrayProduct1D_</a></div><div class="ttdeci">#define _ArrayProduct1D_(x, size, p)</div><div class="ttdef"><b>Definition:</b> <a href="a00136_source.html#l00376">arrayfunctions.h:376</a></div></div>
<div class="ttc" id="a00136_html_afbb862a2fdf5b72b1f9ace42f64b556f"><div class="ttname"><a href="a00136.html#afbb862a2fdf5b72b1f9ace42f64b556f">_ArrayIndex1D_</a></div><div class="ttdeci">#define _ArrayIndex1D_(N, imax, i, ghost, index)</div><div class="ttdef"><b>Definition:</b> <a href="a00136_source.html#l00039">arrayfunctions.h:39</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a25df96c0eccca13167d28045d187db36"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int Interp1PrimSecondOrderMUSCL </td>
          <td>(</td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>fI</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>fC</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>u</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>upw</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>dir</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>s</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>m</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>uflag</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>2nd order MUSCL scheme (component-wise) on a uniform grid </p>
<p>Component-wise interpolation of the first primitive at the cell interfaces using the second-order MUSCL scheme</p>
<p>Computes the interpolated values of the first primitive of a function \({\bf f}\left({\bf u}\right)\) at the interfaces from the cell-centered values of the function using the 2nd order MUSCL scheme on a uniform grid. The first primitive is defined as a function \({\bf h}\left({\bf u}\right)\) that satisfies: </p>
<p class="formulaDsp">
\begin{equation} {\bf f}\left({\bf u}\left(x\right)\right) = \frac{1}{\Delta x} \int_{x-\Delta x/2}^{x+\Delta x/2} {\bf h}\left({\bf u}\left(\zeta\right)\right)d\zeta, \end{equation}
</p>
<p> where \(x\) is the spatial coordinate along the dimension of the interpolation. This function computes numerical approximation \(\hat{\bf f}_{j+1/2} \approx {\bf h}_{j+1/2}\) as: using the 2nd order MUSCL scheme: </p>
<p class="formulaDsp">
\begin{equation} \hat{\bf f}_{j+1/2} = {\bf f}_{j} + \frac{1}{2} \phi\left(r_j\right) \left[{\bf f}_{j+1}-{\bf f}_{j}\right] \end{equation}
</p>
<p> where </p>
<p class="formulaDsp">
\begin{equation} r_j = \left( f_j - f_{j-1} \right) / \left( f_{j+1} - f_j \right) \end{equation}
</p>
<p> and \(\phi\left(r\right)\) is a limiter (minmod, mc, generalized minmod, etc.)</p>
<p><b>Implementation</b> <b>Notes:</b> </p>
<ul>
<li>The scalar interpolation method is applied to the vector function in a component-wise manner.</li>
<li>The method described above corresponds to a left-biased interpolation. The corresponding right-biased interpolation can be obtained by reflecting the equations about interface j+1/2.</li>
<li>The function computes the interpolant for the entire grid in one call. It loops over all the grid lines along the interpolation direction and carries out the 1D interpolation along these grid lines.</li>
<li>Location of cell-centers and cell interfaces along the spatial dimension of the interpolation is shown in the following figure: <div class="image">
<img src="chap1_1Ddomain.png" alt="chap1_1Ddomain.png"/>
</div>
 </li>
</ul>
<p><b>Function</b> <b>arguments:</b> </p>
<table class="doxtable">
<tr>
<th>Argument </th><th>Type </th><th>Explanation  </th></tr>
<tr>
<td>fI </td><td>double* </td><td>Array to hold the computed interpolant at the grid interfaces. This array must have the same layout as the solution, but with <b>no</b> <b>ghost</b> <b>points</b>. Its size should be the same as u in all dimensions, except dir (the dimension along which to interpolate) along which it should be larger by 1 (number of interfaces is 1 more than the number of interior cell centers). </td></tr>
<tr>
<td>fC </td><td>double* </td><td>Array with the cell-centered values of the flux function \({\bf f}\left({\bf u}\right)\). This array must have the same layout and size as the solution, <b>with</b> <b>ghost</b> <b>points</b>. </td></tr>
<tr>
<td>u </td><td>double* </td><td>The solution array \({\bf u}\) (with ghost points). If the interpolation is characteristic based, this is needed to compute the eigendecomposition. For a multidimensional problem, the layout is as follows: u is a contiguous 1D array of size (nvars*dim[0]*dim[1]*...*dim[D-1]) corresponding to the multi-dimensional solution, with the following ordering - nvars, dim[0], dim[1], ..., dim[D-1], where nvars is the number of solution components (<a class="el" href="a00115.html#ae8f6d2fd6490d3153cb4133bf183a404">HyPar::nvars</a>), dim is the local size (<a class="el" href="a00115.html#a38e0371f331cecbe63a77fa03e202afe">HyPar::dim_local</a>), D is the number of spatial dimensions. </td></tr>
<tr>
<td>x </td><td>double* </td><td>The grid array (with ghost points). This is used only by non-uniform-grid interpolation methods. For multidimensional problems, the layout is as follows: x is a contiguous 1D array of size (dim[0]+dim[1]+...+dim[D-1]), with the spatial coordinates along dim[0] stored from 0,...,dim[0]-1, the spatial coordinates along dim[1] stored along dim[0],...,dim[0]+dim[1]-1, and so forth. </td></tr>
<tr>
<td>upw </td><td>int </td><td>Upwinding direction: if positive, a left-biased interpolant will be computed; if negative, a right-biased interpolant will be computed. If the interpolation method is central, then this has no effect. </td></tr>
<tr>
<td>dir </td><td>int </td><td>Spatial dimension along which to interpolate (eg: 0 for 1D; 0 or 1 for 2D; 0,1 or 2 for 3D) </td></tr>
<tr>
<td>s </td><td>void* </td><td>Solver object of type <a class="el" href="a00115.html" title="Structure containing all solver-specific variables and functions. ">HyPar</a>: the following variables are needed - <a class="el" href="a00115.html#aafc992b5fa79d5a4036024615d03bce6">HyPar::ghosts</a>, <a class="el" href="a00115.html#a484873c74138512e41bc50d17b7d955a">HyPar::ndims</a>, <a class="el" href="a00115.html#ae8f6d2fd6490d3153cb4133bf183a404">HyPar::nvars</a>, <a class="el" href="a00115.html#a38e0371f331cecbe63a77fa03e202afe">HyPar::dim_local</a>. </td></tr>
<tr>
<td>m </td><td>void* </td><td>MPI object of type <a class="el" href="a00117.html#a00516" title="Structure of MPI-related variables. ">MPIVariables</a>: this is needed only by compact interpolation method that need to solve a global implicit system across MPI ranks. </td></tr>
<tr>
<td>uflag </td><td>int </td><td>A flag indicating if the function being interpolated \({\bf f}\) is the solution itself \({\bf u}\) (if 1, \({\bf f}\left({\bf u}\right) \equiv {\bf u}\)). </td></tr>
</table>
<p>Reference:</p>
<ul>
<li>van Leer, B. (1979), Towards the Ultimate Conservative Difference Scheme, V. A Second Order Sequel to Godunov's Method, J. Com. Phys., 32, 101136.</li>
<li>Nessyahu, H. and E. Tadmor (1990), Non-oscillatory central differencing for hyperbolic conservation laws, J. Comput. Phys., 87, 408463. </li>
</ul>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">fI</td><td>Array of interpolated function values at the interfaces </td></tr>
    <tr><td class="paramname">fC</td><td>Array of cell-centered values of the function \({\bf f}\left({\bf u}\right)\) </td></tr>
    <tr><td class="paramname">u</td><td>Array of cell-centered values of the solution \({\bf u}\) </td></tr>
    <tr><td class="paramname">x</td><td>Grid coordinates </td></tr>
    <tr><td class="paramname">upw</td><td>Upwind direction (left or right biased) </td></tr>
    <tr><td class="paramname">dir</td><td>Spatial dimension along which to interpolation </td></tr>
    <tr><td class="paramname">s</td><td>Object of type <a class="el" href="a00115.html" title="Structure containing all solver-specific variables and functions. ">HyPar</a> containing solver-related variables </td></tr>
    <tr><td class="paramname">m</td><td>Object of type <a class="el" href="a00117.html#a00516" title="Structure of MPI-related variables. ">MPIVariables</a> containing MPI-related variables </td></tr>
    <tr><td class="paramname">uflag</td><td>Flag to indicate if \(f(u) \equiv u\), i.e, if the solution is being reconstructed </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="a00236_source.html#l00076">76</a> of file <a class="el" href="a00236_source.html">Interp1PrimSecondOrderMUSCL.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;{</div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;  <a class="code" href="a00115.html">HyPar</a>           *solver = (<a class="code" href="a00115.html">HyPar</a>*)          s;</div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;  <a class="code" href="a00118.html">MUSCLParameters</a> *muscl  = (<a class="code" href="a00118.html">MUSCLParameters</a>*) solver-&gt;<a class="code" href="a00115.html#a29c46b81ad574e4dfbad5a7211487dcb">interp</a>;</div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;</div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;  <span class="keywordtype">int</span> ghosts = solver-&gt;<a class="code" href="a00115.html#aafc992b5fa79d5a4036024615d03bce6">ghosts</a>;</div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;  <span class="keywordtype">int</span> ndims  = solver-&gt;<a class="code" href="a00115.html#a484873c74138512e41bc50d17b7d955a">ndims</a>;</div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;  <span class="keywordtype">int</span> nvars  = solver-&gt;<a class="code" href="a00115.html#ae8f6d2fd6490d3153cb4133bf183a404">nvars</a>;</div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;  <span class="keywordtype">int</span> *dim   = solver-&gt;<a class="code" href="a00115.html#a38e0371f331cecbe63a77fa03e202afe">dim_local</a>;</div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;</div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;  <span class="comment">/* define some constants */</span></div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;  <span class="keywordtype">double</span> half = 1.0/2.0;</div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;</div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;  <span class="comment">/* create index and bounds for the outer loop, i.e., to loop over all 1D lines along</span></div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;<span class="comment">     dimension &quot;dir&quot;                                                                    */</span></div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;  <span class="keywordtype">int</span> indexC[ndims], indexI[ndims], index_outer[ndims], bounds_outer[ndims], bounds_inter[ndims];</div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;  <a class="code" href="a00136.html#a89e8330d9e06dd0666c50833628a125c">_ArrayCopy1D_</a>(dim,bounds_outer,ndims); bounds_outer[dir] =  1;</div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;  <a class="code" href="a00136.html#a89e8330d9e06dd0666c50833628a125c">_ArrayCopy1D_</a>(dim,bounds_inter,ndims); bounds_inter[dir] += 1;</div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;  <span class="keywordtype">int</span> N_outer; <a class="code" href="a00136.html#abc65e9c6a51b875f46fdb054a0ecf604">_ArrayProduct1D_</a>(bounds_outer,ndims,N_outer);</div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;</div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;  <span class="keywordtype">int</span> i;</div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;  <span class="keywordflow">if</span> (upw &gt; 0) {</div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;<span class="preprocessor">#pragma omp parallel for schedule(auto) default(shared) private(i,index_outer,indexC,indexI)</span></div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;<span class="preprocessor"></span>    <span class="keywordflow">for</span> (i=0; i&lt;N_outer; i++) {</div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;      <a class="code" href="a00136.html#a03f49e4d44ae8aca85cb04cfe91e4ce4">_ArrayIndexnD_</a>(ndims,i,bounds_outer,index_outer,0);</div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;      <a class="code" href="a00136.html#a89e8330d9e06dd0666c50833628a125c">_ArrayCopy1D_</a>(index_outer,indexC,ndims);</div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;      <a class="code" href="a00136.html#a89e8330d9e06dd0666c50833628a125c">_ArrayCopy1D_</a>(index_outer,indexI,ndims);</div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;      <span class="keywordflow">for</span> (indexI[dir] = 0; indexI[dir] &lt; dim[dir]+1; indexI[dir]++) {</div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;        <span class="keywordtype">int</span> p; <a class="code" href="a00136.html#afbb862a2fdf5b72b1f9ace42f64b556f">_ArrayIndex1D_</a>(ndims,bounds_inter,indexI,0,p);</div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;        <span class="keywordtype">int</span> qm2,qm1,qp1,v;</div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;        indexC[dir] = indexI[dir]-2; <a class="code" href="a00136.html#afbb862a2fdf5b72b1f9ace42f64b556f">_ArrayIndex1D_</a>(ndims,dim,indexC,ghosts,qm2);</div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;        indexC[dir] = indexI[dir]-1; <a class="code" href="a00136.html#afbb862a2fdf5b72b1f9ace42f64b556f">_ArrayIndex1D_</a>(ndims,dim,indexC,ghosts,qm1);</div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;        indexC[dir] = indexI[dir]  ; <a class="code" href="a00136.html#afbb862a2fdf5b72b1f9ace42f64b556f">_ArrayIndex1D_</a>(ndims,dim,indexC,ghosts,qp1);</div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;        <span class="keywordflow">for</span> (v=0; v&lt;nvars; v++)  {</div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;          <span class="comment">/* Defining stencil points */</span></div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;          <span class="keywordtype">double</span> m2, m1, p1;</div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;          m2 = fC[qm2*nvars+v];</div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;          m1 = fC[qm1*nvars+v];</div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;          p1 = fC[qp1*nvars+v];</div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;</div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;          <span class="keywordtype">double</span> slope_ratio = (m1 - m2) / ((p1 - m1) + 1e-40);</div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;          <span class="keywordtype">double</span> phi = muscl-&gt;<a class="code" href="a00118.html#af0d0dd685b67f7e293e616cbfc1ccce6">LimiterFunction</a>(slope_ratio);</div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;          fI[p*nvars+v] =  m1 + 0.5 * phi * (p1-m1);</div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;        }</div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;      }</div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;    }</div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;  } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;<span class="preprocessor">#pragma omp parallel for schedule(auto) default(shared) private(i,index_outer,indexC,indexI)</span></div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;<span class="preprocessor"></span>    <span class="keywordflow">for</span> (i=0; i&lt;N_outer; i++) {</div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;      <a class="code" href="a00136.html#a03f49e4d44ae8aca85cb04cfe91e4ce4">_ArrayIndexnD_</a>(ndims,i,bounds_outer,index_outer,0);</div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;      <a class="code" href="a00136.html#a89e8330d9e06dd0666c50833628a125c">_ArrayCopy1D_</a>(index_outer,indexC,ndims);</div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;      <a class="code" href="a00136.html#a89e8330d9e06dd0666c50833628a125c">_ArrayCopy1D_</a>(index_outer,indexI,ndims);</div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;      <span class="keywordflow">for</span> (indexI[dir] = 0; indexI[dir] &lt; dim[dir]+1; indexI[dir]++) {</div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;        <span class="keywordtype">int</span> p; <a class="code" href="a00136.html#afbb862a2fdf5b72b1f9ace42f64b556f">_ArrayIndex1D_</a>(ndims,bounds_inter,indexI,0,p);</div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;        <span class="keywordtype">int</span> qm1,qp1,qp2,v;</div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;        indexC[dir] = indexI[dir]-1; <a class="code" href="a00136.html#afbb862a2fdf5b72b1f9ace42f64b556f">_ArrayIndex1D_</a>(ndims,dim,indexC,ghosts,qm1);</div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;        indexC[dir] = indexI[dir]  ; <a class="code" href="a00136.html#afbb862a2fdf5b72b1f9ace42f64b556f">_ArrayIndex1D_</a>(ndims,dim,indexC,ghosts,qp1);</div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;        indexC[dir] = indexI[dir]+1; <a class="code" href="a00136.html#afbb862a2fdf5b72b1f9ace42f64b556f">_ArrayIndex1D_</a>(ndims,dim,indexC,ghosts,qp2);</div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;        <span class="keywordflow">for</span> (v=0; v&lt;nvars; v++)  {</div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;          <span class="comment">/* Defining stencil points */</span></div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;          <span class="keywordtype">double</span> m1, p1, p2;</div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;          m1 = fC[qm1*nvars+v];</div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;          p1 = fC[qp1*nvars+v];</div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;          p2 = fC[qp2*nvars+v];</div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;</div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;          <span class="keywordtype">double</span> slope_ratio = (p1 - m1) / ((p2 - p1) + 1e-40);</div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;          <span class="keywordtype">double</span> phi = muscl-&gt;<a class="code" href="a00118.html#af0d0dd685b67f7e293e616cbfc1ccce6">LimiterFunction</a>(slope_ratio);</div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;          fI[p*nvars+v] = p1 + 0.5 * phi * (p1-p2);</div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;        }</div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;      }</div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;    }</div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;  }</div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;  </div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;  <span class="keywordflow">return</span>(0);</div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;}</div>
<div class="ttc" id="a00115_html_a484873c74138512e41bc50d17b7d955a"><div class="ttname"><a href="a00115.html#a484873c74138512e41bc50d17b7d955a">HyPar::ndims</a></div><div class="ttdeci">int ndims</div><div class="ttdef"><b>Definition:</b> <a href="a00143_source.html#l00026">hypar.h:26</a></div></div>
<div class="ttc" id="a00115_html_aafc992b5fa79d5a4036024615d03bce6"><div class="ttname"><a href="a00115.html#aafc992b5fa79d5a4036024615d03bce6">HyPar::ghosts</a></div><div class="ttdeci">int ghosts</div><div class="ttdef"><b>Definition:</b> <a href="a00143_source.html#l00044">hypar.h:44</a></div></div>
<div class="ttc" id="a00115_html"><div class="ttname"><a href="a00115.html">HyPar</a></div><div class="ttdoc">Structure containing all solver-specific variables and functions. </div><div class="ttdef"><b>Definition:</b> <a href="a00143_source.html#l00023">hypar.h:23</a></div></div>
<div class="ttc" id="a00118_html"><div class="ttname"><a href="a00118.html">MUSCLParameters</a></div><div class="ttdoc">Structure of variables/parameters needed by the MUSCL scheme. </div><div class="ttdef"><b>Definition:</b> <a href="a00105_source.html#l00156">interpolation.h:156</a></div></div>
<div class="ttc" id="a00115_html_ae8f6d2fd6490d3153cb4133bf183a404"><div class="ttname"><a href="a00115.html#ae8f6d2fd6490d3153cb4133bf183a404">HyPar::nvars</a></div><div class="ttdeci">int nvars</div><div class="ttdef"><b>Definition:</b> <a href="a00143_source.html#l00029">hypar.h:29</a></div></div>
<div class="ttc" id="a00136_html_a89e8330d9e06dd0666c50833628a125c"><div class="ttname"><a href="a00136.html#a89e8330d9e06dd0666c50833628a125c">_ArrayCopy1D_</a></div><div class="ttdeci">#define _ArrayCopy1D_(x, y, size)</div><div class="ttdef"><b>Definition:</b> <a href="a00136_source.html#l00318">arrayfunctions.h:318</a></div></div>
<div class="ttc" id="a00115_html_a38e0371f331cecbe63a77fa03e202afe"><div class="ttname"><a href="a00115.html#a38e0371f331cecbe63a77fa03e202afe">HyPar::dim_local</a></div><div class="ttdeci">int * dim_local</div><div class="ttdef"><b>Definition:</b> <a href="a00143_source.html#l00035">hypar.h:35</a></div></div>
<div class="ttc" id="a00136_html_a03f49e4d44ae8aca85cb04cfe91e4ce4"><div class="ttname"><a href="a00136.html#a03f49e4d44ae8aca85cb04cfe91e4ce4">_ArrayIndexnD_</a></div><div class="ttdeci">#define _ArrayIndexnD_(N, index, imax, i, ghost)</div><div class="ttdef"><b>Definition:</b> <a href="a00136_source.html#l00020">arrayfunctions.h:20</a></div></div>
<div class="ttc" id="a00115_html_a29c46b81ad574e4dfbad5a7211487dcb"><div class="ttname"><a href="a00115.html#a29c46b81ad574e4dfbad5a7211487dcb">HyPar::interp</a></div><div class="ttdeci">void * interp</div><div class="ttdef"><b>Definition:</b> <a href="a00143_source.html#l00326">hypar.h:326</a></div></div>
<div class="ttc" id="a00136_html_abc65e9c6a51b875f46fdb054a0ecf604"><div class="ttname"><a href="a00136.html#abc65e9c6a51b875f46fdb054a0ecf604">_ArrayProduct1D_</a></div><div class="ttdeci">#define _ArrayProduct1D_(x, size, p)</div><div class="ttdef"><b>Definition:</b> <a href="a00136_source.html#l00376">arrayfunctions.h:376</a></div></div>
<div class="ttc" id="a00136_html_afbb862a2fdf5b72b1f9ace42f64b556f"><div class="ttname"><a href="a00136.html#afbb862a2fdf5b72b1f9ace42f64b556f">_ArrayIndex1D_</a></div><div class="ttdeci">#define _ArrayIndex1D_(N, imax, i, ghost, index)</div><div class="ttdef"><b>Definition:</b> <a href="a00136_source.html#l00039">arrayfunctions.h:39</a></div></div>
<div class="ttc" id="a00118_html_af0d0dd685b67f7e293e616cbfc1ccce6"><div class="ttname"><a href="a00118.html#af0d0dd685b67f7e293e616cbfc1ccce6">MUSCLParameters::LimiterFunction</a></div><div class="ttdeci">double(* LimiterFunction)(double)</div><div class="ttdef"><b>Definition:</b> <a href="a00105_source.html#l00162">interpolation.h:162</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ae7eb6a81a164ca0fa2ace3cab2697847"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int Interp1PrimThirdOrderMUSCL </td>
          <td>(</td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>fI</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>fC</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>u</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>upw</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>dir</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>s</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>m</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>uflag</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>3rd order MUSCL scheme with Koren's limiter (component-wise) on a uniform grid </p>
<p>Component-wise interpolation of the first primitive at the cell interfaces using the third-order MUSCL scheme</p>
<p>Computes the interpolated values of the first primitive of a function \({\bf f}\left({\bf u}\right)\) at the interfaces from the cell-centered values of the function using the 3rd order MUSCL scheme with Koren's limiter on a uniform grid. The first primitive is defined as a function \({\bf h}\left({\bf u}\right)\) that satisfies: </p>
<p class="formulaDsp">
\begin{equation} {\bf f}\left({\bf u}\left(x\right)\right) = \frac{1}{\Delta x} \int_{x-\Delta x/2}^{x+\Delta x/2} {\bf h}\left({\bf u}\left(\zeta\right)\right)d\zeta, \end{equation}
</p>
<p> where \(x\) is the spatial coordinate along the dimension of the interpolation. This function computes numerical approximation \(\hat{\bf f}_{j+1/2} \approx {\bf h}_{j+1/2}\) as: using the 3rd order MUSCL scheme with Koren's limiter as follows: </p>
<p class="formulaDsp">
\begin{equation} \hat{\bf f}_{j+1/2} = {\bf f}_{j-1} + \phi \left[\frac{1}{3}\left({\bf f}_j-{\bf f}_{j-1}\right) + \frac{1}{6}\left({\bf f}_{j-1}-{\bf f}_{j-2}\right)\right] \end{equation}
</p>
<p> where </p>
<p class="formulaDsp">
\begin{equation} \phi = \frac {3\left({\bf f}_j-{\bf f}_{j-1}\right)\left({\bf f}_{j-1}-{\bf f}_{j-2}\right) + \epsilon} {2\left[\left({\bf f}_j-{\bf f}_{j-1}\right)-\left({\bf f}_{j-1}-{\bf f}_{j-2}\right)\right]^2 + 3\left({\bf f}_j-{\bf f}_{j-1}\right)\left({\bf f}_{j-1}-{\bf f}_{j-2}\right) + \epsilon}. \end{equation}
</p>
<p> and \(\epsilon\) is a small constant (typically \(10^{-3}\)).</p>
<p><b>Implementation</b> <b>Notes:</b> </p>
<ul>
<li>The scalar interpolation method is applied to the vector function in a component-wise manner.</li>
<li>The method described above corresponds to a left-biased interpolation. The corresponding right-biased interpolation can be obtained by reflecting the equations about interface j+1/2.</li>
<li>The function computes the interpolant for the entire grid in one call. It loops over all the grid lines along the interpolation direction and carries out the 1D interpolation along these grid lines.</li>
<li>Location of cell-centers and cell interfaces along the spatial dimension of the interpolation is shown in the following figure: <div class="image">
<img src="chap1_1Ddomain.png" alt="chap1_1Ddomain.png"/>
</div>
 </li>
</ul>
<p><b>Function</b> <b>arguments:</b> </p>
<table class="doxtable">
<tr>
<th>Argument </th><th>Type </th><th>Explanation  </th></tr>
<tr>
<td>fI </td><td>double* </td><td>Array to hold the computed interpolant at the grid interfaces. This array must have the same layout as the solution, but with <b>no</b> <b>ghost</b> <b>points</b>. Its size should be the same as u in all dimensions, except dir (the dimension along which to interpolate) along which it should be larger by 1 (number of interfaces is 1 more than the number of interior cell centers). </td></tr>
<tr>
<td>fC </td><td>double* </td><td>Array with the cell-centered values of the flux function \({\bf f}\left({\bf u}\right)\). This array must have the same layout and size as the solution, <b>with</b> <b>ghost</b> <b>points</b>. </td></tr>
<tr>
<td>u </td><td>double* </td><td>The solution array \({\bf u}\) (with ghost points). If the interpolation is characteristic based, this is needed to compute the eigendecomposition. For a multidimensional problem, the layout is as follows: u is a contiguous 1D array of size (nvars*dim[0]*dim[1]*...*dim[D-1]) corresponding to the multi-dimensional solution, with the following ordering - nvars, dim[0], dim[1], ..., dim[D-1], where nvars is the number of solution components (<a class="el" href="a00115.html#ae8f6d2fd6490d3153cb4133bf183a404">HyPar::nvars</a>), dim is the local size (<a class="el" href="a00115.html#a38e0371f331cecbe63a77fa03e202afe">HyPar::dim_local</a>), D is the number of spatial dimensions. </td></tr>
<tr>
<td>x </td><td>double* </td><td>The grid array (with ghost points). This is used only by non-uniform-grid interpolation methods. For multidimensional problems, the layout is as follows: x is a contiguous 1D array of size (dim[0]+dim[1]+...+dim[D-1]), with the spatial coordinates along dim[0] stored from 0,...,dim[0]-1, the spatial coordinates along dim[1] stored along dim[0],...,dim[0]+dim[1]-1, and so forth. </td></tr>
<tr>
<td>upw </td><td>int </td><td>Upwinding direction: if positive, a left-biased interpolant will be computed; if negative, a right-biased interpolant will be computed. If the interpolation method is central, then this has no effect. </td></tr>
<tr>
<td>dir </td><td>int </td><td>Spatial dimension along which to interpolate (eg: 0 for 1D; 0 or 1 for 2D; 0,1 or 2 for 3D) </td></tr>
<tr>
<td>s </td><td>void* </td><td>Solver object of type <a class="el" href="a00115.html" title="Structure containing all solver-specific variables and functions. ">HyPar</a>: the following variables are needed - <a class="el" href="a00115.html#aafc992b5fa79d5a4036024615d03bce6">HyPar::ghosts</a>, <a class="el" href="a00115.html#a484873c74138512e41bc50d17b7d955a">HyPar::ndims</a>, <a class="el" href="a00115.html#ae8f6d2fd6490d3153cb4133bf183a404">HyPar::nvars</a>, <a class="el" href="a00115.html#a38e0371f331cecbe63a77fa03e202afe">HyPar::dim_local</a>. </td></tr>
<tr>
<td>m </td><td>void* </td><td>MPI object of type <a class="el" href="a00117.html#a00516" title="Structure of MPI-related variables. ">MPIVariables</a>: this is needed only by compact interpolation method that need to solve a global implicit system across MPI ranks. </td></tr>
<tr>
<td>uflag </td><td>int </td><td>A flag indicating if the function being interpolated \({\bf f}\) is the solution itself \({\bf u}\) (if 1, \({\bf f}\left({\bf u}\right) \equiv {\bf u}\)). </td></tr>
</table>
<p>Reference:</p>
<ul>
<li>van Leer, B., Towards the Ultimate Conservative Difference Scheme. 2: Monotonicity and Conservation Combined in a Second-Order Scheme, J. of Comput. Phys., 14 (4), 1974, pp.361-370, <a href="http://dx.doi.org/10.1016/0021-9991(74)90019-9">http://dx.doi.org/10.1016/0021-9991(74)90019-9</a></li>
<li>Koren, B., A Robust Upwind Discretization Method for Advection, Diffusion and Source Terms, Centrum voor Wiskunde en Informatica, Amsterdam, 1993 </li>
</ul>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">fI</td><td>Array of interpolated function values at the interfaces </td></tr>
    <tr><td class="paramname">fC</td><td>Array of cell-centered values of the function \({\bf f}\left({\bf u}\right)\) </td></tr>
    <tr><td class="paramname">u</td><td>Array of cell-centered values of the solution \({\bf u}\) </td></tr>
    <tr><td class="paramname">x</td><td>Grid coordinates </td></tr>
    <tr><td class="paramname">upw</td><td>Upwind direction (left or right biased) </td></tr>
    <tr><td class="paramname">dir</td><td>Spatial dimension along which to interpolation </td></tr>
    <tr><td class="paramname">s</td><td>Object of type <a class="el" href="a00115.html" title="Structure containing all solver-specific variables and functions. ">HyPar</a> containing solver-related variables </td></tr>
    <tr><td class="paramname">m</td><td>Object of type <a class="el" href="a00117.html#a00516" title="Structure of MPI-related variables. ">MPIVariables</a> containing MPI-related variables </td></tr>
    <tr><td class="paramname">uflag</td><td>Flag to indicate if \(f(u) \equiv u\), i.e, if the solution is being reconstructed </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="a00238_source.html#l00075">75</a> of file <a class="el" href="a00238_source.html">Interp1PrimThirdOrderMUSCL.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;{</div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;  <a class="code" href="a00115.html">HyPar</a>           *solver = (<a class="code" href="a00115.html">HyPar</a>*)          s;</div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;  <a class="code" href="a00118.html">MUSCLParameters</a> *muscl  = (<a class="code" href="a00118.html">MUSCLParameters</a>*) solver-&gt;<a class="code" href="a00115.html#a29c46b81ad574e4dfbad5a7211487dcb">interp</a>;</div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;</div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;  <span class="keywordtype">int</span> ghosts = solver-&gt;<a class="code" href="a00115.html#aafc992b5fa79d5a4036024615d03bce6">ghosts</a>;</div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;  <span class="keywordtype">int</span> ndims  = solver-&gt;<a class="code" href="a00115.html#a484873c74138512e41bc50d17b7d955a">ndims</a>;</div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;  <span class="keywordtype">int</span> nvars  = solver-&gt;<a class="code" href="a00115.html#ae8f6d2fd6490d3153cb4133bf183a404">nvars</a>;</div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;  <span class="keywordtype">int</span> *dim   = solver-&gt;<a class="code" href="a00115.html#a38e0371f331cecbe63a77fa03e202afe">dim_local</a>;</div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;</div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;  <span class="comment">/* define some constants */</span></div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;  <span class="keywordtype">double</span> one_third = 1.0/3.0;</div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;  <span class="keywordtype">double</span> one_sixth = 1.0/6.0;</div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;</div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;  <span class="comment">/* create index and bounds for the outer loop, i.e., to loop over all 1D lines along</span></div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;<span class="comment">     dimension &quot;dir&quot;                                                                    */</span></div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;  <span class="keywordtype">int</span> indexC[ndims], indexI[ndims], index_outer[ndims], bounds_outer[ndims], bounds_inter[ndims];</div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;  <a class="code" href="a00136.html#a89e8330d9e06dd0666c50833628a125c">_ArrayCopy1D_</a>(dim,bounds_outer,ndims); bounds_outer[dir] =  1;</div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;  <a class="code" href="a00136.html#a89e8330d9e06dd0666c50833628a125c">_ArrayCopy1D_</a>(dim,bounds_inter,ndims); bounds_inter[dir] += 1;</div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;  <span class="keywordtype">int</span> N_outer; <a class="code" href="a00136.html#abc65e9c6a51b875f46fdb054a0ecf604">_ArrayProduct1D_</a>(bounds_outer,ndims,N_outer);</div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;</div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;  <span class="keywordtype">int</span> i;</div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;  <span class="keywordflow">if</span> (upw &gt; 0) {</div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;<span class="preprocessor">#pragma omp parallel for schedule(auto) default(shared) private(i,index_outer,indexC,indexI)</span></div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;<span class="preprocessor"></span>    <span class="keywordflow">for</span> (i=0; i&lt;N_outer; i++) {</div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;      <a class="code" href="a00136.html#a03f49e4d44ae8aca85cb04cfe91e4ce4">_ArrayIndexnD_</a>(ndims,i,bounds_outer,index_outer,0);</div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;      <a class="code" href="a00136.html#a89e8330d9e06dd0666c50833628a125c">_ArrayCopy1D_</a>(index_outer,indexC,ndims);</div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;      <a class="code" href="a00136.html#a89e8330d9e06dd0666c50833628a125c">_ArrayCopy1D_</a>(index_outer,indexI,ndims);</div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;      <span class="keywordflow">for</span> (indexI[dir] = 0; indexI[dir] &lt; dim[dir]+1; indexI[dir]++) {</div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;        <span class="keywordtype">int</span> p; <a class="code" href="a00136.html#afbb862a2fdf5b72b1f9ace42f64b556f">_ArrayIndex1D_</a>(ndims,bounds_inter,indexI,0,p);</div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;        <span class="keywordtype">int</span> qm1,qm2,qp1,v;</div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;        indexC[dir] = indexI[dir]-2; <a class="code" href="a00136.html#afbb862a2fdf5b72b1f9ace42f64b556f">_ArrayIndex1D_</a>(ndims,dim,indexC,ghosts,qm2);</div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;        indexC[dir] = indexI[dir]-1; <a class="code" href="a00136.html#afbb862a2fdf5b72b1f9ace42f64b556f">_ArrayIndex1D_</a>(ndims,dim,indexC,ghosts,qm1);</div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;        indexC[dir] = indexI[dir]  ; <a class="code" href="a00136.html#afbb862a2fdf5b72b1f9ace42f64b556f">_ArrayIndex1D_</a>(ndims,dim,indexC,ghosts,qp1);</div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;        <span class="keywordflow">for</span> (v=0; v&lt;nvars; v++)  {</div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;          <span class="comment">/* Defining stencil points */</span></div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;          <span class="keywordtype">double</span> m2, m1, p1;</div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;          m2 = fC[qm2*nvars+v];</div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;          m1 = fC[qm1*nvars+v];</div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;          p1 = fC[qp1*nvars+v];</div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;</div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;          <span class="keywordtype">double</span> fdiff = p1 - m1;</div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;          <span class="keywordtype">double</span> bdiff = m1 - m2;</div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;          <span class="keywordtype">double</span> limit =  (3*fdiff*bdiff + muscl-&gt;<a class="code" href="a00118.html#a974b448c3d0a13d483d36ef15de369b5">eps</a>) </div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;                        / (2*(fdiff-bdiff)*(fdiff-bdiff) + 3*fdiff*bdiff + muscl-&gt;<a class="code" href="a00118.html#a974b448c3d0a13d483d36ef15de369b5">eps</a>);</div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;</div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;          fI[p*nvars+v] = m1 +  limit * (one_third*fdiff + one_sixth*bdiff);</div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;        }</div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;      }</div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;    }</div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;  } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;<span class="preprocessor">#pragma omp parallel for schedule(auto) default(shared) private(i,index_outer,indexC,indexI)</span></div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;<span class="preprocessor"></span>    <span class="keywordflow">for</span> (i=0; i&lt;N_outer; i++) {</div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;      <a class="code" href="a00136.html#a03f49e4d44ae8aca85cb04cfe91e4ce4">_ArrayIndexnD_</a>(ndims,i,bounds_outer,index_outer,0);</div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;      <a class="code" href="a00136.html#a89e8330d9e06dd0666c50833628a125c">_ArrayCopy1D_</a>(index_outer,indexC,ndims);</div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;      <a class="code" href="a00136.html#a89e8330d9e06dd0666c50833628a125c">_ArrayCopy1D_</a>(index_outer,indexI,ndims);</div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;      <span class="keywordflow">for</span> (indexI[dir] = 0; indexI[dir] &lt; dim[dir]+1; indexI[dir]++) {</div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;        <span class="keywordtype">int</span> p; <a class="code" href="a00136.html#afbb862a2fdf5b72b1f9ace42f64b556f">_ArrayIndex1D_</a>(ndims,bounds_inter,indexI,0,p);</div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;        <span class="keywordtype">int</span> qm1,qp1,qp2,v;</div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;        indexC[dir] = indexI[dir]-1; <a class="code" href="a00136.html#afbb862a2fdf5b72b1f9ace42f64b556f">_ArrayIndex1D_</a>(ndims,dim,indexC,ghosts,qm1);</div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;        indexC[dir] = indexI[dir]  ; <a class="code" href="a00136.html#afbb862a2fdf5b72b1f9ace42f64b556f">_ArrayIndex1D_</a>(ndims,dim,indexC,ghosts,qp1);</div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;        indexC[dir] = indexI[dir]+1; <a class="code" href="a00136.html#afbb862a2fdf5b72b1f9ace42f64b556f">_ArrayIndex1D_</a>(ndims,dim,indexC,ghosts,qp2);</div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;        <span class="keywordflow">for</span> (v=0; v&lt;nvars; v++)  {</div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;          <span class="comment">/* Defining stencil points */</span></div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;          <span class="keywordtype">double</span> m1, p1, p2;</div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;          m1 = fC[qm1*nvars+v];</div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;          p1 = fC[qp1*nvars+v];</div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;          p2 = fC[qp2*nvars+v];</div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;</div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;          <span class="keywordtype">double</span> fdiff = p2 - p1;</div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;          <span class="keywordtype">double</span> bdiff = p1 - m1;</div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;          <span class="keywordtype">double</span> limit =  (3*fdiff*bdiff + muscl-&gt;<a class="code" href="a00118.html#a974b448c3d0a13d483d36ef15de369b5">eps</a>) </div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;                        / (2*(fdiff-bdiff)*(fdiff-bdiff) + 3*fdiff*bdiff + muscl-&gt;<a class="code" href="a00118.html#a974b448c3d0a13d483d36ef15de369b5">eps</a>);</div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;</div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;          fI[p*nvars+v] = p1 -  limit * (one_third*fdiff + one_sixth*bdiff);</div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;        }</div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;      }</div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;    }</div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;  }</div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;  </div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;  <span class="keywordflow">return</span>(0);</div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;}</div>
<div class="ttc" id="a00115_html_a484873c74138512e41bc50d17b7d955a"><div class="ttname"><a href="a00115.html#a484873c74138512e41bc50d17b7d955a">HyPar::ndims</a></div><div class="ttdeci">int ndims</div><div class="ttdef"><b>Definition:</b> <a href="a00143_source.html#l00026">hypar.h:26</a></div></div>
<div class="ttc" id="a00115_html_aafc992b5fa79d5a4036024615d03bce6"><div class="ttname"><a href="a00115.html#aafc992b5fa79d5a4036024615d03bce6">HyPar::ghosts</a></div><div class="ttdeci">int ghosts</div><div class="ttdef"><b>Definition:</b> <a href="a00143_source.html#l00044">hypar.h:44</a></div></div>
<div class="ttc" id="a00115_html"><div class="ttname"><a href="a00115.html">HyPar</a></div><div class="ttdoc">Structure containing all solver-specific variables and functions. </div><div class="ttdef"><b>Definition:</b> <a href="a00143_source.html#l00023">hypar.h:23</a></div></div>
<div class="ttc" id="a00118_html"><div class="ttname"><a href="a00118.html">MUSCLParameters</a></div><div class="ttdoc">Structure of variables/parameters needed by the MUSCL scheme. </div><div class="ttdef"><b>Definition:</b> <a href="a00105_source.html#l00156">interpolation.h:156</a></div></div>
<div class="ttc" id="a00115_html_ae8f6d2fd6490d3153cb4133bf183a404"><div class="ttname"><a href="a00115.html#ae8f6d2fd6490d3153cb4133bf183a404">HyPar::nvars</a></div><div class="ttdeci">int nvars</div><div class="ttdef"><b>Definition:</b> <a href="a00143_source.html#l00029">hypar.h:29</a></div></div>
<div class="ttc" id="a00136_html_a89e8330d9e06dd0666c50833628a125c"><div class="ttname"><a href="a00136.html#a89e8330d9e06dd0666c50833628a125c">_ArrayCopy1D_</a></div><div class="ttdeci">#define _ArrayCopy1D_(x, y, size)</div><div class="ttdef"><b>Definition:</b> <a href="a00136_source.html#l00318">arrayfunctions.h:318</a></div></div>
<div class="ttc" id="a00115_html_a38e0371f331cecbe63a77fa03e202afe"><div class="ttname"><a href="a00115.html#a38e0371f331cecbe63a77fa03e202afe">HyPar::dim_local</a></div><div class="ttdeci">int * dim_local</div><div class="ttdef"><b>Definition:</b> <a href="a00143_source.html#l00035">hypar.h:35</a></div></div>
<div class="ttc" id="a00136_html_a03f49e4d44ae8aca85cb04cfe91e4ce4"><div class="ttname"><a href="a00136.html#a03f49e4d44ae8aca85cb04cfe91e4ce4">_ArrayIndexnD_</a></div><div class="ttdeci">#define _ArrayIndexnD_(N, index, imax, i, ghost)</div><div class="ttdef"><b>Definition:</b> <a href="a00136_source.html#l00020">arrayfunctions.h:20</a></div></div>
<div class="ttc" id="a00115_html_a29c46b81ad574e4dfbad5a7211487dcb"><div class="ttname"><a href="a00115.html#a29c46b81ad574e4dfbad5a7211487dcb">HyPar::interp</a></div><div class="ttdeci">void * interp</div><div class="ttdef"><b>Definition:</b> <a href="a00143_source.html#l00326">hypar.h:326</a></div></div>
<div class="ttc" id="a00136_html_abc65e9c6a51b875f46fdb054a0ecf604"><div class="ttname"><a href="a00136.html#abc65e9c6a51b875f46fdb054a0ecf604">_ArrayProduct1D_</a></div><div class="ttdeci">#define _ArrayProduct1D_(x, size, p)</div><div class="ttdef"><b>Definition:</b> <a href="a00136_source.html#l00376">arrayfunctions.h:376</a></div></div>
<div class="ttc" id="a00136_html_afbb862a2fdf5b72b1f9ace42f64b556f"><div class="ttname"><a href="a00136.html#afbb862a2fdf5b72b1f9ace42f64b556f">_ArrayIndex1D_</a></div><div class="ttdeci">#define _ArrayIndex1D_(N, imax, i, ghost, index)</div><div class="ttdef"><b>Definition:</b> <a href="a00136_source.html#l00039">arrayfunctions.h:39</a></div></div>
<div class="ttc" id="a00118_html_a974b448c3d0a13d483d36ef15de369b5"><div class="ttname"><a href="a00118.html#a974b448c3d0a13d483d36ef15de369b5">MUSCLParameters::eps</a></div><div class="ttdeci">double eps</div><div class="ttdef"><b>Definition:</b> <a href="a00105_source.html#l00159">interpolation.h:159</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="aea7c973ffe0c37bca0703c1bf6175aaa"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int Interp1PrimFifthOrderUpwind </td>
          <td>(</td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>fI</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>fC</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>u</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>upw</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>dir</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>s</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>m</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>uflag</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>5th order upwind reconstruction (component-wise) on a uniform grid </p>
<p>Component-wise interpolation of the first primitive at the cell interfaces using the fifth-order upwind scheme</p>
<p>Computes the interpolated values of the first primitive of a function \({\bf f}\left({\bf u}\right)\) at the interfaces from the cell-centered values of the function using the fifth order upwind scheme on a uniform grid. The first primitive is defined as a function \({\bf h}\left({\bf u}\right)\) that satisfies: </p>
<p class="formulaDsp">
\begin{equation} {\bf f}\left({\bf u}\left(x\right)\right) = \frac{1}{\Delta x} \int_{x-\Delta x/2}^{x+\Delta x/2} {\bf h}\left({\bf u}\left(\zeta\right)\right)d\zeta, \end{equation}
</p>
<p> where \(x\) is the spatial coordinate along the dimension of the interpolation. This function computes the 5th order upwind numerical approximation \(\hat{\bf f}_{j+1/2} \approx {\bf h}_{j+1/2}\) as: </p>
<p class="formulaDsp">
\begin{align} \hat{\bf f}_{j+1/2} = \frac{1}{30} {\bf f}_{j-2} - \frac{13}{60}{\bf f}_{j-1} + \frac{47}{60}{\bf f}_j + \frac{27}{60}{\bf f}_{j+1} - \frac{1}{20}{\bf f}_{j+2}. \end{align}
</p>
<p><b>Implementation</b> <b>Notes:</b> </p>
<ul>
<li>This method assumes a uniform grid in the spatial dimension corresponding to the interpolation.</li>
<li>The method described above corresponds to a left-biased interpolation. The corresponding right-biased interpolation can be obtained by reflecting the equations about interface j+1/2.</li>
<li>The scalar interpolation method is applied to the vector function in a component-wise manner.</li>
<li>The function computes the interpolant for the entire grid in one call. It loops over all the grid lines along the interpolation direction and carries out the 1D interpolation along these grid lines.</li>
<li>Location of cell-centers and cell interfaces along the spatial dimension of the interpolation is shown in the following figure: <div class="image">
<img src="chap1_1Ddomain.png" alt="chap1_1Ddomain.png"/>
</div>
 </li>
</ul>
<p><b>Function</b> <b>arguments:</b> </p>
<table class="doxtable">
<tr>
<th>Argument </th><th>Type </th><th>Explanation  </th></tr>
<tr>
<td>fI </td><td>double* </td><td>Array to hold the computed interpolant at the grid interfaces. This array must have the same layout as the solution, but with <b>no</b> <b>ghost</b> <b>points</b>. Its size should be the same as u in all dimensions, except dir (the dimension along which to interpolate) along which it should be larger by 1 (number of interfaces is 1 more than the number of interior cell centers). </td></tr>
<tr>
<td>fC </td><td>double* </td><td>Array with the cell-centered values of the flux function \({\bf f}\left({\bf u}\right)\). This array must have the same layout and size as the solution, <b>with</b> <b>ghost</b> <b>points</b>. </td></tr>
<tr>
<td>u </td><td>double* </td><td>The solution array \({\bf u}\) (with ghost points). If the interpolation is characteristic based, this is needed to compute the eigendecomposition. For a multidimensional problem, the layout is as follows: u is a contiguous 1D array of size (nvars*dim[0]*dim[1]*...*dim[D-1]) corresponding to the multi-dimensional solution, with the following ordering - nvars, dim[0], dim[1], ..., dim[D-1], where nvars is the number of solution components (<a class="el" href="a00115.html#ae8f6d2fd6490d3153cb4133bf183a404">HyPar::nvars</a>), dim is the local size (<a class="el" href="a00115.html#a38e0371f331cecbe63a77fa03e202afe">HyPar::dim_local</a>), D is the number of spatial dimensions. </td></tr>
<tr>
<td>x </td><td>double* </td><td>The grid array (with ghost points). This is used only by non-uniform-grid interpolation methods. For multidimensional problems, the layout is as follows: x is a contiguous 1D array of size (dim[0]+dim[1]+...+dim[D-1]), with the spatial coordinates along dim[0] stored from 0,...,dim[0]-1, the spatial coordinates along dim[1] stored along dim[0],...,dim[0]+dim[1]-1, and so forth. </td></tr>
<tr>
<td>upw </td><td>int </td><td>Upwinding direction: if positive, a left-biased interpolant will be computed; if negative, a right-biased interpolant will be computed. If the interpolation method is central, then this has no effect. </td></tr>
<tr>
<td>dir </td><td>int </td><td>Spatial dimension along which to interpolate (eg: 0 for 1D; 0 or 1 for 2D; 0,1 or 2 for 3D) </td></tr>
<tr>
<td>s </td><td>void* </td><td>Solver object of type <a class="el" href="a00115.html" title="Structure containing all solver-specific variables and functions. ">HyPar</a>: the following variables are needed - <a class="el" href="a00115.html#aafc992b5fa79d5a4036024615d03bce6">HyPar::ghosts</a>, <a class="el" href="a00115.html#a484873c74138512e41bc50d17b7d955a">HyPar::ndims</a>, <a class="el" href="a00115.html#ae8f6d2fd6490d3153cb4133bf183a404">HyPar::nvars</a>, <a class="el" href="a00115.html#a38e0371f331cecbe63a77fa03e202afe">HyPar::dim_local</a>. </td></tr>
<tr>
<td>m </td><td>void* </td><td>MPI object of type <a class="el" href="a00117.html#a00516" title="Structure of MPI-related variables. ">MPIVariables</a>: this is needed only by compact interpolation method that need to solve a global implicit system across MPI ranks. </td></tr>
<tr>
<td>uflag </td><td>int </td><td>A flag indicating if the function being interpolated \({\bf f}\) is the solution itself \({\bf u}\) (if 1, \({\bf f}\left({\bf u}\right) \equiv {\bf u}\)). </td></tr>
</table>
<p><b>Reference:</b> </p>
<ul>
<li>Jiang, G.-S., Shu, C.-W., Efficient Implementation of Weighted ENO Schemes, J. Comput. Phys., 126 (1), 1996, pp. 202-228, <a href="http://dx.doi.org/10.1006/jcph.1996.0130">http://dx.doi.org/10.1006/jcph.1996.0130</a> </li>
</ul>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">fI</td><td>Array of interpolated function values at the interfaces </td></tr>
    <tr><td class="paramname">fC</td><td>Array of cell-centered values of the function \({\bf f}\left({\bf u}\right)\) </td></tr>
    <tr><td class="paramname">u</td><td>Array of cell-centered values of the solution \({\bf u}\) </td></tr>
    <tr><td class="paramname">x</td><td>Grid coordinates </td></tr>
    <tr><td class="paramname">upw</td><td>Upwind direction (left or right biased) </td></tr>
    <tr><td class="paramname">dir</td><td>Spatial dimension along which to interpolation </td></tr>
    <tr><td class="paramname">s</td><td>Object of type <a class="el" href="a00115.html" title="Structure containing all solver-specific variables and functions. ">HyPar</a> containing solver-related variables </td></tr>
    <tr><td class="paramname">m</td><td>Object of type <a class="el" href="a00117.html#a00516" title="Structure of MPI-related variables. ">MPIVariables</a> containing MPI-related variables </td></tr>
    <tr><td class="paramname">uflag</td><td>Flag to indicate if \(f(u) \equiv u\), i.e, if the solution is being reconstructed </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="a00228_source.html#l00068">68</a> of file <a class="el" href="a00228_source.html">Interp1PrimFifthOrderUpwind.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;{</div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;  <a class="code" href="a00115.html">HyPar</a>           *solver = (<a class="code" href="a00115.html">HyPar</a>*)          s;</div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;</div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;  <span class="keywordtype">int</span> ghosts = solver-&gt;<a class="code" href="a00115.html#aafc992b5fa79d5a4036024615d03bce6">ghosts</a>;</div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;  <span class="keywordtype">int</span> ndims  = solver-&gt;<a class="code" href="a00115.html#a484873c74138512e41bc50d17b7d955a">ndims</a>;</div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;  <span class="keywordtype">int</span> nvars  = solver-&gt;<a class="code" href="a00115.html#ae8f6d2fd6490d3153cb4133bf183a404">nvars</a>;</div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;  <span class="keywordtype">int</span> *dim   = solver-&gt;<a class="code" href="a00115.html#a38e0371f331cecbe63a77fa03e202afe">dim_local</a>;</div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;  <span class="keywordtype">int</span> *stride= solver-&gt;<a class="code" href="a00115.html#a39dc7def53a36bdc722aa90f52e04561">stride_with_ghosts</a>;</div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;</div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;  <span class="comment">/* define some constants */</span></div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;  <span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">double</span> one_by_thirty        = 1.0/30.0,</div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;                      thirteen_by_sixty    = 13.0/60.0,</div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;                      fortyseven_by_sixty  = 47.0/60.0,</div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;                      twentyseven_by_sixty = 27.0/60.0,</div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;                      one_by_twenty        = 1.0/20.0;</div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;</div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;  <span class="comment">/* create index and bounds for the outer loop, i.e., to loop over all 1D lines along</span></div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;<span class="comment">     dimension &quot;dir&quot;                                                                    */</span></div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;  <span class="keywordtype">int</span> indexC[ndims], indexI[ndims], index_outer[ndims], bounds_outer[ndims], bounds_inter[ndims];</div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;  <a class="code" href="a00136.html#a89e8330d9e06dd0666c50833628a125c">_ArrayCopy1D_</a>(dim,bounds_outer,ndims); bounds_outer[dir] =  1;</div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;  <a class="code" href="a00136.html#a89e8330d9e06dd0666c50833628a125c">_ArrayCopy1D_</a>(dim,bounds_inter,ndims); bounds_inter[dir] += 1;</div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;  <span class="keywordtype">int</span> N_outer; <a class="code" href="a00136.html#abc65e9c6a51b875f46fdb054a0ecf604">_ArrayProduct1D_</a>(bounds_outer,ndims,N_outer);</div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;</div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;  <span class="keywordtype">int</span> i;</div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;<span class="preprocessor">#pragma omp parallel for schedule(auto) default(shared) private(i,index_outer,indexC,indexI)</span></div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;<span class="preprocessor"></span>  <span class="keywordflow">for</span> (i=0; i&lt;N_outer; i++) {</div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;    <a class="code" href="a00136.html#a03f49e4d44ae8aca85cb04cfe91e4ce4">_ArrayIndexnD_</a>(ndims,i,bounds_outer,index_outer,0);</div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;    <a class="code" href="a00136.html#a89e8330d9e06dd0666c50833628a125c">_ArrayCopy1D_</a>(index_outer,indexC,ndims);</div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;    <a class="code" href="a00136.html#a89e8330d9e06dd0666c50833628a125c">_ArrayCopy1D_</a>(index_outer,indexI,ndims);</div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;    <span class="keywordflow">for</span> (indexI[dir] = 0; indexI[dir] &lt; dim[dir]+1; indexI[dir]++) {</div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;      <span class="keywordtype">int</span> qm1,qm2,qm3,qp1,qp2,p;</div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;      <a class="code" href="a00136.html#afbb862a2fdf5b72b1f9ace42f64b556f">_ArrayIndex1D_</a>(ndims,bounds_inter,indexI,0,p);</div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;      <span class="keywordflow">if</span> (upw &gt; 0) {</div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;        indexC[dir] = indexI[dir]-1; <a class="code" href="a00136.html#afbb862a2fdf5b72b1f9ace42f64b556f">_ArrayIndex1D_</a>(ndims,dim,indexC,ghosts,qm1);</div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;        qm3 = qm1 - 2*stride[dir];</div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;        qm2 = qm1 -   stride[dir];</div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;        qp1 = qm1 +   stride[dir];</div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;        qp2 = qm1 + 2*stride[dir];</div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;      } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;        indexC[dir] = indexI[dir]  ; <a class="code" href="a00136.html#afbb862a2fdf5b72b1f9ace42f64b556f">_ArrayIndex1D_</a>(ndims,dim,indexC,ghosts,qm1);</div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;        qm3 = qm1 + 2*stride[dir];</div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;        qm2 = qm1 +   stride[dir];</div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;        qp1 = qm1 -   stride[dir];</div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;        qp2 = qm1 - 2*stride[dir];</div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;      }</div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;</div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;      <span class="comment">/* Defining stencil points */</span></div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;      <span class="keywordtype">double</span> *fm3, *fm2, *fm1, *fp1, *fp2;</div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;      fm3 = (fC+qm3*nvars);</div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;      fm2 = (fC+qm2*nvars);</div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;      fm1 = (fC+qm1*nvars);</div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;      fp1 = (fC+qp1*nvars);</div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;      fp2 = (fC+qp2*nvars);</div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;</div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;      <span class="keywordtype">int</span> v;</div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;      <span class="keywordflow">for</span> (v=0; v&lt;nvars; v++) {</div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;        (fI+p*nvars)[v] =   one_by_thirty         * fm3[v]</div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;                          - thirteen_by_sixty     * fm2[v]</div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;                          + fortyseven_by_sixty   * fm1[v]</div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;                          + twentyseven_by_sixty  * fp1[v]</div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;                          - one_by_twenty         * fp2[v];</div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;      }</div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;    }</div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;  }</div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;</div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;  <span class="keywordflow">return</span>(0);</div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;}</div>
<div class="ttc" id="a00115_html_a484873c74138512e41bc50d17b7d955a"><div class="ttname"><a href="a00115.html#a484873c74138512e41bc50d17b7d955a">HyPar::ndims</a></div><div class="ttdeci">int ndims</div><div class="ttdef"><b>Definition:</b> <a href="a00143_source.html#l00026">hypar.h:26</a></div></div>
<div class="ttc" id="a00115_html_aafc992b5fa79d5a4036024615d03bce6"><div class="ttname"><a href="a00115.html#aafc992b5fa79d5a4036024615d03bce6">HyPar::ghosts</a></div><div class="ttdeci">int ghosts</div><div class="ttdef"><b>Definition:</b> <a href="a00143_source.html#l00044">hypar.h:44</a></div></div>
<div class="ttc" id="a00115_html"><div class="ttname"><a href="a00115.html">HyPar</a></div><div class="ttdoc">Structure containing all solver-specific variables and functions. </div><div class="ttdef"><b>Definition:</b> <a href="a00143_source.html#l00023">hypar.h:23</a></div></div>
<div class="ttc" id="a00115_html_ae8f6d2fd6490d3153cb4133bf183a404"><div class="ttname"><a href="a00115.html#ae8f6d2fd6490d3153cb4133bf183a404">HyPar::nvars</a></div><div class="ttdeci">int nvars</div><div class="ttdef"><b>Definition:</b> <a href="a00143_source.html#l00029">hypar.h:29</a></div></div>
<div class="ttc" id="a00136_html_a89e8330d9e06dd0666c50833628a125c"><div class="ttname"><a href="a00136.html#a89e8330d9e06dd0666c50833628a125c">_ArrayCopy1D_</a></div><div class="ttdeci">#define _ArrayCopy1D_(x, y, size)</div><div class="ttdef"><b>Definition:</b> <a href="a00136_source.html#l00318">arrayfunctions.h:318</a></div></div>
<div class="ttc" id="a00115_html_a38e0371f331cecbe63a77fa03e202afe"><div class="ttname"><a href="a00115.html#a38e0371f331cecbe63a77fa03e202afe">HyPar::dim_local</a></div><div class="ttdeci">int * dim_local</div><div class="ttdef"><b>Definition:</b> <a href="a00143_source.html#l00035">hypar.h:35</a></div></div>
<div class="ttc" id="a00136_html_a03f49e4d44ae8aca85cb04cfe91e4ce4"><div class="ttname"><a href="a00136.html#a03f49e4d44ae8aca85cb04cfe91e4ce4">_ArrayIndexnD_</a></div><div class="ttdeci">#define _ArrayIndexnD_(N, index, imax, i, ghost)</div><div class="ttdef"><b>Definition:</b> <a href="a00136_source.html#l00020">arrayfunctions.h:20</a></div></div>
<div class="ttc" id="a00136_html_abc65e9c6a51b875f46fdb054a0ecf604"><div class="ttname"><a href="a00136.html#abc65e9c6a51b875f46fdb054a0ecf604">_ArrayProduct1D_</a></div><div class="ttdeci">#define _ArrayProduct1D_(x, size, p)</div><div class="ttdef"><b>Definition:</b> <a href="a00136_source.html#l00376">arrayfunctions.h:376</a></div></div>
<div class="ttc" id="a00136_html_afbb862a2fdf5b72b1f9ace42f64b556f"><div class="ttname"><a href="a00136.html#afbb862a2fdf5b72b1f9ace42f64b556f">_ArrayIndex1D_</a></div><div class="ttdeci">#define _ArrayIndex1D_(N, imax, i, ghost, index)</div><div class="ttdef"><b>Definition:</b> <a href="a00136_source.html#l00039">arrayfunctions.h:39</a></div></div>
<div class="ttc" id="a00115_html_a39dc7def53a36bdc722aa90f52e04561"><div class="ttname"><a href="a00115.html#a39dc7def53a36bdc722aa90f52e04561">HyPar::stride_with_ghosts</a></div><div class="ttdeci">int * stride_with_ghosts</div><div class="ttdef"><b>Definition:</b> <a href="a00143_source.html#l00370">hypar.h:370</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a3ac2a77b9fa5a50499c285e49cf91344"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int Interp1PrimFifthOrderCompactUpwind </td>
          <td>(</td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>fI</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>fC</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>u</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>upw</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>dir</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>s</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>m</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>uflag</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>5th order compact upwind reconstruction (component-wise) on a uniform grid </p>
<p>Component-wise interpolation of the first primitive at the cell interfaces using the fifth-order compact upwind scheme</p>
<p>Computes the interpolated values of the first primitive of a function \({\bf f}\left({\bf u}\right)\) at the interfaces from the cell-centered values of the function using the fifth order compact upwind scheme on a uniform grid. The first primitive is defined as a function \({\bf h}\left({\bf u}\right)\) that satisfies: </p>
<p class="formulaDsp">
\begin{equation} {\bf f}\left({\bf u}\left(x\right)\right) = \frac{1}{\Delta x} \int_{x-\Delta x/2}^{x+\Delta x/2} {\bf h}\left({\bf u}\left(\zeta\right)\right)d\zeta, \end{equation}
</p>
<p> where \(x\) is the spatial coordinate along the dimension of the interpolation. This function computes the 5th order compact upwind numerical approximation \(\hat{\bf f}_{j+1/2} \approx {\bf h}_{j+1/2}\) as: </p>
<p class="formulaDsp">
\begin{align} \frac{3}{10}\hat{\bf f}_{j-1/2} + \frac{6}{10}\hat{\bf f}_{j+1/2} + \frac{1}{10}\hat{\bf f}_{j+3/2} = \frac{1}{30}{\bf f}_{j-1} + \frac{19}{30}{\bf f}_j + \frac{1}{3}{\bf f}_{j+1}. \end{align}
</p>
<p> The resulting tridiagonal system is solved using <a class="el" href="a00131.html#a83b53dedf034d67bf2dde46eebf492ee">tridiagLU()</a> (see also <a class="el" href="a00131.html#a00521">TridiagLU</a>, <a class="el" href="a00131.html" title="Header file for TridiagLU. ">tridiagLU.h</a>).</p>
<p><b>Implementation</b> <b>Notes:</b> </p>
<ul>
<li>This method assumes a uniform grid in the spatial dimension corresponding to the interpolation.</li>
<li>The method described above corresponds to a left-biased interpolation. The corresponding right-biased interpolation can be obtained by reflecting the equations about interface j+1/2.</li>
<li>The scalar interpolation method is applied to the vector function in a component-wise manner.</li>
<li>The function computes the interpolant for the entire grid in one call. It loops over all the grid lines along the interpolation direction and carries out the 1D interpolation along these grid lines.</li>
<li>Location of cell-centers and cell interfaces along the spatial dimension of the interpolation is shown in the following figure: <div class="image">
<img src="chap1_1Ddomain.png" alt="chap1_1Ddomain.png"/>
</div>
 </li>
</ul>
<p><b>Function</b> <b>arguments:</b> </p>
<table class="doxtable">
<tr>
<th>Argument </th><th>Type </th><th>Explanation  </th></tr>
<tr>
<td>fI </td><td>double* </td><td>Array to hold the computed interpolant at the grid interfaces. This array must have the same layout as the solution, but with <b>no</b> <b>ghost</b> <b>points</b>. Its size should be the same as u in all dimensions, except dir (the dimension along which to interpolate) along which it should be larger by 1 (number of interfaces is 1 more than the number of interior cell centers). </td></tr>
<tr>
<td>fC </td><td>double* </td><td>Array with the cell-centered values of the flux function \({\bf f}\left({\bf u}\right)\). This array must have the same layout and size as the solution, <b>with</b> <b>ghost</b> <b>points</b>. </td></tr>
<tr>
<td>u </td><td>double* </td><td>The solution array \({\bf u}\) (with ghost points). If the interpolation is characteristic based, this is needed to compute the eigendecomposition. For a multidimensional problem, the layout is as follows: u is a contiguous 1D array of size (nvars*dim[0]*dim[1]*...*dim[D-1]) corresponding to the multi-dimensional solution, with the following ordering - nvars, dim[0], dim[1], ..., dim[D-1], where nvars is the number of solution components (<a class="el" href="a00115.html#ae8f6d2fd6490d3153cb4133bf183a404">HyPar::nvars</a>), dim is the local size (<a class="el" href="a00115.html#a38e0371f331cecbe63a77fa03e202afe">HyPar::dim_local</a>), D is the number of spatial dimensions. </td></tr>
<tr>
<td>x </td><td>double* </td><td>The grid array (with ghost points). This is used only by non-uniform-grid interpolation methods. For multidimensional problems, the layout is as follows: x is a contiguous 1D array of size (dim[0]+dim[1]+...+dim[D-1]), with the spatial coordinates along dim[0] stored from 0,...,dim[0]-1, the spatial coordinates along dim[1] stored along dim[0],...,dim[0]+dim[1]-1, and so forth. </td></tr>
<tr>
<td>upw </td><td>int </td><td>Upwinding direction: if positive, a left-biased interpolant will be computed; if negative, a right-biased interpolant will be computed. If the interpolation method is central, then this has no effect. </td></tr>
<tr>
<td>dir </td><td>int </td><td>Spatial dimension along which to interpolate (eg: 0 for 1D; 0 or 1 for 2D; 0,1 or 2 for 3D) </td></tr>
<tr>
<td>s </td><td>void* </td><td>Solver object of type <a class="el" href="a00115.html" title="Structure containing all solver-specific variables and functions. ">HyPar</a>: the following variables are needed - <a class="el" href="a00115.html#aafc992b5fa79d5a4036024615d03bce6">HyPar::ghosts</a>, <a class="el" href="a00115.html#a484873c74138512e41bc50d17b7d955a">HyPar::ndims</a>, <a class="el" href="a00115.html#ae8f6d2fd6490d3153cb4133bf183a404">HyPar::nvars</a>, <a class="el" href="a00115.html#a38e0371f331cecbe63a77fa03e202afe">HyPar::dim_local</a>. </td></tr>
<tr>
<td>m </td><td>void* </td><td>MPI object of type <a class="el" href="a00117.html#a00516" title="Structure of MPI-related variables. ">MPIVariables</a>: this is needed only by compact interpolation method that need to solve a global implicit system across MPI ranks. </td></tr>
<tr>
<td>uflag </td><td>int </td><td>A flag indicating if the function being interpolated \({\bf f}\) is the solution itself \({\bf u}\) (if 1, \({\bf f}\left({\bf u}\right) \equiv {\bf u}\)). </td></tr>
</table>
<p><b>Reference:</b> </p>
<ul>
<li>Ghosh, D., Baeder, J. D., Compact Reconstruction Schemes with Weighted ENO Limiting for Hyperbolic Conservation Laws, SIAM Journal on Scientific Computing, 34 (3), 2012, A1678A1706, <a href="http://dx.doi.org/10.1137/110857659">http://dx.doi.org/10.1137/110857659</a> </li>
</ul>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">fI</td><td>Array of interpolated function values at the interfaces </td></tr>
    <tr><td class="paramname">fC</td><td>Array of cell-centered values of the function \({\bf f}\left({\bf u}\right)\) </td></tr>
    <tr><td class="paramname">u</td><td>Array of cell-centered values of the solution \({\bf u}\) </td></tr>
    <tr><td class="paramname">x</td><td>Grid coordinates </td></tr>
    <tr><td class="paramname">upw</td><td>Upwind direction (left or right biased) </td></tr>
    <tr><td class="paramname">dir</td><td>Spatial dimension along which to interpolation </td></tr>
    <tr><td class="paramname">s</td><td>Object of type <a class="el" href="a00115.html" title="Structure containing all solver-specific variables and functions. ">HyPar</a> containing solver-related variables </td></tr>
    <tr><td class="paramname">m</td><td>Object of type <a class="el" href="a00117.html#a00516" title="Structure of MPI-related variables. ">MPIVariables</a> containing MPI-related variables </td></tr>
    <tr><td class="paramname">uflag</td><td>Flag to indicate if \(f(u) \equiv u\), i.e, if the solution is being reconstructed </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="a00222_source.html#l00072">72</a> of file <a class="el" href="a00222_source.html">Interp1PrimFifthOrderCompactUpwind.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;{</div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;  <a class="code" href="a00115.html">HyPar</a>           *solver = (<a class="code" href="a00115.html">HyPar</a>*)          s;</div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;  <a class="code" href="a00117.html#a00516">MPIVariables</a>    *mpi    = (<a class="code" href="a00117.html#a00516">MPIVariables</a>*)   m;</div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;  <a class="code" href="a00105.html#a00503">CompactScheme</a>   *compact= (<a class="code" href="a00105.html#a00503">CompactScheme</a>*)  solver-&gt;<a class="code" href="a00115.html#a56318721d534e74a96b440f8542a0232">compact</a>;</div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;  <a class="code" href="a00131.html#a00521">TridiagLU</a>       *lu     = (<a class="code" href="a00131.html#a00521">TridiagLU</a>*)      solver-&gt;<a class="code" href="a00115.html#a1dbfa1e479a373073b6ebf72401a7f0f">lusolver</a>;</div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;  <span class="keywordtype">int</span>             sys,Nsys,d,v;</div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;  <a class="code" href="a00137.html#a68f50121fb9a7daeaf60e50cdef82ef3">_DECLARE_IERR_</a>;</div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;</div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;  <span class="keywordtype">int</span> ghosts = solver-&gt;<a class="code" href="a00115.html#aafc992b5fa79d5a4036024615d03bce6">ghosts</a>;</div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;  <span class="keywordtype">int</span> ndims  = solver-&gt;<a class="code" href="a00115.html#a484873c74138512e41bc50d17b7d955a">ndims</a>;</div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;  <span class="keywordtype">int</span> nvars  = solver-&gt;<a class="code" href="a00115.html#ae8f6d2fd6490d3153cb4133bf183a404">nvars</a>;</div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;  <span class="keywordtype">int</span> *dim   = solver-&gt;<a class="code" href="a00115.html#a38e0371f331cecbe63a77fa03e202afe">dim_local</a>;</div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;  <span class="keywordtype">int</span> *stride= solver-&gt;<a class="code" href="a00115.html#a39dc7def53a36bdc722aa90f52e04561">stride_with_ghosts</a>;</div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;</div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;  <span class="comment">/* define some constants */</span></div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;  <span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">double</span> one_third            = 1.0/3.0,</div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;                      thirteen_by_sixty    = 13.0/60.0,</div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;                      fortyseven_by_sixty  = 47.0/60.0,</div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;                      twentyseven_by_sixty = 27.0/60.0,</div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;                      one_by_twenty        = 1.0/20.0,</div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;                      one_by_thirty        = 1.0/30.0,</div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;                      nineteen_by_thirty   = 19.0/30.0,</div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;                      three_by_ten         = 3.0/10.0,</div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;                      six_by_ten           = 6.0/10.0,</div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;                      one_by_ten           = 1.0/10.0;</div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;</div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;  <span class="comment">/* create index and bounds for the outer loop, i.e., to loop over all 1D lines along</span></div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;<span class="comment">     dimension &quot;dir&quot;                                                                    */</span></div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;  <span class="keywordtype">int</span> indexC[ndims], indexI[ndims], index_outer[ndims], bounds_outer[ndims], bounds_inter[ndims];</div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;  <a class="code" href="a00136.html#a89e8330d9e06dd0666c50833628a125c">_ArrayCopy1D_</a>(dim,bounds_outer,ndims); bounds_outer[dir] =  1;</div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;  <a class="code" href="a00136.html#a89e8330d9e06dd0666c50833628a125c">_ArrayCopy1D_</a>(dim,bounds_inter,ndims); bounds_inter[dir] += 1;</div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;  <span class="keywordtype">int</span> N_outer; <a class="code" href="a00136.html#abc65e9c6a51b875f46fdb054a0ecf604">_ArrayProduct1D_</a>(bounds_outer,ndims,N_outer);</div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;</div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;  <span class="comment">/* calculate total number of tridiagonal systems to solve */</span></div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;  <a class="code" href="a00136.html#abc65e9c6a51b875f46fdb054a0ecf604">_ArrayProduct1D_</a>(bounds_outer,ndims,Nsys); Nsys *= nvars;</div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;</div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;  <span class="comment">/* Allocate arrays for tridiagonal system */</span></div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;  <span class="keywordtype">double</span> *A = compact-&gt;<a class="code" href="a00105.html#ac900805a486cbb8489e3c176ed6e0d8e">A</a>;</div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;  <span class="keywordtype">double</span> *B = compact-&gt;<a class="code" href="a00105.html#ad36954709307649365515214a02ab06d">B</a>;</div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;  <span class="keywordtype">double</span> *C = compact-&gt;<a class="code" href="a00105.html#a0a26ce8d1878aac6ddc87e3f6290e039">C</a>;</div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;  <span class="keywordtype">double</span> *R = compact-&gt;<a class="code" href="a00105.html#ac06de847603f5cfaec085f6fe500f3c8">R</a>;</div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;</div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;<span class="preprocessor">#pragma omp parallel for schedule(auto) default(shared) private(sys,d,index_outer,indexC,indexI)</span></div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;<span class="preprocessor"></span>  <span class="keywordflow">for</span> (sys=0; sys &lt; N_outer; sys++) {</div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;    <a class="code" href="a00136.html#a03f49e4d44ae8aca85cb04cfe91e4ce4">_ArrayIndexnD_</a>(ndims,sys,bounds_outer,index_outer,0);</div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;    <a class="code" href="a00136.html#a89e8330d9e06dd0666c50833628a125c">_ArrayCopy1D_</a>(index_outer,indexC,ndims);</div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;    <a class="code" href="a00136.html#a89e8330d9e06dd0666c50833628a125c">_ArrayCopy1D_</a>(index_outer,indexI,ndims);</div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;    <span class="keywordflow">for</span> (indexI[dir] = 0; indexI[dir] &lt; dim[dir]+1; indexI[dir]++) {</div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;      <span class="keywordtype">int</span> qm1,qm2,qm3,qp1,qp2,p;</div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;      <a class="code" href="a00136.html#afbb862a2fdf5b72b1f9ace42f64b556f">_ArrayIndex1D_</a>(ndims,bounds_inter,indexI,0,p);</div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;      <span class="keywordflow">if</span> (upw &gt; 0) {</div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;        indexC[dir] = indexI[dir]-1; <a class="code" href="a00136.html#afbb862a2fdf5b72b1f9ace42f64b556f">_ArrayIndex1D_</a>(ndims,dim,indexC,ghosts,qm1);</div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;        qm3 = qm1 - 2*stride[dir];</div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;        qm2 = qm1 -   stride[dir];</div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;        qp1 = qm1 +   stride[dir];</div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;        qp2 = qm1 + 2*stride[dir];</div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;      } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;        indexC[dir] = indexI[dir]  ; <a class="code" href="a00136.html#afbb862a2fdf5b72b1f9ace42f64b556f">_ArrayIndex1D_</a>(ndims,dim,indexC,ghosts,qm1);</div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;        qm3 = qm1 + 2*stride[dir];</div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;        qm2 = qm1 +   stride[dir];</div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;        qp1 = qm1 -   stride[dir];</div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;        qp2 = qm1 - 2*stride[dir];</div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;      }</div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;</div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;      <span class="comment">/* Defining stencil points */</span></div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;      <span class="keywordtype">double</span> *fm3, *fm2, *fm1, *fp1, *fp2;</div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;      fm3 = fC+qm3*nvars;</div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;      fm2 = fC+qm2*nvars;</div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;      fm1 = fC+qm1*nvars;</div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;      fp1 = fC+qp1*nvars;</div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;      fp2 = fC+qp2*nvars;</div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;</div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;      <span class="keywordflow">if</span> (   ((mpi-&gt;<a class="code" href="a00117.html#aa3c28612a64b8a97bde66b720e15c700">ip</a>[dir] == 0                ) &amp;&amp; (indexI[dir] == 0       ))</div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;          || ((mpi-&gt;<a class="code" href="a00117.html#aa3c28612a64b8a97bde66b720e15c700">ip</a>[dir] == mpi-&gt;<a class="code" href="a00117.html#a0be0f30a83bc3f3d9f6ee3a36bbf2716">iproc</a>[dir]-1) &amp;&amp; (indexI[dir] == dim[dir])) ) {</div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;</div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;        <span class="comment">/* Use 5th order upwind at the physical boundaries */</span></div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;        <a class="code" href="a00136.html#a2b2826031c0cd92495ab351d3e599fc5">_ArraySetValue_</a>((A+Nsys*indexI[dir]+sys*nvars),nvars,0.0)</div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;        <a class="code" href="a00136.html#a2b2826031c0cd92495ab351d3e599fc5">_ArraySetValue_</a>((B+Nsys*indexI[dir]+sys*nvars),nvars,1.0)</div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;        <a class="code" href="a00136.html#a2b2826031c0cd92495ab351d3e599fc5">_ArraySetValue_</a>((C+Nsys*indexI[dir]+sys*nvars),nvars,0.0)</div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;        for (v=0; v&lt;nvars; v++) {</div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;          (R+Nsys*indexI[dir]+sys*nvars)[v] =   one_by_thirty         * fm3[v]</div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;                                              - thirteen_by_sixty     * fm2[v]</div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;                                              + fortyseven_by_sixty   * fm1[v]</div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;                                              + twentyseven_by_sixty  * fp1[v]</div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;                                              - one_by_twenty         * fp2[v];</div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;        }</div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;</div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;      } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;</div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;        <span class="comment">/* Use 5th order upwind at the physical boundaries */</span></div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;        <span class="keywordflow">if</span> (upw &gt; 0) {</div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;          <a class="code" href="a00136.html#a2b2826031c0cd92495ab351d3e599fc5">_ArraySetValue_</a>((A+Nsys*indexI[dir]+sys*nvars),nvars,three_by_ten);</div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;          <a class="code" href="a00136.html#a2b2826031c0cd92495ab351d3e599fc5">_ArraySetValue_</a>((B+Nsys*indexI[dir]+sys*nvars),nvars,six_by_ten  );</div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;          <a class="code" href="a00136.html#a2b2826031c0cd92495ab351d3e599fc5">_ArraySetValue_</a>((C+Nsys*indexI[dir]+sys*nvars),nvars,one_by_ten  );</div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;          <a class="code" href="a00136.html#a2b2826031c0cd92495ab351d3e599fc5">_ArraySetValue_</a>((C+Nsys*indexI[dir]+sys*nvars),nvars,three_by_ten);</div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;          <a class="code" href="a00136.html#a2b2826031c0cd92495ab351d3e599fc5">_ArraySetValue_</a>((B+Nsys*indexI[dir]+sys*nvars),nvars,six_by_ten  );</div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;          <a class="code" href="a00136.html#a2b2826031c0cd92495ab351d3e599fc5">_ArraySetValue_</a>((A+Nsys*indexI[dir]+sys*nvars),nvars,one_by_ten  );</div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;        }</div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;        <span class="keywordflow">for</span> (v=0; v&lt;nvars; v++) {</div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;          (R+Nsys*indexI[dir]+sys*nvars)[v] =   one_by_thirty      * fm2[v]</div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;                                              + nineteen_by_thirty * fm1[v]</div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;                                              + one_third          * fp1[v];</div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;        }</div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;      }</div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;    }</div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;  }</div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;</div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;<span class="preprocessor">#ifdef serial</span></div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;<span class="preprocessor"></span></div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;  <span class="comment">/* Solve the tridiagonal system */</span></div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;  <a class="code" href="a00137.html#ad6ab74942c9de13cf0b4c12eb0d91780">IERR</a> <a class="code" href="a00131.html#a83b53dedf034d67bf2dde46eebf492ee">tridiagLU</a>(A,B,C,R,dim[dir]+1,Nsys,lu,NULL); <a class="code" href="a00137.html#add9cf96ae374934d245a1dc1ab697a42">CHECKERR</a>(ierr);</div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;</div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;<span class="preprocessor">#else</span></div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;<span class="preprocessor"></span></div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;  <span class="comment">/* Solve the tridiagonal system */</span></div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;  <span class="comment">/* all processes except the last will solve without the last interface to avoid overlap */</span></div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;  <span class="keywordflow">if</span> (mpi-&gt;<a class="code" href="a00117.html#aa3c28612a64b8a97bde66b720e15c700">ip</a>[dir] != mpi-&gt;<a class="code" href="a00117.html#a0be0f30a83bc3f3d9f6ee3a36bbf2716">iproc</a>[dir]-1)  { <a class="code" href="a00137.html#ad6ab74942c9de13cf0b4c12eb0d91780">IERR</a> <a class="code" href="a00131.html#a83b53dedf034d67bf2dde46eebf492ee">tridiagLU</a>(A,B,C,R,dim[dir]  ,Nsys,lu,&amp;mpi-&gt;<a class="code" href="a00117.html#a45a2dae130e8ef21ae3aa9c7a9e7a138">comm</a>[dir]); <a class="code" href="a00137.html#add9cf96ae374934d245a1dc1ab697a42">CHECKERR</a>(ierr); }</div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;  <span class="keywordflow">else</span>                                    { <a class="code" href="a00137.html#ad6ab74942c9de13cf0b4c12eb0d91780">IERR</a> <a class="code" href="a00131.html#a83b53dedf034d67bf2dde46eebf492ee">tridiagLU</a>(A,B,C,R,dim[dir]+1,Nsys,lu,&amp;mpi-&gt;<a class="code" href="a00117.html#a45a2dae130e8ef21ae3aa9c7a9e7a138">comm</a>[dir]); <a class="code" href="a00137.html#add9cf96ae374934d245a1dc1ab697a42">CHECKERR</a>(ierr); }</div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;</div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;  <span class="comment">/* Now get the solution to the last interface from the next proc */</span></div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;  <span class="keywordtype">double</span> *sendbuf = compact-&gt;<a class="code" href="a00105.html#aba3b15034da676474db917f9f5533085">sendbuf</a>;</div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;  <span class="keywordtype">double</span> *recvbuf = compact-&gt;<a class="code" href="a00105.html#afc23e46e08649e112e8d64d780cea5cb">recvbuf</a>;</div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;  MPI_Request req[2] = {MPI_REQUEST_NULL,MPI_REQUEST_NULL};</div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;  <span class="keywordflow">if</span> (mpi-&gt;<a class="code" href="a00117.html#aa3c28612a64b8a97bde66b720e15c700">ip</a>[dir]) <span class="keywordflow">for</span> (d=0; d&lt;Nsys; d++) sendbuf[d] = R[d];</div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;  <span class="keywordflow">if</span> (mpi-&gt;<a class="code" href="a00117.html#aa3c28612a64b8a97bde66b720e15c700">ip</a>[dir] != mpi-&gt;<a class="code" href="a00117.html#a0be0f30a83bc3f3d9f6ee3a36bbf2716">iproc</a>[dir]-1) MPI_Irecv(recvbuf,Nsys,MPI_DOUBLE,mpi-&gt;<a class="code" href="a00117.html#aa3c28612a64b8a97bde66b720e15c700">ip</a>[dir]+1,214,mpi-&gt;<a class="code" href="a00117.html#a45a2dae130e8ef21ae3aa9c7a9e7a138">comm</a>[dir],&amp;req[0]);</div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;  <span class="keywordflow">if</span> (mpi-&gt;<a class="code" href="a00117.html#aa3c28612a64b8a97bde66b720e15c700">ip</a>[dir])                      MPI_Isend(sendbuf,Nsys,MPI_DOUBLE,mpi-&gt;<a class="code" href="a00117.html#aa3c28612a64b8a97bde66b720e15c700">ip</a>[dir]-1,214,mpi-&gt;<a class="code" href="a00117.html#a45a2dae130e8ef21ae3aa9c7a9e7a138">comm</a>[dir],&amp;req[1]);</div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;  MPI_Waitall(2,&amp;req[0],MPI_STATUS_IGNORE);</div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;  <span class="keywordflow">if</span> (mpi-&gt;<a class="code" href="a00117.html#aa3c28612a64b8a97bde66b720e15c700">ip</a>[dir] != mpi-&gt;<a class="code" href="a00117.html#a0be0f30a83bc3f3d9f6ee3a36bbf2716">iproc</a>[dir]-1) <span class="keywordflow">for</span> (d=0; d&lt;Nsys; d++) R[d+Nsys*dim[dir]] = recvbuf[d];</div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;</div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;<span class="preprocessor"></span></div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;  <span class="comment">/* save the solution to fI */</span></div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;<span class="preprocessor">#pragma omp parallel for schedule(auto) default(shared) private(sys,d,index_outer,indexC,indexI)</span></div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;<span class="preprocessor"></span>  <span class="keywordflow">for</span> (sys=0; sys &lt; N_outer; sys++) {</div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;    <a class="code" href="a00136.html#a03f49e4d44ae8aca85cb04cfe91e4ce4">_ArrayIndexnD_</a>(ndims,sys,bounds_outer,index_outer,0);</div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;    <a class="code" href="a00136.html#a89e8330d9e06dd0666c50833628a125c">_ArrayCopy1D_</a>(index_outer,indexI,ndims);</div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;    <span class="keywordflow">for</span> (indexI[dir] = 0; indexI[dir] &lt; dim[dir]+1; indexI[dir]++) {</div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;      <span class="keywordtype">int</span> p; <a class="code" href="a00136.html#afbb862a2fdf5b72b1f9ace42f64b556f">_ArrayIndex1D_</a>(ndims,bounds_inter,indexI,0,p);</div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;      <a class="code" href="a00136.html#a89e8330d9e06dd0666c50833628a125c">_ArrayCopy1D_</a>((R+sys*nvars+Nsys*indexI[dir]),(fI+nvars*p),nvars);</div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;    }</div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;  }</div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;</div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;  <span class="keywordflow">return</span>(0);</div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;}</div>
<div class="ttc" id="a00131_html_a00521"><div class="ttname"><a href="a00131.html#a00521">TridiagLU</a></div><div class="ttdef"><b>Definition:</b> <a href="a00131_source.html#l00084">tridiagLU.h:84</a></div></div>
<div class="ttc" id="a00115_html_a56318721d534e74a96b440f8542a0232"><div class="ttname"><a href="a00115.html#a56318721d534e74a96b440f8542a0232">HyPar::compact</a></div><div class="ttdeci">void * compact</div><div class="ttdef"><b>Definition:</b> <a href="a00143_source.html#l00328">hypar.h:328</a></div></div>
<div class="ttc" id="a00115_html_a484873c74138512e41bc50d17b7d955a"><div class="ttname"><a href="a00115.html#a484873c74138512e41bc50d17b7d955a">HyPar::ndims</a></div><div class="ttdeci">int ndims</div><div class="ttdef"><b>Definition:</b> <a href="a00143_source.html#l00026">hypar.h:26</a></div></div>
<div class="ttc" id="a00115_html_aafc992b5fa79d5a4036024615d03bce6"><div class="ttname"><a href="a00115.html#aafc992b5fa79d5a4036024615d03bce6">HyPar::ghosts</a></div><div class="ttdeci">int ghosts</div><div class="ttdef"><b>Definition:</b> <a href="a00143_source.html#l00044">hypar.h:44</a></div></div>
<div class="ttc" id="a00115_html"><div class="ttname"><a href="a00115.html">HyPar</a></div><div class="ttdoc">Structure containing all solver-specific variables and functions. </div><div class="ttdef"><b>Definition:</b> <a href="a00143_source.html#l00023">hypar.h:23</a></div></div>
<div class="ttc" id="a00105_html_ac06de847603f5cfaec085f6fe500f3c8"><div class="ttname"><a href="a00105.html#ac06de847603f5cfaec085f6fe500f3c8">CompactScheme::R</a></div><div class="ttdeci">double * R</div><div class="ttdef"><b>Definition:</b> <a href="a00105_source.html#l00439">interpolation.h:439</a></div></div>
<div class="ttc" id="a00105_html_a00503"><div class="ttname"><a href="a00105.html#a00503">CompactScheme</a></div><div class="ttdoc">Structure of variables/parameters needed by the compact schemes. </div><div class="ttdef"><b>Definition:</b> <a href="a00105_source.html#l00437">interpolation.h:437</a></div></div>
<div class="ttc" id="a00137_html_ad6ab74942c9de13cf0b4c12eb0d91780"><div class="ttname"><a href="a00137.html#ad6ab74942c9de13cf0b4c12eb0d91780">IERR</a></div><div class="ttdeci">#define IERR</div><div class="ttdef"><b>Definition:</b> <a href="a00137_source.html#l00012">basic.h:12</a></div></div>
<div class="ttc" id="a00105_html_aba3b15034da676474db917f9f5533085"><div class="ttname"><a href="a00105.html#aba3b15034da676474db917f9f5533085">CompactScheme::sendbuf</a></div><div class="ttdeci">double * sendbuf</div><div class="ttdef"><b>Definition:</b> <a href="a00105_source.html#l00444">interpolation.h:444</a></div></div>
<div class="ttc" id="a00117_html_a0be0f30a83bc3f3d9f6ee3a36bbf2716"><div class="ttname"><a href="a00117.html#a0be0f30a83bc3f3d9f6ee3a36bbf2716">MPIVariables::iproc</a></div><div class="ttdeci">int * iproc</div><div class="ttdef"><b>Definition:</b> <a href="a00117_source.html#l00027">mpivars_struct.h:27</a></div></div>
<div class="ttc" id="a00115_html_ae8f6d2fd6490d3153cb4133bf183a404"><div class="ttname"><a href="a00115.html#ae8f6d2fd6490d3153cb4133bf183a404">HyPar::nvars</a></div><div class="ttdeci">int nvars</div><div class="ttdef"><b>Definition:</b> <a href="a00143_source.html#l00029">hypar.h:29</a></div></div>
<div class="ttc" id="a00105_html_a0a26ce8d1878aac6ddc87e3f6290e039"><div class="ttname"><a href="a00105.html#a0a26ce8d1878aac6ddc87e3f6290e039">CompactScheme::C</a></div><div class="ttdeci">double * C</div><div class="ttdef"><b>Definition:</b> <a href="a00105_source.html#l00439">interpolation.h:439</a></div></div>
<div class="ttc" id="a00136_html_a89e8330d9e06dd0666c50833628a125c"><div class="ttname"><a href="a00136.html#a89e8330d9e06dd0666c50833628a125c">_ArrayCopy1D_</a></div><div class="ttdeci">#define _ArrayCopy1D_(x, y, size)</div><div class="ttdef"><b>Definition:</b> <a href="a00136_source.html#l00318">arrayfunctions.h:318</a></div></div>
<div class="ttc" id="a00105_html_afc23e46e08649e112e8d64d780cea5cb"><div class="ttname"><a href="a00105.html#afc23e46e08649e112e8d64d780cea5cb">CompactScheme::recvbuf</a></div><div class="ttdeci">double * recvbuf</div><div class="ttdef"><b>Definition:</b> <a href="a00105_source.html#l00444">interpolation.h:444</a></div></div>
<div class="ttc" id="a00115_html_a38e0371f331cecbe63a77fa03e202afe"><div class="ttname"><a href="a00115.html#a38e0371f331cecbe63a77fa03e202afe">HyPar::dim_local</a></div><div class="ttdeci">int * dim_local</div><div class="ttdef"><b>Definition:</b> <a href="a00143_source.html#l00035">hypar.h:35</a></div></div>
<div class="ttc" id="a00117_html_aa3c28612a64b8a97bde66b720e15c700"><div class="ttname"><a href="a00117.html#aa3c28612a64b8a97bde66b720e15c700">MPIVariables::ip</a></div><div class="ttdeci">int * ip</div><div class="ttdef"><b>Definition:</b> <a href="a00117_source.html#l00028">mpivars_struct.h:28</a></div></div>
<div class="ttc" id="a00136_html_a2b2826031c0cd92495ab351d3e599fc5"><div class="ttname"><a href="a00136.html#a2b2826031c0cd92495ab351d3e599fc5">_ArraySetValue_</a></div><div class="ttdeci">#define _ArraySetValue_(x, size, value)</div><div class="ttdef"><b>Definition:</b> <a href="a00136_source.html#l00168">arrayfunctions.h:168</a></div></div>
<div class="ttc" id="a00117_html_a00516"><div class="ttname"><a href="a00117.html#a00516">MPIVariables</a></div><div class="ttdoc">Structure of MPI-related variables. </div><div class="ttdef"><b>Definition:</b> <a href="a00117_source.html#l00024">mpivars_struct.h:24</a></div></div>
<div class="ttc" id="a00137_html_add9cf96ae374934d245a1dc1ab697a42"><div class="ttname"><a href="a00137.html#add9cf96ae374934d245a1dc1ab697a42">CHECKERR</a></div><div class="ttdeci">#define CHECKERR(ierr)</div><div class="ttdef"><b>Definition:</b> <a href="a00137_source.html#l00014">basic.h:14</a></div></div>
<div class="ttc" id="a00115_html_a1dbfa1e479a373073b6ebf72401a7f0f"><div class="ttname"><a href="a00115.html#a1dbfa1e479a373073b6ebf72401a7f0f">HyPar::lusolver</a></div><div class="ttdeci">void * lusolver</div><div class="ttdef"><b>Definition:</b> <a href="a00143_source.html#l00332">hypar.h:332</a></div></div>
<div class="ttc" id="a00136_html_a03f49e4d44ae8aca85cb04cfe91e4ce4"><div class="ttname"><a href="a00136.html#a03f49e4d44ae8aca85cb04cfe91e4ce4">_ArrayIndexnD_</a></div><div class="ttdeci">#define _ArrayIndexnD_(N, index, imax, i, ghost)</div><div class="ttdef"><b>Definition:</b> <a href="a00136_source.html#l00020">arrayfunctions.h:20</a></div></div>
<div class="ttc" id="a00136_html_abc65e9c6a51b875f46fdb054a0ecf604"><div class="ttname"><a href="a00136.html#abc65e9c6a51b875f46fdb054a0ecf604">_ArrayProduct1D_</a></div><div class="ttdeci">#define _ArrayProduct1D_(x, size, p)</div><div class="ttdef"><b>Definition:</b> <a href="a00136_source.html#l00376">arrayfunctions.h:376</a></div></div>
<div class="ttc" id="a00131_html_a83b53dedf034d67bf2dde46eebf492ee"><div class="ttname"><a href="a00131.html#a83b53dedf034d67bf2dde46eebf492ee">tridiagLU</a></div><div class="ttdeci">int tridiagLU(double *, double *, double *, double *, int, int, void *, void *)</div><div class="ttdef"><b>Definition:</b> <a href="a00495_source.html#l00083">tridiagLU.c:83</a></div></div>
<div class="ttc" id="a00105_html_ac900805a486cbb8489e3c176ed6e0d8e"><div class="ttname"><a href="a00105.html#ac900805a486cbb8489e3c176ed6e0d8e">CompactScheme::A</a></div><div class="ttdeci">double * A</div><div class="ttdef"><b>Definition:</b> <a href="a00105_source.html#l00439">interpolation.h:439</a></div></div>
<div class="ttc" id="a00136_html_afbb862a2fdf5b72b1f9ace42f64b556f"><div class="ttname"><a href="a00136.html#afbb862a2fdf5b72b1f9ace42f64b556f">_ArrayIndex1D_</a></div><div class="ttdeci">#define _ArrayIndex1D_(N, imax, i, ghost, index)</div><div class="ttdef"><b>Definition:</b> <a href="a00136_source.html#l00039">arrayfunctions.h:39</a></div></div>
<div class="ttc" id="a00117_html_a45a2dae130e8ef21ae3aa9c7a9e7a138"><div class="ttname"><a href="a00117.html#a45a2dae130e8ef21ae3aa9c7a9e7a138">MPIVariables::comm</a></div><div class="ttdeci">MPI_Comm * comm</div><div class="ttdef"><b>Definition:</b> <a href="a00117_source.html#l00038">mpivars_struct.h:38</a></div></div>
<div class="ttc" id="a00137_html_a68f50121fb9a7daeaf60e50cdef82ef3"><div class="ttname"><a href="a00137.html#a68f50121fb9a7daeaf60e50cdef82ef3">_DECLARE_IERR_</a></div><div class="ttdeci">#define _DECLARE_IERR_</div><div class="ttdef"><b>Definition:</b> <a href="a00137_source.html#l00013">basic.h:13</a></div></div>
<div class="ttc" id="a00115_html_a39dc7def53a36bdc722aa90f52e04561"><div class="ttname"><a href="a00115.html#a39dc7def53a36bdc722aa90f52e04561">HyPar::stride_with_ghosts</a></div><div class="ttdeci">int * stride_with_ghosts</div><div class="ttdef"><b>Definition:</b> <a href="a00143_source.html#l00370">hypar.h:370</a></div></div>
<div class="ttc" id="a00105_html_ad36954709307649365515214a02ab06d"><div class="ttname"><a href="a00105.html#ad36954709307649365515214a02ab06d">CompactScheme::B</a></div><div class="ttdeci">double * B</div><div class="ttdef"><b>Definition:</b> <a href="a00105_source.html#l00439">interpolation.h:439</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="af2195885ad055989a1b2b11655843343"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int Interp1PrimFifthOrderWENO </td>
          <td>(</td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>fI</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>fC</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>u</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>upw</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>dir</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>s</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>m</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>uflag</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>5th order WENO reconstruction (component-wise) on a uniform grid </p>
<p>Component-wise interpolation of the first primitive at the cell interfaces using the fifth-order WENO scheme</p>
<p>Computes the interpolated values of the first primitive of a function \({\bf f}\left({\bf u}\right)\) at the interfaces from the cell-centered values of the function using the fifth order WENO scheme on a uniform grid. The first primitive is defined as a function \({\bf h}\left({\bf u}\right)\) that satisfies: </p>
<p class="formulaDsp">
\begin{equation} {\bf f}\left({\bf u}\left(x\right)\right) = \frac{1}{\Delta x} \int_{x-\Delta x/2}^{x+\Delta x/2} {\bf h}\left({\bf u}\left(\zeta\right)\right)d\zeta, \end{equation}
</p>
<p> where \(x\) is the spatial coordinate along the dimension of the interpolation. This function computes the 5th order WENO numerical approximation \(\hat{\bf f}_{j+1/2} \approx {\bf h}_{j+1/2}\) as the convex combination of three 3rd order methods: </p>
<p class="formulaDsp">
\begin{align} &amp;\ \omega_1\ \times\ \left[ \hat{\bf f}_{j+1/2}^1 = \frac{1}{3} {\bf f}_{j-2} - \frac{7}{6} {\bf f}_{j-1} + \frac{11}{6} {\bf f}_j \right]\\ + &amp;\ \omega_2\ \times\ \left[ \hat{\bf f}_{j+1/2}^2 = -\frac{1}{6} {\bf f}_{j-1} + \frac{5}{6} {\bf f}_j + \frac{1}{3} {\bf f}_{j+1} \right]\\ + &amp;\ \omega_3\ \times\ \left[ \hat{\bf f}_{j+1/2}^3 = \frac{1}{3} {\bf f}_j + \frac{5}{6} {\bf f}_{j+1} - \frac{1}{6} {\bf f}_{j+2} \right]\\ \Rightarrow &amp;\ \hat{\bf f}_{j+1/2} = \frac{\omega_1}{3} {\bf f}_{j-2} - \frac{1}{6}(7\omega_1+\omega_2){\bf f}_{j-1} + \frac{1}{6}(11\omega_1+5\omega_2+2\omega_3){\bf f}_j + \frac{1}{6}(2\omega_2+5\omega_3){\bf f}_{j+1} - \frac{\omega_3}{6}{\bf f}_{j+2}, \end{align}
</p>
<p> where \(\omega_k; k=1,2,3\) are the nonlinear WENO weights computed in <a class="el" href="a00243.html#a91383df8b8b5f32861e2ecb18dab8ab7">WENOFifthOrderCalculateWeights()</a> (note that the \(\omega\) are different for each component of the vector \(\hat{\bf f}\)).</p>
<p><b>Implementation</b> <b>Notes:</b> </p>
<ul>
<li>This method assumes a uniform grid in the spatial dimension corresponding to the interpolation.</li>
<li>The method described above corresponds to a left-biased interpolation. The corresponding right-biased interpolation can be obtained by reflecting the equations about interface j+1/2.</li>
<li>The scalar interpolation method is applied to the vector function in a component-wise manner.</li>
<li>The function computes the interpolant for the entire grid in one call. It loops over all the grid lines along the interpolation direction and carries out the 1D interpolation along these grid lines.</li>
<li>Location of cell-centers and cell interfaces along the spatial dimension of the interpolation is shown in the following figure: <div class="image">
<img src="chap1_1Ddomain.png" alt="chap1_1Ddomain.png"/>
</div>
 </li>
</ul>
<p><b>Function</b> <b>arguments:</b> </p>
<table class="doxtable">
<tr>
<th>Argument </th><th>Type </th><th>Explanation  </th></tr>
<tr>
<td>fI </td><td>double* </td><td>Array to hold the computed interpolant at the grid interfaces. This array must have the same layout as the solution, but with <b>no</b> <b>ghost</b> <b>points</b>. Its size should be the same as u in all dimensions, except dir (the dimension along which to interpolate) along which it should be larger by 1 (number of interfaces is 1 more than the number of interior cell centers). </td></tr>
<tr>
<td>fC </td><td>double* </td><td>Array with the cell-centered values of the flux function \({\bf f}\left({\bf u}\right)\). This array must have the same layout and size as the solution, <b>with</b> <b>ghost</b> <b>points</b>. </td></tr>
<tr>
<td>u </td><td>double* </td><td>The solution array \({\bf u}\) (with ghost points). If the interpolation is characteristic based, this is needed to compute the eigendecomposition. For a multidimensional problem, the layout is as follows: u is a contiguous 1D array of size (nvars*dim[0]*dim[1]*...*dim[D-1]) corresponding to the multi-dimensional solution, with the following ordering - nvars, dim[0], dim[1], ..., dim[D-1], where nvars is the number of solution components (<a class="el" href="a00115.html#ae8f6d2fd6490d3153cb4133bf183a404">HyPar::nvars</a>), dim is the local size (<a class="el" href="a00115.html#a38e0371f331cecbe63a77fa03e202afe">HyPar::dim_local</a>), D is the number of spatial dimensions. </td></tr>
<tr>
<td>x </td><td>double* </td><td>The grid array (with ghost points). This is used only by non-uniform-grid interpolation methods. For multidimensional problems, the layout is as follows: x is a contiguous 1D array of size (dim[0]+dim[1]+...+dim[D-1]), with the spatial coordinates along dim[0] stored from 0,...,dim[0]-1, the spatial coordinates along dim[1] stored along dim[0],...,dim[0]+dim[1]-1, and so forth. </td></tr>
<tr>
<td>upw </td><td>int </td><td>Upwinding direction: if positive, a left-biased interpolant will be computed; if negative, a right-biased interpolant will be computed. If the interpolation method is central, then this has no effect. </td></tr>
<tr>
<td>dir </td><td>int </td><td>Spatial dimension along which to interpolate (eg: 0 for 1D; 0 or 1 for 2D; 0,1 or 2 for 3D) </td></tr>
<tr>
<td>s </td><td>void* </td><td>Solver object of type <a class="el" href="a00115.html" title="Structure containing all solver-specific variables and functions. ">HyPar</a>: the following variables are needed - <a class="el" href="a00115.html#aafc992b5fa79d5a4036024615d03bce6">HyPar::ghosts</a>, <a class="el" href="a00115.html#a484873c74138512e41bc50d17b7d955a">HyPar::ndims</a>, <a class="el" href="a00115.html#ae8f6d2fd6490d3153cb4133bf183a404">HyPar::nvars</a>, <a class="el" href="a00115.html#a38e0371f331cecbe63a77fa03e202afe">HyPar::dim_local</a>. </td></tr>
<tr>
<td>m </td><td>void* </td><td>MPI object of type <a class="el" href="a00117.html#a00516" title="Structure of MPI-related variables. ">MPIVariables</a>: this is needed only by compact interpolation method that need to solve a global implicit system across MPI ranks. </td></tr>
<tr>
<td>uflag </td><td>int </td><td>A flag indicating if the function being interpolated \({\bf f}\) is the solution itself \({\bf u}\) (if 1, \({\bf f}\left({\bf u}\right) \equiv {\bf u}\)). </td></tr>
</table>
<p><b>Reference:</b> </p>
<ul>
<li>Jiang, G.-S., Shu, C.-W., Efficient Implementation of Weighted ENO Schemes, J. Comput. Phys., 126 (1), 1996, pp. 202-228, <a href="http://dx.doi.org/10.1006/jcph.1996.0130">http://dx.doi.org/10.1006/jcph.1996.0130</a> </li>
</ul>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">fI</td><td>Array of interpolated function values at the interfaces </td></tr>
    <tr><td class="paramname">fC</td><td>Array of cell-centered values of the function \({\bf f}\left({\bf u}\right)\) </td></tr>
    <tr><td class="paramname">u</td><td>Array of cell-centered values of the solution \({\bf u}\) </td></tr>
    <tr><td class="paramname">x</td><td>Grid coordinates </td></tr>
    <tr><td class="paramname">upw</td><td>Upwind direction (left or right biased) </td></tr>
    <tr><td class="paramname">dir</td><td>Spatial dimension along which to interpolation </td></tr>
    <tr><td class="paramname">s</td><td>Object of type <a class="el" href="a00115.html" title="Structure containing all solver-specific variables and functions. ">HyPar</a> containing solver-related variables </td></tr>
    <tr><td class="paramname">m</td><td>Object of type <a class="el" href="a00117.html#a00516" title="Structure of MPI-related variables. ">MPIVariables</a> containing MPI-related variables </td></tr>
    <tr><td class="paramname">uflag</td><td>Flag to indicate if \(f(u) \equiv u\), i.e, if the solution is being reconstructed </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="a00230_source.html#l00072">72</a> of file <a class="el" href="a00230_source.html">Interp1PrimFifthOrderWENO.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;{</div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;  <a class="code" href="a00115.html">HyPar</a>           *solver = (<a class="code" href="a00115.html">HyPar</a>*)          s;</div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;  <a class="code" href="a00105.html#a00523">WENOParameters</a>  *weno   = (<a class="code" href="a00105.html#a00523">WENOParameters</a>*) solver-&gt;<a class="code" href="a00115.html#a29c46b81ad574e4dfbad5a7211487dcb">interp</a>;</div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;</div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;  <span class="keywordtype">int</span> ghosts = solver-&gt;<a class="code" href="a00115.html#aafc992b5fa79d5a4036024615d03bce6">ghosts</a>;</div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;  <span class="keywordtype">int</span> ndims  = solver-&gt;<a class="code" href="a00115.html#a484873c74138512e41bc50d17b7d955a">ndims</a>;</div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;  <span class="keywordtype">int</span> nvars  = solver-&gt;<a class="code" href="a00115.html#ae8f6d2fd6490d3153cb4133bf183a404">nvars</a>;</div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;  <span class="keywordtype">int</span> *dim   = solver-&gt;<a class="code" href="a00115.html#a38e0371f331cecbe63a77fa03e202afe">dim_local</a>;</div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;  <span class="keywordtype">int</span> *stride= solver-&gt;<a class="code" href="a00115.html#a39dc7def53a36bdc722aa90f52e04561">stride_with_ghosts</a>;</div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;</div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;  <span class="comment">/* define some constants */</span></div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;  <span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">double</span> one_sixth          = 1.0/6.0;</div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;</div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;  <span class="keywordtype">double</span> *ww1, *ww2, *ww3;</div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;  ww1 = weno-&gt;<a class="code" href="a00105.html#a3ee56e3d8244b3d4582f1396a79f9791">w1</a> + (upw &lt; 0 ? 2*weno-&gt;size : 0) + (uflag ? weno-&gt;<a class="code" href="a00105.html#a439227feff9d7f55384e8780cfc2eb82">size</a> : 0) + weno-&gt;<a class="code" href="a00105.html#ad0c30ee1add42468a6d7c022f2efdf70">offset</a>[dir];</div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;  ww2 = weno-&gt;<a class="code" href="a00105.html#a31eb3c1fcb3bc85ab4fa156325a1f849">w2</a> + (upw &lt; 0 ? 2*weno-&gt;size : 0) + (uflag ? weno-&gt;<a class="code" href="a00105.html#a439227feff9d7f55384e8780cfc2eb82">size</a> : 0) + weno-&gt;<a class="code" href="a00105.html#ad0c30ee1add42468a6d7c022f2efdf70">offset</a>[dir];</div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;  ww3 = weno-&gt;<a class="code" href="a00105.html#aabd83eb3f8a7e3bb9f79a4a943bbd508">w3</a> + (upw &lt; 0 ? 2*weno-&gt;size : 0) + (uflag ? weno-&gt;<a class="code" href="a00105.html#a439227feff9d7f55384e8780cfc2eb82">size</a> : 0) + weno-&gt;<a class="code" href="a00105.html#ad0c30ee1add42468a6d7c022f2efdf70">offset</a>[dir];</div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;</div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;  <span class="comment">/* create index and bounds for the outer loop, i.e., to loop over all 1D lines along</span></div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;<span class="comment">     dimension &quot;dir&quot;                                                                    */</span></div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;  <span class="keywordtype">int</span> indexC[ndims], indexI[ndims], index_outer[ndims], bounds_outer[ndims], bounds_inter[ndims];</div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;  <a class="code" href="a00136.html#a89e8330d9e06dd0666c50833628a125c">_ArrayCopy1D_</a>(dim,bounds_outer,ndims); bounds_outer[dir] =  1;</div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;  <a class="code" href="a00136.html#a89e8330d9e06dd0666c50833628a125c">_ArrayCopy1D_</a>(dim,bounds_inter,ndims); bounds_inter[dir] += 1;</div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;  <span class="keywordtype">int</span> N_outer; <a class="code" href="a00136.html#abc65e9c6a51b875f46fdb054a0ecf604">_ArrayProduct1D_</a>(bounds_outer,ndims,N_outer);</div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;</div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;  <span class="keywordtype">int</span> i;</div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;<span class="preprocessor">#pragma omp parallel for schedule(auto) default(shared) private(i,index_outer,indexC,indexI)</span></div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;<span class="preprocessor"></span>  <span class="keywordflow">for</span> (i=0; i&lt;N_outer; i++) {</div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;    <a class="code" href="a00136.html#a03f49e4d44ae8aca85cb04cfe91e4ce4">_ArrayIndexnD_</a>(ndims,i,bounds_outer,index_outer,0);</div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;    <a class="code" href="a00136.html#a89e8330d9e06dd0666c50833628a125c">_ArrayCopy1D_</a>(index_outer,indexC,ndims);</div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;    <a class="code" href="a00136.html#a89e8330d9e06dd0666c50833628a125c">_ArrayCopy1D_</a>(index_outer,indexI,ndims);</div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;    <span class="keywordflow">for</span> (indexI[dir] = 0; indexI[dir] &lt; dim[dir]+1; indexI[dir]++) {</div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;      <span class="keywordtype">int</span> qm1,qm2,qm3,qp1,qp2,p;</div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;      <a class="code" href="a00136.html#afbb862a2fdf5b72b1f9ace42f64b556f">_ArrayIndex1D_</a>(ndims,bounds_inter,indexI,0,p);</div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;      <span class="keywordflow">if</span> (upw &gt; 0) {</div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;        indexC[dir] = indexI[dir]-1; <a class="code" href="a00136.html#afbb862a2fdf5b72b1f9ace42f64b556f">_ArrayIndex1D_</a>(ndims,dim,indexC,ghosts,qm1);</div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;        qm3 = qm1 - 2*stride[dir];</div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;        qm2 = qm1 -   stride[dir];</div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;        qp1 = qm1 +   stride[dir];</div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;        qp2 = qm1 + 2*stride[dir];</div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;      } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;        indexC[dir] = indexI[dir]  ; <a class="code" href="a00136.html#afbb862a2fdf5b72b1f9ace42f64b556f">_ArrayIndex1D_</a>(ndims,dim,indexC,ghosts,qm1);</div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;        qm3 = qm1 + 2*stride[dir];</div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;        qm2 = qm1 +   stride[dir];</div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;        qp1 = qm1 -   stride[dir];</div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;        qp2 = qm1 - 2*stride[dir];</div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;      }</div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;</div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;      <span class="comment">/* Defining stencil points */</span></div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;      <span class="keywordtype">double</span> *fm3, *fm2, *fm1, *fp1, *fp2;</div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;      fm3 = (fC+qm3*nvars);</div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;      fm2 = (fC+qm2*nvars);</div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;      fm1 = (fC+qm1*nvars);</div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;      fp1 = (fC+qp1*nvars);</div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;      fp2 = (fC+qp2*nvars);</div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;</div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;      <span class="comment">/* Candidate stencils and their optimal weights*/</span></div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;      <span class="keywordtype">double</span> f1[nvars], f2[nvars], f3[nvars];</div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;      <a class="code" href="a00136.html#a7f8e5a8a430e71fd48b436003049d07b">_ArrayAXBYCZ_</a>(f1,(2*one_sixth),fm3,(-7*one_sixth) ,fm2,(11*one_sixth) ,fm1,nvars);</div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;      <a class="code" href="a00136.html#a7f8e5a8a430e71fd48b436003049d07b">_ArrayAXBYCZ_</a>(f2,(-one_sixth) ,fm2,(5*one_sixth)  ,fm1,(2*one_sixth)  ,fp1,nvars);</div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;      <a class="code" href="a00136.html#a7f8e5a8a430e71fd48b436003049d07b">_ArrayAXBYCZ_</a>(f3,(2*one_sixth),fm1,(5*one_sixth)  ,fp1,(-one_sixth)   ,fp2,nvars);</div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;</div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;      <span class="comment">/* calculate WENO weights */</span></div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;      <span class="keywordtype">double</span> *w1,*w2,*w3;</div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;      w1 = (ww1+p*nvars);</div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;      w2 = (ww2+p*nvars);</div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;      w3 = (ww3+p*nvars);</div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;</div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;      <a class="code" href="a00136.html#a6e9a85d9e2b01e38fecf30887ad7cf17">_ArrayMultiply3Add1D_</a>((fI+p*nvars),w1,f1,w2,f2,w3,f3,nvars);</div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;    }</div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;  }</div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;</div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;  <span class="keywordflow">return</span>(0);</div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;}</div>
<div class="ttc" id="a00115_html_a484873c74138512e41bc50d17b7d955a"><div class="ttname"><a href="a00115.html#a484873c74138512e41bc50d17b7d955a">HyPar::ndims</a></div><div class="ttdeci">int ndims</div><div class="ttdef"><b>Definition:</b> <a href="a00143_source.html#l00026">hypar.h:26</a></div></div>
<div class="ttc" id="a00136_html_a6e9a85d9e2b01e38fecf30887ad7cf17"><div class="ttname"><a href="a00136.html#a6e9a85d9e2b01e38fecf30887ad7cf17">_ArrayMultiply3Add1D_</a></div><div class="ttdeci">#define _ArrayMultiply3Add1D_(x, a, b, c, d, e, f, size)</div><div class="ttdef"><b>Definition:</b> <a href="a00136_source.html#l00233">arrayfunctions.h:233</a></div></div>
<div class="ttc" id="a00115_html_aafc992b5fa79d5a4036024615d03bce6"><div class="ttname"><a href="a00115.html#aafc992b5fa79d5a4036024615d03bce6">HyPar::ghosts</a></div><div class="ttdeci">int ghosts</div><div class="ttdef"><b>Definition:</b> <a href="a00143_source.html#l00044">hypar.h:44</a></div></div>
<div class="ttc" id="a00115_html"><div class="ttname"><a href="a00115.html">HyPar</a></div><div class="ttdoc">Structure containing all solver-specific variables and functions. </div><div class="ttdef"><b>Definition:</b> <a href="a00143_source.html#l00023">hypar.h:23</a></div></div>
<div class="ttc" id="a00105_html_a3ee56e3d8244b3d4582f1396a79f9791"><div class="ttname"><a href="a00105.html#a3ee56e3d8244b3d4582f1396a79f9791">WENOParameters::w1</a></div><div class="ttdeci">double * w1</div><div class="ttdef"><b>Definition:</b> <a href="a00105_source.html#l00193">interpolation.h:193</a></div></div>
<div class="ttc" id="a00105_html_a31eb3c1fcb3bc85ab4fa156325a1f849"><div class="ttname"><a href="a00105.html#a31eb3c1fcb3bc85ab4fa156325a1f849">WENOParameters::w2</a></div><div class="ttdeci">double * w2</div><div class="ttdef"><b>Definition:</b> <a href="a00105_source.html#l00193">interpolation.h:193</a></div></div>
<div class="ttc" id="a00105_html_a00523"><div class="ttname"><a href="a00105.html#a00523">WENOParameters</a></div><div class="ttdoc">Structure of variables/parameters needed by the WENO-type scheme. </div><div class="ttdef"><b>Definition:</b> <a href="a00105_source.html#l00175">interpolation.h:175</a></div></div>
<div class="ttc" id="a00105_html_a439227feff9d7f55384e8780cfc2eb82"><div class="ttname"><a href="a00105.html#a439227feff9d7f55384e8780cfc2eb82">WENOParameters::size</a></div><div class="ttdeci">int size</div><div class="ttdef"><b>Definition:</b> <a href="a00105_source.html#l00197">interpolation.h:197</a></div></div>
<div class="ttc" id="a00105_html_aabd83eb3f8a7e3bb9f79a4a943bbd508"><div class="ttname"><a href="a00105.html#aabd83eb3f8a7e3bb9f79a4a943bbd508">WENOParameters::w3</a></div><div class="ttdeci">double * w3</div><div class="ttdef"><b>Definition:</b> <a href="a00105_source.html#l00193">interpolation.h:193</a></div></div>
<div class="ttc" id="a00115_html_ae8f6d2fd6490d3153cb4133bf183a404"><div class="ttname"><a href="a00115.html#ae8f6d2fd6490d3153cb4133bf183a404">HyPar::nvars</a></div><div class="ttdeci">int nvars</div><div class="ttdef"><b>Definition:</b> <a href="a00143_source.html#l00029">hypar.h:29</a></div></div>
<div class="ttc" id="a00136_html_a89e8330d9e06dd0666c50833628a125c"><div class="ttname"><a href="a00136.html#a89e8330d9e06dd0666c50833628a125c">_ArrayCopy1D_</a></div><div class="ttdeci">#define _ArrayCopy1D_(x, y, size)</div><div class="ttdef"><b>Definition:</b> <a href="a00136_source.html#l00318">arrayfunctions.h:318</a></div></div>
<div class="ttc" id="a00115_html_a38e0371f331cecbe63a77fa03e202afe"><div class="ttname"><a href="a00115.html#a38e0371f331cecbe63a77fa03e202afe">HyPar::dim_local</a></div><div class="ttdeci">int * dim_local</div><div class="ttdef"><b>Definition:</b> <a href="a00143_source.html#l00035">hypar.h:35</a></div></div>
<div class="ttc" id="a00136_html_a03f49e4d44ae8aca85cb04cfe91e4ce4"><div class="ttname"><a href="a00136.html#a03f49e4d44ae8aca85cb04cfe91e4ce4">_ArrayIndexnD_</a></div><div class="ttdeci">#define _ArrayIndexnD_(N, index, imax, i, ghost)</div><div class="ttdef"><b>Definition:</b> <a href="a00136_source.html#l00020">arrayfunctions.h:20</a></div></div>
<div class="ttc" id="a00115_html_a29c46b81ad574e4dfbad5a7211487dcb"><div class="ttname"><a href="a00115.html#a29c46b81ad574e4dfbad5a7211487dcb">HyPar::interp</a></div><div class="ttdeci">void * interp</div><div class="ttdef"><b>Definition:</b> <a href="a00143_source.html#l00326">hypar.h:326</a></div></div>
<div class="ttc" id="a00136_html_abc65e9c6a51b875f46fdb054a0ecf604"><div class="ttname"><a href="a00136.html#abc65e9c6a51b875f46fdb054a0ecf604">_ArrayProduct1D_</a></div><div class="ttdeci">#define _ArrayProduct1D_(x, size, p)</div><div class="ttdef"><b>Definition:</b> <a href="a00136_source.html#l00376">arrayfunctions.h:376</a></div></div>
<div class="ttc" id="a00136_html_afbb862a2fdf5b72b1f9ace42f64b556f"><div class="ttname"><a href="a00136.html#afbb862a2fdf5b72b1f9ace42f64b556f">_ArrayIndex1D_</a></div><div class="ttdeci">#define _ArrayIndex1D_(N, imax, i, ghost, index)</div><div class="ttdef"><b>Definition:</b> <a href="a00136_source.html#l00039">arrayfunctions.h:39</a></div></div>
<div class="ttc" id="a00136_html_a7f8e5a8a430e71fd48b436003049d07b"><div class="ttname"><a href="a00136.html#a7f8e5a8a430e71fd48b436003049d07b">_ArrayAXBYCZ_</a></div><div class="ttdeci">#define _ArrayAXBYCZ_(w, a, x, b, y, c, z, size)</div><div class="ttdef"><b>Definition:</b> <a href="a00136_source.html#l00294">arrayfunctions.h:294</a></div></div>
<div class="ttc" id="a00105_html_ad0c30ee1add42468a6d7c022f2efdf70"><div class="ttname"><a href="a00105.html#ad0c30ee1add42468a6d7c022f2efdf70">WENOParameters::offset</a></div><div class="ttdeci">int * offset</div><div class="ttdef"><b>Definition:</b> <a href="a00105_source.html#l00197">interpolation.h:197</a></div></div>
<div class="ttc" id="a00115_html_a39dc7def53a36bdc722aa90f52e04561"><div class="ttname"><a href="a00115.html#a39dc7def53a36bdc722aa90f52e04561">HyPar::stride_with_ghosts</a></div><div class="ttdeci">int * stride_with_ghosts</div><div class="ttdef"><b>Definition:</b> <a href="a00143_source.html#l00370">hypar.h:370</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a33b1e24c12129941b0027a83c543a654"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int Interp1PrimFifthOrderCRWENO </td>
          <td>(</td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>fI</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>fC</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>u</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>upw</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>dir</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>s</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>m</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>uflag</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>5th order CRWENO reconstruction (component-wise) on a uniform grid </p>
<p>Component-wise interpolation of the first primitive at the cell interfaces using the fifth-order CRWENO scheme</p>
<p>Computes the interpolated values of the first primitive of a function \({\bf f}\left({\bf u}\right)\) at the interfaces from the cell-centered values of the function using the fifth order CRWENO scheme on a uniform grid. The first primitive is defined as a function \({\bf h}\left({\bf u}\right)\) that satisfies: </p>
<p class="formulaDsp">
\begin{equation} {\bf f}\left({\bf u}\left(x\right)\right) = \frac{1}{\Delta x} \int_{x-\Delta x/2}^{x+\Delta x/2} {\bf h}\left({\bf u}\left(\zeta\right)\right)d\zeta, \end{equation}
</p>
<p> where \(x\) is the spatial coordinate along the dimension of the interpolation. This function computes the 5th order CRWENO numerical approximation \(\hat{\bf f}_{j+1/2} \approx {\bf h}_{j+1/2}\) as the convex combination of three 3rd order methods: </p>
<p class="formulaDsp">
\begin{align} &amp;\ \omega_1\ \times\ \left[ \frac{2}{3}\hat{\bf f}_{j-1/2} + \frac{1}{3}\hat{\bf f}_{j+1/2} = \frac{1}{6} \left( f_{j-1} + 5f_j \right) \right]\\ + &amp;\ \omega_2\ \times\ \left[ \frac{1}{3}\hat{\bf f}_{j-1/2}+\frac{2}{3}\hat{\bf f}_{j+1/2} = \frac{1}{6} \left( 5f_j + f_{j+1} \right) \right] \\ + &amp;\ \omega_3\ \times\ \left[ \frac{2}{3}\hat{\bf f}_{j+1/2} + \frac{1}{3}\hat{\bf f}_{j+3/2} = \frac{1}{6} \left( f_j + 5f_{j+1} \right) \right] \\ \Rightarrow &amp;\ \left(\frac{2}{3}\omega_1+\frac{1}{3}\omega_2\right)\hat{\bf f}_{j-1/2} + \left[\frac{1}{3}\omega_1+\frac{2}{3}(\omega_2+\omega_3)\right]\hat{\bf f}_{j+1/2} + \frac{1}{3}\omega_3\hat{\bf f}_{j+3/2} = \frac{\omega_1}{6}{\bf f}_{j-1} + \frac{5(\omega_1+\omega_2)+\omega_3}{6}{\bf f}_j + \frac{\omega_2+5\omega_3}{6}{\bf f}_{j+1}, \end{align}
</p>
<p> where \(\omega_k; k=1,2,3\) are the nonlinear WENO weights computed in <a class="el" href="a00243.html#a91383df8b8b5f32861e2ecb18dab8ab7">WENOFifthOrderCalculateWeights()</a> (note that the \(\omega\) are different for each component of the vector \(\hat{\bf f}\)). The resulting tridiagonal system is solved using <a class="el" href="a00131.html#a83b53dedf034d67bf2dde46eebf492ee">tridiagLU()</a> (see also <a class="el" href="a00131.html#a00521">TridiagLU</a>, <a class="el" href="a00131.html" title="Header file for TridiagLU. ">tridiagLU.h</a>).</p>
<p><b>Implementation</b> <b>Notes:</b> </p>
<ul>
<li>This method assumes a uniform grid in the spatial dimension corresponding to the interpolation.</li>
<li>The method described above corresponds to a left-biased interpolation. The corresponding right-biased interpolation can be obtained by reflecting the equations about interface j+1/2.</li>
<li>The scalar interpolation method is applied to the vector function in a component-wise manner.</li>
<li>The function computes the interpolant for the entire grid in one call. It loops over all the grid lines along the interpolation direction and carries out the 1D interpolation along these grid lines.</li>
<li>Location of cell-centers and cell interfaces along the spatial dimension of the interpolation is shown in the following figure: <div class="image">
<img src="chap1_1Ddomain.png" alt="chap1_1Ddomain.png"/>
</div>
 </li>
</ul>
<p><b>Function</b> <b>arguments:</b> </p>
<table class="doxtable">
<tr>
<th>Argument </th><th>Type </th><th>Explanation  </th></tr>
<tr>
<td>fI </td><td>double* </td><td>Array to hold the computed interpolant at the grid interfaces. This array must have the same layout as the solution, but with <b>no</b> <b>ghost</b> <b>points</b>. Its size should be the same as u in all dimensions, except dir (the dimension along which to interpolate) along which it should be larger by 1 (number of interfaces is 1 more than the number of interior cell centers). </td></tr>
<tr>
<td>fC </td><td>double* </td><td>Array with the cell-centered values of the flux function \({\bf f}\left({\bf u}\right)\). This array must have the same layout and size as the solution, <b>with</b> <b>ghost</b> <b>points</b>. </td></tr>
<tr>
<td>u </td><td>double* </td><td>The solution array \({\bf u}\) (with ghost points). If the interpolation is characteristic based, this is needed to compute the eigendecomposition. For a multidimensional problem, the layout is as follows: u is a contiguous 1D array of size (nvars*dim[0]*dim[1]*...*dim[D-1]) corresponding to the multi-dimensional solution, with the following ordering - nvars, dim[0], dim[1], ..., dim[D-1], where nvars is the number of solution components (<a class="el" href="a00115.html#ae8f6d2fd6490d3153cb4133bf183a404">HyPar::nvars</a>), dim is the local size (<a class="el" href="a00115.html#a38e0371f331cecbe63a77fa03e202afe">HyPar::dim_local</a>), D is the number of spatial dimensions. </td></tr>
<tr>
<td>x </td><td>double* </td><td>The grid array (with ghost points). This is used only by non-uniform-grid interpolation methods. For multidimensional problems, the layout is as follows: x is a contiguous 1D array of size (dim[0]+dim[1]+...+dim[D-1]), with the spatial coordinates along dim[0] stored from 0,...,dim[0]-1, the spatial coordinates along dim[1] stored along dim[0],...,dim[0]+dim[1]-1, and so forth. </td></tr>
<tr>
<td>upw </td><td>int </td><td>Upwinding direction: if positive, a left-biased interpolant will be computed; if negative, a right-biased interpolant will be computed. If the interpolation method is central, then this has no effect. </td></tr>
<tr>
<td>dir </td><td>int </td><td>Spatial dimension along which to interpolate (eg: 0 for 1D; 0 or 1 for 2D; 0,1 or 2 for 3D) </td></tr>
<tr>
<td>s </td><td>void* </td><td>Solver object of type <a class="el" href="a00115.html" title="Structure containing all solver-specific variables and functions. ">HyPar</a>: the following variables are needed - <a class="el" href="a00115.html#aafc992b5fa79d5a4036024615d03bce6">HyPar::ghosts</a>, <a class="el" href="a00115.html#a484873c74138512e41bc50d17b7d955a">HyPar::ndims</a>, <a class="el" href="a00115.html#ae8f6d2fd6490d3153cb4133bf183a404">HyPar::nvars</a>, <a class="el" href="a00115.html#a38e0371f331cecbe63a77fa03e202afe">HyPar::dim_local</a>. </td></tr>
<tr>
<td>m </td><td>void* </td><td>MPI object of type <a class="el" href="a00117.html#a00516" title="Structure of MPI-related variables. ">MPIVariables</a>: this is needed only by compact interpolation method that need to solve a global implicit system across MPI ranks. </td></tr>
<tr>
<td>uflag </td><td>int </td><td>A flag indicating if the function being interpolated \({\bf f}\) is the solution itself \({\bf u}\) (if 1, \({\bf f}\left({\bf u}\right) \equiv {\bf u}\)). </td></tr>
</table>
<p><b>Reference:</b> </p>
<ul>
<li>Ghosh, D., Baeder, J. D., Compact Reconstruction Schemes with Weighted ENO Limiting for Hyperbolic Conservation Laws, SIAM Journal on Scientific Computing, 34 (3), 2012, A1678A1706, <a href="http://dx.doi.org/10.1137/110857659">http://dx.doi.org/10.1137/110857659</a></li>
<li>Ghosh, D., Constantinescu, E. M., Brown, J., Efficient Implementation of Nonlinear Compact Schemes on Massively Parallel Platforms, SIAM Journal on Scientific Computing, 37 (3), 2015, C354C383, <a href="http://dx.doi.org/10.1137/140989261">http://dx.doi.org/10.1137/140989261</a> </li>
</ul>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">fI</td><td>Array of interpolated function values at the interfaces </td></tr>
    <tr><td class="paramname">fC</td><td>Array of cell-centered values of the function \({\bf f}\left({\bf u}\right)\) </td></tr>
    <tr><td class="paramname">u</td><td>Array of cell-centered values of the solution \({\bf u}\) </td></tr>
    <tr><td class="paramname">x</td><td>Grid coordinates </td></tr>
    <tr><td class="paramname">upw</td><td>Upwind direction (left or right biased) </td></tr>
    <tr><td class="paramname">dir</td><td>Spatial dimension along which to interpolation </td></tr>
    <tr><td class="paramname">s</td><td>Object of type <a class="el" href="a00115.html" title="Structure containing all solver-specific variables and functions. ">HyPar</a> containing solver-related variables </td></tr>
    <tr><td class="paramname">m</td><td>Object of type <a class="el" href="a00117.html#a00516" title="Structure of MPI-related variables. ">MPIVariables</a> containing MPI-related variables </td></tr>
    <tr><td class="paramname">uflag</td><td>Flag to indicate if \(f(u) \equiv u\), i.e, if the solution is being reconstructed </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="a00224_source.html#l00078">78</a> of file <a class="el" href="a00224_source.html">Interp1PrimFifthOrderCRWENO.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;{</div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;  <a class="code" href="a00115.html">HyPar</a>           *solver = (<a class="code" href="a00115.html">HyPar</a>*)          s;</div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;  <a class="code" href="a00117.html#a00516">MPIVariables</a>    *mpi    = (<a class="code" href="a00117.html#a00516">MPIVariables</a>*)   m;</div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;  <a class="code" href="a00105.html#a00503">CompactScheme</a>   *compact= (<a class="code" href="a00105.html#a00503">CompactScheme</a>*)  solver-&gt;<a class="code" href="a00115.html#a56318721d534e74a96b440f8542a0232">compact</a>;</div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;  <a class="code" href="a00105.html#a00523">WENOParameters</a>  *weno   = (<a class="code" href="a00105.html#a00523">WENOParameters</a>*) solver-&gt;<a class="code" href="a00115.html#a29c46b81ad574e4dfbad5a7211487dcb">interp</a>;</div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;  <a class="code" href="a00131.html#a00521">TridiagLU</a>       *lu     = (<a class="code" href="a00131.html#a00521">TridiagLU</a>*)      solver-&gt;<a class="code" href="a00115.html#a1dbfa1e479a373073b6ebf72401a7f0f">lusolver</a>;</div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;  <span class="keywordtype">int</span>             sys,Nsys,d;</div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;  <a class="code" href="a00137.html#a68f50121fb9a7daeaf60e50cdef82ef3">_DECLARE_IERR_</a>;</div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;</div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;  <span class="keywordtype">int</span> ghosts = solver-&gt;<a class="code" href="a00115.html#aafc992b5fa79d5a4036024615d03bce6">ghosts</a>;</div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;  <span class="keywordtype">int</span> ndims  = solver-&gt;<a class="code" href="a00115.html#a484873c74138512e41bc50d17b7d955a">ndims</a>;</div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;  <span class="keywordtype">int</span> nvars  = solver-&gt;<a class="code" href="a00115.html#ae8f6d2fd6490d3153cb4133bf183a404">nvars</a>;</div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;  <span class="keywordtype">int</span> *dim   = solver-&gt;<a class="code" href="a00115.html#a38e0371f331cecbe63a77fa03e202afe">dim_local</a>;</div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;  <span class="keywordtype">int</span> *stride= solver-&gt;<a class="code" href="a00115.html#a39dc7def53a36bdc722aa90f52e04561">stride_with_ghosts</a>;</div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;</div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;  <span class="comment">/* define some constants */</span></div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;  <span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">double</span> one_third          = 1.0/3.0;</div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;  <span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">double</span> one_sixth          = 1.0/6.0;</div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;</div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;  <span class="keywordtype">double</span> *ww1, *ww2, *ww3;</div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;  ww1 = weno-&gt;w1 + (upw &lt; 0 ? 2*weno-&gt;size : 0) + (uflag ? weno-&gt;size : 0) + weno-&gt;offset[dir];</div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;  ww2 = weno-&gt;w2 + (upw &lt; 0 ? 2*weno-&gt;size : 0) + (uflag ? weno-&gt;size : 0) + weno-&gt;offset[dir];</div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;  ww3 = weno-&gt;w3 + (upw &lt; 0 ? 2*weno-&gt;size : 0) + (uflag ? weno-&gt;size : 0) + weno-&gt;offset[dir];</div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;</div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;  <span class="comment">/* create index and bounds for the outer loop, i.e., to loop over all 1D lines along</span></div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;<span class="comment">     dimension &quot;dir&quot;                                                                    */</span></div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;  <span class="keywordtype">int</span> indexC[ndims], indexI[ndims], index_outer[ndims], bounds_outer[ndims], bounds_inter[ndims];</div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;  <a class="code" href="a00136.html#a89e8330d9e06dd0666c50833628a125c">_ArrayCopy1D_</a>(dim,bounds_outer,ndims); bounds_outer[dir] =  1;</div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;  <a class="code" href="a00136.html#a89e8330d9e06dd0666c50833628a125c">_ArrayCopy1D_</a>(dim,bounds_inter,ndims); bounds_inter[dir] += 1;</div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;  <span class="keywordtype">int</span> N_outer; <a class="code" href="a00136.html#abc65e9c6a51b875f46fdb054a0ecf604">_ArrayProduct1D_</a>(bounds_outer,ndims,N_outer);</div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;</div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;  <span class="comment">/* calculate total number of tridiagonal systems to solve */</span></div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;  <a class="code" href="a00136.html#abc65e9c6a51b875f46fdb054a0ecf604">_ArrayProduct1D_</a>(bounds_outer,ndims,Nsys); Nsys *= nvars;</div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;</div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;  <span class="comment">/* Allocate arrays for tridiagonal system */</span></div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;  <span class="keywordtype">double</span> *A = compact-&gt;<a class="code" href="a00105.html#ac900805a486cbb8489e3c176ed6e0d8e">A</a>;</div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;  <span class="keywordtype">double</span> *B = compact-&gt;<a class="code" href="a00105.html#ad36954709307649365515214a02ab06d">B</a>;</div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;  <span class="keywordtype">double</span> *C = compact-&gt;<a class="code" href="a00105.html#a0a26ce8d1878aac6ddc87e3f6290e039">C</a>;</div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;  <span class="keywordtype">double</span> *R = compact-&gt;<a class="code" href="a00105.html#ac06de847603f5cfaec085f6fe500f3c8">R</a>;</div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;</div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;<span class="preprocessor">#pragma omp parallel for schedule(auto) default(shared) private(sys,d,index_outer,indexC,indexI)</span></div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;<span class="preprocessor"></span>  <span class="keywordflow">for</span> (sys=0; sys &lt; N_outer; sys++) {</div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;    <a class="code" href="a00136.html#a03f49e4d44ae8aca85cb04cfe91e4ce4">_ArrayIndexnD_</a>(ndims,sys,bounds_outer,index_outer,0);</div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;    <a class="code" href="a00136.html#a89e8330d9e06dd0666c50833628a125c">_ArrayCopy1D_</a>(index_outer,indexC,ndims);</div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;    <a class="code" href="a00136.html#a89e8330d9e06dd0666c50833628a125c">_ArrayCopy1D_</a>(index_outer,indexI,ndims);</div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;    <span class="keywordflow">for</span> (indexI[dir] = 0; indexI[dir] &lt; dim[dir]+1; indexI[dir]++) {</div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;      <span class="keywordtype">int</span> qm1,qm2,qm3,qp1,qp2,p;</div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;      <a class="code" href="a00136.html#afbb862a2fdf5b72b1f9ace42f64b556f">_ArrayIndex1D_</a>(ndims,bounds_inter,indexI,0,p);</div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;      <span class="keywordflow">if</span> (upw &gt; 0) {</div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;        indexC[dir] = indexI[dir]-1; <a class="code" href="a00136.html#afbb862a2fdf5b72b1f9ace42f64b556f">_ArrayIndex1D_</a>(ndims,dim,indexC,ghosts,qm1);</div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;        qm3 = qm1 - 2*stride[dir];</div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;        qm2 = qm1 -   stride[dir];</div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;        qp1 = qm1 +   stride[dir];</div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;        qp2 = qm1 + 2*stride[dir];</div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;      } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;        indexC[dir] = indexI[dir]  ; <a class="code" href="a00136.html#afbb862a2fdf5b72b1f9ace42f64b556f">_ArrayIndex1D_</a>(ndims,dim,indexC,ghosts,qm1);</div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;        qm3 = qm1 + 2*stride[dir];</div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;        qm2 = qm1 +   stride[dir];</div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;        qp1 = qm1 -   stride[dir];</div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;        qp2 = qm1 - 2*stride[dir];</div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;      }</div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;</div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;      <span class="comment">/* Defining stencil points */</span></div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;      <span class="keywordtype">double</span> *fm3, *fm2, *fm1, *fp1, *fp2;</div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;      fm3 = fC+qm3*nvars;</div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;      fm2 = fC+qm2*nvars;</div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;      fm1 = fC+qm1*nvars;</div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;      fp1 = fC+qp1*nvars;</div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;      fp2 = fC+qp2*nvars;</div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;</div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;      <span class="comment">/* Candidate stencils and their optimal weights*/</span></div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;      <span class="keywordtype">double</span> f1[nvars], f2[nvars], f3[nvars];</div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;      <span class="keywordflow">if</span> (   ((mpi-&gt;<a class="code" href="a00117.html#aa3c28612a64b8a97bde66b720e15c700">ip</a>[dir] == 0                ) &amp;&amp; (indexI[dir] == 0       ))</div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;          || ((mpi-&gt;<a class="code" href="a00117.html#aa3c28612a64b8a97bde66b720e15c700">ip</a>[dir] == mpi-&gt;<a class="code" href="a00117.html#a0be0f30a83bc3f3d9f6ee3a36bbf2716">iproc</a>[dir]-1) &amp;&amp; (indexI[dir] == dim[dir])) ) {</div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;        <span class="comment">/* Use WENO5 at the physical boundaries */</span></div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;        <a class="code" href="a00136.html#a7f8e5a8a430e71fd48b436003049d07b">_ArrayAXBYCZ_</a>(f1,(2*one_sixth),fm3,(-7*one_sixth) ,fm2,(11*one_sixth) ,fm1,nvars);</div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;        <a class="code" href="a00136.html#a7f8e5a8a430e71fd48b436003049d07b">_ArrayAXBYCZ_</a>(f2,(-one_sixth) ,fm2,(5*one_sixth)  ,fm1,(2*one_sixth)  ,fp1,nvars);</div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;        <a class="code" href="a00136.html#a7f8e5a8a430e71fd48b436003049d07b">_ArrayAXBYCZ_</a>(f3,(2*one_sixth),fm1,(5*one_sixth)  ,fp1,(-one_sixth)   ,fp2,nvars);</div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;      } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;        <span class="comment">/* CRWENO5 at the interior points */</span></div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;        <a class="code" href="a00136.html#ae2829ea36a04607caf64d3a462339af9">_ArrayAXBY_</a>(f1,(one_sixth)  ,fm2,(5*one_sixth),fm1,nvars);</div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;        <a class="code" href="a00136.html#ae2829ea36a04607caf64d3a462339af9">_ArrayAXBY_</a>(f2,(5*one_sixth),fm1,(one_sixth)  ,fp1,nvars);</div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;        <a class="code" href="a00136.html#ae2829ea36a04607caf64d3a462339af9">_ArrayAXBY_</a>(f3,(one_sixth)  ,fm1,(5*one_sixth),fp1,nvars);</div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;      }</div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;</div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;      <span class="comment">/* retrieve the WENO weights */</span></div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;      <span class="keywordtype">double</span> *w1, *w2, *w3;</div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;      w1 = (ww1+p*nvars);</div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;      w2 = (ww2+p*nvars);</div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;      w3 = (ww3+p*nvars);</div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;</div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;      <span class="keywordflow">if</span> (   ((mpi-&gt;<a class="code" href="a00117.html#aa3c28612a64b8a97bde66b720e15c700">ip</a>[dir] == 0                ) &amp;&amp; (indexI[dir] == 0       ))</div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;          || ((mpi-&gt;<a class="code" href="a00117.html#aa3c28612a64b8a97bde66b720e15c700">ip</a>[dir] == mpi-&gt;<a class="code" href="a00117.html#a0be0f30a83bc3f3d9f6ee3a36bbf2716">iproc</a>[dir]-1) &amp;&amp; (indexI[dir] == dim[dir])) ) {</div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;        <a class="code" href="a00136.html#a2b2826031c0cd92495ab351d3e599fc5">_ArraySetValue_</a>     ((A+Nsys*indexI[dir]+sys*nvars),nvars,0.0)</div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;        <a class="code" href="a00136.html#a2b2826031c0cd92495ab351d3e599fc5">_ArraySetValue_</a>     ((B+Nsys*indexI[dir]+sys*nvars),nvars,1.0)</div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;        <a class="code" href="a00136.html#a2b2826031c0cd92495ab351d3e599fc5">_ArraySetValue_</a>     ((C+Nsys*indexI[dir]+sys*nvars),nvars,0.0)</div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;      } else {</div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;        <span class="keywordflow">if</span> (upw &gt; 0) {</div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;          <a class="code" href="a00136.html#ae2829ea36a04607caf64d3a462339af9">_ArrayAXBY_</a>       ((A+Nsys*indexI[dir]+sys*nvars),(2*one_third) ,w1,(one_third)  ,w2,nvars);</div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;          <a class="code" href="a00136.html#a7f8e5a8a430e71fd48b436003049d07b">_ArrayAXBYCZ_</a>     ((B+Nsys*indexI[dir]+sys*nvars),(one_third)   ,w1,(2*one_third),w2,(2*one_third),w3,nvars);</div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;          <a class="code" href="a00136.html#a7d97d4914726fa7cca339356dae28473">_ArrayScaleCopy1D_</a>(w3,(one_third),(C+Nsys*indexI[dir]+sys*nvars),nvars);</div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;          <a class="code" href="a00136.html#ae2829ea36a04607caf64d3a462339af9">_ArrayAXBY_</a>       ((C+Nsys*indexI[dir]+sys*nvars),(2*one_third) ,w1,(one_third)  ,w2,nvars);</div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;          <a class="code" href="a00136.html#a7f8e5a8a430e71fd48b436003049d07b">_ArrayAXBYCZ_</a>     ((B+Nsys*indexI[dir]+sys*nvars),(one_third)   ,w1,(2*one_third),w2,(2*one_third),w3,nvars);</div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;          <a class="code" href="a00136.html#a7d97d4914726fa7cca339356dae28473">_ArrayScaleCopy1D_</a>(w3,(one_third),(A+Nsys*indexI[dir]+sys*nvars),nvars);</div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;        }</div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;      }</div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;      <a class="code" href="a00136.html#a6e9a85d9e2b01e38fecf30887ad7cf17">_ArrayMultiply3Add1D_</a> ((R+Nsys*indexI[dir]+sys*nvars),w1,f1,w2,f2,w3,f3,nvars);</div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;    }</div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;  }</div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;</div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;<span class="preprocessor">#ifdef serial</span></div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;<span class="preprocessor"></span></div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;  <span class="comment">/* Solve the tridiagonal system */</span></div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;  <a class="code" href="a00137.html#ad6ab74942c9de13cf0b4c12eb0d91780">IERR</a> <a class="code" href="a00131.html#a83b53dedf034d67bf2dde46eebf492ee">tridiagLU</a>(A,B,C,R,dim[dir]+1,Nsys,lu,NULL); <a class="code" href="a00137.html#add9cf96ae374934d245a1dc1ab697a42">CHECKERR</a>(ierr);</div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;</div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;<span class="preprocessor">#else</span></div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;<span class="preprocessor"></span></div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;  <span class="comment">/* Solve the tridiagonal system */</span></div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;  <span class="comment">/* all processes except the last will solve without the last interface to avoid overlap */</span></div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;  <span class="keywordflow">if</span> (mpi-&gt;<a class="code" href="a00117.html#aa3c28612a64b8a97bde66b720e15c700">ip</a>[dir] != mpi-&gt;<a class="code" href="a00117.html#a0be0f30a83bc3f3d9f6ee3a36bbf2716">iproc</a>[dir]-1)  { <a class="code" href="a00137.html#ad6ab74942c9de13cf0b4c12eb0d91780">IERR</a> <a class="code" href="a00131.html#a83b53dedf034d67bf2dde46eebf492ee">tridiagLU</a>(A,B,C,R,dim[dir]  ,Nsys,lu,&amp;mpi-&gt;<a class="code" href="a00117.html#a45a2dae130e8ef21ae3aa9c7a9e7a138">comm</a>[dir]); <a class="code" href="a00137.html#add9cf96ae374934d245a1dc1ab697a42">CHECKERR</a>(ierr); }</div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;  <span class="keywordflow">else</span>                                    { <a class="code" href="a00137.html#ad6ab74942c9de13cf0b4c12eb0d91780">IERR</a> <a class="code" href="a00131.html#a83b53dedf034d67bf2dde46eebf492ee">tridiagLU</a>(A,B,C,R,dim[dir]+1,Nsys,lu,&amp;mpi-&gt;<a class="code" href="a00117.html#a45a2dae130e8ef21ae3aa9c7a9e7a138">comm</a>[dir]); <a class="code" href="a00137.html#add9cf96ae374934d245a1dc1ab697a42">CHECKERR</a>(ierr); }</div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;</div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;  <span class="comment">/* Now get the solution to the last interface from the next proc */</span></div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;  <span class="keywordtype">double</span> *sendbuf = compact-&gt;<a class="code" href="a00105.html#aba3b15034da676474db917f9f5533085">sendbuf</a>;</div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;  <span class="keywordtype">double</span> *recvbuf = compact-&gt;<a class="code" href="a00105.html#afc23e46e08649e112e8d64d780cea5cb">recvbuf</a>;</div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;  MPI_Request req[2] = {MPI_REQUEST_NULL,MPI_REQUEST_NULL};</div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;  <span class="keywordflow">if</span> (mpi-&gt;<a class="code" href="a00117.html#aa3c28612a64b8a97bde66b720e15c700">ip</a>[dir]) <span class="keywordflow">for</span> (d=0; d&lt;Nsys; d++) sendbuf[d] = R[d];</div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;  <span class="keywordflow">if</span> (mpi-&gt;<a class="code" href="a00117.html#aa3c28612a64b8a97bde66b720e15c700">ip</a>[dir] != mpi-&gt;<a class="code" href="a00117.html#a0be0f30a83bc3f3d9f6ee3a36bbf2716">iproc</a>[dir]-1) MPI_Irecv(recvbuf,Nsys,MPI_DOUBLE,mpi-&gt;<a class="code" href="a00117.html#aa3c28612a64b8a97bde66b720e15c700">ip</a>[dir]+1,214,mpi-&gt;<a class="code" href="a00117.html#a45a2dae130e8ef21ae3aa9c7a9e7a138">comm</a>[dir],&amp;req[0]);</div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;  <span class="keywordflow">if</span> (mpi-&gt;<a class="code" href="a00117.html#aa3c28612a64b8a97bde66b720e15c700">ip</a>[dir])                      MPI_Isend(sendbuf,Nsys,MPI_DOUBLE,mpi-&gt;<a class="code" href="a00117.html#aa3c28612a64b8a97bde66b720e15c700">ip</a>[dir]-1,214,mpi-&gt;<a class="code" href="a00117.html#a45a2dae130e8ef21ae3aa9c7a9e7a138">comm</a>[dir],&amp;req[1]);</div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;  MPI_Waitall(2,&amp;req[0],MPI_STATUS_IGNORE);</div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;  <span class="keywordflow">if</span> (mpi-&gt;<a class="code" href="a00117.html#aa3c28612a64b8a97bde66b720e15c700">ip</a>[dir] != mpi-&gt;<a class="code" href="a00117.html#a0be0f30a83bc3f3d9f6ee3a36bbf2716">iproc</a>[dir]-1) <span class="keywordflow">for</span> (d=0; d&lt;Nsys; d++) R[d+Nsys*dim[dir]] = recvbuf[d];</div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;</div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;<span class="preprocessor"></span></div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;  <span class="comment">/* save the solution to fI */</span></div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;<span class="preprocessor">#pragma omp parallel for schedule(auto) default(shared) private(sys,d,index_outer,indexC,indexI)</span></div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;<span class="preprocessor"></span>  <span class="keywordflow">for</span> (sys=0; sys &lt; N_outer; sys++) {</div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;    <a class="code" href="a00136.html#a03f49e4d44ae8aca85cb04cfe91e4ce4">_ArrayIndexnD_</a>(ndims,sys,bounds_outer,index_outer,0);</div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;    <a class="code" href="a00136.html#a89e8330d9e06dd0666c50833628a125c">_ArrayCopy1D_</a>(index_outer,indexI,ndims);</div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;    <span class="keywordflow">for</span> (indexI[dir] = 0; indexI[dir] &lt; dim[dir]+1; indexI[dir]++) {</div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;      <span class="keywordtype">int</span> p; <a class="code" href="a00136.html#afbb862a2fdf5b72b1f9ace42f64b556f">_ArrayIndex1D_</a>(ndims,bounds_inter,indexI,0,p);</div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;      <a class="code" href="a00136.html#a89e8330d9e06dd0666c50833628a125c">_ArrayCopy1D_</a>((R+sys*nvars+Nsys*indexI[dir]),(fI+nvars*p),nvars);</div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;    }</div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;  }</div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;</div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;  <span class="keywordflow">return</span>(0);</div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;}</div>
<div class="ttc" id="a00131_html_a00521"><div class="ttname"><a href="a00131.html#a00521">TridiagLU</a></div><div class="ttdef"><b>Definition:</b> <a href="a00131_source.html#l00084">tridiagLU.h:84</a></div></div>
<div class="ttc" id="a00115_html_a56318721d534e74a96b440f8542a0232"><div class="ttname"><a href="a00115.html#a56318721d534e74a96b440f8542a0232">HyPar::compact</a></div><div class="ttdeci">void * compact</div><div class="ttdef"><b>Definition:</b> <a href="a00143_source.html#l00328">hypar.h:328</a></div></div>
<div class="ttc" id="a00115_html_a484873c74138512e41bc50d17b7d955a"><div class="ttname"><a href="a00115.html#a484873c74138512e41bc50d17b7d955a">HyPar::ndims</a></div><div class="ttdeci">int ndims</div><div class="ttdef"><b>Definition:</b> <a href="a00143_source.html#l00026">hypar.h:26</a></div></div>
<div class="ttc" id="a00136_html_a6e9a85d9e2b01e38fecf30887ad7cf17"><div class="ttname"><a href="a00136.html#a6e9a85d9e2b01e38fecf30887ad7cf17">_ArrayMultiply3Add1D_</a></div><div class="ttdeci">#define _ArrayMultiply3Add1D_(x, a, b, c, d, e, f, size)</div><div class="ttdef"><b>Definition:</b> <a href="a00136_source.html#l00233">arrayfunctions.h:233</a></div></div>
<div class="ttc" id="a00115_html_aafc992b5fa79d5a4036024615d03bce6"><div class="ttname"><a href="a00115.html#aafc992b5fa79d5a4036024615d03bce6">HyPar::ghosts</a></div><div class="ttdeci">int ghosts</div><div class="ttdef"><b>Definition:</b> <a href="a00143_source.html#l00044">hypar.h:44</a></div></div>
<div class="ttc" id="a00115_html"><div class="ttname"><a href="a00115.html">HyPar</a></div><div class="ttdoc">Structure containing all solver-specific variables and functions. </div><div class="ttdef"><b>Definition:</b> <a href="a00143_source.html#l00023">hypar.h:23</a></div></div>
<div class="ttc" id="a00105_html_ac06de847603f5cfaec085f6fe500f3c8"><div class="ttname"><a href="a00105.html#ac06de847603f5cfaec085f6fe500f3c8">CompactScheme::R</a></div><div class="ttdeci">double * R</div><div class="ttdef"><b>Definition:</b> <a href="a00105_source.html#l00439">interpolation.h:439</a></div></div>
<div class="ttc" id="a00105_html_a00503"><div class="ttname"><a href="a00105.html#a00503">CompactScheme</a></div><div class="ttdoc">Structure of variables/parameters needed by the compact schemes. </div><div class="ttdef"><b>Definition:</b> <a href="a00105_source.html#l00437">interpolation.h:437</a></div></div>
<div class="ttc" id="a00137_html_ad6ab74942c9de13cf0b4c12eb0d91780"><div class="ttname"><a href="a00137.html#ad6ab74942c9de13cf0b4c12eb0d91780">IERR</a></div><div class="ttdeci">#define IERR</div><div class="ttdef"><b>Definition:</b> <a href="a00137_source.html#l00012">basic.h:12</a></div></div>
<div class="ttc" id="a00105_html_a00523"><div class="ttname"><a href="a00105.html#a00523">WENOParameters</a></div><div class="ttdoc">Structure of variables/parameters needed by the WENO-type scheme. </div><div class="ttdef"><b>Definition:</b> <a href="a00105_source.html#l00175">interpolation.h:175</a></div></div>
<div class="ttc" id="a00105_html_aba3b15034da676474db917f9f5533085"><div class="ttname"><a href="a00105.html#aba3b15034da676474db917f9f5533085">CompactScheme::sendbuf</a></div><div class="ttdeci">double * sendbuf</div><div class="ttdef"><b>Definition:</b> <a href="a00105_source.html#l00444">interpolation.h:444</a></div></div>
<div class="ttc" id="a00117_html_a0be0f30a83bc3f3d9f6ee3a36bbf2716"><div class="ttname"><a href="a00117.html#a0be0f30a83bc3f3d9f6ee3a36bbf2716">MPIVariables::iproc</a></div><div class="ttdeci">int * iproc</div><div class="ttdef"><b>Definition:</b> <a href="a00117_source.html#l00027">mpivars_struct.h:27</a></div></div>
<div class="ttc" id="a00115_html_ae8f6d2fd6490d3153cb4133bf183a404"><div class="ttname"><a href="a00115.html#ae8f6d2fd6490d3153cb4133bf183a404">HyPar::nvars</a></div><div class="ttdeci">int nvars</div><div class="ttdef"><b>Definition:</b> <a href="a00143_source.html#l00029">hypar.h:29</a></div></div>
<div class="ttc" id="a00105_html_a0a26ce8d1878aac6ddc87e3f6290e039"><div class="ttname"><a href="a00105.html#a0a26ce8d1878aac6ddc87e3f6290e039">CompactScheme::C</a></div><div class="ttdeci">double * C</div><div class="ttdef"><b>Definition:</b> <a href="a00105_source.html#l00439">interpolation.h:439</a></div></div>
<div class="ttc" id="a00136_html_a89e8330d9e06dd0666c50833628a125c"><div class="ttname"><a href="a00136.html#a89e8330d9e06dd0666c50833628a125c">_ArrayCopy1D_</a></div><div class="ttdeci">#define _ArrayCopy1D_(x, y, size)</div><div class="ttdef"><b>Definition:</b> <a href="a00136_source.html#l00318">arrayfunctions.h:318</a></div></div>
<div class="ttc" id="a00105_html_afc23e46e08649e112e8d64d780cea5cb"><div class="ttname"><a href="a00105.html#afc23e46e08649e112e8d64d780cea5cb">CompactScheme::recvbuf</a></div><div class="ttdeci">double * recvbuf</div><div class="ttdef"><b>Definition:</b> <a href="a00105_source.html#l00444">interpolation.h:444</a></div></div>
<div class="ttc" id="a00115_html_a38e0371f331cecbe63a77fa03e202afe"><div class="ttname"><a href="a00115.html#a38e0371f331cecbe63a77fa03e202afe">HyPar::dim_local</a></div><div class="ttdeci">int * dim_local</div><div class="ttdef"><b>Definition:</b> <a href="a00143_source.html#l00035">hypar.h:35</a></div></div>
<div class="ttc" id="a00136_html_a7d97d4914726fa7cca339356dae28473"><div class="ttname"><a href="a00136.html#a7d97d4914726fa7cca339356dae28473">_ArrayScaleCopy1D_</a></div><div class="ttdeci">#define _ArrayScaleCopy1D_(x, a, y, size)</div><div class="ttdef"><b>Definition:</b> <a href="a00136_source.html#l00355">arrayfunctions.h:355</a></div></div>
<div class="ttc" id="a00117_html_aa3c28612a64b8a97bde66b720e15c700"><div class="ttname"><a href="a00117.html#aa3c28612a64b8a97bde66b720e15c700">MPIVariables::ip</a></div><div class="ttdeci">int * ip</div><div class="ttdef"><b>Definition:</b> <a href="a00117_source.html#l00028">mpivars_struct.h:28</a></div></div>
<div class="ttc" id="a00136_html_a2b2826031c0cd92495ab351d3e599fc5"><div class="ttname"><a href="a00136.html#a2b2826031c0cd92495ab351d3e599fc5">_ArraySetValue_</a></div><div class="ttdeci">#define _ArraySetValue_(x, size, value)</div><div class="ttdef"><b>Definition:</b> <a href="a00136_source.html#l00168">arrayfunctions.h:168</a></div></div>
<div class="ttc" id="a00117_html_a00516"><div class="ttname"><a href="a00117.html#a00516">MPIVariables</a></div><div class="ttdoc">Structure of MPI-related variables. </div><div class="ttdef"><b>Definition:</b> <a href="a00117_source.html#l00024">mpivars_struct.h:24</a></div></div>
<div class="ttc" id="a00137_html_add9cf96ae374934d245a1dc1ab697a42"><div class="ttname"><a href="a00137.html#add9cf96ae374934d245a1dc1ab697a42">CHECKERR</a></div><div class="ttdeci">#define CHECKERR(ierr)</div><div class="ttdef"><b>Definition:</b> <a href="a00137_source.html#l00014">basic.h:14</a></div></div>
<div class="ttc" id="a00115_html_a1dbfa1e479a373073b6ebf72401a7f0f"><div class="ttname"><a href="a00115.html#a1dbfa1e479a373073b6ebf72401a7f0f">HyPar::lusolver</a></div><div class="ttdeci">void * lusolver</div><div class="ttdef"><b>Definition:</b> <a href="a00143_source.html#l00332">hypar.h:332</a></div></div>
<div class="ttc" id="a00136_html_a03f49e4d44ae8aca85cb04cfe91e4ce4"><div class="ttname"><a href="a00136.html#a03f49e4d44ae8aca85cb04cfe91e4ce4">_ArrayIndexnD_</a></div><div class="ttdeci">#define _ArrayIndexnD_(N, index, imax, i, ghost)</div><div class="ttdef"><b>Definition:</b> <a href="a00136_source.html#l00020">arrayfunctions.h:20</a></div></div>
<div class="ttc" id="a00115_html_a29c46b81ad574e4dfbad5a7211487dcb"><div class="ttname"><a href="a00115.html#a29c46b81ad574e4dfbad5a7211487dcb">HyPar::interp</a></div><div class="ttdeci">void * interp</div><div class="ttdef"><b>Definition:</b> <a href="a00143_source.html#l00326">hypar.h:326</a></div></div>
<div class="ttc" id="a00136_html_abc65e9c6a51b875f46fdb054a0ecf604"><div class="ttname"><a href="a00136.html#abc65e9c6a51b875f46fdb054a0ecf604">_ArrayProduct1D_</a></div><div class="ttdeci">#define _ArrayProduct1D_(x, size, p)</div><div class="ttdef"><b>Definition:</b> <a href="a00136_source.html#l00376">arrayfunctions.h:376</a></div></div>
<div class="ttc" id="a00131_html_a83b53dedf034d67bf2dde46eebf492ee"><div class="ttname"><a href="a00131.html#a83b53dedf034d67bf2dde46eebf492ee">tridiagLU</a></div><div class="ttdeci">int tridiagLU(double *, double *, double *, double *, int, int, void *, void *)</div><div class="ttdef"><b>Definition:</b> <a href="a00495_source.html#l00083">tridiagLU.c:83</a></div></div>
<div class="ttc" id="a00105_html_ac900805a486cbb8489e3c176ed6e0d8e"><div class="ttname"><a href="a00105.html#ac900805a486cbb8489e3c176ed6e0d8e">CompactScheme::A</a></div><div class="ttdeci">double * A</div><div class="ttdef"><b>Definition:</b> <a href="a00105_source.html#l00439">interpolation.h:439</a></div></div>
<div class="ttc" id="a00136_html_afbb862a2fdf5b72b1f9ace42f64b556f"><div class="ttname"><a href="a00136.html#afbb862a2fdf5b72b1f9ace42f64b556f">_ArrayIndex1D_</a></div><div class="ttdeci">#define _ArrayIndex1D_(N, imax, i, ghost, index)</div><div class="ttdef"><b>Definition:</b> <a href="a00136_source.html#l00039">arrayfunctions.h:39</a></div></div>
<div class="ttc" id="a00136_html_a7f8e5a8a430e71fd48b436003049d07b"><div class="ttname"><a href="a00136.html#a7f8e5a8a430e71fd48b436003049d07b">_ArrayAXBYCZ_</a></div><div class="ttdeci">#define _ArrayAXBYCZ_(w, a, x, b, y, c, z, size)</div><div class="ttdef"><b>Definition:</b> <a href="a00136_source.html#l00294">arrayfunctions.h:294</a></div></div>
<div class="ttc" id="a00117_html_a45a2dae130e8ef21ae3aa9c7a9e7a138"><div class="ttname"><a href="a00117.html#a45a2dae130e8ef21ae3aa9c7a9e7a138">MPIVariables::comm</a></div><div class="ttdeci">MPI_Comm * comm</div><div class="ttdef"><b>Definition:</b> <a href="a00117_source.html#l00038">mpivars_struct.h:38</a></div></div>
<div class="ttc" id="a00137_html_a68f50121fb9a7daeaf60e50cdef82ef3"><div class="ttname"><a href="a00137.html#a68f50121fb9a7daeaf60e50cdef82ef3">_DECLARE_IERR_</a></div><div class="ttdeci">#define _DECLARE_IERR_</div><div class="ttdef"><b>Definition:</b> <a href="a00137_source.html#l00013">basic.h:13</a></div></div>
<div class="ttc" id="a00115_html_a39dc7def53a36bdc722aa90f52e04561"><div class="ttname"><a href="a00115.html#a39dc7def53a36bdc722aa90f52e04561">HyPar::stride_with_ghosts</a></div><div class="ttdeci">int * stride_with_ghosts</div><div class="ttdef"><b>Definition:</b> <a href="a00143_source.html#l00370">hypar.h:370</a></div></div>
<div class="ttc" id="a00136_html_ae2829ea36a04607caf64d3a462339af9"><div class="ttname"><a href="a00136.html#ae2829ea36a04607caf64d3a462339af9">_ArrayAXBY_</a></div><div class="ttdeci">#define _ArrayAXBY_(z, a, x, b, y, size)</div><div class="ttdef"><b>Definition:</b> <a href="a00136_source.html#l00282">arrayfunctions.h:282</a></div></div>
<div class="ttc" id="a00105_html_ad36954709307649365515214a02ab06d"><div class="ttname"><a href="a00105.html#ad36954709307649365515214a02ab06d">CompactScheme::B</a></div><div class="ttdeci">double * B</div><div class="ttdef"><b>Definition:</b> <a href="a00105_source.html#l00439">interpolation.h:439</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ad9c611137cfce1c622c2e9838fb523c8"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int Interp1PrimFifthOrderHCWENO </td>
          <td>(</td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>fI</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>fC</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>u</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>upw</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>dir</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>s</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>m</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>uflag</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>5th order hybrid compact-WENO reconstruction (component-wise) on a uniform grid </p>
<p>Component-wise interpolation of the first primitive at the cell interfaces using the fifth-order hybrid-compact WENO scheme</p>
<p>Computes the interpolated values of the first primitive of a function \({\bf f}\left({\bf u}\right)\) at the interfaces from the cell-centered values of the function using the fifth order hybrid compact-WENO scheme on a uniform grid. The tridiagonal system is solved using <a class="el" href="a00131.html#a83b53dedf034d67bf2dde46eebf492ee">tridiagLU()</a> (see also <a class="el" href="a00131.html#a00521">TridiagLU</a>, <a class="el" href="a00131.html" title="Header file for TridiagLU. ">tridiagLU.h</a>). See references below for a complete description of the method implemented here.</p>
<p><b>Implementation</b> <b>Notes:</b> </p>
<ul>
<li>This method assumes a uniform grid in the spatial dimension corresponding to the interpolation.</li>
<li>The scalar interpolation method is applied to the vector function in a component-wise manner.</li>
<li>The WENO weights are computed in <a class="el" href="a00243.html#a91383df8b8b5f32861e2ecb18dab8ab7">WENOFifthOrderCalculateWeights()</a>.</li>
<li>The function computes the interpolant for the entire grid in one call. It loops over all the grid lines along the interpolation direction and carries out the 1D interpolation along these grid lines.</li>
<li>Location of cell-centers and cell interfaces along the spatial dimension of the interpolation is shown in the following figure: <div class="image">
<img src="chap1_1Ddomain.png" alt="chap1_1Ddomain.png"/>
</div>
 </li>
</ul>
<p><b>Function</b> <b>arguments:</b> </p>
<table class="doxtable">
<tr>
<th>Argument </th><th>Type </th><th>Explanation  </th></tr>
<tr>
<td>fI </td><td>double* </td><td>Array to hold the computed interpolant at the grid interfaces. This array must have the same layout as the solution, but with <b>no</b> <b>ghost</b> <b>points</b>. Its size should be the same as u in all dimensions, except dir (the dimension along which to interpolate) along which it should be larger by 1 (number of interfaces is 1 more than the number of interior cell centers). </td></tr>
<tr>
<td>fC </td><td>double* </td><td>Array with the cell-centered values of the flux function \({\bf f}\left({\bf u}\right)\). This array must have the same layout and size as the solution, <b>with</b> <b>ghost</b> <b>points</b>. </td></tr>
<tr>
<td>u </td><td>double* </td><td>The solution array \({\bf u}\) (with ghost points). If the interpolation is characteristic based, this is needed to compute the eigendecomposition. For a multidimensional problem, the layout is as follows: u is a contiguous 1D array of size (nvars*dim[0]*dim[1]*...*dim[D-1]) corresponding to the multi-dimensional solution, with the following ordering - nvars, dim[0], dim[1], ..., dim[D-1], where nvars is the number of solution components (<a class="el" href="a00115.html#ae8f6d2fd6490d3153cb4133bf183a404">HyPar::nvars</a>), dim is the local size (<a class="el" href="a00115.html#a38e0371f331cecbe63a77fa03e202afe">HyPar::dim_local</a>), D is the number of spatial dimensions. </td></tr>
<tr>
<td>x </td><td>double* </td><td>The grid array (with ghost points). This is used only by non-uniform-grid interpolation methods. For multidimensional problems, the layout is as follows: x is a contiguous 1D array of size (dim[0]+dim[1]+...+dim[D-1]), with the spatial coordinates along dim[0] stored from 0,...,dim[0]-1, the spatial coordinates along dim[1] stored along dim[0],...,dim[0]+dim[1]-1, and so forth. </td></tr>
<tr>
<td>upw </td><td>int </td><td>Upwinding direction: if positive, a left-biased interpolant will be computed; if negative, a right-biased interpolant will be computed. If the interpolation method is central, then this has no effect. </td></tr>
<tr>
<td>dir </td><td>int </td><td>Spatial dimension along which to interpolate (eg: 0 for 1D; 0 or 1 for 2D; 0,1 or 2 for 3D) </td></tr>
<tr>
<td>s </td><td>void* </td><td>Solver object of type <a class="el" href="a00115.html" title="Structure containing all solver-specific variables and functions. ">HyPar</a>: the following variables are needed - <a class="el" href="a00115.html#aafc992b5fa79d5a4036024615d03bce6">HyPar::ghosts</a>, <a class="el" href="a00115.html#a484873c74138512e41bc50d17b7d955a">HyPar::ndims</a>, <a class="el" href="a00115.html#ae8f6d2fd6490d3153cb4133bf183a404">HyPar::nvars</a>, <a class="el" href="a00115.html#a38e0371f331cecbe63a77fa03e202afe">HyPar::dim_local</a>. </td></tr>
<tr>
<td>m </td><td>void* </td><td>MPI object of type <a class="el" href="a00117.html#a00516" title="Structure of MPI-related variables. ">MPIVariables</a>: this is needed only by compact interpolation method that need to solve a global implicit system across MPI ranks. </td></tr>
<tr>
<td>uflag </td><td>int </td><td>A flag indicating if the function being interpolated \({\bf f}\) is the solution itself \({\bf u}\) (if 1, \({\bf f}\left({\bf u}\right) \equiv {\bf u}\)). </td></tr>
</table>
<p><b>Reference:</b> </p>
<ul>
<li>Pirozzoli, S., Conservative Hybrid Compact-WENO Schemes for Shock-Turbulence Interaction, J. Comput. Phys., 178 (1), 2002, pp. 81-117, <a href="http://dx.doi.org/10.1006/jcph.2002.7021">http://dx.doi.org/10.1006/jcph.2002.7021</a></li>
<li>Ren, Y.-X., Liu, M., Zhang, H., A characteristic-wise hybrid compact-WENO scheme for solving hyperbolic conservation laws, J. Comput. Phys., 192 (2), 2003, pp. 365-386, <a href="http://dx.doi.org/10.1016/j.jcp.2003.07.006">http://dx.doi.org/10.1016/j.jcp.2003.07.006</a> </li>
</ul>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">fI</td><td>Array of interpolated function values at the interfaces </td></tr>
    <tr><td class="paramname">fC</td><td>Array of cell-centered values of the function \({\bf f}\left({\bf u}\right)\) </td></tr>
    <tr><td class="paramname">u</td><td>Array of cell-centered values of the solution \({\bf u}\) </td></tr>
    <tr><td class="paramname">x</td><td>Grid coordinates </td></tr>
    <tr><td class="paramname">upw</td><td>Upwind direction (left or right biased) </td></tr>
    <tr><td class="paramname">dir</td><td>Spatial dimension along which to interpolation </td></tr>
    <tr><td class="paramname">s</td><td>Object of type <a class="el" href="a00115.html" title="Structure containing all solver-specific variables and functions. ">HyPar</a> containing solver-related variables </td></tr>
    <tr><td class="paramname">m</td><td>Object of type <a class="el" href="a00117.html#a00516" title="Structure of MPI-related variables. ">MPIVariables</a> containing MPI-related variables </td></tr>
    <tr><td class="paramname">uflag</td><td>Flag to indicate if \(f(u) \equiv u\), i.e, if the solution is being reconstructed </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="a00226_source.html#l00063">63</a> of file <a class="el" href="a00226_source.html">Interp1PrimFifthOrderHCWENO.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;{</div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;  <a class="code" href="a00115.html">HyPar</a>           *solver = (<a class="code" href="a00115.html">HyPar</a>*)          s;</div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;  <a class="code" href="a00117.html#a00516">MPIVariables</a>    *mpi    = (<a class="code" href="a00117.html#a00516">MPIVariables</a>*)   m;</div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;  <a class="code" href="a00105.html#a00503">CompactScheme</a>   *compact= (<a class="code" href="a00105.html#a00503">CompactScheme</a>*)  solver-&gt;<a class="code" href="a00115.html#a56318721d534e74a96b440f8542a0232">compact</a>;</div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;  <a class="code" href="a00105.html#a00523">WENOParameters</a>  *weno   = (<a class="code" href="a00105.html#a00523">WENOParameters</a>*) solver-&gt;<a class="code" href="a00115.html#a29c46b81ad574e4dfbad5a7211487dcb">interp</a>;</div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;  <a class="code" href="a00131.html#a00521">TridiagLU</a>       *lu     = (<a class="code" href="a00131.html#a00521">TridiagLU</a>*)      solver-&gt;<a class="code" href="a00115.html#a1dbfa1e479a373073b6ebf72401a7f0f">lusolver</a>;</div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;  <span class="keywordtype">int</span>             sys,Nsys,d;</div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;  <a class="code" href="a00137.html#a68f50121fb9a7daeaf60e50cdef82ef3">_DECLARE_IERR_</a>;</div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;</div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;  <span class="keywordtype">int</span> ghosts = solver-&gt;<a class="code" href="a00115.html#aafc992b5fa79d5a4036024615d03bce6">ghosts</a>;</div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;  <span class="keywordtype">int</span> ndims  = solver-&gt;<a class="code" href="a00115.html#a484873c74138512e41bc50d17b7d955a">ndims</a>;</div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;  <span class="keywordtype">int</span> nvars  = solver-&gt;<a class="code" href="a00115.html#ae8f6d2fd6490d3153cb4133bf183a404">nvars</a>;</div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;  <span class="keywordtype">int</span> *dim   = solver-&gt;<a class="code" href="a00115.html#a38e0371f331cecbe63a77fa03e202afe">dim_local</a>;</div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;</div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;  <span class="comment">/* define some constants */</span></div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;  <span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">double</span> one_half           = 1.0/2.0;</div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;  <span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">double</span> one_third          = 1.0/3.0;</div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;  <span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">double</span> one_sixth          = 1.0/6.0;</div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;</div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;  <span class="keywordtype">double</span> *ww1, *ww2, *ww3;</div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;  ww1 = weno-&gt;w1 + (upw &lt; 0 ? 2*weno-&gt;size : 0) + (uflag ? weno-&gt;size : 0) + weno-&gt;offset[dir];</div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;  ww2 = weno-&gt;w2 + (upw &lt; 0 ? 2*weno-&gt;size : 0) + (uflag ? weno-&gt;size : 0) + weno-&gt;offset[dir];</div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;  ww3 = weno-&gt;w3 + (upw &lt; 0 ? 2*weno-&gt;size : 0) + (uflag ? weno-&gt;size : 0) + weno-&gt;offset[dir];</div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;</div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;  <span class="comment">/* create index and bounds for the outer loop, i.e., to loop over all 1D lines along</span></div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;<span class="comment">     dimension &quot;dir&quot;                                                                    */</span></div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;  <span class="keywordtype">int</span> indexC[ndims], indexI[ndims], index_outer[ndims], bounds_outer[ndims], bounds_inter[ndims];</div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;  <a class="code" href="a00136.html#a89e8330d9e06dd0666c50833628a125c">_ArrayCopy1D_</a>(dim,bounds_outer,ndims); bounds_outer[dir] =  1;</div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;  <a class="code" href="a00136.html#a89e8330d9e06dd0666c50833628a125c">_ArrayCopy1D_</a>(dim,bounds_inter,ndims); bounds_inter[dir] += 1;</div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;  <span class="keywordtype">int</span> N_outer; <a class="code" href="a00136.html#abc65e9c6a51b875f46fdb054a0ecf604">_ArrayProduct1D_</a>(bounds_outer,ndims,N_outer);</div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;</div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;  <span class="comment">/* calculate total number of tridiagonal systems to solve */</span></div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;  <a class="code" href="a00136.html#abc65e9c6a51b875f46fdb054a0ecf604">_ArrayProduct1D_</a>(bounds_outer,ndims,Nsys); Nsys *= nvars;</div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;</div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;  <span class="comment">/* Allocate arrays for tridiagonal system */</span></div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;  <span class="keywordtype">double</span> *A = compact-&gt;<a class="code" href="a00105.html#ac900805a486cbb8489e3c176ed6e0d8e">A</a>;</div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;  <span class="keywordtype">double</span> *B = compact-&gt;<a class="code" href="a00105.html#ad36954709307649365515214a02ab06d">B</a>;</div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;  <span class="keywordtype">double</span> *C = compact-&gt;<a class="code" href="a00105.html#a0a26ce8d1878aac6ddc87e3f6290e039">C</a>;</div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;  <span class="keywordtype">double</span> *R = compact-&gt;<a class="code" href="a00105.html#ac06de847603f5cfaec085f6fe500f3c8">R</a>;</div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;</div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;<span class="preprocessor">#pragma omp parallel for schedule(auto) default(shared) private(sys,d,index_outer,indexC,indexI)</span></div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;<span class="preprocessor"></span>  <span class="keywordflow">for</span> (sys=0; sys &lt; N_outer; sys++) {</div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;    <a class="code" href="a00136.html#a03f49e4d44ae8aca85cb04cfe91e4ce4">_ArrayIndexnD_</a>(ndims,sys,bounds_outer,index_outer,0);</div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;    <a class="code" href="a00136.html#a89e8330d9e06dd0666c50833628a125c">_ArrayCopy1D_</a>(index_outer,indexC,ndims);</div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;    <a class="code" href="a00136.html#a89e8330d9e06dd0666c50833628a125c">_ArrayCopy1D_</a>(index_outer,indexI,ndims);</div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;    <span class="keywordflow">for</span> (indexI[dir] = 0; indexI[dir] &lt; dim[dir]+1; indexI[dir]++) {</div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;      <span class="keywordtype">int</span> qm1,qm2,qm3,qp1,qp2,p;</div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;      <a class="code" href="a00136.html#afbb862a2fdf5b72b1f9ace42f64b556f">_ArrayIndex1D_</a>(ndims,bounds_inter,indexI,0,p);</div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;      <span class="keywordflow">if</span> (upw &gt; 0) {</div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;        indexC[dir] = indexI[dir]-3; <a class="code" href="a00136.html#afbb862a2fdf5b72b1f9ace42f64b556f">_ArrayIndex1D_</a>(ndims,dim,indexC,ghosts,qm3);</div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;        indexC[dir] = indexI[dir]-2; <a class="code" href="a00136.html#afbb862a2fdf5b72b1f9ace42f64b556f">_ArrayIndex1D_</a>(ndims,dim,indexC,ghosts,qm2);</div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;        indexC[dir] = indexI[dir]-1; <a class="code" href="a00136.html#afbb862a2fdf5b72b1f9ace42f64b556f">_ArrayIndex1D_</a>(ndims,dim,indexC,ghosts,qm1);</div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;        indexC[dir] = indexI[dir]  ; <a class="code" href="a00136.html#afbb862a2fdf5b72b1f9ace42f64b556f">_ArrayIndex1D_</a>(ndims,dim,indexC,ghosts,qp1);</div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;        indexC[dir] = indexI[dir]+1; <a class="code" href="a00136.html#afbb862a2fdf5b72b1f9ace42f64b556f">_ArrayIndex1D_</a>(ndims,dim,indexC,ghosts,qp2);</div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;      } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;        indexC[dir] = indexI[dir]+2; <a class="code" href="a00136.html#afbb862a2fdf5b72b1f9ace42f64b556f">_ArrayIndex1D_</a>(ndims,dim,indexC,ghosts,qm3);</div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;        indexC[dir] = indexI[dir]+1; <a class="code" href="a00136.html#afbb862a2fdf5b72b1f9ace42f64b556f">_ArrayIndex1D_</a>(ndims,dim,indexC,ghosts,qm2);</div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;        indexC[dir] = indexI[dir]  ; <a class="code" href="a00136.html#afbb862a2fdf5b72b1f9ace42f64b556f">_ArrayIndex1D_</a>(ndims,dim,indexC,ghosts,qm1);</div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;        indexC[dir] = indexI[dir]-1; <a class="code" href="a00136.html#afbb862a2fdf5b72b1f9ace42f64b556f">_ArrayIndex1D_</a>(ndims,dim,indexC,ghosts,qp1);</div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;        indexC[dir] = indexI[dir]-2; <a class="code" href="a00136.html#afbb862a2fdf5b72b1f9ace42f64b556f">_ArrayIndex1D_</a>(ndims,dim,indexC,ghosts,qp2);</div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;      }</div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;      <span class="keywordtype">int</span> v; </div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;      <span class="keywordflow">for</span> (v=0; v&lt;nvars; v++)  {</div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;        <span class="comment">/* Defining stencil points */</span></div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;        <span class="keywordtype">double</span> fm3, fm2, fm1, fp1, fp2;</div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;        fm3 = fC[qm3*nvars+v];</div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;        fm2 = fC[qm2*nvars+v];</div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;        fm1 = fC[qm1*nvars+v];</div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;        fp1 = fC[qp1*nvars+v];</div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;        fp2 = fC[qp2*nvars+v];</div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;</div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;        <span class="comment">/* Candidate stencils and their optimal weights*/</span></div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;        <span class="keywordtype">double</span> f1, f2, f3;</div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;        f1 = (2*one_sixth)*fm3 - (7.0*one_sixth)*fm2 + (11.0*one_sixth)*fm1;</div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;        f2 = (-one_sixth)*fm2 + (5.0*one_sixth)*fm1 + (2*one_sixth)*fp1;</div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;        f3 = (2*one_sixth)*fm1 + (5*one_sixth)*fp1 - (one_sixth)*fp2;</div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;</div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;        <span class="comment">/* calculate WENO weights */</span></div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;        <span class="keywordtype">double</span> w1,w2,w3;</div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;        w1 = *(ww1+p*nvars+v);</div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;        w2 = *(ww2+p*nvars+v);</div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;        w3 = *(ww3+p*nvars+v);</div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;</div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;        <span class="comment">/* calculate the hybridization parameter */</span></div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;        <span class="keywordtype">double</span> sigma;</div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;        <span class="keywordflow">if</span> (   ((mpi-&gt;<a class="code" href="a00117.html#aa3c28612a64b8a97bde66b720e15c700">ip</a>[dir] == 0                ) &amp;&amp; (indexI[dir] == 0       ))</div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;            || ((mpi-&gt;<a class="code" href="a00117.html#aa3c28612a64b8a97bde66b720e15c700">ip</a>[dir] == mpi-&gt;<a class="code" href="a00117.html#a0be0f30a83bc3f3d9f6ee3a36bbf2716">iproc</a>[dir]-1) &amp;&amp; (indexI[dir] == dim[dir])) ) {</div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;          <span class="comment">/* Standard WENO at physical boundaries */</span></div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;          sigma = 0.0;</div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;          <span class="keywordtype">double</span> cuckoo, df_jm12, df_jp12, df_jp32, r_j, r_jp1, r_int;</div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;          cuckoo = (0.9*weno-&gt;rc / (1.0-0.9*weno-&gt;rc)) * weno-&gt;xi * weno-&gt;xi;</div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;          df_jm12 = fm1 - fm2;</div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;          df_jp12 = fp1 - fm1;</div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;          df_jp32 = fp2 - fp1;</div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;          r_j   = (<a class="code" href="a00147.html#adf1be5ccbb7a2522b4f3a64043c72880">absolute</a>(2*df_jp12*df_jm12)+cuckoo)/(df_jp12*df_jp12+df_jm12*df_jm12+cuckoo);</div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;          r_jp1 = (<a class="code" href="a00147.html#adf1be5ccbb7a2522b4f3a64043c72880">absolute</a>(2*df_jp32*df_jp12)+cuckoo)/(df_jp32*df_jp32+df_jp12*df_jp12+cuckoo);</div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;          r_int = <a class="code" href="a00147.html#ac6afabdc09a49a433ee19d8a9486056d">min</a>(r_j, r_jp1);</div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;          sigma = <a class="code" href="a00147.html#ac6afabdc09a49a433ee19d8a9486056d">min</a>((r_int/weno-&gt;rc), 1.0); </div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;        }</div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;</div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;        <span class="keywordflow">if</span> (upw &gt; 0) {</div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;          A[sys*nvars+v+Nsys*indexI[dir]] = one_half  * sigma;</div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;          B[sys*nvars+v+Nsys*indexI[dir]] = 1.0;</div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;          C[sys*nvars+v+Nsys*indexI[dir]] = one_sixth * sigma;</div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;          C[sys*nvars+v+Nsys*indexI[dir]] = one_half  * sigma;</div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;          B[sys*nvars+v+Nsys*indexI[dir]] = 1.0;</div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;          A[sys*nvars+v+Nsys*indexI[dir]] = one_sixth * sigma;</div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;        }</div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;</div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;        <span class="keywordtype">double</span> fWENO, fCompact;</div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;        fWENO    = w1*f1 + w2*f2 + w3*f3;</div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;        fCompact = one_sixth * (one_third*fm2 + 19.0*one_third*fm1 + 10.0*one_third*fp1);</div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;        R[sys*nvars+v+Nsys*indexI[dir]] =   sigma*fCompact + (1.0-sigma)*fWENO;</div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;      }</div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;    }</div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;  }</div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;</div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;<span class="preprocessor">#ifdef serial</span></div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;<span class="preprocessor"></span></div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;  <span class="comment">/* Solve the tridiagonal system */</span></div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;  <a class="code" href="a00137.html#ad6ab74942c9de13cf0b4c12eb0d91780">IERR</a> <a class="code" href="a00131.html#a83b53dedf034d67bf2dde46eebf492ee">tridiagLU</a>(A,B,C,R,dim[dir]+1,Nsys,lu,NULL); <a class="code" href="a00137.html#add9cf96ae374934d245a1dc1ab697a42">CHECKERR</a>(ierr);</div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;</div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;<span class="preprocessor">#else</span></div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;<span class="preprocessor"></span></div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;  <span class="comment">/* Solve the tridiagonal system */</span></div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;  <span class="comment">/* all processes except the last will solve without the last interface to avoid overlap */</span></div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;  <span class="keywordflow">if</span> (mpi-&gt;<a class="code" href="a00117.html#aa3c28612a64b8a97bde66b720e15c700">ip</a>[dir] != mpi-&gt;<a class="code" href="a00117.html#a0be0f30a83bc3f3d9f6ee3a36bbf2716">iproc</a>[dir]-1)  { <a class="code" href="a00137.html#ad6ab74942c9de13cf0b4c12eb0d91780">IERR</a> <a class="code" href="a00131.html#a83b53dedf034d67bf2dde46eebf492ee">tridiagLU</a>(A,B,C,R,dim[dir]  ,Nsys,lu,&amp;mpi-&gt;<a class="code" href="a00117.html#a45a2dae130e8ef21ae3aa9c7a9e7a138">comm</a>[dir]); <a class="code" href="a00137.html#add9cf96ae374934d245a1dc1ab697a42">CHECKERR</a>(ierr); }</div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;  <span class="keywordflow">else</span>                                    { <a class="code" href="a00137.html#ad6ab74942c9de13cf0b4c12eb0d91780">IERR</a> <a class="code" href="a00131.html#a83b53dedf034d67bf2dde46eebf492ee">tridiagLU</a>(A,B,C,R,dim[dir]+1,Nsys,lu,&amp;mpi-&gt;<a class="code" href="a00117.html#a45a2dae130e8ef21ae3aa9c7a9e7a138">comm</a>[dir]); <a class="code" href="a00137.html#add9cf96ae374934d245a1dc1ab697a42">CHECKERR</a>(ierr); }</div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;</div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;  <span class="comment">/* Now get the solution to the last interface from the next proc */</span></div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;  <span class="keywordtype">double</span> *sendbuf = compact-&gt;<a class="code" href="a00105.html#aba3b15034da676474db917f9f5533085">sendbuf</a>;</div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;  <span class="keywordtype">double</span> *recvbuf = compact-&gt;<a class="code" href="a00105.html#afc23e46e08649e112e8d64d780cea5cb">recvbuf</a>;</div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;  MPI_Request req[2] = {MPI_REQUEST_NULL,MPI_REQUEST_NULL};</div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;  <span class="keywordflow">if</span> (mpi-&gt;<a class="code" href="a00117.html#aa3c28612a64b8a97bde66b720e15c700">ip</a>[dir]) <span class="keywordflow">for</span> (d=0; d&lt;Nsys; d++) sendbuf[d] = R[d];</div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;  <span class="keywordflow">if</span> (mpi-&gt;<a class="code" href="a00117.html#aa3c28612a64b8a97bde66b720e15c700">ip</a>[dir] != mpi-&gt;<a class="code" href="a00117.html#a0be0f30a83bc3f3d9f6ee3a36bbf2716">iproc</a>[dir]-1) MPI_Irecv(recvbuf,Nsys,MPI_DOUBLE,mpi-&gt;<a class="code" href="a00117.html#aa3c28612a64b8a97bde66b720e15c700">ip</a>[dir]+1,214,mpi-&gt;<a class="code" href="a00117.html#a45a2dae130e8ef21ae3aa9c7a9e7a138">comm</a>[dir],&amp;req[0]);</div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;  <span class="keywordflow">if</span> (mpi-&gt;<a class="code" href="a00117.html#aa3c28612a64b8a97bde66b720e15c700">ip</a>[dir])                      MPI_Isend(sendbuf,Nsys,MPI_DOUBLE,mpi-&gt;<a class="code" href="a00117.html#aa3c28612a64b8a97bde66b720e15c700">ip</a>[dir]-1,214,mpi-&gt;<a class="code" href="a00117.html#a45a2dae130e8ef21ae3aa9c7a9e7a138">comm</a>[dir],&amp;req[1]);</div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;  MPI_Waitall(2,&amp;req[0],MPI_STATUS_IGNORE);</div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;  <span class="keywordflow">if</span> (mpi-&gt;<a class="code" href="a00117.html#aa3c28612a64b8a97bde66b720e15c700">ip</a>[dir] != mpi-&gt;<a class="code" href="a00117.html#a0be0f30a83bc3f3d9f6ee3a36bbf2716">iproc</a>[dir]-1) <span class="keywordflow">for</span> (d=0; d&lt;Nsys; d++) R[d+Nsys*dim[dir]] = recvbuf[d];</div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;</div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;<span class="preprocessor"></span></div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;  <span class="comment">/* save the solution to fI */</span></div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;<span class="preprocessor">#pragma omp parallel for schedule(auto) default(shared) private(sys,d,index_outer,indexC,indexI)</span></div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;<span class="preprocessor"></span>  <span class="keywordflow">for</span> (sys=0; sys &lt; N_outer; sys++) {</div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;    <a class="code" href="a00136.html#a03f49e4d44ae8aca85cb04cfe91e4ce4">_ArrayIndexnD_</a>(ndims,sys,bounds_outer,index_outer,0);</div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;    <a class="code" href="a00136.html#a89e8330d9e06dd0666c50833628a125c">_ArrayCopy1D_</a>(index_outer,indexI,ndims);</div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;    <span class="keywordflow">for</span> (indexI[dir] = 0; indexI[dir] &lt; dim[dir]+1; indexI[dir]++) {</div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;      <span class="keywordtype">int</span> p; <a class="code" href="a00136.html#afbb862a2fdf5b72b1f9ace42f64b556f">_ArrayIndex1D_</a>(ndims,bounds_inter,indexI,0,p);</div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;      <a class="code" href="a00136.html#a89e8330d9e06dd0666c50833628a125c">_ArrayCopy1D_</a>((R+sys*nvars+Nsys*indexI[dir]),(fI+nvars*p),nvars);</div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;    }</div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;  }</div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;</div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;  <span class="keywordflow">return</span>(0);</div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;}</div>
<div class="ttc" id="a00131_html_a00521"><div class="ttname"><a href="a00131.html#a00521">TridiagLU</a></div><div class="ttdef"><b>Definition:</b> <a href="a00131_source.html#l00084">tridiagLU.h:84</a></div></div>
<div class="ttc" id="a00115_html_a56318721d534e74a96b440f8542a0232"><div class="ttname"><a href="a00115.html#a56318721d534e74a96b440f8542a0232">HyPar::compact</a></div><div class="ttdeci">void * compact</div><div class="ttdef"><b>Definition:</b> <a href="a00143_source.html#l00328">hypar.h:328</a></div></div>
<div class="ttc" id="a00115_html_a484873c74138512e41bc50d17b7d955a"><div class="ttname"><a href="a00115.html#a484873c74138512e41bc50d17b7d955a">HyPar::ndims</a></div><div class="ttdeci">int ndims</div><div class="ttdef"><b>Definition:</b> <a href="a00143_source.html#l00026">hypar.h:26</a></div></div>
<div class="ttc" id="a00115_html_aafc992b5fa79d5a4036024615d03bce6"><div class="ttname"><a href="a00115.html#aafc992b5fa79d5a4036024615d03bce6">HyPar::ghosts</a></div><div class="ttdeci">int ghosts</div><div class="ttdef"><b>Definition:</b> <a href="a00143_source.html#l00044">hypar.h:44</a></div></div>
<div class="ttc" id="a00115_html"><div class="ttname"><a href="a00115.html">HyPar</a></div><div class="ttdoc">Structure containing all solver-specific variables and functions. </div><div class="ttdef"><b>Definition:</b> <a href="a00143_source.html#l00023">hypar.h:23</a></div></div>
<div class="ttc" id="a00105_html_ac06de847603f5cfaec085f6fe500f3c8"><div class="ttname"><a href="a00105.html#ac06de847603f5cfaec085f6fe500f3c8">CompactScheme::R</a></div><div class="ttdeci">double * R</div><div class="ttdef"><b>Definition:</b> <a href="a00105_source.html#l00439">interpolation.h:439</a></div></div>
<div class="ttc" id="a00105_html_a00503"><div class="ttname"><a href="a00105.html#a00503">CompactScheme</a></div><div class="ttdoc">Structure of variables/parameters needed by the compact schemes. </div><div class="ttdef"><b>Definition:</b> <a href="a00105_source.html#l00437">interpolation.h:437</a></div></div>
<div class="ttc" id="a00137_html_ad6ab74942c9de13cf0b4c12eb0d91780"><div class="ttname"><a href="a00137.html#ad6ab74942c9de13cf0b4c12eb0d91780">IERR</a></div><div class="ttdeci">#define IERR</div><div class="ttdef"><b>Definition:</b> <a href="a00137_source.html#l00012">basic.h:12</a></div></div>
<div class="ttc" id="a00105_html_a00523"><div class="ttname"><a href="a00105.html#a00523">WENOParameters</a></div><div class="ttdoc">Structure of variables/parameters needed by the WENO-type scheme. </div><div class="ttdef"><b>Definition:</b> <a href="a00105_source.html#l00175">interpolation.h:175</a></div></div>
<div class="ttc" id="a00105_html_aba3b15034da676474db917f9f5533085"><div class="ttname"><a href="a00105.html#aba3b15034da676474db917f9f5533085">CompactScheme::sendbuf</a></div><div class="ttdeci">double * sendbuf</div><div class="ttdef"><b>Definition:</b> <a href="a00105_source.html#l00444">interpolation.h:444</a></div></div>
<div class="ttc" id="a00147_html_ac6afabdc09a49a433ee19d8a9486056d"><div class="ttname"><a href="a00147.html#ac6afabdc09a49a433ee19d8a9486056d">min</a></div><div class="ttdeci">#define min(a, b)</div><div class="ttdef"><b>Definition:</b> <a href="a00147_source.html#l00015">mathfunctions.h:15</a></div></div>
<div class="ttc" id="a00117_html_a0be0f30a83bc3f3d9f6ee3a36bbf2716"><div class="ttname"><a href="a00117.html#a0be0f30a83bc3f3d9f6ee3a36bbf2716">MPIVariables::iproc</a></div><div class="ttdeci">int * iproc</div><div class="ttdef"><b>Definition:</b> <a href="a00117_source.html#l00027">mpivars_struct.h:27</a></div></div>
<div class="ttc" id="a00115_html_ae8f6d2fd6490d3153cb4133bf183a404"><div class="ttname"><a href="a00115.html#ae8f6d2fd6490d3153cb4133bf183a404">HyPar::nvars</a></div><div class="ttdeci">int nvars</div><div class="ttdef"><b>Definition:</b> <a href="a00143_source.html#l00029">hypar.h:29</a></div></div>
<div class="ttc" id="a00105_html_a0a26ce8d1878aac6ddc87e3f6290e039"><div class="ttname"><a href="a00105.html#a0a26ce8d1878aac6ddc87e3f6290e039">CompactScheme::C</a></div><div class="ttdeci">double * C</div><div class="ttdef"><b>Definition:</b> <a href="a00105_source.html#l00439">interpolation.h:439</a></div></div>
<div class="ttc" id="a00136_html_a89e8330d9e06dd0666c50833628a125c"><div class="ttname"><a href="a00136.html#a89e8330d9e06dd0666c50833628a125c">_ArrayCopy1D_</a></div><div class="ttdeci">#define _ArrayCopy1D_(x, y, size)</div><div class="ttdef"><b>Definition:</b> <a href="a00136_source.html#l00318">arrayfunctions.h:318</a></div></div>
<div class="ttc" id="a00105_html_afc23e46e08649e112e8d64d780cea5cb"><div class="ttname"><a href="a00105.html#afc23e46e08649e112e8d64d780cea5cb">CompactScheme::recvbuf</a></div><div class="ttdeci">double * recvbuf</div><div class="ttdef"><b>Definition:</b> <a href="a00105_source.html#l00444">interpolation.h:444</a></div></div>
<div class="ttc" id="a00115_html_a38e0371f331cecbe63a77fa03e202afe"><div class="ttname"><a href="a00115.html#a38e0371f331cecbe63a77fa03e202afe">HyPar::dim_local</a></div><div class="ttdeci">int * dim_local</div><div class="ttdef"><b>Definition:</b> <a href="a00143_source.html#l00035">hypar.h:35</a></div></div>
<div class="ttc" id="a00117_html_aa3c28612a64b8a97bde66b720e15c700"><div class="ttname"><a href="a00117.html#aa3c28612a64b8a97bde66b720e15c700">MPIVariables::ip</a></div><div class="ttdeci">int * ip</div><div class="ttdef"><b>Definition:</b> <a href="a00117_source.html#l00028">mpivars_struct.h:28</a></div></div>
<div class="ttc" id="a00117_html_a00516"><div class="ttname"><a href="a00117.html#a00516">MPIVariables</a></div><div class="ttdoc">Structure of MPI-related variables. </div><div class="ttdef"><b>Definition:</b> <a href="a00117_source.html#l00024">mpivars_struct.h:24</a></div></div>
<div class="ttc" id="a00137_html_add9cf96ae374934d245a1dc1ab697a42"><div class="ttname"><a href="a00137.html#add9cf96ae374934d245a1dc1ab697a42">CHECKERR</a></div><div class="ttdeci">#define CHECKERR(ierr)</div><div class="ttdef"><b>Definition:</b> <a href="a00137_source.html#l00014">basic.h:14</a></div></div>
<div class="ttc" id="a00115_html_a1dbfa1e479a373073b6ebf72401a7f0f"><div class="ttname"><a href="a00115.html#a1dbfa1e479a373073b6ebf72401a7f0f">HyPar::lusolver</a></div><div class="ttdeci">void * lusolver</div><div class="ttdef"><b>Definition:</b> <a href="a00143_source.html#l00332">hypar.h:332</a></div></div>
<div class="ttc" id="a00136_html_a03f49e4d44ae8aca85cb04cfe91e4ce4"><div class="ttname"><a href="a00136.html#a03f49e4d44ae8aca85cb04cfe91e4ce4">_ArrayIndexnD_</a></div><div class="ttdeci">#define _ArrayIndexnD_(N, index, imax, i, ghost)</div><div class="ttdef"><b>Definition:</b> <a href="a00136_source.html#l00020">arrayfunctions.h:20</a></div></div>
<div class="ttc" id="a00115_html_a29c46b81ad574e4dfbad5a7211487dcb"><div class="ttname"><a href="a00115.html#a29c46b81ad574e4dfbad5a7211487dcb">HyPar::interp</a></div><div class="ttdeci">void * interp</div><div class="ttdef"><b>Definition:</b> <a href="a00143_source.html#l00326">hypar.h:326</a></div></div>
<div class="ttc" id="a00136_html_abc65e9c6a51b875f46fdb054a0ecf604"><div class="ttname"><a href="a00136.html#abc65e9c6a51b875f46fdb054a0ecf604">_ArrayProduct1D_</a></div><div class="ttdeci">#define _ArrayProduct1D_(x, size, p)</div><div class="ttdef"><b>Definition:</b> <a href="a00136_source.html#l00376">arrayfunctions.h:376</a></div></div>
<div class="ttc" id="a00131_html_a83b53dedf034d67bf2dde46eebf492ee"><div class="ttname"><a href="a00131.html#a83b53dedf034d67bf2dde46eebf492ee">tridiagLU</a></div><div class="ttdeci">int tridiagLU(double *, double *, double *, double *, int, int, void *, void *)</div><div class="ttdef"><b>Definition:</b> <a href="a00495_source.html#l00083">tridiagLU.c:83</a></div></div>
<div class="ttc" id="a00105_html_ac900805a486cbb8489e3c176ed6e0d8e"><div class="ttname"><a href="a00105.html#ac900805a486cbb8489e3c176ed6e0d8e">CompactScheme::A</a></div><div class="ttdeci">double * A</div><div class="ttdef"><b>Definition:</b> <a href="a00105_source.html#l00439">interpolation.h:439</a></div></div>
<div class="ttc" id="a00136_html_afbb862a2fdf5b72b1f9ace42f64b556f"><div class="ttname"><a href="a00136.html#afbb862a2fdf5b72b1f9ace42f64b556f">_ArrayIndex1D_</a></div><div class="ttdeci">#define _ArrayIndex1D_(N, imax, i, ghost, index)</div><div class="ttdef"><b>Definition:</b> <a href="a00136_source.html#l00039">arrayfunctions.h:39</a></div></div>
<div class="ttc" id="a00117_html_a45a2dae130e8ef21ae3aa9c7a9e7a138"><div class="ttname"><a href="a00117.html#a45a2dae130e8ef21ae3aa9c7a9e7a138">MPIVariables::comm</a></div><div class="ttdeci">MPI_Comm * comm</div><div class="ttdef"><b>Definition:</b> <a href="a00117_source.html#l00038">mpivars_struct.h:38</a></div></div>
<div class="ttc" id="a00137_html_a68f50121fb9a7daeaf60e50cdef82ef3"><div class="ttname"><a href="a00137.html#a68f50121fb9a7daeaf60e50cdef82ef3">_DECLARE_IERR_</a></div><div class="ttdeci">#define _DECLARE_IERR_</div><div class="ttdef"><b>Definition:</b> <a href="a00137_source.html#l00013">basic.h:13</a></div></div>
<div class="ttc" id="a00147_html_adf1be5ccbb7a2522b4f3a64043c72880"><div class="ttname"><a href="a00147.html#adf1be5ccbb7a2522b4f3a64043c72880">absolute</a></div><div class="ttdeci">#define absolute(a)</div><div class="ttdef"><b>Definition:</b> <a href="a00147_source.html#l00033">mathfunctions.h:33</a></div></div>
<div class="ttc" id="a00105_html_ad36954709307649365515214a02ab06d"><div class="ttname"><a href="a00105.html#ad36954709307649365515214a02ab06d">CompactScheme::B</a></div><div class="ttdeci">double * B</div><div class="ttdef"><b>Definition:</b> <a href="a00105_source.html#l00439">interpolation.h:439</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a759e07ba8a484c2c6971fc7c6a81a95a"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int Interp1PrimFirstOrderUpwindChar </td>
          <td>(</td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>fI</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>fC</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>u</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>upw</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>dir</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>s</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>m</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>uflag</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>1st order upwind reconstruction (characteristic-based) on a uniform grid </p>
<p>Characteristic-based interpolation of the first primitive at the cell interfaces using the first-order upwind scheme</p>
<p>Computes the interpolated values of the first primitive of a function \({\bf f}\left({\bf u}\right)\) at the interfaces from the cell-centered values of the function using the 1st order upwind scheme on a uniform grid. The first primitive is defined as a function \({\bf h}\left({\bf u}\right)\) that satisfies: </p>
<p class="formulaDsp">
\begin{equation} {\bf f}\left({\bf u}\left(x\right)\right) = \frac{1}{\Delta x} \int_{x-\Delta x/2}^{x+\Delta x/2} {\bf h}\left({\bf u}\left(\zeta\right)\right)d\zeta, \end{equation}
</p>
<p> where \(x\) is the spatial coordinate along the dimension of the interpolation. This function computes the 1st order upwind numerical approximation \(\hat{\bf f}_{j+1/2} \approx {\bf h}_{j+1/2}\) as: </p>
<p class="formulaDsp">
\begin{equation} \hat{\alpha}^k_{j+1/2} = \left\{\begin{array}{cc} {\alpha}^k_{j} &amp; {\rm upw} &gt; 0 \\ {\alpha}^k_{j+1} &amp; {\rm upw} \le 0 \end{array}\right.. \end{equation}
</p>
<p> where </p>
<p class="formulaDsp">
\begin{equation} \alpha^k = {\bf l}_k \cdot {\bf f},\ k=1,\cdots,n \end{equation}
</p>
<p> is the \(k\)-th characteristic quantity, and \({\bf l}_k\) is the \(k\)-th left eigenvector, \({\bf r}_k\) is the \(k\)-th right eigenvector, and \(n\) is <a class="el" href="a00115.html#ae8f6d2fd6490d3153cb4133bf183a404">HyPar::nvars</a>. The final interpolated function is computed from the interpolated characteristic quantities as: </p>
<p class="formulaDsp">
\begin{equation} \hat{\bf f}_{j+1/2} = \sum_{k=1}^n \alpha^k_{j+1/2} {\bf r}_k \end{equation}
</p>
<p><b>Implementation</b> <b>Notes:</b> </p>
<ul>
<li><p class="startli">The left and right eigenvectors are computed at an averaged quantity at j+1/2. Thus, this function requires functions to compute the average state, and the left and right eigenvectors. These are provided by the physical model through</p>
<ul>
<li><a class="el" href="a00115.html#a8c603c73be1f08e408a1de94a088da7b">HyPar::GetLeftEigenvectors()</a></li>
<li><a class="el" href="a00115.html#a22eef349f191a1aa267e14b08140c823">HyPar::GetRightEigenvectors()</a></li>
<li><a class="el" href="a00115.html#a7331366d789b2995436accbc35e1cc80">HyPar::AveragingFunction()</a></li>
</ul>
<p class="startli">If these functions are not provided by the physical model, then a characteristic-based interpolation cannot be used.</p>
</li>
<li>The function computes the interpolant for the entire grid in one call. It loops over all the grid lines along the interpolation direction and carries out the 1D interpolation along these grid lines.</li>
<li>Location of cell-centers and cell interfaces along the spatial dimension of the interpolation is shown in the following figure: <div class="image">
<img src="chap1_1Ddomain.png" alt="chap1_1Ddomain.png"/>
</div>
 </li>
</ul>
<p><b>Function</b> <b>arguments:</b> </p>
<table class="doxtable">
<tr>
<th>Argument </th><th>Type </th><th>Explanation  </th></tr>
<tr>
<td>fI </td><td>double* </td><td>Array to hold the computed interpolant at the grid interfaces. This array must have the same layout as the solution, but with <b>no</b> <b>ghost</b> <b>points</b>. Its size should be the same as u in all dimensions, except dir (the dimension along which to interpolate) along which it should be larger by 1 (number of interfaces is 1 more than the number of interior cell centers). </td></tr>
<tr>
<td>fC </td><td>double* </td><td>Array with the cell-centered values of the flux function \({\bf f}\left({\bf u}\right)\). This array must have the same layout and size as the solution, <b>with</b> <b>ghost</b> <b>points</b>. </td></tr>
<tr>
<td>u </td><td>double* </td><td>The solution array \({\bf u}\) (with ghost points). If the interpolation is characteristic based, this is needed to compute the eigendecomposition. For a multidimensional problem, the layout is as follows: u is a contiguous 1D array of size (nvars*dim[0]*dim[1]*...*dim[D-1]) corresponding to the multi-dimensional solution, with the following ordering - nvars, dim[0], dim[1], ..., dim[D-1], where nvars is the number of solution components (<a class="el" href="a00115.html#ae8f6d2fd6490d3153cb4133bf183a404">HyPar::nvars</a>), dim is the local size (<a class="el" href="a00115.html#a38e0371f331cecbe63a77fa03e202afe">HyPar::dim_local</a>), D is the number of spatial dimensions. </td></tr>
<tr>
<td>x </td><td>double* </td><td>The grid array (with ghost points). This is used only by non-uniform-grid interpolation methods. For multidimensional problems, the layout is as follows: x is a contiguous 1D array of size (dim[0]+dim[1]+...+dim[D-1]), with the spatial coordinates along dim[0] stored from 0,...,dim[0]-1, the spatial coordinates along dim[1] stored along dim[0],...,dim[0]+dim[1]-1, and so forth. </td></tr>
<tr>
<td>upw </td><td>int </td><td>Upwinding direction: if positive, a left-biased interpolant will be computed; if negative, a right-biased interpolant will be computed. If the interpolation method is central, then this has no effect. </td></tr>
<tr>
<td>dir </td><td>int </td><td>Spatial dimension along which to interpolate (eg: 0 for 1D; 0 or 1 for 2D; 0,1 or 2 for 3D) </td></tr>
<tr>
<td>s </td><td>void* </td><td>Solver object of type <a class="el" href="a00115.html" title="Structure containing all solver-specific variables and functions. ">HyPar</a>: the following variables are needed - <a class="el" href="a00115.html#aafc992b5fa79d5a4036024615d03bce6">HyPar::ghosts</a>, <a class="el" href="a00115.html#a484873c74138512e41bc50d17b7d955a">HyPar::ndims</a>, <a class="el" href="a00115.html#ae8f6d2fd6490d3153cb4133bf183a404">HyPar::nvars</a>, <a class="el" href="a00115.html#a38e0371f331cecbe63a77fa03e202afe">HyPar::dim_local</a>. </td></tr>
<tr>
<td>m </td><td>void* </td><td>MPI object of type <a class="el" href="a00117.html#a00516" title="Structure of MPI-related variables. ">MPIVariables</a>: this is needed only by compact interpolation method that need to solve a global implicit system across MPI ranks. </td></tr>
<tr>
<td>uflag </td><td>int </td><td>A flag indicating if the function being interpolated \({\bf f}\) is the solution itself \({\bf u}\) (if 1, \({\bf f}\left({\bf u}\right) \equiv {\bf u}\)). </td></tr>
</table>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">fI</td><td>Array of interpolated function values at the interfaces </td></tr>
    <tr><td class="paramname">fC</td><td>Array of cell-centered values of the function \({\bf f}\left({\bf u}\right)\) </td></tr>
    <tr><td class="paramname">u</td><td>Array of cell-centered values of the solution \({\bf u}\) </td></tr>
    <tr><td class="paramname">x</td><td>Grid coordinates </td></tr>
    <tr><td class="paramname">upw</td><td>Upwind direction (left or right biased) </td></tr>
    <tr><td class="paramname">dir</td><td>Spatial dimension along which to interpolation </td></tr>
    <tr><td class="paramname">s</td><td>Object of type <a class="el" href="a00115.html" title="Structure containing all solver-specific variables and functions. ">HyPar</a> containing solver-related variables </td></tr>
    <tr><td class="paramname">m</td><td>Object of type <a class="el" href="a00117.html#a00516" title="Structure of MPI-related variables. ">MPIVariables</a> containing MPI-related variables </td></tr>
    <tr><td class="paramname">uflag</td><td>Flag to indicate if \(f(u) \equiv u\), i.e, if the solution is being reconstructed </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="a00233_source.html#l00076">76</a> of file <a class="el" href="a00233_source.html">Interp1PrimFirstOrderUpwindChar.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;{</div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;  <a class="code" href="a00115.html">HyPar</a>         *solver = (<a class="code" href="a00115.html">HyPar</a>*) s;</div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;  <span class="keywordtype">int</span>           i, k, v;</div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;  <a class="code" href="a00137.html#a68f50121fb9a7daeaf60e50cdef82ef3">_DECLARE_IERR_</a>;</div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;</div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;  <span class="keywordtype">int</span> ghosts = solver-&gt;<a class="code" href="a00115.html#aafc992b5fa79d5a4036024615d03bce6">ghosts</a>;</div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;  <span class="keywordtype">int</span> ndims  = solver-&gt;<a class="code" href="a00115.html#a484873c74138512e41bc50d17b7d955a">ndims</a>;</div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;  <span class="keywordtype">int</span> nvars  = solver-&gt;<a class="code" href="a00115.html#ae8f6d2fd6490d3153cb4133bf183a404">nvars</a>;</div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;  <span class="keywordtype">int</span> *dim   = solver-&gt;<a class="code" href="a00115.html#a38e0371f331cecbe63a77fa03e202afe">dim_local</a>;</div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;</div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;  <span class="comment">/* create index and bounds for the outer loop, i.e., to loop over all 1D lines along</span></div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;<span class="comment">     dimension &quot;dir&quot;                                                                    */</span></div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;  <span class="keywordtype">int</span> indexC[ndims], indexI[ndims], index_outer[ndims], bounds_outer[ndims], bounds_inter[ndims];</div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;  <a class="code" href="a00136.html#a89e8330d9e06dd0666c50833628a125c">_ArrayCopy1D_</a>(dim,bounds_outer,ndims); bounds_outer[dir] =  1;</div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;  <a class="code" href="a00136.html#a89e8330d9e06dd0666c50833628a125c">_ArrayCopy1D_</a>(dim,bounds_inter,ndims); bounds_inter[dir] += 1;</div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;  <span class="keywordtype">int</span> N_outer; <a class="code" href="a00136.html#abc65e9c6a51b875f46fdb054a0ecf604">_ArrayProduct1D_</a>(bounds_outer,ndims,N_outer);</div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;</div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;  <span class="comment">/* allocate arrays for the averaged state, eigenvectors and characteristic interpolated f */</span></div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;  <span class="keywordtype">double</span> R[nvars*nvars], L[nvars*nvars], uavg[nvars], fchar[nvars];</div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;</div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;<span class="preprocessor">#pragma omp parallel for schedule(auto) default(shared) private(i,k,v,R,L,uavg,fchar,index_outer,indexC,indexI)</span></div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;<span class="preprocessor"></span>  <span class="keywordflow">for</span> (i=0; i&lt;N_outer; i++) {</div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;    <a class="code" href="a00136.html#a03f49e4d44ae8aca85cb04cfe91e4ce4">_ArrayIndexnD_</a>(ndims,i,bounds_outer,index_outer,0);</div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;    <a class="code" href="a00136.html#a89e8330d9e06dd0666c50833628a125c">_ArrayCopy1D_</a>(index_outer,indexC,ndims);</div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;    <a class="code" href="a00136.html#a89e8330d9e06dd0666c50833628a125c">_ArrayCopy1D_</a>(index_outer,indexI,ndims);</div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;</div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;    <span class="keywordflow">for</span> (indexI[dir] = 0; indexI[dir] &lt; dim[dir]+1; indexI[dir]++) {</div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;</div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;      <span class="keywordtype">int</span> pL, pR; <span class="comment">/* 1D index of the left and right cells */</span></div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;      indexC[dir] = indexI[dir]-1; <a class="code" href="a00136.html#afbb862a2fdf5b72b1f9ace42f64b556f">_ArrayIndex1D_</a>(ndims,dim,indexC,ghosts,pL);</div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;      indexC[dir] = indexI[dir]  ; <a class="code" href="a00136.html#afbb862a2fdf5b72b1f9ace42f64b556f">_ArrayIndex1D_</a>(ndims,dim,indexC,ghosts,pR);</div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;      <span class="keywordtype">int</span> p; <span class="comment">/* 1D index of the interface */</span></div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;      <a class="code" href="a00136.html#afbb862a2fdf5b72b1f9ace42f64b556f">_ArrayIndex1D_</a>(ndims,bounds_inter,indexI,0,p);</div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;</div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;      <span class="comment">/* find averaged state at this interface */</span></div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;      <a class="code" href="a00137.html#ad6ab74942c9de13cf0b4c12eb0d91780">IERR</a> solver-&gt;<a class="code" href="a00115.html#a7331366d789b2995436accbc35e1cc80">AveragingFunction</a>(uavg,&amp;u[nvars*pL],&amp;u[nvars*pR],solver-&gt;<a class="code" href="a00115.html#a48e81a1806b5774943fd9a26e9a190f2">physics</a>); <a class="code" href="a00137.html#add9cf96ae374934d245a1dc1ab697a42">CHECKERR</a>(ierr);</div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;</div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;      <span class="comment">/* Get the left and right eigenvectors */</span></div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;      <a class="code" href="a00137.html#ad6ab74942c9de13cf0b4c12eb0d91780">IERR</a> solver-&gt;<a class="code" href="a00115.html#a8c603c73be1f08e408a1de94a088da7b">GetLeftEigenvectors</a>  (uavg,L,solver-&gt;<a class="code" href="a00115.html#a48e81a1806b5774943fd9a26e9a190f2">physics</a>,dir); <a class="code" href="a00137.html#add9cf96ae374934d245a1dc1ab697a42">CHECKERR</a>(ierr);</div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;      <a class="code" href="a00137.html#ad6ab74942c9de13cf0b4c12eb0d91780">IERR</a> solver-&gt;<a class="code" href="a00115.html#a22eef349f191a1aa267e14b08140c823">GetRightEigenvectors</a> (uavg,R,solver-&gt;<a class="code" href="a00115.html#a48e81a1806b5774943fd9a26e9a190f2">physics</a>,dir); <a class="code" href="a00137.html#add9cf96ae374934d245a1dc1ab697a42">CHECKERR</a>(ierr);</div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;</div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;      <span class="comment">/* For each characteristic field */</span></div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;      <span class="keywordflow">for</span> (v = 0; v &lt; nvars; v++) {</div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;</div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;        <span class="comment">/* calculate the characteristic flux components along this characteristic */</span></div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;        <span class="keywordtype">double</span> fcL = 0, fcR = 0;</div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;        <span class="keywordflow">for</span> (k = 0; k &lt; nvars; k++) {</div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;          fcL += L[v*nvars+k] * fC[pL*nvars+k];</div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;          fcR += L[v*nvars+k] * fC[pR*nvars+k];</div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;        }</div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;</div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;        <span class="comment">/* first order upwind approximation of the characteristic flux */</span></div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;        fchar[v] = (upw &gt; 0 ? fcL : fcR);</div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;</div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;      }</div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;</div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;      <span class="comment">/* calculate the interface u from the characteristic u */</span></div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;      <a class="code" href="a00137.html#ad6ab74942c9de13cf0b4c12eb0d91780">IERR</a> <a class="code" href="a00147.html#a3dc53d4eb4ba0f2cfed00aa69617ee84">MatVecMult</a>(nvars,(fI+nvars*p),R,fchar); <a class="code" href="a00137.html#add9cf96ae374934d245a1dc1ab697a42">CHECKERR</a>(ierr);</div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;</div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;    }</div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;  }</div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;</div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;  <span class="keywordflow">return</span>(0);</div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;}</div>
<div class="ttc" id="a00115_html_a484873c74138512e41bc50d17b7d955a"><div class="ttname"><a href="a00115.html#a484873c74138512e41bc50d17b7d955a">HyPar::ndims</a></div><div class="ttdeci">int ndims</div><div class="ttdef"><b>Definition:</b> <a href="a00143_source.html#l00026">hypar.h:26</a></div></div>
<div class="ttc" id="a00115_html_aafc992b5fa79d5a4036024615d03bce6"><div class="ttname"><a href="a00115.html#aafc992b5fa79d5a4036024615d03bce6">HyPar::ghosts</a></div><div class="ttdeci">int ghosts</div><div class="ttdef"><b>Definition:</b> <a href="a00143_source.html#l00044">hypar.h:44</a></div></div>
<div class="ttc" id="a00115_html"><div class="ttname"><a href="a00115.html">HyPar</a></div><div class="ttdoc">Structure containing all solver-specific variables and functions. </div><div class="ttdef"><b>Definition:</b> <a href="a00143_source.html#l00023">hypar.h:23</a></div></div>
<div class="ttc" id="a00137_html_ad6ab74942c9de13cf0b4c12eb0d91780"><div class="ttname"><a href="a00137.html#ad6ab74942c9de13cf0b4c12eb0d91780">IERR</a></div><div class="ttdeci">#define IERR</div><div class="ttdef"><b>Definition:</b> <a href="a00137_source.html#l00012">basic.h:12</a></div></div>
<div class="ttc" id="a00115_html_a8c603c73be1f08e408a1de94a088da7b"><div class="ttname"><a href="a00115.html#a8c603c73be1f08e408a1de94a088da7b">HyPar::GetLeftEigenvectors</a></div><div class="ttdeci">int(* GetLeftEigenvectors)(double *, double *, void *, int)</div><div class="ttdef"><b>Definition:</b> <a href="a00143_source.html#l00321">hypar.h:321</a></div></div>
<div class="ttc" id="a00115_html_ae8f6d2fd6490d3153cb4133bf183a404"><div class="ttname"><a href="a00115.html#ae8f6d2fd6490d3153cb4133bf183a404">HyPar::nvars</a></div><div class="ttdeci">int nvars</div><div class="ttdef"><b>Definition:</b> <a href="a00143_source.html#l00029">hypar.h:29</a></div></div>
<div class="ttc" id="a00136_html_a89e8330d9e06dd0666c50833628a125c"><div class="ttname"><a href="a00136.html#a89e8330d9e06dd0666c50833628a125c">_ArrayCopy1D_</a></div><div class="ttdeci">#define _ArrayCopy1D_(x, y, size)</div><div class="ttdef"><b>Definition:</b> <a href="a00136_source.html#l00318">arrayfunctions.h:318</a></div></div>
<div class="ttc" id="a00115_html_a38e0371f331cecbe63a77fa03e202afe"><div class="ttname"><a href="a00115.html#a38e0371f331cecbe63a77fa03e202afe">HyPar::dim_local</a></div><div class="ttdeci">int * dim_local</div><div class="ttdef"><b>Definition:</b> <a href="a00143_source.html#l00035">hypar.h:35</a></div></div>
<div class="ttc" id="a00115_html_a22eef349f191a1aa267e14b08140c823"><div class="ttname"><a href="a00115.html#a22eef349f191a1aa267e14b08140c823">HyPar::GetRightEigenvectors</a></div><div class="ttdeci">int(* GetRightEigenvectors)(double *, double *, void *, int)</div><div class="ttdef"><b>Definition:</b> <a href="a00143_source.html#l00323">hypar.h:323</a></div></div>
<div class="ttc" id="a00137_html_add9cf96ae374934d245a1dc1ab697a42"><div class="ttname"><a href="a00137.html#add9cf96ae374934d245a1dc1ab697a42">CHECKERR</a></div><div class="ttdeci">#define CHECKERR(ierr)</div><div class="ttdef"><b>Definition:</b> <a href="a00137_source.html#l00014">basic.h:14</a></div></div>
<div class="ttc" id="a00136_html_a03f49e4d44ae8aca85cb04cfe91e4ce4"><div class="ttname"><a href="a00136.html#a03f49e4d44ae8aca85cb04cfe91e4ce4">_ArrayIndexnD_</a></div><div class="ttdeci">#define _ArrayIndexnD_(N, index, imax, i, ghost)</div><div class="ttdef"><b>Definition:</b> <a href="a00136_source.html#l00020">arrayfunctions.h:20</a></div></div>
<div class="ttc" id="a00136_html_abc65e9c6a51b875f46fdb054a0ecf604"><div class="ttname"><a href="a00136.html#abc65e9c6a51b875f46fdb054a0ecf604">_ArrayProduct1D_</a></div><div class="ttdeci">#define _ArrayProduct1D_(x, size, p)</div><div class="ttdef"><b>Definition:</b> <a href="a00136_source.html#l00376">arrayfunctions.h:376</a></div></div>
<div class="ttc" id="a00115_html_a7331366d789b2995436accbc35e1cc80"><div class="ttname"><a href="a00115.html#a7331366d789b2995436accbc35e1cc80">HyPar::AveragingFunction</a></div><div class="ttdeci">int(* AveragingFunction)(double *, double *, double *, void *)</div><div class="ttdef"><b>Definition:</b> <a href="a00143_source.html#l00318">hypar.h:318</a></div></div>
<div class="ttc" id="a00136_html_afbb862a2fdf5b72b1f9ace42f64b556f"><div class="ttname"><a href="a00136.html#afbb862a2fdf5b72b1f9ace42f64b556f">_ArrayIndex1D_</a></div><div class="ttdeci">#define _ArrayIndex1D_(N, imax, i, ghost, index)</div><div class="ttdef"><b>Definition:</b> <a href="a00136_source.html#l00039">arrayfunctions.h:39</a></div></div>
<div class="ttc" id="a00147_html_a3dc53d4eb4ba0f2cfed00aa69617ee84"><div class="ttname"><a href="a00147.html#a3dc53d4eb4ba0f2cfed00aa69617ee84">MatVecMult</a></div><div class="ttdeci">#define MatVecMult(N, y, A, x)</div><div class="ttdef"><b>Definition:</b> <a href="a00147_source.html#l00162">mathfunctions.h:162</a></div></div>
<div class="ttc" id="a00137_html_a68f50121fb9a7daeaf60e50cdef82ef3"><div class="ttname"><a href="a00137.html#a68f50121fb9a7daeaf60e50cdef82ef3">_DECLARE_IERR_</a></div><div class="ttdeci">#define _DECLARE_IERR_</div><div class="ttdef"><b>Definition:</b> <a href="a00137_source.html#l00013">basic.h:13</a></div></div>
<div class="ttc" id="a00115_html_a48e81a1806b5774943fd9a26e9a190f2"><div class="ttname"><a href="a00115.html#a48e81a1806b5774943fd9a26e9a190f2">HyPar::physics</a></div><div class="ttdeci">void * physics</div><div class="ttdef"><b>Definition:</b> <a href="a00143_source.html#l00245">hypar.h:245</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a963c82116a2a1d6084af3d519b61b896"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int Interp1PrimSecondOrderCentralChar </td>
          <td>(</td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>fI</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>fC</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>u</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>upw</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>dir</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>s</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>m</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>uflag</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>2nd order central reconstruction (characteristic-based) on a uniform grid </p>
<p>Characteristic-based interpolation of the first primitive at the cell interfaces using the second-order central scheme</p>
<p>Computes the interpolated values of the first primitive of a function \({\bf f}\left({\bf u}\right)\) at the interfaces from the cell-centered values of the function using the 2nd order central scheme on a uniform grid. The first primitive is defined as a function \({\bf h}\left({\bf u}\right)\) that satisfies: </p>
<p class="formulaDsp">
\begin{equation} {\bf f}\left({\bf u}\left(x\right)\right) = \frac{1}{\Delta x} \int_{x-\Delta x/2}^{x+\Delta x/2} {\bf h}\left({\bf u}\left(\zeta\right)\right)d\zeta, \end{equation}
</p>
<p> where \(x\) is the spatial coordinate along the dimension of the interpolation. This function computes the 2nd order central numerical approximation \(\hat{\bf f}_{j+1/2} \approx {\bf h}_{j+1/2}\) as: </p>
<p class="formulaDsp">
\begin{equation} \hat{\alpha}^k_{j+1/2} = \frac{1}{2} \left( {\alpha}^k_{j-1} + {\alpha}^k_j \right), \end{equation}
</p>
<p> where </p>
<p class="formulaDsp">
\begin{equation} \alpha^k = {\bf l}_k \cdot {\bf f},\ k=1,\cdots,n \end{equation}
</p>
<p> is the \(k\)-th characteristic quantity, and \({\bf l}_k\) is the \(k\)-th left eigenvector, \({\bf r}_k\) is the \(k\)-th right eigenvector, and \(n\) is <a class="el" href="a00115.html#ae8f6d2fd6490d3153cb4133bf183a404">HyPar::nvars</a>. The final interpolated function is computed from the interpolated characteristic quantities as: </p>
<p class="formulaDsp">
\begin{equation} \hat{\bf f}_{j+1/2} = \sum_{k=1}^n \alpha^k_{j+1/2} {\bf r}_k \end{equation}
</p>
<p><b>Implementation</b> <b>Notes:</b> </p>
<ul>
<li>This method assumes a uniform grid in the spatial dimension corresponding to the interpolation.</li>
<li>Since this is a central scheme, the input argument <b>upw</b> has no effect.</li>
<li><p class="startli">The left and right eigenvectors are computed at an averaged quantity at j+1/2. Thus, this function requires functions to compute the average state, and the left and right eigenvectors. These are provided by the physical model through</p>
<ul>
<li><a class="el" href="a00115.html#a8c603c73be1f08e408a1de94a088da7b">HyPar::GetLeftEigenvectors()</a></li>
<li><a class="el" href="a00115.html#a22eef349f191a1aa267e14b08140c823">HyPar::GetRightEigenvectors()</a></li>
<li><a class="el" href="a00115.html#a7331366d789b2995436accbc35e1cc80">HyPar::AveragingFunction()</a></li>
</ul>
<p class="startli">If these functions are not provided by the physical model, then a characteristic-based interpolation cannot be used.</p>
</li>
<li>The function computes the interpolant for the entire grid in one call. It loops over all the grid lines along the interpolation direction and carries out the 1D interpolation along these grid lines.</li>
<li>Location of cell-centers and cell interfaces along the spatial dimension of the interpolation is shown in the following figure: <div class="image">
<img src="chap1_1Ddomain.png" alt="chap1_1Ddomain.png"/>
</div>
 </li>
</ul>
<p><b>Function</b> <b>arguments:</b> </p>
<table class="doxtable">
<tr>
<th>Argument </th><th>Type </th><th>Explanation  </th></tr>
<tr>
<td>fI </td><td>double* </td><td>Array to hold the computed interpolant at the grid interfaces. This array must have the same layout as the solution, but with <b>no</b> <b>ghost</b> <b>points</b>. Its size should be the same as u in all dimensions, except dir (the dimension along which to interpolate) along which it should be larger by 1 (number of interfaces is 1 more than the number of interior cell centers). </td></tr>
<tr>
<td>fC </td><td>double* </td><td>Array with the cell-centered values of the flux function \({\bf f}\left({\bf u}\right)\). This array must have the same layout and size as the solution, <b>with</b> <b>ghost</b> <b>points</b>. </td></tr>
<tr>
<td>u </td><td>double* </td><td>The solution array \({\bf u}\) (with ghost points). If the interpolation is characteristic based, this is needed to compute the eigendecomposition. For a multidimensional problem, the layout is as follows: u is a contiguous 1D array of size (nvars*dim[0]*dim[1]*...*dim[D-1]) corresponding to the multi-dimensional solution, with the following ordering - nvars, dim[0], dim[1], ..., dim[D-1], where nvars is the number of solution components (<a class="el" href="a00115.html#ae8f6d2fd6490d3153cb4133bf183a404">HyPar::nvars</a>), dim is the local size (<a class="el" href="a00115.html#a38e0371f331cecbe63a77fa03e202afe">HyPar::dim_local</a>), D is the number of spatial dimensions. </td></tr>
<tr>
<td>x </td><td>double* </td><td>The grid array (with ghost points). This is used only by non-uniform-grid interpolation methods. For multidimensional problems, the layout is as follows: x is a contiguous 1D array of size (dim[0]+dim[1]+...+dim[D-1]), with the spatial coordinates along dim[0] stored from 0,...,dim[0]-1, the spatial coordinates along dim[1] stored along dim[0],...,dim[0]+dim[1]-1, and so forth. </td></tr>
<tr>
<td>upw </td><td>int </td><td>Upwinding direction: if positive, a left-biased interpolant will be computed; if negative, a right-biased interpolant will be computed. If the interpolation method is central, then this has no effect. </td></tr>
<tr>
<td>dir </td><td>int </td><td>Spatial dimension along which to interpolate (eg: 0 for 1D; 0 or 1 for 2D; 0,1 or 2 for 3D) </td></tr>
<tr>
<td>s </td><td>void* </td><td>Solver object of type <a class="el" href="a00115.html" title="Structure containing all solver-specific variables and functions. ">HyPar</a>: the following variables are needed - <a class="el" href="a00115.html#aafc992b5fa79d5a4036024615d03bce6">HyPar::ghosts</a>, <a class="el" href="a00115.html#a484873c74138512e41bc50d17b7d955a">HyPar::ndims</a>, <a class="el" href="a00115.html#ae8f6d2fd6490d3153cb4133bf183a404">HyPar::nvars</a>, <a class="el" href="a00115.html#a38e0371f331cecbe63a77fa03e202afe">HyPar::dim_local</a>. </td></tr>
<tr>
<td>m </td><td>void* </td><td>MPI object of type <a class="el" href="a00117.html#a00516" title="Structure of MPI-related variables. ">MPIVariables</a>: this is needed only by compact interpolation method that need to solve a global implicit system across MPI ranks. </td></tr>
<tr>
<td>uflag </td><td>int </td><td>A flag indicating if the function being interpolated \({\bf f}\) is the solution itself \({\bf u}\) (if 1, \({\bf f}\left({\bf u}\right) \equiv {\bf u}\)). </td></tr>
</table>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">fI</td><td>Array of interpolated function values at the interfaces </td></tr>
    <tr><td class="paramname">fC</td><td>Array of cell-centered values of the function \({\bf f}\left({\bf u}\right)\) </td></tr>
    <tr><td class="paramname">u</td><td>Array of cell-centered values of the solution \({\bf u}\) </td></tr>
    <tr><td class="paramname">x</td><td>Grid coordinates </td></tr>
    <tr><td class="paramname">upw</td><td>Upwind direction (left or right biased) </td></tr>
    <tr><td class="paramname">dir</td><td>Spatial dimension along which to interpolation </td></tr>
    <tr><td class="paramname">s</td><td>Object of type <a class="el" href="a00115.html" title="Structure containing all solver-specific variables and functions. ">HyPar</a> containing solver-related variables </td></tr>
    <tr><td class="paramname">m</td><td>Object of type <a class="el" href="a00117.html#a00516" title="Structure of MPI-related variables. ">MPIVariables</a> containing MPI-related variables </td></tr>
    <tr><td class="paramname">uflag</td><td>Flag to indicate if \(f(u) \equiv u\), i.e, if the solution is being reconstructed </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="a00235_source.html#l00078">78</a> of file <a class="el" href="a00235_source.html">Interp1PrimSecondOrderCentralChar.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;{</div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;  <a class="code" href="a00115.html">HyPar</a>         *solver = (<a class="code" href="a00115.html">HyPar</a>*) s;</div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;  <span class="keywordtype">int</span>           i, k, v;</div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;  <a class="code" href="a00137.html#a68f50121fb9a7daeaf60e50cdef82ef3">_DECLARE_IERR_</a>;</div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;</div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;  <span class="keywordtype">int</span> ghosts = solver-&gt;<a class="code" href="a00115.html#aafc992b5fa79d5a4036024615d03bce6">ghosts</a>;</div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;  <span class="keywordtype">int</span> ndims  = solver-&gt;<a class="code" href="a00115.html#a484873c74138512e41bc50d17b7d955a">ndims</a>;</div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;  <span class="keywordtype">int</span> nvars  = solver-&gt;<a class="code" href="a00115.html#ae8f6d2fd6490d3153cb4133bf183a404">nvars</a>;</div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;  <span class="keywordtype">int</span> *dim   = solver-&gt;<a class="code" href="a00115.html#a38e0371f331cecbe63a77fa03e202afe">dim_local</a>;</div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;</div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;  <span class="comment">/* create index and bounds for the outer loop, i.e., to loop over all 1D lines along</span></div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;<span class="comment">     dimension &quot;dir&quot;                                                                    */</span></div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;  <span class="keywordtype">int</span> indexC[ndims], indexI[ndims], index_outer[ndims], bounds_outer[ndims], bounds_inter[ndims];</div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;  <a class="code" href="a00136.html#a89e8330d9e06dd0666c50833628a125c">_ArrayCopy1D_</a>(dim,bounds_outer,ndims); bounds_outer[dir] =  1;</div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;  <a class="code" href="a00136.html#a89e8330d9e06dd0666c50833628a125c">_ArrayCopy1D_</a>(dim,bounds_inter,ndims); bounds_inter[dir] += 1;</div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;  <span class="keywordtype">int</span> N_outer; <a class="code" href="a00136.html#abc65e9c6a51b875f46fdb054a0ecf604">_ArrayProduct1D_</a>(bounds_outer,ndims,N_outer);</div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;</div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;  <span class="comment">/* allocate arrays for the averaged state, eigenvectors and characteristic interpolated f */</span></div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;  <span class="keywordtype">double</span> R[nvars*nvars], L[nvars*nvars], uavg[nvars], fchar[nvars];</div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;</div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;<span class="preprocessor">#pragma omp parallel for schedule(auto) default(shared) private(i,k,v,R,L,uavg,fchar,index_outer,indexC,indexI)</span></div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;<span class="preprocessor"></span>  <span class="keywordflow">for</span> (i=0; i&lt;N_outer; i++) {</div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;    <a class="code" href="a00136.html#a03f49e4d44ae8aca85cb04cfe91e4ce4">_ArrayIndexnD_</a>(ndims,i,bounds_outer,index_outer,0);</div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;    <a class="code" href="a00136.html#a89e8330d9e06dd0666c50833628a125c">_ArrayCopy1D_</a>(index_outer,indexC,ndims);</div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;    <a class="code" href="a00136.html#a89e8330d9e06dd0666c50833628a125c">_ArrayCopy1D_</a>(index_outer,indexI,ndims);</div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;</div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;    <span class="keywordflow">for</span> (indexI[dir] = 0; indexI[dir] &lt; dim[dir]+1; indexI[dir]++) {</div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;</div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;      <span class="keywordtype">int</span> pL, pR; <span class="comment">/* 1D index of the left and right cells */</span></div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;      indexC[dir] = indexI[dir]-1; <a class="code" href="a00136.html#afbb862a2fdf5b72b1f9ace42f64b556f">_ArrayIndex1D_</a>(ndims,dim,indexC,ghosts,pL);</div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;      indexC[dir] = indexI[dir]  ; <a class="code" href="a00136.html#afbb862a2fdf5b72b1f9ace42f64b556f">_ArrayIndex1D_</a>(ndims,dim,indexC,ghosts,pR);</div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;      <span class="keywordtype">int</span> p; <span class="comment">/* 1D index of the interface */</span></div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;      <a class="code" href="a00136.html#afbb862a2fdf5b72b1f9ace42f64b556f">_ArrayIndex1D_</a>(ndims,bounds_inter,indexI,0,p);</div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;</div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;      <span class="comment">/* find averaged state at this interface */</span></div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;      <a class="code" href="a00137.html#ad6ab74942c9de13cf0b4c12eb0d91780">IERR</a> solver-&gt;<a class="code" href="a00115.html#a7331366d789b2995436accbc35e1cc80">AveragingFunction</a>(uavg,&amp;u[nvars*pL],&amp;u[nvars*pR],solver-&gt;<a class="code" href="a00115.html#a48e81a1806b5774943fd9a26e9a190f2">physics</a>); <a class="code" href="a00137.html#add9cf96ae374934d245a1dc1ab697a42">CHECKERR</a>(ierr);</div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;</div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;      <span class="comment">/* Get the left and right eigenvectors */</span></div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;      <a class="code" href="a00137.html#ad6ab74942c9de13cf0b4c12eb0d91780">IERR</a> solver-&gt;<a class="code" href="a00115.html#a8c603c73be1f08e408a1de94a088da7b">GetLeftEigenvectors</a>  (uavg,L,solver-&gt;<a class="code" href="a00115.html#a48e81a1806b5774943fd9a26e9a190f2">physics</a>,dir); <a class="code" href="a00137.html#add9cf96ae374934d245a1dc1ab697a42">CHECKERR</a>(ierr);</div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;      <a class="code" href="a00137.html#ad6ab74942c9de13cf0b4c12eb0d91780">IERR</a> solver-&gt;<a class="code" href="a00115.html#a22eef349f191a1aa267e14b08140c823">GetRightEigenvectors</a> (uavg,R,solver-&gt;<a class="code" href="a00115.html#a48e81a1806b5774943fd9a26e9a190f2">physics</a>,dir); <a class="code" href="a00137.html#add9cf96ae374934d245a1dc1ab697a42">CHECKERR</a>(ierr);</div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;</div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;      <span class="comment">/* For each characteristic field */</span></div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;      <span class="keywordflow">for</span> (v = 0; v &lt; nvars; v++) {</div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;</div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;        <span class="comment">/* calculate the characteristic flux components along this characteristic */</span></div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;        <span class="keywordtype">double</span> fcL = 0, fcR = 0;</div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;        <span class="keywordflow">for</span> (k = 0; k &lt; nvars; k++) {</div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;          fcL += L[v*nvars+k] * fC[pL*nvars+k];</div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;          fcR += L[v*nvars+k] * fC[pR*nvars+k];</div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;        }</div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;</div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;        <span class="comment">/* first order upwind approximation of the characteristic flux */</span></div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;        fchar[v] = 0.5 * (fcL + fcR);</div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;</div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;      }</div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;</div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;      <span class="comment">/* calculate the interface u from the characteristic u */</span></div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;      <a class="code" href="a00137.html#ad6ab74942c9de13cf0b4c12eb0d91780">IERR</a> <a class="code" href="a00147.html#a3dc53d4eb4ba0f2cfed00aa69617ee84">MatVecMult</a>(nvars,(fI+nvars*p),R,fchar); <a class="code" href="a00137.html#add9cf96ae374934d245a1dc1ab697a42">CHECKERR</a>(ierr);</div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;</div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;    }</div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;  }</div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;</div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;  <span class="keywordflow">return</span>(0);</div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;}</div>
<div class="ttc" id="a00115_html_a484873c74138512e41bc50d17b7d955a"><div class="ttname"><a href="a00115.html#a484873c74138512e41bc50d17b7d955a">HyPar::ndims</a></div><div class="ttdeci">int ndims</div><div class="ttdef"><b>Definition:</b> <a href="a00143_source.html#l00026">hypar.h:26</a></div></div>
<div class="ttc" id="a00115_html_aafc992b5fa79d5a4036024615d03bce6"><div class="ttname"><a href="a00115.html#aafc992b5fa79d5a4036024615d03bce6">HyPar::ghosts</a></div><div class="ttdeci">int ghosts</div><div class="ttdef"><b>Definition:</b> <a href="a00143_source.html#l00044">hypar.h:44</a></div></div>
<div class="ttc" id="a00115_html"><div class="ttname"><a href="a00115.html">HyPar</a></div><div class="ttdoc">Structure containing all solver-specific variables and functions. </div><div class="ttdef"><b>Definition:</b> <a href="a00143_source.html#l00023">hypar.h:23</a></div></div>
<div class="ttc" id="a00137_html_ad6ab74942c9de13cf0b4c12eb0d91780"><div class="ttname"><a href="a00137.html#ad6ab74942c9de13cf0b4c12eb0d91780">IERR</a></div><div class="ttdeci">#define IERR</div><div class="ttdef"><b>Definition:</b> <a href="a00137_source.html#l00012">basic.h:12</a></div></div>
<div class="ttc" id="a00115_html_a8c603c73be1f08e408a1de94a088da7b"><div class="ttname"><a href="a00115.html#a8c603c73be1f08e408a1de94a088da7b">HyPar::GetLeftEigenvectors</a></div><div class="ttdeci">int(* GetLeftEigenvectors)(double *, double *, void *, int)</div><div class="ttdef"><b>Definition:</b> <a href="a00143_source.html#l00321">hypar.h:321</a></div></div>
<div class="ttc" id="a00115_html_ae8f6d2fd6490d3153cb4133bf183a404"><div class="ttname"><a href="a00115.html#ae8f6d2fd6490d3153cb4133bf183a404">HyPar::nvars</a></div><div class="ttdeci">int nvars</div><div class="ttdef"><b>Definition:</b> <a href="a00143_source.html#l00029">hypar.h:29</a></div></div>
<div class="ttc" id="a00136_html_a89e8330d9e06dd0666c50833628a125c"><div class="ttname"><a href="a00136.html#a89e8330d9e06dd0666c50833628a125c">_ArrayCopy1D_</a></div><div class="ttdeci">#define _ArrayCopy1D_(x, y, size)</div><div class="ttdef"><b>Definition:</b> <a href="a00136_source.html#l00318">arrayfunctions.h:318</a></div></div>
<div class="ttc" id="a00115_html_a38e0371f331cecbe63a77fa03e202afe"><div class="ttname"><a href="a00115.html#a38e0371f331cecbe63a77fa03e202afe">HyPar::dim_local</a></div><div class="ttdeci">int * dim_local</div><div class="ttdef"><b>Definition:</b> <a href="a00143_source.html#l00035">hypar.h:35</a></div></div>
<div class="ttc" id="a00115_html_a22eef349f191a1aa267e14b08140c823"><div class="ttname"><a href="a00115.html#a22eef349f191a1aa267e14b08140c823">HyPar::GetRightEigenvectors</a></div><div class="ttdeci">int(* GetRightEigenvectors)(double *, double *, void *, int)</div><div class="ttdef"><b>Definition:</b> <a href="a00143_source.html#l00323">hypar.h:323</a></div></div>
<div class="ttc" id="a00137_html_add9cf96ae374934d245a1dc1ab697a42"><div class="ttname"><a href="a00137.html#add9cf96ae374934d245a1dc1ab697a42">CHECKERR</a></div><div class="ttdeci">#define CHECKERR(ierr)</div><div class="ttdef"><b>Definition:</b> <a href="a00137_source.html#l00014">basic.h:14</a></div></div>
<div class="ttc" id="a00136_html_a03f49e4d44ae8aca85cb04cfe91e4ce4"><div class="ttname"><a href="a00136.html#a03f49e4d44ae8aca85cb04cfe91e4ce4">_ArrayIndexnD_</a></div><div class="ttdeci">#define _ArrayIndexnD_(N, index, imax, i, ghost)</div><div class="ttdef"><b>Definition:</b> <a href="a00136_source.html#l00020">arrayfunctions.h:20</a></div></div>
<div class="ttc" id="a00136_html_abc65e9c6a51b875f46fdb054a0ecf604"><div class="ttname"><a href="a00136.html#abc65e9c6a51b875f46fdb054a0ecf604">_ArrayProduct1D_</a></div><div class="ttdeci">#define _ArrayProduct1D_(x, size, p)</div><div class="ttdef"><b>Definition:</b> <a href="a00136_source.html#l00376">arrayfunctions.h:376</a></div></div>
<div class="ttc" id="a00115_html_a7331366d789b2995436accbc35e1cc80"><div class="ttname"><a href="a00115.html#a7331366d789b2995436accbc35e1cc80">HyPar::AveragingFunction</a></div><div class="ttdeci">int(* AveragingFunction)(double *, double *, double *, void *)</div><div class="ttdef"><b>Definition:</b> <a href="a00143_source.html#l00318">hypar.h:318</a></div></div>
<div class="ttc" id="a00136_html_afbb862a2fdf5b72b1f9ace42f64b556f"><div class="ttname"><a href="a00136.html#afbb862a2fdf5b72b1f9ace42f64b556f">_ArrayIndex1D_</a></div><div class="ttdeci">#define _ArrayIndex1D_(N, imax, i, ghost, index)</div><div class="ttdef"><b>Definition:</b> <a href="a00136_source.html#l00039">arrayfunctions.h:39</a></div></div>
<div class="ttc" id="a00147_html_a3dc53d4eb4ba0f2cfed00aa69617ee84"><div class="ttname"><a href="a00147.html#a3dc53d4eb4ba0f2cfed00aa69617ee84">MatVecMult</a></div><div class="ttdeci">#define MatVecMult(N, y, A, x)</div><div class="ttdef"><b>Definition:</b> <a href="a00147_source.html#l00162">mathfunctions.h:162</a></div></div>
<div class="ttc" id="a00137_html_a68f50121fb9a7daeaf60e50cdef82ef3"><div class="ttname"><a href="a00137.html#a68f50121fb9a7daeaf60e50cdef82ef3">_DECLARE_IERR_</a></div><div class="ttdeci">#define _DECLARE_IERR_</div><div class="ttdef"><b>Definition:</b> <a href="a00137_source.html#l00013">basic.h:13</a></div></div>
<div class="ttc" id="a00115_html_a48e81a1806b5774943fd9a26e9a190f2"><div class="ttname"><a href="a00115.html#a48e81a1806b5774943fd9a26e9a190f2">HyPar::physics</a></div><div class="ttdeci">void * physics</div><div class="ttdef"><b>Definition:</b> <a href="a00143_source.html#l00245">hypar.h:245</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a9cde00a0c916f0cda162b1c03d3f7b6b"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int Interp1PrimSecondOrderMUSCLChar </td>
          <td>(</td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>fI</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>fC</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>u</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>upw</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>dir</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>s</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>m</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>uflag</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>2nd order MUSCL scheme (characteristic-based) on a uniform grid </p>
<p>Characteristic-based interpolation of the first primitive at the cell interfaces using the second-order MUSCL scheme</p>
<p>Computes the interpolated values of the first primitive of a function \({\bf f}\left({\bf u}\right)\) at the interfaces from the cell-centered values of the function using the 2nd order MUSCL scheme on a uniform grid. The first primitive is defined as a function \({\bf h}\left({\bf u}\right)\) that satisfies: </p>
<p class="formulaDsp">
\begin{equation} {\bf f}\left({\bf u}\left(x\right)\right) = \frac{1}{\Delta x} \int_{x-\Delta x/2}^{x+\Delta x/2} {\bf h}\left({\bf u}\left(\zeta\right)\right)d\zeta, \end{equation}
</p>
<p> where \(x\) is the spatial coordinate along the dimension of the interpolation. This function computes numerical approximation \(\hat{\bf f}_{j+1/2} \approx {\bf h}_{j+1/2}\) as: using the 2nd order MUSCL scheme as follows: </p>
<p class="formulaDsp">
\begin{equation} \hat{\alpha}^k_{j+1/2} = {\alpha}^k_{j} + \frac{1}{2} \phi\left(r_j\right) \left[{\alpha}^k_{j+1}-{\alpha}^k_{j}\right] \end{equation}
</p>
<p> where </p>
<p class="formulaDsp">
\begin{equation} r_j = \left( \alpha^k_j - \alpha^k_{j-1} \right) / \left( \alpha^k_{j+1} - \alpha^k_j \right), \end{equation}
</p>
<p> \(\phi\left(r\right)\) is a limiter (minmod, mc, generalized minmod, etc.), and </p>
<p class="formulaDsp">
\begin{equation} \alpha^k = {\bf l}_k \cdot {\bf f},\ k=1,\cdots,n \end{equation}
</p>
<p> is the \(k\)-th characteristic quantity, and \({\bf l}_k\) is the \(k\)-th left eigenvector, \({\bf r}_k\) is the \(k\)-th right eigenvector, and \(n\) is <a class="el" href="a00115.html#ae8f6d2fd6490d3153cb4133bf183a404">HyPar::nvars</a>. The final interpolated function is computed from the interpolated characteristic quantities as: </p>
<p class="formulaDsp">
\begin{equation} \hat{\bf f}_{j+1/2} = \sum_{k=1}^n \alpha^k_{j+1/2} {\bf r}_k \end{equation}
</p>
<p><b>Implementation</b> <b>Notes:</b> </p>
<ul>
<li>This method assumes a uniform grid in the spatial dimension corresponding to the interpolation.</li>
<li>The method described above corresponds to a left-biased interpolation. The corresponding right-biased interpolation can be obtained by reflecting the equations about interface j+1/2.</li>
<li><p class="startli">The left and right eigenvectors are computed at an averaged quantity at j+1/2. Thus, this function requires functions to compute the average state, and the left and right eigenvectors. These are provided by the physical model through</p>
<ul>
<li><a class="el" href="a00115.html#a8c603c73be1f08e408a1de94a088da7b">HyPar::GetLeftEigenvectors()</a></li>
<li><a class="el" href="a00115.html#a22eef349f191a1aa267e14b08140c823">HyPar::GetRightEigenvectors()</a></li>
<li><a class="el" href="a00115.html#a7331366d789b2995436accbc35e1cc80">HyPar::AveragingFunction()</a></li>
</ul>
<p class="startli">If these functions are not provided by the physical model, then a characteristic-based interpolation cannot be used.</p>
</li>
<li>The function computes the interpolant for the entire grid in one call. It loops over all the grid lines along the interpolation direction and carries out the 1D interpolation along these grid lines.</li>
<li>Location of cell-centers and cell interfaces along the spatial dimension of the interpolation is shown in the following figure: <div class="image">
<img src="chap1_1Ddomain.png" alt="chap1_1Ddomain.png"/>
</div>
 </li>
</ul>
<p><b>Function</b> <b>arguments:</b> </p>
<table class="doxtable">
<tr>
<th>Argument </th><th>Type </th><th>Explanation  </th></tr>
<tr>
<td>fI </td><td>double* </td><td>Array to hold the computed interpolant at the grid interfaces. This array must have the same layout as the solution, but with <b>no</b> <b>ghost</b> <b>points</b>. Its size should be the same as u in all dimensions, except dir (the dimension along which to interpolate) along which it should be larger by 1 (number of interfaces is 1 more than the number of interior cell centers). </td></tr>
<tr>
<td>fC </td><td>double* </td><td>Array with the cell-centered values of the flux function \({\bf f}\left({\bf u}\right)\). This array must have the same layout and size as the solution, <b>with</b> <b>ghost</b> <b>points</b>. </td></tr>
<tr>
<td>u </td><td>double* </td><td>The solution array \({\bf u}\) (with ghost points). If the interpolation is characteristic based, this is needed to compute the eigendecomposition. For a multidimensional problem, the layout is as follows: u is a contiguous 1D array of size (nvars*dim[0]*dim[1]*...*dim[D-1]) corresponding to the multi-dimensional solution, with the following ordering - nvars, dim[0], dim[1], ..., dim[D-1], where nvars is the number of solution components (<a class="el" href="a00115.html#ae8f6d2fd6490d3153cb4133bf183a404">HyPar::nvars</a>), dim is the local size (<a class="el" href="a00115.html#a38e0371f331cecbe63a77fa03e202afe">HyPar::dim_local</a>), D is the number of spatial dimensions. </td></tr>
<tr>
<td>x </td><td>double* </td><td>The grid array (with ghost points). This is used only by non-uniform-grid interpolation methods. For multidimensional problems, the layout is as follows: x is a contiguous 1D array of size (dim[0]+dim[1]+...+dim[D-1]), with the spatial coordinates along dim[0] stored from 0,...,dim[0]-1, the spatial coordinates along dim[1] stored along dim[0],...,dim[0]+dim[1]-1, and so forth. </td></tr>
<tr>
<td>upw </td><td>int </td><td>Upwinding direction: if positive, a left-biased interpolant will be computed; if negative, a right-biased interpolant will be computed. If the interpolation method is central, then this has no effect. </td></tr>
<tr>
<td>dir </td><td>int </td><td>Spatial dimension along which to interpolate (eg: 0 for 1D; 0 or 1 for 2D; 0,1 or 2 for 3D) </td></tr>
<tr>
<td>s </td><td>void* </td><td>Solver object of type <a class="el" href="a00115.html" title="Structure containing all solver-specific variables and functions. ">HyPar</a>: the following variables are needed - <a class="el" href="a00115.html#aafc992b5fa79d5a4036024615d03bce6">HyPar::ghosts</a>, <a class="el" href="a00115.html#a484873c74138512e41bc50d17b7d955a">HyPar::ndims</a>, <a class="el" href="a00115.html#ae8f6d2fd6490d3153cb4133bf183a404">HyPar::nvars</a>, <a class="el" href="a00115.html#a38e0371f331cecbe63a77fa03e202afe">HyPar::dim_local</a>. </td></tr>
<tr>
<td>m </td><td>void* </td><td>MPI object of type <a class="el" href="a00117.html#a00516" title="Structure of MPI-related variables. ">MPIVariables</a>: this is needed only by compact interpolation method that need to solve a global implicit system across MPI ranks. </td></tr>
<tr>
<td>uflag </td><td>int </td><td>A flag indicating if the function being interpolated \({\bf f}\) is the solution itself \({\bf u}\) (if 1, \({\bf f}\left({\bf u}\right) \equiv {\bf u}\)). </td></tr>
</table>
<p>Reference:</p>
<ul>
<li>van Leer, B. (1979), Towards the Ultimate Conservative Difference Scheme, V. A Second Order Sequel to Godunov's Method, J. Com. Phys., 32, 101136.</li>
<li>Nessyahu, H. and E. Tadmor (1990), Non-oscillatory central differencing for hyperbolic conservation laws, J. Comput. Phys., 87, 408463. </li>
</ul>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">fI</td><td>Array of interpolated function values at the interfaces </td></tr>
    <tr><td class="paramname">fC</td><td>Array of cell-centered values of the function \({\bf f}\left({\bf u}\right)\) </td></tr>
    <tr><td class="paramname">u</td><td>Array of cell-centered values of the solution \({\bf u}\) </td></tr>
    <tr><td class="paramname">x</td><td>Grid coordinates </td></tr>
    <tr><td class="paramname">upw</td><td>Upwind direction (left or right biased) </td></tr>
    <tr><td class="paramname">dir</td><td>Spatial dimension along which to interpolation </td></tr>
    <tr><td class="paramname">s</td><td>Object of type <a class="el" href="a00115.html" title="Structure containing all solver-specific variables and functions. ">HyPar</a> containing solver-related variables </td></tr>
    <tr><td class="paramname">m</td><td>Object of type <a class="el" href="a00117.html#a00516" title="Structure of MPI-related variables. ">MPIVariables</a> containing MPI-related variables </td></tr>
    <tr><td class="paramname">uflag</td><td>Flag to indicate if \(f(u) \equiv u\), i.e, if the solution is being reconstructed </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="a00237_source.html#l00091">91</a> of file <a class="el" href="a00237_source.html">Interp1PrimSecondOrderMUSCLChar.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;{</div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;  <a class="code" href="a00115.html">HyPar</a>             *solver = (<a class="code" href="a00115.html">HyPar</a>*) s;</div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;  <a class="code" href="a00118.html">MUSCLParameters</a>   *muscl   = (<a class="code" href="a00118.html">MUSCLParameters</a>*) solver-&gt;<a class="code" href="a00115.html#a29c46b81ad574e4dfbad5a7211487dcb">interp</a>;</div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;  <span class="keywordtype">int</span>               i, k, v;</div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;  <a class="code" href="a00137.html#a68f50121fb9a7daeaf60e50cdef82ef3">_DECLARE_IERR_</a>;</div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;</div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;  <span class="keywordtype">int</span> ghosts = solver-&gt;<a class="code" href="a00115.html#aafc992b5fa79d5a4036024615d03bce6">ghosts</a>;</div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;  <span class="keywordtype">int</span> ndims  = solver-&gt;<a class="code" href="a00115.html#a484873c74138512e41bc50d17b7d955a">ndims</a>;</div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;  <span class="keywordtype">int</span> nvars  = solver-&gt;<a class="code" href="a00115.html#ae8f6d2fd6490d3153cb4133bf183a404">nvars</a>;</div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;  <span class="keywordtype">int</span> *dim   = solver-&gt;<a class="code" href="a00115.html#a38e0371f331cecbe63a77fa03e202afe">dim_local</a>;</div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;</div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;  <span class="comment">/* define some constants */</span></div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;  <span class="keywordtype">double</span> one_third = 1.0/3.0;</div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;  <span class="keywordtype">double</span> one_sixth = 1.0/6.0;</div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;</div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;  <span class="comment">/* create index and bounds for the outer loop, i.e., to loop over all 1D lines along</span></div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;<span class="comment">     dimension &quot;dir&quot;                                                                    */</span></div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;  <span class="keywordtype">int</span> indexC[ndims], indexI[ndims], index_outer[ndims], bounds_outer[ndims], bounds_inter[ndims];</div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;  <a class="code" href="a00136.html#a89e8330d9e06dd0666c50833628a125c">_ArrayCopy1D_</a>(dim,bounds_outer,ndims); bounds_outer[dir] =  1;</div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;  <a class="code" href="a00136.html#a89e8330d9e06dd0666c50833628a125c">_ArrayCopy1D_</a>(dim,bounds_inter,ndims); bounds_inter[dir] += 1;</div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;  <span class="keywordtype">int</span> N_outer; <a class="code" href="a00136.html#abc65e9c6a51b875f46fdb054a0ecf604">_ArrayProduct1D_</a>(bounds_outer,ndims,N_outer);</div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;</div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;  <span class="comment">/* allocate arrays for the averaged state, eigenvectors and characteristic interpolated f */</span></div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;  <span class="keywordtype">double</span> R[nvars*nvars], L[nvars*nvars], uavg[nvars], fchar[nvars];</div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;</div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;  <span class="keywordflow">if</span> (upw &gt; 0) {</div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;<span class="preprocessor">#pragma omp parallel for schedule(auto) default(shared) private(i,k,v,R,L,uavg,fchar,index_outer,indexC,indexI)</span></div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;<span class="preprocessor"></span>    <span class="keywordflow">for</span> (i=0; i&lt;N_outer; i++) {</div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;      <a class="code" href="a00136.html#a03f49e4d44ae8aca85cb04cfe91e4ce4">_ArrayIndexnD_</a>(ndims,i,bounds_outer,index_outer,0);</div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;      <a class="code" href="a00136.html#a89e8330d9e06dd0666c50833628a125c">_ArrayCopy1D_</a>(index_outer,indexC,ndims);</div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;      <a class="code" href="a00136.html#a89e8330d9e06dd0666c50833628a125c">_ArrayCopy1D_</a>(index_outer,indexI,ndims);</div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;</div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;      <span class="keywordflow">for</span> (indexI[dir] = 0; indexI[dir] &lt; dim[dir]+1; indexI[dir]++) {</div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;</div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;        <span class="comment">/* 1D indices of the stencil grid points */</span></div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;        <span class="keywordtype">int</span> qm1,qm2,qp1;</div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;        indexC[dir] = indexI[dir]-2; <a class="code" href="a00136.html#afbb862a2fdf5b72b1f9ace42f64b556f">_ArrayIndex1D_</a>(ndims,dim,indexC,ghosts,qm2);</div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;        indexC[dir] = indexI[dir]-1; <a class="code" href="a00136.html#afbb862a2fdf5b72b1f9ace42f64b556f">_ArrayIndex1D_</a>(ndims,dim,indexC,ghosts,qm1);</div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;        indexC[dir] = indexI[dir]  ; <a class="code" href="a00136.html#afbb862a2fdf5b72b1f9ace42f64b556f">_ArrayIndex1D_</a>(ndims,dim,indexC,ghosts,qp1);</div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;</div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;        <span class="keywordtype">int</span> p; <span class="comment">/* 1D index of the interface */</span></div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;        <a class="code" href="a00136.html#afbb862a2fdf5b72b1f9ace42f64b556f">_ArrayIndex1D_</a>(ndims,bounds_inter,indexI,0,p);</div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;</div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;        <span class="comment">/* find averaged state at this interface */</span></div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;        <a class="code" href="a00137.html#ad6ab74942c9de13cf0b4c12eb0d91780">IERR</a> solver-&gt;<a class="code" href="a00115.html#a7331366d789b2995436accbc35e1cc80">AveragingFunction</a>(uavg,&amp;u[nvars*qm1],&amp;u[nvars*qp1],solver-&gt;<a class="code" href="a00115.html#a48e81a1806b5774943fd9a26e9a190f2">physics</a>);</div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;        <a class="code" href="a00137.html#add9cf96ae374934d245a1dc1ab697a42">CHECKERR</a>(ierr);</div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;</div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;        <span class="comment">/* Get the left and right eigenvectors */</span></div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;        <a class="code" href="a00137.html#ad6ab74942c9de13cf0b4c12eb0d91780">IERR</a> solver-&gt;<a class="code" href="a00115.html#a8c603c73be1f08e408a1de94a088da7b">GetLeftEigenvectors</a>  (uavg,L,solver-&gt;<a class="code" href="a00115.html#a48e81a1806b5774943fd9a26e9a190f2">physics</a>,dir); <a class="code" href="a00137.html#add9cf96ae374934d245a1dc1ab697a42">CHECKERR</a>(ierr);</div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;        <a class="code" href="a00137.html#ad6ab74942c9de13cf0b4c12eb0d91780">IERR</a> solver-&gt;<a class="code" href="a00115.html#a22eef349f191a1aa267e14b08140c823">GetRightEigenvectors</a> (uavg,R,solver-&gt;<a class="code" href="a00115.html#a48e81a1806b5774943fd9a26e9a190f2">physics</a>,dir); <a class="code" href="a00137.html#add9cf96ae374934d245a1dc1ab697a42">CHECKERR</a>(ierr);</div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;</div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;        <span class="comment">/* For each characteristic field */</span></div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;        <span class="keywordflow">for</span> (v = 0; v &lt; nvars; v++) {</div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;          <span class="comment">/* calculate the characteristic flux components along this characteristic */</span></div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;          <span class="keywordtype">double</span> m2, m1, p1;</div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;          m2 = m1 = p1 = 0;</div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;          <span class="keywordflow">for</span> (k = 0; k &lt; nvars; k++) {</div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;            m2 += L[v*nvars+k] * fC[qm2*nvars+k];</div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;            m1 += L[v*nvars+k] * fC[qm1*nvars+k];</div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;            p1 += L[v*nvars+k] * fC[qp1*nvars+k];</div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;          }</div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;</div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;          <span class="keywordtype">double</span> slope_ratio = (m1 - m2) / ((p1 - m1) + 1e-40);</div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;          <span class="keywordtype">double</span> phi = muscl-&gt;<a class="code" href="a00118.html#af0d0dd685b67f7e293e616cbfc1ccce6">LimiterFunction</a>(slope_ratio);</div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;          fchar[v] = m1 + 0.5 * phi * (p1-m1);</div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;        }</div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;</div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;        <span class="comment">/* calculate the interface u from the characteristic u */</span></div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;        <a class="code" href="a00137.html#ad6ab74942c9de13cf0b4c12eb0d91780">IERR</a> <a class="code" href="a00147.html#a3dc53d4eb4ba0f2cfed00aa69617ee84">MatVecMult</a>(nvars,(fI+nvars*p),R,fchar); <a class="code" href="a00137.html#add9cf96ae374934d245a1dc1ab697a42">CHECKERR</a>(ierr);</div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;      }</div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;    }</div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;  } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;<span class="preprocessor">#pragma omp parallel for schedule(auto) default(shared) private(i,k,v,R,L,uavg,fchar,index_outer,indexC,indexI)</span></div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;<span class="preprocessor"></span>    <span class="keywordflow">for</span> (i=0; i&lt;N_outer; i++) {</div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;      <a class="code" href="a00136.html#a03f49e4d44ae8aca85cb04cfe91e4ce4">_ArrayIndexnD_</a>(ndims,i,bounds_outer,index_outer,0);</div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;      <a class="code" href="a00136.html#a89e8330d9e06dd0666c50833628a125c">_ArrayCopy1D_</a>(index_outer,indexC,ndims);</div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;      <a class="code" href="a00136.html#a89e8330d9e06dd0666c50833628a125c">_ArrayCopy1D_</a>(index_outer,indexI,ndims);</div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;</div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;      <span class="keywordflow">for</span> (indexI[dir] = 0; indexI[dir] &lt; dim[dir]+1; indexI[dir]++) {</div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;</div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;        <span class="comment">/* 1D indices of the stencil grid points */</span></div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;        <span class="keywordtype">int</span> qm1,qp1,qp2;</div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;        indexC[dir] = indexI[dir]-1; <a class="code" href="a00136.html#afbb862a2fdf5b72b1f9ace42f64b556f">_ArrayIndex1D_</a>(ndims,dim,indexC,ghosts,qm1);</div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;        indexC[dir] = indexI[dir]  ; <a class="code" href="a00136.html#afbb862a2fdf5b72b1f9ace42f64b556f">_ArrayIndex1D_</a>(ndims,dim,indexC,ghosts,qp1);</div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;        indexC[dir] = indexI[dir]+1; <a class="code" href="a00136.html#afbb862a2fdf5b72b1f9ace42f64b556f">_ArrayIndex1D_</a>(ndims,dim,indexC,ghosts,qp2);</div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;</div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;        <span class="keywordtype">int</span> p; <span class="comment">/* 1D index of the interface */</span></div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;        <a class="code" href="a00136.html#afbb862a2fdf5b72b1f9ace42f64b556f">_ArrayIndex1D_</a>(ndims,bounds_inter,indexI,0,p);</div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;</div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;        <span class="comment">/* find averaged state at this interface */</span></div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;        <a class="code" href="a00137.html#ad6ab74942c9de13cf0b4c12eb0d91780">IERR</a> solver-&gt;<a class="code" href="a00115.html#a7331366d789b2995436accbc35e1cc80">AveragingFunction</a>(uavg,&amp;u[nvars*qm1],&amp;u[nvars*qp1],solver-&gt;<a class="code" href="a00115.html#a48e81a1806b5774943fd9a26e9a190f2">physics</a>);</div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;        <a class="code" href="a00137.html#add9cf96ae374934d245a1dc1ab697a42">CHECKERR</a>(ierr);</div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;</div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;        <span class="comment">/* Get the left and right eigenvectors */</span></div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;        <a class="code" href="a00137.html#ad6ab74942c9de13cf0b4c12eb0d91780">IERR</a> solver-&gt;<a class="code" href="a00115.html#a8c603c73be1f08e408a1de94a088da7b">GetLeftEigenvectors</a>  (uavg,L,solver-&gt;<a class="code" href="a00115.html#a48e81a1806b5774943fd9a26e9a190f2">physics</a>,dir); <a class="code" href="a00137.html#add9cf96ae374934d245a1dc1ab697a42">CHECKERR</a>(ierr);</div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;        <a class="code" href="a00137.html#ad6ab74942c9de13cf0b4c12eb0d91780">IERR</a> solver-&gt;<a class="code" href="a00115.html#a22eef349f191a1aa267e14b08140c823">GetRightEigenvectors</a> (uavg,R,solver-&gt;<a class="code" href="a00115.html#a48e81a1806b5774943fd9a26e9a190f2">physics</a>,dir); <a class="code" href="a00137.html#add9cf96ae374934d245a1dc1ab697a42">CHECKERR</a>(ierr);</div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;</div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;        <span class="comment">/* For each characteristic field */</span></div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;        <span class="keywordflow">for</span> (v = 0; v &lt; nvars; v++) {</div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;          <span class="comment">/* calculate the characteristic flux components along this characteristic */</span></div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;          <span class="keywordtype">double</span> m1, p1, p2;</div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;          m1 = p1 = p2 = 0;</div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;          <span class="keywordflow">for</span> (k = 0; k &lt; nvars; k++) {</div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;            m1 += L[v*nvars+k] * fC[qm1*nvars+k];</div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;            p1 += L[v*nvars+k] * fC[qp1*nvars+k];</div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;            p2 += L[v*nvars+k] * fC[qp2*nvars+k];</div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;          }</div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;</div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;          <span class="keywordtype">double</span> slope_ratio = (p1 - m1) / ((p2 - p1) + 1e-40);</div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;          <span class="keywordtype">double</span> phi = muscl-&gt;<a class="code" href="a00118.html#af0d0dd685b67f7e293e616cbfc1ccce6">LimiterFunction</a>(slope_ratio);</div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;          fchar[v] = p1 + 0.5 * phi * (p1-p2);</div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;        }</div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;</div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;        <span class="comment">/* calculate the interface u from the characteristic u */</span></div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;        <a class="code" href="a00137.html#ad6ab74942c9de13cf0b4c12eb0d91780">IERR</a> <a class="code" href="a00147.html#a3dc53d4eb4ba0f2cfed00aa69617ee84">MatVecMult</a>(nvars,(fI+nvars*p),R,fchar); <a class="code" href="a00137.html#add9cf96ae374934d245a1dc1ab697a42">CHECKERR</a>(ierr);</div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;      }</div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;    }</div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;  }</div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;</div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;  <span class="keywordflow">return</span>(0);</div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;}</div>
<div class="ttc" id="a00115_html_a484873c74138512e41bc50d17b7d955a"><div class="ttname"><a href="a00115.html#a484873c74138512e41bc50d17b7d955a">HyPar::ndims</a></div><div class="ttdeci">int ndims</div><div class="ttdef"><b>Definition:</b> <a href="a00143_source.html#l00026">hypar.h:26</a></div></div>
<div class="ttc" id="a00115_html_aafc992b5fa79d5a4036024615d03bce6"><div class="ttname"><a href="a00115.html#aafc992b5fa79d5a4036024615d03bce6">HyPar::ghosts</a></div><div class="ttdeci">int ghosts</div><div class="ttdef"><b>Definition:</b> <a href="a00143_source.html#l00044">hypar.h:44</a></div></div>
<div class="ttc" id="a00115_html"><div class="ttname"><a href="a00115.html">HyPar</a></div><div class="ttdoc">Structure containing all solver-specific variables and functions. </div><div class="ttdef"><b>Definition:</b> <a href="a00143_source.html#l00023">hypar.h:23</a></div></div>
<div class="ttc" id="a00137_html_ad6ab74942c9de13cf0b4c12eb0d91780"><div class="ttname"><a href="a00137.html#ad6ab74942c9de13cf0b4c12eb0d91780">IERR</a></div><div class="ttdeci">#define IERR</div><div class="ttdef"><b>Definition:</b> <a href="a00137_source.html#l00012">basic.h:12</a></div></div>
<div class="ttc" id="a00115_html_a8c603c73be1f08e408a1de94a088da7b"><div class="ttname"><a href="a00115.html#a8c603c73be1f08e408a1de94a088da7b">HyPar::GetLeftEigenvectors</a></div><div class="ttdeci">int(* GetLeftEigenvectors)(double *, double *, void *, int)</div><div class="ttdef"><b>Definition:</b> <a href="a00143_source.html#l00321">hypar.h:321</a></div></div>
<div class="ttc" id="a00118_html"><div class="ttname"><a href="a00118.html">MUSCLParameters</a></div><div class="ttdoc">Structure of variables/parameters needed by the MUSCL scheme. </div><div class="ttdef"><b>Definition:</b> <a href="a00105_source.html#l00156">interpolation.h:156</a></div></div>
<div class="ttc" id="a00115_html_ae8f6d2fd6490d3153cb4133bf183a404"><div class="ttname"><a href="a00115.html#ae8f6d2fd6490d3153cb4133bf183a404">HyPar::nvars</a></div><div class="ttdeci">int nvars</div><div class="ttdef"><b>Definition:</b> <a href="a00143_source.html#l00029">hypar.h:29</a></div></div>
<div class="ttc" id="a00136_html_a89e8330d9e06dd0666c50833628a125c"><div class="ttname"><a href="a00136.html#a89e8330d9e06dd0666c50833628a125c">_ArrayCopy1D_</a></div><div class="ttdeci">#define _ArrayCopy1D_(x, y, size)</div><div class="ttdef"><b>Definition:</b> <a href="a00136_source.html#l00318">arrayfunctions.h:318</a></div></div>
<div class="ttc" id="a00115_html_a38e0371f331cecbe63a77fa03e202afe"><div class="ttname"><a href="a00115.html#a38e0371f331cecbe63a77fa03e202afe">HyPar::dim_local</a></div><div class="ttdeci">int * dim_local</div><div class="ttdef"><b>Definition:</b> <a href="a00143_source.html#l00035">hypar.h:35</a></div></div>
<div class="ttc" id="a00115_html_a22eef349f191a1aa267e14b08140c823"><div class="ttname"><a href="a00115.html#a22eef349f191a1aa267e14b08140c823">HyPar::GetRightEigenvectors</a></div><div class="ttdeci">int(* GetRightEigenvectors)(double *, double *, void *, int)</div><div class="ttdef"><b>Definition:</b> <a href="a00143_source.html#l00323">hypar.h:323</a></div></div>
<div class="ttc" id="a00137_html_add9cf96ae374934d245a1dc1ab697a42"><div class="ttname"><a href="a00137.html#add9cf96ae374934d245a1dc1ab697a42">CHECKERR</a></div><div class="ttdeci">#define CHECKERR(ierr)</div><div class="ttdef"><b>Definition:</b> <a href="a00137_source.html#l00014">basic.h:14</a></div></div>
<div class="ttc" id="a00136_html_a03f49e4d44ae8aca85cb04cfe91e4ce4"><div class="ttname"><a href="a00136.html#a03f49e4d44ae8aca85cb04cfe91e4ce4">_ArrayIndexnD_</a></div><div class="ttdeci">#define _ArrayIndexnD_(N, index, imax, i, ghost)</div><div class="ttdef"><b>Definition:</b> <a href="a00136_source.html#l00020">arrayfunctions.h:20</a></div></div>
<div class="ttc" id="a00115_html_a29c46b81ad574e4dfbad5a7211487dcb"><div class="ttname"><a href="a00115.html#a29c46b81ad574e4dfbad5a7211487dcb">HyPar::interp</a></div><div class="ttdeci">void * interp</div><div class="ttdef"><b>Definition:</b> <a href="a00143_source.html#l00326">hypar.h:326</a></div></div>
<div class="ttc" id="a00136_html_abc65e9c6a51b875f46fdb054a0ecf604"><div class="ttname"><a href="a00136.html#abc65e9c6a51b875f46fdb054a0ecf604">_ArrayProduct1D_</a></div><div class="ttdeci">#define _ArrayProduct1D_(x, size, p)</div><div class="ttdef"><b>Definition:</b> <a href="a00136_source.html#l00376">arrayfunctions.h:376</a></div></div>
<div class="ttc" id="a00115_html_a7331366d789b2995436accbc35e1cc80"><div class="ttname"><a href="a00115.html#a7331366d789b2995436accbc35e1cc80">HyPar::AveragingFunction</a></div><div class="ttdeci">int(* AveragingFunction)(double *, double *, double *, void *)</div><div class="ttdef"><b>Definition:</b> <a href="a00143_source.html#l00318">hypar.h:318</a></div></div>
<div class="ttc" id="a00136_html_afbb862a2fdf5b72b1f9ace42f64b556f"><div class="ttname"><a href="a00136.html#afbb862a2fdf5b72b1f9ace42f64b556f">_ArrayIndex1D_</a></div><div class="ttdeci">#define _ArrayIndex1D_(N, imax, i, ghost, index)</div><div class="ttdef"><b>Definition:</b> <a href="a00136_source.html#l00039">arrayfunctions.h:39</a></div></div>
<div class="ttc" id="a00147_html_a3dc53d4eb4ba0f2cfed00aa69617ee84"><div class="ttname"><a href="a00147.html#a3dc53d4eb4ba0f2cfed00aa69617ee84">MatVecMult</a></div><div class="ttdeci">#define MatVecMult(N, y, A, x)</div><div class="ttdef"><b>Definition:</b> <a href="a00147_source.html#l00162">mathfunctions.h:162</a></div></div>
<div class="ttc" id="a00118_html_af0d0dd685b67f7e293e616cbfc1ccce6"><div class="ttname"><a href="a00118.html#af0d0dd685b67f7e293e616cbfc1ccce6">MUSCLParameters::LimiterFunction</a></div><div class="ttdeci">double(* LimiterFunction)(double)</div><div class="ttdef"><b>Definition:</b> <a href="a00105_source.html#l00162">interpolation.h:162</a></div></div>
<div class="ttc" id="a00137_html_a68f50121fb9a7daeaf60e50cdef82ef3"><div class="ttname"><a href="a00137.html#a68f50121fb9a7daeaf60e50cdef82ef3">_DECLARE_IERR_</a></div><div class="ttdeci">#define _DECLARE_IERR_</div><div class="ttdef"><b>Definition:</b> <a href="a00137_source.html#l00013">basic.h:13</a></div></div>
<div class="ttc" id="a00115_html_a48e81a1806b5774943fd9a26e9a190f2"><div class="ttname"><a href="a00115.html#a48e81a1806b5774943fd9a26e9a190f2">HyPar::physics</a></div><div class="ttdeci">void * physics</div><div class="ttdef"><b>Definition:</b> <a href="a00143_source.html#l00245">hypar.h:245</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a985d08c4fb9bcb71875c697f9e00d6eb"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int Interp1PrimThirdOrderMUSCLChar </td>
          <td>(</td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>fI</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>fC</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>u</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>upw</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>dir</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>s</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>m</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>uflag</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>3rd order MUSCL scheme with Koren's limiter (characteristic-based) on a uniform grid </p>
<p>Characteristic-based interpolation of the first primitive at the cell interfaces using the third-order MUSCL scheme</p>
<p>Computes the interpolated values of the first primitive of a function \({\bf f}\left({\bf u}\right)\) at the interfaces from the cell-centered values of the function using the 3rd order MUSCL scheme with Koren's limiter on a uniform grid. The first primitive is defined as a function \({\bf h}\left({\bf u}\right)\) that satisfies: </p>
<p class="formulaDsp">
\begin{equation} {\bf f}\left({\bf u}\left(x\right)\right) = \frac{1}{\Delta x} \int_{x-\Delta x/2}^{x+\Delta x/2} {\bf h}\left({\bf u}\left(\zeta\right)\right)d\zeta, \end{equation}
</p>
<p> where \(x\) is the spatial coordinate along the dimension of the interpolation. This function computes numerical approximation \(\hat{\bf f}_{j+1/2} \approx {\bf h}_{j+1/2}\) as: using the 3rd order MUSCL scheme with Koren's limiter as follows: </p>
<p class="formulaDsp">
\begin{equation} \hat{\alpha}^k_{j+1/2} = {\alpha}^k_{j-1} + \phi \left[\frac{1}{3}\left({\alpha}^k_j-{\alpha}^k_{j-1}\right) + \frac{1}{6}\left({\alpha}^k_{j-1}-{\alpha}^k_{j-2}\right)\right] \end{equation}
</p>
<p> where </p>
<p class="formulaDsp">
\begin{equation} \phi = \frac {3\left({\alpha}^k_j-{\alpha}^k_{j-1}\right)\left({\alpha}^k_{j-1}-{\alpha}^k_{j-2}\right) + \epsilon} {2\left[\left({\alpha}^k_j-{\alpha}^k_{j-1}\right)-\left({\alpha}^k_{j-1}-{\alpha}^k_{j-2}\right)\right]^2 + 3\left({\alpha}^k_j-{\alpha}^k_{j-1}\right)\left({\alpha}^k_{j-1}-{\alpha}^k_{j-2}\right) + \epsilon}, \end{equation}
</p>
<p> \(\epsilon\) is a small constant (typically \(10^{-3}\)), and </p>
<p class="formulaDsp">
\begin{equation} \alpha^k = {\bf l}_k \cdot {\bf f},\ k=1,\cdots,n \end{equation}
</p>
<p> is the \(k\)-th characteristic quantity, and \({\bf l}_k\) is the \(k\)-th left eigenvector, \({\bf r}_k\) is the \(k\)-th right eigenvector, and \(n\) is <a class="el" href="a00115.html#ae8f6d2fd6490d3153cb4133bf183a404">HyPar::nvars</a>. The final interpolated function is computed from the interpolated characteristic quantities as: </p>
<p class="formulaDsp">
\begin{equation} \hat{\bf f}_{j+1/2} = \sum_{k=1}^n \alpha^k_{j+1/2} {\bf r}_k \end{equation}
</p>
<p><b>Implementation</b> <b>Notes:</b> </p>
<ul>
<li>This method assumes a uniform grid in the spatial dimension corresponding to the interpolation.</li>
<li>The method described above corresponds to a left-biased interpolation. The corresponding right-biased interpolation can be obtained by reflecting the equations about interface j+1/2.</li>
<li><p class="startli">The left and right eigenvectors are computed at an averaged quantity at j+1/2. Thus, this function requires functions to compute the average state, and the left and right eigenvectors. These are provided by the physical model through</p>
<ul>
<li><a class="el" href="a00115.html#a8c603c73be1f08e408a1de94a088da7b">HyPar::GetLeftEigenvectors()</a></li>
<li><a class="el" href="a00115.html#a22eef349f191a1aa267e14b08140c823">HyPar::GetRightEigenvectors()</a></li>
<li><a class="el" href="a00115.html#a7331366d789b2995436accbc35e1cc80">HyPar::AveragingFunction()</a></li>
</ul>
<p class="startli">If these functions are not provided by the physical model, then a characteristic-based interpolation cannot be used.</p>
</li>
<li>The function computes the interpolant for the entire grid in one call. It loops over all the grid lines along the interpolation direction and carries out the 1D interpolation along these grid lines.</li>
<li>Location of cell-centers and cell interfaces along the spatial dimension of the interpolation is shown in the following figure: <div class="image">
<img src="chap1_1Ddomain.png" alt="chap1_1Ddomain.png"/>
</div>
 </li>
</ul>
<p><b>Function</b> <b>arguments:</b> </p>
<table class="doxtable">
<tr>
<th>Argument </th><th>Type </th><th>Explanation  </th></tr>
<tr>
<td>fI </td><td>double* </td><td>Array to hold the computed interpolant at the grid interfaces. This array must have the same layout as the solution, but with <b>no</b> <b>ghost</b> <b>points</b>. Its size should be the same as u in all dimensions, except dir (the dimension along which to interpolate) along which it should be larger by 1 (number of interfaces is 1 more than the number of interior cell centers). </td></tr>
<tr>
<td>fC </td><td>double* </td><td>Array with the cell-centered values of the flux function \({\bf f}\left({\bf u}\right)\). This array must have the same layout and size as the solution, <b>with</b> <b>ghost</b> <b>points</b>. </td></tr>
<tr>
<td>u </td><td>double* </td><td>The solution array \({\bf u}\) (with ghost points). If the interpolation is characteristic based, this is needed to compute the eigendecomposition. For a multidimensional problem, the layout is as follows: u is a contiguous 1D array of size (nvars*dim[0]*dim[1]*...*dim[D-1]) corresponding to the multi-dimensional solution, with the following ordering - nvars, dim[0], dim[1], ..., dim[D-1], where nvars is the number of solution components (<a class="el" href="a00115.html#ae8f6d2fd6490d3153cb4133bf183a404">HyPar::nvars</a>), dim is the local size (<a class="el" href="a00115.html#a38e0371f331cecbe63a77fa03e202afe">HyPar::dim_local</a>), D is the number of spatial dimensions. </td></tr>
<tr>
<td>x </td><td>double* </td><td>The grid array (with ghost points). This is used only by non-uniform-grid interpolation methods. For multidimensional problems, the layout is as follows: x is a contiguous 1D array of size (dim[0]+dim[1]+...+dim[D-1]), with the spatial coordinates along dim[0] stored from 0,...,dim[0]-1, the spatial coordinates along dim[1] stored along dim[0],...,dim[0]+dim[1]-1, and so forth. </td></tr>
<tr>
<td>upw </td><td>int </td><td>Upwinding direction: if positive, a left-biased interpolant will be computed; if negative, a right-biased interpolant will be computed. If the interpolation method is central, then this has no effect. </td></tr>
<tr>
<td>dir </td><td>int </td><td>Spatial dimension along which to interpolate (eg: 0 for 1D; 0 or 1 for 2D; 0,1 or 2 for 3D) </td></tr>
<tr>
<td>s </td><td>void* </td><td>Solver object of type <a class="el" href="a00115.html" title="Structure containing all solver-specific variables and functions. ">HyPar</a>: the following variables are needed - <a class="el" href="a00115.html#aafc992b5fa79d5a4036024615d03bce6">HyPar::ghosts</a>, <a class="el" href="a00115.html#a484873c74138512e41bc50d17b7d955a">HyPar::ndims</a>, <a class="el" href="a00115.html#ae8f6d2fd6490d3153cb4133bf183a404">HyPar::nvars</a>, <a class="el" href="a00115.html#a38e0371f331cecbe63a77fa03e202afe">HyPar::dim_local</a>. </td></tr>
<tr>
<td>m </td><td>void* </td><td>MPI object of type <a class="el" href="a00117.html#a00516" title="Structure of MPI-related variables. ">MPIVariables</a>: this is needed only by compact interpolation method that need to solve a global implicit system across MPI ranks. </td></tr>
<tr>
<td>uflag </td><td>int </td><td>A flag indicating if the function being interpolated \({\bf f}\) is the solution itself \({\bf u}\) (if 1, \({\bf f}\left({\bf u}\right) \equiv {\bf u}\)). </td></tr>
</table>
<p>Reference:</p>
<ul>
<li>van Leer, B., Towards the Ultimate Conservative Difference Scheme. 2: Monotonicity and Conservation Combined in a Second-Order Scheme, J. of Comput. Phys., 14 (4), 1974, pp.361-370, <a href="http://dx.doi.org/10.1016/0021-9991(74)90019-9">http://dx.doi.org/10.1016/0021-9991(74)90019-9</a></li>
<li>Koren, B., A Robust Upwind Discretization Method for Advection, Diffusion and Source Terms, Centrum voor Wiskunde en Informatica, Amsterdam, 1993 </li>
</ul>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">fI</td><td>Array of interpolated function values at the interfaces </td></tr>
    <tr><td class="paramname">fC</td><td>Array of cell-centered values of the function \({\bf f}\left({\bf u}\right)\) </td></tr>
    <tr><td class="paramname">u</td><td>Array of cell-centered values of the solution \({\bf u}\) </td></tr>
    <tr><td class="paramname">x</td><td>Grid coordinates </td></tr>
    <tr><td class="paramname">upw</td><td>Upwind direction (left or right biased) </td></tr>
    <tr><td class="paramname">dir</td><td>Spatial dimension along which to interpolation </td></tr>
    <tr><td class="paramname">s</td><td>Object of type <a class="el" href="a00115.html" title="Structure containing all solver-specific variables and functions. ">HyPar</a> containing solver-related variables </td></tr>
    <tr><td class="paramname">m</td><td>Object of type <a class="el" href="a00117.html#a00516" title="Structure of MPI-related variables. ">MPIVariables</a> containing MPI-related variables </td></tr>
    <tr><td class="paramname">uflag</td><td>Flag to indicate if \(f(u) \equiv u\), i.e, if the solution is being reconstructed </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="a00239_source.html#l00090">90</a> of file <a class="el" href="a00239_source.html">Interp1PrimThirdOrderMUSCLChar.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;{</div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;  <a class="code" href="a00115.html">HyPar</a>             *solver = (<a class="code" href="a00115.html">HyPar</a>*) s;</div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;  <a class="code" href="a00118.html">MUSCLParameters</a>   *muscl   = (<a class="code" href="a00118.html">MUSCLParameters</a>*) solver-&gt;<a class="code" href="a00115.html#a29c46b81ad574e4dfbad5a7211487dcb">interp</a>;</div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;  <span class="keywordtype">int</span>               i, k, v;</div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;  <a class="code" href="a00137.html#a68f50121fb9a7daeaf60e50cdef82ef3">_DECLARE_IERR_</a>;</div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;</div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;  <span class="keywordtype">int</span> ghosts = solver-&gt;<a class="code" href="a00115.html#aafc992b5fa79d5a4036024615d03bce6">ghosts</a>;</div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;  <span class="keywordtype">int</span> ndims  = solver-&gt;<a class="code" href="a00115.html#a484873c74138512e41bc50d17b7d955a">ndims</a>;</div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;  <span class="keywordtype">int</span> nvars  = solver-&gt;<a class="code" href="a00115.html#ae8f6d2fd6490d3153cb4133bf183a404">nvars</a>;</div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;  <span class="keywordtype">int</span> *dim   = solver-&gt;<a class="code" href="a00115.html#a38e0371f331cecbe63a77fa03e202afe">dim_local</a>;</div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;</div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;  <span class="comment">/* define some constants */</span></div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;  <span class="keywordtype">double</span> one_third = 1.0/3.0;</div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;  <span class="keywordtype">double</span> one_sixth = 1.0/6.0;</div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;</div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;  <span class="comment">/* create index and bounds for the outer loop, i.e., to loop over all 1D lines along</span></div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;<span class="comment">     dimension &quot;dir&quot;                                                                    */</span></div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;  <span class="keywordtype">int</span> indexC[ndims], indexI[ndims], index_outer[ndims], bounds_outer[ndims], bounds_inter[ndims];</div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;  <a class="code" href="a00136.html#a89e8330d9e06dd0666c50833628a125c">_ArrayCopy1D_</a>(dim,bounds_outer,ndims); bounds_outer[dir] =  1;</div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;  <a class="code" href="a00136.html#a89e8330d9e06dd0666c50833628a125c">_ArrayCopy1D_</a>(dim,bounds_inter,ndims); bounds_inter[dir] += 1;</div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;  <span class="keywordtype">int</span> N_outer; <a class="code" href="a00136.html#abc65e9c6a51b875f46fdb054a0ecf604">_ArrayProduct1D_</a>(bounds_outer,ndims,N_outer);</div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;</div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;  <span class="comment">/* allocate arrays for the averaged state, eigenvectors and characteristic interpolated f */</span></div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;  <span class="keywordtype">double</span> R[nvars*nvars], L[nvars*nvars], uavg[nvars], fchar[nvars];</div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;</div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;  <span class="keywordflow">if</span> (upw &gt; 0) {</div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;<span class="preprocessor">#pragma omp parallel for schedule(auto) default(shared) private(i,k,v,R,L,uavg,fchar,index_outer,indexC,indexI)</span></div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;<span class="preprocessor"></span>    <span class="keywordflow">for</span> (i=0; i&lt;N_outer; i++) {</div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;      <a class="code" href="a00136.html#a03f49e4d44ae8aca85cb04cfe91e4ce4">_ArrayIndexnD_</a>(ndims,i,bounds_outer,index_outer,0);</div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;      <a class="code" href="a00136.html#a89e8330d9e06dd0666c50833628a125c">_ArrayCopy1D_</a>(index_outer,indexC,ndims);</div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;      <a class="code" href="a00136.html#a89e8330d9e06dd0666c50833628a125c">_ArrayCopy1D_</a>(index_outer,indexI,ndims);</div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;</div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;      <span class="keywordflow">for</span> (indexI[dir] = 0; indexI[dir] &lt; dim[dir]+1; indexI[dir]++) {</div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;</div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;        <span class="comment">/* 1D indices of the stencil grid points */</span></div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;        <span class="keywordtype">int</span> qm1,qm2,qp1;</div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;        indexC[dir] = indexI[dir]-2; <a class="code" href="a00136.html#afbb862a2fdf5b72b1f9ace42f64b556f">_ArrayIndex1D_</a>(ndims,dim,indexC,ghosts,qm2);</div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;        indexC[dir] = indexI[dir]-1; <a class="code" href="a00136.html#afbb862a2fdf5b72b1f9ace42f64b556f">_ArrayIndex1D_</a>(ndims,dim,indexC,ghosts,qm1);</div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;        indexC[dir] = indexI[dir]  ; <a class="code" href="a00136.html#afbb862a2fdf5b72b1f9ace42f64b556f">_ArrayIndex1D_</a>(ndims,dim,indexC,ghosts,qp1);</div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;</div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;        <span class="keywordtype">int</span> p; <span class="comment">/* 1D index of the interface */</span></div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;        <a class="code" href="a00136.html#afbb862a2fdf5b72b1f9ace42f64b556f">_ArrayIndex1D_</a>(ndims,bounds_inter,indexI,0,p);</div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;</div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;        <span class="comment">/* find averaged state at this interface */</span></div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;        <a class="code" href="a00137.html#ad6ab74942c9de13cf0b4c12eb0d91780">IERR</a> solver-&gt;<a class="code" href="a00115.html#a7331366d789b2995436accbc35e1cc80">AveragingFunction</a>(uavg,&amp;u[nvars*qm1],&amp;u[nvars*qp1],solver-&gt;<a class="code" href="a00115.html#a48e81a1806b5774943fd9a26e9a190f2">physics</a>);</div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;        <a class="code" href="a00137.html#add9cf96ae374934d245a1dc1ab697a42">CHECKERR</a>(ierr);</div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;</div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;        <span class="comment">/* Get the left and right eigenvectors */</span></div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;        <a class="code" href="a00137.html#ad6ab74942c9de13cf0b4c12eb0d91780">IERR</a> solver-&gt;<a class="code" href="a00115.html#a8c603c73be1f08e408a1de94a088da7b">GetLeftEigenvectors</a>  (uavg,L,solver-&gt;<a class="code" href="a00115.html#a48e81a1806b5774943fd9a26e9a190f2">physics</a>,dir); <a class="code" href="a00137.html#add9cf96ae374934d245a1dc1ab697a42">CHECKERR</a>(ierr);</div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;        <a class="code" href="a00137.html#ad6ab74942c9de13cf0b4c12eb0d91780">IERR</a> solver-&gt;<a class="code" href="a00115.html#a22eef349f191a1aa267e14b08140c823">GetRightEigenvectors</a> (uavg,R,solver-&gt;<a class="code" href="a00115.html#a48e81a1806b5774943fd9a26e9a190f2">physics</a>,dir); <a class="code" href="a00137.html#add9cf96ae374934d245a1dc1ab697a42">CHECKERR</a>(ierr);</div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;</div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;        <span class="comment">/* For each characteristic field */</span></div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;        <span class="keywordflow">for</span> (v = 0; v &lt; nvars; v++) {</div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;          <span class="comment">/* calculate the characteristic flux components along this characteristic */</span></div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;          <span class="keywordtype">double</span> m2, m1, p1;</div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;          m2 = m1 = p1 = 0;</div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;          <span class="keywordflow">for</span> (k = 0; k &lt; nvars; k++) {</div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;            m2 += L[v*nvars+k] * fC[qm2*nvars+k];</div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;            m1 += L[v*nvars+k] * fC[qm1*nvars+k];</div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;            p1 += L[v*nvars+k] * fC[qp1*nvars+k];</div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;          }</div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;          <span class="keywordtype">double</span> fdiff = p1 - m1;</div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;          <span class="keywordtype">double</span> bdiff = m1 - m2;</div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;          <span class="keywordtype">double</span> limit =  (3*fdiff*bdiff + muscl-&gt;<a class="code" href="a00118.html#a974b448c3d0a13d483d36ef15de369b5">eps</a>) </div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;                        / (2*(fdiff-bdiff)*(fdiff-bdiff) + 3*fdiff*bdiff + muscl-&gt;<a class="code" href="a00118.html#a974b448c3d0a13d483d36ef15de369b5">eps</a>);</div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;          fchar[v] = m1 +  limit * (one_third*fdiff + one_sixth*bdiff);</div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;        }</div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;</div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;        <span class="comment">/* calculate the interface u from the characteristic u */</span></div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;        <a class="code" href="a00137.html#ad6ab74942c9de13cf0b4c12eb0d91780">IERR</a> <a class="code" href="a00147.html#a3dc53d4eb4ba0f2cfed00aa69617ee84">MatVecMult</a>(nvars,(fI+nvars*p),R,fchar); <a class="code" href="a00137.html#add9cf96ae374934d245a1dc1ab697a42">CHECKERR</a>(ierr);</div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;      }</div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;    }</div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;  } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;<span class="preprocessor">#pragma omp parallel for schedule(auto) default(shared) private(i,k,v,R,L,uavg,fchar,index_outer,indexC,indexI)</span></div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;<span class="preprocessor"></span>    <span class="keywordflow">for</span> (i=0; i&lt;N_outer; i++) {</div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;      <a class="code" href="a00136.html#a03f49e4d44ae8aca85cb04cfe91e4ce4">_ArrayIndexnD_</a>(ndims,i,bounds_outer,index_outer,0);</div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;      <a class="code" href="a00136.html#a89e8330d9e06dd0666c50833628a125c">_ArrayCopy1D_</a>(index_outer,indexC,ndims);</div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;      <a class="code" href="a00136.html#a89e8330d9e06dd0666c50833628a125c">_ArrayCopy1D_</a>(index_outer,indexI,ndims);</div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;</div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;      <span class="keywordflow">for</span> (indexI[dir] = 0; indexI[dir] &lt; dim[dir]+1; indexI[dir]++) {</div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;</div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;        <span class="comment">/* 1D indices of the stencil grid points */</span></div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;        <span class="keywordtype">int</span> qm1,qp1,qp2;</div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;        indexC[dir] = indexI[dir]-1; <a class="code" href="a00136.html#afbb862a2fdf5b72b1f9ace42f64b556f">_ArrayIndex1D_</a>(ndims,dim,indexC,ghosts,qm1);</div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;        indexC[dir] = indexI[dir]  ; <a class="code" href="a00136.html#afbb862a2fdf5b72b1f9ace42f64b556f">_ArrayIndex1D_</a>(ndims,dim,indexC,ghosts,qp1);</div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;        indexC[dir] = indexI[dir]+1; <a class="code" href="a00136.html#afbb862a2fdf5b72b1f9ace42f64b556f">_ArrayIndex1D_</a>(ndims,dim,indexC,ghosts,qp2);</div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;</div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;        <span class="keywordtype">int</span> p; <span class="comment">/* 1D index of the interface */</span></div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;        <a class="code" href="a00136.html#afbb862a2fdf5b72b1f9ace42f64b556f">_ArrayIndex1D_</a>(ndims,bounds_inter,indexI,0,p);</div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;</div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;        <span class="comment">/* find averaged state at this interface */</span></div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;        <a class="code" href="a00137.html#ad6ab74942c9de13cf0b4c12eb0d91780">IERR</a> solver-&gt;<a class="code" href="a00115.html#a7331366d789b2995436accbc35e1cc80">AveragingFunction</a>(uavg,&amp;u[nvars*qm1],&amp;u[nvars*qp1],solver-&gt;<a class="code" href="a00115.html#a48e81a1806b5774943fd9a26e9a190f2">physics</a>);</div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;        <a class="code" href="a00137.html#add9cf96ae374934d245a1dc1ab697a42">CHECKERR</a>(ierr);</div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;</div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;        <span class="comment">/* Get the left and right eigenvectors */</span></div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;        <a class="code" href="a00137.html#ad6ab74942c9de13cf0b4c12eb0d91780">IERR</a> solver-&gt;<a class="code" href="a00115.html#a8c603c73be1f08e408a1de94a088da7b">GetLeftEigenvectors</a>  (uavg,L,solver-&gt;<a class="code" href="a00115.html#a48e81a1806b5774943fd9a26e9a190f2">physics</a>,dir); <a class="code" href="a00137.html#add9cf96ae374934d245a1dc1ab697a42">CHECKERR</a>(ierr);</div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;        <a class="code" href="a00137.html#ad6ab74942c9de13cf0b4c12eb0d91780">IERR</a> solver-&gt;<a class="code" href="a00115.html#a22eef349f191a1aa267e14b08140c823">GetRightEigenvectors</a> (uavg,R,solver-&gt;<a class="code" href="a00115.html#a48e81a1806b5774943fd9a26e9a190f2">physics</a>,dir); <a class="code" href="a00137.html#add9cf96ae374934d245a1dc1ab697a42">CHECKERR</a>(ierr);</div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;</div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;        <span class="comment">/* For each characteristic field */</span></div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;        <span class="keywordflow">for</span> (v = 0; v &lt; nvars; v++) {</div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;          <span class="comment">/* calculate the characteristic flux components along this characteristic */</span></div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;          <span class="keywordtype">double</span> m1, p1, p2;</div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;          m1 = p1 = p2 = 0;</div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;          <span class="keywordflow">for</span> (k = 0; k &lt; nvars; k++) {</div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;            m1 += L[v*nvars+k] * fC[qm1*nvars+k];</div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;            p1 += L[v*nvars+k] * fC[qp1*nvars+k];</div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;            p2 += L[v*nvars+k] * fC[qp2*nvars+k];</div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;          }</div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;          <span class="keywordtype">double</span> fdiff = p2 - p1;</div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;          <span class="keywordtype">double</span> bdiff = p1 - m1;</div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;          <span class="keywordtype">double</span> limit =  (3*fdiff*bdiff + muscl-&gt;<a class="code" href="a00118.html#a974b448c3d0a13d483d36ef15de369b5">eps</a>) </div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;                        / (2*(fdiff-bdiff)*(fdiff-bdiff) + 3*fdiff*bdiff + muscl-&gt;<a class="code" href="a00118.html#a974b448c3d0a13d483d36ef15de369b5">eps</a>);</div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;          fchar[v] = p1 -  limit * (one_third*fdiff + one_sixth*bdiff);</div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;        }</div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;</div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;        <span class="comment">/* calculate the interface u from the characteristic u */</span></div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;        <a class="code" href="a00137.html#ad6ab74942c9de13cf0b4c12eb0d91780">IERR</a> <a class="code" href="a00147.html#a3dc53d4eb4ba0f2cfed00aa69617ee84">MatVecMult</a>(nvars,(fI+nvars*p),R,fchar); <a class="code" href="a00137.html#add9cf96ae374934d245a1dc1ab697a42">CHECKERR</a>(ierr);</div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;      }</div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;    }</div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;  }</div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;</div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;  <span class="keywordflow">return</span>(0);</div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;}</div>
<div class="ttc" id="a00115_html_a484873c74138512e41bc50d17b7d955a"><div class="ttname"><a href="a00115.html#a484873c74138512e41bc50d17b7d955a">HyPar::ndims</a></div><div class="ttdeci">int ndims</div><div class="ttdef"><b>Definition:</b> <a href="a00143_source.html#l00026">hypar.h:26</a></div></div>
<div class="ttc" id="a00115_html_aafc992b5fa79d5a4036024615d03bce6"><div class="ttname"><a href="a00115.html#aafc992b5fa79d5a4036024615d03bce6">HyPar::ghosts</a></div><div class="ttdeci">int ghosts</div><div class="ttdef"><b>Definition:</b> <a href="a00143_source.html#l00044">hypar.h:44</a></div></div>
<div class="ttc" id="a00115_html"><div class="ttname"><a href="a00115.html">HyPar</a></div><div class="ttdoc">Structure containing all solver-specific variables and functions. </div><div class="ttdef"><b>Definition:</b> <a href="a00143_source.html#l00023">hypar.h:23</a></div></div>
<div class="ttc" id="a00137_html_ad6ab74942c9de13cf0b4c12eb0d91780"><div class="ttname"><a href="a00137.html#ad6ab74942c9de13cf0b4c12eb0d91780">IERR</a></div><div class="ttdeci">#define IERR</div><div class="ttdef"><b>Definition:</b> <a href="a00137_source.html#l00012">basic.h:12</a></div></div>
<div class="ttc" id="a00115_html_a8c603c73be1f08e408a1de94a088da7b"><div class="ttname"><a href="a00115.html#a8c603c73be1f08e408a1de94a088da7b">HyPar::GetLeftEigenvectors</a></div><div class="ttdeci">int(* GetLeftEigenvectors)(double *, double *, void *, int)</div><div class="ttdef"><b>Definition:</b> <a href="a00143_source.html#l00321">hypar.h:321</a></div></div>
<div class="ttc" id="a00118_html"><div class="ttname"><a href="a00118.html">MUSCLParameters</a></div><div class="ttdoc">Structure of variables/parameters needed by the MUSCL scheme. </div><div class="ttdef"><b>Definition:</b> <a href="a00105_source.html#l00156">interpolation.h:156</a></div></div>
<div class="ttc" id="a00115_html_ae8f6d2fd6490d3153cb4133bf183a404"><div class="ttname"><a href="a00115.html#ae8f6d2fd6490d3153cb4133bf183a404">HyPar::nvars</a></div><div class="ttdeci">int nvars</div><div class="ttdef"><b>Definition:</b> <a href="a00143_source.html#l00029">hypar.h:29</a></div></div>
<div class="ttc" id="a00136_html_a89e8330d9e06dd0666c50833628a125c"><div class="ttname"><a href="a00136.html#a89e8330d9e06dd0666c50833628a125c">_ArrayCopy1D_</a></div><div class="ttdeci">#define _ArrayCopy1D_(x, y, size)</div><div class="ttdef"><b>Definition:</b> <a href="a00136_source.html#l00318">arrayfunctions.h:318</a></div></div>
<div class="ttc" id="a00115_html_a38e0371f331cecbe63a77fa03e202afe"><div class="ttname"><a href="a00115.html#a38e0371f331cecbe63a77fa03e202afe">HyPar::dim_local</a></div><div class="ttdeci">int * dim_local</div><div class="ttdef"><b>Definition:</b> <a href="a00143_source.html#l00035">hypar.h:35</a></div></div>
<div class="ttc" id="a00115_html_a22eef349f191a1aa267e14b08140c823"><div class="ttname"><a href="a00115.html#a22eef349f191a1aa267e14b08140c823">HyPar::GetRightEigenvectors</a></div><div class="ttdeci">int(* GetRightEigenvectors)(double *, double *, void *, int)</div><div class="ttdef"><b>Definition:</b> <a href="a00143_source.html#l00323">hypar.h:323</a></div></div>
<div class="ttc" id="a00137_html_add9cf96ae374934d245a1dc1ab697a42"><div class="ttname"><a href="a00137.html#add9cf96ae374934d245a1dc1ab697a42">CHECKERR</a></div><div class="ttdeci">#define CHECKERR(ierr)</div><div class="ttdef"><b>Definition:</b> <a href="a00137_source.html#l00014">basic.h:14</a></div></div>
<div class="ttc" id="a00136_html_a03f49e4d44ae8aca85cb04cfe91e4ce4"><div class="ttname"><a href="a00136.html#a03f49e4d44ae8aca85cb04cfe91e4ce4">_ArrayIndexnD_</a></div><div class="ttdeci">#define _ArrayIndexnD_(N, index, imax, i, ghost)</div><div class="ttdef"><b>Definition:</b> <a href="a00136_source.html#l00020">arrayfunctions.h:20</a></div></div>
<div class="ttc" id="a00115_html_a29c46b81ad574e4dfbad5a7211487dcb"><div class="ttname"><a href="a00115.html#a29c46b81ad574e4dfbad5a7211487dcb">HyPar::interp</a></div><div class="ttdeci">void * interp</div><div class="ttdef"><b>Definition:</b> <a href="a00143_source.html#l00326">hypar.h:326</a></div></div>
<div class="ttc" id="a00136_html_abc65e9c6a51b875f46fdb054a0ecf604"><div class="ttname"><a href="a00136.html#abc65e9c6a51b875f46fdb054a0ecf604">_ArrayProduct1D_</a></div><div class="ttdeci">#define _ArrayProduct1D_(x, size, p)</div><div class="ttdef"><b>Definition:</b> <a href="a00136_source.html#l00376">arrayfunctions.h:376</a></div></div>
<div class="ttc" id="a00115_html_a7331366d789b2995436accbc35e1cc80"><div class="ttname"><a href="a00115.html#a7331366d789b2995436accbc35e1cc80">HyPar::AveragingFunction</a></div><div class="ttdeci">int(* AveragingFunction)(double *, double *, double *, void *)</div><div class="ttdef"><b>Definition:</b> <a href="a00143_source.html#l00318">hypar.h:318</a></div></div>
<div class="ttc" id="a00136_html_afbb862a2fdf5b72b1f9ace42f64b556f"><div class="ttname"><a href="a00136.html#afbb862a2fdf5b72b1f9ace42f64b556f">_ArrayIndex1D_</a></div><div class="ttdeci">#define _ArrayIndex1D_(N, imax, i, ghost, index)</div><div class="ttdef"><b>Definition:</b> <a href="a00136_source.html#l00039">arrayfunctions.h:39</a></div></div>
<div class="ttc" id="a00147_html_a3dc53d4eb4ba0f2cfed00aa69617ee84"><div class="ttname"><a href="a00147.html#a3dc53d4eb4ba0f2cfed00aa69617ee84">MatVecMult</a></div><div class="ttdeci">#define MatVecMult(N, y, A, x)</div><div class="ttdef"><b>Definition:</b> <a href="a00147_source.html#l00162">mathfunctions.h:162</a></div></div>
<div class="ttc" id="a00137_html_a68f50121fb9a7daeaf60e50cdef82ef3"><div class="ttname"><a href="a00137.html#a68f50121fb9a7daeaf60e50cdef82ef3">_DECLARE_IERR_</a></div><div class="ttdeci">#define _DECLARE_IERR_</div><div class="ttdef"><b>Definition:</b> <a href="a00137_source.html#l00013">basic.h:13</a></div></div>
<div class="ttc" id="a00115_html_a48e81a1806b5774943fd9a26e9a190f2"><div class="ttname"><a href="a00115.html#a48e81a1806b5774943fd9a26e9a190f2">HyPar::physics</a></div><div class="ttdeci">void * physics</div><div class="ttdef"><b>Definition:</b> <a href="a00143_source.html#l00245">hypar.h:245</a></div></div>
<div class="ttc" id="a00118_html_a974b448c3d0a13d483d36ef15de369b5"><div class="ttname"><a href="a00118.html#a974b448c3d0a13d483d36ef15de369b5">MUSCLParameters::eps</a></div><div class="ttdeci">double eps</div><div class="ttdef"><b>Definition:</b> <a href="a00105_source.html#l00159">interpolation.h:159</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ade9ece6e934d70cdf29090494440f505"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int Interp1PrimFifthOrderUpwindChar </td>
          <td>(</td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>fI</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>fC</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>u</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>upw</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>dir</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>s</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>m</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>uflag</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>5th order upwind reconstruction (characteristic-based) on a uniform grid </p>
<p>Characteristic-based interpolation of the first primitive at the cell interfaces using the fifth-order upwind scheme</p>
<p>Computes the interpolated values of the first primitive of a function \({\bf f}\left({\bf u}\right)\) at the interfaces from the cell-centered values of the function using the fifth order upwind scheme on a uniform grid. The first primitive is defined as a function \({\bf h}\left({\bf u}\right)\) that satisfies: </p>
<p class="formulaDsp">
\begin{equation} {\bf f}\left({\bf u}\left(x\right)\right) = \frac{1}{\Delta x} \int_{x-\Delta x/2}^{x+\Delta x/2} {\bf h}\left({\bf u}\left(\zeta\right)\right)d\zeta, \end{equation}
</p>
<p> where \(x\) is the spatial coordinate along the dimension of the interpolation. This function computes the 5th order upwind numerical approximation \(\hat{\bf f}_{j+1/2} \approx {\bf h}_{j+1/2}\) as: </p>
<p class="formulaDsp">
\begin{align} \hat{\alpha}^k_{j+1/2} = \frac{1}{30} {\alpha}^k_{j-2} - \frac{13}{60}{\alpha}^k_{j-1} + \frac{47}{60}{\alpha}^k_j + \frac{27}{60}{\alpha}^k_{j+1} - \frac{1}{20}{\alpha}^k_{j+2}, \end{align}
</p>
<p> where </p>
<p class="formulaDsp">
\begin{equation} \alpha^k = {\bf l}_k \cdot {\bf f},\ k=1,\cdots,n \end{equation}
</p>
<p> is the \(k\)-th characteristic quantity, and \({\bf l}_k\) is the \(k\)-th left eigenvector, \({\bf r}_k\) is the \(k\)-th right eigenvector, and \(n\) is <a class="el" href="a00115.html#ae8f6d2fd6490d3153cb4133bf183a404">HyPar::nvars</a>. The final interpolated function is computed from the interpolated characteristic quantities as: </p>
<p class="formulaDsp">
\begin{equation} \hat{\bf f}_{j+1/2} = \sum_{k=1}^n \alpha^k_{j+1/2} {\bf r}_k \end{equation}
</p>
<p><b>Implementation</b> <b>Notes:</b> </p>
<ul>
<li>This method assumes a uniform grid in the spatial dimension corresponding to the interpolation.</li>
<li>The method described above corresponds to a left-biased interpolation. The corresponding right-biased interpolation can be obtained by reflecting the equations about interface j+1/2.</li>
<li><p class="startli">The left and right eigenvectors are computed at an averaged quantity at j+1/2. Thus, this function requires functions to compute the average state, and the left and right eigenvectors. These are provided by the physical model through</p>
<ul>
<li><a class="el" href="a00115.html#a8c603c73be1f08e408a1de94a088da7b">HyPar::GetLeftEigenvectors()</a></li>
<li><a class="el" href="a00115.html#a22eef349f191a1aa267e14b08140c823">HyPar::GetRightEigenvectors()</a></li>
<li><a class="el" href="a00115.html#a7331366d789b2995436accbc35e1cc80">HyPar::AveragingFunction()</a></li>
</ul>
<p class="startli">If these functions are not provided by the physical model, then a characteristic-based interpolation cannot be used.</p>
</li>
<li>The function computes the interpolant for the entire grid in one call. It loops over all the grid lines along the interpolation direction and carries out the 1D interpolation along these grid lines.</li>
<li>Location of cell-centers and cell interfaces along the spatial dimension of the interpolation is shown in the following figure: <div class="image">
<img src="chap1_1Ddomain.png" alt="chap1_1Ddomain.png"/>
</div>
 </li>
</ul>
<p><b>Function</b> <b>arguments:</b> </p>
<table class="doxtable">
<tr>
<th>Argument </th><th>Type </th><th>Explanation  </th></tr>
<tr>
<td>fI </td><td>double* </td><td>Array to hold the computed interpolant at the grid interfaces. This array must have the same layout as the solution, but with <b>no</b> <b>ghost</b> <b>points</b>. Its size should be the same as u in all dimensions, except dir (the dimension along which to interpolate) along which it should be larger by 1 (number of interfaces is 1 more than the number of interior cell centers). </td></tr>
<tr>
<td>fC </td><td>double* </td><td>Array with the cell-centered values of the flux function \({\bf f}\left({\bf u}\right)\). This array must have the same layout and size as the solution, <b>with</b> <b>ghost</b> <b>points</b>. </td></tr>
<tr>
<td>u </td><td>double* </td><td>The solution array \({\bf u}\) (with ghost points). If the interpolation is characteristic based, this is needed to compute the eigendecomposition. For a multidimensional problem, the layout is as follows: u is a contiguous 1D array of size (nvars*dim[0]*dim[1]*...*dim[D-1]) corresponding to the multi-dimensional solution, with the following ordering - nvars, dim[0], dim[1], ..., dim[D-1], where nvars is the number of solution components (<a class="el" href="a00115.html#ae8f6d2fd6490d3153cb4133bf183a404">HyPar::nvars</a>), dim is the local size (<a class="el" href="a00115.html#a38e0371f331cecbe63a77fa03e202afe">HyPar::dim_local</a>), D is the number of spatial dimensions. </td></tr>
<tr>
<td>x </td><td>double* </td><td>The grid array (with ghost points). This is used only by non-uniform-grid interpolation methods. For multidimensional problems, the layout is as follows: x is a contiguous 1D array of size (dim[0]+dim[1]+...+dim[D-1]), with the spatial coordinates along dim[0] stored from 0,...,dim[0]-1, the spatial coordinates along dim[1] stored along dim[0],...,dim[0]+dim[1]-1, and so forth. </td></tr>
<tr>
<td>upw </td><td>int </td><td>Upwinding direction: if positive, a left-biased interpolant will be computed; if negative, a right-biased interpolant will be computed. If the interpolation method is central, then this has no effect. </td></tr>
<tr>
<td>dir </td><td>int </td><td>Spatial dimension along which to interpolate (eg: 0 for 1D; 0 or 1 for 2D; 0,1 or 2 for 3D) </td></tr>
<tr>
<td>s </td><td>void* </td><td>Solver object of type <a class="el" href="a00115.html" title="Structure containing all solver-specific variables and functions. ">HyPar</a>: the following variables are needed - <a class="el" href="a00115.html#aafc992b5fa79d5a4036024615d03bce6">HyPar::ghosts</a>, <a class="el" href="a00115.html#a484873c74138512e41bc50d17b7d955a">HyPar::ndims</a>, <a class="el" href="a00115.html#ae8f6d2fd6490d3153cb4133bf183a404">HyPar::nvars</a>, <a class="el" href="a00115.html#a38e0371f331cecbe63a77fa03e202afe">HyPar::dim_local</a>. </td></tr>
<tr>
<td>m </td><td>void* </td><td>MPI object of type <a class="el" href="a00117.html#a00516" title="Structure of MPI-related variables. ">MPIVariables</a>: this is needed only by compact interpolation method that need to solve a global implicit system across MPI ranks. </td></tr>
<tr>
<td>uflag </td><td>int </td><td>A flag indicating if the function being interpolated \({\bf f}\) is the solution itself \({\bf u}\) (if 1, \({\bf f}\left({\bf u}\right) \equiv {\bf u}\)). </td></tr>
</table>
<p><b>Reference:</b> </p>
<ul>
<li>Jiang, G.-S., Shu, C.-W., Efficient Implementation of Weighted ENO Schemes, J. Comput. Phys., 126 (1), 1996, pp. 202-228, <a href="http://dx.doi.org/10.1006/jcph.1996.0130">http://dx.doi.org/10.1006/jcph.1996.0130</a> </li>
</ul>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">fI</td><td>Array of interpolated function values at the interfaces </td></tr>
    <tr><td class="paramname">fC</td><td>Array of cell-centered values of the function \({\bf f}\left({\bf u}\right)\) </td></tr>
    <tr><td class="paramname">u</td><td>Array of cell-centered values of the solution \({\bf u}\) </td></tr>
    <tr><td class="paramname">x</td><td>Grid coordinates </td></tr>
    <tr><td class="paramname">upw</td><td>Upwind direction (left or right biased) </td></tr>
    <tr><td class="paramname">dir</td><td>Spatial dimension along which to interpolation </td></tr>
    <tr><td class="paramname">s</td><td>Object of type <a class="el" href="a00115.html" title="Structure containing all solver-specific variables and functions. ">HyPar</a> containing solver-related variables </td></tr>
    <tr><td class="paramname">m</td><td>Object of type <a class="el" href="a00117.html#a00516" title="Structure of MPI-related variables. ">MPIVariables</a> containing MPI-related variables </td></tr>
    <tr><td class="paramname">uflag</td><td>Flag to indicate if \(f(u) \equiv u\), i.e, if the solution is being reconstructed </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="a00229_source.html#l00083">83</a> of file <a class="el" href="a00229_source.html">Interp1PrimFifthOrderUpwindChar.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;{</div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;  <a class="code" href="a00115.html">HyPar</a>           *solver = (<a class="code" href="a00115.html">HyPar</a>*) s;</div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;  <span class="keywordtype">int</span>             i, k, v;</div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;  <a class="code" href="a00137.html#a68f50121fb9a7daeaf60e50cdef82ef3">_DECLARE_IERR_</a>;</div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;</div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;  <span class="keywordtype">int</span> ghosts = solver-&gt;<a class="code" href="a00115.html#aafc992b5fa79d5a4036024615d03bce6">ghosts</a>;</div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;  <span class="keywordtype">int</span> ndims  = solver-&gt;<a class="code" href="a00115.html#a484873c74138512e41bc50d17b7d955a">ndims</a>;</div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;  <span class="keywordtype">int</span> nvars  = solver-&gt;<a class="code" href="a00115.html#ae8f6d2fd6490d3153cb4133bf183a404">nvars</a>;</div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;  <span class="keywordtype">int</span> *dim   = solver-&gt;<a class="code" href="a00115.html#a38e0371f331cecbe63a77fa03e202afe">dim_local</a>;</div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;</div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;  <span class="comment">/* define some constants */</span></div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;  <span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">double</span> one_by_thirty        = 1.0/30.0,</div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;                      thirteen_by_sixty    = 13.0/60.0,</div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;                      fortyseven_by_sixty  = 47.0/60.0,</div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;                      twentyseven_by_sixty = 27.0/60.0,</div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;                      one_by_twenty        = 1.0/20.0;</div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;</div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;  <span class="comment">/* create index and bounds for the outer loop, i.e., to loop over all 1D lines along</span></div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;<span class="comment">     dimension &quot;dir&quot;                                                                    */</span></div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;  <span class="keywordtype">int</span> indexC[ndims], indexI[ndims], index_outer[ndims], bounds_outer[ndims], bounds_inter[ndims];</div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;  <a class="code" href="a00136.html#a89e8330d9e06dd0666c50833628a125c">_ArrayCopy1D_</a>(dim,bounds_outer,ndims); bounds_outer[dir] =  1;</div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;  <a class="code" href="a00136.html#a89e8330d9e06dd0666c50833628a125c">_ArrayCopy1D_</a>(dim,bounds_inter,ndims); bounds_inter[dir] += 1;</div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;  <span class="keywordtype">int</span> N_outer; <a class="code" href="a00136.html#abc65e9c6a51b875f46fdb054a0ecf604">_ArrayProduct1D_</a>(bounds_outer,ndims,N_outer);</div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;</div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;  <span class="comment">/* allocate arrays for the averaged state, eigenvectors and characteristic interpolated f */</span></div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;  <span class="keywordtype">double</span> R[nvars*nvars], L[nvars*nvars], uavg[nvars], fchar[nvars];</div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;</div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;<span class="preprocessor">#pragma omp parallel for schedule(auto) default(shared) private(i,k,v,R,L,uavg,fchar,index_outer,indexC,indexI)</span></div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;<span class="preprocessor"></span>  <span class="keywordflow">for</span> (i=0; i&lt;N_outer; i++) {</div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;    <a class="code" href="a00136.html#a03f49e4d44ae8aca85cb04cfe91e4ce4">_ArrayIndexnD_</a>(ndims,i,bounds_outer,index_outer,0);</div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;    <a class="code" href="a00136.html#a89e8330d9e06dd0666c50833628a125c">_ArrayCopy1D_</a>(index_outer,indexC,ndims);</div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;    <a class="code" href="a00136.html#a89e8330d9e06dd0666c50833628a125c">_ArrayCopy1D_</a>(index_outer,indexI,ndims);</div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;</div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;    <span class="keywordflow">for</span> (indexI[dir] = 0; indexI[dir] &lt; dim[dir]+1; indexI[dir]++) {</div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;</div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;      <span class="comment">/* 1D indices of the stencil grid points */</span></div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;      <span class="keywordtype">int</span> qm1,qm2,qm3,qp1,qp2;</div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;      <span class="keywordflow">if</span> (upw &gt; 0) {</div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;        indexC[dir] = indexI[dir]-3; <a class="code" href="a00136.html#afbb862a2fdf5b72b1f9ace42f64b556f">_ArrayIndex1D_</a>(ndims,dim,indexC,ghosts,qm3);</div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;        indexC[dir] = indexI[dir]-2; <a class="code" href="a00136.html#afbb862a2fdf5b72b1f9ace42f64b556f">_ArrayIndex1D_</a>(ndims,dim,indexC,ghosts,qm2);</div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;        indexC[dir] = indexI[dir]-1; <a class="code" href="a00136.html#afbb862a2fdf5b72b1f9ace42f64b556f">_ArrayIndex1D_</a>(ndims,dim,indexC,ghosts,qm1);</div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;        indexC[dir] = indexI[dir]  ; <a class="code" href="a00136.html#afbb862a2fdf5b72b1f9ace42f64b556f">_ArrayIndex1D_</a>(ndims,dim,indexC,ghosts,qp1);</div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;        indexC[dir] = indexI[dir]+1; <a class="code" href="a00136.html#afbb862a2fdf5b72b1f9ace42f64b556f">_ArrayIndex1D_</a>(ndims,dim,indexC,ghosts,qp2);</div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;      } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;        indexC[dir] = indexI[dir]+2; <a class="code" href="a00136.html#afbb862a2fdf5b72b1f9ace42f64b556f">_ArrayIndex1D_</a>(ndims,dim,indexC,ghosts,qm3);</div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;        indexC[dir] = indexI[dir]+1; <a class="code" href="a00136.html#afbb862a2fdf5b72b1f9ace42f64b556f">_ArrayIndex1D_</a>(ndims,dim,indexC,ghosts,qm2);</div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;        indexC[dir] = indexI[dir]  ; <a class="code" href="a00136.html#afbb862a2fdf5b72b1f9ace42f64b556f">_ArrayIndex1D_</a>(ndims,dim,indexC,ghosts,qm1);</div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;        indexC[dir] = indexI[dir]-1; <a class="code" href="a00136.html#afbb862a2fdf5b72b1f9ace42f64b556f">_ArrayIndex1D_</a>(ndims,dim,indexC,ghosts,qp1);</div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;        indexC[dir] = indexI[dir]-2; <a class="code" href="a00136.html#afbb862a2fdf5b72b1f9ace42f64b556f">_ArrayIndex1D_</a>(ndims,dim,indexC,ghosts,qp2);</div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;      }</div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;</div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;      <span class="keywordtype">int</span> p; <span class="comment">/* 1D index of the interface */</span></div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;      <a class="code" href="a00136.html#afbb862a2fdf5b72b1f9ace42f64b556f">_ArrayIndex1D_</a>(ndims,bounds_inter,indexI,0,p);</div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;</div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;      <span class="comment">/* find averaged state at this interface */</span></div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;      <a class="code" href="a00137.html#ad6ab74942c9de13cf0b4c12eb0d91780">IERR</a> solver-&gt;<a class="code" href="a00115.html#a7331366d789b2995436accbc35e1cc80">AveragingFunction</a>(uavg,&amp;u[nvars*qm1],&amp;u[nvars*qp1],solver-&gt;<a class="code" href="a00115.html#a48e81a1806b5774943fd9a26e9a190f2">physics</a>); <a class="code" href="a00137.html#add9cf96ae374934d245a1dc1ab697a42">CHECKERR</a>(ierr);</div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;</div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;      <span class="comment">/* Get the left and right eigenvectors */</span></div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;      <a class="code" href="a00137.html#ad6ab74942c9de13cf0b4c12eb0d91780">IERR</a> solver-&gt;<a class="code" href="a00115.html#a8c603c73be1f08e408a1de94a088da7b">GetLeftEigenvectors</a>  (uavg,L,solver-&gt;<a class="code" href="a00115.html#a48e81a1806b5774943fd9a26e9a190f2">physics</a>,dir); <a class="code" href="a00137.html#add9cf96ae374934d245a1dc1ab697a42">CHECKERR</a>(ierr);</div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;      <a class="code" href="a00137.html#ad6ab74942c9de13cf0b4c12eb0d91780">IERR</a> solver-&gt;<a class="code" href="a00115.html#a22eef349f191a1aa267e14b08140c823">GetRightEigenvectors</a> (uavg,R,solver-&gt;<a class="code" href="a00115.html#a48e81a1806b5774943fd9a26e9a190f2">physics</a>,dir); <a class="code" href="a00137.html#add9cf96ae374934d245a1dc1ab697a42">CHECKERR</a>(ierr);</div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;</div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;      <span class="comment">/* For each characteristic field */</span></div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;      <span class="keywordflow">for</span> (v = 0; v &lt; nvars; v++) {</div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;</div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;        <span class="comment">/* calculate the characteristic flux components along this characteristic */</span></div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;        <span class="keywordtype">double</span> fm3, fm2, fm1, fp1, fp2;</div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;        fm3 = fm2 = fm1 = fp1 = fp2 = 0;</div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;        <span class="keywordflow">for</span> (k = 0; k &lt; nvars; k++) {</div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;          fm3 += L[v*nvars+k] * fC[qm3*nvars+k];</div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;          fm2 += L[v*nvars+k] * fC[qm2*nvars+k];</div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;          fm1 += L[v*nvars+k] * fC[qm1*nvars+k];</div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;          fp1 += L[v*nvars+k] * fC[qp1*nvars+k];</div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;          fp2 += L[v*nvars+k] * fC[qp2*nvars+k];</div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;        }</div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;</div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;        <span class="comment">/* fifth order upwind approximation of the characteristic flux */</span></div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;        fchar[v] =    one_by_thirty         * fm3</div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;                   -  thirteen_by_sixty     * fm2</div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;                   +  fortyseven_by_sixty   * fm1</div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;                   +  twentyseven_by_sixty  * fp1</div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;                   -  one_by_twenty         * fp2;</div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;      }</div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;</div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;      <span class="comment">/* calculate the interface u from the characteristic u */</span></div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;      <a class="code" href="a00137.html#ad6ab74942c9de13cf0b4c12eb0d91780">IERR</a> <a class="code" href="a00147.html#a3dc53d4eb4ba0f2cfed00aa69617ee84">MatVecMult</a>(nvars,(fI+nvars*p),R,fchar); <a class="code" href="a00137.html#add9cf96ae374934d245a1dc1ab697a42">CHECKERR</a>(ierr);</div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;</div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;    }</div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;  }</div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;</div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;  <span class="keywordflow">return</span>(0);</div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;}</div>
<div class="ttc" id="a00115_html_a484873c74138512e41bc50d17b7d955a"><div class="ttname"><a href="a00115.html#a484873c74138512e41bc50d17b7d955a">HyPar::ndims</a></div><div class="ttdeci">int ndims</div><div class="ttdef"><b>Definition:</b> <a href="a00143_source.html#l00026">hypar.h:26</a></div></div>
<div class="ttc" id="a00115_html_aafc992b5fa79d5a4036024615d03bce6"><div class="ttname"><a href="a00115.html#aafc992b5fa79d5a4036024615d03bce6">HyPar::ghosts</a></div><div class="ttdeci">int ghosts</div><div class="ttdef"><b>Definition:</b> <a href="a00143_source.html#l00044">hypar.h:44</a></div></div>
<div class="ttc" id="a00115_html"><div class="ttname"><a href="a00115.html">HyPar</a></div><div class="ttdoc">Structure containing all solver-specific variables and functions. </div><div class="ttdef"><b>Definition:</b> <a href="a00143_source.html#l00023">hypar.h:23</a></div></div>
<div class="ttc" id="a00137_html_ad6ab74942c9de13cf0b4c12eb0d91780"><div class="ttname"><a href="a00137.html#ad6ab74942c9de13cf0b4c12eb0d91780">IERR</a></div><div class="ttdeci">#define IERR</div><div class="ttdef"><b>Definition:</b> <a href="a00137_source.html#l00012">basic.h:12</a></div></div>
<div class="ttc" id="a00115_html_a8c603c73be1f08e408a1de94a088da7b"><div class="ttname"><a href="a00115.html#a8c603c73be1f08e408a1de94a088da7b">HyPar::GetLeftEigenvectors</a></div><div class="ttdeci">int(* GetLeftEigenvectors)(double *, double *, void *, int)</div><div class="ttdef"><b>Definition:</b> <a href="a00143_source.html#l00321">hypar.h:321</a></div></div>
<div class="ttc" id="a00115_html_ae8f6d2fd6490d3153cb4133bf183a404"><div class="ttname"><a href="a00115.html#ae8f6d2fd6490d3153cb4133bf183a404">HyPar::nvars</a></div><div class="ttdeci">int nvars</div><div class="ttdef"><b>Definition:</b> <a href="a00143_source.html#l00029">hypar.h:29</a></div></div>
<div class="ttc" id="a00136_html_a89e8330d9e06dd0666c50833628a125c"><div class="ttname"><a href="a00136.html#a89e8330d9e06dd0666c50833628a125c">_ArrayCopy1D_</a></div><div class="ttdeci">#define _ArrayCopy1D_(x, y, size)</div><div class="ttdef"><b>Definition:</b> <a href="a00136_source.html#l00318">arrayfunctions.h:318</a></div></div>
<div class="ttc" id="a00115_html_a38e0371f331cecbe63a77fa03e202afe"><div class="ttname"><a href="a00115.html#a38e0371f331cecbe63a77fa03e202afe">HyPar::dim_local</a></div><div class="ttdeci">int * dim_local</div><div class="ttdef"><b>Definition:</b> <a href="a00143_source.html#l00035">hypar.h:35</a></div></div>
<div class="ttc" id="a00115_html_a22eef349f191a1aa267e14b08140c823"><div class="ttname"><a href="a00115.html#a22eef349f191a1aa267e14b08140c823">HyPar::GetRightEigenvectors</a></div><div class="ttdeci">int(* GetRightEigenvectors)(double *, double *, void *, int)</div><div class="ttdef"><b>Definition:</b> <a href="a00143_source.html#l00323">hypar.h:323</a></div></div>
<div class="ttc" id="a00137_html_add9cf96ae374934d245a1dc1ab697a42"><div class="ttname"><a href="a00137.html#add9cf96ae374934d245a1dc1ab697a42">CHECKERR</a></div><div class="ttdeci">#define CHECKERR(ierr)</div><div class="ttdef"><b>Definition:</b> <a href="a00137_source.html#l00014">basic.h:14</a></div></div>
<div class="ttc" id="a00136_html_a03f49e4d44ae8aca85cb04cfe91e4ce4"><div class="ttname"><a href="a00136.html#a03f49e4d44ae8aca85cb04cfe91e4ce4">_ArrayIndexnD_</a></div><div class="ttdeci">#define _ArrayIndexnD_(N, index, imax, i, ghost)</div><div class="ttdef"><b>Definition:</b> <a href="a00136_source.html#l00020">arrayfunctions.h:20</a></div></div>
<div class="ttc" id="a00136_html_abc65e9c6a51b875f46fdb054a0ecf604"><div class="ttname"><a href="a00136.html#abc65e9c6a51b875f46fdb054a0ecf604">_ArrayProduct1D_</a></div><div class="ttdeci">#define _ArrayProduct1D_(x, size, p)</div><div class="ttdef"><b>Definition:</b> <a href="a00136_source.html#l00376">arrayfunctions.h:376</a></div></div>
<div class="ttc" id="a00115_html_a7331366d789b2995436accbc35e1cc80"><div class="ttname"><a href="a00115.html#a7331366d789b2995436accbc35e1cc80">HyPar::AveragingFunction</a></div><div class="ttdeci">int(* AveragingFunction)(double *, double *, double *, void *)</div><div class="ttdef"><b>Definition:</b> <a href="a00143_source.html#l00318">hypar.h:318</a></div></div>
<div class="ttc" id="a00136_html_afbb862a2fdf5b72b1f9ace42f64b556f"><div class="ttname"><a href="a00136.html#afbb862a2fdf5b72b1f9ace42f64b556f">_ArrayIndex1D_</a></div><div class="ttdeci">#define _ArrayIndex1D_(N, imax, i, ghost, index)</div><div class="ttdef"><b>Definition:</b> <a href="a00136_source.html#l00039">arrayfunctions.h:39</a></div></div>
<div class="ttc" id="a00147_html_a3dc53d4eb4ba0f2cfed00aa69617ee84"><div class="ttname"><a href="a00147.html#a3dc53d4eb4ba0f2cfed00aa69617ee84">MatVecMult</a></div><div class="ttdeci">#define MatVecMult(N, y, A, x)</div><div class="ttdef"><b>Definition:</b> <a href="a00147_source.html#l00162">mathfunctions.h:162</a></div></div>
<div class="ttc" id="a00137_html_a68f50121fb9a7daeaf60e50cdef82ef3"><div class="ttname"><a href="a00137.html#a68f50121fb9a7daeaf60e50cdef82ef3">_DECLARE_IERR_</a></div><div class="ttdeci">#define _DECLARE_IERR_</div><div class="ttdef"><b>Definition:</b> <a href="a00137_source.html#l00013">basic.h:13</a></div></div>
<div class="ttc" id="a00115_html_a48e81a1806b5774943fd9a26e9a190f2"><div class="ttname"><a href="a00115.html#a48e81a1806b5774943fd9a26e9a190f2">HyPar::physics</a></div><div class="ttdeci">void * physics</div><div class="ttdef"><b>Definition:</b> <a href="a00143_source.html#l00245">hypar.h:245</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a28b8d3ce17676cec19de4f91f989042d"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int Interp1PrimFifthOrderCompactUpwindChar </td>
          <td>(</td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>fI</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>fC</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>u</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>upw</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>dir</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>s</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>m</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>uflag</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>5th order compact upwind reconstruction (characteristic-based) on a uniform grid </p>
<p>Characteristic-based interpolation of the first primitive at the cell interfaces using the fifth-order compact upwind scheme</p>
<p>Computes the interpolated values of the first primitive of a function \({\bf f}\left({\bf u}\right)\) at the interfaces from the cell-centered values of the function using the fifth order compact upwind scheme on a uniform grid. The first primitive is defined as a function \({\bf h}\left({\bf u}\right)\) that satisfies: </p>
<p class="formulaDsp">
\begin{equation} {\bf f}\left({\bf u}\left(x\right)\right) = \frac{1}{\Delta x} \int_{x-\Delta x/2}^{x+\Delta x/2} {\bf h}\left({\bf u}\left(\zeta\right)\right)d\zeta, \end{equation}
</p>
<p> where \(x\) is the spatial coordinate along the dimension of the interpolation. This function computes the 5th order compact upwind numerical approximation \(\hat{\bf f}_{j+1/2} \approx {\bf h}_{j+1/2}\) as: </p>
<p class="formulaDsp">
\begin{align} \frac{3}{10}\hat{\alpha}^k_{j-1/2} + \frac{6}{10}\hat{\alpha}^k_{j+1/2} + \frac{1}{10}\hat{\alpha}^k_{j+3/2} = \frac{}{30}{\alpha}^k_{j-1} + \frac{19}{30}{\alpha}^k_j + \frac{1}{3}{\alpha}^k_{j+1}, \end{align}
</p>
<p> where </p>
<p class="formulaDsp">
\begin{equation} \alpha^k = {\bf l}_k \cdot {\bf f},\ k=1,\cdots,n \end{equation}
</p>
<p> is the \(k\)-th characteristic quantity, and \({\bf l}_k\) is the \(k\)-th left eigenvector, \({\bf r}_k\) is the \(k\)-th right eigenvector, and \(n\) is <a class="el" href="a00115.html#ae8f6d2fd6490d3153cb4133bf183a404">HyPar::nvars</a>. The resulting block tridiagonal system is solved using <a class="el" href="a00131.html#ad2c404dd44e760ee729740176b186bd0">blocktridiagLU()</a> (see also <a class="el" href="a00131.html#a00521">TridiagLU</a>, <a class="el" href="a00131.html" title="Header file for TridiagLU. ">tridiagLU.h</a>). The final interpolated function is computed from the interpolated characteristic quantities as: </p>
<p class="formulaDsp">
\begin{equation} \hat{\bf f}_{j+1/2} = \sum_{k=1}^n \alpha^k_{j+1/2} {\bf r}_k \end{equation}
</p>
<p><b>Implementation</b> <b>Notes:</b> </p>
<ul>
<li>This method assumes a uniform grid in the spatial dimension corresponding to the interpolation.</li>
<li>The method described above corresponds to a left-biased interpolation. The corresponding right-biased interpolation can be obtained by reflecting the equations about interface j+1/2.</li>
<li><p class="startli">The left and right eigenvectors are computed at an averaged quantity at j+1/2. Thus, this function requires functions to compute the average state, and the left and right eigenvectors. These are provided by the physical model through</p>
<ul>
<li><a class="el" href="a00115.html#a8c603c73be1f08e408a1de94a088da7b">HyPar::GetLeftEigenvectors()</a></li>
<li><a class="el" href="a00115.html#a22eef349f191a1aa267e14b08140c823">HyPar::GetRightEigenvectors()</a></li>
<li><a class="el" href="a00115.html#a7331366d789b2995436accbc35e1cc80">HyPar::AveragingFunction()</a></li>
</ul>
<p class="startli">If these functions are not provided by the physical model, then a characteristic-based interpolation cannot be used.</p>
</li>
<li>The function computes the interpolant for the entire grid in one call. It loops over all the grid lines along the interpolation direction and carries out the 1D interpolation along these grid lines.</li>
<li>Location of cell-centers and cell interfaces along the spatial dimension of the interpolation is shown in the following figure: <div class="image">
<img src="chap1_1Ddomain.png" alt="chap1_1Ddomain.png"/>
</div>
 </li>
</ul>
<p><b>Function</b> <b>arguments:</b> </p>
<table class="doxtable">
<tr>
<th>Argument </th><th>Type </th><th>Explanation  </th></tr>
<tr>
<td>fI </td><td>double* </td><td>Array to hold the computed interpolant at the grid interfaces. This array must have the same layout as the solution, but with <b>no</b> <b>ghost</b> <b>points</b>. Its size should be the same as u in all dimensions, except dir (the dimension along which to interpolate) along which it should be larger by 1 (number of interfaces is 1 more than the number of interior cell centers). </td></tr>
<tr>
<td>fC </td><td>double* </td><td>Array with the cell-centered values of the flux function \({\bf f}\left({\bf u}\right)\). This array must have the same layout and size as the solution, <b>with</b> <b>ghost</b> <b>points</b>. </td></tr>
<tr>
<td>u </td><td>double* </td><td>The solution array \({\bf u}\) (with ghost points). If the interpolation is characteristic based, this is needed to compute the eigendecomposition. For a multidimensional problem, the layout is as follows: u is a contiguous 1D array of size (nvars*dim[0]*dim[1]*...*dim[D-1]) corresponding to the multi-dimensional solution, with the following ordering - nvars, dim[0], dim[1], ..., dim[D-1], where nvars is the number of solution components (<a class="el" href="a00115.html#ae8f6d2fd6490d3153cb4133bf183a404">HyPar::nvars</a>), dim is the local size (<a class="el" href="a00115.html#a38e0371f331cecbe63a77fa03e202afe">HyPar::dim_local</a>), D is the number of spatial dimensions. </td></tr>
<tr>
<td>x </td><td>double* </td><td>The grid array (with ghost points). This is used only by non-uniform-grid interpolation methods. For multidimensional problems, the layout is as follows: x is a contiguous 1D array of size (dim[0]+dim[1]+...+dim[D-1]), with the spatial coordinates along dim[0] stored from 0,...,dim[0]-1, the spatial coordinates along dim[1] stored along dim[0],...,dim[0]+dim[1]-1, and so forth. </td></tr>
<tr>
<td>upw </td><td>int </td><td>Upwinding direction: if positive, a left-biased interpolant will be computed; if negative, a right-biased interpolant will be computed. If the interpolation method is central, then this has no effect. </td></tr>
<tr>
<td>dir </td><td>int </td><td>Spatial dimension along which to interpolate (eg: 0 for 1D; 0 or 1 for 2D; 0,1 or 2 for 3D) </td></tr>
<tr>
<td>s </td><td>void* </td><td>Solver object of type <a class="el" href="a00115.html" title="Structure containing all solver-specific variables and functions. ">HyPar</a>: the following variables are needed - <a class="el" href="a00115.html#aafc992b5fa79d5a4036024615d03bce6">HyPar::ghosts</a>, <a class="el" href="a00115.html#a484873c74138512e41bc50d17b7d955a">HyPar::ndims</a>, <a class="el" href="a00115.html#ae8f6d2fd6490d3153cb4133bf183a404">HyPar::nvars</a>, <a class="el" href="a00115.html#a38e0371f331cecbe63a77fa03e202afe">HyPar::dim_local</a>. </td></tr>
<tr>
<td>m </td><td>void* </td><td>MPI object of type <a class="el" href="a00117.html#a00516" title="Structure of MPI-related variables. ">MPIVariables</a>: this is needed only by compact interpolation method that need to solve a global implicit system across MPI ranks. </td></tr>
<tr>
<td>uflag </td><td>int </td><td>A flag indicating if the function being interpolated \({\bf f}\) is the solution itself \({\bf u}\) (if 1, \({\bf f}\left({\bf u}\right) \equiv {\bf u}\)). </td></tr>
</table>
<p><b>Reference:</b> </p>
<ul>
<li>Ghosh, D., Baeder, J. D., Compact Reconstruction Schemes with Weighted ENO Limiting for Hyperbolic Conservation Laws, SIAM Journal on Scientific Computing, 34 (3), 2012, A1678A1706, <a href="http://dx.doi.org/10.1137/110857659">http://dx.doi.org/10.1137/110857659</a></li>
<li>Ghosh, D., Constantinescu, E. M., Brown, J., Efficient Implementation of Nonlinear Compact Schemes on Massively Parallel Platforms, SIAM Journal on Scientific Computing, 37 (3), 2015, C354C383, <a href="http://dx.doi.org/10.1137/140989261">http://dx.doi.org/10.1137/140989261</a> </li>
</ul>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">fI</td><td>Array of interpolated function values at the interfaces </td></tr>
    <tr><td class="paramname">fC</td><td>Array of cell-centered values of the function \({\bf f}\left({\bf u}\right)\) </td></tr>
    <tr><td class="paramname">u</td><td>Array of cell-centered values of the solution \({\bf u}\) </td></tr>
    <tr><td class="paramname">x</td><td>Grid coordinates </td></tr>
    <tr><td class="paramname">upw</td><td>Upwind direction (left or right biased) </td></tr>
    <tr><td class="paramname">dir</td><td>Spatial dimension along which to interpolation </td></tr>
    <tr><td class="paramname">s</td><td>Object of type <a class="el" href="a00115.html" title="Structure containing all solver-specific variables and functions. ">HyPar</a> containing solver-related variables </td></tr>
    <tr><td class="paramname">m</td><td>Object of type <a class="el" href="a00117.html#a00516" title="Structure of MPI-related variables. ">MPIVariables</a> containing MPI-related variables </td></tr>
    <tr><td class="paramname">uflag</td><td>Flag to indicate if \(f(u) \equiv u\), i.e, if the solution is being reconstructed </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="a00223_source.html#l00089">89</a> of file <a class="el" href="a00223_source.html">Interp1PrimFifthOrderCompactUpwindChar.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;{</div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;  <a class="code" href="a00115.html">HyPar</a>           *solver = (<a class="code" href="a00115.html">HyPar</a>*)          s;</div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;  <a class="code" href="a00117.html#a00516">MPIVariables</a>    *mpi    = (<a class="code" href="a00117.html#a00516">MPIVariables</a>*)   m;</div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;  <a class="code" href="a00105.html#a00503">CompactScheme</a>   *compact= (<a class="code" href="a00105.html#a00503">CompactScheme</a>*)  solver-&gt;<a class="code" href="a00115.html#a56318721d534e74a96b440f8542a0232">compact</a>;</div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;  <a class="code" href="a00131.html#a00521">TridiagLU</a>       *lu     = (<a class="code" href="a00131.html#a00521">TridiagLU</a>*)      solver-&gt;<a class="code" href="a00115.html#a1dbfa1e479a373073b6ebf72401a7f0f">lusolver</a>;</div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;  <span class="keywordtype">int</span>             sys,Nsys,d,v,k;</div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;  <a class="code" href="a00137.html#a68f50121fb9a7daeaf60e50cdef82ef3">_DECLARE_IERR_</a>;</div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;</div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;  <span class="keywordtype">int</span> ghosts = solver-&gt;<a class="code" href="a00115.html#aafc992b5fa79d5a4036024615d03bce6">ghosts</a>;</div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;  <span class="keywordtype">int</span> ndims  = solver-&gt;<a class="code" href="a00115.html#a484873c74138512e41bc50d17b7d955a">ndims</a>;</div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;  <span class="keywordtype">int</span> nvars  = solver-&gt;<a class="code" href="a00115.html#ae8f6d2fd6490d3153cb4133bf183a404">nvars</a>;</div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;  <span class="keywordtype">int</span> *dim   = solver-&gt;<a class="code" href="a00115.html#a38e0371f331cecbe63a77fa03e202afe">dim_local</a>;</div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;</div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;  <span class="comment">/* define some constants */</span></div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;  <span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">double</span> three_by_ten          = 3.0/10.0,</div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;                      six_by_ten            = 6.0/10.0,</div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;                      one_by_ten            = 1.0/10.0,</div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;                      one_by_thirty         = 1.0/30.0,</div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;                      nineteen_by_thirty    = 19.0/30.0,</div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;                      one_third             = 1.0/3.0,</div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;                      thirteen_by_sixty     = 13.0/60.0,</div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;                      fortyseven_by_sixty   = 47.0/60.0,</div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;                      twentyseven_by_sixty  = 27.0/60.0,</div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;                      one_by_twenty         = 1.0/20.0;</div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;</div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;  <span class="comment">/* create index and bounds for the outer loop, i.e., to loop over all 1D lines along</span></div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;<span class="comment">     dimension &quot;dir&quot;                                                                    */</span></div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;  <span class="keywordtype">int</span> indexC[ndims], indexI[ndims], index_outer[ndims], bounds_outer[ndims], bounds_inter[ndims];</div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;  <a class="code" href="a00136.html#a89e8330d9e06dd0666c50833628a125c">_ArrayCopy1D_</a>(dim,bounds_outer,ndims); bounds_outer[dir] =  1;</div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;  <a class="code" href="a00136.html#a89e8330d9e06dd0666c50833628a125c">_ArrayCopy1D_</a>(dim,bounds_inter,ndims); bounds_inter[dir] += 1;</div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;</div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;  <span class="comment">/* calculate total number of block tridiagonal systems to solve */</span></div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;  <a class="code" href="a00136.html#abc65e9c6a51b875f46fdb054a0ecf604">_ArrayProduct1D_</a>(bounds_outer,ndims,Nsys);</div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;</div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;  <span class="comment">/* allocate arrays for the averaged state, eigenvectors and characteristic interpolated f */</span></div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;  <span class="keywordtype">double</span> R[nvars*nvars], L[nvars*nvars], uavg[nvars];</div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;</div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;  <span class="comment">/* Allocate arrays for tridiagonal system */</span></div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;  <span class="keywordtype">double</span> *A = compact-&gt;<a class="code" href="a00105.html#ac900805a486cbb8489e3c176ed6e0d8e">A</a>;</div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;  <span class="keywordtype">double</span> *B = compact-&gt;<a class="code" href="a00105.html#ad36954709307649365515214a02ab06d">B</a>;</div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;  <span class="keywordtype">double</span> *C = compact-&gt;<a class="code" href="a00105.html#a0a26ce8d1878aac6ddc87e3f6290e039">C</a>;</div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;  <span class="keywordtype">double</span> *F = compact-&gt;<a class="code" href="a00105.html#ac06de847603f5cfaec085f6fe500f3c8">R</a>;</div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;</div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;<span class="preprocessor">#pragma omp parallel for schedule(auto) default(shared) private(sys,d,v,k,R,L,uavg,index_outer,indexC,indexI)</span></div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;<span class="preprocessor"></span>  <span class="keywordflow">for</span> (sys=0; sys&lt;Nsys; sys++) {</div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;    <a class="code" href="a00136.html#a03f49e4d44ae8aca85cb04cfe91e4ce4">_ArrayIndexnD_</a>(ndims,sys,bounds_outer,index_outer,0);</div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;    <a class="code" href="a00136.html#a89e8330d9e06dd0666c50833628a125c">_ArrayCopy1D_</a>(index_outer,indexC,ndims);</div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;    <a class="code" href="a00136.html#a89e8330d9e06dd0666c50833628a125c">_ArrayCopy1D_</a>(index_outer,indexI,ndims);</div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;    <span class="keywordflow">for</span> (indexI[dir] = 0; indexI[dir] &lt; dim[dir]+1; indexI[dir]++) {</div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;      <span class="keywordtype">int</span> qm1,qm2,qm3,qp1,qp2;</div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;      <span class="keywordflow">if</span> (upw &gt; 0) {</div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;        indexC[dir] = indexI[dir]-3; <a class="code" href="a00136.html#afbb862a2fdf5b72b1f9ace42f64b556f">_ArrayIndex1D_</a>(ndims,dim,indexC,ghosts,qm3);</div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;        indexC[dir] = indexI[dir]-2; <a class="code" href="a00136.html#afbb862a2fdf5b72b1f9ace42f64b556f">_ArrayIndex1D_</a>(ndims,dim,indexC,ghosts,qm2);</div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;        indexC[dir] = indexI[dir]-1; <a class="code" href="a00136.html#afbb862a2fdf5b72b1f9ace42f64b556f">_ArrayIndex1D_</a>(ndims,dim,indexC,ghosts,qm1);</div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;        indexC[dir] = indexI[dir]  ; <a class="code" href="a00136.html#afbb862a2fdf5b72b1f9ace42f64b556f">_ArrayIndex1D_</a>(ndims,dim,indexC,ghosts,qp1);</div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;        indexC[dir] = indexI[dir]+1; <a class="code" href="a00136.html#afbb862a2fdf5b72b1f9ace42f64b556f">_ArrayIndex1D_</a>(ndims,dim,indexC,ghosts,qp2);</div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;      } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;        indexC[dir] = indexI[dir]+2; <a class="code" href="a00136.html#afbb862a2fdf5b72b1f9ace42f64b556f">_ArrayIndex1D_</a>(ndims,dim,indexC,ghosts,qm3);</div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;        indexC[dir] = indexI[dir]+1; <a class="code" href="a00136.html#afbb862a2fdf5b72b1f9ace42f64b556f">_ArrayIndex1D_</a>(ndims,dim,indexC,ghosts,qm2);</div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;        indexC[dir] = indexI[dir]  ; <a class="code" href="a00136.html#afbb862a2fdf5b72b1f9ace42f64b556f">_ArrayIndex1D_</a>(ndims,dim,indexC,ghosts,qm1);</div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;        indexC[dir] = indexI[dir]-1; <a class="code" href="a00136.html#afbb862a2fdf5b72b1f9ace42f64b556f">_ArrayIndex1D_</a>(ndims,dim,indexC,ghosts,qp1);</div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;        indexC[dir] = indexI[dir]-2; <a class="code" href="a00136.html#afbb862a2fdf5b72b1f9ace42f64b556f">_ArrayIndex1D_</a>(ndims,dim,indexC,ghosts,qp2);</div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;      }</div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;</div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;      <span class="keywordtype">int</span> p; <span class="comment">/* 1D index of the interface */</span></div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;      <a class="code" href="a00136.html#afbb862a2fdf5b72b1f9ace42f64b556f">_ArrayIndex1D_</a>(ndims,bounds_inter,indexI,0,p);</div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;</div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;      <span class="comment">/* find averaged state at this interface */</span></div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;      <a class="code" href="a00137.html#ad6ab74942c9de13cf0b4c12eb0d91780">IERR</a> solver-&gt;<a class="code" href="a00115.html#a7331366d789b2995436accbc35e1cc80">AveragingFunction</a>(uavg,&amp;u[nvars*qm1],&amp;u[nvars*qp1],solver-&gt;<a class="code" href="a00115.html#a48e81a1806b5774943fd9a26e9a190f2">physics</a>); <a class="code" href="a00137.html#add9cf96ae374934d245a1dc1ab697a42">CHECKERR</a>(ierr);</div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;</div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;      <span class="comment">/* Get the left and right eigenvectors */</span></div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;      <a class="code" href="a00137.html#ad6ab74942c9de13cf0b4c12eb0d91780">IERR</a> solver-&gt;<a class="code" href="a00115.html#a8c603c73be1f08e408a1de94a088da7b">GetLeftEigenvectors</a>  (uavg,L,solver-&gt;<a class="code" href="a00115.html#a48e81a1806b5774943fd9a26e9a190f2">physics</a>,dir); <a class="code" href="a00137.html#add9cf96ae374934d245a1dc1ab697a42">CHECKERR</a>(ierr);</div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;      <a class="code" href="a00137.html#ad6ab74942c9de13cf0b4c12eb0d91780">IERR</a> solver-&gt;<a class="code" href="a00115.html#a22eef349f191a1aa267e14b08140c823">GetRightEigenvectors</a> (uavg,R,solver-&gt;<a class="code" href="a00115.html#a48e81a1806b5774943fd9a26e9a190f2">physics</a>,dir); <a class="code" href="a00137.html#add9cf96ae374934d245a1dc1ab697a42">CHECKERR</a>(ierr);</div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;</div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;      <span class="keywordflow">for</span> (v=0; v&lt;nvars; v++)  {</div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;</div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;        <span class="comment">/* calculate the characteristic flux components along this characteristic */</span></div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;        <span class="keywordtype">double</span> fm3, fm2, fm1, fp1, fp2;</div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;        fm3 = fm2 = fm1 = fp1 = fp2 = 0;</div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;        <span class="keywordflow">for</span> (k = 0; k &lt; nvars; k++) {</div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;          fm3 += L[v*nvars+k] * fC[qm3*nvars+k];</div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;          fm2 += L[v*nvars+k] * fC[qm2*nvars+k];</div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;          fm1 += L[v*nvars+k] * fC[qm1*nvars+k];</div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;          fp1 += L[v*nvars+k] * fC[qp1*nvars+k];</div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;          fp2 += L[v*nvars+k] * fC[qp2*nvars+k];</div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;        }</div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;</div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;        <span class="keywordflow">if</span> (   ((mpi-&gt;<a class="code" href="a00117.html#aa3c28612a64b8a97bde66b720e15c700">ip</a>[dir] == 0                ) &amp;&amp; (indexI[dir] == 0       ))</div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;            || ((mpi-&gt;<a class="code" href="a00117.html#aa3c28612a64b8a97bde66b720e15c700">ip</a>[dir] == mpi-&gt;<a class="code" href="a00117.html#a0be0f30a83bc3f3d9f6ee3a36bbf2716">iproc</a>[dir]-1) &amp;&amp; (indexI[dir] == dim[dir])) ) {</div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;          <span class="comment">/* Use 5th order upwind at the physical boundaries */</span></div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;          <span class="keywordflow">for</span> (k=0; k&lt;nvars; k++) {</div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;            A[(Nsys*indexI[dir]+sys)*nvars*nvars+v*nvars+k] = 0.0;</div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;            C[(Nsys*indexI[dir]+sys)*nvars*nvars+v*nvars+k] = 0.0;</div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;            B[(Nsys*indexI[dir]+sys)*nvars*nvars+v*nvars+k] = L[v*nvars+k];</div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;          }</div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;          F[(Nsys*indexI[dir]+sys)*nvars+v] =   one_by_thirty         * fm3</div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;                                              - thirteen_by_sixty     * fm2</div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;                                              + fortyseven_by_sixty   * fm1</div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;                                              + twentyseven_by_sixty  * fp1</div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;                                              - one_by_twenty         * fp2;</div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;          <span class="comment">/* 5th order compact upwind at the interior points */</span></div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;          <span class="keywordflow">if</span> (upw &gt; 0) {</div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;            <span class="keywordflow">for</span> (k=0; k&lt;nvars; k++) {</div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;              A[(Nsys*indexI[dir]+sys)*nvars*nvars+v*nvars+k] = three_by_ten * L[v*nvars+k];</div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;              B[(Nsys*indexI[dir]+sys)*nvars*nvars+v*nvars+k] = six_by_ten   * L[v*nvars+k];</div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;              C[(Nsys*indexI[dir]+sys)*nvars*nvars+v*nvars+k] = one_by_ten   * L[v*nvars+k];</div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;            }</div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;          } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;            <span class="keywordflow">for</span> (k=0; k&lt;nvars; k++) {</div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;              C[(Nsys*indexI[dir]+sys)*nvars*nvars+v*nvars+k] = three_by_ten * L[v*nvars+k];</div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;              B[(Nsys*indexI[dir]+sys)*nvars*nvars+v*nvars+k] = six_by_ten   * L[v*nvars+k];</div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;              A[(Nsys*indexI[dir]+sys)*nvars*nvars+v*nvars+k] = one_by_ten   * L[v*nvars+k];</div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;            }</div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;          }</div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;          F[(Nsys*indexI[dir]+sys)*nvars+v] =   one_by_thirty      * fm2</div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;                                              + nineteen_by_thirty * fm1</div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;                                              + one_third          * fp1;</div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;        }</div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;      }</div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;    }</div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;  }</div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;</div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;<span class="preprocessor">#ifdef serial</span></div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;<span class="preprocessor"></span></div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;  <span class="comment">/* Solve the tridiagonal system */</span></div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;  <a class="code" href="a00137.html#ad6ab74942c9de13cf0b4c12eb0d91780">IERR</a> <a class="code" href="a00131.html#ad2c404dd44e760ee729740176b186bd0">blocktridiagLU</a>(A,B,C,F,dim[dir]+1,Nsys,nvars,lu,NULL); <a class="code" href="a00137.html#add9cf96ae374934d245a1dc1ab697a42">CHECKERR</a>(ierr);</div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;</div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;<span class="preprocessor">#else</span></div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;<span class="preprocessor"></span></div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;  <span class="comment">/* Solve the tridiagonal system */</span></div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;  <span class="comment">/* all processes except the last will solve without the last interface to avoid overlap */</span></div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;  <span class="keywordflow">if</span> (mpi-&gt;<a class="code" href="a00117.html#aa3c28612a64b8a97bde66b720e15c700">ip</a>[dir] != mpi-&gt;<a class="code" href="a00117.html#a0be0f30a83bc3f3d9f6ee3a36bbf2716">iproc</a>[dir]-1)  { </div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;    <a class="code" href="a00137.html#ad6ab74942c9de13cf0b4c12eb0d91780">IERR</a> <a class="code" href="a00131.html#ad2c404dd44e760ee729740176b186bd0">blocktridiagLU</a>(A,B,C,F,dim[dir]  ,Nsys,nvars,lu,&amp;mpi-&gt;<a class="code" href="a00117.html#a45a2dae130e8ef21ae3aa9c7a9e7a138">comm</a>[dir]); <a class="code" href="a00137.html#add9cf96ae374934d245a1dc1ab697a42">CHECKERR</a>(ierr); </div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;  } <span class="keywordflow">else</span> { </div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;    <a class="code" href="a00137.html#ad6ab74942c9de13cf0b4c12eb0d91780">IERR</a> <a class="code" href="a00131.html#ad2c404dd44e760ee729740176b186bd0">blocktridiagLU</a>(A,B,C,F,dim[dir]+1,Nsys,nvars,lu,&amp;mpi-&gt;<a class="code" href="a00117.html#a45a2dae130e8ef21ae3aa9c7a9e7a138">comm</a>[dir]); <a class="code" href="a00137.html#add9cf96ae374934d245a1dc1ab697a42">CHECKERR</a>(ierr);</div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;  }</div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;</div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;  <span class="comment">/* Now get the solution to the last interface from the next proc */</span></div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;  <span class="keywordtype">double</span> *sendbuf = compact-&gt;<a class="code" href="a00105.html#aba3b15034da676474db917f9f5533085">sendbuf</a>;</div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;  <span class="keywordtype">double</span> *recvbuf = compact-&gt;<a class="code" href="a00105.html#afc23e46e08649e112e8d64d780cea5cb">recvbuf</a>;</div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;  MPI_Request req[2] = {MPI_REQUEST_NULL,MPI_REQUEST_NULL};</div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;  <span class="keywordflow">if</span> (mpi-&gt;<a class="code" href="a00117.html#aa3c28612a64b8a97bde66b720e15c700">ip</a>[dir]) <span class="keywordflow">for</span> (d=0; d&lt;Nsys*nvars; d++) sendbuf[d] = F[d];</div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;  <span class="keywordflow">if</span> (mpi-&gt;<a class="code" href="a00117.html#aa3c28612a64b8a97bde66b720e15c700">ip</a>[dir] != mpi-&gt;<a class="code" href="a00117.html#a0be0f30a83bc3f3d9f6ee3a36bbf2716">iproc</a>[dir]-1) MPI_Irecv(recvbuf,Nsys*nvars,MPI_DOUBLE,mpi-&gt;<a class="code" href="a00117.html#aa3c28612a64b8a97bde66b720e15c700">ip</a>[dir]+1,214,mpi-&gt;<a class="code" href="a00117.html#a45a2dae130e8ef21ae3aa9c7a9e7a138">comm</a>[dir],&amp;req[0]);</div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;  <span class="keywordflow">if</span> (mpi-&gt;<a class="code" href="a00117.html#aa3c28612a64b8a97bde66b720e15c700">ip</a>[dir])                      MPI_Isend(sendbuf,Nsys*nvars,MPI_DOUBLE,mpi-&gt;<a class="code" href="a00117.html#aa3c28612a64b8a97bde66b720e15c700">ip</a>[dir]-1,214,mpi-&gt;<a class="code" href="a00117.html#a45a2dae130e8ef21ae3aa9c7a9e7a138">comm</a>[dir],&amp;req[1]);</div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;  MPI_Waitall(2,&amp;req[0],MPI_STATUS_IGNORE);</div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;  <span class="keywordflow">if</span> (mpi-&gt;<a class="code" href="a00117.html#aa3c28612a64b8a97bde66b720e15c700">ip</a>[dir] != mpi-&gt;<a class="code" href="a00117.html#a0be0f30a83bc3f3d9f6ee3a36bbf2716">iproc</a>[dir]-1) <span class="keywordflow">for</span> (d=0; d&lt;Nsys*nvars; d++) F[d+Nsys*nvars*dim[dir]] = recvbuf[d];</div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;</div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;<span class="preprocessor"></span></div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;  <span class="comment">/* save the solution to fI */</span></div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;<span class="preprocessor">#pragma omp parallel for schedule(auto) default(shared) private(sys,d,v,k,R,L,uavg,index_outer,indexC,indexI)</span></div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;<span class="preprocessor"></span>  <span class="keywordflow">for</span> (sys=0; sys&lt;Nsys; sys++) {</div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;    <a class="code" href="a00136.html#a03f49e4d44ae8aca85cb04cfe91e4ce4">_ArrayIndexnD_</a>(ndims,sys,bounds_outer,index_outer,0);</div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;    <a class="code" href="a00136.html#a89e8330d9e06dd0666c50833628a125c">_ArrayCopy1D_</a>(index_outer,indexI,ndims);</div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;    <span class="keywordflow">for</span> (indexI[dir] = 0; indexI[dir] &lt; dim[dir]+1; indexI[dir]++) {</div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;      <span class="keywordtype">int</span> p; <a class="code" href="a00136.html#afbb862a2fdf5b72b1f9ace42f64b556f">_ArrayIndex1D_</a>(ndims,bounds_inter,indexI,0,p);</div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;      <a class="code" href="a00136.html#a89e8330d9e06dd0666c50833628a125c">_ArrayCopy1D_</a>((F+sys*nvars+Nsys*nvars*indexI[dir]),(fI+nvars*p),nvars);</div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;    }</div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;  }</div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;</div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;  <span class="keywordflow">return</span>(0);</div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;}</div>
<div class="ttc" id="a00131_html_a00521"><div class="ttname"><a href="a00131.html#a00521">TridiagLU</a></div><div class="ttdef"><b>Definition:</b> <a href="a00131_source.html#l00084">tridiagLU.h:84</a></div></div>
<div class="ttc" id="a00115_html_a56318721d534e74a96b440f8542a0232"><div class="ttname"><a href="a00115.html#a56318721d534e74a96b440f8542a0232">HyPar::compact</a></div><div class="ttdeci">void * compact</div><div class="ttdef"><b>Definition:</b> <a href="a00143_source.html#l00328">hypar.h:328</a></div></div>
<div class="ttc" id="a00115_html_a484873c74138512e41bc50d17b7d955a"><div class="ttname"><a href="a00115.html#a484873c74138512e41bc50d17b7d955a">HyPar::ndims</a></div><div class="ttdeci">int ndims</div><div class="ttdef"><b>Definition:</b> <a href="a00143_source.html#l00026">hypar.h:26</a></div></div>
<div class="ttc" id="a00115_html_aafc992b5fa79d5a4036024615d03bce6"><div class="ttname"><a href="a00115.html#aafc992b5fa79d5a4036024615d03bce6">HyPar::ghosts</a></div><div class="ttdeci">int ghosts</div><div class="ttdef"><b>Definition:</b> <a href="a00143_source.html#l00044">hypar.h:44</a></div></div>
<div class="ttc" id="a00115_html"><div class="ttname"><a href="a00115.html">HyPar</a></div><div class="ttdoc">Structure containing all solver-specific variables and functions. </div><div class="ttdef"><b>Definition:</b> <a href="a00143_source.html#l00023">hypar.h:23</a></div></div>
<div class="ttc" id="a00105_html_ac06de847603f5cfaec085f6fe500f3c8"><div class="ttname"><a href="a00105.html#ac06de847603f5cfaec085f6fe500f3c8">CompactScheme::R</a></div><div class="ttdeci">double * R</div><div class="ttdef"><b>Definition:</b> <a href="a00105_source.html#l00439">interpolation.h:439</a></div></div>
<div class="ttc" id="a00105_html_a00503"><div class="ttname"><a href="a00105.html#a00503">CompactScheme</a></div><div class="ttdoc">Structure of variables/parameters needed by the compact schemes. </div><div class="ttdef"><b>Definition:</b> <a href="a00105_source.html#l00437">interpolation.h:437</a></div></div>
<div class="ttc" id="a00137_html_ad6ab74942c9de13cf0b4c12eb0d91780"><div class="ttname"><a href="a00137.html#ad6ab74942c9de13cf0b4c12eb0d91780">IERR</a></div><div class="ttdeci">#define IERR</div><div class="ttdef"><b>Definition:</b> <a href="a00137_source.html#l00012">basic.h:12</a></div></div>
<div class="ttc" id="a00105_html_aba3b15034da676474db917f9f5533085"><div class="ttname"><a href="a00105.html#aba3b15034da676474db917f9f5533085">CompactScheme::sendbuf</a></div><div class="ttdeci">double * sendbuf</div><div class="ttdef"><b>Definition:</b> <a href="a00105_source.html#l00444">interpolation.h:444</a></div></div>
<div class="ttc" id="a00117_html_a0be0f30a83bc3f3d9f6ee3a36bbf2716"><div class="ttname"><a href="a00117.html#a0be0f30a83bc3f3d9f6ee3a36bbf2716">MPIVariables::iproc</a></div><div class="ttdeci">int * iproc</div><div class="ttdef"><b>Definition:</b> <a href="a00117_source.html#l00027">mpivars_struct.h:27</a></div></div>
<div class="ttc" id="a00115_html_a8c603c73be1f08e408a1de94a088da7b"><div class="ttname"><a href="a00115.html#a8c603c73be1f08e408a1de94a088da7b">HyPar::GetLeftEigenvectors</a></div><div class="ttdeci">int(* GetLeftEigenvectors)(double *, double *, void *, int)</div><div class="ttdef"><b>Definition:</b> <a href="a00143_source.html#l00321">hypar.h:321</a></div></div>
<div class="ttc" id="a00115_html_ae8f6d2fd6490d3153cb4133bf183a404"><div class="ttname"><a href="a00115.html#ae8f6d2fd6490d3153cb4133bf183a404">HyPar::nvars</a></div><div class="ttdeci">int nvars</div><div class="ttdef"><b>Definition:</b> <a href="a00143_source.html#l00029">hypar.h:29</a></div></div>
<div class="ttc" id="a00105_html_a0a26ce8d1878aac6ddc87e3f6290e039"><div class="ttname"><a href="a00105.html#a0a26ce8d1878aac6ddc87e3f6290e039">CompactScheme::C</a></div><div class="ttdeci">double * C</div><div class="ttdef"><b>Definition:</b> <a href="a00105_source.html#l00439">interpolation.h:439</a></div></div>
<div class="ttc" id="a00136_html_a89e8330d9e06dd0666c50833628a125c"><div class="ttname"><a href="a00136.html#a89e8330d9e06dd0666c50833628a125c">_ArrayCopy1D_</a></div><div class="ttdeci">#define _ArrayCopy1D_(x, y, size)</div><div class="ttdef"><b>Definition:</b> <a href="a00136_source.html#l00318">arrayfunctions.h:318</a></div></div>
<div class="ttc" id="a00105_html_afc23e46e08649e112e8d64d780cea5cb"><div class="ttname"><a href="a00105.html#afc23e46e08649e112e8d64d780cea5cb">CompactScheme::recvbuf</a></div><div class="ttdeci">double * recvbuf</div><div class="ttdef"><b>Definition:</b> <a href="a00105_source.html#l00444">interpolation.h:444</a></div></div>
<div class="ttc" id="a00115_html_a38e0371f331cecbe63a77fa03e202afe"><div class="ttname"><a href="a00115.html#a38e0371f331cecbe63a77fa03e202afe">HyPar::dim_local</a></div><div class="ttdeci">int * dim_local</div><div class="ttdef"><b>Definition:</b> <a href="a00143_source.html#l00035">hypar.h:35</a></div></div>
<div class="ttc" id="a00115_html_a22eef349f191a1aa267e14b08140c823"><div class="ttname"><a href="a00115.html#a22eef349f191a1aa267e14b08140c823">HyPar::GetRightEigenvectors</a></div><div class="ttdeci">int(* GetRightEigenvectors)(double *, double *, void *, int)</div><div class="ttdef"><b>Definition:</b> <a href="a00143_source.html#l00323">hypar.h:323</a></div></div>
<div class="ttc" id="a00131_html_ad2c404dd44e760ee729740176b186bd0"><div class="ttname"><a href="a00131.html#ad2c404dd44e760ee729740176b186bd0">blocktridiagLU</a></div><div class="ttdeci">int blocktridiagLU(double *, double *, double *, double *, int, int, int, void *, void *)</div><div class="ttdef"><b>Definition:</b> <a href="a00493_source.html#l00107">blocktridiagLU.c:107</a></div></div>
<div class="ttc" id="a00117_html_aa3c28612a64b8a97bde66b720e15c700"><div class="ttname"><a href="a00117.html#aa3c28612a64b8a97bde66b720e15c700">MPIVariables::ip</a></div><div class="ttdeci">int * ip</div><div class="ttdef"><b>Definition:</b> <a href="a00117_source.html#l00028">mpivars_struct.h:28</a></div></div>
<div class="ttc" id="a00117_html_a00516"><div class="ttname"><a href="a00117.html#a00516">MPIVariables</a></div><div class="ttdoc">Structure of MPI-related variables. </div><div class="ttdef"><b>Definition:</b> <a href="a00117_source.html#l00024">mpivars_struct.h:24</a></div></div>
<div class="ttc" id="a00137_html_add9cf96ae374934d245a1dc1ab697a42"><div class="ttname"><a href="a00137.html#add9cf96ae374934d245a1dc1ab697a42">CHECKERR</a></div><div class="ttdeci">#define CHECKERR(ierr)</div><div class="ttdef"><b>Definition:</b> <a href="a00137_source.html#l00014">basic.h:14</a></div></div>
<div class="ttc" id="a00115_html_a1dbfa1e479a373073b6ebf72401a7f0f"><div class="ttname"><a href="a00115.html#a1dbfa1e479a373073b6ebf72401a7f0f">HyPar::lusolver</a></div><div class="ttdeci">void * lusolver</div><div class="ttdef"><b>Definition:</b> <a href="a00143_source.html#l00332">hypar.h:332</a></div></div>
<div class="ttc" id="a00136_html_a03f49e4d44ae8aca85cb04cfe91e4ce4"><div class="ttname"><a href="a00136.html#a03f49e4d44ae8aca85cb04cfe91e4ce4">_ArrayIndexnD_</a></div><div class="ttdeci">#define _ArrayIndexnD_(N, index, imax, i, ghost)</div><div class="ttdef"><b>Definition:</b> <a href="a00136_source.html#l00020">arrayfunctions.h:20</a></div></div>
<div class="ttc" id="a00136_html_abc65e9c6a51b875f46fdb054a0ecf604"><div class="ttname"><a href="a00136.html#abc65e9c6a51b875f46fdb054a0ecf604">_ArrayProduct1D_</a></div><div class="ttdeci">#define _ArrayProduct1D_(x, size, p)</div><div class="ttdef"><b>Definition:</b> <a href="a00136_source.html#l00376">arrayfunctions.h:376</a></div></div>
<div class="ttc" id="a00115_html_a7331366d789b2995436accbc35e1cc80"><div class="ttname"><a href="a00115.html#a7331366d789b2995436accbc35e1cc80">HyPar::AveragingFunction</a></div><div class="ttdeci">int(* AveragingFunction)(double *, double *, double *, void *)</div><div class="ttdef"><b>Definition:</b> <a href="a00143_source.html#l00318">hypar.h:318</a></div></div>
<div class="ttc" id="a00105_html_ac900805a486cbb8489e3c176ed6e0d8e"><div class="ttname"><a href="a00105.html#ac900805a486cbb8489e3c176ed6e0d8e">CompactScheme::A</a></div><div class="ttdeci">double * A</div><div class="ttdef"><b>Definition:</b> <a href="a00105_source.html#l00439">interpolation.h:439</a></div></div>
<div class="ttc" id="a00136_html_afbb862a2fdf5b72b1f9ace42f64b556f"><div class="ttname"><a href="a00136.html#afbb862a2fdf5b72b1f9ace42f64b556f">_ArrayIndex1D_</a></div><div class="ttdeci">#define _ArrayIndex1D_(N, imax, i, ghost, index)</div><div class="ttdef"><b>Definition:</b> <a href="a00136_source.html#l00039">arrayfunctions.h:39</a></div></div>
<div class="ttc" id="a00117_html_a45a2dae130e8ef21ae3aa9c7a9e7a138"><div class="ttname"><a href="a00117.html#a45a2dae130e8ef21ae3aa9c7a9e7a138">MPIVariables::comm</a></div><div class="ttdeci">MPI_Comm * comm</div><div class="ttdef"><b>Definition:</b> <a href="a00117_source.html#l00038">mpivars_struct.h:38</a></div></div>
<div class="ttc" id="a00137_html_a68f50121fb9a7daeaf60e50cdef82ef3"><div class="ttname"><a href="a00137.html#a68f50121fb9a7daeaf60e50cdef82ef3">_DECLARE_IERR_</a></div><div class="ttdeci">#define _DECLARE_IERR_</div><div class="ttdef"><b>Definition:</b> <a href="a00137_source.html#l00013">basic.h:13</a></div></div>
<div class="ttc" id="a00105_html_ad36954709307649365515214a02ab06d"><div class="ttname"><a href="a00105.html#ad36954709307649365515214a02ab06d">CompactScheme::B</a></div><div class="ttdeci">double * B</div><div class="ttdef"><b>Definition:</b> <a href="a00105_source.html#l00439">interpolation.h:439</a></div></div>
<div class="ttc" id="a00115_html_a48e81a1806b5774943fd9a26e9a190f2"><div class="ttname"><a href="a00115.html#a48e81a1806b5774943fd9a26e9a190f2">HyPar::physics</a></div><div class="ttdeci">void * physics</div><div class="ttdef"><b>Definition:</b> <a href="a00143_source.html#l00245">hypar.h:245</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="abf3b032fdc8c0e84b86909db9e0b93c3"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int Interp1PrimFifthOrderWENOChar </td>
          <td>(</td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>fI</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>fC</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>u</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>upw</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>dir</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>s</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>m</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>uflag</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>5th order WENO reconstruction (characteristic-based) on a uniform grid </p>
<p>Characteristic-based interpolation of the first primitive at the cell interfaces using the fifth-order WENO scheme</p>
<p>Computes the interpolated values of the first primitive of a function \({\bf f}\left({\bf u}\right)\) at the interfaces from the cell-centered values of the function using the fifth order WENO scheme on a uniform grid. The first primitive is defined as a function \({\bf h}\left({\bf u}\right)\) that satisfies: </p>
<p class="formulaDsp">
\begin{equation} {\bf f}\left({\bf u}\left(x\right)\right) = \frac{1}{\Delta x} \int_{x-\Delta x/2}^{x+\Delta x/2} {\bf h}\left({\bf u}\left(\zeta\right)\right)d\zeta, \end{equation}
</p>
<p> where \(x\) is the spatial coordinate along the dimension of the interpolation. This function computes the 5th order WENO numerical approximation \(\hat{\bf f}_{j+1/2} \approx {\bf h}_{j+1/2}\) as the convex combination of three 3rd order methods: </p>
<p class="formulaDsp">
\begin{align} &amp;\ \omega_1\ \times\ \left[ \hat{\alpha}^k_{j+1/2} = \frac{1}{3} {\alpha}^k_{j-2} - \frac{7}{6} {\alpha}^k_{j-1} + \frac{11}{6} {\alpha}^k_j \right]\\ + &amp;\ \omega_2\ \times\ \left[ \hat{\alpha}^k_{j+1/2} = -\frac{1}{6} {\alpha}^k_{j-1} + \frac{5}{6} {\alpha}^k_j + \frac{1}{3} {\alpha}^k_{j+1} \right]\\ + &amp;\ \omega_3\ \times\ \left[ \hat{\alpha}^k_{j+1/2} = \frac{1}{3} {\alpha}^k_j + \frac{5}{6} {\alpha}^k_{j+1} - \frac{1}{6} {\alpha}^k_{j+2} \right]\\ \Rightarrow &amp;\ \hat{\alpha}^k_{j+1/2} = \frac{\omega_1}{3} {\alpha}^k_{j-2} - \frac{1}{6}(7\omega_1+\omega_2){\alpha}^k_{j-1} + \frac{1}{6}(11\omega_1+5\omega_2+2\omega_3){\alpha}^k_j + \frac{1}{6}(2\omega_2+5\omega_3){\alpha}^k_{j+1} - \frac{\omega_3}{6}{\alpha}^k_{j+2}, \end{align}
</p>
<p> where </p>
<p class="formulaDsp">
\begin{equation} \alpha^k = {\bf l}_k \cdot {\bf f},\ k=1,\cdots,n \end{equation}
</p>
<p> is the \(k\)-th characteristic quantity, and \({\bf l}_k\) is the \(k\)-th left eigenvector, \({\bf r}_k\) is the \(k\)-th right eigenvector, and \(n\) is <a class="el" href="a00115.html#ae8f6d2fd6490d3153cb4133bf183a404">HyPar::nvars</a>. The nonlinear weights \(\omega_k; k=1,2,3\) are the WENO weights computed in <a class="el" href="a00243.html#a6f1f5da1b6e5134bb1deccfad05a506d">WENOFifthOrderCalculateWeightsChar()</a>. The final interpolated function is computed from the interpolated characteristic quantities as: </p>
<p class="formulaDsp">
\begin{equation} \hat{\bf f}_{j+1/2} = \sum_{k=1}^n \alpha^k_{j+1/2} {\bf r}_k \end{equation}
</p>
<p><b>Implementation</b> <b>Notes:</b> </p>
<ul>
<li>This method assumes a uniform grid in the spatial dimension corresponding to the interpolation.</li>
<li>The method described above corresponds to a left-biased interpolation. The corresponding right-biased interpolation can be obtained by reflecting the equations about interface j+1/2.</li>
<li><p class="startli">The left and right eigenvectors are computed at an averaged quantity at j+1/2. Thus, this function requires functions to compute the average state, and the left and right eigenvectors. These are provided by the physical model through</p>
<ul>
<li><a class="el" href="a00115.html#a8c603c73be1f08e408a1de94a088da7b">HyPar::GetLeftEigenvectors()</a></li>
<li><a class="el" href="a00115.html#a22eef349f191a1aa267e14b08140c823">HyPar::GetRightEigenvectors()</a></li>
<li><a class="el" href="a00115.html#a7331366d789b2995436accbc35e1cc80">HyPar::AveragingFunction()</a></li>
</ul>
<p class="startli">If these functions are not provided by the physical model, then a characteristic-based interpolation cannot be used.</p>
</li>
<li>The function computes the interpolant for the entire grid in one call. It loops over all the grid lines along the interpolation direction and carries out the 1D interpolation along these grid lines.</li>
<li>Location of cell-centers and cell interfaces along the spatial dimension of the interpolation is shown in the following figure: <div class="image">
<img src="chap1_1Ddomain.png" alt="chap1_1Ddomain.png"/>
</div>
 </li>
</ul>
<p><b>Function</b> <b>arguments:</b> </p>
<table class="doxtable">
<tr>
<th>Argument </th><th>Type </th><th>Explanation  </th></tr>
<tr>
<td>fI </td><td>double* </td><td>Array to hold the computed interpolant at the grid interfaces. This array must have the same layout as the solution, but with <b>no</b> <b>ghost</b> <b>points</b>. Its size should be the same as u in all dimensions, except dir (the dimension along which to interpolate) along which it should be larger by 1 (number of interfaces is 1 more than the number of interior cell centers). </td></tr>
<tr>
<td>fC </td><td>double* </td><td>Array with the cell-centered values of the flux function \({\bf f}\left({\bf u}\right)\). This array must have the same layout and size as the solution, <b>with</b> <b>ghost</b> <b>points</b>. </td></tr>
<tr>
<td>u </td><td>double* </td><td>The solution array \({\bf u}\) (with ghost points). If the interpolation is characteristic based, this is needed to compute the eigendecomposition. For a multidimensional problem, the layout is as follows: u is a contiguous 1D array of size (nvars*dim[0]*dim[1]*...*dim[D-1]) corresponding to the multi-dimensional solution, with the following ordering - nvars, dim[0], dim[1], ..., dim[D-1], where nvars is the number of solution components (<a class="el" href="a00115.html#ae8f6d2fd6490d3153cb4133bf183a404">HyPar::nvars</a>), dim is the local size (<a class="el" href="a00115.html#a38e0371f331cecbe63a77fa03e202afe">HyPar::dim_local</a>), D is the number of spatial dimensions. </td></tr>
<tr>
<td>x </td><td>double* </td><td>The grid array (with ghost points). This is used only by non-uniform-grid interpolation methods. For multidimensional problems, the layout is as follows: x is a contiguous 1D array of size (dim[0]+dim[1]+...+dim[D-1]), with the spatial coordinates along dim[0] stored from 0,...,dim[0]-1, the spatial coordinates along dim[1] stored along dim[0],...,dim[0]+dim[1]-1, and so forth. </td></tr>
<tr>
<td>upw </td><td>int </td><td>Upwinding direction: if positive, a left-biased interpolant will be computed; if negative, a right-biased interpolant will be computed. If the interpolation method is central, then this has no effect. </td></tr>
<tr>
<td>dir </td><td>int </td><td>Spatial dimension along which to interpolate (eg: 0 for 1D; 0 or 1 for 2D; 0,1 or 2 for 3D) </td></tr>
<tr>
<td>s </td><td>void* </td><td>Solver object of type <a class="el" href="a00115.html" title="Structure containing all solver-specific variables and functions. ">HyPar</a>: the following variables are needed - <a class="el" href="a00115.html#aafc992b5fa79d5a4036024615d03bce6">HyPar::ghosts</a>, <a class="el" href="a00115.html#a484873c74138512e41bc50d17b7d955a">HyPar::ndims</a>, <a class="el" href="a00115.html#ae8f6d2fd6490d3153cb4133bf183a404">HyPar::nvars</a>, <a class="el" href="a00115.html#a38e0371f331cecbe63a77fa03e202afe">HyPar::dim_local</a>. </td></tr>
<tr>
<td>m </td><td>void* </td><td>MPI object of type <a class="el" href="a00117.html#a00516" title="Structure of MPI-related variables. ">MPIVariables</a>: this is needed only by compact interpolation method that need to solve a global implicit system across MPI ranks. </td></tr>
<tr>
<td>uflag </td><td>int </td><td>A flag indicating if the function being interpolated \({\bf f}\) is the solution itself \({\bf u}\) (if 1, \({\bf f}\left({\bf u}\right) \equiv {\bf u}\)). </td></tr>
</table>
<p><b>Reference:</b> </p>
<ul>
<li>Jiang, G.-S., Shu, C.-W., Efficient Implementation of Weighted ENO Schemes, J. Comput. Phys., 126 (1), 1996, pp. 202-228, <a href="http://dx.doi.org/10.1006/jcph.1996.0130">http://dx.doi.org/10.1006/jcph.1996.0130</a> </li>
</ul>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">fI</td><td>Array of interpolated function values at the interfaces </td></tr>
    <tr><td class="paramname">fC</td><td>Array of cell-centered values of the function \({\bf f}\left({\bf u}\right)\) </td></tr>
    <tr><td class="paramname">u</td><td>Array of cell-centered values of the solution \({\bf u}\) </td></tr>
    <tr><td class="paramname">x</td><td>Grid coordinates </td></tr>
    <tr><td class="paramname">upw</td><td>Upwind direction (left or right biased) </td></tr>
    <tr><td class="paramname">dir</td><td>Spatial dimension along which to interpolation </td></tr>
    <tr><td class="paramname">s</td><td>Object of type <a class="el" href="a00115.html" title="Structure containing all solver-specific variables and functions. ">HyPar</a> containing solver-related variables </td></tr>
    <tr><td class="paramname">m</td><td>Object of type <a class="el" href="a00117.html#a00516" title="Structure of MPI-related variables. ">MPIVariables</a> containing MPI-related variables </td></tr>
    <tr><td class="paramname">uflag</td><td>Flag to indicate if \(f(u) \equiv u\), i.e, if the solution is being reconstructed </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="a00231_source.html#l00085">85</a> of file <a class="el" href="a00231_source.html">Interp1PrimFifthOrderWENOChar.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;{</div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;  <a class="code" href="a00115.html">HyPar</a>           *solver = (<a class="code" href="a00115.html">HyPar</a>*) s;</div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;  <a class="code" href="a00105.html#a00523">WENOParameters</a>  *weno   = (<a class="code" href="a00105.html#a00523">WENOParameters</a>*) solver-&gt;<a class="code" href="a00115.html#a29c46b81ad574e4dfbad5a7211487dcb">interp</a>;</div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;  <span class="keywordtype">int</span>             i, k, v;</div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;  <a class="code" href="a00137.html#a68f50121fb9a7daeaf60e50cdef82ef3">_DECLARE_IERR_</a>;</div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;</div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;  <span class="keywordtype">int</span> ghosts = solver-&gt;<a class="code" href="a00115.html#aafc992b5fa79d5a4036024615d03bce6">ghosts</a>;</div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;  <span class="keywordtype">int</span> ndims  = solver-&gt;<a class="code" href="a00115.html#a484873c74138512e41bc50d17b7d955a">ndims</a>;</div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;  <span class="keywordtype">int</span> nvars  = solver-&gt;<a class="code" href="a00115.html#ae8f6d2fd6490d3153cb4133bf183a404">nvars</a>;</div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;  <span class="keywordtype">int</span> *dim   = solver-&gt;<a class="code" href="a00115.html#a38e0371f331cecbe63a77fa03e202afe">dim_local</a>;</div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;</div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;  <span class="comment">/* define some constants */</span></div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;  <span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">double</span> one_sixth          = 1.0/6.0;</div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;</div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;  <span class="keywordtype">double</span> *ww1, *ww2, *ww3;</div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;  ww1 = weno-&gt;<a class="code" href="a00105.html#a3ee56e3d8244b3d4582f1396a79f9791">w1</a> + (upw &lt; 0 ? 2*weno-&gt;size : 0) + (uflag ? weno-&gt;<a class="code" href="a00105.html#a439227feff9d7f55384e8780cfc2eb82">size</a> : 0) + weno-&gt;<a class="code" href="a00105.html#ad0c30ee1add42468a6d7c022f2efdf70">offset</a>[dir];</div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;  ww2 = weno-&gt;<a class="code" href="a00105.html#a31eb3c1fcb3bc85ab4fa156325a1f849">w2</a> + (upw &lt; 0 ? 2*weno-&gt;size : 0) + (uflag ? weno-&gt;<a class="code" href="a00105.html#a439227feff9d7f55384e8780cfc2eb82">size</a> : 0) + weno-&gt;<a class="code" href="a00105.html#ad0c30ee1add42468a6d7c022f2efdf70">offset</a>[dir];</div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;  ww3 = weno-&gt;<a class="code" href="a00105.html#aabd83eb3f8a7e3bb9f79a4a943bbd508">w3</a> + (upw &lt; 0 ? 2*weno-&gt;size : 0) + (uflag ? weno-&gt;<a class="code" href="a00105.html#a439227feff9d7f55384e8780cfc2eb82">size</a> : 0) + weno-&gt;<a class="code" href="a00105.html#ad0c30ee1add42468a6d7c022f2efdf70">offset</a>[dir];</div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;</div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;  <span class="comment">/* create index and bounds for the outer loop, i.e., to loop over all 1D lines along</span></div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;<span class="comment">     dimension &quot;dir&quot;                                                                    */</span></div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;  <span class="keywordtype">int</span> indexC[ndims], indexI[ndims], index_outer[ndims], bounds_outer[ndims], bounds_inter[ndims];</div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;  <a class="code" href="a00136.html#a89e8330d9e06dd0666c50833628a125c">_ArrayCopy1D_</a>(dim,bounds_outer,ndims); bounds_outer[dir] =  1;</div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;  <a class="code" href="a00136.html#a89e8330d9e06dd0666c50833628a125c">_ArrayCopy1D_</a>(dim,bounds_inter,ndims); bounds_inter[dir] += 1;</div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;  <span class="keywordtype">int</span> N_outer; <a class="code" href="a00136.html#abc65e9c6a51b875f46fdb054a0ecf604">_ArrayProduct1D_</a>(bounds_outer,ndims,N_outer);</div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;</div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;  <span class="comment">/* allocate arrays for the averaged state, eigenvectors and characteristic interpolated f */</span></div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;  <span class="keywordtype">double</span> R[nvars*nvars], L[nvars*nvars], uavg[nvars], fchar[nvars];</div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;</div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;<span class="preprocessor">#pragma omp parallel for schedule(auto) default(shared) private(i,k,v,R,L,uavg,fchar,index_outer,indexC,indexI)</span></div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;<span class="preprocessor"></span>  <span class="keywordflow">for</span> (i=0; i&lt;N_outer; i++) {</div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;    <a class="code" href="a00136.html#a03f49e4d44ae8aca85cb04cfe91e4ce4">_ArrayIndexnD_</a>(ndims,i,bounds_outer,index_outer,0);</div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;    <a class="code" href="a00136.html#a89e8330d9e06dd0666c50833628a125c">_ArrayCopy1D_</a>(index_outer,indexC,ndims);</div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;    <a class="code" href="a00136.html#a89e8330d9e06dd0666c50833628a125c">_ArrayCopy1D_</a>(index_outer,indexI,ndims);</div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;</div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;    <span class="keywordflow">for</span> (indexI[dir] = 0; indexI[dir] &lt; dim[dir]+1; indexI[dir]++) {</div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;</div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;      <span class="comment">/* 1D indices of the stencil grid points */</span></div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;      <span class="keywordtype">int</span> qm1,qm2,qm3,qp1,qp2;</div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;      <span class="keywordflow">if</span> (upw &gt; 0) {</div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;        indexC[dir] = indexI[dir]-3; <a class="code" href="a00136.html#afbb862a2fdf5b72b1f9ace42f64b556f">_ArrayIndex1D_</a>(ndims,dim,indexC,ghosts,qm3);</div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;        indexC[dir] = indexI[dir]-2; <a class="code" href="a00136.html#afbb862a2fdf5b72b1f9ace42f64b556f">_ArrayIndex1D_</a>(ndims,dim,indexC,ghosts,qm2);</div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;        indexC[dir] = indexI[dir]-1; <a class="code" href="a00136.html#afbb862a2fdf5b72b1f9ace42f64b556f">_ArrayIndex1D_</a>(ndims,dim,indexC,ghosts,qm1);</div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;        indexC[dir] = indexI[dir]  ; <a class="code" href="a00136.html#afbb862a2fdf5b72b1f9ace42f64b556f">_ArrayIndex1D_</a>(ndims,dim,indexC,ghosts,qp1);</div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;        indexC[dir] = indexI[dir]+1; <a class="code" href="a00136.html#afbb862a2fdf5b72b1f9ace42f64b556f">_ArrayIndex1D_</a>(ndims,dim,indexC,ghosts,qp2);</div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;      } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;        indexC[dir] = indexI[dir]+2; <a class="code" href="a00136.html#afbb862a2fdf5b72b1f9ace42f64b556f">_ArrayIndex1D_</a>(ndims,dim,indexC,ghosts,qm3);</div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;        indexC[dir] = indexI[dir]+1; <a class="code" href="a00136.html#afbb862a2fdf5b72b1f9ace42f64b556f">_ArrayIndex1D_</a>(ndims,dim,indexC,ghosts,qm2);</div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;        indexC[dir] = indexI[dir]  ; <a class="code" href="a00136.html#afbb862a2fdf5b72b1f9ace42f64b556f">_ArrayIndex1D_</a>(ndims,dim,indexC,ghosts,qm1);</div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;        indexC[dir] = indexI[dir]-1; <a class="code" href="a00136.html#afbb862a2fdf5b72b1f9ace42f64b556f">_ArrayIndex1D_</a>(ndims,dim,indexC,ghosts,qp1);</div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;        indexC[dir] = indexI[dir]-2; <a class="code" href="a00136.html#afbb862a2fdf5b72b1f9ace42f64b556f">_ArrayIndex1D_</a>(ndims,dim,indexC,ghosts,qp2);</div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;      }</div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;</div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;      <span class="keywordtype">int</span> p; <span class="comment">/* 1D index of the interface */</span></div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;      <a class="code" href="a00136.html#afbb862a2fdf5b72b1f9ace42f64b556f">_ArrayIndex1D_</a>(ndims,bounds_inter,indexI,0,p);</div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;</div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;      <span class="comment">/* find averaged state at this interface */</span></div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;      <a class="code" href="a00137.html#ad6ab74942c9de13cf0b4c12eb0d91780">IERR</a> solver-&gt;<a class="code" href="a00115.html#a7331366d789b2995436accbc35e1cc80">AveragingFunction</a>(uavg,&amp;u[nvars*qm1],&amp;u[nvars*qp1],solver-&gt;<a class="code" href="a00115.html#a48e81a1806b5774943fd9a26e9a190f2">physics</a>); <a class="code" href="a00137.html#add9cf96ae374934d245a1dc1ab697a42">CHECKERR</a>(ierr);</div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;</div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;      <span class="comment">/* Get the left and right eigenvectors */</span></div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;      <a class="code" href="a00137.html#ad6ab74942c9de13cf0b4c12eb0d91780">IERR</a> solver-&gt;<a class="code" href="a00115.html#a8c603c73be1f08e408a1de94a088da7b">GetLeftEigenvectors</a>  (uavg,L,solver-&gt;<a class="code" href="a00115.html#a48e81a1806b5774943fd9a26e9a190f2">physics</a>,dir); <a class="code" href="a00137.html#add9cf96ae374934d245a1dc1ab697a42">CHECKERR</a>(ierr);</div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;      <a class="code" href="a00137.html#ad6ab74942c9de13cf0b4c12eb0d91780">IERR</a> solver-&gt;<a class="code" href="a00115.html#a22eef349f191a1aa267e14b08140c823">GetRightEigenvectors</a> (uavg,R,solver-&gt;<a class="code" href="a00115.html#a48e81a1806b5774943fd9a26e9a190f2">physics</a>,dir); <a class="code" href="a00137.html#add9cf96ae374934d245a1dc1ab697a42">CHECKERR</a>(ierr);</div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;</div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;      <span class="comment">/* For each characteristic field */</span></div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;      <span class="keywordflow">for</span> (v = 0; v &lt; nvars; v++) {</div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;</div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;        <span class="comment">/* calculate the characteristic flux components along this characteristic */</span></div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;        <span class="keywordtype">double</span> fm3, fm2, fm1, fp1, fp2;</div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;        fm3 = fm2 = fm1 = fp1 = fp2 = 0;</div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;        <span class="keywordflow">for</span> (k = 0; k &lt; nvars; k++) {</div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;          fm3 += L[v*nvars+k] * fC[qm3*nvars+k];</div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;          fm2 += L[v*nvars+k] * fC[qm2*nvars+k];</div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;          fm1 += L[v*nvars+k] * fC[qm1*nvars+k];</div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;          fp1 += L[v*nvars+k] * fC[qp1*nvars+k];</div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;          fp2 += L[v*nvars+k] * fC[qp2*nvars+k];</div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;        }</div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;</div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;        <span class="comment">/* Candidate stencils and their optimal weights*/</span></div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;        <span class="keywordtype">double</span> f1, f2, f3;</div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;        f1 = (2*one_sixth)*fm3 - (7.0*one_sixth)*fm2 + (11.0*one_sixth)*fm1;</div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;        f2 = (-one_sixth)*fm2 + (5.0*one_sixth)*fm1 + (2*one_sixth)*fp1;</div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;        f3 = (2*one_sixth)*fm1 + (5*one_sixth)*fp1 - (one_sixth)*fp2;</div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;</div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;        <span class="comment">/* calculate WENO weights */</span></div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;        <span class="keywordtype">double</span> w1,w2,w3;</div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;        w1 = *(ww1+p*nvars+v);</div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;        w2 = *(ww2+p*nvars+v);</div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;        w3 = *(ww3+p*nvars+v);</div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;</div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;        <span class="comment">/* fifth order WENO approximation of the characteristic flux */</span></div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;        fchar[v] = w1*f1 + w2*f2 + w3*f3;</div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;</div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;      }</div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;</div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;      <span class="comment">/* calculate the interface u from the characteristic u */</span></div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;      <a class="code" href="a00137.html#ad6ab74942c9de13cf0b4c12eb0d91780">IERR</a> <a class="code" href="a00147.html#a3dc53d4eb4ba0f2cfed00aa69617ee84">MatVecMult</a>(nvars,(fI+nvars*p),R,fchar); <a class="code" href="a00137.html#add9cf96ae374934d245a1dc1ab697a42">CHECKERR</a>(ierr);</div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;</div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;    }</div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;  }</div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;</div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;  <span class="keywordflow">return</span>(0);</div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;}</div>
<div class="ttc" id="a00115_html_a484873c74138512e41bc50d17b7d955a"><div class="ttname"><a href="a00115.html#a484873c74138512e41bc50d17b7d955a">HyPar::ndims</a></div><div class="ttdeci">int ndims</div><div class="ttdef"><b>Definition:</b> <a href="a00143_source.html#l00026">hypar.h:26</a></div></div>
<div class="ttc" id="a00115_html_aafc992b5fa79d5a4036024615d03bce6"><div class="ttname"><a href="a00115.html#aafc992b5fa79d5a4036024615d03bce6">HyPar::ghosts</a></div><div class="ttdeci">int ghosts</div><div class="ttdef"><b>Definition:</b> <a href="a00143_source.html#l00044">hypar.h:44</a></div></div>
<div class="ttc" id="a00115_html"><div class="ttname"><a href="a00115.html">HyPar</a></div><div class="ttdoc">Structure containing all solver-specific variables and functions. </div><div class="ttdef"><b>Definition:</b> <a href="a00143_source.html#l00023">hypar.h:23</a></div></div>
<div class="ttc" id="a00105_html_a3ee56e3d8244b3d4582f1396a79f9791"><div class="ttname"><a href="a00105.html#a3ee56e3d8244b3d4582f1396a79f9791">WENOParameters::w1</a></div><div class="ttdeci">double * w1</div><div class="ttdef"><b>Definition:</b> <a href="a00105_source.html#l00193">interpolation.h:193</a></div></div>
<div class="ttc" id="a00105_html_a31eb3c1fcb3bc85ab4fa156325a1f849"><div class="ttname"><a href="a00105.html#a31eb3c1fcb3bc85ab4fa156325a1f849">WENOParameters::w2</a></div><div class="ttdeci">double * w2</div><div class="ttdef"><b>Definition:</b> <a href="a00105_source.html#l00193">interpolation.h:193</a></div></div>
<div class="ttc" id="a00137_html_ad6ab74942c9de13cf0b4c12eb0d91780"><div class="ttname"><a href="a00137.html#ad6ab74942c9de13cf0b4c12eb0d91780">IERR</a></div><div class="ttdeci">#define IERR</div><div class="ttdef"><b>Definition:</b> <a href="a00137_source.html#l00012">basic.h:12</a></div></div>
<div class="ttc" id="a00105_html_a00523"><div class="ttname"><a href="a00105.html#a00523">WENOParameters</a></div><div class="ttdoc">Structure of variables/parameters needed by the WENO-type scheme. </div><div class="ttdef"><b>Definition:</b> <a href="a00105_source.html#l00175">interpolation.h:175</a></div></div>
<div class="ttc" id="a00105_html_a439227feff9d7f55384e8780cfc2eb82"><div class="ttname"><a href="a00105.html#a439227feff9d7f55384e8780cfc2eb82">WENOParameters::size</a></div><div class="ttdeci">int size</div><div class="ttdef"><b>Definition:</b> <a href="a00105_source.html#l00197">interpolation.h:197</a></div></div>
<div class="ttc" id="a00115_html_a8c603c73be1f08e408a1de94a088da7b"><div class="ttname"><a href="a00115.html#a8c603c73be1f08e408a1de94a088da7b">HyPar::GetLeftEigenvectors</a></div><div class="ttdeci">int(* GetLeftEigenvectors)(double *, double *, void *, int)</div><div class="ttdef"><b>Definition:</b> <a href="a00143_source.html#l00321">hypar.h:321</a></div></div>
<div class="ttc" id="a00105_html_aabd83eb3f8a7e3bb9f79a4a943bbd508"><div class="ttname"><a href="a00105.html#aabd83eb3f8a7e3bb9f79a4a943bbd508">WENOParameters::w3</a></div><div class="ttdeci">double * w3</div><div class="ttdef"><b>Definition:</b> <a href="a00105_source.html#l00193">interpolation.h:193</a></div></div>
<div class="ttc" id="a00115_html_ae8f6d2fd6490d3153cb4133bf183a404"><div class="ttname"><a href="a00115.html#ae8f6d2fd6490d3153cb4133bf183a404">HyPar::nvars</a></div><div class="ttdeci">int nvars</div><div class="ttdef"><b>Definition:</b> <a href="a00143_source.html#l00029">hypar.h:29</a></div></div>
<div class="ttc" id="a00136_html_a89e8330d9e06dd0666c50833628a125c"><div class="ttname"><a href="a00136.html#a89e8330d9e06dd0666c50833628a125c">_ArrayCopy1D_</a></div><div class="ttdeci">#define _ArrayCopy1D_(x, y, size)</div><div class="ttdef"><b>Definition:</b> <a href="a00136_source.html#l00318">arrayfunctions.h:318</a></div></div>
<div class="ttc" id="a00115_html_a38e0371f331cecbe63a77fa03e202afe"><div class="ttname"><a href="a00115.html#a38e0371f331cecbe63a77fa03e202afe">HyPar::dim_local</a></div><div class="ttdeci">int * dim_local</div><div class="ttdef"><b>Definition:</b> <a href="a00143_source.html#l00035">hypar.h:35</a></div></div>
<div class="ttc" id="a00115_html_a22eef349f191a1aa267e14b08140c823"><div class="ttname"><a href="a00115.html#a22eef349f191a1aa267e14b08140c823">HyPar::GetRightEigenvectors</a></div><div class="ttdeci">int(* GetRightEigenvectors)(double *, double *, void *, int)</div><div class="ttdef"><b>Definition:</b> <a href="a00143_source.html#l00323">hypar.h:323</a></div></div>
<div class="ttc" id="a00137_html_add9cf96ae374934d245a1dc1ab697a42"><div class="ttname"><a href="a00137.html#add9cf96ae374934d245a1dc1ab697a42">CHECKERR</a></div><div class="ttdeci">#define CHECKERR(ierr)</div><div class="ttdef"><b>Definition:</b> <a href="a00137_source.html#l00014">basic.h:14</a></div></div>
<div class="ttc" id="a00136_html_a03f49e4d44ae8aca85cb04cfe91e4ce4"><div class="ttname"><a href="a00136.html#a03f49e4d44ae8aca85cb04cfe91e4ce4">_ArrayIndexnD_</a></div><div class="ttdeci">#define _ArrayIndexnD_(N, index, imax, i, ghost)</div><div class="ttdef"><b>Definition:</b> <a href="a00136_source.html#l00020">arrayfunctions.h:20</a></div></div>
<div class="ttc" id="a00115_html_a29c46b81ad574e4dfbad5a7211487dcb"><div class="ttname"><a href="a00115.html#a29c46b81ad574e4dfbad5a7211487dcb">HyPar::interp</a></div><div class="ttdeci">void * interp</div><div class="ttdef"><b>Definition:</b> <a href="a00143_source.html#l00326">hypar.h:326</a></div></div>
<div class="ttc" id="a00136_html_abc65e9c6a51b875f46fdb054a0ecf604"><div class="ttname"><a href="a00136.html#abc65e9c6a51b875f46fdb054a0ecf604">_ArrayProduct1D_</a></div><div class="ttdeci">#define _ArrayProduct1D_(x, size, p)</div><div class="ttdef"><b>Definition:</b> <a href="a00136_source.html#l00376">arrayfunctions.h:376</a></div></div>
<div class="ttc" id="a00115_html_a7331366d789b2995436accbc35e1cc80"><div class="ttname"><a href="a00115.html#a7331366d789b2995436accbc35e1cc80">HyPar::AveragingFunction</a></div><div class="ttdeci">int(* AveragingFunction)(double *, double *, double *, void *)</div><div class="ttdef"><b>Definition:</b> <a href="a00143_source.html#l00318">hypar.h:318</a></div></div>
<div class="ttc" id="a00136_html_afbb862a2fdf5b72b1f9ace42f64b556f"><div class="ttname"><a href="a00136.html#afbb862a2fdf5b72b1f9ace42f64b556f">_ArrayIndex1D_</a></div><div class="ttdeci">#define _ArrayIndex1D_(N, imax, i, ghost, index)</div><div class="ttdef"><b>Definition:</b> <a href="a00136_source.html#l00039">arrayfunctions.h:39</a></div></div>
<div class="ttc" id="a00147_html_a3dc53d4eb4ba0f2cfed00aa69617ee84"><div class="ttname"><a href="a00147.html#a3dc53d4eb4ba0f2cfed00aa69617ee84">MatVecMult</a></div><div class="ttdeci">#define MatVecMult(N, y, A, x)</div><div class="ttdef"><b>Definition:</b> <a href="a00147_source.html#l00162">mathfunctions.h:162</a></div></div>
<div class="ttc" id="a00105_html_ad0c30ee1add42468a6d7c022f2efdf70"><div class="ttname"><a href="a00105.html#ad0c30ee1add42468a6d7c022f2efdf70">WENOParameters::offset</a></div><div class="ttdeci">int * offset</div><div class="ttdef"><b>Definition:</b> <a href="a00105_source.html#l00197">interpolation.h:197</a></div></div>
<div class="ttc" id="a00137_html_a68f50121fb9a7daeaf60e50cdef82ef3"><div class="ttname"><a href="a00137.html#a68f50121fb9a7daeaf60e50cdef82ef3">_DECLARE_IERR_</a></div><div class="ttdeci">#define _DECLARE_IERR_</div><div class="ttdef"><b>Definition:</b> <a href="a00137_source.html#l00013">basic.h:13</a></div></div>
<div class="ttc" id="a00115_html_a48e81a1806b5774943fd9a26e9a190f2"><div class="ttname"><a href="a00115.html#a48e81a1806b5774943fd9a26e9a190f2">HyPar::physics</a></div><div class="ttdeci">void * physics</div><div class="ttdef"><b>Definition:</b> <a href="a00143_source.html#l00245">hypar.h:245</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ae2b27971cc952cf3b4959128bef6174b"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int Interp1PrimFifthOrderCRWENOChar </td>
          <td>(</td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>fI</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>fC</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>u</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>upw</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>dir</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>s</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>m</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>uflag</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>5th order CRWENO reconstruction (characteristic-based) on a uniform grid </p>
<p>Characteristic-based interpolation of the first primitive at the cell interfaces using the fifth-order CRWENO scheme</p>
<p>Computes the interpolated values of the first primitive of a function \({\bf f}\left({\bf u}\right)\) at the interfaces from the cell-centered values of the function using the fifth order CRWENO scheme on a uniform grid. The first primitive is defined as a function \({\bf h}\left({\bf u}\right)\) that satisfies: </p>
<p class="formulaDsp">
\begin{equation} {\bf f}\left({\bf u}\left(x\right)\right) = \frac{1}{\Delta x} \int_{x-\Delta x/2}^{x+\Delta x/2} {\bf h}\left({\bf u}\left(\zeta\right)\right)d\zeta, \end{equation}
</p>
<p> where \(x\) is the spatial coordinate along the dimension of the interpolation. This function computes the 5th order CRWENO numerical approximation \(\hat{\bf f}_{j+1/2} \approx {\bf h}_{j+1/2}\) as the convex combination of three 3rd order methods: </p>
<p class="formulaDsp">
\begin{align} &amp;\ \omega_1\ \times\ \left[ \frac{2}{3}\hat{\alpha}^k_{j-1/2} + \frac{1}{3}\hat{\alpha}^k_{j+1/2} = \frac{1}{6} \left( f_{j-1} + 5f_j \right) \right]\\ + &amp;\ \omega_2\ \times\ \left[ \frac{1}{3}\hat{\alpha}^k_{j-1/2}+\frac{2}{3}\hat{\alpha}^k_{j+1/2} = \frac{1}{6} \left( 5f_j + f_{j+1} \right) \right] \\ + &amp;\ \omega_3\ \times\ \left[ \frac{2}{3}\hat{\alpha}^k_{j+1/2} + \frac{1}{3}\hat{\alpha}^k_{j+3/2} = \frac{1}{6} \left( f_j + 5f_{j+1} \right) \right] \\ \Rightarrow &amp;\ \left(\frac{2}{3}\omega_1+\frac{1}{3}\omega_2\right)\hat{\alpha}^k_{j-1/2} + \left[\frac{1}{3}\omega_1+\frac{2}{3}(\omega_2+\omega_3)\right]\hat{\alpha}^k_{j+1/2} + \frac{1}{3}\omega_3\hat{\alpha}^k_{j+3/2} = \frac{\omega_1}{6}{\alpha}^k_{j-1} + \frac{5(\omega_1+\omega_2)+\omega_3}{6}{\alpha}^k_j + \frac{\omega_2+5\omega_3}{6}{\alpha}^k_{j+1}, \end{align}
</p>
<p> where </p>
<p class="formulaDsp">
\begin{equation} \alpha^k = {\bf l}_k \cdot {\bf f},\ k=1,\cdots,n \end{equation}
</p>
<p> is the \(k\)-th characteristic quantity, and \({\bf l}_k\) is the \(k\)-th left eigenvector, \({\bf r}_k\) is the \(k\)-th right eigenvector, and \(n\) is <a class="el" href="a00115.html#ae8f6d2fd6490d3153cb4133bf183a404">HyPar::nvars</a>. The nonlinear weights \(\omega_k; k=1,2,3\) are the WENO weights computed in <a class="el" href="a00243.html#a6f1f5da1b6e5134bb1deccfad05a506d">WENOFifthOrderCalculateWeightsChar()</a>. The resulting block tridiagonal system is solved using <a class="el" href="a00131.html#ad2c404dd44e760ee729740176b186bd0">blocktridiagLU()</a> (see also <a class="el" href="a00131.html#a00521">TridiagLU</a>, <a class="el" href="a00131.html" title="Header file for TridiagLU. ">tridiagLU.h</a>). The final interpolated function is computed from the interpolated characteristic quantities as: </p>
<p class="formulaDsp">
\begin{equation} \hat{\bf f}_{j+1/2} = \sum_{k=1}^n \alpha^k_{j+1/2} {\bf r}_k \end{equation}
</p>
<p><b>Implementation</b> <b>Notes:</b> </p>
<ul>
<li>This method assumes a uniform grid in the spatial dimension corresponding to the interpolation.</li>
<li>The method described above corresponds to a left-biased interpolation. The corresponding right-biased interpolation can be obtained by reflecting the equations about interface j+1/2.</li>
<li><p class="startli">The left and right eigenvectors are computed at an averaged quantity at j+1/2. Thus, this function requires functions to compute the average state, and the left and right eigenvectors. These are provided by the physical model through</p>
<ul>
<li><a class="el" href="a00115.html#a8c603c73be1f08e408a1de94a088da7b">HyPar::GetLeftEigenvectors()</a></li>
<li><a class="el" href="a00115.html#a22eef349f191a1aa267e14b08140c823">HyPar::GetRightEigenvectors()</a></li>
<li><a class="el" href="a00115.html#a7331366d789b2995436accbc35e1cc80">HyPar::AveragingFunction()</a></li>
</ul>
<p class="startli">If these functions are not provided by the physical model, then a characteristic-based interpolation cannot be used.</p>
</li>
<li>The function computes the interpolant for the entire grid in one call. It loops over all the grid lines along the interpolation direction and carries out the 1D interpolation along these grid lines.</li>
<li>Location of cell-centers and cell interfaces along the spatial dimension of the interpolation is shown in the following figure: <div class="image">
<img src="chap1_1Ddomain.png" alt="chap1_1Ddomain.png"/>
</div>
 </li>
</ul>
<p><b>Function</b> <b>arguments:</b> </p>
<table class="doxtable">
<tr>
<th>Argument </th><th>Type </th><th>Explanation  </th></tr>
<tr>
<td>fI </td><td>double* </td><td>Array to hold the computed interpolant at the grid interfaces. This array must have the same layout as the solution, but with <b>no</b> <b>ghost</b> <b>points</b>. Its size should be the same as u in all dimensions, except dir (the dimension along which to interpolate) along which it should be larger by 1 (number of interfaces is 1 more than the number of interior cell centers). </td></tr>
<tr>
<td>fC </td><td>double* </td><td>Array with the cell-centered values of the flux function \({\bf f}\left({\bf u}\right)\). This array must have the same layout and size as the solution, <b>with</b> <b>ghost</b> <b>points</b>. </td></tr>
<tr>
<td>u </td><td>double* </td><td>The solution array \({\bf u}\) (with ghost points). If the interpolation is characteristic based, this is needed to compute the eigendecomposition. For a multidimensional problem, the layout is as follows: u is a contiguous 1D array of size (nvars*dim[0]*dim[1]*...*dim[D-1]) corresponding to the multi-dimensional solution, with the following ordering - nvars, dim[0], dim[1], ..., dim[D-1], where nvars is the number of solution components (<a class="el" href="a00115.html#ae8f6d2fd6490d3153cb4133bf183a404">HyPar::nvars</a>), dim is the local size (<a class="el" href="a00115.html#a38e0371f331cecbe63a77fa03e202afe">HyPar::dim_local</a>), D is the number of spatial dimensions. </td></tr>
<tr>
<td>x </td><td>double* </td><td>The grid array (with ghost points). This is used only by non-uniform-grid interpolation methods. For multidimensional problems, the layout is as follows: x is a contiguous 1D array of size (dim[0]+dim[1]+...+dim[D-1]), with the spatial coordinates along dim[0] stored from 0,...,dim[0]-1, the spatial coordinates along dim[1] stored along dim[0],...,dim[0]+dim[1]-1, and so forth. </td></tr>
<tr>
<td>upw </td><td>int </td><td>Upwinding direction: if positive, a left-biased interpolant will be computed; if negative, a right-biased interpolant will be computed. If the interpolation method is central, then this has no effect. </td></tr>
<tr>
<td>dir </td><td>int </td><td>Spatial dimension along which to interpolate (eg: 0 for 1D; 0 or 1 for 2D; 0,1 or 2 for 3D) </td></tr>
<tr>
<td>s </td><td>void* </td><td>Solver object of type <a class="el" href="a00115.html" title="Structure containing all solver-specific variables and functions. ">HyPar</a>: the following variables are needed - <a class="el" href="a00115.html#aafc992b5fa79d5a4036024615d03bce6">HyPar::ghosts</a>, <a class="el" href="a00115.html#a484873c74138512e41bc50d17b7d955a">HyPar::ndims</a>, <a class="el" href="a00115.html#ae8f6d2fd6490d3153cb4133bf183a404">HyPar::nvars</a>, <a class="el" href="a00115.html#a38e0371f331cecbe63a77fa03e202afe">HyPar::dim_local</a>. </td></tr>
<tr>
<td>m </td><td>void* </td><td>MPI object of type <a class="el" href="a00117.html#a00516" title="Structure of MPI-related variables. ">MPIVariables</a>: this is needed only by compact interpolation method that need to solve a global implicit system across MPI ranks. </td></tr>
<tr>
<td>uflag </td><td>int </td><td>A flag indicating if the function being interpolated \({\bf f}\) is the solution itself \({\bf u}\) (if 1, \({\bf f}\left({\bf u}\right) \equiv {\bf u}\)). </td></tr>
</table>
<p><b>Reference:</b> </p>
<ul>
<li>Ghosh, D., Baeder, J. D., Compact Reconstruction Schemes with Weighted ENO Limiting for Hyperbolic Conservation Laws, SIAM Journal on Scientific Computing, 34 (3), 2012, A1678A1706, <a href="http://dx.doi.org/10.1137/110857659">http://dx.doi.org/10.1137/110857659</a></li>
<li>Ghosh, D., Constantinescu, E. M., Brown, J., Efficient Implementation of Nonlinear Compact Schemes on Massively Parallel Platforms, SIAM Journal on Scientific Computing, 37 (3), 2015, C354C383, <a href="http://dx.doi.org/10.1137/140989261">http://dx.doi.org/10.1137/140989261</a> </li>
</ul>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">fI</td><td>Array of interpolated function values at the interfaces </td></tr>
    <tr><td class="paramname">fC</td><td>Array of cell-centered values of the function \({\bf f}\left({\bf u}\right)\) </td></tr>
    <tr><td class="paramname">u</td><td>Array of cell-centered values of the solution \({\bf u}\) </td></tr>
    <tr><td class="paramname">x</td><td>Grid coordinates </td></tr>
    <tr><td class="paramname">upw</td><td>Upwind direction (left or right biased) </td></tr>
    <tr><td class="paramname">dir</td><td>Spatial dimension along which to interpolation </td></tr>
    <tr><td class="paramname">s</td><td>Object of type <a class="el" href="a00115.html" title="Structure containing all solver-specific variables and functions. ">HyPar</a> containing solver-related variables </td></tr>
    <tr><td class="paramname">m</td><td>Object of type <a class="el" href="a00117.html#a00516" title="Structure of MPI-related variables. ">MPIVariables</a> containing MPI-related variables </td></tr>
    <tr><td class="paramname">uflag</td><td>Flag to indicate if \(f(u) \equiv u\), i.e, if the solution is being reconstructed </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="a00225_source.html#l00092">92</a> of file <a class="el" href="a00225_source.html">Interp1PrimFifthOrderCRWENOChar.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;{</div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;  <a class="code" href="a00115.html">HyPar</a>           *solver = (<a class="code" href="a00115.html">HyPar</a>*)          s;</div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;  <a class="code" href="a00117.html#a00516">MPIVariables</a>    *mpi    = (<a class="code" href="a00117.html#a00516">MPIVariables</a>*)   m;</div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;  <a class="code" href="a00105.html#a00503">CompactScheme</a>   *compact= (<a class="code" href="a00105.html#a00503">CompactScheme</a>*)  solver-&gt;<a class="code" href="a00115.html#a56318721d534e74a96b440f8542a0232">compact</a>;</div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;  <a class="code" href="a00105.html#a00523">WENOParameters</a>  *weno   = (<a class="code" href="a00105.html#a00523">WENOParameters</a>*) solver-&gt;<a class="code" href="a00115.html#a29c46b81ad574e4dfbad5a7211487dcb">interp</a>;</div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;  <a class="code" href="a00131.html#a00521">TridiagLU</a>       *lu     = (<a class="code" href="a00131.html#a00521">TridiagLU</a>*)      solver-&gt;<a class="code" href="a00115.html#a1dbfa1e479a373073b6ebf72401a7f0f">lusolver</a>;</div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;  <span class="keywordtype">int</span>             sys,Nsys,d,v,k;</div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;  <a class="code" href="a00137.html#a68f50121fb9a7daeaf60e50cdef82ef3">_DECLARE_IERR_</a>;</div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;</div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;  <span class="keywordtype">int</span> ghosts = solver-&gt;<a class="code" href="a00115.html#aafc992b5fa79d5a4036024615d03bce6">ghosts</a>;</div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;  <span class="keywordtype">int</span> ndims  = solver-&gt;<a class="code" href="a00115.html#a484873c74138512e41bc50d17b7d955a">ndims</a>;</div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;  <span class="keywordtype">int</span> nvars  = solver-&gt;<a class="code" href="a00115.html#ae8f6d2fd6490d3153cb4133bf183a404">nvars</a>;</div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;  <span class="keywordtype">int</span> *dim   = solver-&gt;<a class="code" href="a00115.html#a38e0371f331cecbe63a77fa03e202afe">dim_local</a>;</div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;</div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;  <span class="comment">/* define some constants */</span></div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;  <span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">double</span> one_third          = 1.0/3.0;</div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;  <span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">double</span> one_sixth          = 1.0/6.0;</div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;</div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;  <span class="keywordtype">double</span> *ww1, *ww2, *ww3;</div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;  ww1 = weno-&gt;w1 + (upw &lt; 0 ? 2*weno-&gt;size : 0) + (uflag ? weno-&gt;size : 0) + weno-&gt;offset[dir];</div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;  ww2 = weno-&gt;w2 + (upw &lt; 0 ? 2*weno-&gt;size : 0) + (uflag ? weno-&gt;size : 0) + weno-&gt;offset[dir];</div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;  ww3 = weno-&gt;w3 + (upw &lt; 0 ? 2*weno-&gt;size : 0) + (uflag ? weno-&gt;size : 0) + weno-&gt;offset[dir];</div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;</div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;  <span class="comment">/* create index and bounds for the outer loop, i.e., to loop over all 1D lines along</span></div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;<span class="comment">     dimension &quot;dir&quot;                                                                    */</span></div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;  <span class="keywordtype">int</span> indexC[ndims], indexI[ndims], index_outer[ndims], bounds_outer[ndims], bounds_inter[ndims];</div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;  <a class="code" href="a00136.html#a89e8330d9e06dd0666c50833628a125c">_ArrayCopy1D_</a>(dim,bounds_outer,ndims); bounds_outer[dir] =  1;</div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;  <a class="code" href="a00136.html#a89e8330d9e06dd0666c50833628a125c">_ArrayCopy1D_</a>(dim,bounds_inter,ndims); bounds_inter[dir] += 1;</div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;</div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;  <span class="comment">/* calculate total number of block tridiagonal systems to solve */</span></div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;  <a class="code" href="a00136.html#abc65e9c6a51b875f46fdb054a0ecf604">_ArrayProduct1D_</a>(bounds_outer,ndims,Nsys);</div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;</div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;  <span class="comment">/* allocate arrays for the averaged state, eigenvectors and characteristic interpolated f */</span></div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;  <span class="keywordtype">double</span> R[nvars*nvars], L[nvars*nvars], uavg[nvars];</div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;</div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;  <span class="comment">/* Allocate arrays for tridiagonal system */</span></div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;  <span class="keywordtype">double</span> *A = compact-&gt;<a class="code" href="a00105.html#ac900805a486cbb8489e3c176ed6e0d8e">A</a>;</div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;  <span class="keywordtype">double</span> *B = compact-&gt;<a class="code" href="a00105.html#ad36954709307649365515214a02ab06d">B</a>;</div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;  <span class="keywordtype">double</span> *C = compact-&gt;<a class="code" href="a00105.html#a0a26ce8d1878aac6ddc87e3f6290e039">C</a>;</div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;  <span class="keywordtype">double</span> *F = compact-&gt;<a class="code" href="a00105.html#ac06de847603f5cfaec085f6fe500f3c8">R</a>;</div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;</div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;<span class="preprocessor">#pragma omp parallel for schedule(auto) default(shared) private(sys,d,v,k,R,L,uavg,index_outer,indexC,indexI)</span></div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;<span class="preprocessor"></span>  <span class="keywordflow">for</span> (sys=0; sys&lt;Nsys; sys++) {</div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;    <a class="code" href="a00136.html#a03f49e4d44ae8aca85cb04cfe91e4ce4">_ArrayIndexnD_</a>(ndims,sys,bounds_outer,index_outer,0);</div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;    <a class="code" href="a00136.html#a89e8330d9e06dd0666c50833628a125c">_ArrayCopy1D_</a>(index_outer,indexC,ndims);</div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;    <a class="code" href="a00136.html#a89e8330d9e06dd0666c50833628a125c">_ArrayCopy1D_</a>(index_outer,indexI,ndims);</div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;    <span class="keywordflow">for</span> (indexI[dir] = 0; indexI[dir] &lt; dim[dir]+1; indexI[dir]++) {</div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;      <span class="keywordtype">int</span> qm1,qm2,qm3,qp1,qp2;</div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;      <span class="keywordflow">if</span> (upw &gt; 0) {</div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;        indexC[dir] = indexI[dir]-3; <a class="code" href="a00136.html#afbb862a2fdf5b72b1f9ace42f64b556f">_ArrayIndex1D_</a>(ndims,dim,indexC,ghosts,qm3);</div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;        indexC[dir] = indexI[dir]-2; <a class="code" href="a00136.html#afbb862a2fdf5b72b1f9ace42f64b556f">_ArrayIndex1D_</a>(ndims,dim,indexC,ghosts,qm2);</div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;        indexC[dir] = indexI[dir]-1; <a class="code" href="a00136.html#afbb862a2fdf5b72b1f9ace42f64b556f">_ArrayIndex1D_</a>(ndims,dim,indexC,ghosts,qm1);</div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;        indexC[dir] = indexI[dir]  ; <a class="code" href="a00136.html#afbb862a2fdf5b72b1f9ace42f64b556f">_ArrayIndex1D_</a>(ndims,dim,indexC,ghosts,qp1);</div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;        indexC[dir] = indexI[dir]+1; <a class="code" href="a00136.html#afbb862a2fdf5b72b1f9ace42f64b556f">_ArrayIndex1D_</a>(ndims,dim,indexC,ghosts,qp2);</div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;      } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;        indexC[dir] = indexI[dir]+2; <a class="code" href="a00136.html#afbb862a2fdf5b72b1f9ace42f64b556f">_ArrayIndex1D_</a>(ndims,dim,indexC,ghosts,qm3);</div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;        indexC[dir] = indexI[dir]+1; <a class="code" href="a00136.html#afbb862a2fdf5b72b1f9ace42f64b556f">_ArrayIndex1D_</a>(ndims,dim,indexC,ghosts,qm2);</div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;        indexC[dir] = indexI[dir]  ; <a class="code" href="a00136.html#afbb862a2fdf5b72b1f9ace42f64b556f">_ArrayIndex1D_</a>(ndims,dim,indexC,ghosts,qm1);</div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;        indexC[dir] = indexI[dir]-1; <a class="code" href="a00136.html#afbb862a2fdf5b72b1f9ace42f64b556f">_ArrayIndex1D_</a>(ndims,dim,indexC,ghosts,qp1);</div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;        indexC[dir] = indexI[dir]-2; <a class="code" href="a00136.html#afbb862a2fdf5b72b1f9ace42f64b556f">_ArrayIndex1D_</a>(ndims,dim,indexC,ghosts,qp2);</div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;      }</div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;</div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;      <span class="keywordtype">int</span> p; <span class="comment">/* 1D index of the interface */</span></div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;      <a class="code" href="a00136.html#afbb862a2fdf5b72b1f9ace42f64b556f">_ArrayIndex1D_</a>(ndims,bounds_inter,indexI,0,p);</div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;</div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;      <span class="comment">/* find averaged state at this interface */</span></div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;      <a class="code" href="a00137.html#ad6ab74942c9de13cf0b4c12eb0d91780">IERR</a> solver-&gt;<a class="code" href="a00115.html#a7331366d789b2995436accbc35e1cc80">AveragingFunction</a>(uavg,&amp;u[nvars*qm1],&amp;u[nvars*qp1],solver-&gt;<a class="code" href="a00115.html#a48e81a1806b5774943fd9a26e9a190f2">physics</a>); <a class="code" href="a00137.html#add9cf96ae374934d245a1dc1ab697a42">CHECKERR</a>(ierr);</div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;</div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;      <span class="comment">/* Get the left and right eigenvectors */</span></div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;      <a class="code" href="a00137.html#ad6ab74942c9de13cf0b4c12eb0d91780">IERR</a> solver-&gt;<a class="code" href="a00115.html#a8c603c73be1f08e408a1de94a088da7b">GetLeftEigenvectors</a>  (uavg,L,solver-&gt;<a class="code" href="a00115.html#a48e81a1806b5774943fd9a26e9a190f2">physics</a>,dir); <a class="code" href="a00137.html#add9cf96ae374934d245a1dc1ab697a42">CHECKERR</a>(ierr);</div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;      <a class="code" href="a00137.html#ad6ab74942c9de13cf0b4c12eb0d91780">IERR</a> solver-&gt;<a class="code" href="a00115.html#a22eef349f191a1aa267e14b08140c823">GetRightEigenvectors</a> (uavg,R,solver-&gt;<a class="code" href="a00115.html#a48e81a1806b5774943fd9a26e9a190f2">physics</a>,dir); <a class="code" href="a00137.html#add9cf96ae374934d245a1dc1ab697a42">CHECKERR</a>(ierr);</div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;</div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;      <span class="keywordflow">for</span> (v=0; v&lt;nvars; v++)  {</div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;</div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;        <span class="comment">/* calculate the characteristic flux components along this characteristic */</span></div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;        <span class="keywordtype">double</span> fm3, fm2, fm1, fp1, fp2;</div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;        fm3 = fm2 = fm1 = fp1 = fp2 = 0;</div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;        <span class="keywordflow">for</span> (k = 0; k &lt; nvars; k++) {</div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;          fm3 += L[v*nvars+k] * fC[qm3*nvars+k];</div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;          fm2 += L[v*nvars+k] * fC[qm2*nvars+k];</div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;          fm1 += L[v*nvars+k] * fC[qm1*nvars+k];</div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;          fp1 += L[v*nvars+k] * fC[qp1*nvars+k];</div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;          fp2 += L[v*nvars+k] * fC[qp2*nvars+k];</div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;        }</div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;</div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;        <span class="comment">/* Candidate stencils and their optimal weights*/</span></div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;        <span class="keywordtype">double</span> f1, f2, f3;</div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;        <span class="keywordflow">if</span> (   ((mpi-&gt;<a class="code" href="a00117.html#aa3c28612a64b8a97bde66b720e15c700">ip</a>[dir] == 0                ) &amp;&amp; (indexI[dir] == 0       ))</div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;            || ((mpi-&gt;<a class="code" href="a00117.html#aa3c28612a64b8a97bde66b720e15c700">ip</a>[dir] == mpi-&gt;<a class="code" href="a00117.html#a0be0f30a83bc3f3d9f6ee3a36bbf2716">iproc</a>[dir]-1) &amp;&amp; (indexI[dir] == dim[dir])) ) {</div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;          <span class="comment">/* Use WENO5 at the physical boundaries */</span></div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;          f1 = (2*one_sixth)*fm3 - (7.0*one_sixth)*fm2 + (11.0*one_sixth)*fm1;</div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;          f2 = (-one_sixth)*fm2 + (5.0*one_sixth)*fm1 + (2*one_sixth)*fp1;</div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;          f3 = (2*one_sixth)*fm1 + (5*one_sixth)*fp1 - (one_sixth)*fp2;</div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;          <span class="comment">/* CRWENO5 at the interior points */</span></div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;          f1 = (one_sixth) * (fm2 + 5*fm1);</div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;          f2 = (one_sixth) * (5*fm1 + fp1);</div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;          f3 = (one_sixth) * (fm1 + 5*fp1);</div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;        }</div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;</div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;        <span class="comment">/* calculate WENO weights */</span></div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;        <span class="keywordtype">double</span> w1,w2,w3;</div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;        w1 = *(ww1+p*nvars+v);</div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;        w2 = *(ww2+p*nvars+v);</div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;        w3 = *(ww3+p*nvars+v);</div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;</div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;        <span class="keywordflow">if</span> (   ((mpi-&gt;<a class="code" href="a00117.html#aa3c28612a64b8a97bde66b720e15c700">ip</a>[dir] == 0                ) &amp;&amp; (indexI[dir] == 0       ))</div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;            || ((mpi-&gt;<a class="code" href="a00117.html#aa3c28612a64b8a97bde66b720e15c700">ip</a>[dir] == mpi-&gt;<a class="code" href="a00117.html#a0be0f30a83bc3f3d9f6ee3a36bbf2716">iproc</a>[dir]-1) &amp;&amp; (indexI[dir] == dim[dir])) ) {</div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;          <span class="keywordflow">for</span> (k=0; k&lt;nvars; k++) {</div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;            A[(Nsys*indexI[dir]+sys)*nvars*nvars+v*nvars+k] = 0.0;</div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;            C[(Nsys*indexI[dir]+sys)*nvars*nvars+v*nvars+k] = 0.0;</div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;            B[(Nsys*indexI[dir]+sys)*nvars*nvars+v*nvars+k] = L[v*nvars+k];</div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;          }</div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;          <span class="keywordflow">if</span> (upw &gt; 0) {</div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;            <span class="keywordflow">for</span> (k=0; k&lt;nvars; k++) {</div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;              A[(Nsys*indexI[dir]+sys)*nvars*nvars+v*nvars+k] = ((2*one_third)*w1 + (one_third)*w2)      * L[v*nvars+k];</div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;              B[(Nsys*indexI[dir]+sys)*nvars*nvars+v*nvars+k] = ((one_third)*w1 + (2*one_third)*(w2+w3)) * L[v*nvars+k];</div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;              C[(Nsys*indexI[dir]+sys)*nvars*nvars+v*nvars+k] = ((one_third)*w3)                         * L[v*nvars+k];</div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;            }</div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;          } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;            <span class="keywordflow">for</span> (k=0; k&lt;nvars; k++) {</div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;              C[(Nsys*indexI[dir]+sys)*nvars*nvars+v*nvars+k] = ((2*one_third)*w1 + (one_third)*w2)      * L[v*nvars+k];</div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;              B[(Nsys*indexI[dir]+sys)*nvars*nvars+v*nvars+k] = ((one_third)*w1 + (2*one_third)*(w2+w3)) * L[v*nvars+k];</div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;              A[(Nsys*indexI[dir]+sys)*nvars*nvars+v*nvars+k] = ((one_third)*w3)                         * L[v*nvars+k];</div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;            }</div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;          }</div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;        }</div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;        F[(Nsys*indexI[dir]+sys)*nvars+v] = w1*f1 + w2*f2 + w3*f3;</div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;      }</div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;    }</div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;  }</div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;</div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;<span class="preprocessor">#ifdef serial</span></div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;<span class="preprocessor"></span></div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;  <span class="comment">/* Solve the tridiagonal system */</span></div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;  <a class="code" href="a00137.html#ad6ab74942c9de13cf0b4c12eb0d91780">IERR</a> <a class="code" href="a00131.html#ad2c404dd44e760ee729740176b186bd0">blocktridiagLU</a>(A,B,C,F,dim[dir]+1,Nsys,nvars,lu,NULL); <a class="code" href="a00137.html#add9cf96ae374934d245a1dc1ab697a42">CHECKERR</a>(ierr);</div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;</div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;<span class="preprocessor">#else</span></div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;<span class="preprocessor"></span></div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;  <span class="comment">/* Solve the tridiagonal system */</span></div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;  <span class="comment">/* all processes except the last will solve without the last interface to avoid overlap */</span></div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;  <span class="keywordflow">if</span> (mpi-&gt;<a class="code" href="a00117.html#aa3c28612a64b8a97bde66b720e15c700">ip</a>[dir] != mpi-&gt;<a class="code" href="a00117.html#a0be0f30a83bc3f3d9f6ee3a36bbf2716">iproc</a>[dir]-1)  { </div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;    <a class="code" href="a00137.html#ad6ab74942c9de13cf0b4c12eb0d91780">IERR</a> <a class="code" href="a00131.html#ad2c404dd44e760ee729740176b186bd0">blocktridiagLU</a>(A,B,C,F,dim[dir]  ,Nsys,nvars,lu,&amp;mpi-&gt;<a class="code" href="a00117.html#a45a2dae130e8ef21ae3aa9c7a9e7a138">comm</a>[dir]); <a class="code" href="a00137.html#add9cf96ae374934d245a1dc1ab697a42">CHECKERR</a>(ierr); </div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;  } <span class="keywordflow">else</span> { </div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;    <a class="code" href="a00137.html#ad6ab74942c9de13cf0b4c12eb0d91780">IERR</a> <a class="code" href="a00131.html#ad2c404dd44e760ee729740176b186bd0">blocktridiagLU</a>(A,B,C,F,dim[dir]+1,Nsys,nvars,lu,&amp;mpi-&gt;<a class="code" href="a00117.html#a45a2dae130e8ef21ae3aa9c7a9e7a138">comm</a>[dir]); <a class="code" href="a00137.html#add9cf96ae374934d245a1dc1ab697a42">CHECKERR</a>(ierr);</div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;  }</div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;</div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;  <span class="comment">/* Now get the solution to the last interface from the next proc */</span></div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;  <span class="keywordtype">double</span> *sendbuf = compact-&gt;<a class="code" href="a00105.html#aba3b15034da676474db917f9f5533085">sendbuf</a>;</div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;  <span class="keywordtype">double</span> *recvbuf = compact-&gt;<a class="code" href="a00105.html#afc23e46e08649e112e8d64d780cea5cb">recvbuf</a>;</div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;  MPI_Request req[2] = {MPI_REQUEST_NULL,MPI_REQUEST_NULL};</div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;  <span class="keywordflow">if</span> (mpi-&gt;<a class="code" href="a00117.html#aa3c28612a64b8a97bde66b720e15c700">ip</a>[dir]) <span class="keywordflow">for</span> (d=0; d&lt;Nsys*nvars; d++) sendbuf[d] = F[d];</div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;  <span class="keywordflow">if</span> (mpi-&gt;<a class="code" href="a00117.html#aa3c28612a64b8a97bde66b720e15c700">ip</a>[dir] != mpi-&gt;<a class="code" href="a00117.html#a0be0f30a83bc3f3d9f6ee3a36bbf2716">iproc</a>[dir]-1) MPI_Irecv(recvbuf,Nsys*nvars,MPI_DOUBLE,mpi-&gt;<a class="code" href="a00117.html#aa3c28612a64b8a97bde66b720e15c700">ip</a>[dir]+1,214,mpi-&gt;<a class="code" href="a00117.html#a45a2dae130e8ef21ae3aa9c7a9e7a138">comm</a>[dir],&amp;req[0]);</div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;  <span class="keywordflow">if</span> (mpi-&gt;<a class="code" href="a00117.html#aa3c28612a64b8a97bde66b720e15c700">ip</a>[dir])                      MPI_Isend(sendbuf,Nsys*nvars,MPI_DOUBLE,mpi-&gt;<a class="code" href="a00117.html#aa3c28612a64b8a97bde66b720e15c700">ip</a>[dir]-1,214,mpi-&gt;<a class="code" href="a00117.html#a45a2dae130e8ef21ae3aa9c7a9e7a138">comm</a>[dir],&amp;req[1]);</div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;  MPI_Waitall(2,&amp;req[0],MPI_STATUS_IGNORE);</div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;  <span class="keywordflow">if</span> (mpi-&gt;<a class="code" href="a00117.html#aa3c28612a64b8a97bde66b720e15c700">ip</a>[dir] != mpi-&gt;<a class="code" href="a00117.html#a0be0f30a83bc3f3d9f6ee3a36bbf2716">iproc</a>[dir]-1) <span class="keywordflow">for</span> (d=0; d&lt;Nsys*nvars; d++) F[d+Nsys*nvars*dim[dir]] = recvbuf[d];</div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;</div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;<span class="preprocessor"></span></div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;  <span class="comment">/* save the solution to fI */</span></div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;<span class="preprocessor">#pragma omp parallel for schedule(auto) default(shared) private(sys,d,v,k,R,L,uavg,index_outer,indexC,indexI)</span></div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;<span class="preprocessor"></span>  <span class="keywordflow">for</span> (sys=0; sys&lt;Nsys; sys++) {</div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;    <a class="code" href="a00136.html#a03f49e4d44ae8aca85cb04cfe91e4ce4">_ArrayIndexnD_</a>(ndims,sys,bounds_outer,index_outer,0);</div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;    <a class="code" href="a00136.html#a89e8330d9e06dd0666c50833628a125c">_ArrayCopy1D_</a>(index_outer,indexI,ndims);</div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;    <span class="keywordflow">for</span> (indexI[dir] = 0; indexI[dir] &lt; dim[dir]+1; indexI[dir]++) {</div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;      <span class="keywordtype">int</span> p; <a class="code" href="a00136.html#afbb862a2fdf5b72b1f9ace42f64b556f">_ArrayIndex1D_</a>(ndims,bounds_inter,indexI,0,p);</div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;      <a class="code" href="a00136.html#a89e8330d9e06dd0666c50833628a125c">_ArrayCopy1D_</a>((F+sys*nvars+Nsys*nvars*indexI[dir]),(fI+nvars*p),nvars);</div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;    }</div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;  }</div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;</div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;  <span class="keywordflow">return</span>(0);</div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;}</div>
<div class="ttc" id="a00131_html_a00521"><div class="ttname"><a href="a00131.html#a00521">TridiagLU</a></div><div class="ttdef"><b>Definition:</b> <a href="a00131_source.html#l00084">tridiagLU.h:84</a></div></div>
<div class="ttc" id="a00115_html_a56318721d534e74a96b440f8542a0232"><div class="ttname"><a href="a00115.html#a56318721d534e74a96b440f8542a0232">HyPar::compact</a></div><div class="ttdeci">void * compact</div><div class="ttdef"><b>Definition:</b> <a href="a00143_source.html#l00328">hypar.h:328</a></div></div>
<div class="ttc" id="a00115_html_a484873c74138512e41bc50d17b7d955a"><div class="ttname"><a href="a00115.html#a484873c74138512e41bc50d17b7d955a">HyPar::ndims</a></div><div class="ttdeci">int ndims</div><div class="ttdef"><b>Definition:</b> <a href="a00143_source.html#l00026">hypar.h:26</a></div></div>
<div class="ttc" id="a00115_html_aafc992b5fa79d5a4036024615d03bce6"><div class="ttname"><a href="a00115.html#aafc992b5fa79d5a4036024615d03bce6">HyPar::ghosts</a></div><div class="ttdeci">int ghosts</div><div class="ttdef"><b>Definition:</b> <a href="a00143_source.html#l00044">hypar.h:44</a></div></div>
<div class="ttc" id="a00115_html"><div class="ttname"><a href="a00115.html">HyPar</a></div><div class="ttdoc">Structure containing all solver-specific variables and functions. </div><div class="ttdef"><b>Definition:</b> <a href="a00143_source.html#l00023">hypar.h:23</a></div></div>
<div class="ttc" id="a00105_html_ac06de847603f5cfaec085f6fe500f3c8"><div class="ttname"><a href="a00105.html#ac06de847603f5cfaec085f6fe500f3c8">CompactScheme::R</a></div><div class="ttdeci">double * R</div><div class="ttdef"><b>Definition:</b> <a href="a00105_source.html#l00439">interpolation.h:439</a></div></div>
<div class="ttc" id="a00105_html_a00503"><div class="ttname"><a href="a00105.html#a00503">CompactScheme</a></div><div class="ttdoc">Structure of variables/parameters needed by the compact schemes. </div><div class="ttdef"><b>Definition:</b> <a href="a00105_source.html#l00437">interpolation.h:437</a></div></div>
<div class="ttc" id="a00137_html_ad6ab74942c9de13cf0b4c12eb0d91780"><div class="ttname"><a href="a00137.html#ad6ab74942c9de13cf0b4c12eb0d91780">IERR</a></div><div class="ttdeci">#define IERR</div><div class="ttdef"><b>Definition:</b> <a href="a00137_source.html#l00012">basic.h:12</a></div></div>
<div class="ttc" id="a00105_html_a00523"><div class="ttname"><a href="a00105.html#a00523">WENOParameters</a></div><div class="ttdoc">Structure of variables/parameters needed by the WENO-type scheme. </div><div class="ttdef"><b>Definition:</b> <a href="a00105_source.html#l00175">interpolation.h:175</a></div></div>
<div class="ttc" id="a00105_html_aba3b15034da676474db917f9f5533085"><div class="ttname"><a href="a00105.html#aba3b15034da676474db917f9f5533085">CompactScheme::sendbuf</a></div><div class="ttdeci">double * sendbuf</div><div class="ttdef"><b>Definition:</b> <a href="a00105_source.html#l00444">interpolation.h:444</a></div></div>
<div class="ttc" id="a00117_html_a0be0f30a83bc3f3d9f6ee3a36bbf2716"><div class="ttname"><a href="a00117.html#a0be0f30a83bc3f3d9f6ee3a36bbf2716">MPIVariables::iproc</a></div><div class="ttdeci">int * iproc</div><div class="ttdef"><b>Definition:</b> <a href="a00117_source.html#l00027">mpivars_struct.h:27</a></div></div>
<div class="ttc" id="a00115_html_a8c603c73be1f08e408a1de94a088da7b"><div class="ttname"><a href="a00115.html#a8c603c73be1f08e408a1de94a088da7b">HyPar::GetLeftEigenvectors</a></div><div class="ttdeci">int(* GetLeftEigenvectors)(double *, double *, void *, int)</div><div class="ttdef"><b>Definition:</b> <a href="a00143_source.html#l00321">hypar.h:321</a></div></div>
<div class="ttc" id="a00115_html_ae8f6d2fd6490d3153cb4133bf183a404"><div class="ttname"><a href="a00115.html#ae8f6d2fd6490d3153cb4133bf183a404">HyPar::nvars</a></div><div class="ttdeci">int nvars</div><div class="ttdef"><b>Definition:</b> <a href="a00143_source.html#l00029">hypar.h:29</a></div></div>
<div class="ttc" id="a00105_html_a0a26ce8d1878aac6ddc87e3f6290e039"><div class="ttname"><a href="a00105.html#a0a26ce8d1878aac6ddc87e3f6290e039">CompactScheme::C</a></div><div class="ttdeci">double * C</div><div class="ttdef"><b>Definition:</b> <a href="a00105_source.html#l00439">interpolation.h:439</a></div></div>
<div class="ttc" id="a00136_html_a89e8330d9e06dd0666c50833628a125c"><div class="ttname"><a href="a00136.html#a89e8330d9e06dd0666c50833628a125c">_ArrayCopy1D_</a></div><div class="ttdeci">#define _ArrayCopy1D_(x, y, size)</div><div class="ttdef"><b>Definition:</b> <a href="a00136_source.html#l00318">arrayfunctions.h:318</a></div></div>
<div class="ttc" id="a00105_html_afc23e46e08649e112e8d64d780cea5cb"><div class="ttname"><a href="a00105.html#afc23e46e08649e112e8d64d780cea5cb">CompactScheme::recvbuf</a></div><div class="ttdeci">double * recvbuf</div><div class="ttdef"><b>Definition:</b> <a href="a00105_source.html#l00444">interpolation.h:444</a></div></div>
<div class="ttc" id="a00115_html_a38e0371f331cecbe63a77fa03e202afe"><div class="ttname"><a href="a00115.html#a38e0371f331cecbe63a77fa03e202afe">HyPar::dim_local</a></div><div class="ttdeci">int * dim_local</div><div class="ttdef"><b>Definition:</b> <a href="a00143_source.html#l00035">hypar.h:35</a></div></div>
<div class="ttc" id="a00115_html_a22eef349f191a1aa267e14b08140c823"><div class="ttname"><a href="a00115.html#a22eef349f191a1aa267e14b08140c823">HyPar::GetRightEigenvectors</a></div><div class="ttdeci">int(* GetRightEigenvectors)(double *, double *, void *, int)</div><div class="ttdef"><b>Definition:</b> <a href="a00143_source.html#l00323">hypar.h:323</a></div></div>
<div class="ttc" id="a00131_html_ad2c404dd44e760ee729740176b186bd0"><div class="ttname"><a href="a00131.html#ad2c404dd44e760ee729740176b186bd0">blocktridiagLU</a></div><div class="ttdeci">int blocktridiagLU(double *, double *, double *, double *, int, int, int, void *, void *)</div><div class="ttdef"><b>Definition:</b> <a href="a00493_source.html#l00107">blocktridiagLU.c:107</a></div></div>
<div class="ttc" id="a00117_html_aa3c28612a64b8a97bde66b720e15c700"><div class="ttname"><a href="a00117.html#aa3c28612a64b8a97bde66b720e15c700">MPIVariables::ip</a></div><div class="ttdeci">int * ip</div><div class="ttdef"><b>Definition:</b> <a href="a00117_source.html#l00028">mpivars_struct.h:28</a></div></div>
<div class="ttc" id="a00117_html_a00516"><div class="ttname"><a href="a00117.html#a00516">MPIVariables</a></div><div class="ttdoc">Structure of MPI-related variables. </div><div class="ttdef"><b>Definition:</b> <a href="a00117_source.html#l00024">mpivars_struct.h:24</a></div></div>
<div class="ttc" id="a00137_html_add9cf96ae374934d245a1dc1ab697a42"><div class="ttname"><a href="a00137.html#add9cf96ae374934d245a1dc1ab697a42">CHECKERR</a></div><div class="ttdeci">#define CHECKERR(ierr)</div><div class="ttdef"><b>Definition:</b> <a href="a00137_source.html#l00014">basic.h:14</a></div></div>
<div class="ttc" id="a00115_html_a1dbfa1e479a373073b6ebf72401a7f0f"><div class="ttname"><a href="a00115.html#a1dbfa1e479a373073b6ebf72401a7f0f">HyPar::lusolver</a></div><div class="ttdeci">void * lusolver</div><div class="ttdef"><b>Definition:</b> <a href="a00143_source.html#l00332">hypar.h:332</a></div></div>
<div class="ttc" id="a00136_html_a03f49e4d44ae8aca85cb04cfe91e4ce4"><div class="ttname"><a href="a00136.html#a03f49e4d44ae8aca85cb04cfe91e4ce4">_ArrayIndexnD_</a></div><div class="ttdeci">#define _ArrayIndexnD_(N, index, imax, i, ghost)</div><div class="ttdef"><b>Definition:</b> <a href="a00136_source.html#l00020">arrayfunctions.h:20</a></div></div>
<div class="ttc" id="a00115_html_a29c46b81ad574e4dfbad5a7211487dcb"><div class="ttname"><a href="a00115.html#a29c46b81ad574e4dfbad5a7211487dcb">HyPar::interp</a></div><div class="ttdeci">void * interp</div><div class="ttdef"><b>Definition:</b> <a href="a00143_source.html#l00326">hypar.h:326</a></div></div>
<div class="ttc" id="a00136_html_abc65e9c6a51b875f46fdb054a0ecf604"><div class="ttname"><a href="a00136.html#abc65e9c6a51b875f46fdb054a0ecf604">_ArrayProduct1D_</a></div><div class="ttdeci">#define _ArrayProduct1D_(x, size, p)</div><div class="ttdef"><b>Definition:</b> <a href="a00136_source.html#l00376">arrayfunctions.h:376</a></div></div>
<div class="ttc" id="a00115_html_a7331366d789b2995436accbc35e1cc80"><div class="ttname"><a href="a00115.html#a7331366d789b2995436accbc35e1cc80">HyPar::AveragingFunction</a></div><div class="ttdeci">int(* AveragingFunction)(double *, double *, double *, void *)</div><div class="ttdef"><b>Definition:</b> <a href="a00143_source.html#l00318">hypar.h:318</a></div></div>
<div class="ttc" id="a00105_html_ac900805a486cbb8489e3c176ed6e0d8e"><div class="ttname"><a href="a00105.html#ac900805a486cbb8489e3c176ed6e0d8e">CompactScheme::A</a></div><div class="ttdeci">double * A</div><div class="ttdef"><b>Definition:</b> <a href="a00105_source.html#l00439">interpolation.h:439</a></div></div>
<div class="ttc" id="a00136_html_afbb862a2fdf5b72b1f9ace42f64b556f"><div class="ttname"><a href="a00136.html#afbb862a2fdf5b72b1f9ace42f64b556f">_ArrayIndex1D_</a></div><div class="ttdeci">#define _ArrayIndex1D_(N, imax, i, ghost, index)</div><div class="ttdef"><b>Definition:</b> <a href="a00136_source.html#l00039">arrayfunctions.h:39</a></div></div>
<div class="ttc" id="a00117_html_a45a2dae130e8ef21ae3aa9c7a9e7a138"><div class="ttname"><a href="a00117.html#a45a2dae130e8ef21ae3aa9c7a9e7a138">MPIVariables::comm</a></div><div class="ttdeci">MPI_Comm * comm</div><div class="ttdef"><b>Definition:</b> <a href="a00117_source.html#l00038">mpivars_struct.h:38</a></div></div>
<div class="ttc" id="a00137_html_a68f50121fb9a7daeaf60e50cdef82ef3"><div class="ttname"><a href="a00137.html#a68f50121fb9a7daeaf60e50cdef82ef3">_DECLARE_IERR_</a></div><div class="ttdeci">#define _DECLARE_IERR_</div><div class="ttdef"><b>Definition:</b> <a href="a00137_source.html#l00013">basic.h:13</a></div></div>
<div class="ttc" id="a00105_html_ad36954709307649365515214a02ab06d"><div class="ttname"><a href="a00105.html#ad36954709307649365515214a02ab06d">CompactScheme::B</a></div><div class="ttdeci">double * B</div><div class="ttdef"><b>Definition:</b> <a href="a00105_source.html#l00439">interpolation.h:439</a></div></div>
<div class="ttc" id="a00115_html_a48e81a1806b5774943fd9a26e9a190f2"><div class="ttname"><a href="a00115.html#a48e81a1806b5774943fd9a26e9a190f2">HyPar::physics</a></div><div class="ttdeci">void * physics</div><div class="ttdef"><b>Definition:</b> <a href="a00143_source.html#l00245">hypar.h:245</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a91fbe118c8c01fe1d5efa3cea4930589"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int Interp1PrimFifthOrderHCWENOChar </td>
          <td>(</td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>fI</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>fC</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>u</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>upw</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>dir</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>s</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>m</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>uflag</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>5th order hybrid compact-WENO reconstruction (characteristic-based) on a uniform grid </p>
<p>Characteristic-based interpolation of the first primitive at the cell interfaces using the fifth-order hybrid-compact WENO scheme</p>
<p>Computes the interpolated values of the first primitive of a function \({\bf f}\left({\bf u}\right)\) at the interfaces from the cell-centered values of the function using the fifth hybrid compact-WENO order scheme on a uniform grid. The reconstruction is carried out in terms of </p>
<p class="formulaDsp">
\begin{equation} \alpha^k = {\bf l}_k \cdot {\bf f},\ k=1,\cdots,n, \end{equation}
</p>
<p> which is the \(k\)-th characteristic quantity, and \({\bf l}_k\) is the \(k\)-th left eigenvector, \({\bf r}_k\) is the \(k\)-th right eigenvector, and \(n\) is <a class="el" href="a00115.html#ae8f6d2fd6490d3153cb4133bf183a404">HyPar::nvars</a>. The block tridiagonal system is solved using <a class="el" href="a00131.html#ad2c404dd44e760ee729740176b186bd0">blocktridiagLU()</a> (see also <a class="el" href="a00131.html#a00521">TridiagLU</a>, <a class="el" href="a00131.html" title="Header file for TridiagLU. ">tridiagLU.h</a>). The final interpolated function is computed from the interpolated characteristic quantities as: </p>
<p class="formulaDsp">
\begin{equation} \hat{\bf f}_{j+1/2} = \sum_{k=1}^n \alpha^k_{j+1/2} {\bf r}_k \end{equation}
</p>
<p> See the references below for details of the hybrid compact-WENO scheme.</p>
<p><b>Implementation</b> <b>Notes:</b> </p>
<ul>
<li>This method assumes a uniform grid in the spatial dimension corresponding to the interpolation.</li>
<li>The method described above corresponds to a left-biased interpolation. The corresponding right-biased interpolation can be obtained by reflecting the equations about interface j+1/2.</li>
<li>The WENO weights are computed in <a class="el" href="a00243.html#a6f1f5da1b6e5134bb1deccfad05a506d">WENOFifthOrderCalculateWeightsChar()</a>.</li>
<li><p class="startli">The left and right eigenvectors are computed at an averaged quantity at j+1/2. Thus, this function requires functions to compute the average state, and the left and right eigenvectors. These are provided by the physical model through</p>
<ul>
<li><a class="el" href="a00115.html#a8c603c73be1f08e408a1de94a088da7b">HyPar::GetLeftEigenvectors()</a></li>
<li><a class="el" href="a00115.html#a22eef349f191a1aa267e14b08140c823">HyPar::GetRightEigenvectors()</a></li>
<li><a class="el" href="a00115.html#a7331366d789b2995436accbc35e1cc80">HyPar::AveragingFunction()</a></li>
</ul>
<p class="startli">If these functions are not provided by the physical model, then a characteristic-based interpolation cannot be used.</p>
</li>
<li>The function computes the interpolant for the entire grid in one call. It loops over all the grid lines along the interpolation direction and carries out the 1D interpolation along these grid lines.</li>
<li>Location of cell-centers and cell interfaces along the spatial dimension of the interpolation is shown in the following figure: <div class="image">
<img src="chap1_1Ddomain.png" alt="chap1_1Ddomain.png"/>
</div>
 </li>
</ul>
<p><b>Function</b> <b>arguments:</b> </p>
<table class="doxtable">
<tr>
<th>Argument </th><th>Type </th><th>Explanation  </th></tr>
<tr>
<td>fI </td><td>double* </td><td>Array to hold the computed interpolant at the grid interfaces. This array must have the same layout as the solution, but with <b>no</b> <b>ghost</b> <b>points</b>. Its size should be the same as u in all dimensions, except dir (the dimension along which to interpolate) along which it should be larger by 1 (number of interfaces is 1 more than the number of interior cell centers). </td></tr>
<tr>
<td>fC </td><td>double* </td><td>Array with the cell-centered values of the flux function \({\bf f}\left({\bf u}\right)\). This array must have the same layout and size as the solution, <b>with</b> <b>ghost</b> <b>points</b>. </td></tr>
<tr>
<td>u </td><td>double* </td><td>The solution array \({\bf u}\) (with ghost points). If the interpolation is characteristic based, this is needed to compute the eigendecomposition. For a multidimensional problem, the layout is as follows: u is a contiguous 1D array of size (nvars*dim[0]*dim[1]*...*dim[D-1]) corresponding to the multi-dimensional solution, with the following ordering - nvars, dim[0], dim[1], ..., dim[D-1], where nvars is the number of solution components (<a class="el" href="a00115.html#ae8f6d2fd6490d3153cb4133bf183a404">HyPar::nvars</a>), dim is the local size (<a class="el" href="a00115.html#a38e0371f331cecbe63a77fa03e202afe">HyPar::dim_local</a>), D is the number of spatial dimensions. </td></tr>
<tr>
<td>x </td><td>double* </td><td>The grid array (with ghost points). This is used only by non-uniform-grid interpolation methods. For multidimensional problems, the layout is as follows: x is a contiguous 1D array of size (dim[0]+dim[1]+...+dim[D-1]), with the spatial coordinates along dim[0] stored from 0,...,dim[0]-1, the spatial coordinates along dim[1] stored along dim[0],...,dim[0]+dim[1]-1, and so forth. </td></tr>
<tr>
<td>upw </td><td>int </td><td>Upwinding direction: if positive, a left-biased interpolant will be computed; if negative, a right-biased interpolant will be computed. If the interpolation method is central, then this has no effect. </td></tr>
<tr>
<td>dir </td><td>int </td><td>Spatial dimension along which to interpolate (eg: 0 for 1D; 0 or 1 for 2D; 0,1 or 2 for 3D) </td></tr>
<tr>
<td>s </td><td>void* </td><td>Solver object of type <a class="el" href="a00115.html" title="Structure containing all solver-specific variables and functions. ">HyPar</a>: the following variables are needed - <a class="el" href="a00115.html#aafc992b5fa79d5a4036024615d03bce6">HyPar::ghosts</a>, <a class="el" href="a00115.html#a484873c74138512e41bc50d17b7d955a">HyPar::ndims</a>, <a class="el" href="a00115.html#ae8f6d2fd6490d3153cb4133bf183a404">HyPar::nvars</a>, <a class="el" href="a00115.html#a38e0371f331cecbe63a77fa03e202afe">HyPar::dim_local</a>. </td></tr>
<tr>
<td>m </td><td>void* </td><td>MPI object of type <a class="el" href="a00117.html#a00516" title="Structure of MPI-related variables. ">MPIVariables</a>: this is needed only by compact interpolation method that need to solve a global implicit system across MPI ranks. </td></tr>
<tr>
<td>uflag </td><td>int </td><td>A flag indicating if the function being interpolated \({\bf f}\) is the solution itself \({\bf u}\) (if 1, \({\bf f}\left({\bf u}\right) \equiv {\bf u}\)). </td></tr>
</table>
<p><b>Reference:</b> </p>
<ul>
<li>Pirozzoli, S., Conservative Hybrid Compact-WENO Schemes for Shock-Turbulence Interaction, J. Comput. Phys., 178 (1), 2002, pp. 81-117, <a href="http://dx.doi.org/10.1006/jcph.2002.7021">http://dx.doi.org/10.1006/jcph.2002.7021</a></li>
<li>Ren, Y.-X., Liu, M., Zhang, H., A characteristic-wise hybrid compact-WENO scheme for solving hyperbolic conservation laws, J. Comput. Phys., 192 (2), 2003, pp. 365-386, </li>
</ul>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">fI</td><td>Array of interpolated function values at the interfaces </td></tr>
    <tr><td class="paramname">fC</td><td>Array of cell-centered values of the function \({\bf f}\left({\bf u}\right)\) </td></tr>
    <tr><td class="paramname">u</td><td>Array of cell-centered values of the solution \({\bf u}\) </td></tr>
    <tr><td class="paramname">x</td><td>Grid coordinates </td></tr>
    <tr><td class="paramname">upw</td><td>Upwind direction (left or right biased) </td></tr>
    <tr><td class="paramname">dir</td><td>Spatial dimension along which to interpolation </td></tr>
    <tr><td class="paramname">s</td><td>Object of type <a class="el" href="a00115.html" title="Structure containing all solver-specific variables and functions. ">HyPar</a> containing solver-related variables </td></tr>
    <tr><td class="paramname">m</td><td>Object of type <a class="el" href="a00117.html#a00516" title="Structure of MPI-related variables. ">MPIVariables</a> containing MPI-related variables </td></tr>
    <tr><td class="paramname">uflag</td><td>Flag to indicate if \(f(u) \equiv u\), i.e, if the solution is being reconstructed </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="a00227_source.html#l00078">78</a> of file <a class="el" href="a00227_source.html">Interp1PrimFifthOrderHCWENOChar.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;{</div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;  <a class="code" href="a00115.html">HyPar</a>           *solver = (<a class="code" href="a00115.html">HyPar</a>*)          s;</div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;  <a class="code" href="a00117.html#a00516">MPIVariables</a>    *mpi    = (<a class="code" href="a00117.html#a00516">MPIVariables</a>*)   m;</div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;  <a class="code" href="a00105.html#a00503">CompactScheme</a>   *compact= (<a class="code" href="a00105.html#a00503">CompactScheme</a>*)  solver-&gt;<a class="code" href="a00115.html#a56318721d534e74a96b440f8542a0232">compact</a>;</div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;  <a class="code" href="a00105.html#a00523">WENOParameters</a>  *weno   = (<a class="code" href="a00105.html#a00523">WENOParameters</a>*) solver-&gt;<a class="code" href="a00115.html#a29c46b81ad574e4dfbad5a7211487dcb">interp</a>;</div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;  <a class="code" href="a00131.html#a00521">TridiagLU</a>       *lu     = (<a class="code" href="a00131.html#a00521">TridiagLU</a>*)      solver-&gt;<a class="code" href="a00115.html#a1dbfa1e479a373073b6ebf72401a7f0f">lusolver</a>;</div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;  <span class="keywordtype">int</span>             sys,Nsys,d,v,k;</div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;  <a class="code" href="a00137.html#a68f50121fb9a7daeaf60e50cdef82ef3">_DECLARE_IERR_</a>;</div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;</div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;  <span class="keywordtype">int</span> ghosts = solver-&gt;<a class="code" href="a00115.html#aafc992b5fa79d5a4036024615d03bce6">ghosts</a>;</div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;  <span class="keywordtype">int</span> ndims  = solver-&gt;<a class="code" href="a00115.html#a484873c74138512e41bc50d17b7d955a">ndims</a>;</div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;  <span class="keywordtype">int</span> nvars  = solver-&gt;<a class="code" href="a00115.html#ae8f6d2fd6490d3153cb4133bf183a404">nvars</a>;</div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;  <span class="keywordtype">int</span> *dim   = solver-&gt;<a class="code" href="a00115.html#a38e0371f331cecbe63a77fa03e202afe">dim_local</a>;</div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;</div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;  <span class="comment">/* define some constants */</span></div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;  <span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">double</span> one_half           = 1.0/2.0;</div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;  <span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">double</span> one_third          = 1.0/3.0;</div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;  <span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">double</span> one_sixth          = 1.0/6.0;</div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;</div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;  <span class="keywordtype">double</span> *ww1, *ww2, *ww3;</div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;  ww1 = weno-&gt;w1 + (upw &lt; 0 ? 2*weno-&gt;size : 0) + (uflag ? weno-&gt;size : 0) + weno-&gt;offset[dir];</div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;  ww2 = weno-&gt;w2 + (upw &lt; 0 ? 2*weno-&gt;size : 0) + (uflag ? weno-&gt;size : 0) + weno-&gt;offset[dir];</div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;  ww3 = weno-&gt;w3 + (upw &lt; 0 ? 2*weno-&gt;size : 0) + (uflag ? weno-&gt;size : 0) + weno-&gt;offset[dir];</div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;</div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;  <span class="comment">/* create index and bounds for the outer loop, i.e., to loop over all 1D lines along</span></div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;<span class="comment">     dimension &quot;dir&quot;                                                                    */</span></div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;  <span class="keywordtype">int</span> indexC[ndims], indexI[ndims], index_outer[ndims], bounds_outer[ndims], bounds_inter[ndims];</div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;  <a class="code" href="a00136.html#a89e8330d9e06dd0666c50833628a125c">_ArrayCopy1D_</a>(dim,bounds_outer,ndims); bounds_outer[dir] =  1;</div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;  <a class="code" href="a00136.html#a89e8330d9e06dd0666c50833628a125c">_ArrayCopy1D_</a>(dim,bounds_inter,ndims); bounds_inter[dir] += 1;</div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;</div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;  <span class="comment">/* calculate total number of block tridiagonal systems to solve */</span></div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;  <a class="code" href="a00136.html#abc65e9c6a51b875f46fdb054a0ecf604">_ArrayProduct1D_</a>(bounds_outer,ndims,Nsys);</div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;</div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;  <span class="comment">/* allocate arrays for the averaged state, eigenvectors and characteristic interpolated f */</span></div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;  <span class="keywordtype">double</span> R[nvars*nvars], L[nvars*nvars], uavg[nvars];</div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;</div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;  <span class="comment">/* Allocate arrays for tridiagonal system */</span></div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;  <span class="keywordtype">double</span> *A = compact-&gt;<a class="code" href="a00105.html#ac900805a486cbb8489e3c176ed6e0d8e">A</a>;</div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;  <span class="keywordtype">double</span> *B = compact-&gt;<a class="code" href="a00105.html#ad36954709307649365515214a02ab06d">B</a>;</div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;  <span class="keywordtype">double</span> *C = compact-&gt;<a class="code" href="a00105.html#a0a26ce8d1878aac6ddc87e3f6290e039">C</a>;</div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;  <span class="keywordtype">double</span> *F = compact-&gt;<a class="code" href="a00105.html#ac06de847603f5cfaec085f6fe500f3c8">R</a>;</div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;</div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;<span class="preprocessor">#pragma omp parallel for schedule(auto) default(shared) private(sys,d,v,k,R,L,uavg,index_outer,indexC,indexI)</span></div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;<span class="preprocessor"></span>  <span class="keywordflow">for</span> (sys=0; sys&lt;Nsys; sys++) {</div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;    <a class="code" href="a00136.html#a03f49e4d44ae8aca85cb04cfe91e4ce4">_ArrayIndexnD_</a>(ndims,sys,bounds_outer,index_outer,0);</div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;    <a class="code" href="a00136.html#a89e8330d9e06dd0666c50833628a125c">_ArrayCopy1D_</a>(index_outer,indexC,ndims);</div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;    <a class="code" href="a00136.html#a89e8330d9e06dd0666c50833628a125c">_ArrayCopy1D_</a>(index_outer,indexI,ndims);</div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;    <span class="keywordflow">for</span> (indexI[dir] = 0; indexI[dir] &lt; dim[dir]+1; indexI[dir]++) {</div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;      <span class="keywordtype">int</span> qm1,qm2,qm3,qp1,qp2;</div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;      <span class="keywordflow">if</span> (upw &gt; 0) {</div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;        indexC[dir] = indexI[dir]-3; <a class="code" href="a00136.html#afbb862a2fdf5b72b1f9ace42f64b556f">_ArrayIndex1D_</a>(ndims,dim,indexC,ghosts,qm3);</div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;        indexC[dir] = indexI[dir]-2; <a class="code" href="a00136.html#afbb862a2fdf5b72b1f9ace42f64b556f">_ArrayIndex1D_</a>(ndims,dim,indexC,ghosts,qm2);</div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;        indexC[dir] = indexI[dir]-1; <a class="code" href="a00136.html#afbb862a2fdf5b72b1f9ace42f64b556f">_ArrayIndex1D_</a>(ndims,dim,indexC,ghosts,qm1);</div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;        indexC[dir] = indexI[dir]  ; <a class="code" href="a00136.html#afbb862a2fdf5b72b1f9ace42f64b556f">_ArrayIndex1D_</a>(ndims,dim,indexC,ghosts,qp1);</div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;        indexC[dir] = indexI[dir]+1; <a class="code" href="a00136.html#afbb862a2fdf5b72b1f9ace42f64b556f">_ArrayIndex1D_</a>(ndims,dim,indexC,ghosts,qp2);</div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;      } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;        indexC[dir] = indexI[dir]+2; <a class="code" href="a00136.html#afbb862a2fdf5b72b1f9ace42f64b556f">_ArrayIndex1D_</a>(ndims,dim,indexC,ghosts,qm3);</div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;        indexC[dir] = indexI[dir]+1; <a class="code" href="a00136.html#afbb862a2fdf5b72b1f9ace42f64b556f">_ArrayIndex1D_</a>(ndims,dim,indexC,ghosts,qm2);</div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;        indexC[dir] = indexI[dir]  ; <a class="code" href="a00136.html#afbb862a2fdf5b72b1f9ace42f64b556f">_ArrayIndex1D_</a>(ndims,dim,indexC,ghosts,qm1);</div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;        indexC[dir] = indexI[dir]-1; <a class="code" href="a00136.html#afbb862a2fdf5b72b1f9ace42f64b556f">_ArrayIndex1D_</a>(ndims,dim,indexC,ghosts,qp1);</div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;        indexC[dir] = indexI[dir]-2; <a class="code" href="a00136.html#afbb862a2fdf5b72b1f9ace42f64b556f">_ArrayIndex1D_</a>(ndims,dim,indexC,ghosts,qp2);</div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;      }</div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;</div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;      <span class="keywordtype">int</span> p; <span class="comment">/* 1D index of the interface */</span></div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;      <a class="code" href="a00136.html#afbb862a2fdf5b72b1f9ace42f64b556f">_ArrayIndex1D_</a>(ndims,bounds_inter,indexI,0,p);</div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;</div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;      <span class="comment">/* find averaged state at this interface */</span></div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;      <a class="code" href="a00137.html#ad6ab74942c9de13cf0b4c12eb0d91780">IERR</a> solver-&gt;<a class="code" href="a00115.html#a7331366d789b2995436accbc35e1cc80">AveragingFunction</a>(uavg,&amp;u[nvars*qm1],&amp;u[nvars*qp1],solver-&gt;<a class="code" href="a00115.html#a48e81a1806b5774943fd9a26e9a190f2">physics</a>); <a class="code" href="a00137.html#add9cf96ae374934d245a1dc1ab697a42">CHECKERR</a>(ierr);</div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;</div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;      <span class="comment">/* Get the left and right eigenvectors */</span></div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;      <a class="code" href="a00137.html#ad6ab74942c9de13cf0b4c12eb0d91780">IERR</a> solver-&gt;<a class="code" href="a00115.html#a8c603c73be1f08e408a1de94a088da7b">GetLeftEigenvectors</a>  (uavg,L,solver-&gt;<a class="code" href="a00115.html#a48e81a1806b5774943fd9a26e9a190f2">physics</a>,dir); <a class="code" href="a00137.html#add9cf96ae374934d245a1dc1ab697a42">CHECKERR</a>(ierr);</div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;      <a class="code" href="a00137.html#ad6ab74942c9de13cf0b4c12eb0d91780">IERR</a> solver-&gt;<a class="code" href="a00115.html#a22eef349f191a1aa267e14b08140c823">GetRightEigenvectors</a> (uavg,R,solver-&gt;<a class="code" href="a00115.html#a48e81a1806b5774943fd9a26e9a190f2">physics</a>,dir); <a class="code" href="a00137.html#add9cf96ae374934d245a1dc1ab697a42">CHECKERR</a>(ierr);</div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;</div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;      <span class="keywordflow">for</span> (v=0; v&lt;nvars; v++)  {</div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;</div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;        <span class="comment">/* calculate the characteristic flux components along this characteristic */</span></div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;        <span class="keywordtype">double</span> fm3, fm2, fm1, fp1, fp2;</div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;        fm3 = fm2 = fm1 = fp1 = fp2 = 0;</div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;        <span class="keywordflow">for</span> (k = 0; k &lt; nvars; k++) {</div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;          fm3 += L[v*nvars+k] * fC[qm3*nvars+k];</div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;          fm2 += L[v*nvars+k] * fC[qm2*nvars+k];</div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;          fm1 += L[v*nvars+k] * fC[qm1*nvars+k];</div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;          fp1 += L[v*nvars+k] * fC[qp1*nvars+k];</div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;          fp2 += L[v*nvars+k] * fC[qp2*nvars+k];</div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;        }</div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;</div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;        <span class="comment">/* Candidate stencils and their optimal weights*/</span></div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;        <span class="keywordtype">double</span> f1, f2, f3;</div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;        <span class="keywordflow">if</span> (   ((mpi-&gt;<a class="code" href="a00117.html#aa3c28612a64b8a97bde66b720e15c700">ip</a>[dir] == 0                ) &amp;&amp; (indexI[dir] == 0       ))</div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;            || ((mpi-&gt;<a class="code" href="a00117.html#aa3c28612a64b8a97bde66b720e15c700">ip</a>[dir] == mpi-&gt;<a class="code" href="a00117.html#a0be0f30a83bc3f3d9f6ee3a36bbf2716">iproc</a>[dir]-1) &amp;&amp; (indexI[dir] == dim[dir])) ) {</div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;          <span class="comment">/* Use WENO5 at the physical boundaries */</span></div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;          f1 = (2*one_sixth)*fm3 - (7.0*one_sixth)*fm2 + (11.0*one_sixth)*fm1;</div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;          f2 = (-one_sixth)*fm2 + (5.0*one_sixth)*fm1 + (2*one_sixth)*fp1;</div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;          f3 = (2*one_sixth)*fm1 + (5*one_sixth)*fp1 - (one_sixth)*fp2;</div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;          <span class="comment">/* HCWENO5 at the interior points */</span></div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;          f1 = (one_sixth) * (fm2 + 5*fm1);</div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;          f2 = (one_sixth) * (5*fm1 + fp1);</div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;          f3 = (one_sixth) * (fm1 + 5*fp1);</div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;        }</div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;</div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;        <span class="comment">/* calculate WENO weights */</span></div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;        <span class="keywordtype">double</span> w1,w2,w3;</div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;        w1 = *(ww1+p*nvars+v);</div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;        w2 = *(ww2+p*nvars+v);</div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;        w3 = *(ww3+p*nvars+v);</div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;</div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;        <span class="comment">/* calculate the hybridization parameter */</span></div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;        <span class="keywordtype">double</span> sigma;</div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;        <span class="keywordflow">if</span> (   ((mpi-&gt;<a class="code" href="a00117.html#aa3c28612a64b8a97bde66b720e15c700">ip</a>[dir] == 0                ) &amp;&amp; (indexI[dir] == 0       ))</div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;            || ((mpi-&gt;<a class="code" href="a00117.html#aa3c28612a64b8a97bde66b720e15c700">ip</a>[dir] == mpi-&gt;<a class="code" href="a00117.html#a0be0f30a83bc3f3d9f6ee3a36bbf2716">iproc</a>[dir]-1) &amp;&amp; (indexI[dir] == dim[dir])) ) {</div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;          <span class="comment">/* Standard WENO at physical boundaries */</span></div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;          sigma = 0.0;</div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;          <span class="keywordtype">double</span> cuckoo, df_jm12, df_jp12, df_jp32, r_j, r_jp1, r_int;</div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;          cuckoo = (0.9*weno-&gt;rc / (1.0-0.9*weno-&gt;rc)) * weno-&gt;xi * weno-&gt;xi;</div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;          df_jm12 = fm1 - fm2;</div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;          df_jp12 = fp1 - fm1;</div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;          df_jp32 = fp2 - fp1;</div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;          r_j   = (<a class="code" href="a00147.html#adf1be5ccbb7a2522b4f3a64043c72880">absolute</a>(2*df_jp12*df_jm12)+cuckoo)/(df_jp12*df_jp12+df_jm12*df_jm12+cuckoo);</div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;          r_jp1 = (<a class="code" href="a00147.html#adf1be5ccbb7a2522b4f3a64043c72880">absolute</a>(2*df_jp32*df_jp12)+cuckoo)/(df_jp32*df_jp32+df_jp12*df_jp12+cuckoo);</div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;          r_int = <a class="code" href="a00147.html#ac6afabdc09a49a433ee19d8a9486056d">min</a>(r_j, r_jp1);</div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;          sigma = <a class="code" href="a00147.html#ac6afabdc09a49a433ee19d8a9486056d">min</a>((r_int/weno-&gt;rc), 1.0); </div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;        }</div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;</div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;        <span class="keywordflow">if</span> (upw &gt; 0) {</div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;          <span class="keywordflow">for</span> (k=0; k&lt;nvars; k++) {</div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;            A[(Nsys*indexI[dir]+sys)*nvars*nvars+v*nvars+k] = (one_half*sigma)  * L[v*nvars+k];</div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;            B[(Nsys*indexI[dir]+sys)*nvars*nvars+v*nvars+k] = (1.0)             * L[v*nvars+k];</div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;            C[(Nsys*indexI[dir]+sys)*nvars*nvars+v*nvars+k] = (one_sixth*sigma) * L[v*nvars+k];</div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;          }</div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;          <span class="keywordflow">for</span> (k=0; k&lt;nvars; k++) {</div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;            C[(Nsys*indexI[dir]+sys)*nvars*nvars+v*nvars+k] = (one_half*sigma)  * L[v*nvars+k];</div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;            B[(Nsys*indexI[dir]+sys)*nvars*nvars+v*nvars+k] = (1.0)             * L[v*nvars+k];</div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;            A[(Nsys*indexI[dir]+sys)*nvars*nvars+v*nvars+k] = (one_sixth*sigma) * L[v*nvars+k];</div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;          }</div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;        }</div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;        <span class="keywordtype">double</span> fWENO, fCompact;</div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;        fWENO    = w1*f1 + w2*f2 + w3*f3;</div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;        fCompact = one_sixth * (one_third*fm2 + 19.0*one_third*fm1 + 10.0*one_third*fp1);</div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;        F[(Nsys*indexI[dir]+sys)*nvars+v] = sigma*fCompact + (1.0-sigma)*fWENO;</div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;      }</div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;    }</div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;  }</div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;</div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;<span class="preprocessor">#ifdef serial</span></div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;<span class="preprocessor"></span></div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;  <span class="comment">/* Solve the tridiagonal system */</span></div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;  <a class="code" href="a00137.html#ad6ab74942c9de13cf0b4c12eb0d91780">IERR</a> <a class="code" href="a00131.html#ad2c404dd44e760ee729740176b186bd0">blocktridiagLU</a>(A,B,C,F,dim[dir]+1,Nsys,nvars,lu,NULL); <a class="code" href="a00137.html#add9cf96ae374934d245a1dc1ab697a42">CHECKERR</a>(ierr);</div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;</div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;<span class="preprocessor">#else</span></div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;<span class="preprocessor"></span></div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;  <span class="comment">/* Solve the tridiagonal system */</span></div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;  <span class="comment">/* all processes except the last will solve without the last interface to avoid overlap */</span></div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;  <span class="keywordflow">if</span> (mpi-&gt;<a class="code" href="a00117.html#aa3c28612a64b8a97bde66b720e15c700">ip</a>[dir] != mpi-&gt;<a class="code" href="a00117.html#a0be0f30a83bc3f3d9f6ee3a36bbf2716">iproc</a>[dir]-1)  { </div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;    <a class="code" href="a00137.html#ad6ab74942c9de13cf0b4c12eb0d91780">IERR</a> <a class="code" href="a00131.html#ad2c404dd44e760ee729740176b186bd0">blocktridiagLU</a>(A,B,C,F,dim[dir]  ,Nsys,nvars,lu,&amp;mpi-&gt;<a class="code" href="a00117.html#a45a2dae130e8ef21ae3aa9c7a9e7a138">comm</a>[dir]); <a class="code" href="a00137.html#add9cf96ae374934d245a1dc1ab697a42">CHECKERR</a>(ierr); </div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;  } <span class="keywordflow">else</span> { </div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;    <a class="code" href="a00137.html#ad6ab74942c9de13cf0b4c12eb0d91780">IERR</a> <a class="code" href="a00131.html#ad2c404dd44e760ee729740176b186bd0">blocktridiagLU</a>(A,B,C,F,dim[dir]+1,Nsys,nvars,lu,&amp;mpi-&gt;<a class="code" href="a00117.html#a45a2dae130e8ef21ae3aa9c7a9e7a138">comm</a>[dir]); <a class="code" href="a00137.html#add9cf96ae374934d245a1dc1ab697a42">CHECKERR</a>(ierr);</div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;  }</div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;</div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;  <span class="comment">/* Now get the solution to the last interface from the next proc */</span></div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;  <span class="keywordtype">double</span> *sendbuf = compact-&gt;<a class="code" href="a00105.html#aba3b15034da676474db917f9f5533085">sendbuf</a>;</div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;  <span class="keywordtype">double</span> *recvbuf = compact-&gt;<a class="code" href="a00105.html#afc23e46e08649e112e8d64d780cea5cb">recvbuf</a>;</div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;  MPI_Request req[2] = {MPI_REQUEST_NULL,MPI_REQUEST_NULL};</div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;  <span class="keywordflow">if</span> (mpi-&gt;<a class="code" href="a00117.html#aa3c28612a64b8a97bde66b720e15c700">ip</a>[dir]) <span class="keywordflow">for</span> (d=0; d&lt;Nsys*nvars; d++) sendbuf[d] = F[d];</div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;  <span class="keywordflow">if</span> (mpi-&gt;<a class="code" href="a00117.html#aa3c28612a64b8a97bde66b720e15c700">ip</a>[dir] != mpi-&gt;<a class="code" href="a00117.html#a0be0f30a83bc3f3d9f6ee3a36bbf2716">iproc</a>[dir]-1) MPI_Irecv(recvbuf,Nsys*nvars,MPI_DOUBLE,mpi-&gt;<a class="code" href="a00117.html#aa3c28612a64b8a97bde66b720e15c700">ip</a>[dir]+1,214,mpi-&gt;<a class="code" href="a00117.html#a45a2dae130e8ef21ae3aa9c7a9e7a138">comm</a>[dir],&amp;req[0]);</div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;  <span class="keywordflow">if</span> (mpi-&gt;<a class="code" href="a00117.html#aa3c28612a64b8a97bde66b720e15c700">ip</a>[dir])                      MPI_Isend(sendbuf,Nsys*nvars,MPI_DOUBLE,mpi-&gt;<a class="code" href="a00117.html#aa3c28612a64b8a97bde66b720e15c700">ip</a>[dir]-1,214,mpi-&gt;<a class="code" href="a00117.html#a45a2dae130e8ef21ae3aa9c7a9e7a138">comm</a>[dir],&amp;req[1]);</div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;  MPI_Waitall(2,&amp;req[0],MPI_STATUS_IGNORE);</div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;  <span class="keywordflow">if</span> (mpi-&gt;<a class="code" href="a00117.html#aa3c28612a64b8a97bde66b720e15c700">ip</a>[dir] != mpi-&gt;<a class="code" href="a00117.html#a0be0f30a83bc3f3d9f6ee3a36bbf2716">iproc</a>[dir]-1) <span class="keywordflow">for</span> (d=0; d&lt;Nsys*nvars; d++) F[d+Nsys*nvars*dim[dir]] = recvbuf[d];</div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;</div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;<span class="preprocessor"></span></div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;  <span class="comment">/* save the solution to fI */</span></div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;<span class="preprocessor">#pragma omp parallel for schedule(auto) default(shared) private(sys,d,v,k,R,L,uavg,index_outer,indexC,indexI)</span></div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;<span class="preprocessor"></span>  <span class="keywordflow">for</span> (sys=0; sys&lt;Nsys; sys++) {</div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;    <a class="code" href="a00136.html#a03f49e4d44ae8aca85cb04cfe91e4ce4">_ArrayIndexnD_</a>(ndims,sys,bounds_outer,index_outer,0);</div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;    <a class="code" href="a00136.html#a89e8330d9e06dd0666c50833628a125c">_ArrayCopy1D_</a>(index_outer,indexI,ndims);</div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;    <span class="keywordflow">for</span> (indexI[dir] = 0; indexI[dir] &lt; dim[dir]+1; indexI[dir]++) {</div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;      <span class="keywordtype">int</span> p; <a class="code" href="a00136.html#afbb862a2fdf5b72b1f9ace42f64b556f">_ArrayIndex1D_</a>(ndims,bounds_inter,indexI,0,p);</div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;      <a class="code" href="a00136.html#a89e8330d9e06dd0666c50833628a125c">_ArrayCopy1D_</a>((F+sys*nvars+Nsys*nvars*indexI[dir]),(fI+nvars*p),nvars);</div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;    }</div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;  }</div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;</div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;  <span class="keywordflow">return</span>(0);</div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;}</div>
<div class="ttc" id="a00131_html_a00521"><div class="ttname"><a href="a00131.html#a00521">TridiagLU</a></div><div class="ttdef"><b>Definition:</b> <a href="a00131_source.html#l00084">tridiagLU.h:84</a></div></div>
<div class="ttc" id="a00115_html_a56318721d534e74a96b440f8542a0232"><div class="ttname"><a href="a00115.html#a56318721d534e74a96b440f8542a0232">HyPar::compact</a></div><div class="ttdeci">void * compact</div><div class="ttdef"><b>Definition:</b> <a href="a00143_source.html#l00328">hypar.h:328</a></div></div>
<div class="ttc" id="a00115_html_a484873c74138512e41bc50d17b7d955a"><div class="ttname"><a href="a00115.html#a484873c74138512e41bc50d17b7d955a">HyPar::ndims</a></div><div class="ttdeci">int ndims</div><div class="ttdef"><b>Definition:</b> <a href="a00143_source.html#l00026">hypar.h:26</a></div></div>
<div class="ttc" id="a00115_html_aafc992b5fa79d5a4036024615d03bce6"><div class="ttname"><a href="a00115.html#aafc992b5fa79d5a4036024615d03bce6">HyPar::ghosts</a></div><div class="ttdeci">int ghosts</div><div class="ttdef"><b>Definition:</b> <a href="a00143_source.html#l00044">hypar.h:44</a></div></div>
<div class="ttc" id="a00115_html"><div class="ttname"><a href="a00115.html">HyPar</a></div><div class="ttdoc">Structure containing all solver-specific variables and functions. </div><div class="ttdef"><b>Definition:</b> <a href="a00143_source.html#l00023">hypar.h:23</a></div></div>
<div class="ttc" id="a00105_html_ac06de847603f5cfaec085f6fe500f3c8"><div class="ttname"><a href="a00105.html#ac06de847603f5cfaec085f6fe500f3c8">CompactScheme::R</a></div><div class="ttdeci">double * R</div><div class="ttdef"><b>Definition:</b> <a href="a00105_source.html#l00439">interpolation.h:439</a></div></div>
<div class="ttc" id="a00105_html_a00503"><div class="ttname"><a href="a00105.html#a00503">CompactScheme</a></div><div class="ttdoc">Structure of variables/parameters needed by the compact schemes. </div><div class="ttdef"><b>Definition:</b> <a href="a00105_source.html#l00437">interpolation.h:437</a></div></div>
<div class="ttc" id="a00137_html_ad6ab74942c9de13cf0b4c12eb0d91780"><div class="ttname"><a href="a00137.html#ad6ab74942c9de13cf0b4c12eb0d91780">IERR</a></div><div class="ttdeci">#define IERR</div><div class="ttdef"><b>Definition:</b> <a href="a00137_source.html#l00012">basic.h:12</a></div></div>
<div class="ttc" id="a00105_html_a00523"><div class="ttname"><a href="a00105.html#a00523">WENOParameters</a></div><div class="ttdoc">Structure of variables/parameters needed by the WENO-type scheme. </div><div class="ttdef"><b>Definition:</b> <a href="a00105_source.html#l00175">interpolation.h:175</a></div></div>
<div class="ttc" id="a00105_html_aba3b15034da676474db917f9f5533085"><div class="ttname"><a href="a00105.html#aba3b15034da676474db917f9f5533085">CompactScheme::sendbuf</a></div><div class="ttdeci">double * sendbuf</div><div class="ttdef"><b>Definition:</b> <a href="a00105_source.html#l00444">interpolation.h:444</a></div></div>
<div class="ttc" id="a00147_html_ac6afabdc09a49a433ee19d8a9486056d"><div class="ttname"><a href="a00147.html#ac6afabdc09a49a433ee19d8a9486056d">min</a></div><div class="ttdeci">#define min(a, b)</div><div class="ttdef"><b>Definition:</b> <a href="a00147_source.html#l00015">mathfunctions.h:15</a></div></div>
<div class="ttc" id="a00117_html_a0be0f30a83bc3f3d9f6ee3a36bbf2716"><div class="ttname"><a href="a00117.html#a0be0f30a83bc3f3d9f6ee3a36bbf2716">MPIVariables::iproc</a></div><div class="ttdeci">int * iproc</div><div class="ttdef"><b>Definition:</b> <a href="a00117_source.html#l00027">mpivars_struct.h:27</a></div></div>
<div class="ttc" id="a00115_html_a8c603c73be1f08e408a1de94a088da7b"><div class="ttname"><a href="a00115.html#a8c603c73be1f08e408a1de94a088da7b">HyPar::GetLeftEigenvectors</a></div><div class="ttdeci">int(* GetLeftEigenvectors)(double *, double *, void *, int)</div><div class="ttdef"><b>Definition:</b> <a href="a00143_source.html#l00321">hypar.h:321</a></div></div>
<div class="ttc" id="a00115_html_ae8f6d2fd6490d3153cb4133bf183a404"><div class="ttname"><a href="a00115.html#ae8f6d2fd6490d3153cb4133bf183a404">HyPar::nvars</a></div><div class="ttdeci">int nvars</div><div class="ttdef"><b>Definition:</b> <a href="a00143_source.html#l00029">hypar.h:29</a></div></div>
<div class="ttc" id="a00105_html_a0a26ce8d1878aac6ddc87e3f6290e039"><div class="ttname"><a href="a00105.html#a0a26ce8d1878aac6ddc87e3f6290e039">CompactScheme::C</a></div><div class="ttdeci">double * C</div><div class="ttdef"><b>Definition:</b> <a href="a00105_source.html#l00439">interpolation.h:439</a></div></div>
<div class="ttc" id="a00136_html_a89e8330d9e06dd0666c50833628a125c"><div class="ttname"><a href="a00136.html#a89e8330d9e06dd0666c50833628a125c">_ArrayCopy1D_</a></div><div class="ttdeci">#define _ArrayCopy1D_(x, y, size)</div><div class="ttdef"><b>Definition:</b> <a href="a00136_source.html#l00318">arrayfunctions.h:318</a></div></div>
<div class="ttc" id="a00105_html_afc23e46e08649e112e8d64d780cea5cb"><div class="ttname"><a href="a00105.html#afc23e46e08649e112e8d64d780cea5cb">CompactScheme::recvbuf</a></div><div class="ttdeci">double * recvbuf</div><div class="ttdef"><b>Definition:</b> <a href="a00105_source.html#l00444">interpolation.h:444</a></div></div>
<div class="ttc" id="a00115_html_a38e0371f331cecbe63a77fa03e202afe"><div class="ttname"><a href="a00115.html#a38e0371f331cecbe63a77fa03e202afe">HyPar::dim_local</a></div><div class="ttdeci">int * dim_local</div><div class="ttdef"><b>Definition:</b> <a href="a00143_source.html#l00035">hypar.h:35</a></div></div>
<div class="ttc" id="a00115_html_a22eef349f191a1aa267e14b08140c823"><div class="ttname"><a href="a00115.html#a22eef349f191a1aa267e14b08140c823">HyPar::GetRightEigenvectors</a></div><div class="ttdeci">int(* GetRightEigenvectors)(double *, double *, void *, int)</div><div class="ttdef"><b>Definition:</b> <a href="a00143_source.html#l00323">hypar.h:323</a></div></div>
<div class="ttc" id="a00131_html_ad2c404dd44e760ee729740176b186bd0"><div class="ttname"><a href="a00131.html#ad2c404dd44e760ee729740176b186bd0">blocktridiagLU</a></div><div class="ttdeci">int blocktridiagLU(double *, double *, double *, double *, int, int, int, void *, void *)</div><div class="ttdef"><b>Definition:</b> <a href="a00493_source.html#l00107">blocktridiagLU.c:107</a></div></div>
<div class="ttc" id="a00117_html_aa3c28612a64b8a97bde66b720e15c700"><div class="ttname"><a href="a00117.html#aa3c28612a64b8a97bde66b720e15c700">MPIVariables::ip</a></div><div class="ttdeci">int * ip</div><div class="ttdef"><b>Definition:</b> <a href="a00117_source.html#l00028">mpivars_struct.h:28</a></div></div>
<div class="ttc" id="a00117_html_a00516"><div class="ttname"><a href="a00117.html#a00516">MPIVariables</a></div><div class="ttdoc">Structure of MPI-related variables. </div><div class="ttdef"><b>Definition:</b> <a href="a00117_source.html#l00024">mpivars_struct.h:24</a></div></div>
<div class="ttc" id="a00137_html_add9cf96ae374934d245a1dc1ab697a42"><div class="ttname"><a href="a00137.html#add9cf96ae374934d245a1dc1ab697a42">CHECKERR</a></div><div class="ttdeci">#define CHECKERR(ierr)</div><div class="ttdef"><b>Definition:</b> <a href="a00137_source.html#l00014">basic.h:14</a></div></div>
<div class="ttc" id="a00115_html_a1dbfa1e479a373073b6ebf72401a7f0f"><div class="ttname"><a href="a00115.html#a1dbfa1e479a373073b6ebf72401a7f0f">HyPar::lusolver</a></div><div class="ttdeci">void * lusolver</div><div class="ttdef"><b>Definition:</b> <a href="a00143_source.html#l00332">hypar.h:332</a></div></div>
<div class="ttc" id="a00136_html_a03f49e4d44ae8aca85cb04cfe91e4ce4"><div class="ttname"><a href="a00136.html#a03f49e4d44ae8aca85cb04cfe91e4ce4">_ArrayIndexnD_</a></div><div class="ttdeci">#define _ArrayIndexnD_(N, index, imax, i, ghost)</div><div class="ttdef"><b>Definition:</b> <a href="a00136_source.html#l00020">arrayfunctions.h:20</a></div></div>
<div class="ttc" id="a00115_html_a29c46b81ad574e4dfbad5a7211487dcb"><div class="ttname"><a href="a00115.html#a29c46b81ad574e4dfbad5a7211487dcb">HyPar::interp</a></div><div class="ttdeci">void * interp</div><div class="ttdef"><b>Definition:</b> <a href="a00143_source.html#l00326">hypar.h:326</a></div></div>
<div class="ttc" id="a00136_html_abc65e9c6a51b875f46fdb054a0ecf604"><div class="ttname"><a href="a00136.html#abc65e9c6a51b875f46fdb054a0ecf604">_ArrayProduct1D_</a></div><div class="ttdeci">#define _ArrayProduct1D_(x, size, p)</div><div class="ttdef"><b>Definition:</b> <a href="a00136_source.html#l00376">arrayfunctions.h:376</a></div></div>
<div class="ttc" id="a00115_html_a7331366d789b2995436accbc35e1cc80"><div class="ttname"><a href="a00115.html#a7331366d789b2995436accbc35e1cc80">HyPar::AveragingFunction</a></div><div class="ttdeci">int(* AveragingFunction)(double *, double *, double *, void *)</div><div class="ttdef"><b>Definition:</b> <a href="a00143_source.html#l00318">hypar.h:318</a></div></div>
<div class="ttc" id="a00105_html_ac900805a486cbb8489e3c176ed6e0d8e"><div class="ttname"><a href="a00105.html#ac900805a486cbb8489e3c176ed6e0d8e">CompactScheme::A</a></div><div class="ttdeci">double * A</div><div class="ttdef"><b>Definition:</b> <a href="a00105_source.html#l00439">interpolation.h:439</a></div></div>
<div class="ttc" id="a00136_html_afbb862a2fdf5b72b1f9ace42f64b556f"><div class="ttname"><a href="a00136.html#afbb862a2fdf5b72b1f9ace42f64b556f">_ArrayIndex1D_</a></div><div class="ttdeci">#define _ArrayIndex1D_(N, imax, i, ghost, index)</div><div class="ttdef"><b>Definition:</b> <a href="a00136_source.html#l00039">arrayfunctions.h:39</a></div></div>
<div class="ttc" id="a00117_html_a45a2dae130e8ef21ae3aa9c7a9e7a138"><div class="ttname"><a href="a00117.html#a45a2dae130e8ef21ae3aa9c7a9e7a138">MPIVariables::comm</a></div><div class="ttdeci">MPI_Comm * comm</div><div class="ttdef"><b>Definition:</b> <a href="a00117_source.html#l00038">mpivars_struct.h:38</a></div></div>
<div class="ttc" id="a00137_html_a68f50121fb9a7daeaf60e50cdef82ef3"><div class="ttname"><a href="a00137.html#a68f50121fb9a7daeaf60e50cdef82ef3">_DECLARE_IERR_</a></div><div class="ttdeci">#define _DECLARE_IERR_</div><div class="ttdef"><b>Definition:</b> <a href="a00137_source.html#l00013">basic.h:13</a></div></div>
<div class="ttc" id="a00147_html_adf1be5ccbb7a2522b4f3a64043c72880"><div class="ttname"><a href="a00147.html#adf1be5ccbb7a2522b4f3a64043c72880">absolute</a></div><div class="ttdeci">#define absolute(a)</div><div class="ttdef"><b>Definition:</b> <a href="a00147_source.html#l00033">mathfunctions.h:33</a></div></div>
<div class="ttc" id="a00105_html_ad36954709307649365515214a02ab06d"><div class="ttname"><a href="a00105.html#ad36954709307649365515214a02ab06d">CompactScheme::B</a></div><div class="ttdeci">double * B</div><div class="ttdef"><b>Definition:</b> <a href="a00105_source.html#l00439">interpolation.h:439</a></div></div>
<div class="ttc" id="a00115_html_a48e81a1806b5774943fd9a26e9a190f2"><div class="ttname"><a href="a00115.html#a48e81a1806b5774943fd9a26e9a190f2">HyPar::physics</a></div><div class="ttdeci">void * physics</div><div class="ttdef"><b>Definition:</b> <a href="a00143_source.html#l00245">hypar.h:245</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ae8bfe856abd743f5af925dc03e708ee3"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int Interp2PrimSecondOrder </td>
          <td>(</td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>fI</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>fC</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>dir</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>s</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>m</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>2nd order component-wise interpolation of the 2nd primitive on a uniform grid </p>
<p>Interpolation of the second primitive at the cell interfaces using the second-order central scheme</p>
<p>Computes the interpolated values of the second primitive of a function \({\bf f}\left({\bf u}\right)\) at the interfaces from the cell-centered values of the function using the second order central method on a uniform grid. The second primitive is defined as a function \({\bf h}\left({\bf u}\right)\) that satisfies: </p>
<p class="formulaDsp">
\begin{equation} {\bf f}\left({\bf u}\left(x\right)\right) = \frac{1}{\Delta x^2} \int_{x-\Delta x/2}^{x+\Delta x/2} \left( \int_{\eta-\Delta x/2}^{\eta+\Delta x/2} {\bf h}\left({\bf u}\left(\zeta\right)\right) d\zeta \right) d\eta, \end{equation}
</p>
<p> where \(x\) is the spatial coordinate along the dimension of the interpolation. This function the 2nd order central numerical approximation \(\hat{\bf f}_{j+1/2} \approx {\bf h}_{j+1/2}\) as \(\hat{\bf f}_{j+1/2} \approx {\bf h}_{j+1/2}\) as: </p>
<p class="formulaDsp">
\begin{equation} \hat{\bf f}_{j+1/2} = \frac{1}{2}\left( {\bf f}_{j+1} - {\bf f}_j \right). \end{equation}
</p>
<p><b>Implementation</b> <b>Notes:</b> </p>
<ul>
<li>The scalar interpolation method is applied to the vector function in a component-wise manner.</li>
<li>The function computes the interpolant for the entire grid in one call. It loops over all the grid lines along the interpolation direction and carries out the 1D interpolation along these grid lines.</li>
<li>Location of cell-centers and cell interfaces along the spatial dimension of the interpolation is shown in the following figure: <div class="image">
<img src="chap1_1Ddomain.png" alt="chap1_1Ddomain.png"/>
</div>
 </li>
</ul>
<p><b>Reference:</b> </p>
<ul>
<li>Liu, Y., Shu, C.-W., Zhang, M., High Order Finite Difference WENO Schemes for Nonlinear Degenerate Parabolic Equations, SIAM J. Sci. Comput., 33 (2), 2011, pp. 939-965, <a href="http://dx.doi.org/10.1137/100791002">http://dx.doi.org/10.1137/100791002</a>.</li>
</ul>
<p><b>Function</b> <b>arguments:</b> </p>
<table class="doxtable">
<tr>
<th>Argument </th><th>Type </th><th>Explanation  </th></tr>
<tr>
<td>fI </td><td>double* </td><td>Array to hold the computed interpolant at the grid interfaces. This array must have the same layout as the solution, but with <b>no</b> <b>ghost</b> <b>points</b>. Its size should be the same as u in all dimensions, except dir (the dimension along which to interpolate) along which it should be larger by 1 (number of interfaces is 1 more than the number of interior cell centers). </td></tr>
<tr>
<td>fC </td><td>double* </td><td>Array with the cell-centered values of the flux function \({\bf f}\left({\bf u}\right)\). This array must have the same layout and size as the solution, <b>with</b> <b>ghost</b> <b>points</b>. </td></tr>
<tr>
<td>dir </td><td>int </td><td>Spatial dimension along which to interpolate (eg: 0 for 1D; 0 or 1 for 2D; 0,1 or 2 for 3D) </td></tr>
<tr>
<td>s </td><td>void* </td><td>Solver object of type <a class="el" href="a00115.html" title="Structure containing all solver-specific variables and functions. ">HyPar</a>: the following variables are needed - <a class="el" href="a00115.html#aafc992b5fa79d5a4036024615d03bce6">HyPar::ghosts</a>, <a class="el" href="a00115.html#a484873c74138512e41bc50d17b7d955a">HyPar::ndims</a>, <a class="el" href="a00115.html#ae8f6d2fd6490d3153cb4133bf183a404">HyPar::nvars</a>, <a class="el" href="a00115.html#a38e0371f331cecbe63a77fa03e202afe">HyPar::dim_local</a>. </td></tr>
<tr>
<td>m </td><td>void* </td><td>MPI object of type <a class="el" href="a00117.html#a00516" title="Structure of MPI-related variables. ">MPIVariables</a>: this is needed only by compact interpolation method that need to solve a global implicit system across MPI ranks. </td></tr>
</table>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">fI</td><td>Array of interpolated function values at the interfaces </td></tr>
    <tr><td class="paramname">fC</td><td>Array of cell-centered values of the function \({\bf f}\left({\bf u}\right)\) </td></tr>
    <tr><td class="paramname">dir</td><td>Spatial dimension along which to interpolation </td></tr>
    <tr><td class="paramname">s</td><td>Object of type <a class="el" href="a00115.html" title="Structure containing all solver-specific variables and functions. ">HyPar</a> containing solver-related variables </td></tr>
    <tr><td class="paramname">m</td><td>Object of type <a class="el" href="a00117.html#a00516" title="Structure of MPI-related variables. ">MPIVariables</a> containing MPI-related variables </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="a00240_source.html#l00056">56</a> of file <a class="el" href="a00240_source.html">Interp2PrimSecondOrder.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;{</div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;  <a class="code" href="a00115.html">HyPar</a>         *solver = (<a class="code" href="a00115.html">HyPar</a>*)        s;</div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;</div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;  <span class="keywordtype">int</span> ghosts = solver-&gt;<a class="code" href="a00115.html#aafc992b5fa79d5a4036024615d03bce6">ghosts</a>;</div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;  <span class="keywordtype">int</span> ndims  = solver-&gt;<a class="code" href="a00115.html#a484873c74138512e41bc50d17b7d955a">ndims</a>;</div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;  <span class="keywordtype">int</span> nvars  = solver-&gt;<a class="code" href="a00115.html#ae8f6d2fd6490d3153cb4133bf183a404">nvars</a>;</div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;  <span class="keywordtype">int</span> *dim   = solver-&gt;<a class="code" href="a00115.html#a38e0371f331cecbe63a77fa03e202afe">dim_local</a>;</div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;</div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;  <span class="comment">/* create index and bounds for the outer loop, i.e., to loop over all 1D lines along</span></div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;<span class="comment">     dimension &quot;dir&quot;                                                                    */</span></div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;  <span class="keywordtype">int</span> indexC[ndims], indexI[ndims], index_outer[ndims], bounds_outer[ndims], bounds_inter[ndims];</div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;  <a class="code" href="a00136.html#a89e8330d9e06dd0666c50833628a125c">_ArrayCopy1D_</a>(dim,bounds_outer,ndims); bounds_outer[dir] =  1;</div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;  <a class="code" href="a00136.html#a89e8330d9e06dd0666c50833628a125c">_ArrayCopy1D_</a>(dim,bounds_inter,ndims); bounds_inter[dir] += 1;</div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;</div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;  <span class="keywordtype">int</span> done = 0; <a class="code" href="a00136.html#a2b2826031c0cd92495ab351d3e599fc5">_ArraySetValue_</a>(index_outer,ndims,0);</div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;  <span class="keywordflow">while</span> (!done) {</div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;    <a class="code" href="a00136.html#a89e8330d9e06dd0666c50833628a125c">_ArrayCopy1D_</a>(index_outer,indexC,ndims);</div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;    <a class="code" href="a00136.html#a89e8330d9e06dd0666c50833628a125c">_ArrayCopy1D_</a>(index_outer,indexI,ndims);</div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;    <span class="keywordflow">for</span> (indexI[dir] = 0; indexI[dir] &lt; dim[dir]+1; indexI[dir]++) {</div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;      <span class="keywordtype">int</span> p, qL, qR;</div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;      <a class="code" href="a00136.html#afbb862a2fdf5b72b1f9ace42f64b556f">_ArrayIndex1D_</a>(ndims,bounds_inter,indexI,0,p);</div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;      indexC[dir] = indexI[dir]-1; <a class="code" href="a00136.html#afbb862a2fdf5b72b1f9ace42f64b556f">_ArrayIndex1D_</a>(ndims,dim,indexC,ghosts,qL);</div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;      indexC[dir] = indexI[dir]  ; <a class="code" href="a00136.html#afbb862a2fdf5b72b1f9ace42f64b556f">_ArrayIndex1D_</a>(ndims,dim,indexC,ghosts,qR);</div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;      <span class="keywordtype">int</span> v; <span class="keywordflow">for</span> (v=0; v&lt;nvars; v++) fI[p*nvars+v] = (fC[qR*nvars+v] - fC[qL*nvars+v]);</div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;    }</div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;    <a class="code" href="a00136.html#ac5ec1371623f11d03b0f42adaa24acbc">_ArrayIncrementIndex_</a>(ndims,bounds_outer,index_outer,done);</div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;  }</div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;  </div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;  <span class="keywordflow">return</span>(0);</div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;}</div>
<div class="ttc" id="a00136_html_ac5ec1371623f11d03b0f42adaa24acbc"><div class="ttname"><a href="a00136.html#ac5ec1371623f11d03b0f42adaa24acbc">_ArrayIncrementIndex_</a></div><div class="ttdeci">#define _ArrayIncrementIndex_(N, imax, i, done)</div><div class="ttdef"><b>Definition:</b> <a href="a00136_source.html#l00125">arrayfunctions.h:125</a></div></div>
<div class="ttc" id="a00115_html_a484873c74138512e41bc50d17b7d955a"><div class="ttname"><a href="a00115.html#a484873c74138512e41bc50d17b7d955a">HyPar::ndims</a></div><div class="ttdeci">int ndims</div><div class="ttdef"><b>Definition:</b> <a href="a00143_source.html#l00026">hypar.h:26</a></div></div>
<div class="ttc" id="a00115_html_aafc992b5fa79d5a4036024615d03bce6"><div class="ttname"><a href="a00115.html#aafc992b5fa79d5a4036024615d03bce6">HyPar::ghosts</a></div><div class="ttdeci">int ghosts</div><div class="ttdef"><b>Definition:</b> <a href="a00143_source.html#l00044">hypar.h:44</a></div></div>
<div class="ttc" id="a00115_html"><div class="ttname"><a href="a00115.html">HyPar</a></div><div class="ttdoc">Structure containing all solver-specific variables and functions. </div><div class="ttdef"><b>Definition:</b> <a href="a00143_source.html#l00023">hypar.h:23</a></div></div>
<div class="ttc" id="a00115_html_ae8f6d2fd6490d3153cb4133bf183a404"><div class="ttname"><a href="a00115.html#ae8f6d2fd6490d3153cb4133bf183a404">HyPar::nvars</a></div><div class="ttdeci">int nvars</div><div class="ttdef"><b>Definition:</b> <a href="a00143_source.html#l00029">hypar.h:29</a></div></div>
<div class="ttc" id="a00136_html_a89e8330d9e06dd0666c50833628a125c"><div class="ttname"><a href="a00136.html#a89e8330d9e06dd0666c50833628a125c">_ArrayCopy1D_</a></div><div class="ttdeci">#define _ArrayCopy1D_(x, y, size)</div><div class="ttdef"><b>Definition:</b> <a href="a00136_source.html#l00318">arrayfunctions.h:318</a></div></div>
<div class="ttc" id="a00115_html_a38e0371f331cecbe63a77fa03e202afe"><div class="ttname"><a href="a00115.html#a38e0371f331cecbe63a77fa03e202afe">HyPar::dim_local</a></div><div class="ttdeci">int * dim_local</div><div class="ttdef"><b>Definition:</b> <a href="a00143_source.html#l00035">hypar.h:35</a></div></div>
<div class="ttc" id="a00136_html_a2b2826031c0cd92495ab351d3e599fc5"><div class="ttname"><a href="a00136.html#a2b2826031c0cd92495ab351d3e599fc5">_ArraySetValue_</a></div><div class="ttdeci">#define _ArraySetValue_(x, size, value)</div><div class="ttdef"><b>Definition:</b> <a href="a00136_source.html#l00168">arrayfunctions.h:168</a></div></div>
<div class="ttc" id="a00136_html_afbb862a2fdf5b72b1f9ace42f64b556f"><div class="ttname"><a href="a00136.html#afbb862a2fdf5b72b1f9ace42f64b556f">_ArrayIndex1D_</a></div><div class="ttdeci">#define _ArrayIndex1D_(N, imax, i, ghost, index)</div><div class="ttdef"><b>Definition:</b> <a href="a00136_source.html#l00039">arrayfunctions.h:39</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a249ae68fb7394160a7a709220b684acb"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int InterpSetLimiterVar </td>
          <td>(</td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname">&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Function to calculate and save the nonlinear interpolation coefficients for a non-linear (solution-dependent) interpolation scheme (eg. <a class="el" href="a00105.html#acfeff1b158131390b7129f4a857b15ff">_FIFTH_ORDER_WENO_</a>, <a class="el" href="a00105.html#a175a82b8ae2b24c0ba51e1b1dd68c0e5">_FIFTH_ORDER_CRWENO_</a>, <a class="el" href="a00105.html#a6d34f5e8aae80a0d2a27ea20368dfef1">_FIFTH_ORDER_HCWENO_</a>, etc). </p>

</div>
</div>
<a class="anchor" id="a22e0ae19117192cae9978a7a741d15a5"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int MUSCLInitialize </td>
          <td>(</td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>s</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>m</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Initialize the 2nd or 3rd order MUSCL scheme. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">s</td><td>Solver object of type <a class="el" href="a00115.html" title="Structure containing all solver-specific variables and functions. ">HyPar</a> </td></tr>
    <tr><td class="paramname">m</td><td>MPI object of type <a class="el" href="a00117.html#a00516" title="Structure of MPI-related variables. ">MPIVariables</a> </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="a00241_source.html#l00017">17</a> of file <a class="el" href="a00241_source.html">MUSCLInitialize.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;{</div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;  <a class="code" href="a00115.html">HyPar</a>           *solver = (<a class="code" href="a00115.html">HyPar</a>*) s;</div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;  <a class="code" href="a00117.html#a00516">MPIVariables</a>    *mpi    = (<a class="code" href="a00117.html#a00516">MPIVariables</a>*) m;</div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;  <a class="code" href="a00118.html">MUSCLParameters</a> *muscl  = (<a class="code" href="a00118.html">MUSCLParameters</a>*) solver-&gt;<a class="code" href="a00115.html#a29c46b81ad574e4dfbad5a7211487dcb">interp</a>;</div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;</div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;  <span class="comment">/* default values */</span></div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;  muscl-&gt;<a class="code" href="a00118.html#a974b448c3d0a13d483d36ef15de369b5">eps</a> = 1e-3;</div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;  strcpy(muscl-&gt;<a class="code" href="a00118.html#a719bcd37c38ee89560c4e08566d0ce05">limiter_type</a>, <a class="code" href="a00146.html#a709c944f0d1acdf4471cebadad905603">_LIM_GM_</a>);</div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;</div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;  <span class="keywordflow">if</span> (!mpi-&gt;<a class="code" href="a00117.html#a6cfd95afd0afebd625b889fb6e58371c">rank</a>) {</div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;    FILE *in;</div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;    <span class="keywordtype">int</span> ferr;</div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;    in = fopen(<span class="stringliteral">&quot;muscl.inp&quot;</span>,<span class="stringliteral">&quot;r&quot;</span>);</div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;    <span class="keywordflow">if</span> (!in) printf(<span class="stringliteral">&quot;Warning: File muscl.inp not found. Using default parameters for muscl2/muscl3 scheme.\n&quot;</span>);</div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;    <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;      printf(<span class="stringliteral">&quot;Reading MUSCL parameters from muscl.inp.\n&quot;</span>);</div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;      <span class="keywordtype">char</span> word[<a class="code" href="a00137.html#a51efea86a4d76d1259893f606b776573">_MAX_STRING_SIZE_</a>];</div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;      ferr = fscanf(in,<span class="stringliteral">&quot;%s&quot;</span>,word); <span class="keywordflow">if</span> (ferr != 1) <span class="keywordflow">return</span>(1);</div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;      <span class="keywordflow">if</span> (!strcmp(word, <span class="stringliteral">&quot;begin&quot;</span>)){</div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;          <span class="keywordflow">while</span> (strcmp(word, <span class="stringliteral">&quot;end&quot;</span>)){</div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;              ferr = fscanf(in,<span class="stringliteral">&quot;%s&quot;</span>,word); <span class="keywordflow">if</span> (ferr != 1) <span class="keywordflow">return</span>(1);</div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;          <span class="keywordflow">if</span>      (!strcmp(word,<span class="stringliteral">&quot;epsilon&quot;</span>)) { ferr = fscanf(in,<span class="stringliteral">&quot;%lf&quot;</span>,&amp;muscl-&gt;<a class="code" href="a00118.html#a974b448c3d0a13d483d36ef15de369b5">eps</a>);          <span class="keywordflow">if</span> (ferr != 1) <span class="keywordflow">return</span>(1); }</div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;          <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcmp(word,<span class="stringliteral">&quot;limiter&quot;</span>)) { ferr = fscanf(in,<span class="stringliteral">&quot;%s&quot;</span> ,&amp;muscl-&gt;<a class="code" href="a00118.html#a719bcd37c38ee89560c4e08566d0ce05">limiter_type</a>); <span class="keywordflow">if</span> (ferr != 1) <span class="keywordflow">return</span>(1); }</div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;          <span class="keywordflow">else</span> <span class="keywordflow">if</span> (strcmp(word,<span class="stringliteral">&quot;end&quot;</span>)) {</div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;            <span class="keywordtype">char</span> useless[<a class="code" href="a00137.html#a51efea86a4d76d1259893f606b776573">_MAX_STRING_SIZE_</a>];</div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;            ferr = fscanf(in,<span class="stringliteral">&quot;%s&quot;</span>,useless); <span class="keywordflow">if</span> (ferr != 1) <span class="keywordflow">return</span>(ferr);</div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;            printf(<span class="stringliteral">&quot;Warning: keyword %s in file \&quot;muscl.inp\&quot; with value %s not &quot;</span>,word,useless);</div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;            printf(<span class="stringliteral">&quot;recognized or extraneous. Ignoring.\n&quot;</span>);</div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;          }</div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;        }</div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;          fprintf(stderr,<span class="stringliteral">&quot;Error: Illegal format in file \&quot;muscl.inp\&quot;.\n&quot;</span>);</div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;        <span class="keywordflow">return</span>(1);</div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;        }</div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;      fclose(in);</div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;    }</div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;  }</div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;</div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;  <a class="code" href="a00149.html#a45dcb265863a65d862bb16222e7e623c">MPIBroadcast_double</a>(&amp;muscl-&gt;<a class="code" href="a00118.html#a974b448c3d0a13d483d36ef15de369b5">eps</a>, 1, 0, &amp;mpi-&gt;<a class="code" href="a00117.html#adad7a6f85831f3ac84d854b6c80aef43">world</a>);</div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;  <a class="code" href="a00149.html#ad408e5a44e863cca50112d1e2f728597">MPIBroadcast_character</a>(muscl-&gt;<a class="code" href="a00118.html#a719bcd37c38ee89560c4e08566d0ce05">limiter_type</a>, <a class="code" href="a00137.html#a51efea86a4d76d1259893f606b776573">_MAX_STRING_SIZE_</a>, 0, &amp;mpi-&gt;<a class="code" href="a00117.html#adad7a6f85831f3ac84d854b6c80aef43">world</a>);</div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;</div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;  <span class="keywordflow">if</span> (!strcmp(muscl-&gt;<a class="code" href="a00118.html#a719bcd37c38ee89560c4e08566d0ce05">limiter_type</a>, <a class="code" href="a00146.html#a709c944f0d1acdf4471cebadad905603">_LIM_GM_</a>)) {</div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;    muscl-&gt;<a class="code" href="a00118.html#af0d0dd685b67f7e293e616cbfc1ccce6">LimiterFunction</a> = <a class="code" href="a00146.html#aa3a1bfccb1c53cfcdb4ce40e8dcdf754">LimiterGeneralizedMinMod</a>;</div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;  } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcmp(muscl-&gt;<a class="code" href="a00118.html#a719bcd37c38ee89560c4e08566d0ce05">limiter_type</a>, <a class="code" href="a00146.html#ab5921c3e03f8c8afdcdc402008f70119">_LIM_MM_</a>)) {</div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;    muscl-&gt;<a class="code" href="a00118.html#af0d0dd685b67f7e293e616cbfc1ccce6">LimiterFunction</a> = <a class="code" href="a00146.html#a5a7e3e6ec209bbe35f9278625ccae845">LimiterMinMod</a>;</div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;  } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcmp(muscl-&gt;<a class="code" href="a00118.html#a719bcd37c38ee89560c4e08566d0ce05">limiter_type</a>, <a class="code" href="a00146.html#a367f4f3889293e279da34b5325e45c0b">_LIM_VANLEER_</a>)) {</div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;    muscl-&gt;<a class="code" href="a00118.html#af0d0dd685b67f7e293e616cbfc1ccce6">LimiterFunction</a> = <a class="code" href="a00146.html#a65cac92ad79132ce522202535b165dbf">LimiterVanLeer</a>;</div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;  } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcmp(muscl-&gt;<a class="code" href="a00118.html#a719bcd37c38ee89560c4e08566d0ce05">limiter_type</a>, <a class="code" href="a00146.html#a1eb2f1d88c4ccd13f08d495a7740ba19">_LIM_SUPERBEE_</a>)) {</div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;    muscl-&gt;<a class="code" href="a00118.html#af0d0dd685b67f7e293e616cbfc1ccce6">LimiterFunction</a> = <a class="code" href="a00146.html#af8c1bbcc710852804d9be359bb88c770">LimiterSuperBee</a>;</div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;  } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;    <span class="keywordflow">if</span> (!mpi-&gt;<a class="code" href="a00117.html#a6cfd95afd0afebd625b889fb6e58371c">rank</a>) {</div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;      fprintf(stderr, <span class="stringliteral">&quot;Warning: %s is an invalid limiter type. Using default (Generalized MinMod).\n&quot;</span>, </div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;              muscl-&gt;<a class="code" href="a00118.html#a719bcd37c38ee89560c4e08566d0ce05">limiter_type</a>);</div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;    }</div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;    muscl-&gt;<a class="code" href="a00118.html#af0d0dd685b67f7e293e616cbfc1ccce6">LimiterFunction</a> = <a class="code" href="a00146.html#aa3a1bfccb1c53cfcdb4ce40e8dcdf754">LimiterGeneralizedMinMod</a>;</div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;  }</div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;  </div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;  <span class="keywordflow">return</span>(0);</div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;}</div>
<div class="ttc" id="a00146_html_a1eb2f1d88c4ccd13f08d495a7740ba19"><div class="ttname"><a href="a00146.html#a1eb2f1d88c4ccd13f08d495a7740ba19">_LIM_SUPERBEE_</a></div><div class="ttdeci">#define _LIM_SUPERBEE_</div><div class="ttdef"><b>Definition:</b> <a href="a00146_source.html#l00016">limiters.h:16</a></div></div>
<div class="ttc" id="a00137_html_a51efea86a4d76d1259893f606b776573"><div class="ttname"><a href="a00137.html#a51efea86a4d76d1259893f606b776573">_MAX_STRING_SIZE_</a></div><div class="ttdeci">#define _MAX_STRING_SIZE_</div><div class="ttdef"><b>Definition:</b> <a href="a00137_source.html#l00010">basic.h:10</a></div></div>
<div class="ttc" id="a00146_html_a709c944f0d1acdf4471cebadad905603"><div class="ttname"><a href="a00146.html#a709c944f0d1acdf4471cebadad905603">_LIM_GM_</a></div><div class="ttdeci">#define _LIM_GM_</div><div class="ttdef"><b>Definition:</b> <a href="a00146_source.html#l00010">limiters.h:10</a></div></div>
<div class="ttc" id="a00149_html_ad408e5a44e863cca50112d1e2f728597"><div class="ttname"><a href="a00149.html#ad408e5a44e863cca50112d1e2f728597">MPIBroadcast_character</a></div><div class="ttdeci">int MPIBroadcast_character(char *, int, int, void *)</div><div class="ttdef"><b>Definition:</b> <a href="a00259_source.html#l00037">MPIBroadcast.c:37</a></div></div>
<div class="ttc" id="a00115_html"><div class="ttname"><a href="a00115.html">HyPar</a></div><div class="ttdoc">Structure containing all solver-specific variables and functions. </div><div class="ttdef"><b>Definition:</b> <a href="a00143_source.html#l00023">hypar.h:23</a></div></div>
<div class="ttc" id="a00149_html_a45dcb265863a65d862bb16222e7e623c"><div class="ttname"><a href="a00149.html#a45dcb265863a65d862bb16222e7e623c">MPIBroadcast_double</a></div><div class="ttdeci">int MPIBroadcast_double(double *, int, int, void *)</div><div class="ttdef"><b>Definition:</b> <a href="a00259_source.html#l00009">MPIBroadcast.c:9</a></div></div>
<div class="ttc" id="a00146_html_a367f4f3889293e279da34b5325e45c0b"><div class="ttname"><a href="a00146.html#a367f4f3889293e279da34b5325e45c0b">_LIM_VANLEER_</a></div><div class="ttdeci">#define _LIM_VANLEER_</div><div class="ttdef"><b>Definition:</b> <a href="a00146_source.html#l00014">limiters.h:14</a></div></div>
<div class="ttc" id="a00118_html"><div class="ttname"><a href="a00118.html">MUSCLParameters</a></div><div class="ttdoc">Structure of variables/parameters needed by the MUSCL scheme. </div><div class="ttdef"><b>Definition:</b> <a href="a00105_source.html#l00156">interpolation.h:156</a></div></div>
<div class="ttc" id="a00117_html_a6cfd95afd0afebd625b889fb6e58371c"><div class="ttname"><a href="a00117.html#a6cfd95afd0afebd625b889fb6e58371c">MPIVariables::rank</a></div><div class="ttdeci">int rank</div><div class="ttdef"><b>Definition:</b> <a href="a00117_source.html#l00025">mpivars_struct.h:25</a></div></div>
<div class="ttc" id="a00118_html_a719bcd37c38ee89560c4e08566d0ce05"><div class="ttname"><a href="a00118.html#a719bcd37c38ee89560c4e08566d0ce05">MUSCLParameters::limiter_type</a></div><div class="ttdeci">char limiter_type[_MAX_STRING_SIZE_]</div><div class="ttdef"><b>Definition:</b> <a href="a00105_source.html#l00158">interpolation.h:158</a></div></div>
<div class="ttc" id="a00146_html_a5a7e3e6ec209bbe35f9278625ccae845"><div class="ttname"><a href="a00146.html#a5a7e3e6ec209bbe35f9278625ccae845">LimiterMinMod</a></div><div class="ttdeci">double LimiterMinMod(double)</div><div class="ttdef"><b>Definition:</b> <a href="a00253_source.html#l00016">LimiterMinMod.c:16</a></div></div>
<div class="ttc" id="a00117_html_a00516"><div class="ttname"><a href="a00117.html#a00516">MPIVariables</a></div><div class="ttdoc">Structure of MPI-related variables. </div><div class="ttdef"><b>Definition:</b> <a href="a00117_source.html#l00024">mpivars_struct.h:24</a></div></div>
<div class="ttc" id="a00115_html_a29c46b81ad574e4dfbad5a7211487dcb"><div class="ttname"><a href="a00115.html#a29c46b81ad574e4dfbad5a7211487dcb">HyPar::interp</a></div><div class="ttdeci">void * interp</div><div class="ttdef"><b>Definition:</b> <a href="a00143_source.html#l00326">hypar.h:326</a></div></div>
<div class="ttc" id="a00118_html_af0d0dd685b67f7e293e616cbfc1ccce6"><div class="ttname"><a href="a00118.html#af0d0dd685b67f7e293e616cbfc1ccce6">MUSCLParameters::LimiterFunction</a></div><div class="ttdeci">double(* LimiterFunction)(double)</div><div class="ttdef"><b>Definition:</b> <a href="a00105_source.html#l00162">interpolation.h:162</a></div></div>
<div class="ttc" id="a00146_html_a65cac92ad79132ce522202535b165dbf"><div class="ttname"><a href="a00146.html#a65cac92ad79132ce522202535b165dbf">LimiterVanLeer</a></div><div class="ttdeci">double LimiterVanLeer(double)</div><div class="ttdef"><b>Definition:</b> <a href="a00255_source.html#l00017">LimiterVanLeer.c:17</a></div></div>
<div class="ttc" id="a00146_html_aa3a1bfccb1c53cfcdb4ce40e8dcdf754"><div class="ttname"><a href="a00146.html#aa3a1bfccb1c53cfcdb4ce40e8dcdf754">LimiterGeneralizedMinMod</a></div><div class="ttdeci">double LimiterGeneralizedMinMod(double)</div><div class="ttdef"><b>Definition:</b> <a href="a00252_source.html#l00016">LimiterGeneralizedMinMod.c:16</a></div></div>
<div class="ttc" id="a00118_html_a974b448c3d0a13d483d36ef15de369b5"><div class="ttname"><a href="a00118.html#a974b448c3d0a13d483d36ef15de369b5">MUSCLParameters::eps</a></div><div class="ttdeci">double eps</div><div class="ttdef"><b>Definition:</b> <a href="a00105_source.html#l00159">interpolation.h:159</a></div></div>
<div class="ttc" id="a00146_html_ab5921c3e03f8c8afdcdc402008f70119"><div class="ttname"><a href="a00146.html#ab5921c3e03f8c8afdcdc402008f70119">_LIM_MM_</a></div><div class="ttdeci">#define _LIM_MM_</div><div class="ttdef"><b>Definition:</b> <a href="a00146_source.html#l00012">limiters.h:12</a></div></div>
<div class="ttc" id="a00146_html_af8c1bbcc710852804d9be359bb88c770"><div class="ttname"><a href="a00146.html#af8c1bbcc710852804d9be359bb88c770">LimiterSuperBee</a></div><div class="ttdeci">double LimiterSuperBee(double)</div><div class="ttdef"><b>Definition:</b> <a href="a00254_source.html#l00016">LimiterSuperBee.c:16</a></div></div>
<div class="ttc" id="a00117_html_adad7a6f85831f3ac84d854b6c80aef43"><div class="ttname"><a href="a00117.html#adad7a6f85831f3ac84d854b6c80aef43">MPIVariables::world</a></div><div class="ttdeci">MPI_Comm world</div><div class="ttdef"><b>Definition:</b> <a href="a00117_source.html#l00037">mpivars_struct.h:37</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="aecbe557b2ccc254cdbbd312fc91717be"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int WENOInitialize </td>
          <td>(</td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>s</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>m</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>scheme</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>type</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Initialize the structure containing variables and parameters for WENO-type schemes</p>
<p>This function initializes the WENO-type methods.</p>
<ul>
<li>Sets the parameters to default values.</li>
<li>Reads in the parameters from optional input file "weno.inp", if available.</li>
<li>Allocates memory for and initializes the nonlinear weights used by WENO-type schemes. </li>
</ul>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">s</td><td>Solver object of type <a class="el" href="a00115.html" title="Structure containing all solver-specific variables and functions. ">HyPar</a> </td></tr>
    <tr><td class="paramname">m</td><td>MPI object of type <a class="el" href="a00117.html#a00516" title="Structure of MPI-related variables. ">MPIVariables</a> </td></tr>
    <tr><td class="paramname">scheme</td><td>Name of scheme </td></tr>
    <tr><td class="paramname">type</td><td>Type of interpolation </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="a00245_source.html#l00024">24</a> of file <a class="el" href="a00245_source.html">WENOInitialize.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;{</div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;  <a class="code" href="a00115.html">HyPar</a>           *solver = (<a class="code" href="a00115.html">HyPar</a>*) s;</div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;  <a class="code" href="a00117.html#a00516">MPIVariables</a>    *mpi    = (<a class="code" href="a00117.html#a00516">MPIVariables</a>*) m;</div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;  <a class="code" href="a00105.html#a00523">WENOParameters</a>  *weno   = (<a class="code" href="a00105.html#a00523">WENOParameters</a>*) solver-&gt;<a class="code" href="a00115.html#a29c46b81ad574e4dfbad5a7211487dcb">interp</a>;</div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;</div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;  <span class="keyword">static</span> <span class="keywordtype">int</span> count = 0;</div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;</div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;  <span class="keywordtype">int</span> nvars = solver-&gt;<a class="code" href="a00115.html#ae8f6d2fd6490d3153cb4133bf183a404">nvars</a>;</div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;  <span class="keywordtype">int</span> ndims = solver-&gt;<a class="code" href="a00115.html#a484873c74138512e41bc50d17b7d955a">ndims</a>;</div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;</div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;  <span class="comment">/* default parameters */</span></div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;  weno-&gt;<a class="code" href="a00105.html#af370a2df117483b6f752da8889a89bb0">mapped</a>      = 0;</div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;  weno-&gt;<a class="code" href="a00105.html#af3c02b1dce05b28870fa1994c40cd1f2">borges</a>      = 0;</div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;  weno-&gt;<a class="code" href="a00105.html#a8470a9f95ece04985a5031e745042b7e">yc</a>          = 0;</div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;  weno-&gt;<a class="code" href="a00105.html#a20e793c98bd33aef1cbbafcf3df48a55">no_limiting</a> = 0;</div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;  weno-&gt;<a class="code" href="a00105.html#a974b448c3d0a13d483d36ef15de369b5">eps</a>         = 1e-6;</div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;  weno-&gt;<a class="code" href="a00105.html#aace2d484b0e3651abd108f04803d316c">p</a>           = 2.0;</div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;</div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;  weno-&gt;<a class="code" href="a00105.html#af77cf650495294f69237f94cc237cba3">rc</a>          = 0.3;</div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;  weno-&gt;<a class="code" href="a00105.html#adf147b14a64e08756e9e30868e943da8">xi</a>          = 0.001;</div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;  weno-&gt;<a class="code" href="a00105.html#a2687e4b3cb5da7dbd00e565343f66c6c">tol</a>         = 1e-16;</div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;</div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;  if (!mpi-&gt;<a class="code" href="a00117.html#a6cfd95afd0afebd625b889fb6e58371c">rank</a>) {</div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;    FILE *in;</div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;    <span class="keywordtype">int</span> ferr;</div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;    in = fopen(<span class="stringliteral">&quot;weno.inp&quot;</span>,<span class="stringliteral">&quot;r&quot;</span>);</div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;    <span class="keywordflow">if</span> (!in) printf(<span class="stringliteral">&quot;Warning: File weno.inp not found. Using default parameters for WENO5/CRWENO5/HCWENO5 scheme.\n&quot;</span>);</div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;    <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;      <span class="keywordflow">if</span> (!count) printf(<span class="stringliteral">&quot;Reading WENO parameters from weno.inp.\n&quot;</span>);</div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;      <span class="keywordtype">char</span> word[<a class="code" href="a00137.html#a51efea86a4d76d1259893f606b776573">_MAX_STRING_SIZE_</a>];</div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;      ferr = fscanf(in,<span class="stringliteral">&quot;%s&quot;</span>,word); <span class="keywordflow">if</span> (ferr != 1) <span class="keywordflow">return</span>(1);</div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;      <span class="keywordflow">if</span> (!strcmp(word, <span class="stringliteral">&quot;begin&quot;</span>)){</div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;          <span class="keywordflow">while</span> (strcmp(word, <span class="stringliteral">&quot;end&quot;</span>)){</div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;              ferr = fscanf(in,<span class="stringliteral">&quot;%s&quot;</span>,word); <span class="keywordflow">if</span> (ferr != 1) <span class="keywordflow">return</span>(1);</div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;          <span class="keywordflow">if</span>      (!strcmp(word,<span class="stringliteral">&quot;mapped&quot;</span>     )) { ferr = fscanf(in,<span class="stringliteral">&quot;%d&quot;</span> ,&amp;weno-&gt;<a class="code" href="a00105.html#af370a2df117483b6f752da8889a89bb0">mapped</a>     ); <span class="keywordflow">if</span> (ferr != 1) <span class="keywordflow">return</span>(1); }</div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;          <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcmp(word,<span class="stringliteral">&quot;borges&quot;</span>     )) { ferr = fscanf(in,<span class="stringliteral">&quot;%d&quot;</span> ,&amp;weno-&gt;<a class="code" href="a00105.html#af3c02b1dce05b28870fa1994c40cd1f2">borges</a>     ); <span class="keywordflow">if</span> (ferr != 1) <span class="keywordflow">return</span>(1); }</div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;          <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcmp(word,<span class="stringliteral">&quot;yc&quot;</span>         )) { ferr = fscanf(in,<span class="stringliteral">&quot;%d&quot;</span> ,&amp;weno-&gt;<a class="code" href="a00105.html#a8470a9f95ece04985a5031e745042b7e">yc</a>         ); <span class="keywordflow">if</span> (ferr != 1) <span class="keywordflow">return</span>(1); }</div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;          <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcmp(word,<span class="stringliteral">&quot;no_limiting&quot;</span>)) { ferr = fscanf(in,<span class="stringliteral">&quot;%d&quot;</span> ,&amp;weno-&gt;<a class="code" href="a00105.html#a20e793c98bd33aef1cbbafcf3df48a55">no_limiting</a>); <span class="keywordflow">if</span> (ferr != 1) <span class="keywordflow">return</span>(1); }</div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;          <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcmp(word,<span class="stringliteral">&quot;epsilon&quot;</span>    )) { ferr = fscanf(in,<span class="stringliteral">&quot;%lf&quot;</span>,&amp;weno-&gt;<a class="code" href="a00105.html#a974b448c3d0a13d483d36ef15de369b5">eps</a>        ); <span class="keywordflow">if</span> (ferr != 1) <span class="keywordflow">return</span>(1); }</div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;          <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcmp(word,<span class="stringliteral">&quot;p&quot;</span>          )) { ferr = fscanf(in,<span class="stringliteral">&quot;%lf&quot;</span>,&amp;weno-&gt;<a class="code" href="a00105.html#aace2d484b0e3651abd108f04803d316c">p</a>          ); <span class="keywordflow">if</span> (ferr != 1) <span class="keywordflow">return</span>(1); }</div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;          <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcmp(word,<span class="stringliteral">&quot;rc&quot;</span>         )) { ferr = fscanf(in,<span class="stringliteral">&quot;%lf&quot;</span>,&amp;weno-&gt;<a class="code" href="a00105.html#af77cf650495294f69237f94cc237cba3">rc</a>         ); <span class="keywordflow">if</span> (ferr != 1) <span class="keywordflow">return</span>(1); }</div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;          <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcmp(word,<span class="stringliteral">&quot;xi&quot;</span>         )) { ferr = fscanf(in,<span class="stringliteral">&quot;%lf&quot;</span>,&amp;weno-&gt;<a class="code" href="a00105.html#adf147b14a64e08756e9e30868e943da8">xi</a>         ); <span class="keywordflow">if</span> (ferr != 1) <span class="keywordflow">return</span>(1); }</div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;          <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcmp(word,<span class="stringliteral">&quot;tol&quot;</span>        )) { ferr = fscanf(in,<span class="stringliteral">&quot;%lf&quot;</span>,&amp;weno-&gt;<a class="code" href="a00105.html#a2687e4b3cb5da7dbd00e565343f66c6c">tol</a>        ); <span class="keywordflow">if</span> (ferr != 1) <span class="keywordflow">return</span>(1); }</div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;          <span class="keywordflow">else</span> <span class="keywordflow">if</span> (strcmp(word,<span class="stringliteral">&quot;end&quot;</span>)) {</div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;            <span class="keywordtype">char</span> useless[<a class="code" href="a00137.html#a51efea86a4d76d1259893f606b776573">_MAX_STRING_SIZE_</a>];</div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;            ferr = fscanf(in,<span class="stringliteral">&quot;%s&quot;</span>,useless); <span class="keywordflow">if</span> (ferr != 1) <span class="keywordflow">return</span>(ferr);</div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;            printf(<span class="stringliteral">&quot;Warning: keyword %s in file \&quot;weno.inp\&quot; with value %s not &quot;</span>,word,useless);</div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;            printf(<span class="stringliteral">&quot;recognized or extraneous. Ignoring.\n&quot;</span>);</div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;          }</div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;        }</div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;          fprintf(stderr,<span class="stringliteral">&quot;Error: Illegal format in file \&quot;weno.inp\&quot;.\n&quot;</span>);</div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;        <span class="keywordflow">return</span>(1);</div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;        }</div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;      fclose(in);</div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;    }</div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;  }</div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;</div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;  <span class="keywordtype">int</span>     integer_data[4];</div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;  <span class="keywordtype">double</span>  real_data[5];</div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;  <span class="keywordflow">if</span> (!mpi-&gt;<a class="code" href="a00117.html#a6cfd95afd0afebd625b889fb6e58371c">rank</a>) {</div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;    integer_data[0] = weno-&gt;<a class="code" href="a00105.html#af370a2df117483b6f752da8889a89bb0">mapped</a>;</div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;    integer_data[1] = weno-&gt;<a class="code" href="a00105.html#af3c02b1dce05b28870fa1994c40cd1f2">borges</a>;</div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;    integer_data[2] = weno-&gt;<a class="code" href="a00105.html#a8470a9f95ece04985a5031e745042b7e">yc</a>;</div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;    integer_data[3] = weno-&gt;<a class="code" href="a00105.html#a20e793c98bd33aef1cbbafcf3df48a55">no_limiting</a>;</div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;    real_data[0]    = weno-&gt;<a class="code" href="a00105.html#a974b448c3d0a13d483d36ef15de369b5">eps</a>;</div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;    real_data[1]    = weno-&gt;<a class="code" href="a00105.html#aace2d484b0e3651abd108f04803d316c">p</a>;</div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;    real_data[2]    = weno-&gt;<a class="code" href="a00105.html#af77cf650495294f69237f94cc237cba3">rc</a>;</div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;    real_data[3]    = weno-&gt;<a class="code" href="a00105.html#adf147b14a64e08756e9e30868e943da8">xi</a>;</div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;    real_data[4]    = weno-&gt;<a class="code" href="a00105.html#a2687e4b3cb5da7dbd00e565343f66c6c">tol</a>;</div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;  }</div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;  <a class="code" href="a00149.html#acd7957559b9206224c7da3cab4f22b27">MPIBroadcast_integer</a>(integer_data,4,0,&amp;mpi-&gt;<a class="code" href="a00117.html#adad7a6f85831f3ac84d854b6c80aef43">world</a>);</div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;  <a class="code" href="a00149.html#a45dcb265863a65d862bb16222e7e623c">MPIBroadcast_double</a> (real_data   ,5,0,&amp;mpi-&gt;<a class="code" href="a00117.html#adad7a6f85831f3ac84d854b6c80aef43">world</a>);</div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;  </div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;  weno-&gt;<a class="code" href="a00105.html#af370a2df117483b6f752da8889a89bb0">mapped</a>      = integer_data[0];</div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;  weno-&gt;<a class="code" href="a00105.html#af3c02b1dce05b28870fa1994c40cd1f2">borges</a>      = integer_data[1];</div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;  weno-&gt;<a class="code" href="a00105.html#a8470a9f95ece04985a5031e745042b7e">yc</a>          = integer_data[2];</div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;  weno-&gt;<a class="code" href="a00105.html#a20e793c98bd33aef1cbbafcf3df48a55">no_limiting</a> = integer_data[3];</div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;  weno-&gt;<a class="code" href="a00105.html#a974b448c3d0a13d483d36ef15de369b5">eps</a>         = real_data   [0];</div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;  weno-&gt;<a class="code" href="a00105.html#aace2d484b0e3651abd108f04803d316c">p</a>           = real_data   [1];</div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;  weno-&gt;<a class="code" href="a00105.html#af77cf650495294f69237f94cc237cba3">rc</a>          = real_data   [2];</div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;  weno-&gt;<a class="code" href="a00105.html#adf147b14a64e08756e9e30868e943da8">xi</a>          = real_data   [3];</div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;  weno-&gt;<a class="code" href="a00105.html#a2687e4b3cb5da7dbd00e565343f66c6c">tol</a>         = real_data   [4];</div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;</div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;  <span class="comment">/* WENO weight calculation is hard-coded for p=2, so return error if p != 2 in</span></div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;<span class="comment">   * user input file, so that there&#39;s no confusion */</span></div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;  <span class="keywordflow">if</span> (weno-&gt;<a class="code" href="a00105.html#aace2d484b0e3651abd108f04803d316c">p</a> != 2.0) {</div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;    <span class="keywordflow">if</span> (!mpi-&gt;<a class="code" href="a00117.html#a6cfd95afd0afebd625b889fb6e58371c">rank</a> &amp;&amp; !count) printf(<span class="stringliteral">&quot;Warning from WENOInitialize(): \&quot;p\&quot; parameter is 2.0. Any other value will be ignored!\n&quot;</span>);</div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;  }</div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;</div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;  weno-&gt;<a class="code" href="a00105.html#ad0c30ee1add42468a6d7c022f2efdf70">offset</a> = (<span class="keywordtype">int</span>*) calloc (ndims,<span class="keyword">sizeof</span>(<span class="keywordtype">int</span>));</div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;  <span class="keywordtype">int</span> dir,d;</div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;  <span class="keywordflow">for</span> (dir=0; dir&lt;ndims; dir++) {</div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;    weno-&gt;<a class="code" href="a00105.html#ad0c30ee1add42468a6d7c022f2efdf70">offset</a>[dir] = 0;</div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;    <span class="keywordflow">for</span> (d=0; d&lt;dir; d++) {</div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;      <span class="keywordtype">int</span> size = nvars, i;</div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;      <span class="keywordflow">for</span> (i=0; i&lt;ndims; i++) </div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;        size *= ( i==d ? solver-&gt;<a class="code" href="a00115.html#a38e0371f331cecbe63a77fa03e202afe">dim_local</a>[i]+1 : solver-&gt;<a class="code" href="a00115.html#a38e0371f331cecbe63a77fa03e202afe">dim_local</a>[i] );</div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;      weno-&gt;<a class="code" href="a00105.html#ad0c30ee1add42468a6d7c022f2efdf70">offset</a>[dir] += size;</div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;    }</div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;  }</div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;</div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;  <span class="keywordtype">int</span> total_size = 0;</div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;  <span class="keywordflow">for</span> (d=0; d&lt;ndims; d++) {</div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;    <span class="keywordtype">int</span> size = nvars, i;</div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;    <span class="keywordflow">for</span> (i=0; i&lt;ndims; i++) </div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;      size *= ( i==d ? solver-&gt;<a class="code" href="a00115.html#a38e0371f331cecbe63a77fa03e202afe">dim_local</a>[i]+1 : solver-&gt;<a class="code" href="a00115.html#a38e0371f331cecbe63a77fa03e202afe">dim_local</a>[i] );</div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;    total_size += size;</div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;  }</div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;  weno-&gt;<a class="code" href="a00105.html#a439227feff9d7f55384e8780cfc2eb82">size</a> = total_size;</div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;</div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;  weno-&gt;<a class="code" href="a00105.html#a3ee56e3d8244b3d4582f1396a79f9791">w1</a> = (<span class="keywordtype">double</span>*) calloc (4*total_size,<span class="keyword">sizeof</span>(<span class="keywordtype">double</span>));</div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;  weno-&gt;<a class="code" href="a00105.html#a31eb3c1fcb3bc85ab4fa156325a1f849">w2</a> = (<span class="keywordtype">double</span>*) calloc (4*total_size,<span class="keyword">sizeof</span>(<span class="keywordtype">double</span>));</div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;  weno-&gt;<a class="code" href="a00105.html#aabd83eb3f8a7e3bb9f79a4a943bbd508">w3</a> = (<span class="keywordtype">double</span>*) calloc (4*total_size,<span class="keyword">sizeof</span>(<span class="keywordtype">double</span>));</div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;</div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;  <span class="keywordflow">if</span> ((!strcmp(type,<a class="code" href="a00105.html#aa7752b40155314f9f2c063d4d9d8339d">_CHARACTERISTIC_</a>)) &amp;&amp; (nvars &gt; 1)) </div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;    solver-&gt;<a class="code" href="a00115.html#afeeb150a9699ade5eccc7589fcae3fe0">SetInterpLimiterVar</a> = <a class="code" href="a00243.html#a6f1f5da1b6e5134bb1deccfad05a506d">WENOFifthOrderCalculateWeightsChar</a>;</div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;  <span class="keywordflow">else</span> solver-&gt;<a class="code" href="a00115.html#afeeb150a9699ade5eccc7589fcae3fe0">SetInterpLimiterVar</a> = <a class="code" href="a00243.html#a91383df8b8b5f32861e2ecb18dab8ab7">WENOFifthOrderCalculateWeights</a>;</div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;</div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;  <span class="comment">/* initialize WENO weights to their optimal values */</span></div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;  for (d=0; d&lt;ndims; d++) <a class="code" href="a00244.html#a9518887c8f6d1554faf274a46afbf2ad">WENOFifthOrderInitializeWeights</a>(d,solver,mpi);</div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;</div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;  count++;</div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;  <span class="keywordflow">return</span>(0);</div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;}</div>
<div class="ttc" id="a00137_html_a51efea86a4d76d1259893f606b776573"><div class="ttname"><a href="a00137.html#a51efea86a4d76d1259893f606b776573">_MAX_STRING_SIZE_</a></div><div class="ttdeci">#define _MAX_STRING_SIZE_</div><div class="ttdef"><b>Definition:</b> <a href="a00137_source.html#l00010">basic.h:10</a></div></div>
<div class="ttc" id="a00115_html_a484873c74138512e41bc50d17b7d955a"><div class="ttname"><a href="a00115.html#a484873c74138512e41bc50d17b7d955a">HyPar::ndims</a></div><div class="ttdeci">int ndims</div><div class="ttdef"><b>Definition:</b> <a href="a00143_source.html#l00026">hypar.h:26</a></div></div>
<div class="ttc" id="a00115_html"><div class="ttname"><a href="a00115.html">HyPar</a></div><div class="ttdoc">Structure containing all solver-specific variables and functions. </div><div class="ttdef"><b>Definition:</b> <a href="a00143_source.html#l00023">hypar.h:23</a></div></div>
<div class="ttc" id="a00105_html_a3ee56e3d8244b3d4582f1396a79f9791"><div class="ttname"><a href="a00105.html#a3ee56e3d8244b3d4582f1396a79f9791">WENOParameters::w1</a></div><div class="ttdeci">double * w1</div><div class="ttdef"><b>Definition:</b> <a href="a00105_source.html#l00193">interpolation.h:193</a></div></div>
<div class="ttc" id="a00105_html_a2687e4b3cb5da7dbd00e565343f66c6c"><div class="ttname"><a href="a00105.html#a2687e4b3cb5da7dbd00e565343f66c6c">WENOParameters::tol</a></div><div class="ttdeci">double tol</div><div class="ttdef"><b>Definition:</b> <a href="a00105_source.html#l00182">interpolation.h:182</a></div></div>
<div class="ttc" id="a00105_html_af77cf650495294f69237f94cc237cba3"><div class="ttname"><a href="a00105.html#af77cf650495294f69237f94cc237cba3">WENOParameters::rc</a></div><div class="ttdeci">double rc</div><div class="ttdef"><b>Definition:</b> <a href="a00105_source.html#l00189">interpolation.h:189</a></div></div>
<div class="ttc" id="a00105_html_a31eb3c1fcb3bc85ab4fa156325a1f849"><div class="ttname"><a href="a00105.html#a31eb3c1fcb3bc85ab4fa156325a1f849">WENOParameters::w2</a></div><div class="ttdeci">double * w2</div><div class="ttdef"><b>Definition:</b> <a href="a00105_source.html#l00193">interpolation.h:193</a></div></div>
<div class="ttc" id="a00149_html_a45dcb265863a65d862bb16222e7e623c"><div class="ttname"><a href="a00149.html#a45dcb265863a65d862bb16222e7e623c">MPIBroadcast_double</a></div><div class="ttdeci">int MPIBroadcast_double(double *, int, int, void *)</div><div class="ttdef"><b>Definition:</b> <a href="a00259_source.html#l00009">MPIBroadcast.c:9</a></div></div>
<div class="ttc" id="a00105_html_a00523"><div class="ttname"><a href="a00105.html#a00523">WENOParameters</a></div><div class="ttdoc">Structure of variables/parameters needed by the WENO-type scheme. </div><div class="ttdef"><b>Definition:</b> <a href="a00105_source.html#l00175">interpolation.h:175</a></div></div>
<div class="ttc" id="a00105_html_a439227feff9d7f55384e8780cfc2eb82"><div class="ttname"><a href="a00105.html#a439227feff9d7f55384e8780cfc2eb82">WENOParameters::size</a></div><div class="ttdeci">int size</div><div class="ttdef"><b>Definition:</b> <a href="a00105_source.html#l00197">interpolation.h:197</a></div></div>
<div class="ttc" id="a00105_html_aa7752b40155314f9f2c063d4d9d8339d"><div class="ttname"><a href="a00105.html#aa7752b40155314f9f2c063d4d9d8339d">_CHARACTERISTIC_</a></div><div class="ttdeci">#define _CHARACTERISTIC_</div><div class="ttdef"><b>Definition:</b> <a href="a00105_source.html#l00031">interpolation.h:31</a></div></div>
<div class="ttc" id="a00244_html_a9518887c8f6d1554faf274a46afbf2ad"><div class="ttname"><a href="a00244.html#a9518887c8f6d1554faf274a46afbf2ad">WENOFifthOrderInitializeWeights</a></div><div class="ttdeci">int WENOFifthOrderInitializeWeights(int dir, void *s, void *m)</div><div class="ttdef"><b>Definition:</b> <a href="a00244_source.html#l00033">WENOFifthOrderInitializeWeights.c:33</a></div></div>
<div class="ttc" id="a00105_html_adf147b14a64e08756e9e30868e943da8"><div class="ttname"><a href="a00105.html#adf147b14a64e08756e9e30868e943da8">WENOParameters::xi</a></div><div class="ttdeci">double xi</div><div class="ttdef"><b>Definition:</b> <a href="a00105_source.html#l00189">interpolation.h:189</a></div></div>
<div class="ttc" id="a00105_html_aabd83eb3f8a7e3bb9f79a4a943bbd508"><div class="ttname"><a href="a00105.html#aabd83eb3f8a7e3bb9f79a4a943bbd508">WENOParameters::w3</a></div><div class="ttdeci">double * w3</div><div class="ttdef"><b>Definition:</b> <a href="a00105_source.html#l00193">interpolation.h:193</a></div></div>
<div class="ttc" id="a00115_html_ae8f6d2fd6490d3153cb4133bf183a404"><div class="ttname"><a href="a00115.html#ae8f6d2fd6490d3153cb4133bf183a404">HyPar::nvars</a></div><div class="ttdeci">int nvars</div><div class="ttdef"><b>Definition:</b> <a href="a00143_source.html#l00029">hypar.h:29</a></div></div>
<div class="ttc" id="a00115_html_afeeb150a9699ade5eccc7589fcae3fe0"><div class="ttname"><a href="a00115.html#afeeb150a9699ade5eccc7589fcae3fe0">HyPar::SetInterpLimiterVar</a></div><div class="ttdeci">int(* SetInterpLimiterVar)(double *, double *, double *, int, void *, void *)</div><div class="ttdef"><b>Definition:</b> <a href="a00143_source.html#l00213">hypar.h:213</a></div></div>
<div class="ttc" id="a00115_html_a38e0371f331cecbe63a77fa03e202afe"><div class="ttname"><a href="a00115.html#a38e0371f331cecbe63a77fa03e202afe">HyPar::dim_local</a></div><div class="ttdeci">int * dim_local</div><div class="ttdef"><b>Definition:</b> <a href="a00143_source.html#l00035">hypar.h:35</a></div></div>
<div class="ttc" id="a00105_html_af3c02b1dce05b28870fa1994c40cd1f2"><div class="ttname"><a href="a00105.html#af3c02b1dce05b28870fa1994c40cd1f2">WENOParameters::borges</a></div><div class="ttdeci">int borges</div><div class="ttdef"><b>Definition:</b> <a href="a00105_source.html#l00177">interpolation.h:177</a></div></div>
<div class="ttc" id="a00117_html_a6cfd95afd0afebd625b889fb6e58371c"><div class="ttname"><a href="a00117.html#a6cfd95afd0afebd625b889fb6e58371c">MPIVariables::rank</a></div><div class="ttdeci">int rank</div><div class="ttdef"><b>Definition:</b> <a href="a00117_source.html#l00025">mpivars_struct.h:25</a></div></div>
<div class="ttc" id="a00117_html_a00516"><div class="ttname"><a href="a00117.html#a00516">MPIVariables</a></div><div class="ttdoc">Structure of MPI-related variables. </div><div class="ttdef"><b>Definition:</b> <a href="a00117_source.html#l00024">mpivars_struct.h:24</a></div></div>
<div class="ttc" id="a00115_html_a29c46b81ad574e4dfbad5a7211487dcb"><div class="ttname"><a href="a00115.html#a29c46b81ad574e4dfbad5a7211487dcb">HyPar::interp</a></div><div class="ttdeci">void * interp</div><div class="ttdef"><b>Definition:</b> <a href="a00143_source.html#l00326">hypar.h:326</a></div></div>
<div class="ttc" id="a00105_html_a20e793c98bd33aef1cbbafcf3df48a55"><div class="ttname"><a href="a00105.html#a20e793c98bd33aef1cbbafcf3df48a55">WENOParameters::no_limiting</a></div><div class="ttdeci">int no_limiting</div><div class="ttdef"><b>Definition:</b> <a href="a00105_source.html#l00179">interpolation.h:179</a></div></div>
<div class="ttc" id="a00243_html_a91383df8b8b5f32861e2ecb18dab8ab7"><div class="ttname"><a href="a00243.html#a91383df8b8b5f32861e2ecb18dab8ab7">WENOFifthOrderCalculateWeights</a></div><div class="ttdeci">int WENOFifthOrderCalculateWeights(double *fC, double *uC, double *x, int dir, void *s, void *m)</div><div class="ttdef"><b>Definition:</b> <a href="a00243_source.html#l00035">WENOFifthOrderCalculateWeights.c:35</a></div></div>
<div class="ttc" id="a00105_html_ad0c30ee1add42468a6d7c022f2efdf70"><div class="ttname"><a href="a00105.html#ad0c30ee1add42468a6d7c022f2efdf70">WENOParameters::offset</a></div><div class="ttdeci">int * offset</div><div class="ttdef"><b>Definition:</b> <a href="a00105_source.html#l00197">interpolation.h:197</a></div></div>
<div class="ttc" id="a00105_html_af370a2df117483b6f752da8889a89bb0"><div class="ttname"><a href="a00105.html#af370a2df117483b6f752da8889a89bb0">WENOParameters::mapped</a></div><div class="ttdeci">int mapped</div><div class="ttdef"><b>Definition:</b> <a href="a00105_source.html#l00176">interpolation.h:176</a></div></div>
<div class="ttc" id="a00105_html_aace2d484b0e3651abd108f04803d316c"><div class="ttname"><a href="a00105.html#aace2d484b0e3651abd108f04803d316c">WENOParameters::p</a></div><div class="ttdeci">double p</div><div class="ttdef"><b>Definition:</b> <a href="a00105_source.html#l00181">interpolation.h:181</a></div></div>
<div class="ttc" id="a00105_html_a8470a9f95ece04985a5031e745042b7e"><div class="ttname"><a href="a00105.html#a8470a9f95ece04985a5031e745042b7e">WENOParameters::yc</a></div><div class="ttdeci">int yc</div><div class="ttdef"><b>Definition:</b> <a href="a00105_source.html#l00178">interpolation.h:178</a></div></div>
<div class="ttc" id="a00105_html_a974b448c3d0a13d483d36ef15de369b5"><div class="ttname"><a href="a00105.html#a974b448c3d0a13d483d36ef15de369b5">WENOParameters::eps</a></div><div class="ttdeci">double eps</div><div class="ttdef"><b>Definition:</b> <a href="a00105_source.html#l00180">interpolation.h:180</a></div></div>
<div class="ttc" id="a00243_html_a6f1f5da1b6e5134bb1deccfad05a506d"><div class="ttname"><a href="a00243.html#a6f1f5da1b6e5134bb1deccfad05a506d">WENOFifthOrderCalculateWeightsChar</a></div><div class="ttdeci">int WENOFifthOrderCalculateWeightsChar(double *fC, double *uC, double *x, int dir, void *s, void *m)</div><div class="ttdef"><b>Definition:</b> <a href="a00243_source.html#l00057">WENOFifthOrderCalculateWeights.c:57</a></div></div>
<div class="ttc" id="a00149_html_acd7957559b9206224c7da3cab4f22b27"><div class="ttname"><a href="a00149.html#acd7957559b9206224c7da3cab4f22b27">MPIBroadcast_integer</a></div><div class="ttdeci">int MPIBroadcast_integer(int *, int, int, void *)</div><div class="ttdef"><b>Definition:</b> <a href="a00259_source.html#l00023">MPIBroadcast.c:23</a></div></div>
<div class="ttc" id="a00117_html_adad7a6f85831f3ac84d854b6c80aef43"><div class="ttname"><a href="a00117.html#adad7a6f85831f3ac84d854b6c80aef43">MPIVariables::world</a></div><div class="ttdeci">MPI_Comm world</div><div class="ttdef"><b>Definition:</b> <a href="a00117_source.html#l00037">mpivars_struct.h:37</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a37dd034f5e9eb221bd3fd51cc8d1b0f4"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int WENOCleanup </td>
          <td>(</td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>s</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Clean up the structure containing variables and parameters for WENO-type schemes</p>
<p>Cleans up all allocations related to the WENO-type methods. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">s</td><td>WENO object of type <a class="el" href="a00105.html#a00523" title="Structure of variables/parameters needed by the WENO-type scheme. ">WENOParameters</a> </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="a00242_source.html#l00014">14</a> of file <a class="el" href="a00242_source.html">WENOCleanup.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;{</div>
<div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;  <a class="code" href="a00105.html#a00523">WENOParameters</a>  *weno   = (<a class="code" href="a00105.html#a00523">WENOParameters</a>*) s;</div>
<div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;</div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;  free(weno-&gt;<a class="code" href="a00105.html#ad0c30ee1add42468a6d7c022f2efdf70">offset</a>);</div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;  free(weno-&gt;<a class="code" href="a00105.html#a3ee56e3d8244b3d4582f1396a79f9791">w1</a>);</div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;  free(weno-&gt;<a class="code" href="a00105.html#a31eb3c1fcb3bc85ab4fa156325a1f849">w2</a>);</div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;  free(weno-&gt;<a class="code" href="a00105.html#aabd83eb3f8a7e3bb9f79a4a943bbd508">w3</a>);</div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;</div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;  <span class="keywordflow">return</span>(0);</div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;}</div>
<div class="ttc" id="a00105_html_a3ee56e3d8244b3d4582f1396a79f9791"><div class="ttname"><a href="a00105.html#a3ee56e3d8244b3d4582f1396a79f9791">WENOParameters::w1</a></div><div class="ttdeci">double * w1</div><div class="ttdef"><b>Definition:</b> <a href="a00105_source.html#l00193">interpolation.h:193</a></div></div>
<div class="ttc" id="a00105_html_a31eb3c1fcb3bc85ab4fa156325a1f849"><div class="ttname"><a href="a00105.html#a31eb3c1fcb3bc85ab4fa156325a1f849">WENOParameters::w2</a></div><div class="ttdeci">double * w2</div><div class="ttdef"><b>Definition:</b> <a href="a00105_source.html#l00193">interpolation.h:193</a></div></div>
<div class="ttc" id="a00105_html_a00523"><div class="ttname"><a href="a00105.html#a00523">WENOParameters</a></div><div class="ttdoc">Structure of variables/parameters needed by the WENO-type scheme. </div><div class="ttdef"><b>Definition:</b> <a href="a00105_source.html#l00175">interpolation.h:175</a></div></div>
<div class="ttc" id="a00105_html_aabd83eb3f8a7e3bb9f79a4a943bbd508"><div class="ttname"><a href="a00105.html#aabd83eb3f8a7e3bb9f79a4a943bbd508">WENOParameters::w3</a></div><div class="ttdeci">double * w3</div><div class="ttdef"><b>Definition:</b> <a href="a00105_source.html#l00193">interpolation.h:193</a></div></div>
<div class="ttc" id="a00105_html_ad0c30ee1add42468a6d7c022f2efdf70"><div class="ttname"><a href="a00105.html#ad0c30ee1add42468a6d7c022f2efdf70">WENOParameters::offset</a></div><div class="ttdeci">int * offset</div><div class="ttdef"><b>Definition:</b> <a href="a00105_source.html#l00197">interpolation.h:197</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="af255a582e14c5820cf12f9f95b4e28fd"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int CompactSchemeInitialize </td>
          <td>(</td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>s</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>m</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>type</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Initialize the structure containing variables and parameters for compact schemes</p>
<p>This function initializes the compact finite-difference methods: allocates the arrays to store the tridiagonal system. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">s</td><td>Solver object of type <a class="el" href="a00115.html" title="Structure containing all solver-specific variables and functions. ">HyPar</a> </td></tr>
    <tr><td class="paramname">m</td><td>MPI object of type <a class="el" href="a00117.html#a00516" title="Structure of MPI-related variables. ">MPIVariables</a> </td></tr>
    <tr><td class="paramname">type</td><td>Type of interpolation </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="a00221_source.html#l00017">17</a> of file <a class="el" href="a00221_source.html">CompactSchemeInitialize.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;{</div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;  <a class="code" href="a00115.html">HyPar</a>         *solver = (<a class="code" href="a00115.html">HyPar</a>*) s;</div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;  <a class="code" href="a00117.html#a00516">MPIVariables</a>  *mpi    = (<a class="code" href="a00117.html#a00516">MPIVariables</a>*) m;</div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;  <a class="code" href="a00105.html#a00503">CompactScheme</a> *compact   = (<a class="code" href="a00105.html#a00503">CompactScheme</a>*) solver-&gt;<a class="code" href="a00115.html#a56318721d534e74a96b440f8542a0232">compact</a>;</div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;</div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;  <span class="keywordtype">int</span> nvars = solver-&gt;<a class="code" href="a00115.html#ae8f6d2fd6490d3153cb4133bf183a404">nvars</a>;</div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;  <span class="keywordtype">int</span> ndims = solver-&gt;<a class="code" href="a00115.html#a484873c74138512e41bc50d17b7d955a">ndims</a>;</div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;</div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;  <span class="keywordtype">int</span> size = 1, d;</div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;  for (d=0; d&lt;solver-&gt;<a class="code" href="a00115.html#a484873c74138512e41bc50d17b7d955a">ndims</a>; d++) size *= (solver-&gt;<a class="code" href="a00115.html#a38e0371f331cecbe63a77fa03e202afe">dim_local</a>[d]+1);</div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;  size *= solver-&gt;<a class="code" href="a00115.html#ae8f6d2fd6490d3153cb4133bf183a404">nvars</a>;</div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;  <span class="keywordflow">if</span> (!strcmp(solver-&gt;<a class="code" href="a00115.html#a9591ba0fadb863561474e2ba251d2594">interp_type</a>,<a class="code" href="a00105.html#aa7752b40155314f9f2c063d4d9d8339d">_CHARACTERISTIC_</a>)) size *= solver-&gt;<a class="code" href="a00115.html#ae8f6d2fd6490d3153cb4133bf183a404">nvars</a>;</div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;</div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;  compact-&gt;<a class="code" href="a00105.html#ac900805a486cbb8489e3c176ed6e0d8e">A</a> = (<span class="keywordtype">double</span>*) calloc (size, <span class="keyword">sizeof</span>(<span class="keywordtype">double</span>));</div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;  compact-&gt;<a class="code" href="a00105.html#ad36954709307649365515214a02ab06d">B</a> = (<span class="keywordtype">double</span>*) calloc (size, <span class="keyword">sizeof</span>(<span class="keywordtype">double</span>));</div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;  compact-&gt;<a class="code" href="a00105.html#a0a26ce8d1878aac6ddc87e3f6290e039">C</a> = (<span class="keywordtype">double</span>*) calloc (size, <span class="keyword">sizeof</span>(<span class="keywordtype">double</span>));</div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;  compact-&gt;<a class="code" href="a00105.html#ac06de847603f5cfaec085f6fe500f3c8">R</a> = (<span class="keywordtype">double</span>*) calloc (size, <span class="keyword">sizeof</span>(<span class="keywordtype">double</span>));</div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;</div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;  compact-&gt;<a class="code" href="a00105.html#aba3b15034da676474db917f9f5533085">sendbuf</a> = (<span class="keywordtype">double</span>*) calloc (size, <span class="keyword">sizeof</span>(<span class="keywordtype">double</span>));</div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;  compact-&gt;<a class="code" href="a00105.html#afc23e46e08649e112e8d64d780cea5cb">recvbuf</a> = (<span class="keywordtype">double</span>*) calloc (size, <span class="keyword">sizeof</span>(<span class="keywordtype">double</span>));</div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;</div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;  <span class="keywordflow">return</span>(0);</div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;}</div>
<div class="ttc" id="a00115_html_a56318721d534e74a96b440f8542a0232"><div class="ttname"><a href="a00115.html#a56318721d534e74a96b440f8542a0232">HyPar::compact</a></div><div class="ttdeci">void * compact</div><div class="ttdef"><b>Definition:</b> <a href="a00143_source.html#l00328">hypar.h:328</a></div></div>
<div class="ttc" id="a00115_html_a484873c74138512e41bc50d17b7d955a"><div class="ttname"><a href="a00115.html#a484873c74138512e41bc50d17b7d955a">HyPar::ndims</a></div><div class="ttdeci">int ndims</div><div class="ttdef"><b>Definition:</b> <a href="a00143_source.html#l00026">hypar.h:26</a></div></div>
<div class="ttc" id="a00115_html"><div class="ttname"><a href="a00115.html">HyPar</a></div><div class="ttdoc">Structure containing all solver-specific variables and functions. </div><div class="ttdef"><b>Definition:</b> <a href="a00143_source.html#l00023">hypar.h:23</a></div></div>
<div class="ttc" id="a00105_html_ac06de847603f5cfaec085f6fe500f3c8"><div class="ttname"><a href="a00105.html#ac06de847603f5cfaec085f6fe500f3c8">CompactScheme::R</a></div><div class="ttdeci">double * R</div><div class="ttdef"><b>Definition:</b> <a href="a00105_source.html#l00439">interpolation.h:439</a></div></div>
<div class="ttc" id="a00105_html_a00503"><div class="ttname"><a href="a00105.html#a00503">CompactScheme</a></div><div class="ttdoc">Structure of variables/parameters needed by the compact schemes. </div><div class="ttdef"><b>Definition:</b> <a href="a00105_source.html#l00437">interpolation.h:437</a></div></div>
<div class="ttc" id="a00105_html_aba3b15034da676474db917f9f5533085"><div class="ttname"><a href="a00105.html#aba3b15034da676474db917f9f5533085">CompactScheme::sendbuf</a></div><div class="ttdeci">double * sendbuf</div><div class="ttdef"><b>Definition:</b> <a href="a00105_source.html#l00444">interpolation.h:444</a></div></div>
<div class="ttc" id="a00105_html_aa7752b40155314f9f2c063d4d9d8339d"><div class="ttname"><a href="a00105.html#aa7752b40155314f9f2c063d4d9d8339d">_CHARACTERISTIC_</a></div><div class="ttdeci">#define _CHARACTERISTIC_</div><div class="ttdef"><b>Definition:</b> <a href="a00105_source.html#l00031">interpolation.h:31</a></div></div>
<div class="ttc" id="a00115_html_ae8f6d2fd6490d3153cb4133bf183a404"><div class="ttname"><a href="a00115.html#ae8f6d2fd6490d3153cb4133bf183a404">HyPar::nvars</a></div><div class="ttdeci">int nvars</div><div class="ttdef"><b>Definition:</b> <a href="a00143_source.html#l00029">hypar.h:29</a></div></div>
<div class="ttc" id="a00105_html_a0a26ce8d1878aac6ddc87e3f6290e039"><div class="ttname"><a href="a00105.html#a0a26ce8d1878aac6ddc87e3f6290e039">CompactScheme::C</a></div><div class="ttdeci">double * C</div><div class="ttdef"><b>Definition:</b> <a href="a00105_source.html#l00439">interpolation.h:439</a></div></div>
<div class="ttc" id="a00105_html_afc23e46e08649e112e8d64d780cea5cb"><div class="ttname"><a href="a00105.html#afc23e46e08649e112e8d64d780cea5cb">CompactScheme::recvbuf</a></div><div class="ttdeci">double * recvbuf</div><div class="ttdef"><b>Definition:</b> <a href="a00105_source.html#l00444">interpolation.h:444</a></div></div>
<div class="ttc" id="a00115_html_a38e0371f331cecbe63a77fa03e202afe"><div class="ttname"><a href="a00115.html#a38e0371f331cecbe63a77fa03e202afe">HyPar::dim_local</a></div><div class="ttdeci">int * dim_local</div><div class="ttdef"><b>Definition:</b> <a href="a00143_source.html#l00035">hypar.h:35</a></div></div>
<div class="ttc" id="a00117_html_a00516"><div class="ttname"><a href="a00117.html#a00516">MPIVariables</a></div><div class="ttdoc">Structure of MPI-related variables. </div><div class="ttdef"><b>Definition:</b> <a href="a00117_source.html#l00024">mpivars_struct.h:24</a></div></div>
<div class="ttc" id="a00105_html_ac900805a486cbb8489e3c176ed6e0d8e"><div class="ttname"><a href="a00105.html#ac900805a486cbb8489e3c176ed6e0d8e">CompactScheme::A</a></div><div class="ttdeci">double * A</div><div class="ttdef"><b>Definition:</b> <a href="a00105_source.html#l00439">interpolation.h:439</a></div></div>
<div class="ttc" id="a00115_html_a9591ba0fadb863561474e2ba251d2594"><div class="ttname"><a href="a00115.html#a9591ba0fadb863561474e2ba251d2594">HyPar::interp_type</a></div><div class="ttdeci">char interp_type[_MAX_STRING_SIZE_]</div><div class="ttdef"><b>Definition:</b> <a href="a00143_source.html#l00072">hypar.h:72</a></div></div>
<div class="ttc" id="a00105_html_ad36954709307649365515214a02ab06d"><div class="ttname"><a href="a00105.html#ad36954709307649365515214a02ab06d">CompactScheme::B</a></div><div class="ttdeci">double * B</div><div class="ttdef"><b>Definition:</b> <a href="a00105_source.html#l00439">interpolation.h:439</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="acfaa225472f09e2ade88945e909d5893"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int CompactSchemeCleanup </td>
          <td>(</td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>s</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Clean up the structure containing variables and parameters for compact schemes</p>
<p>Cleans up all allocations related to the compact finite difference methods. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">s</td><td><a class="el" href="a00105.html#a00503" title="Structure of variables/parameters needed by the compact schemes. ">CompactScheme</a> object of type <a class="el" href="a00105.html#a00503" title="Structure of variables/parameters needed by the compact schemes. ">CompactScheme</a> </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="a00220_source.html#l00014">14</a> of file <a class="el" href="a00220_source.html">CompactSchemeCleanup.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;{</div>
<div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;  <a class="code" href="a00105.html#a00503">CompactScheme</a> *compact   = (<a class="code" href="a00105.html#a00503">CompactScheme</a>*) s;</div>
<div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;</div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;  <span class="keywordflow">if</span> (compact-&gt;<a class="code" href="a00105.html#ac900805a486cbb8489e3c176ed6e0d8e">A</a>) free(compact-&gt;<a class="code" href="a00105.html#ac900805a486cbb8489e3c176ed6e0d8e">A</a>);</div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;  <span class="keywordflow">if</span> (compact-&gt;<a class="code" href="a00105.html#ad36954709307649365515214a02ab06d">B</a>) free(compact-&gt;<a class="code" href="a00105.html#ad36954709307649365515214a02ab06d">B</a>);</div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;  <span class="keywordflow">if</span> (compact-&gt;<a class="code" href="a00105.html#a0a26ce8d1878aac6ddc87e3f6290e039">C</a>) free(compact-&gt;<a class="code" href="a00105.html#a0a26ce8d1878aac6ddc87e3f6290e039">C</a>);</div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;  <span class="keywordflow">if</span> (compact-&gt;<a class="code" href="a00105.html#ac06de847603f5cfaec085f6fe500f3c8">R</a>) free(compact-&gt;<a class="code" href="a00105.html#ac06de847603f5cfaec085f6fe500f3c8">R</a>);</div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;</div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;  <span class="keywordflow">if</span> (compact-&gt;<a class="code" href="a00105.html#aba3b15034da676474db917f9f5533085">sendbuf</a>) free(compact-&gt;<a class="code" href="a00105.html#aba3b15034da676474db917f9f5533085">sendbuf</a>);</div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;  <span class="keywordflow">if</span> (compact-&gt;<a class="code" href="a00105.html#afc23e46e08649e112e8d64d780cea5cb">recvbuf</a>) free(compact-&gt;<a class="code" href="a00105.html#afc23e46e08649e112e8d64d780cea5cb">recvbuf</a>);</div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;</div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;  <span class="keywordflow">return</span>(0);</div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;}</div>
<div class="ttc" id="a00105_html_ac06de847603f5cfaec085f6fe500f3c8"><div class="ttname"><a href="a00105.html#ac06de847603f5cfaec085f6fe500f3c8">CompactScheme::R</a></div><div class="ttdeci">double * R</div><div class="ttdef"><b>Definition:</b> <a href="a00105_source.html#l00439">interpolation.h:439</a></div></div>
<div class="ttc" id="a00105_html_a00503"><div class="ttname"><a href="a00105.html#a00503">CompactScheme</a></div><div class="ttdoc">Structure of variables/parameters needed by the compact schemes. </div><div class="ttdef"><b>Definition:</b> <a href="a00105_source.html#l00437">interpolation.h:437</a></div></div>
<div class="ttc" id="a00105_html_aba3b15034da676474db917f9f5533085"><div class="ttname"><a href="a00105.html#aba3b15034da676474db917f9f5533085">CompactScheme::sendbuf</a></div><div class="ttdeci">double * sendbuf</div><div class="ttdef"><b>Definition:</b> <a href="a00105_source.html#l00444">interpolation.h:444</a></div></div>
<div class="ttc" id="a00105_html_a0a26ce8d1878aac6ddc87e3f6290e039"><div class="ttname"><a href="a00105.html#a0a26ce8d1878aac6ddc87e3f6290e039">CompactScheme::C</a></div><div class="ttdeci">double * C</div><div class="ttdef"><b>Definition:</b> <a href="a00105_source.html#l00439">interpolation.h:439</a></div></div>
<div class="ttc" id="a00105_html_afc23e46e08649e112e8d64d780cea5cb"><div class="ttname"><a href="a00105.html#afc23e46e08649e112e8d64d780cea5cb">CompactScheme::recvbuf</a></div><div class="ttdeci">double * recvbuf</div><div class="ttdef"><b>Definition:</b> <a href="a00105_source.html#l00444">interpolation.h:444</a></div></div>
<div class="ttc" id="a00105_html_ac900805a486cbb8489e3c176ed6e0d8e"><div class="ttname"><a href="a00105.html#ac900805a486cbb8489e3c176ed6e0d8e">CompactScheme::A</a></div><div class="ttdeci">double * A</div><div class="ttdef"><b>Definition:</b> <a href="a00105_source.html#l00439">interpolation.h:439</a></div></div>
<div class="ttc" id="a00105_html_ad36954709307649365515214a02ab06d"><div class="ttname"><a href="a00105.html#ad36954709307649365515214a02ab06d">CompactScheme::B</a></div><div class="ttdeci">double * B</div><div class="ttdef"><b>Definition:</b> <a href="a00105_source.html#l00439">interpolation.h:439</a></div></div>
</div><!-- fragment -->
</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- Start of StatCounter Code for Default Guide -->
<script type="text/javascript">
var sc_project=10897352; 
var sc_invisible=1; 
var sc_security="83042f57"; 
var scJsHost = (("https:" == document.location.protocol) ?
"https://secure." : "http://www.");
document.write("<sc"+"ript type='text/javascript' src='" +
scJsHost+
"statcounter.com/counter/counter.js'></"+"script>");
</script>
<noscript><div class="statcounter"><a title="website
statistics" href="http://statcounter.com/"
target="_blank"><img class="statcounter"
src="//c.statcounter.com/10897352/0/83042f57/1/"
alt="website statistics"></a></div></noscript>
<!-- End of StatCounter Code for Default Guide -->
