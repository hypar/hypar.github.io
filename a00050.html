<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.9.1"/>
<title>HyPar: Numerical Method</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script><script src="http://cdn.mathjax.org/mathjax/latest/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="doxygen_html_style.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">HyPar
   &#160;<span id="projectnumber">1.0</span>
   </div>
   <div id="projectbrief">Finite-Difference Hyperbolic-Parabolic PDE Solver on Cartesian Grids</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.9.1 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li class="current"><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Structures</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('a00050.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">Numerical Method </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p><a class="el" href="a00062.html" title="Structure containing all solver-specific variables and functions. ">HyPar</a> solves the following partial differential equation (PDE) using a conservative finite-difference algorithm on a Cartesian grid. </p><p class="formulaDsp">
\begin{equation} \frac {\partial {\bf u}} {\partial t} = {\bf F}_{\rm hyp}\left({\bf u}\right) + {\bf F}_{\rm par}\left({\bf u}\right) + {\bf F}_{\rm sou}\left({\bf u}\right) \end{equation}
</p>
<p> where \({\bf F}_{\rm hyp}\) is the hyperbolic term, \({\bf F}_{\rm par}\) is the parabolic term, and \({\bf F}_{\rm sou}\) is the source term. Each of these is discretized in space as described below, to obtain the following semi-discrete ordinary differential equation (ODE) in time: </p><p class="formulaDsp">
\begin{equation} \frac {d {\bf u}} {d t} = \hat{\bf F}_{\rm hyp}\left({\bf u}\right) + \hat{\bf F}_{\rm par}\left({\bf u}\right) + \hat{\bf F}_{\rm sou}\left({\bf u}\right) \end{equation}
</p>
<p> where \(\hat{\left(\cdot\right)}\) represents the spatially discretized terms. The governing PDE can be of any space dimension. The semi-discrete ODE is integrated in time by</p><ul>
<li>Using native time integrators (see <a class="el" href="a00057.html" title="Contains structures and function declarations for time integration. ">timeintegration.h</a>, <a class="el" href="a00082.html#a5242c7db89f8888de5d72251e5da91c2">Solve()</a>).</li>
<li>PETSc (<a href="https://www.mcs.anl.gov/petsc/">https://www.mcs.anl.gov/petsc/</a>) - specifically the TS module (see <a class="el" href="a00070.html" title="Contains variables and function definitions for time integration with PETSc (http://www.mcs.anl.gov/petsc/) ">petscinterface.h</a>, <a class="el" href="a00082.html#a4dc9b9ce6ce776b7901fa2a6c9c9c1cf" title="Integrate in time with PETSc. ">SolvePETSc()</a>).</li>
</ul>
<h2>Hyperbolic term </h2>
<p>The hyperbolic term is of the following form: </p><p class="formulaDsp">
\begin{equation} {\bf F}_{\rm hyp}\left({\bf u}\right) = -\sum_{d=0}^{D-1} \frac{\partial {\bf f}_d\left({\bf u}\right)}{\partial x_d} \end{equation}
</p>
<p> and is discretized as: </p><p class="formulaDsp">
\begin{equation} {\bf F}_{\rm hyp}\left({\bf u}\right) \approx - \sum_{d=0}^{D-1} \frac{1}{\Delta x_d} \left[ \hat{\bf f}_{d,j+1/2} - \hat{\bf f}_{d,j-1/2} \right] \end{equation}
</p>
<p> where \(d\) is the spatial dimension, \(D\) is the total number of spatial dimensions, \(j\) denotes the grid index along \(d\). This is implemented in <a class="el" href="a00123.html#a0096c47175c007dbe805b34129835b84">HyperbolicFunction()</a>.</p>
<p>The numerical approximation \(\hat{\bf f}_{d,j+1/2}\) of the primitive of the flux \({\bf f}_d\left({\bf u}\right)\) at the grid interfaces \(j+1/2\) is expressed as </p><p class="formulaDsp">
\begin{equation} \hat{\bf f}_{d,j+1/2} = \mathcal{U}\left(\hat{\bf f}^L_{d,j+1/2},\hat{\bf f}^R_{d,j+1/2},\hat{\bf u}^L_{d,j+1/2},\hat{\bf u}^R_{d,j+1/2}\right) \end{equation}
</p>
<p> where \(\mathcal{U}\) is an upwinding function. <a class="el" href="a00062.html#a3687b87fa31b07580aa2ef43089fb010">HyPar::Upwind</a> points to the physical model-specific upwinding function that implements \(\mathcal{U}\), and is set by the initialization function of a specific physical model (for example <a class="el" href="a00086.html#a2143f7f3c03f53cf752a344a613fe429">Euler1DInitialize()</a>). The physical model is specified by setting <a class="el" href="a00062.html#ad3fe4b266b398f3a7567ac1b241d99a2">HyPar::model</a> (read from <em>"solver.inp"</em> in <a class="el" href="a00082.html#a1eaea8a114ef1dad09df700d03e735e9">ReadInputs()</a>).</p>
<p>\(\hat{\bf f}^{L,R}_{d,j+1/2}\) are the left- and right-biased numerically interpolated values of the primitive of the flux \({\bf f}_d\left({\bf u}\right)\) at the grid interfaces and are computed using <a class="el" href="a00062.html#a9a8456b08cde5ecf5d15e67e0729525c">HyPar::InterpolateInterfacesHyp</a>. They are initialized in <a class="el" href="a00082.html#a8166bb7cded409b3baa135d99fd6bc7c">InitializeSolvers()</a> based on the value of <a class="el" href="a00062.html#ad29846eeb9c83b329a8d7c1fe69d46b2">HyPar::spatial_scheme_hyp</a> (read from <em>"solver.inp"</em> in <a class="el" href="a00082.html#a1eaea8a114ef1dad09df700d03e735e9">ReadInputs()</a>).</p>
<p><a class="el" href="a00062.html#ac6e21700e87392a666ef9425981388a2">HyPar::HyperbolicFunction</a> points to <a class="el" href="a00123.html#a0096c47175c007dbe805b34129835b84">HyperbolicFunction()</a>.</p>
<h2>Parabolic term </h2>
<p>The parabolic term can take two different forms as described below:-</p>
<p><b>No</b> <b>cross-derivatives</b>: In this form, the parabolic term is of the following form: </p><p class="formulaDsp">
\begin{equation} {\bf F}_{\rm par}\left({\bf u}\right) = \sum_{d=0}^{D-1} \frac {\partial^2 {\bf g}_d\left({\bf u}\right)} {\partial x_d^2} \end{equation}
</p>
<p> where \(d\) is the spatial dimension, and \(D\) is the total number of spatial dimensions. If the parabolic function is in this form, then the physical model must specify <a class="el" href="a00062.html#a3ac9d2c5e617ff6d5029c40e46c0fba3">HyPar::GFunction</a> which must point to the function that computes \({\bf g}_d\left({\bf u}\right)\). In this case, the spatial discretization is carried out in one of two ways:-</p>
<ul>
<li>Conservative discretization, implemented in <a class="el" href="a00128.html#abcdd5c036af1b80bd99884e9148fa711">ParabolicFunctionCons1Stage()</a> and invoked by setting <a class="el" href="a00062.html#ad45d57b33d578bf602574a221bf53d93">HyPar::spatial_type_par</a> to <a class="el" href="a00082.html#aabd653aa5d489ae2d0d8140290f6f026">_CONS_1STAGE_</a>: The parabolic term is discretized as <p class="formulaDsp">
\begin{equation} {\bf F}_{\rm par}\left({\bf u}\right) \approx \sum_{d=0}^{D-1} \frac {1}{\Delta x_d^2} \left[ \hat{\bf g}_{d,j+1/2} - \hat{\bf g}_{d,j-1/2} \right] \end{equation}
</p>
 where \(j\) denotes the grid index along \(d\). \(\hat{\bf g}_{d,j+1/2}\) is the numerical approximation to the second primitive of \({\bf g}_d\left({\bf u}\right)\) and is computed using <a class="el" href="a00062.html#a5b70211377c8260e3f192934a72847df">HyPar::InterpolateInterfacesPar</a>.</li>
<li>Non-conservative, 1-Stage discretization, implemented in <a class="el" href="a00128.html#aeac475b48b3fe25f426e14ff117db7ba">ParabolicFunctionNC1Stage()</a> and invoked by setting <a class="el" href="a00062.html#ad45d57b33d578bf602574a221bf53d93">HyPar::spatial_type_par</a> to <a class="el" href="a00082.html#a18ee8cd9b4297a259b08aa4cdfe30aa1">_NC_1STAGE_</a>: The parabolic term is discretized as <p class="formulaDsp">
\begin{equation} {\bf F}_{\rm par}\left({\bf u}\right) \approx \sum_{d=0}^{D-1} \frac {1}{\Delta x_d^2} \left[ \mathcal{L}_d\left({\bf g}_d\right) \right] \end{equation}
</p>
 where \(\mathcal{L}\) represents the finite-difference Laplacian operator, and is computed using <a class="el" href="a00062.html#ad620f41c8df5d995ba6304fa21079103">HyPar::SecondDerivativePar</a>.</li>
</ul>
<p><b>With</b> <b>cross-derivatives</b>: In this form, the parabolic term is of the following form: </p><p class="formulaDsp">
\begin{equation} {\bf F}_{\rm par}\left({\bf u}\right) = \sum_{d1=0}^{D-1}\sum_{d2=0}^{D-1} \frac {\partial^2 h_{d1,d2}\left({\bf u}\right)} {\partial x_{d1} \partial x_{d2}} \end{equation}
</p>
<p> where \(d1,d2\) are spatial dimensions, \(D\) is the total number of spatial dimensions. If the parabolic function is in this form, then the physical model must specify <a class="el" href="a00062.html#a6e41f429f671ba4548cb84861c021033">HyPar::HFunction</a> which must point to the function that computes \({\bf h}_{d1,d2}\left({\bf u}\right)\). In this case, the spatial discretization is carried out in one of two ways:-</p>
<ul>
<li>Non-conservative 2-stage discretization, implemented in <a class="el" href="a00128.html#a9f5c8ed9c587aa71c9f75209222ad67c">ParabolicFunctionNC2Stage()</a> and invoked by setting <a class="el" href="a00062.html#ad45d57b33d578bf602574a221bf53d93">HyPar::spatial_type_par</a> to <a class="el" href="a00082.html#a9f4de86b900c9aa5f097c2746e17612a">_NC_2STAGE_</a>: The parabolic term is discretized as <p class="formulaDsp">
\begin{equation} {\bf F}_{\rm par}\left({\bf u}\right) \approx \sum_{d1=0}^{D-1}\sum_{d2=0}^{D-1} \frac {1}{\Delta x_{d1} \Delta x_{d2}} \left[ \mathcal{D}_{d1}\left(\mathcal{D}_{d2}\left({\bf g}_d\right)\right) \right] \end{equation}
</p>
 where \(\mathcal{D}_d\) denotes the finite-difference first derivative operator along spatial dimension \(d\), and is computed using <a class="el" href="a00062.html#a70476d05a40159f61242a8dae0526cc3">HyPar::FirstDerivativePar</a>.</li>
<li>Non-conservative, "1.5-Stage" discretization, implemented in <a class="el" href="a00128.html#aedd832fdf4002f675da44a840e132456">ParabolicFunctionNC1_5Stage()</a> and invoked by setting <a class="el" href="a00062.html#ad45d57b33d578bf602574a221bf53d93">HyPar::spatial_type_par</a> to <a class="el" href="a00082.html#a7bc6f9c42df5610bc5d844ad95c74fb8">_NC_1_5STAGE_</a>: The parabolic term is discretized as <p class="formulaDsp">
\begin{equation} {\bf F}_{\rm par}\left({\bf u}\right) \approx \sum_{d1=0}^{D-1}\sum_{d2=0,d2 \ne d1}^{D-1} \frac {1}{\Delta x_{d1} \Delta x_{d2}} \left[ \mathcal{D}_{d1}\left(\mathcal{D}_{d2}\left({\bf g}_d\right)\right) \right] + \sum_{d=0}^{D-1} \frac {1}{\Delta x_d^2} \left[ \mathcal{L}_d\left({\bf g}_d\right) \right] \end{equation}
</p>
 where \(\mathcal{D}_d\) denotes the finite-difference first derivative operator along spatial dimension \(d\) (computed using <a class="el" href="a00062.html#a70476d05a40159f61242a8dae0526cc3">HyPar::FirstDerivativePar</a>). and \(\mathcal{L}\) represents the finite-difference Laplacian operator (computed using <a class="el" href="a00062.html#ad620f41c8df5d995ba6304fa21079103">HyPar::SecondDerivativePar</a>).</li>
</ul>
<p>The function pointers <a class="el" href="a00062.html#a5b70211377c8260e3f192934a72847df">HyPar::InterpolateInterfacesPar</a>, <a class="el" href="a00062.html#ad620f41c8df5d995ba6304fa21079103">HyPar::SecondDerivativePar</a>, and <a class="el" href="a00062.html#a70476d05a40159f61242a8dae0526cc3">HyPar::FirstDerivativePar</a> are set in <a class="el" href="a00082.html#a8166bb7cded409b3baa135d99fd6bc7c">InitializeSolvers()</a> based on the value of <a class="el" href="a00062.html#a170f2f6cc8ac86b78fcb376c2392e290">HyPar::spatial_scheme_par</a> (read from <em>"solver.inp"</em> in <a class="el" href="a00082.html#a1eaea8a114ef1dad09df700d03e735e9">ReadInputs()</a>).</p>
<p>Depending on which of the above forms are used, <a class="el" href="a00062.html#ad607a144bb3dbf119fd52c47757212dd">HyPar::ParabolicFunction</a> points to either of <a class="el" href="a00128.html#abcdd5c036af1b80bd99884e9148fa711">ParabolicFunctionCons1Stage()</a>, <a class="el" href="a00128.html#aeac475b48b3fe25f426e14ff117db7ba">ParabolicFunctionNC1Stage()</a>, <a class="el" href="a00128.html#a9f5c8ed9c587aa71c9f75209222ad67c">ParabolicFunctionNC2Stage()</a>, or <a class="el" href="a00128.html#aedd832fdf4002f675da44a840e132456">ParabolicFunctionNC1_5Stage()</a> (set in <a class="el" href="a00082.html#a8166bb7cded409b3baa135d99fd6bc7c">InitializeSolvers()</a>).</p>
<h2>Source term </h2>
<p><a class="el" href="a00062.html#ad8a664f0fe5ef5f928bb259fa5e3657e">HyPar::SourceFunction</a> points to <a class="el" href="a00128.html#a6f2b6bacb5d50cb9fce6e3e00d55cc6d">SourceFunction()</a>. There is no discretization involved in general, and this function just calls the physical model-specific source function to which <a class="el" href="a00062.html#ac195e64afcda3d4ec94d8fdf2b9dcdc8">HyPar::SFunction</a> points. </p>
</div></div><!-- contents -->
</div><!-- doc-content -->
<!-- Start of StatCounter Code for Default Guide -->
<script type="text/javascript">
var sc_project=10897352; 
var sc_invisible=1; 
var sc_security="83042f57"; 
var scJsHost = (("https:" == document.location.protocol) ?
"https://secure." : "http://www.");
document.write("<sc"+"ript type='text/javascript' src='" +
scJsHost+
"statcounter.com/counter/counter.js'></"+"script>");
</script>
<noscript><div class="statcounter"><a title="free hit
counters" href="http://statcounter.com/free-hit-counter/"
target="_blank"><img class="statcounter"
src="http://c.statcounter.com/10897352/0/83042f57/1/"
alt="free hit counters"></a></div></noscript>
<!-- End of StatCounter Code for Default Guide -->
