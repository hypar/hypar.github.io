<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.5"/>
<title>HyPar: src/CommonFunctions/ParallelReduction_GPU.cu File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script><script src="http://cdn.mathjax.org/mathjax/latest/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="doxygen_html_style.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">HyPar
   &#160;<span id="projectnumber">1.0</span>
   </div>
   <div id="projectbrief">Finite-Difference Hyperbolic-Parabolic PDE Solver on Cartesian Grids</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.5 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Structures</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>Globals</span></a></li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('a00301.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Data Structures</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Namespaces</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(9)"><span class="SelectionMark">&#160;</span>Macros</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(10)"><span class="SelectionMark">&#160;</span>Pages</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#nested-classes">Data Structures</a> &#124;
<a href="#define-members">Macros</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">ParallelReduction_GPU.cu File Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>Parallel reduction kernels.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &lt;cooperative_groups.h&gt;</code><br/>
<code>#include &lt;cooperative_groups/reduce.h&gt;</code><br/>
<code>#include &lt;stdio.h&gt;</code><br/>
</div>
<p><a href="a00301_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="nested-classes"></a>
Data Structures</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00217.html">SharedMemory&lt; T &gt;</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00218.html">SharedMemory&lt; double &gt;</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:a898ad91e649b74051af50552bf8f056c"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00301.html#a898ad91e649b74051af50552bf8f056c">_PARALLEL_REDUCTION_H_</a></td></tr>
<tr class="separator:a898ad91e649b74051af50552bf8f056c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3de890e3fb681b02368e411be8c1b2cd"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00301.html#a3de890e3fb681b02368e411be8c1b2cd">_CG_ABI_EXPERIMENTAL</a></td></tr>
<tr class="separator:a3de890e3fb681b02368e411be8c1b2cd"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a57ac942d4d9fed566d65dae44e5c1c3c"><td class="memTemplParams" colspan="2">template&lt;class T &gt; </td></tr>
<tr class="memitem:a57ac942d4d9fed566d65dae44e5c1c3c"><td class="memTemplItemLeft" align="right" valign="top">__device__ __forceinline__ T&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="a00301.html#a57ac942d4d9fed566d65dae44e5c1c3c">warpReduceSum</a> (unsigned int mask, T mySum)</td></tr>
<tr class="separator:a57ac942d4d9fed566d65dae44e5c1c3c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4f5b03ad79c6aa970c535ca117fc29ea"><td class="memTemplParams" colspan="2">template&lt;class T &gt; </td></tr>
<tr class="memitem:a4f5b03ad79c6aa970c535ca117fc29ea"><td class="memTemplItemLeft" align="right" valign="top">__global__ void&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="a00301.html#a4f5b03ad79c6aa970c535ca117fc29ea">reduce0</a> (T *g_idata, T *g_odata, unsigned int n)</td></tr>
<tr class="separator:a4f5b03ad79c6aa970c535ca117fc29ea"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a75e85073f675244ea4e460798156ad0c"><td class="memTemplParams" colspan="2">template&lt;class T &gt; </td></tr>
<tr class="memitem:a75e85073f675244ea4e460798156ad0c"><td class="memTemplItemLeft" align="right" valign="top">__global__ void&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="a00301.html#a75e85073f675244ea4e460798156ad0c">reduce1</a> (T *g_idata, T *g_odata, unsigned int n)</td></tr>
<tr class="separator:a75e85073f675244ea4e460798156ad0c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ace3f504395059f2ac2b28220d5e047a2"><td class="memTemplParams" colspan="2">template&lt;class T &gt; </td></tr>
<tr class="memitem:ace3f504395059f2ac2b28220d5e047a2"><td class="memTemplItemLeft" align="right" valign="top">__global__ void&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="a00301.html#ace3f504395059f2ac2b28220d5e047a2">reduce2</a> (T *g_idata, T *g_odata, unsigned int n)</td></tr>
<tr class="separator:ace3f504395059f2ac2b28220d5e047a2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a36a9a634eee38526237d92ad4b78d095"><td class="memTemplParams" colspan="2">template&lt;class T &gt; </td></tr>
<tr class="memitem:a36a9a634eee38526237d92ad4b78d095"><td class="memTemplItemLeft" align="right" valign="top">__global__ void&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="a00301.html#a36a9a634eee38526237d92ad4b78d095">reduce3</a> (T *g_idata, T *g_odata, unsigned int n)</td></tr>
<tr class="separator:a36a9a634eee38526237d92ad4b78d095"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac6bf5a3ebc6f09947110c9d8f4c1b06f"><td class="memTemplParams" colspan="2">template&lt;class T , unsigned int blockSize&gt; </td></tr>
<tr class="memitem:ac6bf5a3ebc6f09947110c9d8f4c1b06f"><td class="memTemplItemLeft" align="right" valign="top">__global__ void&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="a00301.html#ac6bf5a3ebc6f09947110c9d8f4c1b06f">reduce4</a> (T *g_idata, T *g_odata, unsigned int n)</td></tr>
<tr class="separator:ac6bf5a3ebc6f09947110c9d8f4c1b06f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a24268525ea84b5520bc860803b81286b"><td class="memTemplParams" colspan="2">template&lt;class T , unsigned int blockSize&gt; </td></tr>
<tr class="memitem:a24268525ea84b5520bc860803b81286b"><td class="memTemplItemLeft" align="right" valign="top">__global__ void&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="a00301.html#a24268525ea84b5520bc860803b81286b">reduce5</a> (T *g_idata, T *g_odata, unsigned int n)</td></tr>
<tr class="separator:a24268525ea84b5520bc860803b81286b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abf65411d2d811b8f805791bcf27d5976"><td class="memTemplParams" colspan="2">template&lt;class T , unsigned int blockSize, bool nIsPow2&gt; </td></tr>
<tr class="memitem:abf65411d2d811b8f805791bcf27d5976"><td class="memTemplItemLeft" align="right" valign="top">__global__ void&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="a00301.html#abf65411d2d811b8f805791bcf27d5976">reduce6</a> (T *g_idata, T *g_odata, unsigned int n)</td></tr>
<tr class="separator:abf65411d2d811b8f805791bcf27d5976"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae5640768448db34abc0ddadd82bbc99c"><td class="memTemplParams" colspan="2">template&lt;typename T , unsigned int blockSize, bool nIsPow2&gt; </td></tr>
<tr class="memitem:ae5640768448db34abc0ddadd82bbc99c"><td class="memTemplItemLeft" align="right" valign="top">__global__ void&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="a00301.html#ae5640768448db34abc0ddadd82bbc99c">reduce7</a> (const T *__restrict__ g_idata, T *__restrict__ g_odata, unsigned int n)</td></tr>
<tr class="separator:ae5640768448db34abc0ddadd82bbc99c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7694c20f9f61838b868c2b02d593b17c"><td class="memTemplParams" colspan="2">template&lt;typename T , typename Group &gt; </td></tr>
<tr class="memitem:a7694c20f9f61838b868c2b02d593b17c"><td class="memTemplItemLeft" align="right" valign="top">__device__ T&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="a00301.html#a7694c20f9f61838b868c2b02d593b17c">cg_reduce_n</a> (T in, Group &amp;threads)</td></tr>
<tr class="separator:a7694c20f9f61838b868c2b02d593b17c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5ea49102ff2a1f30f837617687caa128"><td class="memTemplParams" colspan="2">template&lt;class T &gt; </td></tr>
<tr class="memitem:a5ea49102ff2a1f30f837617687caa128"><td class="memTemplItemLeft" align="right" valign="top">__global__ void&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="a00301.html#a5ea49102ff2a1f30f837617687caa128">cg_reduce</a> (T *g_idata, T *g_odata, unsigned int n)</td></tr>
<tr class="separator:a5ea49102ff2a1f30f837617687caa128"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af164dd43ee254a12353703e3ca51df11"><td class="memTemplParams" colspan="2">template&lt;class T , size_t BlockSize, size_t MultiWarpGroupSize&gt; </td></tr>
<tr class="memitem:af164dd43ee254a12353703e3ca51df11"><td class="memTemplItemLeft" align="right" valign="top">__global__ void&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="a00301.html#af164dd43ee254a12353703e3ca51df11">multi_warp_cg_reduce</a> (T *g_idata, T *g_odata, unsigned int n)</td></tr>
<tr class="separator:af164dd43ee254a12353703e3ca51df11"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4402d8b02944d53e362f9a25ea59c7b1"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00301.html#a4402d8b02944d53e362f9a25ea59c7b1">isPow2</a> (unsigned int x)</td></tr>
<tr class="separator:a4402d8b02944d53e362f9a25ea59c7b1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1024a0c3df7789c601e3a0d3da5c1832"><td class="memTemplParams" colspan="2">template&lt;class T &gt; </td></tr>
<tr class="memitem:a1024a0c3df7789c601e3a0d3da5c1832"><td class="memTemplItemLeft" align="right" valign="top">void&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="a00301.html#a1024a0c3df7789c601e3a0d3da5c1832">reduce</a> (int size, int threads, int blocks, int whichKernel, T *d_idata, T *d_odata)</td></tr>
<tr class="separator:a1024a0c3df7789c601e3a0d3da5c1832"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae39af8c237ab8ba9d1cac0a3e8731b4a"><td class="memItemLeft" align="right" valign="top">template void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00301.html#ae39af8c237ab8ba9d1cac0a3e8731b4a">reduce&lt; int &gt;</a> (int size, int threads, int blocks, int whichKernel, int *d_idata, int *d_odata)</td></tr>
<tr class="separator:ae39af8c237ab8ba9d1cac0a3e8731b4a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afe06f9ca01de557df7c3b982be05d618"><td class="memItemLeft" align="right" valign="top">template void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00301.html#afe06f9ca01de557df7c3b982be05d618">reduce&lt; float &gt;</a> (int size, int threads, int blocks, int whichKernel, float *d_idata, float *d_odata)</td></tr>
<tr class="separator:afe06f9ca01de557df7c3b982be05d618"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab35beed285c9a6b0579af1945ee307d9"><td class="memItemLeft" align="right" valign="top">template void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00301.html#ab35beed285c9a6b0579af1945ee307d9">reduce&lt; double &gt;</a> (int size, int threads, int blocks, int whichKernel, double *d_idata, double *d_odata)</td></tr>
<tr class="separator:ab35beed285c9a6b0579af1945ee307d9"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Parallel reduction kernels. </p>
<p>Copyright (c) 2021, NVIDIA CORPORATION. All rights reserved.</p>
<p>Redistribution and use in source and binary forms, with or without modification, are permitted provided that the following conditions are met:</p>
<ul>
<li>Redistributions of source code must retain the above copyright notice, this list of conditions and the following disclaimer.</li>
<li>Redistributions in binary form must reproduce the above copyright notice, this list of conditions and the following disclaimer in the documentation and/or other materials provided with the distribution.</li>
<li>Neither the name of NVIDIA CORPORATION nor the names of its contributors may be used to endorse or promote products derived from this software without specific prior written permission.</li>
</ul>
<p>THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS ``AS IS'' AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT OWNER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE. </p>

<p>Definition in file <a class="el" href="a00301_source.html">ParallelReduction_GPU.cu</a>.</p>
</div><h2 class="groupheader">Macro Definition Documentation</h2>
<a class="anchor" id="a898ad91e649b74051af50552bf8f056c"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define _PARALLEL_REDUCTION_H_</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="a00301_source.html#l00032">32</a> of file <a class="el" href="a00301_source.html">ParallelReduction_GPU.cu</a>.</p>

</div>
</div>
<a class="anchor" id="a3de890e3fb681b02368e411be8c1b2cd"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define _CG_ABI_EXPERIMENTAL</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="a00301_source.html#l00034">34</a> of file <a class="el" href="a00301_source.html">ParallelReduction_GPU.cu</a>.</p>

</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a class="anchor" id="a57ac942d4d9fed566d65dae44e5c1c3c"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">__device__ __forceinline__ T warpReduceSum </td>
          <td>(</td>
          <td class="paramtype">unsigned int&#160;</td>
          <td class="paramname"><em>mask</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">T&#160;</td>
          <td class="paramname"><em>mySum</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="a00301_source.html#l00072">72</a> of file <a class="el" href="a00301_source.html">ParallelReduction_GPU.cu</a>.</p>
<div class="fragment"><div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;                                                                       {</div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> offset = warpSize / 2; offset &gt; 0; offset /= 2) {</div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;    mySum += __shfl_down_sync(mask, mySum, offset);</div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;  }</div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;  <span class="keywordflow">return</span> mySum;</div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a4f5b03ad79c6aa970c535ca117fc29ea"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">__global__ void reduce0 </td>
          <td>(</td>
          <td class="paramtype">T *&#160;</td>
          <td class="paramname"><em>g_idata</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">T *&#160;</td>
          <td class="paramname"><em>g_odata</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned int&#160;</td>
          <td class="paramname"><em>n</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>This reduction interleaves which threads are active by using the modulo operator. This operator is very expensive on GPUs, and the interleaved inactivity means that no whole warps are active, which is also very inefficient </p>

<p>Definition at line <a class="el" href="a00301_source.html#l00102">102</a> of file <a class="el" href="a00301_source.html">ParallelReduction_GPU.cu</a>.</p>
<div class="fragment"><div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;                                                                {</div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;  <span class="comment">// Handle to thread block group</span></div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;  cg::thread_block cta = cg::this_thread_block();</div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;  T *sdata = <a class="code" href="a00217.html">SharedMemory&lt;T&gt;</a>();</div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;</div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;  <span class="comment">// load shared mem</span></div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;  <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> tid = threadIdx.x;</div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;  <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i = blockIdx.x * blockDim.x + threadIdx.x;</div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;</div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;  sdata[tid] = (i &lt; n) ? g_idata[i] : 0;</div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;</div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;  cg::sync(cta);</div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;</div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;  <span class="comment">// do reduction in shared mem</span></div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> s = 1; s &lt; blockDim.x; s *= 2) {</div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;    <span class="comment">// modulo arithmetic is slow!</span></div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;    <span class="keywordflow">if</span> ((tid % (2 * s)) == 0) {</div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;      sdata[tid] += sdata[tid + s];</div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;    }</div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;</div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;    cg::sync(cta);</div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;  }</div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;</div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;  <span class="comment">// write result for this block to global mem</span></div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;  <span class="keywordflow">if</span> (tid == 0) g_odata[blockIdx.x] = sdata[0];</div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;}</div>
<div class="ttc" id="a00217_html"><div class="ttname"><a href="a00217.html">SharedMemory</a></div><div class="ttdef"><b>Definition:</b> <a href="a00301_source.html#l00044">ParallelReduction_GPU.cu:44</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a75e85073f675244ea4e460798156ad0c"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">__global__ void reduce1 </td>
          <td>(</td>
          <td class="paramtype">T *&#160;</td>
          <td class="paramname"><em>g_idata</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">T *&#160;</td>
          <td class="paramname"><em>g_odata</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned int&#160;</td>
          <td class="paramname"><em>n</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>This version uses contiguous threads, but its interleaved addressing results in many shared memory bank conflicts. </p>

<p>Definition at line <a class="el" href="a00301_source.html#l00133">133</a> of file <a class="el" href="a00301_source.html">ParallelReduction_GPU.cu</a>.</p>
<div class="fragment"><div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;                                                                {</div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;  <span class="comment">// Handle to thread block group</span></div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;  cg::thread_block cta = cg::this_thread_block();</div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;  T *sdata = <a class="code" href="a00217.html">SharedMemory&lt;T&gt;</a>();</div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;</div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;  <span class="comment">// load shared mem</span></div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;  <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> tid = threadIdx.x;</div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;  <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i = blockIdx.x * blockDim.x + threadIdx.x;</div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;</div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;  sdata[tid] = (i &lt; n) ? g_idata[i] : 0;</div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;</div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;  cg::sync(cta);</div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;</div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;  <span class="comment">// do reduction in shared mem</span></div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> s = 1; s &lt; blockDim.x; s *= 2) {</div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;    <span class="keywordtype">int</span> index = 2 * s * tid;</div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;</div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;    <span class="keywordflow">if</span> (index &lt; blockDim.x) {</div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;      sdata[index] += sdata[index + s];</div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;    }</div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;</div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;    cg::sync(cta);</div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;  }</div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;</div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;  <span class="comment">// write result for this block to global mem</span></div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;  <span class="keywordflow">if</span> (tid == 0) g_odata[blockIdx.x] = sdata[0];</div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;}</div>
<div class="ttc" id="a00217_html"><div class="ttname"><a href="a00217.html">SharedMemory</a></div><div class="ttdef"><b>Definition:</b> <a href="a00301_source.html#l00044">ParallelReduction_GPU.cu:44</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ace3f504395059f2ac2b28220d5e047a2"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">__global__ void reduce2 </td>
          <td>(</td>
          <td class="paramtype">T *&#160;</td>
          <td class="paramname"><em>g_idata</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">T *&#160;</td>
          <td class="paramname"><em>g_odata</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned int&#160;</td>
          <td class="paramname"><em>n</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="a00301_source.html#l00165">165</a> of file <a class="el" href="a00301_source.html">ParallelReduction_GPU.cu</a>.</p>
<div class="fragment"><div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;                                                                {</div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;  <span class="comment">// Handle to thread block group</span></div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;  cg::thread_block cta = cg::this_thread_block();</div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;  T *sdata = <a class="code" href="a00217.html">SharedMemory&lt;T&gt;</a>();</div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;</div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;  <span class="comment">// load shared mem</span></div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;  <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> tid = threadIdx.x;</div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;  <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i = blockIdx.x * blockDim.x + threadIdx.x;</div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;</div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;  sdata[tid] = (i &lt; n) ? g_idata[i] : 0;</div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;</div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;  cg::sync(cta);</div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;</div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;  <span class="comment">// do reduction in shared mem</span></div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> s = blockDim.x / 2; s &gt; 0; s &gt;&gt;= 1) {</div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;    <span class="keywordflow">if</span> (tid &lt; s) {</div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;      sdata[tid] += sdata[tid + s];</div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;    }</div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;</div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;    cg::sync(cta);</div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;  }</div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;</div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;  <span class="comment">// write result for this block to global mem</span></div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;  <span class="keywordflow">if</span> (tid == 0) g_odata[blockIdx.x] = sdata[0];</div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;}</div>
<div class="ttc" id="a00217_html"><div class="ttname"><a href="a00217.html">SharedMemory</a></div><div class="ttdef"><b>Definition:</b> <a href="a00301_source.html#l00044">ParallelReduction_GPU.cu:44</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a36a9a634eee38526237d92ad4b78d095"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">__global__ void reduce3 </td>
          <td>(</td>
          <td class="paramtype">T *&#160;</td>
          <td class="paramname"><em>g_idata</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">T *&#160;</td>
          <td class="paramname"><em>g_odata</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned int&#160;</td>
          <td class="paramname"><em>n</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="a00301_source.html#l00196">196</a> of file <a class="el" href="a00301_source.html">ParallelReduction_GPU.cu</a>.</p>
<div class="fragment"><div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;                                                                {</div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;  <span class="comment">// Handle to thread block group</span></div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;  cg::thread_block cta = cg::this_thread_block();</div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;  T *sdata = <a class="code" href="a00217.html">SharedMemory&lt;T&gt;</a>();</div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;</div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;  <span class="comment">// perform first level of reduction,</span></div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;  <span class="comment">// reading from global memory, writing to shared memory</span></div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;  <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> tid = threadIdx.x;</div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;  <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i = blockIdx.x * (blockDim.x * 2) + threadIdx.x;</div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;</div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;  T mySum = (i &lt; n) ? g_idata[i] : 0;</div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;</div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;  <span class="keywordflow">if</span> (i + blockDim.x &lt; n) mySum += g_idata[i + blockDim.x];</div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;</div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;  sdata[tid] = mySum;</div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;  cg::sync(cta);</div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;</div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;  <span class="comment">// do reduction in shared mem</span></div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> s = blockDim.x / 2; s &gt; 0; s &gt;&gt;= 1) {</div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;    <span class="keywordflow">if</span> (tid &lt; s) {</div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;      sdata[tid] = mySum = mySum + sdata[tid + s];</div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;    }</div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;</div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;    cg::sync(cta);</div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;  }</div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;</div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;  <span class="comment">// write result for this block to global mem</span></div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;  <span class="keywordflow">if</span> (tid == 0) g_odata[blockIdx.x] = mySum;</div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;}</div>
<div class="ttc" id="a00217_html"><div class="ttname"><a href="a00217.html">SharedMemory</a></div><div class="ttdef"><b>Definition:</b> <a href="a00301_source.html#l00044">ParallelReduction_GPU.cu:44</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ac6bf5a3ebc6f09947110c9d8f4c1b06f"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">__global__ void reduce4 </td>
          <td>(</td>
          <td class="paramtype">T *&#160;</td>
          <td class="paramname"><em>g_idata</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">T *&#160;</td>
          <td class="paramname"><em>g_odata</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned int&#160;</td>
          <td class="paramname"><em>n</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="a00301_source.html#l00239">239</a> of file <a class="el" href="a00301_source.html">ParallelReduction_GPU.cu</a>.</p>
<div class="fragment"><div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;                                                                {</div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;  <span class="comment">// Handle to thread block group</span></div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;  cg::thread_block cta = cg::this_thread_block();</div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;  T *sdata = <a class="code" href="a00217.html">SharedMemory&lt;T&gt;</a>();</div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;</div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;  <span class="comment">// perform first level of reduction,</span></div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;  <span class="comment">// reading from global memory, writing to shared memory</span></div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;  <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> tid = threadIdx.x;</div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;  <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i = blockIdx.x * (blockDim.x * 2) + threadIdx.x;</div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;</div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;  T mySum = (i &lt; n) ? g_idata[i] : 0;</div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;</div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;  <span class="keywordflow">if</span> (i + blockSize &lt; n) mySum += g_idata[i + blockSize];</div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;</div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;  sdata[tid] = mySum;</div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;  cg::sync(cta);</div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;</div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;  <span class="comment">// do reduction in shared mem</span></div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> s = blockDim.x / 2; s &gt; 32; s &gt;&gt;= 1) {</div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;    <span class="keywordflow">if</span> (tid &lt; s) {</div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;      sdata[tid] = mySum = mySum + sdata[tid + s];</div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;    }</div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;</div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;    cg::sync(cta);</div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;  }</div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;</div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;  cg::thread_block_tile&lt;32&gt; tile32 = cg::tiled_partition&lt;32&gt;(cta);</div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;</div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;  <span class="keywordflow">if</span> (cta.thread_rank() &lt; 32) {</div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;    <span class="comment">// Fetch final intermediate sum from 2nd warp</span></div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;    <span class="keywordflow">if</span> (blockSize &gt;= 64) mySum += sdata[tid + 32];</div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;    <span class="comment">// Reduce final warp using shuffle</span></div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> offset = tile32.size() / 2; offset &gt; 0; offset /= 2) {</div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;      mySum += tile32.shfl_down(mySum, offset);</div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;    }</div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;  }</div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;</div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;  <span class="comment">// write result for this block to global mem</span></div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;  <span class="keywordflow">if</span> (cta.thread_rank() == 0) g_odata[blockIdx.x] = mySum;</div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;}</div>
<div class="ttc" id="a00217_html"><div class="ttname"><a href="a00217.html">SharedMemory</a></div><div class="ttdef"><b>Definition:</b> <a href="a00301_source.html#l00044">ParallelReduction_GPU.cu:44</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a24268525ea84b5520bc860803b81286b"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">__global__ void reduce5 </td>
          <td>(</td>
          <td class="paramtype">T *&#160;</td>
          <td class="paramname"><em>g_idata</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">T *&#160;</td>
          <td class="paramname"><em>g_odata</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned int&#160;</td>
          <td class="paramname"><em>n</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="a00301_source.html#l00292">292</a> of file <a class="el" href="a00301_source.html">ParallelReduction_GPU.cu</a>.</p>
<div class="fragment"><div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;                                                                {</div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;  <span class="comment">// Handle to thread block group</span></div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;  cg::thread_block cta = cg::this_thread_block();</div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;  T *sdata = <a class="code" href="a00217.html">SharedMemory&lt;T&gt;</a>();</div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;</div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;  <span class="comment">// perform first level of reduction,</span></div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;  <span class="comment">// reading from global memory, writing to shared memory</span></div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;  <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> tid = threadIdx.x;</div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;  <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i = blockIdx.x * (blockSize * 2) + threadIdx.x;</div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;</div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;  T mySum = (i &lt; n) ? g_idata[i] : 0;</div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;</div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;  <span class="keywordflow">if</span> (i + blockSize &lt; n) mySum += g_idata[i + blockSize];</div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;</div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;  sdata[tid] = mySum;</div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;  cg::sync(cta);</div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;</div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;  <span class="comment">// do reduction in shared mem</span></div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;  <span class="keywordflow">if</span> ((blockSize &gt;= 512) &amp;&amp; (tid &lt; 256)) {</div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;    sdata[tid] = mySum = mySum + sdata[tid + 256];</div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;  }</div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;</div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;  cg::sync(cta);</div>
<div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;</div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;  <span class="keywordflow">if</span> ((blockSize &gt;= 256) &amp;&amp; (tid &lt; 128)) {</div>
<div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;    sdata[tid] = mySum = mySum + sdata[tid + 128];</div>
<div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;  }</div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;</div>
<div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;  cg::sync(cta);</div>
<div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;</div>
<div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;  <span class="keywordflow">if</span> ((blockSize &gt;= 128) &amp;&amp; (tid &lt; 64)) {</div>
<div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;    sdata[tid] = mySum = mySum + sdata[tid + 64];</div>
<div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;  }</div>
<div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;</div>
<div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;  cg::sync(cta);</div>
<div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;</div>
<div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;  cg::thread_block_tile&lt;32&gt; tile32 = cg::tiled_partition&lt;32&gt;(cta);</div>
<div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;</div>
<div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;  <span class="keywordflow">if</span> (cta.thread_rank() &lt; 32) {</div>
<div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;    <span class="comment">// Fetch final intermediate sum from 2nd warp</span></div>
<div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;    <span class="keywordflow">if</span> (blockSize &gt;= 64) mySum += sdata[tid + 32];</div>
<div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;    <span class="comment">// Reduce final warp using shuffle</span></div>
<div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> offset = tile32.size() / 2; offset &gt; 0; offset /= 2) {</div>
<div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;      mySum += tile32.shfl_down(mySum, offset);</div>
<div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;    }</div>
<div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;  }</div>
<div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;</div>
<div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;  <span class="comment">// write result for this block to global mem</span></div>
<div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;  <span class="keywordflow">if</span> (cta.thread_rank() == 0) g_odata[blockIdx.x] = mySum;</div>
<div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;}</div>
<div class="ttc" id="a00217_html"><div class="ttname"><a href="a00217.html">SharedMemory</a></div><div class="ttdef"><b>Definition:</b> <a href="a00301_source.html#l00044">ParallelReduction_GPU.cu:44</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="abf65411d2d811b8f805791bcf27d5976"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">__global__ void reduce6 </td>
          <td>(</td>
          <td class="paramtype">T *&#160;</td>
          <td class="paramname"><em>g_idata</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">T *&#160;</td>
          <td class="paramname"><em>g_odata</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned int&#160;</td>
          <td class="paramname"><em>n</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="a00301_source.html#l00352">352</a> of file <a class="el" href="a00301_source.html">ParallelReduction_GPU.cu</a>.</p>
<div class="fragment"><div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;                                                                {</div>
<div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;  <span class="comment">// Handle to thread block group</span></div>
<div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;  cg::thread_block cta = cg::this_thread_block();</div>
<div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;  T *sdata = <a class="code" href="a00217.html">SharedMemory&lt;T&gt;</a>();</div>
<div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;</div>
<div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;  <span class="comment">// perform first level of reduction,</span></div>
<div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;  <span class="comment">// reading from global memory, writing to shared memory</span></div>
<div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;  <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> tid = threadIdx.x;</div>
<div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;  <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> gridSize = blockSize * gridDim.x;</div>
<div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;</div>
<div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;  T mySum = 0;</div>
<div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;</div>
<div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;  <span class="comment">// we reduce multiple elements per thread.  The number is determined by the</span></div>
<div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;  <span class="comment">// number of active thread blocks (via gridDim).  More blocks will result</span></div>
<div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;  <span class="comment">// in a larger gridSize and therefore fewer elements per thread</span></div>
<div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;  <span class="keywordflow">if</span> (nIsPow2) {</div>
<div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i = blockIdx.x * blockSize * 2 + threadIdx.x;</div>
<div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;    gridSize = gridSize &lt;&lt; 1;</div>
<div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;</div>
<div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;    <span class="keywordflow">while</span> (i &lt; n) {</div>
<div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;      mySum += g_idata[i];</div>
<div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;      <span class="comment">// ensure we don&#39;t read out of bounds -- this is optimized away for</span></div>
<div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;      <span class="comment">// powerOf2 sized arrays</span></div>
<div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;      <span class="keywordflow">if</span> ((i + blockSize) &lt; n) {</div>
<div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;        mySum += g_idata[i + blockSize];</div>
<div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;      }</div>
<div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;      i += gridSize;</div>
<div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;    }</div>
<div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;  } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i = blockIdx.x * blockSize + threadIdx.x;</div>
<div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;    <span class="keywordflow">while</span> (i &lt; n) {</div>
<div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;      mySum += g_idata[i];</div>
<div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;      i += gridSize;</div>
<div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;    }</div>
<div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;  }</div>
<div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;</div>
<div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;  <span class="comment">// each thread puts its local sum into shared memory</span></div>
<div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;  sdata[tid] = mySum;</div>
<div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;  cg::sync(cta);</div>
<div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;</div>
<div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;  <span class="comment">// do reduction in shared mem</span></div>
<div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;  <span class="keywordflow">if</span> ((blockSize &gt;= 512) &amp;&amp; (tid &lt; 256)) {</div>
<div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;    sdata[tid] = mySum = mySum + sdata[tid + 256];</div>
<div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;  }</div>
<div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;</div>
<div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;  cg::sync(cta);</div>
<div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;</div>
<div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;  <span class="keywordflow">if</span> ((blockSize &gt;= 256) &amp;&amp; (tid &lt; 128)) {</div>
<div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;    sdata[tid] = mySum = mySum + sdata[tid + 128];</div>
<div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;  }</div>
<div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;</div>
<div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;  cg::sync(cta);</div>
<div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;</div>
<div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;  <span class="keywordflow">if</span> ((blockSize &gt;= 128) &amp;&amp; (tid &lt; 64)) {</div>
<div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;    sdata[tid] = mySum = mySum + sdata[tid + 64];</div>
<div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;  }</div>
<div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;</div>
<div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;  cg::sync(cta);</div>
<div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;</div>
<div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;  cg::thread_block_tile&lt;32&gt; tile32 = cg::tiled_partition&lt;32&gt;(cta);</div>
<div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;</div>
<div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;  <span class="keywordflow">if</span> (cta.thread_rank() &lt; 32) {</div>
<div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;    <span class="comment">// Fetch final intermediate sum from 2nd warp</span></div>
<div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;    <span class="keywordflow">if</span> (blockSize &gt;= 64) mySum += sdata[tid + 32];</div>
<div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;    <span class="comment">// Reduce final warp using shuffle</span></div>
<div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> offset = tile32.size() / 2; offset &gt; 0; offset /= 2) {</div>
<div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;      mySum += tile32.shfl_down(mySum, offset);</div>
<div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;    }</div>
<div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;  }</div>
<div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;</div>
<div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;  <span class="comment">// write result for this block to global mem</span></div>
<div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;  <span class="keywordflow">if</span> (cta.thread_rank() == 0) g_odata[blockIdx.x] = mySum;</div>
<div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;}</div>
<div class="ttc" id="a00217_html"><div class="ttname"><a href="a00217.html">SharedMemory</a></div><div class="ttdef"><b>Definition:</b> <a href="a00301_source.html#l00044">ParallelReduction_GPU.cu:44</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ae5640768448db34abc0ddadd82bbc99c"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">__global__ void reduce7 </td>
          <td>(</td>
          <td class="paramtype">const T *__restrict__&#160;</td>
          <td class="paramname"><em>g_idata</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">T *__restrict__&#160;</td>
          <td class="paramname"><em>g_odata</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned int&#160;</td>
          <td class="paramname"><em>n</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="a00301_source.html#l00427">427</a> of file <a class="el" href="a00301_source.html">ParallelReduction_GPU.cu</a>.</p>
<div class="fragment"><div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;                                        {</div>
<div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;  T *sdata = <a class="code" href="a00217.html">SharedMemory&lt;T&gt;</a>();</div>
<div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;</div>
<div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;  <span class="comment">// perform first level of reduction,</span></div>
<div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;  <span class="comment">// reading from global memory, writing to shared memory</span></div>
<div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;  <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> tid = threadIdx.x;</div>
<div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;  <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> gridSize = blockSize * gridDim.x;</div>
<div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;  <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> maskLength = (blockSize &amp; 31);  <span class="comment">// 31 = warpSize-1</span></div>
<div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;  maskLength = (maskLength &gt; 0) ? (32 - maskLength) : maskLength;</div>
<div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> mask = (0xffffffff) &gt;&gt; maskLength;</div>
<div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;</div>
<div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;  T mySum = 0;</div>
<div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;</div>
<div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;  <span class="comment">// we reduce multiple elements per thread.  The number is determined by the</span></div>
<div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;  <span class="comment">// number of active thread blocks (via gridDim).  More blocks will result</span></div>
<div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;  <span class="comment">// in a larger gridSize and therefore fewer elements per thread</span></div>
<div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;  <span class="keywordflow">if</span> (nIsPow2) {</div>
<div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i = blockIdx.x * blockSize * 2 + threadIdx.x;</div>
<div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;    gridSize = gridSize &lt;&lt; 1;</div>
<div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;</div>
<div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;    <span class="keywordflow">while</span> (i &lt; n) {</div>
<div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;      mySum += g_idata[i];</div>
<div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;      <span class="comment">// ensure we don&#39;t read out of bounds -- this is optimized away for</span></div>
<div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;      <span class="comment">// powerOf2 sized arrays</span></div>
<div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;      <span class="keywordflow">if</span> ((i + blockSize) &lt; n) {</div>
<div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;        mySum += g_idata[i + blockSize];</div>
<div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;      }</div>
<div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;      i += gridSize;</div>
<div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;    }</div>
<div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;  } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i = blockIdx.x * blockSize + threadIdx.x;</div>
<div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;    <span class="keywordflow">while</span> (i &lt; n) {</div>
<div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;      mySum += g_idata[i];</div>
<div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;      i += gridSize;</div>
<div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;    }</div>
<div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;  }</div>
<div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;</div>
<div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;  <span class="comment">// Reduce within warp using shuffle or reduce_add if T==int &amp; CUDA_ARCH ==</span></div>
<div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;  <span class="comment">// SM 8.0</span></div>
<div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;  mySum = warpReduceSum&lt;T&gt;(mask, mySum);</div>
<div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;</div>
<div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;  <span class="comment">// each thread puts its local sum into shared memory</span></div>
<div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;  <span class="keywordflow">if</span> ((tid % warpSize) == 0) {</div>
<div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;    sdata[tid / warpSize] = mySum;</div>
<div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;  }</div>
<div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;</div>
<div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;  __syncthreads();</div>
<div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;</div>
<div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> shmem_extent =</div>
<div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;      (blockSize / warpSize) &gt; 0 ? (blockSize / warpSize) : 1;</div>
<div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> ballot_result = __ballot_sync(mask, tid &lt; shmem_extent);</div>
<div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;  <span class="keywordflow">if</span> (tid &lt; shmem_extent) {</div>
<div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;    mySum = sdata[tid];</div>
<div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;    <span class="comment">// Reduce final warp using shuffle or reduce_add if T==int &amp; CUDA_ARCH ==</span></div>
<div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;    <span class="comment">// SM 8.0</span></div>
<div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;    mySum = warpReduceSum&lt;T&gt;(ballot_result, mySum);</div>
<div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;  }</div>
<div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;</div>
<div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;  <span class="comment">// write result for this block to global mem</span></div>
<div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;  <span class="keywordflow">if</span> (tid == 0) {</div>
<div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;    g_odata[blockIdx.x] = mySum;</div>
<div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;  }</div>
<div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;}</div>
<div class="ttc" id="a00217_html"><div class="ttname"><a href="a00217.html">SharedMemory</a></div><div class="ttdef"><b>Definition:</b> <a href="a00301_source.html#l00044">ParallelReduction_GPU.cu:44</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a7694c20f9f61838b868c2b02d593b17c"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">__device__ T cg_reduce_n </td>
          <td>(</td>
          <td class="paramtype">T&#160;</td>
          <td class="paramname"><em>in</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Group &amp;&#160;</td>
          <td class="paramname"><em>threads</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="a00301_source.html#l00494">494</a> of file <a class="el" href="a00301_source.html">ParallelReduction_GPU.cu</a>.</p>
<div class="fragment"><div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;                                               {</div>
<div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="a00301.html#a1024a0c3df7789c601e3a0d3da5c1832">cg::reduce</a>(threads, in, cg::plus&lt;T&gt;());</div>
<div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;}</div>
<div class="ttc" id="a00301_html_a1024a0c3df7789c601e3a0d3da5c1832"><div class="ttname"><a href="a00301.html#a1024a0c3df7789c601e3a0d3da5c1832">reduce</a></div><div class="ttdeci">void reduce(int size, int threads, int blocks, int whichKernel, T *d_idata, T *d_odata)</div><div class="ttdef"><b>Definition:</b> <a href="a00301_source.html#l00610">ParallelReduction_GPU.cu:610</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a5ea49102ff2a1f30f837617687caa128"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">__global__ void cg_reduce </td>
          <td>(</td>
          <td class="paramtype">T *&#160;</td>
          <td class="paramname"><em>g_idata</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">T *&#160;</td>
          <td class="paramname"><em>g_odata</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned int&#160;</td>
          <td class="paramname"><em>n</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="a00301_source.html#l00499">499</a> of file <a class="el" href="a00301_source.html">ParallelReduction_GPU.cu</a>.</p>
<div class="fragment"><div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;                                                                  {</div>
<div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;  <span class="comment">// Shared memory for intermediate steps</span></div>
<div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;  T *sdata = <a class="code" href="a00217.html">SharedMemory&lt;T&gt;</a>();</div>
<div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;  <span class="comment">// Handle to thread block group</span></div>
<div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;  cg::thread_block cta = cg::this_thread_block();</div>
<div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;  <span class="comment">// Handle to tile in thread block</span></div>
<div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;  cg::thread_block_tile&lt;32&gt; tile = cg::tiled_partition&lt;32&gt;(cta);</div>
<div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;</div>
<div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;  <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> ctaSize = cta.size();</div>
<div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;  <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> numCtas = gridDim.x;</div>
<div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;  <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> threadRank = cta.thread_rank();</div>
<div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;  <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> threadIndex = (blockIdx.x * ctaSize) + threadRank;</div>
<div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;</div>
<div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;  T threadVal = 0;</div>
<div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;  {</div>
<div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i = threadIndex;</div>
<div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> indexStride = (numCtas * ctaSize);</div>
<div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;    <span class="keywordflow">while</span> (i &lt; n) {</div>
<div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;      threadVal += g_idata[i];</div>
<div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;      i += indexStride;</div>
<div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;    }</div>
<div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;    sdata[threadRank] = threadVal;</div>
<div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;  }</div>
<div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;</div>
<div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;  <span class="comment">// Wait for all tiles to finish and reduce within CTA</span></div>
<div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;  {</div>
<div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> ctaSteps = tile.meta_group_size();</div>
<div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> ctaIndex = ctaSize &gt;&gt; 1;</div>
<div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;    <span class="keywordflow">while</span> (ctaIndex &gt;= 32) {</div>
<div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;      cta.sync();</div>
<div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;      <span class="keywordflow">if</span> (threadRank &lt; ctaIndex) {</div>
<div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;        threadVal += sdata[threadRank + ctaIndex];</div>
<div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;        sdata[threadRank] = threadVal;</div>
<div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;      }</div>
<div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;      ctaSteps &gt;&gt;= 1;</div>
<div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;      ctaIndex &gt;&gt;= 1;</div>
<div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;    }</div>
<div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;  }</div>
<div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;</div>
<div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;  <span class="comment">// Shuffle redux instead of smem redux</span></div>
<div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;  {</div>
<div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;    cta.sync();</div>
<div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;    <span class="keywordflow">if</span> (tile.meta_group_rank() == 0) {</div>
<div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;      threadVal = <a class="code" href="a00301.html#a7694c20f9f61838b868c2b02d593b17c">cg_reduce_n</a>(threadVal, tile);</div>
<div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;    }</div>
<div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;  }</div>
<div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;</div>
<div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;  <span class="keywordflow">if</span> (threadRank == 0) g_odata[blockIdx.x] = threadVal;</div>
<div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;}</div>
<div class="ttc" id="a00301_html_a7694c20f9f61838b868c2b02d593b17c"><div class="ttname"><a href="a00301.html#a7694c20f9f61838b868c2b02d593b17c">cg_reduce_n</a></div><div class="ttdeci">__device__ T cg_reduce_n(T in, Group &amp;threads)</div><div class="ttdef"><b>Definition:</b> <a href="a00301_source.html#l00494">ParallelReduction_GPU.cu:494</a></div></div>
<div class="ttc" id="a00217_html"><div class="ttname"><a href="a00217.html">SharedMemory</a></div><div class="ttdef"><b>Definition:</b> <a href="a00301_source.html#l00044">ParallelReduction_GPU.cu:44</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="af164dd43ee254a12353703e3ca51df11"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">__global__ void multi_warp_cg_reduce </td>
          <td>(</td>
          <td class="paramtype">T *&#160;</td>
          <td class="paramname"><em>g_idata</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">T *&#160;</td>
          <td class="paramname"><em>g_odata</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned int&#160;</td>
          <td class="paramname"><em>n</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="a00301_source.html#l00550">550</a> of file <a class="el" href="a00301_source.html">ParallelReduction_GPU.cu</a>.</p>
<div class="fragment"><div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;                                                                             {</div>
<div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;  <span class="comment">// Shared memory for intermediate steps</span></div>
<div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;  T *sdata = <a class="code" href="a00217.html">SharedMemory&lt;T&gt;</a>();</div>
<div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;  __shared__ cg::experimental::block_tile_memory&lt;sizeof(T), BlockSize&gt; scratch;</div>
<div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;</div>
<div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;  <span class="comment">// Handle to thread block group</span></div>
<div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;  <span class="keyword">auto</span> cta = cg::experimental::this_thread_block(scratch);</div>
<div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;  <span class="comment">// Handle to multiWarpTile in thread block</span></div>
<div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;  <span class="keyword">auto</span> multiWarpTile = cg::experimental::tiled_partition&lt;MultiWarpGroupSize&gt;(cta);</div>
<div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;</div>
<div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;  <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> gridSize = BlockSize * gridDim.x;</div>
<div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;  T threadVal = 0;</div>
<div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;</div>
<div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;  <span class="comment">// we reduce multiple elements per thread.  The number is determined by the</span></div>
<div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;  <span class="comment">// number of active thread blocks (via gridDim).  More blocks will result</span></div>
<div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;  <span class="comment">// in a larger gridSize and therefore fewer elements per thread</span></div>
<div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;  <span class="keywordtype">int</span> nIsPow2 = !(n &amp; n-1);</div>
<div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;  <span class="keywordflow">if</span> (nIsPow2) {</div>
<div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i = blockIdx.x * BlockSize * 2 + threadIdx.x;</div>
<div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;    gridSize = gridSize &lt;&lt; 1;</div>
<div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;</div>
<div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;    <span class="keywordflow">while</span> (i &lt; n) {</div>
<div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;      threadVal += g_idata[i];</div>
<div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;      <span class="comment">// ensure we don&#39;t read out of bounds -- this is optimized away for</span></div>
<div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;      <span class="comment">// powerOf2 sized arrays</span></div>
<div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;      <span class="keywordflow">if</span> ((i + BlockSize) &lt; n) {</div>
<div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;        threadVal += g_idata[i + blockDim.x];</div>
<div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;      }</div>
<div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;      i += gridSize;</div>
<div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;    }</div>
<div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;  } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i = blockIdx.x * BlockSize + threadIdx.x;</div>
<div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;    <span class="keywordflow">while</span> (i &lt; n) {</div>
<div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;      threadVal += g_idata[i];</div>
<div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;      i += gridSize;</div>
<div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;    }</div>
<div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;  }</div>
<div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160;</div>
<div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160;  threadVal = <a class="code" href="a00301.html#a7694c20f9f61838b868c2b02d593b17c">cg_reduce_n</a>(threadVal, multiWarpTile);</div>
<div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;</div>
<div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160;  <span class="keywordflow">if</span> (multiWarpTile.thread_rank() == 0) {</div>
<div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160;    sdata[multiWarpTile.meta_group_rank()] = threadVal;</div>
<div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160;  }</div>
<div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160;  cg::sync(cta);</div>
<div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160;</div>
<div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160;  <span class="keywordflow">if</span> (threadIdx.x == 0) {</div>
<div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;    threadVal = 0;</div>
<div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i &lt; multiWarpTile.meta_group_size(); i++) {</div>
<div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160;      threadVal += sdata[i];</div>
<div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;    }</div>
<div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160;    g_odata[blockIdx.x] = threadVal;</div>
<div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160;  }</div>
<div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160;}</div>
<div class="ttc" id="a00301_html_a7694c20f9f61838b868c2b02d593b17c"><div class="ttname"><a href="a00301.html#a7694c20f9f61838b868c2b02d593b17c">cg_reduce_n</a></div><div class="ttdeci">__device__ T cg_reduce_n(T in, Group &amp;threads)</div><div class="ttdef"><b>Definition:</b> <a href="a00301_source.html#l00494">ParallelReduction_GPU.cu:494</a></div></div>
<div class="ttc" id="a00217_html"><div class="ttname"><a href="a00217.html">SharedMemory</a></div><div class="ttdef"><b>Definition:</b> <a href="a00301_source.html#l00044">ParallelReduction_GPU.cu:44</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a4402d8b02944d53e362f9a25ea59c7b1"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool isPow2 </td>
          <td>(</td>
          <td class="paramtype">unsigned int&#160;</td>
          <td class="paramname"><em>x</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a class="anchor" id="a1024a0c3df7789c601e3a0d3da5c1832"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void reduce </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>size</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>threads</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>blocks</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>whichKernel</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">T *&#160;</td>
          <td class="paramname"><em>d_idata</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">T *&#160;</td>
          <td class="paramname"><em>d_odata</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="a00301_source.html#l00610">610</a> of file <a class="el" href="a00301_source.html">ParallelReduction_GPU.cu</a>.</p>
<div class="fragment"><div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;                        {</div>
<div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160;  dim3 dimBlock(threads, 1, 1);</div>
<div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160;  dim3 dimGrid(blocks, 1, 1);</div>
<div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160;</div>
<div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160;  <span class="comment">// when there is only one warp per block, we need to allocate two warps</span></div>
<div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160;  <span class="comment">// worth of shared memory so that we don&#39;t index shared memory out of bounds</span></div>
<div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160;  <span class="keywordtype">int</span> smemSize =</div>
<div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160;      (threads &lt;= 32) ? 2 * threads * <span class="keyword">sizeof</span>(T) : threads * <span class="keyword">sizeof</span>(T);</div>
<div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160;</div>
<div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160;  <span class="comment">// as kernel 9 - multi_warp_cg_reduce cannot work for more than 64 threads</span></div>
<div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160;  <span class="comment">// we choose to set kernel 7 for this purpose.</span></div>
<div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160;  <span class="keywordflow">if</span> (threads &lt; 64 &amp;&amp; whichKernel == 9)</div>
<div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160;  {</div>
<div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160;    whichKernel = 7;</div>
<div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160;  }</div>
<div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160;</div>
<div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160;  <span class="comment">// choose which of the optimized versions of reduction to launch</span></div>
<div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160;  <span class="keywordflow">switch</span> (whichKernel) {</div>
<div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160;    <span class="keywordflow">case</span> 0:</div>
<div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160;      reduce0&lt;T&gt;&lt;&lt;&lt;dimGrid, dimBlock, smemSize&gt;&gt;&gt;(d_idata, d_odata, size);</div>
<div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160;      <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160;</div>
<div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160;    <span class="keywordflow">case</span> 1:</div>
<div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160;      reduce1&lt;T&gt;&lt;&lt;&lt;dimGrid, dimBlock, smemSize&gt;&gt;&gt;(d_idata, d_odata, size);</div>
<div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160;      <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160;</div>
<div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160;    <span class="keywordflow">case</span> 2:</div>
<div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160;      reduce2&lt;T&gt;&lt;&lt;&lt;dimGrid, dimBlock, smemSize&gt;&gt;&gt;(d_idata, d_odata, size);</div>
<div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160;      <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00640"></a><span class="lineno">  640</span>&#160;</div>
<div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160;    <span class="keywordflow">case</span> 3:</div>
<div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160;      reduce3&lt;T&gt;&lt;&lt;&lt;dimGrid, dimBlock, smemSize&gt;&gt;&gt;(d_idata, d_odata, size);</div>
<div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160;      <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160;</div>
<div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160;    <span class="keywordflow">case</span> 4:</div>
<div class="line"><a name="l00646"></a><span class="lineno">  646</span>&#160;      <span class="keywordflow">switch</span> (threads) {</div>
<div class="line"><a name="l00647"></a><span class="lineno">  647</span>&#160;        <span class="keywordflow">case</span> 512:</div>
<div class="line"><a name="l00648"></a><span class="lineno">  648</span>&#160;          reduce4&lt;T, 512&gt;</div>
<div class="line"><a name="l00649"></a><span class="lineno">  649</span>&#160;              &lt;&lt;&lt;dimGrid, dimBlock, smemSize&gt;&gt;&gt;(d_idata, d_odata, size);</div>
<div class="line"><a name="l00650"></a><span class="lineno">  650</span>&#160;          <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00651"></a><span class="lineno">  651</span>&#160;</div>
<div class="line"><a name="l00652"></a><span class="lineno">  652</span>&#160;        <span class="keywordflow">case</span> 256:</div>
<div class="line"><a name="l00653"></a><span class="lineno">  653</span>&#160;          reduce4&lt;T, 256&gt;</div>
<div class="line"><a name="l00654"></a><span class="lineno">  654</span>&#160;              &lt;&lt;&lt;dimGrid, dimBlock, smemSize&gt;&gt;&gt;(d_idata, d_odata, size);</div>
<div class="line"><a name="l00655"></a><span class="lineno">  655</span>&#160;          <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00656"></a><span class="lineno">  656</span>&#160;</div>
<div class="line"><a name="l00657"></a><span class="lineno">  657</span>&#160;        <span class="keywordflow">case</span> 128:</div>
<div class="line"><a name="l00658"></a><span class="lineno">  658</span>&#160;          reduce4&lt;T, 128&gt;</div>
<div class="line"><a name="l00659"></a><span class="lineno">  659</span>&#160;              &lt;&lt;&lt;dimGrid, dimBlock, smemSize&gt;&gt;&gt;(d_idata, d_odata, size);</div>
<div class="line"><a name="l00660"></a><span class="lineno">  660</span>&#160;          <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00661"></a><span class="lineno">  661</span>&#160;</div>
<div class="line"><a name="l00662"></a><span class="lineno">  662</span>&#160;        <span class="keywordflow">case</span> 64:</div>
<div class="line"><a name="l00663"></a><span class="lineno">  663</span>&#160;          reduce4&lt;T, 64&gt;</div>
<div class="line"><a name="l00664"></a><span class="lineno">  664</span>&#160;              &lt;&lt;&lt;dimGrid, dimBlock, smemSize&gt;&gt;&gt;(d_idata, d_odata, size);</div>
<div class="line"><a name="l00665"></a><span class="lineno">  665</span>&#160;          <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00666"></a><span class="lineno">  666</span>&#160;</div>
<div class="line"><a name="l00667"></a><span class="lineno">  667</span>&#160;        <span class="keywordflow">case</span> 32:</div>
<div class="line"><a name="l00668"></a><span class="lineno">  668</span>&#160;          reduce4&lt;T, 32&gt;</div>
<div class="line"><a name="l00669"></a><span class="lineno">  669</span>&#160;              &lt;&lt;&lt;dimGrid, dimBlock, smemSize&gt;&gt;&gt;(d_idata, d_odata, size);</div>
<div class="line"><a name="l00670"></a><span class="lineno">  670</span>&#160;          <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00671"></a><span class="lineno">  671</span>&#160;</div>
<div class="line"><a name="l00672"></a><span class="lineno">  672</span>&#160;        <span class="keywordflow">case</span> 16:</div>
<div class="line"><a name="l00673"></a><span class="lineno">  673</span>&#160;          reduce4&lt;T, 16&gt;</div>
<div class="line"><a name="l00674"></a><span class="lineno">  674</span>&#160;              &lt;&lt;&lt;dimGrid, dimBlock, smemSize&gt;&gt;&gt;(d_idata, d_odata, size);</div>
<div class="line"><a name="l00675"></a><span class="lineno">  675</span>&#160;          <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00676"></a><span class="lineno">  676</span>&#160;</div>
<div class="line"><a name="l00677"></a><span class="lineno">  677</span>&#160;        <span class="keywordflow">case</span> 8:</div>
<div class="line"><a name="l00678"></a><span class="lineno">  678</span>&#160;          reduce4&lt;T, 8&gt;</div>
<div class="line"><a name="l00679"></a><span class="lineno">  679</span>&#160;              &lt;&lt;&lt;dimGrid, dimBlock, smemSize&gt;&gt;&gt;(d_idata, d_odata, size);</div>
<div class="line"><a name="l00680"></a><span class="lineno">  680</span>&#160;          <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00681"></a><span class="lineno">  681</span>&#160;</div>
<div class="line"><a name="l00682"></a><span class="lineno">  682</span>&#160;        <span class="keywordflow">case</span> 4:</div>
<div class="line"><a name="l00683"></a><span class="lineno">  683</span>&#160;          reduce4&lt;T, 4&gt;</div>
<div class="line"><a name="l00684"></a><span class="lineno">  684</span>&#160;              &lt;&lt;&lt;dimGrid, dimBlock, smemSize&gt;&gt;&gt;(d_idata, d_odata, size);</div>
<div class="line"><a name="l00685"></a><span class="lineno">  685</span>&#160;          <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00686"></a><span class="lineno">  686</span>&#160;</div>
<div class="line"><a name="l00687"></a><span class="lineno">  687</span>&#160;        <span class="keywordflow">case</span> 2:</div>
<div class="line"><a name="l00688"></a><span class="lineno">  688</span>&#160;          reduce4&lt;T, 2&gt;</div>
<div class="line"><a name="l00689"></a><span class="lineno">  689</span>&#160;              &lt;&lt;&lt;dimGrid, dimBlock, smemSize&gt;&gt;&gt;(d_idata, d_odata, size);</div>
<div class="line"><a name="l00690"></a><span class="lineno">  690</span>&#160;          <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00691"></a><span class="lineno">  691</span>&#160;</div>
<div class="line"><a name="l00692"></a><span class="lineno">  692</span>&#160;        <span class="keywordflow">case</span> 1:</div>
<div class="line"><a name="l00693"></a><span class="lineno">  693</span>&#160;          reduce4&lt;T, 1&gt;</div>
<div class="line"><a name="l00694"></a><span class="lineno">  694</span>&#160;              &lt;&lt;&lt;dimGrid, dimBlock, smemSize&gt;&gt;&gt;(d_idata, d_odata, size);</div>
<div class="line"><a name="l00695"></a><span class="lineno">  695</span>&#160;          <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00696"></a><span class="lineno">  696</span>&#160;      }</div>
<div class="line"><a name="l00697"></a><span class="lineno">  697</span>&#160;</div>
<div class="line"><a name="l00698"></a><span class="lineno">  698</span>&#160;      <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00699"></a><span class="lineno">  699</span>&#160;</div>
<div class="line"><a name="l00700"></a><span class="lineno">  700</span>&#160;    <span class="keywordflow">case</span> 5:</div>
<div class="line"><a name="l00701"></a><span class="lineno">  701</span>&#160;      <span class="keywordflow">switch</span> (threads) {</div>
<div class="line"><a name="l00702"></a><span class="lineno">  702</span>&#160;        <span class="keywordflow">case</span> 512:</div>
<div class="line"><a name="l00703"></a><span class="lineno">  703</span>&#160;          reduce5&lt;T, 512&gt;</div>
<div class="line"><a name="l00704"></a><span class="lineno">  704</span>&#160;              &lt;&lt;&lt;dimGrid, dimBlock, smemSize&gt;&gt;&gt;(d_idata, d_odata, size);</div>
<div class="line"><a name="l00705"></a><span class="lineno">  705</span>&#160;          <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00706"></a><span class="lineno">  706</span>&#160;</div>
<div class="line"><a name="l00707"></a><span class="lineno">  707</span>&#160;        <span class="keywordflow">case</span> 256:</div>
<div class="line"><a name="l00708"></a><span class="lineno">  708</span>&#160;          reduce5&lt;T, 256&gt;</div>
<div class="line"><a name="l00709"></a><span class="lineno">  709</span>&#160;              &lt;&lt;&lt;dimGrid, dimBlock, smemSize&gt;&gt;&gt;(d_idata, d_odata, size);</div>
<div class="line"><a name="l00710"></a><span class="lineno">  710</span>&#160;          <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00711"></a><span class="lineno">  711</span>&#160;</div>
<div class="line"><a name="l00712"></a><span class="lineno">  712</span>&#160;        <span class="keywordflow">case</span> 128:</div>
<div class="line"><a name="l00713"></a><span class="lineno">  713</span>&#160;          reduce5&lt;T, 128&gt;</div>
<div class="line"><a name="l00714"></a><span class="lineno">  714</span>&#160;              &lt;&lt;&lt;dimGrid, dimBlock, smemSize&gt;&gt;&gt;(d_idata, d_odata, size);</div>
<div class="line"><a name="l00715"></a><span class="lineno">  715</span>&#160;          <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00716"></a><span class="lineno">  716</span>&#160;</div>
<div class="line"><a name="l00717"></a><span class="lineno">  717</span>&#160;        <span class="keywordflow">case</span> 64:</div>
<div class="line"><a name="l00718"></a><span class="lineno">  718</span>&#160;          reduce5&lt;T, 64&gt;</div>
<div class="line"><a name="l00719"></a><span class="lineno">  719</span>&#160;              &lt;&lt;&lt;dimGrid, dimBlock, smemSize&gt;&gt;&gt;(d_idata, d_odata, size);</div>
<div class="line"><a name="l00720"></a><span class="lineno">  720</span>&#160;          <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00721"></a><span class="lineno">  721</span>&#160;</div>
<div class="line"><a name="l00722"></a><span class="lineno">  722</span>&#160;        <span class="keywordflow">case</span> 32:</div>
<div class="line"><a name="l00723"></a><span class="lineno">  723</span>&#160;          reduce5&lt;T, 32&gt;</div>
<div class="line"><a name="l00724"></a><span class="lineno">  724</span>&#160;              &lt;&lt;&lt;dimGrid, dimBlock, smemSize&gt;&gt;&gt;(d_idata, d_odata, size);</div>
<div class="line"><a name="l00725"></a><span class="lineno">  725</span>&#160;          <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00726"></a><span class="lineno">  726</span>&#160;</div>
<div class="line"><a name="l00727"></a><span class="lineno">  727</span>&#160;        <span class="keywordflow">case</span> 16:</div>
<div class="line"><a name="l00728"></a><span class="lineno">  728</span>&#160;          reduce5&lt;T, 16&gt;</div>
<div class="line"><a name="l00729"></a><span class="lineno">  729</span>&#160;              &lt;&lt;&lt;dimGrid, dimBlock, smemSize&gt;&gt;&gt;(d_idata, d_odata, size);</div>
<div class="line"><a name="l00730"></a><span class="lineno">  730</span>&#160;          <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00731"></a><span class="lineno">  731</span>&#160;</div>
<div class="line"><a name="l00732"></a><span class="lineno">  732</span>&#160;        <span class="keywordflow">case</span> 8:</div>
<div class="line"><a name="l00733"></a><span class="lineno">  733</span>&#160;          reduce5&lt;T, 8&gt;</div>
<div class="line"><a name="l00734"></a><span class="lineno">  734</span>&#160;              &lt;&lt;&lt;dimGrid, dimBlock, smemSize&gt;&gt;&gt;(d_idata, d_odata, size);</div>
<div class="line"><a name="l00735"></a><span class="lineno">  735</span>&#160;          <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00736"></a><span class="lineno">  736</span>&#160;</div>
<div class="line"><a name="l00737"></a><span class="lineno">  737</span>&#160;        <span class="keywordflow">case</span> 4:</div>
<div class="line"><a name="l00738"></a><span class="lineno">  738</span>&#160;          reduce5&lt;T, 4&gt;</div>
<div class="line"><a name="l00739"></a><span class="lineno">  739</span>&#160;              &lt;&lt;&lt;dimGrid, dimBlock, smemSize&gt;&gt;&gt;(d_idata, d_odata, size);</div>
<div class="line"><a name="l00740"></a><span class="lineno">  740</span>&#160;          <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00741"></a><span class="lineno">  741</span>&#160;</div>
<div class="line"><a name="l00742"></a><span class="lineno">  742</span>&#160;        <span class="keywordflow">case</span> 2:</div>
<div class="line"><a name="l00743"></a><span class="lineno">  743</span>&#160;          reduce5&lt;T, 2&gt;</div>
<div class="line"><a name="l00744"></a><span class="lineno">  744</span>&#160;              &lt;&lt;&lt;dimGrid, dimBlock, smemSize&gt;&gt;&gt;(d_idata, d_odata, size);</div>
<div class="line"><a name="l00745"></a><span class="lineno">  745</span>&#160;          <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00746"></a><span class="lineno">  746</span>&#160;</div>
<div class="line"><a name="l00747"></a><span class="lineno">  747</span>&#160;        <span class="keywordflow">case</span> 1:</div>
<div class="line"><a name="l00748"></a><span class="lineno">  748</span>&#160;          reduce5&lt;T, 1&gt;</div>
<div class="line"><a name="l00749"></a><span class="lineno">  749</span>&#160;              &lt;&lt;&lt;dimGrid, dimBlock, smemSize&gt;&gt;&gt;(d_idata, d_odata, size);</div>
<div class="line"><a name="l00750"></a><span class="lineno">  750</span>&#160;          <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00751"></a><span class="lineno">  751</span>&#160;      }</div>
<div class="line"><a name="l00752"></a><span class="lineno">  752</span>&#160;</div>
<div class="line"><a name="l00753"></a><span class="lineno">  753</span>&#160;      <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00754"></a><span class="lineno">  754</span>&#160;</div>
<div class="line"><a name="l00755"></a><span class="lineno">  755</span>&#160;    <span class="keywordflow">case</span> 6:</div>
<div class="line"><a name="l00756"></a><span class="lineno">  756</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="a00301.html#a4402d8b02944d53e362f9a25ea59c7b1">isPow2</a>(size)) {</div>
<div class="line"><a name="l00757"></a><span class="lineno">  757</span>&#160;        <span class="keywordflow">switch</span> (threads) {</div>
<div class="line"><a name="l00758"></a><span class="lineno">  758</span>&#160;          <span class="keywordflow">case</span> 512:</div>
<div class="line"><a name="l00759"></a><span class="lineno">  759</span>&#160;            reduce6&lt;T, 512, true&gt;</div>
<div class="line"><a name="l00760"></a><span class="lineno">  760</span>&#160;                &lt;&lt;&lt;dimGrid, dimBlock, smemSize&gt;&gt;&gt;(d_idata, d_odata, size);</div>
<div class="line"><a name="l00761"></a><span class="lineno">  761</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00762"></a><span class="lineno">  762</span>&#160;</div>
<div class="line"><a name="l00763"></a><span class="lineno">  763</span>&#160;          <span class="keywordflow">case</span> 256:</div>
<div class="line"><a name="l00764"></a><span class="lineno">  764</span>&#160;            reduce6&lt;T, 256, true&gt;</div>
<div class="line"><a name="l00765"></a><span class="lineno">  765</span>&#160;                &lt;&lt;&lt;dimGrid, dimBlock, smemSize&gt;&gt;&gt;(d_idata, d_odata, size);</div>
<div class="line"><a name="l00766"></a><span class="lineno">  766</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00767"></a><span class="lineno">  767</span>&#160;</div>
<div class="line"><a name="l00768"></a><span class="lineno">  768</span>&#160;          <span class="keywordflow">case</span> 128:</div>
<div class="line"><a name="l00769"></a><span class="lineno">  769</span>&#160;            reduce6&lt;T, 128, true&gt;</div>
<div class="line"><a name="l00770"></a><span class="lineno">  770</span>&#160;                &lt;&lt;&lt;dimGrid, dimBlock, smemSize&gt;&gt;&gt;(d_idata, d_odata, size);</div>
<div class="line"><a name="l00771"></a><span class="lineno">  771</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00772"></a><span class="lineno">  772</span>&#160;</div>
<div class="line"><a name="l00773"></a><span class="lineno">  773</span>&#160;          <span class="keywordflow">case</span> 64:</div>
<div class="line"><a name="l00774"></a><span class="lineno">  774</span>&#160;            reduce6&lt;T, 64, true&gt;</div>
<div class="line"><a name="l00775"></a><span class="lineno">  775</span>&#160;                &lt;&lt;&lt;dimGrid, dimBlock, smemSize&gt;&gt;&gt;(d_idata, d_odata, size);</div>
<div class="line"><a name="l00776"></a><span class="lineno">  776</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00777"></a><span class="lineno">  777</span>&#160;</div>
<div class="line"><a name="l00778"></a><span class="lineno">  778</span>&#160;          <span class="keywordflow">case</span> 32:</div>
<div class="line"><a name="l00779"></a><span class="lineno">  779</span>&#160;            reduce6&lt;T, 32, true&gt;</div>
<div class="line"><a name="l00780"></a><span class="lineno">  780</span>&#160;                &lt;&lt;&lt;dimGrid, dimBlock, smemSize&gt;&gt;&gt;(d_idata, d_odata, size);</div>
<div class="line"><a name="l00781"></a><span class="lineno">  781</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00782"></a><span class="lineno">  782</span>&#160;</div>
<div class="line"><a name="l00783"></a><span class="lineno">  783</span>&#160;          <span class="keywordflow">case</span> 16:</div>
<div class="line"><a name="l00784"></a><span class="lineno">  784</span>&#160;            reduce6&lt;T, 16, true&gt;</div>
<div class="line"><a name="l00785"></a><span class="lineno">  785</span>&#160;                &lt;&lt;&lt;dimGrid, dimBlock, smemSize&gt;&gt;&gt;(d_idata, d_odata, size);</div>
<div class="line"><a name="l00786"></a><span class="lineno">  786</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00787"></a><span class="lineno">  787</span>&#160;</div>
<div class="line"><a name="l00788"></a><span class="lineno">  788</span>&#160;          <span class="keywordflow">case</span> 8:</div>
<div class="line"><a name="l00789"></a><span class="lineno">  789</span>&#160;            reduce6&lt;T, 8, true&gt;</div>
<div class="line"><a name="l00790"></a><span class="lineno">  790</span>&#160;                &lt;&lt;&lt;dimGrid, dimBlock, smemSize&gt;&gt;&gt;(d_idata, d_odata, size);</div>
<div class="line"><a name="l00791"></a><span class="lineno">  791</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00792"></a><span class="lineno">  792</span>&#160;</div>
<div class="line"><a name="l00793"></a><span class="lineno">  793</span>&#160;          <span class="keywordflow">case</span> 4:</div>
<div class="line"><a name="l00794"></a><span class="lineno">  794</span>&#160;            reduce6&lt;T, 4, true&gt;</div>
<div class="line"><a name="l00795"></a><span class="lineno">  795</span>&#160;                &lt;&lt;&lt;dimGrid, dimBlock, smemSize&gt;&gt;&gt;(d_idata, d_odata, size);</div>
<div class="line"><a name="l00796"></a><span class="lineno">  796</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00797"></a><span class="lineno">  797</span>&#160;</div>
<div class="line"><a name="l00798"></a><span class="lineno">  798</span>&#160;          <span class="keywordflow">case</span> 2:</div>
<div class="line"><a name="l00799"></a><span class="lineno">  799</span>&#160;            reduce6&lt;T, 2, true&gt;</div>
<div class="line"><a name="l00800"></a><span class="lineno">  800</span>&#160;                &lt;&lt;&lt;dimGrid, dimBlock, smemSize&gt;&gt;&gt;(d_idata, d_odata, size);</div>
<div class="line"><a name="l00801"></a><span class="lineno">  801</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00802"></a><span class="lineno">  802</span>&#160;</div>
<div class="line"><a name="l00803"></a><span class="lineno">  803</span>&#160;          <span class="keywordflow">case</span> 1:</div>
<div class="line"><a name="l00804"></a><span class="lineno">  804</span>&#160;            reduce6&lt;T, 1, true&gt;</div>
<div class="line"><a name="l00805"></a><span class="lineno">  805</span>&#160;                &lt;&lt;&lt;dimGrid, dimBlock, smemSize&gt;&gt;&gt;(d_idata, d_odata, size);</div>
<div class="line"><a name="l00806"></a><span class="lineno">  806</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00807"></a><span class="lineno">  807</span>&#160;        }</div>
<div class="line"><a name="l00808"></a><span class="lineno">  808</span>&#160;      } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00809"></a><span class="lineno">  809</span>&#160;        <span class="keywordflow">switch</span> (threads) {</div>
<div class="line"><a name="l00810"></a><span class="lineno">  810</span>&#160;          <span class="keywordflow">case</span> 512:</div>
<div class="line"><a name="l00811"></a><span class="lineno">  811</span>&#160;            reduce6&lt;T, 512, false&gt;</div>
<div class="line"><a name="l00812"></a><span class="lineno">  812</span>&#160;                &lt;&lt;&lt;dimGrid, dimBlock, smemSize&gt;&gt;&gt;(d_idata, d_odata, size);</div>
<div class="line"><a name="l00813"></a><span class="lineno">  813</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00814"></a><span class="lineno">  814</span>&#160;</div>
<div class="line"><a name="l00815"></a><span class="lineno">  815</span>&#160;          <span class="keywordflow">case</span> 256:</div>
<div class="line"><a name="l00816"></a><span class="lineno">  816</span>&#160;            reduce6&lt;T, 256, false&gt;</div>
<div class="line"><a name="l00817"></a><span class="lineno">  817</span>&#160;                &lt;&lt;&lt;dimGrid, dimBlock, smemSize&gt;&gt;&gt;(d_idata, d_odata, size);</div>
<div class="line"><a name="l00818"></a><span class="lineno">  818</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00819"></a><span class="lineno">  819</span>&#160;</div>
<div class="line"><a name="l00820"></a><span class="lineno">  820</span>&#160;          <span class="keywordflow">case</span> 128:</div>
<div class="line"><a name="l00821"></a><span class="lineno">  821</span>&#160;            reduce6&lt;T, 128, false&gt;</div>
<div class="line"><a name="l00822"></a><span class="lineno">  822</span>&#160;                &lt;&lt;&lt;dimGrid, dimBlock, smemSize&gt;&gt;&gt;(d_idata, d_odata, size);</div>
<div class="line"><a name="l00823"></a><span class="lineno">  823</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00824"></a><span class="lineno">  824</span>&#160;</div>
<div class="line"><a name="l00825"></a><span class="lineno">  825</span>&#160;          <span class="keywordflow">case</span> 64:</div>
<div class="line"><a name="l00826"></a><span class="lineno">  826</span>&#160;            reduce6&lt;T, 64, false&gt;</div>
<div class="line"><a name="l00827"></a><span class="lineno">  827</span>&#160;                &lt;&lt;&lt;dimGrid, dimBlock, smemSize&gt;&gt;&gt;(d_idata, d_odata, size);</div>
<div class="line"><a name="l00828"></a><span class="lineno">  828</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00829"></a><span class="lineno">  829</span>&#160;</div>
<div class="line"><a name="l00830"></a><span class="lineno">  830</span>&#160;          <span class="keywordflow">case</span> 32:</div>
<div class="line"><a name="l00831"></a><span class="lineno">  831</span>&#160;            reduce6&lt;T, 32, false&gt;</div>
<div class="line"><a name="l00832"></a><span class="lineno">  832</span>&#160;                &lt;&lt;&lt;dimGrid, dimBlock, smemSize&gt;&gt;&gt;(d_idata, d_odata, size);</div>
<div class="line"><a name="l00833"></a><span class="lineno">  833</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00834"></a><span class="lineno">  834</span>&#160;</div>
<div class="line"><a name="l00835"></a><span class="lineno">  835</span>&#160;          <span class="keywordflow">case</span> 16:</div>
<div class="line"><a name="l00836"></a><span class="lineno">  836</span>&#160;            reduce6&lt;T, 16, false&gt;</div>
<div class="line"><a name="l00837"></a><span class="lineno">  837</span>&#160;                &lt;&lt;&lt;dimGrid, dimBlock, smemSize&gt;&gt;&gt;(d_idata, d_odata, size);</div>
<div class="line"><a name="l00838"></a><span class="lineno">  838</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00839"></a><span class="lineno">  839</span>&#160;</div>
<div class="line"><a name="l00840"></a><span class="lineno">  840</span>&#160;          <span class="keywordflow">case</span> 8:</div>
<div class="line"><a name="l00841"></a><span class="lineno">  841</span>&#160;            reduce6&lt;T, 8, false&gt;</div>
<div class="line"><a name="l00842"></a><span class="lineno">  842</span>&#160;                &lt;&lt;&lt;dimGrid, dimBlock, smemSize&gt;&gt;&gt;(d_idata, d_odata, size);</div>
<div class="line"><a name="l00843"></a><span class="lineno">  843</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00844"></a><span class="lineno">  844</span>&#160;</div>
<div class="line"><a name="l00845"></a><span class="lineno">  845</span>&#160;          <span class="keywordflow">case</span> 4:</div>
<div class="line"><a name="l00846"></a><span class="lineno">  846</span>&#160;            reduce6&lt;T, 4, false&gt;</div>
<div class="line"><a name="l00847"></a><span class="lineno">  847</span>&#160;                &lt;&lt;&lt;dimGrid, dimBlock, smemSize&gt;&gt;&gt;(d_idata, d_odata, size);</div>
<div class="line"><a name="l00848"></a><span class="lineno">  848</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00849"></a><span class="lineno">  849</span>&#160;</div>
<div class="line"><a name="l00850"></a><span class="lineno">  850</span>&#160;          <span class="keywordflow">case</span> 2:</div>
<div class="line"><a name="l00851"></a><span class="lineno">  851</span>&#160;            reduce6&lt;T, 2, false&gt;</div>
<div class="line"><a name="l00852"></a><span class="lineno">  852</span>&#160;                &lt;&lt;&lt;dimGrid, dimBlock, smemSize&gt;&gt;&gt;(d_idata, d_odata, size);</div>
<div class="line"><a name="l00853"></a><span class="lineno">  853</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00854"></a><span class="lineno">  854</span>&#160;</div>
<div class="line"><a name="l00855"></a><span class="lineno">  855</span>&#160;          <span class="keywordflow">case</span> 1:</div>
<div class="line"><a name="l00856"></a><span class="lineno">  856</span>&#160;            reduce6&lt;T, 1, false&gt;</div>
<div class="line"><a name="l00857"></a><span class="lineno">  857</span>&#160;                &lt;&lt;&lt;dimGrid, dimBlock, smemSize&gt;&gt;&gt;(d_idata, d_odata, size);</div>
<div class="line"><a name="l00858"></a><span class="lineno">  858</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00859"></a><span class="lineno">  859</span>&#160;        }</div>
<div class="line"><a name="l00860"></a><span class="lineno">  860</span>&#160;      }</div>
<div class="line"><a name="l00861"></a><span class="lineno">  861</span>&#160;</div>
<div class="line"><a name="l00862"></a><span class="lineno">  862</span>&#160;      <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00863"></a><span class="lineno">  863</span>&#160;</div>
<div class="line"><a name="l00864"></a><span class="lineno">  864</span>&#160;    <span class="keywordflow">case</span> 7:</div>
<div class="line"><a name="l00865"></a><span class="lineno">  865</span>&#160;      <span class="comment">// For reduce7 kernel we require only blockSize/warpSize</span></div>
<div class="line"><a name="l00866"></a><span class="lineno">  866</span>&#160;      <span class="comment">// number of elements in shared memory</span></div>
<div class="line"><a name="l00867"></a><span class="lineno">  867</span>&#160;      smemSize = ((threads / 32) + 1) * <span class="keyword">sizeof</span>(T);</div>
<div class="line"><a name="l00868"></a><span class="lineno">  868</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="a00301.html#a4402d8b02944d53e362f9a25ea59c7b1">isPow2</a>(size)) {</div>
<div class="line"><a name="l00869"></a><span class="lineno">  869</span>&#160;        <span class="keywordflow">switch</span> (threads) {</div>
<div class="line"><a name="l00870"></a><span class="lineno">  870</span>&#160;          <span class="keywordflow">case</span> 1024:</div>
<div class="line"><a name="l00871"></a><span class="lineno">  871</span>&#160;            reduce7&lt;T, 1024, true&gt;</div>
<div class="line"><a name="l00872"></a><span class="lineno">  872</span>&#160;                &lt;&lt;&lt;dimGrid, dimBlock, smemSize&gt;&gt;&gt;(d_idata, d_odata, size);</div>
<div class="line"><a name="l00873"></a><span class="lineno">  873</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00874"></a><span class="lineno">  874</span>&#160;          <span class="keywordflow">case</span> 512:</div>
<div class="line"><a name="l00875"></a><span class="lineno">  875</span>&#160;            reduce7&lt;T, 512, true&gt;</div>
<div class="line"><a name="l00876"></a><span class="lineno">  876</span>&#160;                &lt;&lt;&lt;dimGrid, dimBlock, smemSize&gt;&gt;&gt;(d_idata, d_odata, size);</div>
<div class="line"><a name="l00877"></a><span class="lineno">  877</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00878"></a><span class="lineno">  878</span>&#160;</div>
<div class="line"><a name="l00879"></a><span class="lineno">  879</span>&#160;          <span class="keywordflow">case</span> 256:</div>
<div class="line"><a name="l00880"></a><span class="lineno">  880</span>&#160;            reduce7&lt;T, 256, true&gt;</div>
<div class="line"><a name="l00881"></a><span class="lineno">  881</span>&#160;                &lt;&lt;&lt;dimGrid, dimBlock, smemSize&gt;&gt;&gt;(d_idata, d_odata, size);</div>
<div class="line"><a name="l00882"></a><span class="lineno">  882</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00883"></a><span class="lineno">  883</span>&#160;</div>
<div class="line"><a name="l00884"></a><span class="lineno">  884</span>&#160;          <span class="keywordflow">case</span> 128:</div>
<div class="line"><a name="l00885"></a><span class="lineno">  885</span>&#160;            reduce7&lt;T, 128, true&gt;</div>
<div class="line"><a name="l00886"></a><span class="lineno">  886</span>&#160;                &lt;&lt;&lt;dimGrid, dimBlock, smemSize&gt;&gt;&gt;(d_idata, d_odata, size);</div>
<div class="line"><a name="l00887"></a><span class="lineno">  887</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00888"></a><span class="lineno">  888</span>&#160;</div>
<div class="line"><a name="l00889"></a><span class="lineno">  889</span>&#160;          <span class="keywordflow">case</span> 64:</div>
<div class="line"><a name="l00890"></a><span class="lineno">  890</span>&#160;            reduce7&lt;T, 64, true&gt;</div>
<div class="line"><a name="l00891"></a><span class="lineno">  891</span>&#160;                &lt;&lt;&lt;dimGrid, dimBlock, smemSize&gt;&gt;&gt;(d_idata, d_odata, size);</div>
<div class="line"><a name="l00892"></a><span class="lineno">  892</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00893"></a><span class="lineno">  893</span>&#160;</div>
<div class="line"><a name="l00894"></a><span class="lineno">  894</span>&#160;          <span class="keywordflow">case</span> 32:</div>
<div class="line"><a name="l00895"></a><span class="lineno">  895</span>&#160;            reduce7&lt;T, 32, true&gt;</div>
<div class="line"><a name="l00896"></a><span class="lineno">  896</span>&#160;                &lt;&lt;&lt;dimGrid, dimBlock, smemSize&gt;&gt;&gt;(d_idata, d_odata, size);</div>
<div class="line"><a name="l00897"></a><span class="lineno">  897</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00898"></a><span class="lineno">  898</span>&#160;</div>
<div class="line"><a name="l00899"></a><span class="lineno">  899</span>&#160;          <span class="keywordflow">case</span> 16:</div>
<div class="line"><a name="l00900"></a><span class="lineno">  900</span>&#160;            reduce7&lt;T, 16, true&gt;</div>
<div class="line"><a name="l00901"></a><span class="lineno">  901</span>&#160;                &lt;&lt;&lt;dimGrid, dimBlock, smemSize&gt;&gt;&gt;(d_idata, d_odata, size);</div>
<div class="line"><a name="l00902"></a><span class="lineno">  902</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00903"></a><span class="lineno">  903</span>&#160;</div>
<div class="line"><a name="l00904"></a><span class="lineno">  904</span>&#160;          <span class="keywordflow">case</span> 8:</div>
<div class="line"><a name="l00905"></a><span class="lineno">  905</span>&#160;            reduce7&lt;T, 8, true&gt;</div>
<div class="line"><a name="l00906"></a><span class="lineno">  906</span>&#160;                &lt;&lt;&lt;dimGrid, dimBlock, smemSize&gt;&gt;&gt;(d_idata, d_odata, size);</div>
<div class="line"><a name="l00907"></a><span class="lineno">  907</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00908"></a><span class="lineno">  908</span>&#160;</div>
<div class="line"><a name="l00909"></a><span class="lineno">  909</span>&#160;          <span class="keywordflow">case</span> 4:</div>
<div class="line"><a name="l00910"></a><span class="lineno">  910</span>&#160;            reduce7&lt;T, 4, true&gt;</div>
<div class="line"><a name="l00911"></a><span class="lineno">  911</span>&#160;                &lt;&lt;&lt;dimGrid, dimBlock, smemSize&gt;&gt;&gt;(d_idata, d_odata, size);</div>
<div class="line"><a name="l00912"></a><span class="lineno">  912</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00913"></a><span class="lineno">  913</span>&#160;</div>
<div class="line"><a name="l00914"></a><span class="lineno">  914</span>&#160;          <span class="keywordflow">case</span> 2:</div>
<div class="line"><a name="l00915"></a><span class="lineno">  915</span>&#160;            reduce7&lt;T, 2, true&gt;</div>
<div class="line"><a name="l00916"></a><span class="lineno">  916</span>&#160;                &lt;&lt;&lt;dimGrid, dimBlock, smemSize&gt;&gt;&gt;(d_idata, d_odata, size);</div>
<div class="line"><a name="l00917"></a><span class="lineno">  917</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00918"></a><span class="lineno">  918</span>&#160;</div>
<div class="line"><a name="l00919"></a><span class="lineno">  919</span>&#160;          <span class="keywordflow">case</span> 1:</div>
<div class="line"><a name="l00920"></a><span class="lineno">  920</span>&#160;            reduce7&lt;T, 1, true&gt;</div>
<div class="line"><a name="l00921"></a><span class="lineno">  921</span>&#160;                &lt;&lt;&lt;dimGrid, dimBlock, smemSize&gt;&gt;&gt;(d_idata, d_odata, size);</div>
<div class="line"><a name="l00922"></a><span class="lineno">  922</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00923"></a><span class="lineno">  923</span>&#160;        }</div>
<div class="line"><a name="l00924"></a><span class="lineno">  924</span>&#160;      } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00925"></a><span class="lineno">  925</span>&#160;        <span class="keywordflow">switch</span> (threads) {</div>
<div class="line"><a name="l00926"></a><span class="lineno">  926</span>&#160;          <span class="keywordflow">case</span> 1024:</div>
<div class="line"><a name="l00927"></a><span class="lineno">  927</span>&#160;            reduce7&lt;T, 1024, true&gt;</div>
<div class="line"><a name="l00928"></a><span class="lineno">  928</span>&#160;                &lt;&lt;&lt;dimGrid, dimBlock, smemSize&gt;&gt;&gt;(d_idata, d_odata, size);</div>
<div class="line"><a name="l00929"></a><span class="lineno">  929</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00930"></a><span class="lineno">  930</span>&#160;          <span class="keywordflow">case</span> 512:</div>
<div class="line"><a name="l00931"></a><span class="lineno">  931</span>&#160;            reduce7&lt;T, 512, false&gt;</div>
<div class="line"><a name="l00932"></a><span class="lineno">  932</span>&#160;                &lt;&lt;&lt;dimGrid, dimBlock, smemSize&gt;&gt;&gt;(d_idata, d_odata, size);</div>
<div class="line"><a name="l00933"></a><span class="lineno">  933</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00934"></a><span class="lineno">  934</span>&#160;</div>
<div class="line"><a name="l00935"></a><span class="lineno">  935</span>&#160;          <span class="keywordflow">case</span> 256:</div>
<div class="line"><a name="l00936"></a><span class="lineno">  936</span>&#160;            reduce7&lt;T, 256, false&gt;</div>
<div class="line"><a name="l00937"></a><span class="lineno">  937</span>&#160;                &lt;&lt;&lt;dimGrid, dimBlock, smemSize&gt;&gt;&gt;(d_idata, d_odata, size);</div>
<div class="line"><a name="l00938"></a><span class="lineno">  938</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00939"></a><span class="lineno">  939</span>&#160;</div>
<div class="line"><a name="l00940"></a><span class="lineno">  940</span>&#160;          <span class="keywordflow">case</span> 128:</div>
<div class="line"><a name="l00941"></a><span class="lineno">  941</span>&#160;            reduce7&lt;T, 128, false&gt;</div>
<div class="line"><a name="l00942"></a><span class="lineno">  942</span>&#160;                &lt;&lt;&lt;dimGrid, dimBlock, smemSize&gt;&gt;&gt;(d_idata, d_odata, size);</div>
<div class="line"><a name="l00943"></a><span class="lineno">  943</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00944"></a><span class="lineno">  944</span>&#160;</div>
<div class="line"><a name="l00945"></a><span class="lineno">  945</span>&#160;          <span class="keywordflow">case</span> 64:</div>
<div class="line"><a name="l00946"></a><span class="lineno">  946</span>&#160;            reduce7&lt;T, 64, false&gt;</div>
<div class="line"><a name="l00947"></a><span class="lineno">  947</span>&#160;                &lt;&lt;&lt;dimGrid, dimBlock, smemSize&gt;&gt;&gt;(d_idata, d_odata, size);</div>
<div class="line"><a name="l00948"></a><span class="lineno">  948</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00949"></a><span class="lineno">  949</span>&#160;</div>
<div class="line"><a name="l00950"></a><span class="lineno">  950</span>&#160;          <span class="keywordflow">case</span> 32:</div>
<div class="line"><a name="l00951"></a><span class="lineno">  951</span>&#160;            reduce7&lt;T, 32, false&gt;</div>
<div class="line"><a name="l00952"></a><span class="lineno">  952</span>&#160;                &lt;&lt;&lt;dimGrid, dimBlock, smemSize&gt;&gt;&gt;(d_idata, d_odata, size);</div>
<div class="line"><a name="l00953"></a><span class="lineno">  953</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00954"></a><span class="lineno">  954</span>&#160;</div>
<div class="line"><a name="l00955"></a><span class="lineno">  955</span>&#160;          <span class="keywordflow">case</span> 16:</div>
<div class="line"><a name="l00956"></a><span class="lineno">  956</span>&#160;            reduce7&lt;T, 16, false&gt;</div>
<div class="line"><a name="l00957"></a><span class="lineno">  957</span>&#160;                &lt;&lt;&lt;dimGrid, dimBlock, smemSize&gt;&gt;&gt;(d_idata, d_odata, size);</div>
<div class="line"><a name="l00958"></a><span class="lineno">  958</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00959"></a><span class="lineno">  959</span>&#160;</div>
<div class="line"><a name="l00960"></a><span class="lineno">  960</span>&#160;          <span class="keywordflow">case</span> 8:</div>
<div class="line"><a name="l00961"></a><span class="lineno">  961</span>&#160;            reduce7&lt;T, 8, false&gt;</div>
<div class="line"><a name="l00962"></a><span class="lineno">  962</span>&#160;                &lt;&lt;&lt;dimGrid, dimBlock, smemSize&gt;&gt;&gt;(d_idata, d_odata, size);</div>
<div class="line"><a name="l00963"></a><span class="lineno">  963</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00964"></a><span class="lineno">  964</span>&#160;</div>
<div class="line"><a name="l00965"></a><span class="lineno">  965</span>&#160;          <span class="keywordflow">case</span> 4:</div>
<div class="line"><a name="l00966"></a><span class="lineno">  966</span>&#160;            reduce7&lt;T, 4, false&gt;</div>
<div class="line"><a name="l00967"></a><span class="lineno">  967</span>&#160;                &lt;&lt;&lt;dimGrid, dimBlock, smemSize&gt;&gt;&gt;(d_idata, d_odata, size);</div>
<div class="line"><a name="l00968"></a><span class="lineno">  968</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00969"></a><span class="lineno">  969</span>&#160;</div>
<div class="line"><a name="l00970"></a><span class="lineno">  970</span>&#160;          <span class="keywordflow">case</span> 2:</div>
<div class="line"><a name="l00971"></a><span class="lineno">  971</span>&#160;            reduce7&lt;T, 2, false&gt;</div>
<div class="line"><a name="l00972"></a><span class="lineno">  972</span>&#160;                &lt;&lt;&lt;dimGrid, dimBlock, smemSize&gt;&gt;&gt;(d_idata, d_odata, size);</div>
<div class="line"><a name="l00973"></a><span class="lineno">  973</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00974"></a><span class="lineno">  974</span>&#160;</div>
<div class="line"><a name="l00975"></a><span class="lineno">  975</span>&#160;          <span class="keywordflow">case</span> 1:</div>
<div class="line"><a name="l00976"></a><span class="lineno">  976</span>&#160;            reduce7&lt;T, 1, false&gt;</div>
<div class="line"><a name="l00977"></a><span class="lineno">  977</span>&#160;                &lt;&lt;&lt;dimGrid, dimBlock, smemSize&gt;&gt;&gt;(d_idata, d_odata, size);</div>
<div class="line"><a name="l00978"></a><span class="lineno">  978</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00979"></a><span class="lineno">  979</span>&#160;        }</div>
<div class="line"><a name="l00980"></a><span class="lineno">  980</span>&#160;      }</div>
<div class="line"><a name="l00981"></a><span class="lineno">  981</span>&#160;</div>
<div class="line"><a name="l00982"></a><span class="lineno">  982</span>&#160;      <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00983"></a><span class="lineno">  983</span>&#160;    <span class="keywordflow">case</span> 8:</div>
<div class="line"><a name="l00984"></a><span class="lineno">  984</span>&#160;      cg_reduce&lt;T&gt;&lt;&lt;&lt;dimGrid, dimBlock, smemSize&gt;&gt;&gt;(d_idata, d_odata, size);</div>
<div class="line"><a name="l00985"></a><span class="lineno">  985</span>&#160;      <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00986"></a><span class="lineno">  986</span>&#160;    <span class="keywordflow">case</span> 9:</div>
<div class="line"><a name="l00987"></a><span class="lineno">  987</span>&#160;      constexpr <span class="keywordtype">int</span> numOfMultiWarpGroups = 2;</div>
<div class="line"><a name="l00988"></a><span class="lineno">  988</span>&#160;      smemSize = numOfMultiWarpGroups * <span class="keyword">sizeof</span>(T);</div>
<div class="line"><a name="l00989"></a><span class="lineno">  989</span>&#160;      <span class="keywordflow">switch</span> (threads) {</div>
<div class="line"><a name="l00990"></a><span class="lineno">  990</span>&#160;        <span class="keywordflow">case</span> 1024:</div>
<div class="line"><a name="l00991"></a><span class="lineno">  991</span>&#160;          <a class="code" href="a00301.html#af164dd43ee254a12353703e3ca51df11">multi_warp_cg_reduce</a>&lt;T, 1024, 1024/numOfMultiWarpGroups&gt;</div>
<div class="line"><a name="l00992"></a><span class="lineno">  992</span>&#160;            &lt;&lt;&lt;dimGrid, dimBlock, smemSize&gt;&gt;&gt;(d_idata, d_odata, size);</div>
<div class="line"><a name="l00993"></a><span class="lineno">  993</span>&#160;          <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00994"></a><span class="lineno">  994</span>&#160;</div>
<div class="line"><a name="l00995"></a><span class="lineno">  995</span>&#160;        <span class="keywordflow">case</span> 512:</div>
<div class="line"><a name="l00996"></a><span class="lineno">  996</span>&#160;          <a class="code" href="a00301.html#af164dd43ee254a12353703e3ca51df11">multi_warp_cg_reduce</a>&lt;T, 512, 512/numOfMultiWarpGroups&gt;</div>
<div class="line"><a name="l00997"></a><span class="lineno">  997</span>&#160;              &lt;&lt;&lt;dimGrid, dimBlock, smemSize&gt;&gt;&gt;(d_idata, d_odata, size);</div>
<div class="line"><a name="l00998"></a><span class="lineno">  998</span>&#160;          <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00999"></a><span class="lineno">  999</span>&#160;</div>
<div class="line"><a name="l01000"></a><span class="lineno"> 1000</span>&#160;        <span class="keywordflow">case</span> 256:</div>
<div class="line"><a name="l01001"></a><span class="lineno"> 1001</span>&#160;          <a class="code" href="a00301.html#af164dd43ee254a12353703e3ca51df11">multi_warp_cg_reduce</a>&lt;T, 256, 256/numOfMultiWarpGroups&gt;</div>
<div class="line"><a name="l01002"></a><span class="lineno"> 1002</span>&#160;              &lt;&lt;&lt;dimGrid, dimBlock, smemSize&gt;&gt;&gt;(d_idata, d_odata, size);</div>
<div class="line"><a name="l01003"></a><span class="lineno"> 1003</span>&#160;          <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01004"></a><span class="lineno"> 1004</span>&#160;</div>
<div class="line"><a name="l01005"></a><span class="lineno"> 1005</span>&#160;        <span class="keywordflow">case</span> 128:</div>
<div class="line"><a name="l01006"></a><span class="lineno"> 1006</span>&#160;          <a class="code" href="a00301.html#af164dd43ee254a12353703e3ca51df11">multi_warp_cg_reduce</a>&lt;T, 128, 128/numOfMultiWarpGroups&gt;</div>
<div class="line"><a name="l01007"></a><span class="lineno"> 1007</span>&#160;              &lt;&lt;&lt;dimGrid, dimBlock, smemSize&gt;&gt;&gt;(d_idata, d_odata, size);</div>
<div class="line"><a name="l01008"></a><span class="lineno"> 1008</span>&#160;          <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01009"></a><span class="lineno"> 1009</span>&#160;</div>
<div class="line"><a name="l01010"></a><span class="lineno"> 1010</span>&#160;        <span class="keywordflow">case</span> 64:</div>
<div class="line"><a name="l01011"></a><span class="lineno"> 1011</span>&#160;          <a class="code" href="a00301.html#af164dd43ee254a12353703e3ca51df11">multi_warp_cg_reduce</a>&lt;T, 64, 64/numOfMultiWarpGroups&gt;</div>
<div class="line"><a name="l01012"></a><span class="lineno"> 1012</span>&#160;              &lt;&lt;&lt;dimGrid, dimBlock, smemSize&gt;&gt;&gt;(d_idata, d_odata, size);</div>
<div class="line"><a name="l01013"></a><span class="lineno"> 1013</span>&#160;          <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01014"></a><span class="lineno"> 1014</span>&#160;</div>
<div class="line"><a name="l01015"></a><span class="lineno"> 1015</span>&#160;        <span class="keywordflow">default</span>:</div>
<div class="line"><a name="l01016"></a><span class="lineno"> 1016</span>&#160;          printf(<span class="stringliteral">&quot;thread block size of &lt; 64 is not supported for this kernel\n&quot;</span>);</div>
<div class="line"><a name="l01017"></a><span class="lineno"> 1017</span>&#160;          <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01018"></a><span class="lineno"> 1018</span>&#160;      }</div>
<div class="line"><a name="l01019"></a><span class="lineno"> 1019</span>&#160;      <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01020"></a><span class="lineno"> 1020</span>&#160;  }</div>
<div class="line"><a name="l01021"></a><span class="lineno"> 1021</span>&#160;}</div>
<div class="ttc" id="a00301_html_af164dd43ee254a12353703e3ca51df11"><div class="ttname"><a href="a00301.html#af164dd43ee254a12353703e3ca51df11">multi_warp_cg_reduce</a></div><div class="ttdeci">__global__ void multi_warp_cg_reduce(T *g_idata, T *g_odata, unsigned int n)</div><div class="ttdef"><b>Definition:</b> <a href="a00301_source.html#l00550">ParallelReduction_GPU.cu:550</a></div></div>
<div class="ttc" id="a00301_html_a4402d8b02944d53e362f9a25ea59c7b1"><div class="ttname"><a href="a00301.html#a4402d8b02944d53e362f9a25ea59c7b1">isPow2</a></div><div class="ttdeci">bool isPow2(unsigned int x)</div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ae39af8c237ab8ba9d1cac0a3e8731b4a"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">template void <a class="el" href="a00301.html#a1024a0c3df7789c601e3a0d3da5c1832">reduce</a>&lt; int &gt; </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>size</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>threads</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>blocks</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>whichKernel</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>d_idata</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>d_odata</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a class="anchor" id="afe06f9ca01de557df7c3b982be05d618"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">template void <a class="el" href="a00301.html#a1024a0c3df7789c601e3a0d3da5c1832">reduce</a>&lt; float &gt; </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>size</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>threads</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>blocks</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>whichKernel</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float *&#160;</td>
          <td class="paramname"><em>d_idata</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float *&#160;</td>
          <td class="paramname"><em>d_odata</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a class="anchor" id="ab35beed285c9a6b0579af1945ee307d9"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">template void <a class="el" href="a00301.html#a1024a0c3df7789c601e3a0d3da5c1832">reduce</a>&lt; double &gt; </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>size</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>threads</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>blocks</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>whichKernel</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>d_idata</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>d_odata</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- Start of StatCounter Code for Default Guide -->
<script type="text/javascript">
var sc_project=10897352; 
var sc_invisible=1; 
var sc_security="83042f57"; 
var scJsHost = (("https:" == document.location.protocol) ?
"https://secure." : "http://www.");
document.write("<sc"+"ript type='text/javascript' src='" +
scJsHost+
"statcounter.com/counter/counter.js'></"+"script>");
</script>
<noscript><div class="statcounter"><a title="website
statistics" href="http://statcounter.com/"
target="_blank"><img class="statcounter"
src="//c.statcounter.com/10897352/0/83042f57/1/"
alt="website statistics"></a></div></noscript>
<!-- End of StatCounter Code for Default Guide -->
