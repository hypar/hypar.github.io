<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>HyPar: src/BoundaryConditions/BCSubsonicOutflow.c File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<!-- Generated by Doxygen 1.6.1 -->
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li><a href="main.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="annotated.html"><span>Data&nbsp;Structures</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div class="tabs">
    <ul>
      <li><a href="files.html"><span>File&nbsp;List</span></a></li>
      <li><a href="globals.html"><span>Globals</span></a></li>
    </ul>
  </div>
</div>
<div class="contents">
<h1>src/BoundaryConditions/BCSubsonicOutflow.c File Reference</h1>
<p>Subsonic outflow boundary conditions (specific to Euler/Navier-Stokes systems).  
<a href="#_details">More...</a></p>
<code>#include &lt;stdlib.h&gt;</code><br/>
<code>#include &lt;<a class="el" href="a00036_source.html">basic.h</a>&gt;</code><br/>
<code>#include &lt;<a class="el" href="a00034_source.html">arrayfunctions.h</a>&gt;</code><br/>
<code>#include &lt;<a class="el" href="a00037_source.html">boundaryconditions.h</a>&gt;</code><br/>
<code>#include &lt;<a class="el" href="a00048_source.html">physicalmodels/euler2d.h</a>&gt;</code><br/>
<code>#include &lt;<a class="el" href="a00055_source.html">physicalmodels/navierstokes3d.h</a>&gt;</code><br/>

<p><a href="a00081_source.html">Go to the source code of this file.</a></p>
<table border="0" cellpadding="0" cellspacing="0">
<tr><td colspan="2"><h2>Functions</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00081.html#aea51db89a0a00f1c9b8288f9ebc059c6">BCSubsonicOutflowU</a> (void *b, void *m, int ndims, int nvars, int *size, int ghosts, double *phi, double waqt)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00081.html#a93eee7ff0ffe23d4cb5110d2b68eac26">BCSubsonicOutflowDU</a> (void *b, void *m, int ndims, int nvars, int *size, int ghosts, double *phi, double *phi_ref, double waqt)</td></tr>
</table>
<hr/><a name="_details"></a><h2>Detailed Description</h2>
<p>Subsonic outflow boundary conditions (specific to Euler/Navier-Stokes systems). </p>
<dl class="author"><dt><b>Author:</b></dt><dd>Debojyoti Ghosh </dd></dl>

<p>Definition in file <a class="el" href="a00081_source.html">BCSubsonicOutflow.c</a>.</p>
<hr/><h2>Function Documentation</h2>
<a class="anchor" id="aea51db89a0a00f1c9b8288f9ebc059c6"></a><!-- doxytag: member="BCSubsonicOutflow.c::BCSubsonicOutflowU" ref="aea51db89a0a00f1c9b8288f9ebc059c6" args="(void *b, void *m, int ndims, int nvars, int *size, int ghosts, double *phi, double waqt)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int BCSubsonicOutflowU </td>
          <td>(</td>
          <td class="paramtype">void *&nbsp;</td>
          <td class="paramname"> <em>b</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&nbsp;</td>
          <td class="paramname"> <em>m</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>ndims</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>nvars</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&nbsp;</td>
          <td class="paramname"> <em>size</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>ghosts</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&nbsp;</td>
          <td class="paramname"> <em>phi</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&nbsp;</td>
          <td class="paramname"> <em>waqt</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Applies the subsonic outflow boundary condition: The pressure at the physical boundary ghost points is specified, while the density and velocity are extrapolated from the interior. This boundary condition is specific to two and three dimensional Euler/ Navier-Stokes systems (<a class="el" href="a00006.html">Euler2D</a>, <a class="el" href="a00021.html" title="Structure containing variables and parameters specific to the 2D Navier Stokes equations...">NavierStokes2D</a>, <a class="el" href="a00022.html" title="Structure containing variables and parameters specific to the 3D Navier Stokes equations...">NavierStokes3D</a>). </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>b</em>&nbsp;</td><td>Boundary object of type <a class="el" href="a00004.html" title="Structure containing the variables and function pointers defining a boundary.">DomainBoundary</a> </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>m</em>&nbsp;</td><td>MPI object of type <a class="el" href="a00019.html" title="Structure of MPI-related variables.">MPIVariables</a> </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>ndims</em>&nbsp;</td><td>Number of spatial dimensions </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>nvars</em>&nbsp;</td><td>Number of variables/DoFs per grid point </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>size</em>&nbsp;</td><td>Integer array with the number of grid points in each spatial dimension </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>ghosts</em>&nbsp;</td><td>Number of ghost points </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>phi</em>&nbsp;</td><td>The solution array on which to apply the boundary condition </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>waqt</em>&nbsp;</td><td>Current solution time </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="a00081_source.html#l00019">19</a> of file <a class="el" href="a00081_source.html">BCSubsonicOutflow.c</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00029"></a>00029 {
<a name="l00030"></a>00030   <a class="code" href="a00004.html" title="Structure containing the variables and function pointers defining a boundary.">DomainBoundary</a> *boundary = (<a class="code" href="a00004.html" title="Structure containing the variables and function pointers defining a boundary.">DomainBoundary</a>*) b;
<a name="l00031"></a>00031 
<a name="l00032"></a>00032   <span class="keywordtype">int</span> dim   = boundary-&gt;<a class="code" href="a00004.html#a70b5e28b5bc3d1b63a7435c5fe50b837">dim</a>;
<a name="l00033"></a>00033   <span class="keywordtype">int</span> face  = boundary-&gt;<a class="code" href="a00004.html#a9582c650f117a06449b5ee368b6762ef">face</a>;
<a name="l00034"></a>00034 
<a name="l00035"></a>00035   <span class="keywordflow">if</span> (ndims == 2) {
<a name="l00036"></a>00036 
<a name="l00037"></a>00037     <span class="comment">/* create a fake physics object */</span>
<a name="l00038"></a>00038     <a class="code" href="a00006.html">Euler2D</a> physics; 
<a name="l00039"></a>00039     <span class="keywordtype">double</span> gamma;
<a name="l00040"></a>00040     gamma = physics.<a class="code" href="a00006.html#a72f9e01745b3a8203067ab84aefc9aea">gamma</a> = boundary-&gt;<a class="code" href="a00004.html#a72f9e01745b3a8203067ab84aefc9aea">gamma</a>;
<a name="l00041"></a>00041     <span class="keywordtype">double</span> inv_gamma_m1 = 1.0/(gamma-1.0);
<a name="l00042"></a>00042 
<a name="l00043"></a>00043     <span class="keywordflow">if</span> (boundary-&gt;<a class="code" href="a00004.html#a2eec7e4ee612d5edc985ba81453346e1">on_this_proc</a>) {
<a name="l00044"></a>00044       <span class="keywordtype">int</span> bounds[ndims], indexb[ndims], indexi[ndims];
<a name="l00045"></a>00045       <a class="code" href="a00034.html#ab49d0f261ea751a17d6beca0504daf78">_ArraySubtract1D_</a>(bounds,boundary-&gt;<a class="code" href="a00004.html#a7602de5ebb1b59ec35217e78a35a531e">ie</a>,boundary-&gt;<a class="code" href="a00004.html#a481013ba007a99a4237cde5eeb3c9a29">is</a>,ndims);
<a name="l00046"></a>00046       <a class="code" href="a00034.html#a2b2826031c0cd92495ab351d3e599fc5">_ArraySetValue_</a>(indexb,ndims,0);
<a name="l00047"></a>00047       <span class="keywordtype">int</span> done = 0;
<a name="l00048"></a>00048       <span class="keywordflow">while</span> (!done) {
<a name="l00049"></a>00049         <span class="keywordtype">int</span> p1, p2;
<a name="l00050"></a>00050         <a class="code" href="a00034.html#a89e8330d9e06dd0666c50833628a125c">_ArrayCopy1D_</a>(indexb,indexi,ndims);
<a name="l00051"></a>00051         <a class="code" href="a00034.html#a98a3bb5fda2fcafb70a6288d100a0924">_ArrayAdd1D_</a>(indexi,indexi,boundary-&gt;<a class="code" href="a00004.html#a481013ba007a99a4237cde5eeb3c9a29">is</a>,ndims);
<a name="l00052"></a>00052         <span class="keywordflow">if</span>      (face ==  1) indexi[dim] = ghosts-1-indexb[dim];
<a name="l00053"></a>00053         <span class="keywordflow">else</span> <span class="keywordflow">if</span> (face == -1) indexi[dim] = size[dim]-indexb[dim]-1;
<a name="l00054"></a>00054         <span class="keywordflow">else</span> <span class="keywordflow">return</span>(1);
<a name="l00055"></a>00055         <a class="code" href="a00034.html#a0739cb538f4d301fad3b45059ddd0738">_ArrayIndex1DWO_</a>(ndims,size,indexb,boundary-&gt;<a class="code" href="a00004.html#a481013ba007a99a4237cde5eeb3c9a29">is</a>,ghosts,p1);
<a name="l00056"></a>00056         <a class="code" href="a00034.html#afbb862a2fdf5b72b1f9ace42f64b556f">_ArrayIndex1D_</a>(ndims,size,indexi,ghosts,p2);
<a name="l00057"></a>00057         
<a name="l00058"></a>00058         <span class="comment">/* flow variables in the interior */</span>
<a name="l00059"></a>00059         <span class="keywordtype">double</span> rho, uvel, vvel, energy, <a class="code" href="a00032.html#a58d87a94271c7f86a36fafc7117fe0b0">pressure</a>;
<a name="l00060"></a>00060         <span class="keywordtype">double</span> rho_gpt, uvel_gpt, vvel_gpt, energy_gpt, pressure_gpt;
<a name="l00061"></a>00061         <a class="code" href="a00048.html#afff338b9964cae67fd9b3f4dc224e77b">_Euler2DGetFlowVar_</a>((phi+nvars*p2),rho,uvel,vvel,energy,pressure,(&amp;physics));
<a name="l00062"></a>00062         <span class="comment">/* set the ghost point values */</span>
<a name="l00063"></a>00063         rho_gpt = rho;
<a name="l00064"></a>00064         pressure_gpt = pressure; <span class="comment">/* useless statement to avoid compiler warning */</span>
<a name="l00065"></a>00065         pressure_gpt = boundary-&gt;<a class="code" href="a00004.html#a0a3c5af6bdb8fbdb746fd4edb374bb18">FlowPressure</a>;
<a name="l00066"></a>00066         uvel_gpt = uvel;
<a name="l00067"></a>00067         vvel_gpt = vvel;
<a name="l00068"></a>00068         energy_gpt = inv_gamma_m1*pressure_gpt
<a name="l00069"></a>00069                     + 0.5 * rho_gpt * (uvel_gpt*uvel_gpt + vvel_gpt*vvel_gpt);
<a name="l00070"></a>00070 
<a name="l00071"></a>00071         phi[nvars*p1+0] = rho_gpt;
<a name="l00072"></a>00072         phi[nvars*p1+1] = rho_gpt * uvel_gpt;
<a name="l00073"></a>00073         phi[nvars*p1+2] = rho_gpt * vvel_gpt;
<a name="l00074"></a>00074         phi[nvars*p1+3] = energy_gpt;
<a name="l00075"></a>00075 
<a name="l00076"></a>00076         <a class="code" href="a00034.html#ac5ec1371623f11d03b0f42adaa24acbc">_ArrayIncrementIndex_</a>(ndims,bounds,indexb,done);
<a name="l00077"></a>00077       }
<a name="l00078"></a>00078     }
<a name="l00079"></a>00079 
<a name="l00080"></a>00080   } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (ndims == 3) {
<a name="l00081"></a>00081 
<a name="l00082"></a>00082     <span class="comment">/* create a fake physics object */</span>
<a name="l00083"></a>00083     <a class="code" href="a00022.html" title="Structure containing variables and parameters specific to the 3D Navier Stokes equations...">NavierStokes3D</a> physics;
<a name="l00084"></a>00084     <span class="keywordtype">double</span> gamma;
<a name="l00085"></a>00085     gamma = physics.<a class="code" href="a00022.html#a72f9e01745b3a8203067ab84aefc9aea">gamma</a> = boundary-&gt;<a class="code" href="a00004.html#a72f9e01745b3a8203067ab84aefc9aea">gamma</a>;
<a name="l00086"></a>00086     <span class="keywordtype">double</span> inv_gamma_m1 = 1.0/(gamma-1.0);
<a name="l00087"></a>00087 
<a name="l00088"></a>00088     <span class="keywordflow">if</span> (boundary-&gt;<a class="code" href="a00004.html#a2eec7e4ee612d5edc985ba81453346e1">on_this_proc</a>) {
<a name="l00089"></a>00089       <span class="keywordtype">int</span> bounds[ndims], indexb[ndims], indexi[ndims];
<a name="l00090"></a>00090       <a class="code" href="a00034.html#ab49d0f261ea751a17d6beca0504daf78">_ArraySubtract1D_</a>(bounds,boundary-&gt;<a class="code" href="a00004.html#a7602de5ebb1b59ec35217e78a35a531e">ie</a>,boundary-&gt;<a class="code" href="a00004.html#a481013ba007a99a4237cde5eeb3c9a29">is</a>,ndims);
<a name="l00091"></a>00091       <a class="code" href="a00034.html#a2b2826031c0cd92495ab351d3e599fc5">_ArraySetValue_</a>(indexb,ndims,0);
<a name="l00092"></a>00092       <span class="keywordtype">int</span> done = 0;
<a name="l00093"></a>00093       <span class="keywordflow">while</span> (!done) {
<a name="l00094"></a>00094         <span class="keywordtype">int</span> p1, p2;
<a name="l00095"></a>00095         <a class="code" href="a00034.html#a89e8330d9e06dd0666c50833628a125c">_ArrayCopy1D_</a>(indexb,indexi,ndims);
<a name="l00096"></a>00096         <a class="code" href="a00034.html#a98a3bb5fda2fcafb70a6288d100a0924">_ArrayAdd1D_</a>(indexi,indexi,boundary-&gt;<a class="code" href="a00004.html#a481013ba007a99a4237cde5eeb3c9a29">is</a>,ndims);
<a name="l00097"></a>00097         <span class="keywordflow">if</span>      (face ==  1) indexi[dim] = ghosts-1-indexb[dim];
<a name="l00098"></a>00098         <span class="keywordflow">else</span> <span class="keywordflow">if</span> (face == -1) indexi[dim] = size[dim]-indexb[dim]-1;
<a name="l00099"></a>00099         <span class="keywordflow">else</span> <span class="keywordflow">return</span>(1);
<a name="l00100"></a>00100         <a class="code" href="a00034.html#a0739cb538f4d301fad3b45059ddd0738">_ArrayIndex1DWO_</a>(ndims,size,indexb,boundary-&gt;<a class="code" href="a00004.html#a481013ba007a99a4237cde5eeb3c9a29">is</a>,ghosts,p1);
<a name="l00101"></a>00101         <a class="code" href="a00034.html#afbb862a2fdf5b72b1f9ace42f64b556f">_ArrayIndex1D_</a>(ndims,size,indexi,ghosts,p2);
<a name="l00102"></a>00102         
<a name="l00103"></a>00103         <span class="comment">/* flow variables in the interior */</span>
<a name="l00104"></a>00104         <span class="keywordtype">double</span> rho, uvel, vvel, wvel, energy, <a class="code" href="a00032.html#a58d87a94271c7f86a36fafc7117fe0b0">pressure</a>;
<a name="l00105"></a>00105         <span class="keywordtype">double</span> rho_gpt, uvel_gpt, vvel_gpt, wvel_gpt, energy_gpt, pressure_gpt;
<a name="l00106"></a>00106         <a class="code" href="a00055.html#a47cfbfdecf13cd3336cc049cfe93ed45">_NavierStokes3DGetFlowVar_</a>((phi+nvars*p2),rho,uvel,vvel,wvel,energy,pressure,(&amp;physics));
<a name="l00107"></a>00107         <span class="comment">/* set the ghost point values */</span>
<a name="l00108"></a>00108         rho_gpt = rho;
<a name="l00109"></a>00109         pressure_gpt = pressure; <span class="comment">/* useless statement to avoid compiler warning */</span>
<a name="l00110"></a>00110         pressure_gpt = boundary-&gt;<a class="code" href="a00004.html#a0a3c5af6bdb8fbdb746fd4edb374bb18">FlowPressure</a>;
<a name="l00111"></a>00111         uvel_gpt = uvel;
<a name="l00112"></a>00112         vvel_gpt = vvel;
<a name="l00113"></a>00113         wvel_gpt = wvel;
<a name="l00114"></a>00114         energy_gpt = inv_gamma_m1*pressure_gpt
<a name="l00115"></a>00115                     + 0.5 * rho_gpt 
<a name="l00116"></a>00116                     * (uvel_gpt*uvel_gpt + vvel_gpt*vvel_gpt + wvel_gpt*wvel_gpt);
<a name="l00117"></a>00117 
<a name="l00118"></a>00118         phi[nvars*p1+0] = rho_gpt;
<a name="l00119"></a>00119         phi[nvars*p1+1] = rho_gpt * uvel_gpt;
<a name="l00120"></a>00120         phi[nvars*p1+2] = rho_gpt * vvel_gpt;
<a name="l00121"></a>00121         phi[nvars*p1+3] = rho_gpt * wvel_gpt;
<a name="l00122"></a>00122         phi[nvars*p1+4] = energy_gpt;
<a name="l00123"></a>00123 
<a name="l00124"></a>00124         <a class="code" href="a00034.html#ac5ec1371623f11d03b0f42adaa24acbc">_ArrayIncrementIndex_</a>(ndims,bounds,indexb,done);
<a name="l00125"></a>00125       }
<a name="l00126"></a>00126     }
<a name="l00127"></a>00127 
<a name="l00128"></a>00128   }
<a name="l00129"></a>00129   <span class="keywordflow">return</span>(0);
<a name="l00130"></a>00130 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a93eee7ff0ffe23d4cb5110d2b68eac26"></a><!-- doxytag: member="BCSubsonicOutflow.c::BCSubsonicOutflowDU" ref="a93eee7ff0ffe23d4cb5110d2b68eac26" args="(void *b, void *m, int ndims, int nvars, int *size, int ghosts, double *phi, double *phi_ref, double waqt)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int BCSubsonicOutflowDU </td>
          <td>(</td>
          <td class="paramtype">void *&nbsp;</td>
          <td class="paramname"> <em>b</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&nbsp;</td>
          <td class="paramname"> <em>m</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>ndims</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>nvars</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&nbsp;</td>
          <td class="paramname"> <em>size</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>ghosts</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&nbsp;</td>
          <td class="paramname"> <em>phi</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&nbsp;</td>
          <td class="paramname"> <em>phi_ref</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&nbsp;</td>
          <td class="paramname"> <em>waqt</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Applies the subsonic outflow boundary condition to the delta-solution: The pressure at the physical boundary ghost points is specified, while the density and velocity are extrapolated from the interior. This boundary condition is specific to two and three dimensional Euler/Navier-Stokes systems (<a class="el" href="a00006.html">Euler2D</a>, <a class="el" href="a00021.html" title="Structure containing variables and parameters specific to the 2D Navier Stokes equations...">NavierStokes2D</a>, <a class="el" href="a00022.html" title="Structure containing variables and parameters specific to the 3D Navier Stokes equations...">NavierStokes3D</a>). <br/>
<br/>
 The delta-solution is added to the reference solution, and the above treatment is applied to this total solution. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>b</em>&nbsp;</td><td>Boundary object of type <a class="el" href="a00004.html" title="Structure containing the variables and function pointers defining a boundary.">DomainBoundary</a> </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>m</em>&nbsp;</td><td>MPI object of type <a class="el" href="a00019.html" title="Structure of MPI-related variables.">MPIVariables</a> </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>ndims</em>&nbsp;</td><td>Number of spatial dimensions </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>nvars</em>&nbsp;</td><td>Number of variables/DoFs per grid point </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>size</em>&nbsp;</td><td>Integer array with the number of grid points in each spatial dimension </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>ghosts</em>&nbsp;</td><td>Number of ghost points </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>phi</em>&nbsp;</td><td>The solution array on which to apply the boundary condition - Note that this is a delta-solution <img class="formulaInl" alt="$\Delta {\bf U}$" src="form_93.png"/>. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>phi_ref</em>&nbsp;</td><td>Reference solution </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>waqt</em>&nbsp;</td><td>Current solution time </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="a00081_source.html#l00141">141</a> of file <a class="el" href="a00081_source.html">BCSubsonicOutflow.c</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00149"></a>00149                                                                                             {\bf U}\f$.*/
<a name="l00150"></a>00150                         <span class="keywordtype">double</span>  *phi_ref, 
<a name="l00151"></a>00151                         <span class="keywordtype">double</span>  waqt      
<a name="l00152"></a>00152                        )
<a name="l00153"></a>00153 {
<a name="l00154"></a>00154   <a class="code" href="a00004.html" title="Structure containing the variables and function pointers defining a boundary.">DomainBoundary</a> *boundary = (<a class="code" href="a00004.html" title="Structure containing the variables and function pointers defining a boundary.">DomainBoundary</a>*) b;
<a name="l00155"></a>00155 
<a name="l00156"></a>00156   <span class="keywordtype">int</span> dim   = boundary-&gt;<a class="code" href="a00004.html#a70b5e28b5bc3d1b63a7435c5fe50b837">dim</a>;
<a name="l00157"></a>00157   <span class="keywordtype">int</span> face  = boundary-&gt;<a class="code" href="a00004.html#a9582c650f117a06449b5ee368b6762ef">face</a>;
<a name="l00158"></a>00158   <span class="keywordtype">int</span> v;
<a name="l00159"></a>00159 
<a name="l00160"></a>00160   <span class="keywordflow">if</span> (ndims == 2) {
<a name="l00161"></a>00161 
<a name="l00162"></a>00162     <span class="comment">/* create a fake physics object */</span>
<a name="l00163"></a>00163     <a class="code" href="a00006.html">Euler2D</a> physics; 
<a name="l00164"></a>00164     <span class="keywordtype">double</span> gamma;
<a name="l00165"></a>00165     gamma = physics.<a class="code" href="a00006.html#a72f9e01745b3a8203067ab84aefc9aea">gamma</a> = boundary-&gt;<a class="code" href="a00004.html#a72f9e01745b3a8203067ab84aefc9aea">gamma</a>;
<a name="l00166"></a>00166     <span class="keywordtype">double</span> inv_gamma_m1 = 1.0/(gamma-1.0);
<a name="l00167"></a>00167 
<a name="l00168"></a>00168     <span class="keywordflow">if</span> (boundary-&gt;<a class="code" href="a00004.html#a2eec7e4ee612d5edc985ba81453346e1">on_this_proc</a>) {
<a name="l00169"></a>00169       <span class="keywordtype">int</span> bounds[ndims], indexb[ndims], indexi[ndims];
<a name="l00170"></a>00170       <a class="code" href="a00034.html#ab49d0f261ea751a17d6beca0504daf78">_ArraySubtract1D_</a>(bounds,boundary-&gt;<a class="code" href="a00004.html#a7602de5ebb1b59ec35217e78a35a531e">ie</a>,boundary-&gt;<a class="code" href="a00004.html#a481013ba007a99a4237cde5eeb3c9a29">is</a>,ndims);
<a name="l00171"></a>00171       <a class="code" href="a00034.html#a2b2826031c0cd92495ab351d3e599fc5">_ArraySetValue_</a>(indexb,ndims,0);
<a name="l00172"></a>00172       <span class="keywordtype">int</span> done = 0;
<a name="l00173"></a>00173       <span class="keywordflow">while</span> (!done) {
<a name="l00174"></a>00174         <span class="keywordtype">int</span> p1, p2;
<a name="l00175"></a>00175         <a class="code" href="a00034.html#a89e8330d9e06dd0666c50833628a125c">_ArrayCopy1D_</a>(indexb,indexi,ndims);
<a name="l00176"></a>00176         <a class="code" href="a00034.html#a98a3bb5fda2fcafb70a6288d100a0924">_ArrayAdd1D_</a>(indexi,indexi,boundary-&gt;<a class="code" href="a00004.html#a481013ba007a99a4237cde5eeb3c9a29">is</a>,ndims);
<a name="l00177"></a>00177         <span class="keywordflow">if</span>      (face ==  1) indexi[dim] = ghosts-1-indexb[dim];
<a name="l00178"></a>00178         <span class="keywordflow">else</span> <span class="keywordflow">if</span> (face == -1) indexi[dim] = size[dim]-indexb[dim]-1;
<a name="l00179"></a>00179         <span class="keywordflow">else</span> <span class="keywordflow">return</span>(1);
<a name="l00180"></a>00180         <a class="code" href="a00034.html#a0739cb538f4d301fad3b45059ddd0738">_ArrayIndex1DWO_</a>(ndims,size,indexb,boundary-&gt;<a class="code" href="a00004.html#a481013ba007a99a4237cde5eeb3c9a29">is</a>,ghosts,p1);
<a name="l00181"></a>00181         <a class="code" href="a00034.html#afbb862a2fdf5b72b1f9ace42f64b556f">_ArrayIndex1D_</a>(ndims,size,indexi,ghosts,p2);
<a name="l00182"></a>00182         
<a name="l00183"></a>00183         <span class="comment">/* flow in the interior is phi + phi_ref (since phi is DU) */</span>
<a name="l00184"></a>00184         <span class="keywordtype">double</span> phi_total[nvars]; 
<a name="l00185"></a>00185         <span class="keywordflow">for</span> (v=0; v&lt;nvars; v++) phi_total[v] = phi[nvars*p2+v]+phi_ref[nvars*p2+v];
<a name="l00186"></a>00186 
<a name="l00187"></a>00187         <span class="comment">/* flow variables in the interior */</span>
<a name="l00188"></a>00188         <span class="keywordtype">double</span> rho, uvel, vvel, energy, <a class="code" href="a00032.html#a58d87a94271c7f86a36fafc7117fe0b0">pressure</a>;
<a name="l00189"></a>00189         <span class="keywordtype">double</span> rho0, uvel0, vvel0, energy0, pressure0;
<a name="l00190"></a>00190         <a class="code" href="a00048.html#afff338b9964cae67fd9b3f4dc224e77b">_Euler2DGetFlowVar_</a>(phi_total,rho,uvel,vvel,energy,pressure,(&amp;physics));
<a name="l00191"></a>00191         <a class="code" href="a00048.html#afff338b9964cae67fd9b3f4dc224e77b">_Euler2DGetFlowVar_</a>((phi_ref+nvars*p2),rho0,uvel0,vvel0,energy0,pressure0,(&amp;physics));
<a name="l00192"></a>00192         <span class="comment">/* set the ghost point values */</span>
<a name="l00193"></a>00193         <span class="keywordtype">double</span> rho_gpt, uvel_gpt, vvel_gpt, energy_gpt, pressure_gpt;
<a name="l00194"></a>00194         <span class="keywordtype">double</span> rho0_gpt, uvel0_gpt, vvel0_gpt, energy0_gpt, pressure0_gpt;
<a name="l00195"></a>00195         <span class="comment">/* setting the ghost point values of the total flow variables */</span>
<a name="l00196"></a>00196         rho_gpt      = rho;
<a name="l00197"></a>00197         pressure_gpt = pressure; <span class="comment">/* useless statement to avoid compiler warning */</span>
<a name="l00198"></a>00198         pressure_gpt = boundary-&gt;<a class="code" href="a00004.html#a0a3c5af6bdb8fbdb746fd4edb374bb18">FlowPressure</a>;
<a name="l00199"></a>00199         uvel_gpt     = uvel;
<a name="l00200"></a>00200         vvel_gpt     = vvel;
<a name="l00201"></a>00201         energy_gpt   = inv_gamma_m1*pressure_gpt
<a name="l00202"></a>00202                        + 0.5 * rho_gpt * (uvel_gpt*uvel_gpt + vvel_gpt*vvel_gpt);
<a name="l00203"></a>00203         <span class="comment">/* setting the ghost point values of the reference flow variables */</span>
<a name="l00204"></a>00204         rho0_gpt      = rho0;
<a name="l00205"></a>00205         pressure0_gpt = pressure0; <span class="comment">/* useless statement to avoid compiler warning */</span>
<a name="l00206"></a>00206         pressure0_gpt = boundary-&gt;<a class="code" href="a00004.html#a0a3c5af6bdb8fbdb746fd4edb374bb18">FlowPressure</a>;
<a name="l00207"></a>00207         uvel0_gpt     = uvel0;
<a name="l00208"></a>00208         vvel0_gpt     = vvel0;
<a name="l00209"></a>00209         energy0_gpt   = inv_gamma_m1*pressure0_gpt
<a name="l00210"></a>00210                        + 0.5 * rho0_gpt * (uvel0_gpt*uvel0_gpt + vvel0_gpt*vvel0_gpt);
<a name="l00211"></a>00211 
<a name="l00212"></a>00212         phi[nvars*p1+0] = rho_gpt            - rho0_gpt;
<a name="l00213"></a>00213         phi[nvars*p1+1] = rho_gpt * uvel_gpt - rho0_gpt * uvel0_gpt;
<a name="l00214"></a>00214         phi[nvars*p1+2] = rho_gpt * vvel_gpt - rho0_gpt * vvel0_gpt;
<a name="l00215"></a>00215         phi[nvars*p1+3] = energy_gpt         - energy0_gpt;
<a name="l00216"></a>00216 
<a name="l00217"></a>00217         <a class="code" href="a00034.html#ac5ec1371623f11d03b0f42adaa24acbc">_ArrayIncrementIndex_</a>(ndims,bounds,indexb,done);
<a name="l00218"></a>00218       }
<a name="l00219"></a>00219     }
<a name="l00220"></a>00220 
<a name="l00221"></a>00221   } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (ndims == 3) {
<a name="l00222"></a>00222 
<a name="l00223"></a>00223     <span class="comment">/* create a fake physics object */</span>
<a name="l00224"></a>00224     <a class="code" href="a00022.html" title="Structure containing variables and parameters specific to the 3D Navier Stokes equations...">NavierStokes3D</a> physics;
<a name="l00225"></a>00225     <span class="keywordtype">double</span> gamma;
<a name="l00226"></a>00226     gamma = physics.<a class="code" href="a00022.html#a72f9e01745b3a8203067ab84aefc9aea">gamma</a> = boundary-&gt;<a class="code" href="a00004.html#a72f9e01745b3a8203067ab84aefc9aea">gamma</a>;
<a name="l00227"></a>00227     <span class="keywordtype">double</span> inv_gamma_m1 = 1.0/(gamma-1.0);
<a name="l00228"></a>00228 
<a name="l00229"></a>00229     <span class="keywordflow">if</span> (boundary-&gt;<a class="code" href="a00004.html#a2eec7e4ee612d5edc985ba81453346e1">on_this_proc</a>) {
<a name="l00230"></a>00230       <span class="keywordtype">int</span> bounds[ndims], indexb[ndims], indexi[ndims];
<a name="l00231"></a>00231       <a class="code" href="a00034.html#ab49d0f261ea751a17d6beca0504daf78">_ArraySubtract1D_</a>(bounds,boundary-&gt;<a class="code" href="a00004.html#a7602de5ebb1b59ec35217e78a35a531e">ie</a>,boundary-&gt;<a class="code" href="a00004.html#a481013ba007a99a4237cde5eeb3c9a29">is</a>,ndims);
<a name="l00232"></a>00232       <a class="code" href="a00034.html#a2b2826031c0cd92495ab351d3e599fc5">_ArraySetValue_</a>(indexb,ndims,0);
<a name="l00233"></a>00233       <span class="keywordtype">int</span> done = 0;
<a name="l00234"></a>00234       <span class="keywordflow">while</span> (!done) {
<a name="l00235"></a>00235         <span class="keywordtype">int</span> p1, p2;
<a name="l00236"></a>00236         <a class="code" href="a00034.html#a89e8330d9e06dd0666c50833628a125c">_ArrayCopy1D_</a>(indexb,indexi,ndims);
<a name="l00237"></a>00237         <a class="code" href="a00034.html#a98a3bb5fda2fcafb70a6288d100a0924">_ArrayAdd1D_</a>(indexi,indexi,boundary-&gt;<a class="code" href="a00004.html#a481013ba007a99a4237cde5eeb3c9a29">is</a>,ndims);
<a name="l00238"></a>00238         <span class="keywordflow">if</span>      (face ==  1) indexi[dim] = ghosts-1-indexb[dim];
<a name="l00239"></a>00239         <span class="keywordflow">else</span> <span class="keywordflow">if</span> (face == -1) indexi[dim] = size[dim]-indexb[dim]-1;
<a name="l00240"></a>00240         <span class="keywordflow">else</span> <span class="keywordflow">return</span>(1);
<a name="l00241"></a>00241         <a class="code" href="a00034.html#a0739cb538f4d301fad3b45059ddd0738">_ArrayIndex1DWO_</a>(ndims,size,indexb,boundary-&gt;<a class="code" href="a00004.html#a481013ba007a99a4237cde5eeb3c9a29">is</a>,ghosts,p1);
<a name="l00242"></a>00242         <a class="code" href="a00034.html#afbb862a2fdf5b72b1f9ace42f64b556f">_ArrayIndex1D_</a>(ndims,size,indexi,ghosts,p2);
<a name="l00243"></a>00243         
<a name="l00244"></a>00244         <span class="comment">/* flow in the interior is phi + phi_ref (since phi is DU) */</span>
<a name="l00245"></a>00245         <span class="keywordtype">double</span> phi_total[nvars]; 
<a name="l00246"></a>00246         <span class="keywordflow">for</span> (v=0; v&lt;nvars; v++) phi_total[v] = phi[nvars*p2+v]+phi_ref[nvars*p2+v];
<a name="l00247"></a>00247 
<a name="l00248"></a>00248         <span class="comment">/* flow variables in the interior */</span>
<a name="l00249"></a>00249         <span class="keywordtype">double</span> rho, uvel, vvel, wvel, energy, pressure;
<a name="l00250"></a>00250         <span class="keywordtype">double</span> rho0, uvel0, vvel0, wvel0, energy0, pressure0;
<a name="l00251"></a>00251         <a class="code" href="a00055.html#a47cfbfdecf13cd3336cc049cfe93ed45">_NavierStokes3DGetFlowVar_</a>(phi_total,rho,uvel,vvel,wvel,energy,pressure,(&amp;physics));
<a name="l00252"></a>00252         <a class="code" href="a00055.html#a47cfbfdecf13cd3336cc049cfe93ed45">_NavierStokes3DGetFlowVar_</a>((phi_ref+nvars*p2),rho0,uvel0,vvel0,wvel0,energy0,pressure0,(&amp;physics));
<a name="l00253"></a>00253         <span class="comment">/* set the ghost point values */</span>
<a name="l00254"></a>00254         <span class="keywordtype">double</span> rho_gpt, uvel_gpt, vvel_gpt, wvel_gpt, energy_gpt, pressure_gpt;
<a name="l00255"></a>00255         <span class="keywordtype">double</span> rho0_gpt, uvel0_gpt, vvel0_gpt, wvel0_gpt, energy0_gpt, pressure0_gpt;
<a name="l00256"></a>00256         <span class="comment">/* setting the ghost point values of the total flow variables */</span>
<a name="l00257"></a>00257         rho_gpt      = rho;
<a name="l00258"></a>00258         pressure_gpt = pressure; <span class="comment">/* useless statement to avoid compiler warning */</span>
<a name="l00259"></a>00259         pressure_gpt = boundary-&gt;<a class="code" href="a00004.html#a0a3c5af6bdb8fbdb746fd4edb374bb18">FlowPressure</a>;
<a name="l00260"></a>00260         uvel_gpt     = uvel;
<a name="l00261"></a>00261         vvel_gpt     = vvel;
<a name="l00262"></a>00262         wvel_gpt     = wvel;
<a name="l00263"></a>00263         energy_gpt   = inv_gamma_m1*pressure_gpt
<a name="l00264"></a>00264                        + 0.5 * rho_gpt 
<a name="l00265"></a>00265                        * (uvel_gpt*uvel_gpt + vvel_gpt*vvel_gpt + wvel_gpt*wvel_gpt);
<a name="l00266"></a>00266         <span class="comment">/* setting the ghost point values of the reference flow variables */</span>
<a name="l00267"></a>00267         rho0_gpt      = rho0;
<a name="l00268"></a>00268         pressure0_gpt = pressure0; <span class="comment">/* useless statement to avoid compiler warning */</span>
<a name="l00269"></a>00269         pressure0_gpt = boundary-&gt;<a class="code" href="a00004.html#a0a3c5af6bdb8fbdb746fd4edb374bb18">FlowPressure</a>;
<a name="l00270"></a>00270         uvel0_gpt     = uvel0;
<a name="l00271"></a>00271         vvel0_gpt     = vvel0;
<a name="l00272"></a>00272         wvel0_gpt     = wvel0;
<a name="l00273"></a>00273         energy0_gpt   = inv_gamma_m1*pressure0_gpt
<a name="l00274"></a>00274                        + 0.5 * rho0_gpt 
<a name="l00275"></a>00275                        * (uvel0_gpt*uvel0_gpt + vvel0_gpt*vvel0_gpt + wvel0_gpt*wvel0_gpt);
<a name="l00276"></a>00276 
<a name="l00277"></a>00277         phi[nvars*p1+0] = rho_gpt            - rho0_gpt;
<a name="l00278"></a>00278         phi[nvars*p1+1] = rho_gpt * uvel_gpt - rho0_gpt * uvel0_gpt;
<a name="l00279"></a>00279         phi[nvars*p1+2] = rho_gpt * vvel_gpt - rho0_gpt * vvel0_gpt;
<a name="l00280"></a>00280         phi[nvars*p1+3] = rho_gpt * wvel_gpt - rho0_gpt * wvel0_gpt;
<a name="l00281"></a>00281         phi[nvars*p1+4] = energy_gpt         - energy0_gpt;
<a name="l00282"></a>00282 
<a name="l00283"></a>00283         <a class="code" href="a00034.html#ac5ec1371623f11d03b0f42adaa24acbc">_ArrayIncrementIndex_</a>(ndims,bounds,indexb,done);
<a name="l00284"></a>00284       }
<a name="l00285"></a>00285     }
<a name="l00286"></a>00286 
<a name="l00287"></a>00287   }
<a name="l00288"></a>00288   <span class="keywordflow">return</span>(0);
<a name="l00289"></a>00289 }
</pre></div></p>

</div>
</div>
</div>
<!-- Start of StatCounter Code for Default Guide -->
<script type="text/javascript">
var sc_project=10897352; 
var sc_invisible=1; 
var sc_security="83042f57"; 
var scJsHost = (("https:" == document.location.protocol) ?
"https://secure." : "http://www.");
document.write("<sc"+"ript type='text/javascript' src='" +
scJsHost+
"statcounter.com/counter/counter.js'></"+"script>");
</script>
<noscript><div class="statcounter"><a title="website
statistics" href="http://statcounter.com/"
target="_blank"><img class="statcounter"
src="//c.statcounter.com/10897352/0/83042f57/1/"
alt="website statistics"></a></div></noscript>
<!-- End of StatCounter Code for Default Guide -->
