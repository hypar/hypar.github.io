<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>HyPar: include/physicalmodels/navierstokes3d.h File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<!-- Generated by Doxygen 1.6.1 -->
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li><a href="main.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="annotated.html"><span>Data&nbsp;Structures</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div class="tabs">
    <ul>
      <li><a href="files.html"><span>File&nbsp;List</span></a></li>
      <li><a href="globals.html"><span>Globals</span></a></li>
    </ul>
  </div>
</div>
<div class="contents">
<h1>include/physicalmodels/navierstokes3d.h File Reference</h1>
<p>3D Navier Stokes equations (compressible flows)  
<a href="#_details">More...</a></p>
<code>#include &lt;<a class="el" href="a00036_source.html">basic.h</a>&gt;</code><br/>

<p><a href="a00055_source.html">Go to the source code of this file.</a></p>
<table border="0" cellpadding="0" cellspacing="0">
<tr><td colspan="2"><h2>Data Structures</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">struct &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00022.html">NavierStokes3D</a></td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Structure containing variables and parameters specific to the 3D Navier Stokes equations. This structure contains the physical parameters, variables, and function pointers specific to the 3D Navier-Stokes equations.  <a href="a00022.html#_details">More...</a><br/></td></tr>
<tr><td colspan="2"><h2>Defines</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00055.html#a34099431ed2606bd884d36cea1d0448e">_NAVIER_STOKES_3D_</a>&nbsp;&nbsp;&nbsp;&quot;navierstokes3d&quot;</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00055.html#a57771c952ec174601addf43e1c0202b2">_MODEL_NDIMS_</a>&nbsp;&nbsp;&nbsp;3</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00055.html#ad3395a55a5fde64d6603c7a82d7bf2c7">_MODEL_NVARS_</a>&nbsp;&nbsp;&nbsp;5</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00055.html#abffeadaaee7a3a2baeeb28e395411d73">_ROE_</a>&nbsp;&nbsp;&nbsp;&quot;roe&quot;</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00055.html#a51e0f9431973e4cf55e6aeee7dab6d83">_RF_</a>&nbsp;&nbsp;&nbsp;&quot;rf-char&quot;</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00055.html#a98a6bcc1b69abface4bef84cf0d51955">_LLF_</a>&nbsp;&nbsp;&nbsp;&quot;llf-char&quot;</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00055.html#a68e6f3e8f20e4c3a5874221661141935">_RUSANOV_</a>&nbsp;&nbsp;&nbsp;&quot;rusanov&quot;</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00055.html#a6a44057228e5f4b86e1c4d04b2a28977">_XDIR_</a>&nbsp;&nbsp;&nbsp;0</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00055.html#a7fd32e06617f4489079bc50ce9bfc00c">_YDIR_</a>&nbsp;&nbsp;&nbsp;1</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00055.html#a227beecac6bef022707512c15d39e30b">_ZDIR_</a>&nbsp;&nbsp;&nbsp;2</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00055.html#a47cfbfdecf13cd3336cc049cfe93ed45">_NavierStokes3DGetFlowVar_</a>(u, rho, vx, vy, vz, <a class="el" href="a00032.html#a35b3e91c83139b35bbacfaa59a58afd1">e</a>, P, p)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00055.html#afe0735e8f79bed00ed4461b173ed48b3">_NavierStokes3DSetFlux_</a>(f, rho, vx, vy, vz, <a class="el" href="a00032.html#a35b3e91c83139b35bbacfaa59a58afd1">e</a>, P, dir)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00055.html#ae40168fa87c0d4466425166ea6d17269">_NavierStokes3DSetStiffFlux_</a>(f, rho, vx, vy, vz, <a class="el" href="a00032.html#a35b3e91c83139b35bbacfaa59a58afd1">e</a>, P, dir, gamma)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00055.html#af732c2201acf769c741833a401dc54cb">_NavierStokes3DSetNonStiffFlux_</a>(f, rho, vx, vy, vz, <a class="el" href="a00032.html#a35b3e91c83139b35bbacfaa59a58afd1">e</a>, P, dir, gamma)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00055.html#acb34fead87ef529f7f9efdc21cf0c585">_NavierStokes3DRoeAverage_</a>(uavg, uL, uR, p)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00055.html#a147b6aba2ceb349155d1fd74807677bd">_NavierStokes3DEigenvalues_</a>(u, <a class="el" href="a00031.html#add034d002483743ecf892648b0a4b6cc">D</a>, p, dir)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00055.html#ab38778016784c1a6aeadbbf41d0e07ce">_NavierStokes3DLeftEigenvectors_</a>(u, L, p, dir)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00055.html#a79a3562dd840ea39718f3c5993e65e45">_NavierStokes3DRightEigenvectors_</a>(u, R, p, dir)</td></tr>
<tr><td colspan="2"><h2>Functions</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00055.html#a0385acf3caf014aa7491ad2fc6a9572a">NavierStokes3DInitialize</a> (void *, void *)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00055.html#a5467b4e62f223583e901763082eb0d57">NavierStokes3DCleanup</a> (void *)</td></tr>
</table>
<hr/><a name="_details"></a><h2>Detailed Description</h2>
<p>3D Navier Stokes equations (compressible flows) </p>
<dl class="author"><dt><b>Author:</b></dt><dd>Debojyoti Ghosh</dd></dl>
<p>3D Navier-Stokes equations for viscous and inviscid compressible flows (with gravitational terms)<br/>
</p>
<p class="formulaDsp">
<img class="formulaDsp" alt="\begin{equation} \frac {\partial} {\partial t} \left[\begin{array}{c} \rho \\ \rho u \\ \rho v \\ \rho w \\ e \end{array}\right] + \frac {\partial} {\partial x} \left[\begin{array}{c} \rho u \\ \rho u^2 + p \\ \rho u v \\ \rho u w \\ (e+p) u\end{array}\right] + \frac {\partial} {\partial y} \left[\begin{array}{c} \rho v \\ \rho u v \\ \rho v^2 + p \\ \rho v w \\ (e+p) v \end{array}\right] + \frac {\partial} {\partial z} \left[\begin{array}{c} \rho w \\ \rho u w \\ \rho v w \\ \rho w^2 + p \\ (e+p) w \end{array}\right] = \frac {\partial} {\partial x} \left[\begin{array}{c} 0 \\ \tau_{xx} \\ \tau_{yx} \\ \tau_{zx} \\ u \tau_{xx} + v \tau_{yx} + w \tau_{zx} - q_x \end{array}\right] + \frac {\partial} {\partial y} \left[\begin{array}{c} 0 \\ \tau_{xy} \\ \tau_{yy} \\ \tau_{zy} \\ u \tau_{xy} + v \tau_{yy} + w \tau_{zy} - q_y \end{array}\right] + \frac {\partial} {\partial z} \left[\begin{array}{c} 0 \\ \tau_{xz} \\ \tau_{yz} \\ \tau_{zz} \\ u \tau_{xz} + v \tau_{yz} + w \tau_{zz} - q_z \end{array}\right] + \left[\begin{array}{c} 0 \\ -\rho {\bf g}\cdot{\bf \hat{i}} \\ -\rho {\bf g}\cdot{\bf \hat{j}} \\ -\rho {\bf g}\cdot{\bf \hat{k}} \\ -\rho u {\bf g}\cdot{\bf \hat{i}} - \rho v {\bf g}\cdot{\bf \hat{j}} - \rho w {\bf g}\cdot{\bf \hat{k}} \end{array}\right] \end{equation}" src="form_63.png"/>
</p>
<p> where <img class="formulaInl" alt="${\bf g}$" src="form_53.png"/> is the gravitational force vector per unit mass, <img class="formulaInl" alt="${\bf \hat{i}},{\bf \hat{j}}, {\bf \hat{k}}$" src="form_64.png"/> are the unit vectors along the x, y, and z, the viscous terms are given by </p>
<p class="formulaDsp">
<img class="formulaDsp" alt="\begin{align} \tau_{ij} &amp;= \frac{\mu}{Re_\infty} \left[ \left( \frac{\partial u_i}{\partial x_j} + \frac{\partial u_j}{\partial x_i}\right) - \frac{2}{3}\frac{\partial u_k}{\partial x_k} \delta_{ij} \right], \\ q_i &amp;= - \frac{\mu}{\left(\gamma-1\right)Re_\infty Pr} \frac{\partial T}{\partial x_i} \end{align}" src="form_55.png"/>
</p>
<p> with <img class="formulaInl" alt="$\mu$" src="form_56.png"/> being the viscosity coefficient (computed using Sutherland's law), and the equation of state is </p>
<p class="formulaDsp">
<img class="formulaDsp" alt="\begin{equation} e = \frac {p} {\gamma-1} + \frac{1}{2} \rho \left(u^2 + v^2 + w^2\right) \end{equation}" src="form_65.png"/>
</p>
<p> References for the governing equations (as well as non-dimensional form):- + Tannehill, Anderson and Pletcher, Computational Fluid Mechanics and Heat Transfer, Chapter 5, Section 5.1.7 (However, the non-dimensional velocity and the Reynolds number is based on speed of sound, instead of the freestream velocity).</p>
<p>Reference for the well-balanced treatment of gravitational source term: + Ghosh, D., Constantinescu, E.M., Well-Balanced Formulation of Gravitational Source Terms for Conservative Finite-Difference Atmospheric Flow Solvers, AIAA Paper 2015-2889, 7th AIAA Atmospheric and Space Environments Conference, June 22-26, 2015, Dallas, TX, <a href="http://dx.doi.org/10.2514/6.2015-2889">http://dx.doi.org/10.2514/6.2015-2889</a> + Ghosh, D., Constantinescu, E.M., A Well-Balanced, Conservative Finite-Difference Algorithm for Atmospheric Flows, AIAA Journal, 54 (4), 2016, pp. 1370-1385, <a href="http://dx.doi.org/10.2514/1.J054580.">http://dx.doi.org/10.2514/1.J054580.</a></p>
<p>Reference for the partitioning of the flux into its stiff (acoustic) and non-stiff (convective) components: + Ghosh, D., Constantinescu, E. M., Semi-Implicit Time Integration of Atmospheric Flows with Characteristic-Based Flux Partitioning, SIAM Journal on Scientific Computing, 38 (3), 2016, A1848-A1875, <a href="http://dx.doi.org/10.1137/15M1044369.">http://dx.doi.org/10.1137/15M1044369.</a> </p>

<p>Definition in file <a class="el" href="a00055_source.html">navierstokes3d.h</a>.</p>
<hr/><h2>Define Documentation</h2>
<a class="anchor" id="a34099431ed2606bd884d36cea1d0448e"></a><!-- doxytag: member="navierstokes3d.h::_NAVIER_STOKES_3D_" ref="a34099431ed2606bd884d36cea1d0448e" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define _NAVIER_STOKES_3D_&nbsp;&nbsp;&nbsp;&quot;navierstokes3d&quot;</td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>3D Navier-Stokes equations </p>

<p>Definition at line <a class="el" href="a00055_source.html#l00050">50</a> of file <a class="el" href="a00055_source.html">navierstokes3d.h</a>.</p>

</div>
</div>
<a class="anchor" id="a57771c952ec174601addf43e1c0202b2"></a><!-- doxytag: member="navierstokes3d.h::_MODEL_NDIMS_" ref="a57771c952ec174601addf43e1c0202b2" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define _MODEL_NDIMS_&nbsp;&nbsp;&nbsp;3</td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Number of spatial dimensions </p>

<p>Definition at line <a class="el" href="a00055_source.html#l00056">56</a> of file <a class="el" href="a00055_source.html">navierstokes3d.h</a>.</p>

</div>
</div>
<a class="anchor" id="ad3395a55a5fde64d6603c7a82d7bf2c7"></a><!-- doxytag: member="navierstokes3d.h::_MODEL_NVARS_" ref="ad3395a55a5fde64d6603c7a82d7bf2c7" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define _MODEL_NVARS_&nbsp;&nbsp;&nbsp;5</td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Number of vector components at each grid point </p>

<p>Definition at line <a class="el" href="a00055_source.html#l00058">58</a> of file <a class="el" href="a00055_source.html">navierstokes3d.h</a>.</p>

</div>
</div>
<a class="anchor" id="abffeadaaee7a3a2baeeb28e395411d73"></a><!-- doxytag: member="navierstokes3d.h::_ROE_" ref="abffeadaaee7a3a2baeeb28e395411d73" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define _ROE_&nbsp;&nbsp;&nbsp;&quot;roe&quot;</td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Roe's upwinding scheme </p>

<p>Definition at line <a class="el" href="a00055_source.html#l00062">62</a> of file <a class="el" href="a00055_source.html">navierstokes3d.h</a>.</p>

</div>
</div>
<a class="anchor" id="a51e0f9431973e4cf55e6aeee7dab6d83"></a><!-- doxytag: member="navierstokes3d.h::_RF_" ref="a51e0f9431973e4cf55e6aeee7dab6d83" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define _RF_&nbsp;&nbsp;&nbsp;&quot;rf-char&quot;</td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Characteristic-based Roe-fixed scheme </p>

<p>Definition at line <a class="el" href="a00055_source.html#l00064">64</a> of file <a class="el" href="a00055_source.html">navierstokes3d.h</a>.</p>

</div>
</div>
<a class="anchor" id="a98a6bcc1b69abface4bef84cf0d51955"></a><!-- doxytag: member="navierstokes3d.h::_LLF_" ref="a98a6bcc1b69abface4bef84cf0d51955" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define _LLF_&nbsp;&nbsp;&nbsp;&quot;llf-char&quot;</td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Characteristic-based local Lax-Friedrich scheme </p>

<p>Definition at line <a class="el" href="a00055_source.html#l00066">66</a> of file <a class="el" href="a00055_source.html">navierstokes3d.h</a>.</p>

</div>
</div>
<a class="anchor" id="a68e6f3e8f20e4c3a5874221661141935"></a><!-- doxytag: member="navierstokes3d.h::_RUSANOV_" ref="a68e6f3e8f20e4c3a5874221661141935" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define _RUSANOV_&nbsp;&nbsp;&nbsp;&quot;rusanov&quot;</td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Rusanov's upwinding scheme </p>

<p>Definition at line <a class="el" href="a00055_source.html#l00068">68</a> of file <a class="el" href="a00055_source.html">navierstokes3d.h</a>.</p>

</div>
</div>
<a class="anchor" id="a6a44057228e5f4b86e1c4d04b2a28977"></a><!-- doxytag: member="navierstokes3d.h::_XDIR_" ref="a6a44057228e5f4b86e1c4d04b2a28977" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define _XDIR_&nbsp;&nbsp;&nbsp;0</td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>dimension corresponding to the <em>x</em> spatial dimension </p>

<p>Definition at line <a class="el" href="a00055_source.html#l00072">72</a> of file <a class="el" href="a00055_source.html">navierstokes3d.h</a>.</p>

</div>
</div>
<a class="anchor" id="a7fd32e06617f4489079bc50ce9bfc00c"></a><!-- doxytag: member="navierstokes3d.h::_YDIR_" ref="a7fd32e06617f4489079bc50ce9bfc00c" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define _YDIR_&nbsp;&nbsp;&nbsp;1</td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>dimension corresponding to the <em>y</em> spatial dimension </p>

<p>Definition at line <a class="el" href="a00055_source.html#l00074">74</a> of file <a class="el" href="a00055_source.html">navierstokes3d.h</a>.</p>

</div>
</div>
<a class="anchor" id="a227beecac6bef022707512c15d39e30b"></a><!-- doxytag: member="navierstokes3d.h::_ZDIR_" ref="a227beecac6bef022707512c15d39e30b" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define _ZDIR_&nbsp;&nbsp;&nbsp;2</td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>dimension corresponding to the <em>z</em> spatial dimension </p>

<p>Definition at line <a class="el" href="a00055_source.html#l00076">76</a> of file <a class="el" href="a00055_source.html">navierstokes3d.h</a>.</p>

</div>
</div>
<a class="anchor" id="a47cfbfdecf13cd3336cc049cfe93ed45"></a><!-- doxytag: member="navierstokes3d.h::_NavierStokes3DGetFlowVar_" ref="a47cfbfdecf13cd3336cc049cfe93ed45" args="(u, rho, vx, vy, vz, e, P, p)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define _NavierStokes3DGetFlowVar_</td>
          <td>(</td>
          <td class="paramtype">u, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">rho, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">vx, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">vy, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">vz, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="a00032.html#a35b3e91c83139b35bbacfaa59a58afd1">e</a>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">P, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">p&nbsp;</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<b>Value:</b><div class="fragment"><pre class="fragment">{ \
    <span class="keywordtype">double</span> gamma   = p-&gt;gamma, vsq; \
    rho = u[0]; \
    vx  = u[1] / rho; \
    vy  = u[2] / rho; \
    vz  = u[3] / rho; \
    <a class="code" href="a00032.html#a35b3e91c83139b35bbacfaa59a58afd1">e</a>   = u[4]; \
    vsq  = vx*vx + vy*vy + vz*vz; \
    P   = (<a class="code" href="a00032.html#a35b3e91c83139b35bbacfaa59a58afd1">e</a> - 0.5*rho*vsq) * (gamma-1.0); \
  }
</pre></div><p>Get the flow variables from the conserved solution vector. </p>
<p class="formulaDsp">
<img class="formulaDsp" alt="\begin{equation} {\bf u} = \left[\begin{array}{c} \rho \\ \rho u \\ \rho v \\ \rho w \\ e \end{array}\right] \end{equation}" src="form_66.png"/>
</p>
 
<p>Definition at line <a class="el" href="a00055_source.html#l00084">84</a> of file <a class="el" href="a00055_source.html">navierstokes3d.h</a>.</p>

</div>
</div>
<a class="anchor" id="afe0735e8f79bed00ed4461b173ed48b3"></a><!-- doxytag: member="navierstokes3d.h::_NavierStokes3DSetFlux_" ref="afe0735e8f79bed00ed4461b173ed48b3" args="(f, rho, vx, vy, vz, e, P, dir)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define _NavierStokes3DSetFlux_</td>
          <td>(</td>
          <td class="paramtype">f, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">rho, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">vx, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">vy, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">vz, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="a00032.html#a35b3e91c83139b35bbacfaa59a58afd1">e</a>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">P, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">dir&nbsp;</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<b>Value:</b><div class="fragment"><pre class="fragment">{ \
    <span class="keywordflow">if</span> (dir == <a class="code" href="a00047.html#a6a44057228e5f4b86e1c4d04b2a28977">_XDIR_</a>) { \
      f[0] = rho * vx; \
      f[1] = rho * vx * vx + P; \
      f[2] = rho * vx * vy; \
      f[3] = rho * vx * vz; \
      f[4] = (<a class="code" href="a00032.html#a35b3e91c83139b35bbacfaa59a58afd1">e</a> + P) * vx; \
    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (dir == <a class="code" href="a00048.html#a7fd32e06617f4489079bc50ce9bfc00c">_YDIR_</a>) { \
      f[0] = rho * vy; \
      f[1] = rho * vy * vx; \
      f[2] = rho * vy * vy + P; \
      f[3] = rho * vy * vz; \
      f[4] = (<a class="code" href="a00032.html#a35b3e91c83139b35bbacfaa59a58afd1">e</a> + P) * vy; \
    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (dir == <a class="code" href="a00055.html#a227beecac6bef022707512c15d39e30b">_ZDIR_</a>) { \
      f[0] = rho * vz; \
      f[1] = rho * vz * vx; \
      f[2] = rho * vz * vy; \
      f[3] = rho * vz * vz + P; \
      f[4] = (<a class="code" href="a00032.html#a35b3e91c83139b35bbacfaa59a58afd1">e</a> + P) * vz; \
    } \
  }
</pre></div><p>Compute the flux vector, given the flow variables </p>
<p class="formulaDsp">
<img class="formulaDsp" alt="\begin{eqnarray} dir = x, &amp; {\bf f}\left({\bf u}\right) = \left[\begin{array}{c} \rho u \\ \rho u^2 + p \\ \rho u v \\ \rho u w \\ (e+p)u \end{array}\right], \\ dir = y, &amp; {\bf f}\left({\bf u}\right) = \left[\begin{array}{c} \rho v \\ \rho u v \\ \rho v^2 + p \\ \rho v w \\ (e+p)v \end{array}\right], \\ dir = z, &amp; {\bf f}\left({\bf u}\right) = \left[\begin{array}{c} \rho w \\ \rho u w \\ \rho v w \\ \rho w^2 + p \\ (e+p)w \end{array}\right] \end{eqnarray}" src="form_67.png"/>
</p>
 
<p>Definition at line <a class="el" href="a00055_source.html#l00104">104</a> of file <a class="el" href="a00055_source.html">navierstokes3d.h</a>.</p>

</div>
</div>
<a class="anchor" id="ae40168fa87c0d4466425166ea6d17269"></a><!-- doxytag: member="navierstokes3d.h::_NavierStokes3DSetStiffFlux_" ref="ae40168fa87c0d4466425166ea6d17269" args="(f, rho, vx, vy, vz, e, P, dir, gamma)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define _NavierStokes3DSetStiffFlux_</td>
          <td>(</td>
          <td class="paramtype">f, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">rho, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">vx, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">vy, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">vz, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="a00032.html#a35b3e91c83139b35bbacfaa59a58afd1">e</a>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">P, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">dir, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">gamma&nbsp;</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<b>Value:</b><div class="fragment"><pre class="fragment">{ \
    <span class="keywordtype">double</span> gamma_inv = 1.0/gamma; \
    <span class="keywordflow">if</span> (dir == <a class="code" href="a00047.html#a6a44057228e5f4b86e1c4d04b2a28977">_XDIR_</a>) { \
      f[0] = gamma_inv * rho * vx; \
      f[1] = gamma_inv * rho * vx * vx + P; \
      f[2] = gamma_inv * rho * vx * vy; \
      f[3] = gamma_inv * rho * vx * vz; \
      f[4] = (<a class="code" href="a00032.html#a35b3e91c83139b35bbacfaa59a58afd1">e</a> + P) * vx - 0.5 * gamma_inv * (gamma-1.0) * rho * (vx*vx+vy*vy+vz*vz) * vx; \
    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (dir == <a class="code" href="a00048.html#a7fd32e06617f4489079bc50ce9bfc00c">_YDIR_</a>) { \
      f[0] = gamma_inv * rho * vy; \
      f[1] = gamma_inv * rho * vy * vx; \
      f[2] = gamma_inv * rho * vy * vy + P; \
      f[3] = gamma_inv * rho * vy * vz; \
      f[4] = (<a class="code" href="a00032.html#a35b3e91c83139b35bbacfaa59a58afd1">e</a> + P) * vy - 0.5 * gamma_inv * (gamma-1.0) * rho * (vx*vx+vy*vy+vz*vz) * vy; \
    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (dir == <a class="code" href="a00055.html#a227beecac6bef022707512c15d39e30b">_ZDIR_</a>) { \
      f[0] = gamma_inv * rho * vz; \
      f[1] = gamma_inv * rho * vz * vx; \
      f[2] = gamma_inv * rho * vz * vy; \
      f[3] = gamma_inv * rho * vz * vz + P; \
      f[4] = (<a class="code" href="a00032.html#a35b3e91c83139b35bbacfaa59a58afd1">e</a> + P) * vz - 0.5 * gamma_inv * (gamma-1.0) * rho * (vx*vx+vy*vy+vz*vz) * vz; \
    } \
  }
</pre></div><p>Compute the stiff flux vector (comprising the acoustic modes only), given the flow variables </p>
<p class="formulaDsp">
<img class="formulaDsp" alt="\begin{eqnarray} dir = x, &amp; {\bf f}\left({\bf u}\right) = \left[\begin{array}{c} \frac{1}{\gamma}\rho u \\ \frac{1}{\gamma}\rho u^2 + p \\ \frac{1}{\gamma}\rho u v \\ \frac{1}{\gamma}\rho u w \\ (e+p)u - \frac{1}{2} \frac{\gamma-1}{\gamma}\rho\left(u^2+v^2+w^2\right)u \end{array}\right], \\ dir = y, &amp; {\bf f}\left({\bf u}\right) = \left[\begin{array}{c} \frac{1}{\gamma}\rho v \\ \frac{1}{\gamma}\rho u v \\ \frac{1}{\gamma}\rho v^2 + p \\ \frac{1}{\gamma}\rho v w \\ (e+p)v - \frac{1}{2} \frac{\gamma-1}{\gamma}\rho\left(u^2+v^2+w^2\right)v \end{array}\right], \\ dir = z, &amp; {\bf f}\left({\bf u}\right) = \left[\begin{array}{c} \frac{1}{\gamma}\rho w \\ \frac{1}{\gamma}\rho u w \\ \frac{1}{\gamma}\rho v w \\ \frac{1}{\gamma}\rho w^2 + p \\ (e+p)w - \frac{1}{2} \frac{\gamma-1}{\gamma}\rho\left(u^2+v^2+w^2\right)w \end{array}\right], \\ \end{eqnarray}" src="form_68.png"/>
</p>
<p> Reference: + Ghosh, D., Constantinescu, E. M., Semi-Implicit Time Integration of Atmospheric Flows with Characteristic-Based Flux Partitioning, SIAM Journal on Scientific Computing, 38 (3), 2016, A1848-A1875, <a href="http://dx.doi.org/10.1137/15M1044369.">http://dx.doi.org/10.1137/15M1044369.</a> </p>

<p>Definition at line <a class="el" href="a00055_source.html#l00139">139</a> of file <a class="el" href="a00055_source.html">navierstokes3d.h</a>.</p>

</div>
</div>
<a class="anchor" id="af732c2201acf769c741833a401dc54cb"></a><!-- doxytag: member="navierstokes3d.h::_NavierStokes3DSetNonStiffFlux_" ref="af732c2201acf769c741833a401dc54cb" args="(f, rho, vx, vy, vz, e, P, dir, gamma)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define _NavierStokes3DSetNonStiffFlux_</td>
          <td>(</td>
          <td class="paramtype">f, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">rho, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">vx, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">vy, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">vz, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="a00032.html#a35b3e91c83139b35bbacfaa59a58afd1">e</a>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">P, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">dir, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">gamma&nbsp;</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<b>Value:</b><div class="fragment"><pre class="fragment">{ \
    <span class="keywordtype">double</span> gamma_inv = 1.0/gamma; \
    <span class="keywordflow">if</span> (dir == <a class="code" href="a00047.html#a6a44057228e5f4b86e1c4d04b2a28977">_XDIR_</a>) { \
      f[0] = (gamma-1.0) * gamma_inv * rho * vx; \
      f[1] = (gamma-1.0) * gamma_inv * rho * vx * vx; \
      f[2] = (gamma-1.0) * gamma_inv * rho * vx * vy; \
      f[3] = (gamma-1.0) * gamma_inv * rho * vx * vz; \
      f[4] = 0.5 * gamma_inv * (gamma-1.0) * rho * (vx*vx+vy*vy+vz*vz) * vx; \
    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (dir == <a class="code" href="a00048.html#a7fd32e06617f4489079bc50ce9bfc00c">_YDIR_</a>) { \
      f[0] = (gamma-1.0) * gamma_inv * rho * vy; \
      f[1] = (gamma-1.0) * gamma_inv * rho * vy * vx; \
      f[2] = (gamma-1.0) * gamma_inv * rho * vy * vy; \
      f[3] = (gamma-1.0) * gamma_inv * rho * vy * vz; \
      f[4] = 0.5 * gamma_inv * (gamma-1.0) * rho * (vx*vx+vy*vy+vz*vz) * vy; \
    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (dir == <a class="code" href="a00055.html#a227beecac6bef022707512c15d39e30b">_ZDIR_</a>) { \
      f[0] = (gamma-1.0) * gamma_inv * rho * vz; \
      f[1] = (gamma-1.0) * gamma_inv * rho * vz * vx; \
      f[2] = (gamma-1.0) * gamma_inv * rho * vz * vy; \
      f[3] = (gamma-1.0) * gamma_inv * rho * vz * vz; \
      f[4] = 0.5 * gamma_inv * (gamma-1.0) * rho * (vx*vx+vy*vy+vz*vz) * vz; \
    } \
  }
</pre></div><p>Compute the non-stiff flux vector (comprising the entropy modes only), given the flow variables </p>
<p class="formulaDsp">
<img class="formulaDsp" alt="\begin{eqnarray} dir = x, &amp; {\bf f}\left({\bf u}\right) = \left[\begin{array}{c} \frac{\gamma-1}{\gamma}\rho u \\ \frac{\gamma-1}{\gamma}\rho u^2 \\ \frac{\gamma-11}{\gamma}\rho u v \\ \frac{\gamma-1}{\gamma}\rho u w \\ \frac{1}{2} \frac{\gamma-1}{\gamma}\rho\left(u^2+v^2+w^2\right)u \end{array}\right], \\ dir = y, &amp; {\bf f}\left({\bf u}\right) = \left[\begin{array}{c} \frac{\gamma-1}{\gamma}\rho v \\ \frac{\gamma-1}{\gamma}\rho u v \\ \frac{\gamma-1}{\gamma}\rho v^2 \\ \frac{\gamma-1}{\gamma}\rho v w \\ \frac{1}{2} \frac{\gamma-1}{\gamma}\rho\left(u^2+v^2+w^2\right)v \end{array}\right], \\ dir = z, &amp; {\bf f}\left({\bf u}\right) = \left[\begin{array}{c} \frac{\gamma-1}{\gamma}\rho w \\ \frac{\gamma-1}{\gamma}\rho u w \\ \frac{\gamma-1}{\gamma}\rho v w \\ \frac{\gamma-1}{\gamma}\rho w^2 \\ \frac{1}{2} \frac{\gamma-1}{\gamma}\rho\left(u^2+v^2+w^2\right)w \end{array}\right], \\ \end{eqnarray}" src="form_69.png"/>
</p>
<p> Reference: + Ghosh, D., Constantinescu, E. M., Semi-Implicit Time Integration of Atmospheric Flows with Characteristic-Based Flux Partitioning, SIAM Journal on Scientific Computing, 38 (3), 2016, A1848-A1875, <a href="http://dx.doi.org/10.1137/15M1044369.">http://dx.doi.org/10.1137/15M1044369.</a> </p>

<p>Definition at line <a class="el" href="a00055_source.html#l00175">175</a> of file <a class="el" href="a00055_source.html">navierstokes3d.h</a>.</p>

</div>
</div>
<a class="anchor" id="acb34fead87ef529f7f9efdc21cf0c585"></a><!-- doxytag: member="navierstokes3d.h::_NavierStokes3DRoeAverage_" ref="acb34fead87ef529f7f9efdc21cf0c585" args="(uavg, uL, uR, p)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define _NavierStokes3DRoeAverage_</td>
          <td>(</td>
          <td class="paramtype">uavg, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uL, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uR, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">p&nbsp;</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<b>Value:</b><div class="fragment"><pre class="fragment">{ \
    <span class="keywordtype">double</span>  rho ,vx, vy, vz, <a class="code" href="a00032.html#a35b3e91c83139b35bbacfaa59a58afd1">e</a> ,P ,H; \
    <span class="keywordtype">double</span>  rhoL,vxL,vyL,vzL,eL,PL,HL,cLsq; \
    <span class="keywordtype">double</span>  rhoR,vxR,vyR,vzR,eR,PR,HR,cRsq; \
    <span class="keywordtype">double</span>  gamma = p-&gt;gamma; \
    <a class="code" href="a00055.html#a47cfbfdecf13cd3336cc049cfe93ed45">_NavierStokes3DGetFlowVar_</a>(uL,rhoL,vxL,vyL,vzL,eL,PL,p); \
    cLsq = gamma * PL/rhoL; \
    HL = 0.5*(vxL*vxL+vyL*vyL+vzL*vzL) + cLsq / (gamma-1.0); \
    <a class="code" href="a00055.html#a47cfbfdecf13cd3336cc049cfe93ed45">_NavierStokes3DGetFlowVar_</a>(uR,rhoR,vxR,vyR,vzR,eR,PR,p); \
    cRsq = gamma * PR/rhoR; \
    HR = 0.5*(vxR*vxR+vyR*vyR+vzR*vzR) + cRsq / (gamma-1.0); \
    <span class="keywordtype">double</span> tL = sqrt(rhoL); \
    <span class="keywordtype">double</span> tR = sqrt(rhoR); \
    rho = tL * tR; \
    vx  = (tL*vxL + tR*vxR) / (tL + tR); \
    vy  = (tL*vyL + tR*vyR) / (tL + tR); \
    vz  = (tL*vzL + tR*vzR) / (tL + tR); \
    H   = (tL*HL  + tR*HR ) / (tL + tR); \
    P = (H - 0.5* (vx*vx+vy*vy+vz*vz)) * (rho*(gamma-1.0))/gamma; \
    e   = P/(gamma-1.0) + 0.5*rho*(vx*vx+vy*vy+vz*vz); \
    uavg[0] = rho; \
    uavg[1] = rho*vx; \
    uavg[2] = rho*vy; \
    uavg[3] = rho*vz; \
    uavg[4] = e; \
  }
</pre></div><p>Compute the Roe-average of two solutions. </p>

<p>Definition at line <a class="el" href="a00055_source.html#l00202">202</a> of file <a class="el" href="a00055_source.html">navierstokes3d.h</a>.</p>

</div>
</div>
<a class="anchor" id="a147b6aba2ceb349155d1fd74807677bd"></a><!-- doxytag: member="navierstokes3d.h::_NavierStokes3DEigenvalues_" ref="a147b6aba2ceb349155d1fd74807677bd" args="(u, D, p, dir)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define _NavierStokes3DEigenvalues_</td>
          <td>(</td>
          <td class="paramtype">u, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="a00031.html#add034d002483743ecf892648b0a4b6cc">D</a>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">p, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">dir&nbsp;</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<b>Value:</b><div class="fragment"><pre class="fragment">{ \
    <span class="keywordtype">double</span>          gamma   = p-&gt;gamma; \
    <span class="keywordtype">double</span>          rho,vx,vy,vz,<a class="code" href="a00032.html#a35b3e91c83139b35bbacfaa59a58afd1">e</a>,P,c; \
    <a class="code" href="a00055.html#a47cfbfdecf13cd3336cc049cfe93ed45">_NavierStokes3DGetFlowVar_</a>(u,rho,vx,vy,vz,e,P,p); \
    c    = sqrt(gamma*P/rho); \
    <span class="keywordflow">if</span> (dir == <a class="code" href="a00047.html#a6a44057228e5f4b86e1c4d04b2a28977">_XDIR_</a>) { \
      <a class="code" href="a00031.html#add034d002483743ecf892648b0a4b6cc">D</a>[0*<a class="code" href="a00047.html#ad3395a55a5fde64d6603c7a82d7bf2c7">_MODEL_NVARS_</a>+0] = vx;     <a class="code" href="a00031.html#add034d002483743ecf892648b0a4b6cc">D</a>[0*<a class="code" href="a00047.html#ad3395a55a5fde64d6603c7a82d7bf2c7">_MODEL_NVARS_</a>+1] = 0;    <a class="code" href="a00031.html#add034d002483743ecf892648b0a4b6cc">D</a>[0*<a class="code" href="a00047.html#ad3395a55a5fde64d6603c7a82d7bf2c7">_MODEL_NVARS_</a>+2] = 0;      <a class="code" href="a00031.html#add034d002483743ecf892648b0a4b6cc">D</a>[0*<a class="code" href="a00047.html#ad3395a55a5fde64d6603c7a82d7bf2c7">_MODEL_NVARS_</a>+3] = 0;    <a class="code" href="a00031.html#add034d002483743ecf892648b0a4b6cc">D</a>[0*<a class="code" href="a00047.html#ad3395a55a5fde64d6603c7a82d7bf2c7">_MODEL_NVARS_</a>+4] = 0; \
      <a class="code" href="a00031.html#add034d002483743ecf892648b0a4b6cc">D</a>[1*<a class="code" href="a00047.html#ad3395a55a5fde64d6603c7a82d7bf2c7">_MODEL_NVARS_</a>+0] = 0;      <a class="code" href="a00031.html#add034d002483743ecf892648b0a4b6cc">D</a>[1*<a class="code" href="a00047.html#ad3395a55a5fde64d6603c7a82d7bf2c7">_MODEL_NVARS_</a>+1] = vx-c; <a class="code" href="a00031.html#add034d002483743ecf892648b0a4b6cc">D</a>[1*<a class="code" href="a00047.html#ad3395a55a5fde64d6603c7a82d7bf2c7">_MODEL_NVARS_</a>+2] = 0;      <a class="code" href="a00031.html#add034d002483743ecf892648b0a4b6cc">D</a>[1*<a class="code" href="a00047.html#ad3395a55a5fde64d6603c7a82d7bf2c7">_MODEL_NVARS_</a>+3] = 0;    <a class="code" href="a00031.html#add034d002483743ecf892648b0a4b6cc">D</a>[1*<a class="code" href="a00047.html#ad3395a55a5fde64d6603c7a82d7bf2c7">_MODEL_NVARS_</a>+4] = 0; \
      <a class="code" href="a00031.html#add034d002483743ecf892648b0a4b6cc">D</a>[2*<a class="code" href="a00047.html#ad3395a55a5fde64d6603c7a82d7bf2c7">_MODEL_NVARS_</a>+0] = 0;      <a class="code" href="a00031.html#add034d002483743ecf892648b0a4b6cc">D</a>[2*<a class="code" href="a00047.html#ad3395a55a5fde64d6603c7a82d7bf2c7">_MODEL_NVARS_</a>+1] = 0;    <a class="code" href="a00031.html#add034d002483743ecf892648b0a4b6cc">D</a>[2*<a class="code" href="a00047.html#ad3395a55a5fde64d6603c7a82d7bf2c7">_MODEL_NVARS_</a>+2] = vx;     <a class="code" href="a00031.html#add034d002483743ecf892648b0a4b6cc">D</a>[2*<a class="code" href="a00047.html#ad3395a55a5fde64d6603c7a82d7bf2c7">_MODEL_NVARS_</a>+3] = 0;    <a class="code" href="a00031.html#add034d002483743ecf892648b0a4b6cc">D</a>[2*<a class="code" href="a00047.html#ad3395a55a5fde64d6603c7a82d7bf2c7">_MODEL_NVARS_</a>+4] = 0; \
      <a class="code" href="a00031.html#add034d002483743ecf892648b0a4b6cc">D</a>[3*<a class="code" href="a00047.html#ad3395a55a5fde64d6603c7a82d7bf2c7">_MODEL_NVARS_</a>+0] = 0;      <a class="code" href="a00031.html#add034d002483743ecf892648b0a4b6cc">D</a>[3*<a class="code" href="a00047.html#ad3395a55a5fde64d6603c7a82d7bf2c7">_MODEL_NVARS_</a>+1] = 0;    <a class="code" href="a00031.html#add034d002483743ecf892648b0a4b6cc">D</a>[3*<a class="code" href="a00047.html#ad3395a55a5fde64d6603c7a82d7bf2c7">_MODEL_NVARS_</a>+2] = 0;      <a class="code" href="a00031.html#add034d002483743ecf892648b0a4b6cc">D</a>[3*<a class="code" href="a00047.html#ad3395a55a5fde64d6603c7a82d7bf2c7">_MODEL_NVARS_</a>+3] = vx;   <a class="code" href="a00031.html#add034d002483743ecf892648b0a4b6cc">D</a>[3*<a class="code" href="a00047.html#ad3395a55a5fde64d6603c7a82d7bf2c7">_MODEL_NVARS_</a>+4] = 0; \
      <a class="code" href="a00031.html#add034d002483743ecf892648b0a4b6cc">D</a>[4*<a class="code" href="a00047.html#ad3395a55a5fde64d6603c7a82d7bf2c7">_MODEL_NVARS_</a>+0] = 0;      <a class="code" href="a00031.html#add034d002483743ecf892648b0a4b6cc">D</a>[4*<a class="code" href="a00047.html#ad3395a55a5fde64d6603c7a82d7bf2c7">_MODEL_NVARS_</a>+1] = 0;    <a class="code" href="a00031.html#add034d002483743ecf892648b0a4b6cc">D</a>[4*<a class="code" href="a00047.html#ad3395a55a5fde64d6603c7a82d7bf2c7">_MODEL_NVARS_</a>+2] = 0;      <a class="code" href="a00031.html#add034d002483743ecf892648b0a4b6cc">D</a>[4*<a class="code" href="a00047.html#ad3395a55a5fde64d6603c7a82d7bf2c7">_MODEL_NVARS_</a>+3] = 0;    <a class="code" href="a00031.html#add034d002483743ecf892648b0a4b6cc">D</a>[4*<a class="code" href="a00047.html#ad3395a55a5fde64d6603c7a82d7bf2c7">_MODEL_NVARS_</a>+4] = vx+c;\
    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (dir == <a class="code" href="a00048.html#a7fd32e06617f4489079bc50ce9bfc00c">_YDIR_</a>) { \
      <a class="code" href="a00031.html#add034d002483743ecf892648b0a4b6cc">D</a>[0*<a class="code" href="a00047.html#ad3395a55a5fde64d6603c7a82d7bf2c7">_MODEL_NVARS_</a>+0] = vy;     <a class="code" href="a00031.html#add034d002483743ecf892648b0a4b6cc">D</a>[0*<a class="code" href="a00047.html#ad3395a55a5fde64d6603c7a82d7bf2c7">_MODEL_NVARS_</a>+1] = 0;    <a class="code" href="a00031.html#add034d002483743ecf892648b0a4b6cc">D</a>[0*<a class="code" href="a00047.html#ad3395a55a5fde64d6603c7a82d7bf2c7">_MODEL_NVARS_</a>+2] = 0;      <a class="code" href="a00031.html#add034d002483743ecf892648b0a4b6cc">D</a>[0*<a class="code" href="a00047.html#ad3395a55a5fde64d6603c7a82d7bf2c7">_MODEL_NVARS_</a>+3] = 0;    <a class="code" href="a00031.html#add034d002483743ecf892648b0a4b6cc">D</a>[0*<a class="code" href="a00047.html#ad3395a55a5fde64d6603c7a82d7bf2c7">_MODEL_NVARS_</a>+4] = 0; \
      <a class="code" href="a00031.html#add034d002483743ecf892648b0a4b6cc">D</a>[1*<a class="code" href="a00047.html#ad3395a55a5fde64d6603c7a82d7bf2c7">_MODEL_NVARS_</a>+0] = 0;      <a class="code" href="a00031.html#add034d002483743ecf892648b0a4b6cc">D</a>[1*<a class="code" href="a00047.html#ad3395a55a5fde64d6603c7a82d7bf2c7">_MODEL_NVARS_</a>+1] = vy;   <a class="code" href="a00031.html#add034d002483743ecf892648b0a4b6cc">D</a>[1*<a class="code" href="a00047.html#ad3395a55a5fde64d6603c7a82d7bf2c7">_MODEL_NVARS_</a>+2] = 0;      <a class="code" href="a00031.html#add034d002483743ecf892648b0a4b6cc">D</a>[1*<a class="code" href="a00047.html#ad3395a55a5fde64d6603c7a82d7bf2c7">_MODEL_NVARS_</a>+3] = 0;    <a class="code" href="a00031.html#add034d002483743ecf892648b0a4b6cc">D</a>[1*<a class="code" href="a00047.html#ad3395a55a5fde64d6603c7a82d7bf2c7">_MODEL_NVARS_</a>+4] = 0; \
      <a class="code" href="a00031.html#add034d002483743ecf892648b0a4b6cc">D</a>[2*<a class="code" href="a00047.html#ad3395a55a5fde64d6603c7a82d7bf2c7">_MODEL_NVARS_</a>+0] = 0;      <a class="code" href="a00031.html#add034d002483743ecf892648b0a4b6cc">D</a>[2*<a class="code" href="a00047.html#ad3395a55a5fde64d6603c7a82d7bf2c7">_MODEL_NVARS_</a>+1] = 0;    <a class="code" href="a00031.html#add034d002483743ecf892648b0a4b6cc">D</a>[2*<a class="code" href="a00047.html#ad3395a55a5fde64d6603c7a82d7bf2c7">_MODEL_NVARS_</a>+2] = vy-c;   <a class="code" href="a00031.html#add034d002483743ecf892648b0a4b6cc">D</a>[2*<a class="code" href="a00047.html#ad3395a55a5fde64d6603c7a82d7bf2c7">_MODEL_NVARS_</a>+3] = 0;    <a class="code" href="a00031.html#add034d002483743ecf892648b0a4b6cc">D</a>[2*<a class="code" href="a00047.html#ad3395a55a5fde64d6603c7a82d7bf2c7">_MODEL_NVARS_</a>+4] = 0; \
      <a class="code" href="a00031.html#add034d002483743ecf892648b0a4b6cc">D</a>[3*<a class="code" href="a00047.html#ad3395a55a5fde64d6603c7a82d7bf2c7">_MODEL_NVARS_</a>+0] = 0;      <a class="code" href="a00031.html#add034d002483743ecf892648b0a4b6cc">D</a>[3*<a class="code" href="a00047.html#ad3395a55a5fde64d6603c7a82d7bf2c7">_MODEL_NVARS_</a>+1] = 0;    <a class="code" href="a00031.html#add034d002483743ecf892648b0a4b6cc">D</a>[3*<a class="code" href="a00047.html#ad3395a55a5fde64d6603c7a82d7bf2c7">_MODEL_NVARS_</a>+2] = 0;      <a class="code" href="a00031.html#add034d002483743ecf892648b0a4b6cc">D</a>[3*<a class="code" href="a00047.html#ad3395a55a5fde64d6603c7a82d7bf2c7">_MODEL_NVARS_</a>+3] = vy;   <a class="code" href="a00031.html#add034d002483743ecf892648b0a4b6cc">D</a>[3*<a class="code" href="a00047.html#ad3395a55a5fde64d6603c7a82d7bf2c7">_MODEL_NVARS_</a>+4] = 0; \
      <a class="code" href="a00031.html#add034d002483743ecf892648b0a4b6cc">D</a>[4*<a class="code" href="a00047.html#ad3395a55a5fde64d6603c7a82d7bf2c7">_MODEL_NVARS_</a>+0] = 0;      <a class="code" href="a00031.html#add034d002483743ecf892648b0a4b6cc">D</a>[4*<a class="code" href="a00047.html#ad3395a55a5fde64d6603c7a82d7bf2c7">_MODEL_NVARS_</a>+1] = 0;    <a class="code" href="a00031.html#add034d002483743ecf892648b0a4b6cc">D</a>[4*<a class="code" href="a00047.html#ad3395a55a5fde64d6603c7a82d7bf2c7">_MODEL_NVARS_</a>+2] = 0;      <a class="code" href="a00031.html#add034d002483743ecf892648b0a4b6cc">D</a>[4*<a class="code" href="a00047.html#ad3395a55a5fde64d6603c7a82d7bf2c7">_MODEL_NVARS_</a>+3] = 0;    <a class="code" href="a00031.html#add034d002483743ecf892648b0a4b6cc">D</a>[4*<a class="code" href="a00047.html#ad3395a55a5fde64d6603c7a82d7bf2c7">_MODEL_NVARS_</a>+4] = vy+c;\
    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (dir == <a class="code" href="a00055.html#a227beecac6bef022707512c15d39e30b">_ZDIR_</a>) { \
      <a class="code" href="a00031.html#add034d002483743ecf892648b0a4b6cc">D</a>[0*<a class="code" href="a00047.html#ad3395a55a5fde64d6603c7a82d7bf2c7">_MODEL_NVARS_</a>+0] = vz;     <a class="code" href="a00031.html#add034d002483743ecf892648b0a4b6cc">D</a>[0*<a class="code" href="a00047.html#ad3395a55a5fde64d6603c7a82d7bf2c7">_MODEL_NVARS_</a>+1] = 0;    <a class="code" href="a00031.html#add034d002483743ecf892648b0a4b6cc">D</a>[0*<a class="code" href="a00047.html#ad3395a55a5fde64d6603c7a82d7bf2c7">_MODEL_NVARS_</a>+2] = 0;      <a class="code" href="a00031.html#add034d002483743ecf892648b0a4b6cc">D</a>[0*<a class="code" href="a00047.html#ad3395a55a5fde64d6603c7a82d7bf2c7">_MODEL_NVARS_</a>+3] = 0;    <a class="code" href="a00031.html#add034d002483743ecf892648b0a4b6cc">D</a>[0*<a class="code" href="a00047.html#ad3395a55a5fde64d6603c7a82d7bf2c7">_MODEL_NVARS_</a>+4] = 0; \
      <a class="code" href="a00031.html#add034d002483743ecf892648b0a4b6cc">D</a>[1*<a class="code" href="a00047.html#ad3395a55a5fde64d6603c7a82d7bf2c7">_MODEL_NVARS_</a>+0] = 0;      <a class="code" href="a00031.html#add034d002483743ecf892648b0a4b6cc">D</a>[1*<a class="code" href="a00047.html#ad3395a55a5fde64d6603c7a82d7bf2c7">_MODEL_NVARS_</a>+1] = vz;   <a class="code" href="a00031.html#add034d002483743ecf892648b0a4b6cc">D</a>[1*<a class="code" href="a00047.html#ad3395a55a5fde64d6603c7a82d7bf2c7">_MODEL_NVARS_</a>+2] = 0;      <a class="code" href="a00031.html#add034d002483743ecf892648b0a4b6cc">D</a>[1*<a class="code" href="a00047.html#ad3395a55a5fde64d6603c7a82d7bf2c7">_MODEL_NVARS_</a>+3] = 0;    <a class="code" href="a00031.html#add034d002483743ecf892648b0a4b6cc">D</a>[1*<a class="code" href="a00047.html#ad3395a55a5fde64d6603c7a82d7bf2c7">_MODEL_NVARS_</a>+4] = 0; \
      <a class="code" href="a00031.html#add034d002483743ecf892648b0a4b6cc">D</a>[2*<a class="code" href="a00047.html#ad3395a55a5fde64d6603c7a82d7bf2c7">_MODEL_NVARS_</a>+0] = 0;      <a class="code" href="a00031.html#add034d002483743ecf892648b0a4b6cc">D</a>[2*<a class="code" href="a00047.html#ad3395a55a5fde64d6603c7a82d7bf2c7">_MODEL_NVARS_</a>+1] = 0;    <a class="code" href="a00031.html#add034d002483743ecf892648b0a4b6cc">D</a>[2*<a class="code" href="a00047.html#ad3395a55a5fde64d6603c7a82d7bf2c7">_MODEL_NVARS_</a>+2] = vz;     <a class="code" href="a00031.html#add034d002483743ecf892648b0a4b6cc">D</a>[2*<a class="code" href="a00047.html#ad3395a55a5fde64d6603c7a82d7bf2c7">_MODEL_NVARS_</a>+3] = 0;    <a class="code" href="a00031.html#add034d002483743ecf892648b0a4b6cc">D</a>[2*<a class="code" href="a00047.html#ad3395a55a5fde64d6603c7a82d7bf2c7">_MODEL_NVARS_</a>+4] = 0; \
      <a class="code" href="a00031.html#add034d002483743ecf892648b0a4b6cc">D</a>[3*<a class="code" href="a00047.html#ad3395a55a5fde64d6603c7a82d7bf2c7">_MODEL_NVARS_</a>+0] = 0;      <a class="code" href="a00031.html#add034d002483743ecf892648b0a4b6cc">D</a>[3*<a class="code" href="a00047.html#ad3395a55a5fde64d6603c7a82d7bf2c7">_MODEL_NVARS_</a>+1] = 0;    <a class="code" href="a00031.html#add034d002483743ecf892648b0a4b6cc">D</a>[3*<a class="code" href="a00047.html#ad3395a55a5fde64d6603c7a82d7bf2c7">_MODEL_NVARS_</a>+2] = 0;      <a class="code" href="a00031.html#add034d002483743ecf892648b0a4b6cc">D</a>[3*<a class="code" href="a00047.html#ad3395a55a5fde64d6603c7a82d7bf2c7">_MODEL_NVARS_</a>+3] = vz-c; <a class="code" href="a00031.html#add034d002483743ecf892648b0a4b6cc">D</a>[3*<a class="code" href="a00047.html#ad3395a55a5fde64d6603c7a82d7bf2c7">_MODEL_NVARS_</a>+4] = 0; \
      <a class="code" href="a00031.html#add034d002483743ecf892648b0a4b6cc">D</a>[4*<a class="code" href="a00047.html#ad3395a55a5fde64d6603c7a82d7bf2c7">_MODEL_NVARS_</a>+0] = 0;      <a class="code" href="a00031.html#add034d002483743ecf892648b0a4b6cc">D</a>[4*<a class="code" href="a00047.html#ad3395a55a5fde64d6603c7a82d7bf2c7">_MODEL_NVARS_</a>+1] = 0;    <a class="code" href="a00031.html#add034d002483743ecf892648b0a4b6cc">D</a>[4*<a class="code" href="a00047.html#ad3395a55a5fde64d6603c7a82d7bf2c7">_MODEL_NVARS_</a>+2] = 0;      <a class="code" href="a00031.html#add034d002483743ecf892648b0a4b6cc">D</a>[4*<a class="code" href="a00047.html#ad3395a55a5fde64d6603c7a82d7bf2c7">_MODEL_NVARS_</a>+3] = 0;    <a class="code" href="a00031.html#add034d002483743ecf892648b0a4b6cc">D</a>[4*<a class="code" href="a00047.html#ad3395a55a5fde64d6603c7a82d7bf2c7">_MODEL_NVARS_</a>+4] = vz+c;\
    } \
  }
</pre></div><p>Compute the eigenvalues, given a solution vector in terms of the conserved variables. The eigenvalues are returned as a matrix D whose diagonal values are the eigenvalues. Admittedly, this is inefficient. The matrix D is stored in a row-major format.</p>
<p>The eigenvalues are <img class="formulaInl" alt="$ {\bf v}\cdot\hat{\bf n}, {\bf v}\cdot\hat{\bf n}, {\bf v}\cdot\hat{\bf n}, {\bf v}\cdot\hat{\bf n} \pm c$" src="form_70.png"/> where <img class="formulaInl" alt="${\bf v} = u\hat{\bf i} + v\hat{\bf j} + w\hat{\bf k}$" src="form_71.png"/> is the velocity vector, <img class="formulaInl" alt="$\hat{\bf n} = \hat{\bf i}, \hat{\bf j}, \hat{\bf k}$" src="form_72.png"/> is the unit vector along the spatial dimension, and <img class="formulaInl" alt="$c$" src="form_73.png"/> is the speed of sound. <b>Note</b> that the order of the eigenvalues (and therefore, the order of the eigenvectors in <a class="el" href="a00055.html#ab38778016784c1a6aeadbbf41d0e07ce">_NavierStokes3DLeftEigenvectors_</a> and <a class="el" href="a00055.html#a79a3562dd840ea39718f3c5993e65e45">_NavierStokes3DRightEigenvectors_</a> has been chosen to avoid left eigen-matrices with zero on the diagonals. </p>

<p>Definition at line <a class="el" href="a00055_source.html#l00241">241</a> of file <a class="el" href="a00055_source.html">navierstokes3d.h</a>.</p>

</div>
</div>
<a class="anchor" id="ab38778016784c1a6aeadbbf41d0e07ce"></a><!-- doxytag: member="navierstokes3d.h::_NavierStokes3DLeftEigenvectors_" ref="ab38778016784c1a6aeadbbf41d0e07ce" args="(u, L, p, dir)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define _NavierStokes3DLeftEigenvectors_</td>
          <td>(</td>
          <td class="paramtype">u, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">L, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">p, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">dir&nbsp;</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Compute the left eigenvectors, given a solution vector in terms of the conserved variables. The eigenvectors are returned as a matrix L whose rows correspond to each eigenvector. The matrix L is stored in the row-major format. <br/>
<br/>
 Reference: + Rohde, "Eigenvalues and eigenvectors of the Euler equations in general geometries", AIAA Paper 2001-2609, <a href="http://dx.doi.org/10.2514/6.2001-2609">http://dx.doi.org/10.2514/6.2001-2609</a> </p>

<p>Definition at line <a class="el" href="a00055_source.html#l00276">276</a> of file <a class="el" href="a00055_source.html">navierstokes3d.h</a>.</p>

</div>
</div>
<a class="anchor" id="a79a3562dd840ea39718f3c5993e65e45"></a><!-- doxytag: member="navierstokes3d.h::_NavierStokes3DRightEigenvectors_" ref="a79a3562dd840ea39718f3c5993e65e45" args="(u, R, p, dir)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define _NavierStokes3DRightEigenvectors_</td>
          <td>(</td>
          <td class="paramtype">u, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">R, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">p, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">dir&nbsp;</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Compute the right eigenvectors, given a solution vector in terms of the conserved variables. The eigenvectors are returned as a matrix R whose columns correspond to each eigenvector. The matrix R is stored in the row-major format. <br/>
<br/>
 Reference: + Rohde, "Eigenvalues and eigenvectors of the Euler equations in general geometries", AIAA Paper 2001-2609, <a href="http://dx.doi.org/10.2514/6.2001-2609">http://dx.doi.org/10.2514/6.2001-2609</a> </p>

<p>Definition at line <a class="el" href="a00055_source.html#l00372">372</a> of file <a class="el" href="a00055_source.html">navierstokes3d.h</a>.</p>

</div>
</div>
<hr/><h2>Function Documentation</h2>
<a class="anchor" id="a0385acf3caf014aa7491ad2fc6a9572a"></a><!-- doxytag: member="navierstokes3d.h::NavierStokes3DInitialize" ref="a0385acf3caf014aa7491ad2fc6a9572a" args="(void *, void *)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int NavierStokes3DInitialize </td>
          <td>(</td>
          <td class="paramtype">void *&nbsp;</td>
          <td class="paramname"> <em>s</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&nbsp;</td>
          <td class="paramname"> <em>m</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Initialize the 3D Navier-Stokes (<a class="el" href="a00022.html" title="Structure containing variables and parameters specific to the 3D Navier Stokes equations...">NavierStokes3D</a>) module: Sets the default parameters, read in and set physics-related parameters, and set the physics-related function pointers in <a class="el" href="a00015.html" title="Structure containing all solver-specific variables and functions.">HyPar</a>.</p>
<p>This file reads the file "physics.inp" that must have the following format:</p>
<p>begin &lt;keyword&gt; </p>
<p>&lt;keyword&gt; </p>
<p>&lt;keyword&gt; </p>
<p>... &lt;keyword&gt; </p>
<p>end</p>
<p>where the list of keywords are:</p>
<p>Keyword name | Type | Variable | Default value ------------------ | -------------------- | ----------------------------------------------------------------------- | ------------------------ gamma | double | <a class="el" href="a00022.html#a72f9e01745b3a8203067ab84aefc9aea">NavierStokes3D::gamma</a> | 1.4 Pr | double | <a class="el" href="a00022.html#af0f6e03342b9eb912e25f94ce0249a2c">NavierStokes3D::Pr</a> | 0.72 Re | double | <a class="el" href="a00022.html#a3b92a4b98cedf64473b3c13dfa7674b4">NavierStokes3D::Re</a> | -1 Minf | double | <a class="el" href="a00022.html#aa5f774fe7b4f69be5e085f1988ef2a6d">NavierStokes3D::Minf</a> | 1.0 gravity | double,double,double | <a class="el" href="a00022.html#aaccb5cbe710523019e8615b49383fea1">NavierStokes3D::grav_x</a>,<a class="el" href="a00022.html#adf08e308b453bd2d4e117576e493ed03">NavierStokes3D::grav_y</a>,<a class="el" href="a00022.html#a320ec93c1b9ba874a2e334d5543f0e54">NavierStokes3D::grav_z</a> | 0.0,0.0,0.0 rho_ref | double | <a class="el" href="a00022.html#a1e6f66261d19a1c1c272e8808bd2657b">NavierStokes3D::rho0</a> | 1.0 p_ref | double | <a class="el" href="a00022.html#a8be9de5ac626cddcd15c5ec181619694">NavierStokes3D::p0</a> | 1.0 HB | int | <a class="el" href="a00022.html#a2e01ef077b0fedaea9e286ccdf2fe259">NavierStokes3D::HB</a> | 1 R | double | <a class="el" href="a00022.html#a228eb5e837a644887ac6e7bab3f42485">NavierStokes3D::R</a> | 1.0 upwinding | char[] | <a class="el" href="a00022.html#a57894a0f53d5b228bf64053367736bf9">NavierStokes3D::upw_choice</a> | "roe" (<a class="el" href="a00059.html#abffeadaaee7a3a2baeeb28e395411d73">_ROE_</a>)</p>
<p>+ If "HB" (<a class="el" href="a00022.html#a2e01ef077b0fedaea9e286ccdf2fe259">NavierStokes3D::HB</a>) is specified as 3, it should be followed by the the Brunt-Vaisala frequency (<a class="el" href="a00022.html#aa79c64518f6e9127d9b201bacd398174">NavierStokes3D::N_bv</a>), <a class="el" href="a00032.html#a35b3e91c83139b35bbacfaa59a58afd1">i.e</a>.</p>
<p>begin ... HB 3 0.01 ... end</p>
<p><b>Note:</b> "physics.inp" is <b>optional</b>; if absent, default values will be used. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>s</em>&nbsp;</td><td>Solver object of type <a class="el" href="a00015.html" title="Structure containing all solver-specific variables and functions.">HyPar</a> </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>m</em>&nbsp;</td><td>MPI object of type <a class="el" href="a00019.html" title="Structure of MPI-related variables.">MPIVariables</a> </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="a00285_source.html#l00088">88</a> of file <a class="el" href="a00285_source.html">NavierStokes3DInitialize.c</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00092"></a>00092 {
<a name="l00093"></a>00093   <a class="code" href="a00015.html" title="Structure containing all solver-specific variables and functions.">HyPar</a>           *solver  = (<a class="code" href="a00015.html" title="Structure containing all solver-specific variables and functions.">HyPar</a>*)          s;
<a name="l00094"></a>00094   <a class="code" href="a00019.html" title="Structure of MPI-related variables.">MPIVariables</a>    *mpi     = (<a class="code" href="a00019.html" title="Structure of MPI-related variables.">MPIVariables</a>*)   m; 
<a name="l00095"></a>00095   <a class="code" href="a00022.html" title="Structure containing variables and parameters specific to the 3D Navier Stokes equations...">NavierStokes3D</a>  *physics = (<a class="code" href="a00022.html" title="Structure containing variables and parameters specific to the 3D Navier Stokes equations...">NavierStokes3D</a>*) solver-&gt;<a class="code" href="a00015.html#a48e81a1806b5774943fd9a26e9a190f2">physics</a>;
<a name="l00096"></a>00096   <span class="keywordtype">int</span>             ferr     = 0;
<a name="l00097"></a>00097 
<a name="l00098"></a>00098   if (solver-&gt;<a class="code" href="a00015.html#ae8f6d2fd6490d3153cb4133bf183a404">nvars</a> != <a class="code" href="a00047.html#ad3395a55a5fde64d6603c7a82d7bf2c7">_MODEL_NVARS_</a>) {
<a name="l00099"></a>00099     fprintf(stderr,<span class="stringliteral">&quot;Error in NavierStokes3DInitialize(): nvars has to be %d.\n&quot;</span>,<a class="code" href="a00047.html#ad3395a55a5fde64d6603c7a82d7bf2c7">_MODEL_NVARS_</a>);
<a name="l00100"></a>00100     <span class="keywordflow">return</span>(1);
<a name="l00101"></a>00101   }
<a name="l00102"></a>00102   <span class="keywordflow">if</span> (solver-&gt;<a class="code" href="a00015.html#a484873c74138512e41bc50d17b7d955a">ndims</a> != <a class="code" href="a00047.html#a57771c952ec174601addf43e1c0202b2">_MODEL_NDIMS_</a>) {
<a name="l00103"></a>00103     fprintf(stderr,<span class="stringliteral">&quot;Error in NavierStokes3DInitialize(): ndims has to be %d.\n&quot;</span>,<a class="code" href="a00047.html#a57771c952ec174601addf43e1c0202b2">_MODEL_NDIMS_</a>);
<a name="l00104"></a>00104     <span class="keywordflow">return</span>(1);
<a name="l00105"></a>00105   }
<a name="l00106"></a>00106 
<a name="l00107"></a>00107   <span class="comment">/* default values */</span>
<a name="l00108"></a>00108   physics-&gt;<a class="code" href="a00022.html#a72f9e01745b3a8203067ab84aefc9aea">gamma</a>  = 1.4; 
<a name="l00109"></a>00109   physics-&gt;<a class="code" href="a00022.html#af0f6e03342b9eb912e25f94ce0249a2c">Pr</a>     = 0.72;
<a name="l00110"></a>00110   physics-&gt;<a class="code" href="a00022.html#a3b92a4b98cedf64473b3c13dfa7674b4">Re</a>     = -1;
<a name="l00111"></a>00111   physics-&gt;<a class="code" href="a00022.html#aa5f774fe7b4f69be5e085f1988ef2a6d">Minf</a>   = 1.0;
<a name="l00112"></a>00112   physics-&gt;<a class="code" href="a00022.html#ad69d2b382d336189251f264999f56bfa">C1</a>     = 1.458e-6;
<a name="l00113"></a>00113   physics-&gt;<a class="code" href="a00022.html#a666af5280f39c3ddcafb7c01e55192a2">C2</a>     = 110.4;
<a name="l00114"></a>00114   physics-&gt;<a class="code" href="a00022.html#aaccb5cbe710523019e8615b49383fea1">grav_x</a> = 0.0;
<a name="l00115"></a>00115   physics-&gt;<a class="code" href="a00022.html#adf08e308b453bd2d4e117576e493ed03">grav_y</a> = 0.0;
<a name="l00116"></a>00116   physics-&gt;<a class="code" href="a00022.html#a320ec93c1b9ba874a2e334d5543f0e54">grav_z</a> = 0.0;
<a name="l00117"></a>00117   physics-&gt;<a class="code" href="a00022.html#a1e6f66261d19a1c1c272e8808bd2657b">rho0</a>   = 1.0;
<a name="l00118"></a>00118   physics-&gt;<a class="code" href="a00022.html#a8be9de5ac626cddcd15c5ec181619694">p0</a>     = 1.0;
<a name="l00119"></a>00119   physics-&gt;<a class="code" href="a00022.html#a2e01ef077b0fedaea9e286ccdf2fe259">HB</a>     = 1;
<a name="l00120"></a>00120   physics-&gt;<a class="code" href="a00022.html#a228eb5e837a644887ac6e7bab3f42485">R</a>      = 1.0;
<a name="l00121"></a>00121   physics-&gt;<a class="code" href="a00022.html#aa79c64518f6e9127d9b201bacd398174">N_bv</a>   = 0.0;
<a name="l00122"></a>00122   strcpy(physics-&gt;<a class="code" href="a00022.html#a57894a0f53d5b228bf64053367736bf9">upw_choice</a>,<span class="stringliteral">&quot;roe&quot;</span>);
<a name="l00123"></a>00123   strcpy(physics-&gt;<a class="code" href="a00022.html#a6dc28a9d77b29d3dc1ce7f4a9bbbc829">ib_write_surface_data</a>,<span class="stringliteral">&quot;yes&quot;</span>);
<a name="l00124"></a>00124 
<a name="l00125"></a>00125   <span class="comment">/* reading physical model specific inputs - all processes */</span>
<a name="l00126"></a>00126   <span class="keywordflow">if</span> (!mpi-&gt;<a class="code" href="a00019.html#a6cfd95afd0afebd625b889fb6e58371c">rank</a>) {
<a name="l00127"></a>00127     FILE *in;
<a name="l00128"></a>00128     printf(<span class="stringliteral">&quot;Reading physical model inputs from file \&quot;physics.inp\&quot;.\n&quot;</span>);
<a name="l00129"></a>00129     in = fopen(<span class="stringliteral">&quot;physics.inp&quot;</span>,<span class="stringliteral">&quot;r&quot;</span>);
<a name="l00130"></a>00130     <span class="keywordflow">if</span> (!in) printf(<span class="stringliteral">&quot;Warning: File \&quot;physics.inp\&quot; not found. Using default values.\n&quot;</span>);
<a name="l00131"></a>00131     <span class="keywordflow">else</span> {
<a name="l00132"></a>00132       <span class="keywordtype">char</span> word[<a class="code" href="a00036.html#a51efea86a4d76d1259893f606b776573">_MAX_STRING_SIZE_</a>];
<a name="l00133"></a>00133       ferr = fscanf(in,<span class="stringliteral">&quot;%s&quot;</span>,word);                      <span class="keywordflow">if</span> (ferr != 1) <span class="keywordflow">return</span>(1);
<a name="l00134"></a>00134       <span class="keywordflow">if</span> (!strcmp(word, <span class="stringliteral">&quot;begin&quot;</span>)){
<a name="l00135"></a>00135           <span class="keywordflow">while</span> (strcmp(word, <span class="stringliteral">&quot;end&quot;</span>)){
<a name="l00136"></a>00136               ferr = fscanf(in,<span class="stringliteral">&quot;%s&quot;</span>,word);                  <span class="keywordflow">if</span> (ferr != 1) <span class="keywordflow">return</span>(1);
<a name="l00137"></a>00137           <span class="keywordflow">if</span> (!strcmp(word, <span class="stringliteral">&quot;gamma&quot;</span>)) { 
<a name="l00138"></a>00138             ferr = fscanf(in,<span class="stringliteral">&quot;%lf&quot;</span>,&amp;physics-&gt;<a class="code" href="a00022.html#a72f9e01745b3a8203067ab84aefc9aea">gamma</a>);    <span class="keywordflow">if</span> (ferr != 1) <span class="keywordflow">return</span>(1);
<a name="l00139"></a>00139           } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcmp(word,<span class="stringliteral">&quot;upwinding&quot;</span>)) {
<a name="l00140"></a>00140             ferr = fscanf(in,<span class="stringliteral">&quot;%s&quot;</span>,physics-&gt;<a class="code" href="a00022.html#a57894a0f53d5b228bf64053367736bf9">upw_choice</a>); <span class="keywordflow">if</span> (ferr != 1) <span class="keywordflow">return</span>(1);
<a name="l00141"></a>00141           } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcmp(word,<span class="stringliteral">&quot;Pr&quot;</span>)) {
<a name="l00142"></a>00142             ferr = fscanf(in,<span class="stringliteral">&quot;%lf&quot;</span>,&amp;physics-&gt;<a class="code" href="a00022.html#af0f6e03342b9eb912e25f94ce0249a2c">Pr</a>);       <span class="keywordflow">if</span> (ferr != 1) <span class="keywordflow">return</span>(1);
<a name="l00143"></a>00143           } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcmp(word,<span class="stringliteral">&quot;Re&quot;</span>)) {
<a name="l00144"></a>00144             ferr = fscanf(in,<span class="stringliteral">&quot;%lf&quot;</span>,&amp;physics-&gt;<a class="code" href="a00022.html#a3b92a4b98cedf64473b3c13dfa7674b4">Re</a>);       <span class="keywordflow">if</span> (ferr != 1) <span class="keywordflow">return</span>(1);
<a name="l00145"></a>00145           } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcmp(word,<span class="stringliteral">&quot;Minf&quot;</span>)) {
<a name="l00146"></a>00146             ferr = fscanf(in,<span class="stringliteral">&quot;%lf&quot;</span>,&amp;physics-&gt;<a class="code" href="a00022.html#aa5f774fe7b4f69be5e085f1988ef2a6d">Minf</a>);     <span class="keywordflow">if</span> (ferr != 1) <span class="keywordflow">return</span>(1);
<a name="l00147"></a>00147           } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcmp(word,<span class="stringliteral">&quot;gravity&quot;</span>)) {
<a name="l00148"></a>00148             ferr = fscanf(in,<span class="stringliteral">&quot;%lf&quot;</span>,&amp;physics-&gt;<a class="code" href="a00022.html#aaccb5cbe710523019e8615b49383fea1">grav_x</a>);   <span class="keywordflow">if</span> (ferr != 1) <span class="keywordflow">return</span>(1);
<a name="l00149"></a>00149             ferr = fscanf(in,<span class="stringliteral">&quot;%lf&quot;</span>,&amp;physics-&gt;<a class="code" href="a00022.html#adf08e308b453bd2d4e117576e493ed03">grav_y</a>);   <span class="keywordflow">if</span> (ferr != 1) <span class="keywordflow">return</span>(1);
<a name="l00150"></a>00150             ferr = fscanf(in,<span class="stringliteral">&quot;%lf&quot;</span>,&amp;physics-&gt;<a class="code" href="a00022.html#a320ec93c1b9ba874a2e334d5543f0e54">grav_z</a>);   <span class="keywordflow">if</span> (ferr != 1) <span class="keywordflow">return</span>(1);
<a name="l00151"></a>00151           } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcmp(word,<span class="stringliteral">&quot;rho_ref&quot;</span>)) {
<a name="l00152"></a>00152             ferr = fscanf(in,<span class="stringliteral">&quot;%lf&quot;</span>,&amp;physics-&gt;<a class="code" href="a00022.html#a1e6f66261d19a1c1c272e8808bd2657b">rho0</a>);     <span class="keywordflow">if</span> (ferr != 1) <span class="keywordflow">return</span>(1);
<a name="l00153"></a>00153           } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcmp(word,<span class="stringliteral">&quot;p_ref&quot;</span>)) {
<a name="l00154"></a>00154             ferr = fscanf(in,<span class="stringliteral">&quot;%lf&quot;</span>,&amp;physics-&gt;<a class="code" href="a00022.html#a8be9de5ac626cddcd15c5ec181619694">p0</a>);       <span class="keywordflow">if</span> (ferr != 1) <span class="keywordflow">return</span>(1);
<a name="l00155"></a>00155           } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcmp(word,<span class="stringliteral">&quot;HB&quot;</span>)) {
<a name="l00156"></a>00156             ferr = fscanf(in,<span class="stringliteral">&quot;%d&quot;</span>,&amp;physics-&gt;<a class="code" href="a00022.html#a2e01ef077b0fedaea9e286ccdf2fe259">HB</a>);        <span class="keywordflow">if</span> (ferr != 1) <span class="keywordflow">return</span>(1);
<a name="l00157"></a>00157             <span class="keywordflow">if</span> (physics-&gt;<a class="code" href="a00022.html#a2e01ef077b0fedaea9e286ccdf2fe259">HB</a>==3) {
<a name="l00158"></a>00158               ferr = fscanf(in,<span class="stringliteral">&quot;%lf&quot;</span>,&amp;physics-&gt;<a class="code" href="a00022.html#aa79c64518f6e9127d9b201bacd398174">N_bv</a>);   <span class="keywordflow">if</span> (ferr != 1) <span class="keywordflow">return</span>(1);
<a name="l00159"></a>00159             }
<a name="l00160"></a>00160           } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcmp(word,<span class="stringliteral">&quot;R&quot;</span>)) {
<a name="l00161"></a>00161             ferr = fscanf(in,<span class="stringliteral">&quot;%lf&quot;</span>,&amp;physics-&gt;<a class="code" href="a00022.html#a228eb5e837a644887ac6e7bab3f42485">R</a>);        <span class="keywordflow">if</span> (ferr != 1) <span class="keywordflow">return</span>(1);
<a name="l00162"></a>00162           } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcmp(word,<span class="stringliteral">&quot;ib_surface_data&quot;</span>)) {
<a name="l00163"></a>00163             ferr = fscanf(in,<span class="stringliteral">&quot;%s&quot;</span>,physics-&gt;<a class="code" href="a00022.html#a6dc28a9d77b29d3dc1ce7f4a9bbbc829">ib_write_surface_data</a>); <span class="keywordflow">if</span> (ferr != 1) <span class="keywordflow">return</span>(1);
<a name="l00164"></a>00164           } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (strcmp(word,<span class="stringliteral">&quot;end&quot;</span>)) {
<a name="l00165"></a>00165             <span class="keywordtype">char</span> useless[<a class="code" href="a00036.html#a51efea86a4d76d1259893f606b776573">_MAX_STRING_SIZE_</a>];
<a name="l00166"></a>00166             ferr = fscanf(in,<span class="stringliteral">&quot;%s&quot;</span>,useless); <span class="keywordflow">if</span> (ferr != 1) <span class="keywordflow">return</span>(ferr);
<a name="l00167"></a>00167             printf(<span class="stringliteral">&quot;Warning: keyword %s in file \&quot;physics.inp\&quot; with value %s not &quot;</span>,word,useless);
<a name="l00168"></a>00168             printf(<span class="stringliteral">&quot;recognized or extraneous. Ignoring.\n&quot;</span>);
<a name="l00169"></a>00169           }
<a name="l00170"></a>00170         }
<a name="l00171"></a>00171         } <span class="keywordflow">else</span> {
<a name="l00172"></a>00172           fprintf(stderr,<span class="stringliteral">&quot;Error: Illegal format in file \&quot;physics.inp\&quot;.\n&quot;</span>);
<a name="l00173"></a>00173         <span class="keywordflow">return</span>(1);
<a name="l00174"></a>00174         }
<a name="l00175"></a>00175     }
<a name="l00176"></a>00176     fclose(in);
<a name="l00177"></a>00177   }
<a name="l00178"></a>00178 
<a name="l00179"></a>00179   <a class="code" href="a00036.html#ad6ab74942c9de13cf0b4c12eb0d91780">IERR</a> <a class="code" href="a00045.html#ad408e5a44e863cca50112d1e2f728597">MPIBroadcast_character</a> (physics-&gt;<a class="code" href="a00022.html#a57894a0f53d5b228bf64053367736bf9">upw_choice</a>            ,<a class="code" href="a00036.html#a51efea86a4d76d1259893f606b776573">_MAX_STRING_SIZE_</a>,0,&amp;mpi-&gt;<a class="code" href="a00019.html#adad7a6f85831f3ac84d854b6c80aef43">world</a>); <a class="code" href="a00036.html#add9cf96ae374934d245a1dc1ab697a42">CHECKERR</a>(ierr);
<a name="l00180"></a>00180   <a class="code" href="a00036.html#ad6ab74942c9de13cf0b4c12eb0d91780">IERR</a> <a class="code" href="a00045.html#ad408e5a44e863cca50112d1e2f728597">MPIBroadcast_character</a> (physics-&gt;<a class="code" href="a00022.html#a6dc28a9d77b29d3dc1ce7f4a9bbbc829">ib_write_surface_data</a> ,<a class="code" href="a00036.html#a51efea86a4d76d1259893f606b776573">_MAX_STRING_SIZE_</a>,0,&amp;mpi-&gt;<a class="code" href="a00019.html#adad7a6f85831f3ac84d854b6c80aef43">world</a>); <a class="code" href="a00036.html#add9cf96ae374934d245a1dc1ab697a42">CHECKERR</a>(ierr);
<a name="l00181"></a>00181   <a class="code" href="a00036.html#ad6ab74942c9de13cf0b4c12eb0d91780">IERR</a> <a class="code" href="a00045.html#a45dcb265863a65d862bb16222e7e623c">MPIBroadcast_double</a>    (&amp;physics-&gt;<a class="code" href="a00022.html#a72f9e01745b3a8203067ab84aefc9aea">gamma</a>                ,1                ,0,&amp;mpi-&gt;<a class="code" href="a00019.html#adad7a6f85831f3ac84d854b6c80aef43">world</a>); <a class="code" href="a00036.html#add9cf96ae374934d245a1dc1ab697a42">CHECKERR</a>(ierr);
<a name="l00182"></a>00182   <a class="code" href="a00036.html#ad6ab74942c9de13cf0b4c12eb0d91780">IERR</a> <a class="code" href="a00045.html#a45dcb265863a65d862bb16222e7e623c">MPIBroadcast_double</a>    (&amp;physics-&gt;<a class="code" href="a00022.html#af0f6e03342b9eb912e25f94ce0249a2c">Pr</a>                   ,1                ,0,&amp;mpi-&gt;<a class="code" href="a00019.html#adad7a6f85831f3ac84d854b6c80aef43">world</a>); <a class="code" href="a00036.html#add9cf96ae374934d245a1dc1ab697a42">CHECKERR</a>(ierr);
<a name="l00183"></a>00183   <a class="code" href="a00036.html#ad6ab74942c9de13cf0b4c12eb0d91780">IERR</a> <a class="code" href="a00045.html#a45dcb265863a65d862bb16222e7e623c">MPIBroadcast_double</a>    (&amp;physics-&gt;<a class="code" href="a00022.html#a3b92a4b98cedf64473b3c13dfa7674b4">Re</a>                   ,1                ,0,&amp;mpi-&gt;<a class="code" href="a00019.html#adad7a6f85831f3ac84d854b6c80aef43">world</a>); <a class="code" href="a00036.html#add9cf96ae374934d245a1dc1ab697a42">CHECKERR</a>(ierr);
<a name="l00184"></a>00184   <a class="code" href="a00036.html#ad6ab74942c9de13cf0b4c12eb0d91780">IERR</a> <a class="code" href="a00045.html#a45dcb265863a65d862bb16222e7e623c">MPIBroadcast_double</a>    (&amp;physics-&gt;<a class="code" href="a00022.html#aa5f774fe7b4f69be5e085f1988ef2a6d">Minf</a>                 ,1                ,0,&amp;mpi-&gt;<a class="code" href="a00019.html#adad7a6f85831f3ac84d854b6c80aef43">world</a>); <a class="code" href="a00036.html#add9cf96ae374934d245a1dc1ab697a42">CHECKERR</a>(ierr);
<a name="l00185"></a>00185   <a class="code" href="a00036.html#ad6ab74942c9de13cf0b4c12eb0d91780">IERR</a> <a class="code" href="a00045.html#a45dcb265863a65d862bb16222e7e623c">MPIBroadcast_double</a>    (&amp;physics-&gt;<a class="code" href="a00022.html#aaccb5cbe710523019e8615b49383fea1">grav_x</a>               ,1                ,0,&amp;mpi-&gt;<a class="code" href="a00019.html#adad7a6f85831f3ac84d854b6c80aef43">world</a>); <a class="code" href="a00036.html#add9cf96ae374934d245a1dc1ab697a42">CHECKERR</a>(ierr);
<a name="l00186"></a>00186   <a class="code" href="a00036.html#ad6ab74942c9de13cf0b4c12eb0d91780">IERR</a> <a class="code" href="a00045.html#a45dcb265863a65d862bb16222e7e623c">MPIBroadcast_double</a>    (&amp;physics-&gt;<a class="code" href="a00022.html#adf08e308b453bd2d4e117576e493ed03">grav_y</a>               ,1                ,0,&amp;mpi-&gt;<a class="code" href="a00019.html#adad7a6f85831f3ac84d854b6c80aef43">world</a>); <a class="code" href="a00036.html#add9cf96ae374934d245a1dc1ab697a42">CHECKERR</a>(ierr);
<a name="l00187"></a>00187   <a class="code" href="a00036.html#ad6ab74942c9de13cf0b4c12eb0d91780">IERR</a> <a class="code" href="a00045.html#a45dcb265863a65d862bb16222e7e623c">MPIBroadcast_double</a>    (&amp;physics-&gt;<a class="code" href="a00022.html#a320ec93c1b9ba874a2e334d5543f0e54">grav_z</a>               ,1                ,0,&amp;mpi-&gt;<a class="code" href="a00019.html#adad7a6f85831f3ac84d854b6c80aef43">world</a>); <a class="code" href="a00036.html#add9cf96ae374934d245a1dc1ab697a42">CHECKERR</a>(ierr);
<a name="l00188"></a>00188   <a class="code" href="a00036.html#ad6ab74942c9de13cf0b4c12eb0d91780">IERR</a> <a class="code" href="a00045.html#a45dcb265863a65d862bb16222e7e623c">MPIBroadcast_double</a>    (&amp;physics-&gt;<a class="code" href="a00022.html#a1e6f66261d19a1c1c272e8808bd2657b">rho0</a>                 ,1                ,0,&amp;mpi-&gt;<a class="code" href="a00019.html#adad7a6f85831f3ac84d854b6c80aef43">world</a>); <a class="code" href="a00036.html#add9cf96ae374934d245a1dc1ab697a42">CHECKERR</a>(ierr);
<a name="l00189"></a>00189   <a class="code" href="a00036.html#ad6ab74942c9de13cf0b4c12eb0d91780">IERR</a> <a class="code" href="a00045.html#a45dcb265863a65d862bb16222e7e623c">MPIBroadcast_double</a>    (&amp;physics-&gt;<a class="code" href="a00022.html#a8be9de5ac626cddcd15c5ec181619694">p0</a>                   ,1                ,0,&amp;mpi-&gt;<a class="code" href="a00019.html#adad7a6f85831f3ac84d854b6c80aef43">world</a>); <a class="code" href="a00036.html#add9cf96ae374934d245a1dc1ab697a42">CHECKERR</a>(ierr);
<a name="l00190"></a>00190   <a class="code" href="a00036.html#ad6ab74942c9de13cf0b4c12eb0d91780">IERR</a> <a class="code" href="a00045.html#a45dcb265863a65d862bb16222e7e623c">MPIBroadcast_double</a>    (&amp;physics-&gt;<a class="code" href="a00022.html#a228eb5e837a644887ac6e7bab3f42485">R</a>                    ,1                ,0,&amp;mpi-&gt;<a class="code" href="a00019.html#adad7a6f85831f3ac84d854b6c80aef43">world</a>); <a class="code" href="a00036.html#add9cf96ae374934d245a1dc1ab697a42">CHECKERR</a>(ierr);
<a name="l00191"></a>00191   <a class="code" href="a00036.html#ad6ab74942c9de13cf0b4c12eb0d91780">IERR</a> <a class="code" href="a00045.html#a45dcb265863a65d862bb16222e7e623c">MPIBroadcast_double</a>    (&amp;physics-&gt;<a class="code" href="a00022.html#aa79c64518f6e9127d9b201bacd398174">N_bv</a>                 ,1                ,0,&amp;mpi-&gt;<a class="code" href="a00019.html#adad7a6f85831f3ac84d854b6c80aef43">world</a>); <a class="code" href="a00036.html#add9cf96ae374934d245a1dc1ab697a42">CHECKERR</a>(ierr);
<a name="l00192"></a>00192   <a class="code" href="a00036.html#ad6ab74942c9de13cf0b4c12eb0d91780">IERR</a> <a class="code" href="a00045.html#acd7957559b9206224c7da3cab4f22b27">MPIBroadcast_integer</a>   (&amp;physics-&gt;<a class="code" href="a00022.html#a2e01ef077b0fedaea9e286ccdf2fe259">HB</a>                   ,1                ,0,&amp;mpi-&gt;<a class="code" href="a00019.html#adad7a6f85831f3ac84d854b6c80aef43">world</a>); <a class="code" href="a00036.html#add9cf96ae374934d245a1dc1ab697a42">CHECKERR</a>(ierr);
<a name="l00193"></a>00193 
<a name="l00194"></a>00194   <span class="comment">/* if file output is disabled in HyPar, respect that */</span>
<a name="l00195"></a>00195   <span class="keywordflow">if</span> (!strcmp(solver-&gt;<a class="code" href="a00015.html#a51a3b8c19b86e9e1df5be02b05a6613c">op_file_format</a>,<span class="stringliteral">&quot;none&quot;</span>)) {
<a name="l00196"></a>00196     <span class="keywordflow">if</span> (!strcmp(physics-&gt;<a class="code" href="a00022.html#a6dc28a9d77b29d3dc1ce7f4a9bbbc829">ib_write_surface_data</a>,<span class="stringliteral">&quot;yes&quot;</span>)) {
<a name="l00197"></a>00197       <span class="keywordflow">if</span> (!mpi-&gt;<a class="code" href="a00019.html#a6cfd95afd0afebd625b889fb6e58371c">rank</a>) {
<a name="l00198"></a>00198         printf(<span class="stringliteral">&quot;Warning from NavierStokes3DInitialize(): solver-&gt;op_file_format is set to \&quot;none\&quot;, thus &quot;</span>);
<a name="l00199"></a>00199         printf(<span class="stringliteral">&quot;setting physics-&gt;ib_write_surface_data to \&quot;no\&quot; (no solution files will be written).\n&quot;</span>);
<a name="l00200"></a>00200       }
<a name="l00201"></a>00201     }
<a name="l00202"></a>00202     strcpy(physics-&gt;<a class="code" href="a00022.html#a6dc28a9d77b29d3dc1ce7f4a9bbbc829">ib_write_surface_data</a>,<span class="stringliteral">&quot;no&quot;</span>);
<a name="l00203"></a>00203   }
<a name="l00204"></a>00204 
<a name="l00205"></a>00205   <span class="comment">/* Scaling Re by M_inf */</span>
<a name="l00206"></a>00206   physics-&gt;<a class="code" href="a00022.html#a3b92a4b98cedf64473b3c13dfa7674b4">Re</a> /= physics-&gt;<a class="code" href="a00022.html#aa5f774fe7b4f69be5e085f1988ef2a6d">Minf</a>;
<a name="l00207"></a>00207 
<a name="l00208"></a>00208   <span class="comment">/* check that a well-balanced upwinding scheme is being used for cases with gravity */</span>
<a name="l00209"></a>00209   <span class="keywordflow">if</span> (   ((physics-&gt;<a class="code" href="a00022.html#aaccb5cbe710523019e8615b49383fea1">grav_x</a> != 0.0) || (physics-&gt;<a class="code" href="a00022.html#adf08e308b453bd2d4e117576e493ed03">grav_y</a> != 0.0) || (physics-&gt;<a class="code" href="a00022.html#a320ec93c1b9ba874a2e334d5543f0e54">grav_z</a> != 0.0) )
<a name="l00210"></a>00210       &amp;&amp; (strcmp(physics-&gt;<a class="code" href="a00022.html#a57894a0f53d5b228bf64053367736bf9">upw_choice</a>,<a class="code" href="a00047.html#a68e6f3e8f20e4c3a5874221661141935">_RUSANOV_</a>)) ) {
<a name="l00211"></a>00211     <span class="keywordflow">if</span> (!mpi-&gt;<a class="code" href="a00019.html#a6cfd95afd0afebd625b889fb6e58371c">rank</a>) {
<a name="l00212"></a>00212       fprintf(stderr,<span class="stringliteral">&quot;Error in NavierStokes3DInitialize: %s upwinding is needed for flows &quot;</span>,<a class="code" href="a00047.html#a68e6f3e8f20e4c3a5874221661141935">_RUSANOV_</a>);
<a name="l00213"></a>00213       fprintf(stderr,<span class="stringliteral">&quot;with gravitational forces.\n&quot;</span>);
<a name="l00214"></a>00214     }
<a name="l00215"></a>00215     <span class="keywordflow">return</span>(1);
<a name="l00216"></a>00216   }
<a name="l00217"></a>00217   <span class="comment">/* check that solver has the correct choice of diffusion formulation, if viscous flow */</span>
<a name="l00218"></a>00218   <span class="keywordflow">if</span> (strcmp(solver-&gt;<a class="code" href="a00015.html#ad45d57b33d578bf602574a221bf53d93">spatial_type_par</a>,<a class="code" href="a00039.html#a9f4de86b900c9aa5f097c2746e17612a">_NC_2STAGE_</a>) &amp;&amp; (physics-&gt;<a class="code" href="a00022.html#a3b92a4b98cedf64473b3c13dfa7674b4">Re</a> &gt; 0)) {
<a name="l00219"></a>00219     <span class="keywordflow">if</span> (!mpi-&gt;<a class="code" href="a00019.html#a6cfd95afd0afebd625b889fb6e58371c">rank</a>) {
<a name="l00220"></a>00220       fprintf(stderr,<span class="stringliteral">&quot;Error in NavierStokes3DInitialize(): Parabolic term spatial discretization must be \&quot;%s\&quot;\n&quot;</span>,<a class="code" href="a00039.html#a9f4de86b900c9aa5f097c2746e17612a">_NC_2STAGE_</a>);
<a name="l00221"></a>00221     }
<a name="l00222"></a>00222     <span class="keywordflow">return</span>(1);
<a name="l00223"></a>00223   }
<a name="l00224"></a>00224 
<a name="l00225"></a>00225   <span class="comment">/* initializing physical model-specific functions */</span>
<a name="l00226"></a>00226   solver-&gt;<a class="code" href="a00015.html#a6a34ae8a3044f521e57180a7260f3b42">PreStep</a>               = <a class="code" href="a00285.html#ab46a2b2ab6bfce2d5b2ae6075d2dee64">NavierStokes3DPreStep</a>;
<a name="l00227"></a>00227   solver-&gt;<a class="code" href="a00015.html#a73ad2e9dae43bf438ab8bfc4cd2e1bdd">ComputeCFL</a>            = <a class="code" href="a00278.html#ae98f605de061bde1006de5e37e7745bb">NavierStokes3DComputeCFL</a>;
<a name="l00228"></a>00228   solver-&gt;<a class="code" href="a00015.html#a0d895f9bb0c8a3e79a64dd2379e1f2dd">FFunction</a>             = <a class="code" href="a00280.html#ac0c3d11fce67eca952fcb594ff3930cb">NavierStokes3DFlux</a>;
<a name="l00229"></a>00229   solver-&gt;<a class="code" href="a00015.html#a1685cd0c6b8c413bdbbe86d8f4475c58">SFunction</a>             = <a class="code" href="a00285.html#af948a0c8afd2ef2dedaf5c9c3708dcf2">NavierStokes3DSource</a>;
<a name="l00230"></a>00230   solver-&gt;<a class="code" href="a00015.html#af1dc5a4ba2bdc46dfd226e35772b4130">UFunction</a>             = <a class="code" href="a00285.html#acb5490573b85442e23e4f69f97a6e8cd">NavierStokes3DModifiedSolution</a>;
<a name="l00231"></a>00231   solver-&gt;<a class="code" href="a00015.html#a7331366d789b2995436accbc35e1cc80">AveragingFunction</a>     = <a class="code" href="a00281.html#a8910dbe2aaf01714c0136e887ab88a89">NavierStokes3DRoeAverage</a>;
<a name="l00232"></a>00232   solver-&gt;<a class="code" href="a00015.html#a8c603c73be1f08e408a1de94a088da7b">GetLeftEigenvectors</a>   = <a class="code" href="a00279.html#ab376732168de139806c9f77828caa063">NavierStokes3DLeftEigenvectors</a>;
<a name="l00233"></a>00233   solver-&gt;<a class="code" href="a00015.html#a22eef349f191a1aa267e14b08140c823">GetRightEigenvectors</a>  = <a class="code" href="a00279.html#a62b44025b86e4d73a34142b32301ee7c">NavierStokes3DRightEigenvectors</a>;
<a name="l00234"></a>00234 
<a name="l00235"></a>00235   <span class="keywordflow">if</span> (solver-&gt;<a class="code" href="a00015.html#ae83b1b0117b6a805ead2e4728945814c">flag_ib</a>) {
<a name="l00236"></a>00236     solver-&gt;<a class="code" href="a00015.html#a0d9d4a968c52356bd63f45ad76112245">IBFunction</a>          = <a class="code" href="a00284.html#a7420691d461963f76073899aa8f55e0e">NavierStokes3DImmersedBoundary</a>;
<a name="l00237"></a>00237     <span class="keywordflow">if</span> (!strcmp(physics-&gt;<a class="code" href="a00022.html#a6dc28a9d77b29d3dc1ce7f4a9bbbc829">ib_write_surface_data</a>,<span class="stringliteral">&quot;yes&quot;</span>)) {
<a name="l00238"></a>00238       solver-&gt;<a class="code" href="a00015.html#ab4c55736e92f7d72f04b8a957d82b054">PhysicsOutput</a>     = <a class="code" href="a00283.html#ac66d24485c83422b6ec21fdf9e1363e5">NavierStokes3DIBForces</a>;
<a name="l00239"></a>00239     }
<a name="l00240"></a>00240   }
<a name="l00241"></a>00241 
<a name="l00242"></a>00242   <span class="keywordflow">if</span> (!strcmp(solver-&gt;<a class="code" href="a00015.html#a5bed0cb9665daad89f4377c4f7609df4">SplitHyperbolicFlux</a>,<span class="stringliteral">&quot;yes&quot;</span>)) {
<a name="l00243"></a>00243     solver-&gt;<a class="code" href="a00015.html#adcc5e677515d0952ce3ff702c9d85b86">FdFFunction</a> = <a class="code" href="a00280.html#ae304378ba0faf692ac352fef0deeb961">NavierStokes3DNonStiffFlux</a>;
<a name="l00244"></a>00244     solver-&gt;<a class="code" href="a00015.html#aa1dd38befc4bb4adda9d456146436b14">dFFunction</a>  = <a class="code" href="a00280.html#a028bf569168b6ac14cc51c485fd891ce">NavierStokes3DStiffFlux</a>;
<a name="l00245"></a>00245     solver-&gt;<a class="code" href="a00015.html#a15eea1647344c503deb1d9f89cead631">JFunction</a>   = <a class="code" href="a00285.html#a24b8975686a9861a8ab86548477a343a">NavierStokes3DStiffJacobian</a>;
<a name="l00246"></a>00246     <span class="keywordflow">if</span> (!strcmp(physics-&gt;<a class="code" href="a00022.html#a57894a0f53d5b228bf64053367736bf9">upw_choice</a>,<a class="code" href="a00047.html#abffeadaaee7a3a2baeeb28e395411d73">_ROE_</a>)) {
<a name="l00247"></a>00247       solver-&gt;<a class="code" href="a00015.html#a7eb68b9643feb74bd49f3a171b66eef1">Upwind</a>    = <a class="code" href="a00285.html#a183d011079d8d0d506ecfac3f3780c27">NavierStokes3DUpwindRoe</a>;
<a name="l00248"></a>00248       solver-&gt;<a class="code" href="a00015.html#a73a85f83072e02bf979234486265b6d3">UpwinddF</a>  = <a class="code" href="a00285.html#ae1dbdac366ab08e662af6736a26dbeac">NavierStokes3DUpwinddFRoe</a>;
<a name="l00249"></a>00249       solver-&gt;<a class="code" href="a00015.html#ab06746933e859e829d694505c18258b3">UpwindFdF</a> = <a class="code" href="a00285.html#a9795f4f26514c700c22f2182cbe73f9b">NavierStokes3DUpwindFdFRoe</a>;
<a name="l00250"></a>00250     } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcmp(physics-&gt;<a class="code" href="a00022.html#a57894a0f53d5b228bf64053367736bf9">upw_choice</a>,<a class="code" href="a00047.html#a68e6f3e8f20e4c3a5874221661141935">_RUSANOV_</a>)) {
<a name="l00251"></a>00251       solver-&gt;<a class="code" href="a00015.html#a7eb68b9643feb74bd49f3a171b66eef1">Upwind</a>    = <a class="code" href="a00285.html#a07752c8fd9267a5c0aec3a30f5624d80">NavierStokes3DUpwindRusanovModified</a>;
<a name="l00252"></a>00252       solver-&gt;<a class="code" href="a00015.html#a73a85f83072e02bf979234486265b6d3">UpwinddF</a>  = <a class="code" href="a00285.html#a49b2dd6bbcdf3eed8732b6fb39619069">NavierStokes3DUpwinddFRusanovModified</a>;
<a name="l00253"></a>00253       solver-&gt;<a class="code" href="a00015.html#ab06746933e859e829d694505c18258b3">UpwindFdF</a> = <a class="code" href="a00285.html#a219b374873326eda267953ad47345ab2">NavierStokes3DUpwindFdFRusanovModified</a>;
<a name="l00254"></a>00254     } <span class="keywordflow">else</span> {
<a name="l00255"></a>00255       <span class="keywordflow">if</span> (!mpi-&gt;<a class="code" href="a00019.html#a6cfd95afd0afebd625b889fb6e58371c">rank</a>) {
<a name="l00256"></a>00256         fprintf(stderr,<span class="stringliteral">&quot;Error in NavierStokes3DInitialize(): %s is not a valid upwinding scheme &quot;</span>,
<a name="l00257"></a>00257                 physics-&gt;<a class="code" href="a00022.html#a57894a0f53d5b228bf64053367736bf9">upw_choice</a>);
<a name="l00258"></a>00258         fprintf(stderr,<span class="stringliteral">&quot;for use with split hyperbolic flux form. Use %s or %s.\n&quot;</span>,
<a name="l00259"></a>00259                 <a class="code" href="a00047.html#abffeadaaee7a3a2baeeb28e395411d73">_ROE_</a>,<a class="code" href="a00047.html#a68e6f3e8f20e4c3a5874221661141935">_RUSANOV_</a>);
<a name="l00260"></a>00260       }
<a name="l00261"></a>00261       <span class="keywordflow">return</span>(1);
<a name="l00262"></a>00262     }
<a name="l00263"></a>00263   } <span class="keywordflow">else</span> {
<a name="l00264"></a>00264     solver-&gt;<a class="code" href="a00015.html#a15eea1647344c503deb1d9f89cead631">JFunction</a>      = <a class="code" href="a00285.html#a263d12debe46a00911f249c191423492">NavierStokes3DJacobian</a>;
<a name="l00265"></a>00265     <span class="keywordflow">if</span>      (!strcmp(physics-&gt;<a class="code" href="a00022.html#a57894a0f53d5b228bf64053367736bf9">upw_choice</a>,<a class="code" href="a00047.html#abffeadaaee7a3a2baeeb28e395411d73">_ROE_</a>    )) solver-&gt;<a class="code" href="a00015.html#a7eb68b9643feb74bd49f3a171b66eef1">Upwind</a> = <a class="code" href="a00285.html#a183d011079d8d0d506ecfac3f3780c27">NavierStokes3DUpwindRoe</a>;
<a name="l00266"></a>00266     <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcmp(physics-&gt;<a class="code" href="a00022.html#a57894a0f53d5b228bf64053367736bf9">upw_choice</a>,<a class="code" href="a00047.html#a51e0f9431973e4cf55e6aeee7dab6d83">_RF_</a>     )) solver-&gt;<a class="code" href="a00015.html#a7eb68b9643feb74bd49f3a171b66eef1">Upwind</a> = <a class="code" href="a00285.html#a6dd8db236f058412263acd0065a8e704">NavierStokes3DUpwindRF</a>;
<a name="l00267"></a>00267     <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcmp(physics-&gt;<a class="code" href="a00022.html#a57894a0f53d5b228bf64053367736bf9">upw_choice</a>,<a class="code" href="a00047.html#a98a6bcc1b69abface4bef84cf0d51955">_LLF_</a>    )) solver-&gt;<a class="code" href="a00015.html#a7eb68b9643feb74bd49f3a171b66eef1">Upwind</a> = <a class="code" href="a00285.html#a981ec533e49c2260e728d57b1356f13e">NavierStokes3DUpwindLLF</a>;
<a name="l00268"></a>00268     <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcmp(physics-&gt;<a class="code" href="a00022.html#a57894a0f53d5b228bf64053367736bf9">upw_choice</a>,<a class="code" href="a00047.html#a68e6f3e8f20e4c3a5874221661141935">_RUSANOV_</a>)) solver-&gt;<a class="code" href="a00015.html#a7eb68b9643feb74bd49f3a171b66eef1">Upwind</a> = <a class="code" href="a00285.html#a3ef989c38a4ee47143d0e1064a9849e6">NavierStokes3DUpwindRusanov</a>;
<a name="l00269"></a>00269     <span class="keywordflow">else</span> {
<a name="l00270"></a>00270       <span class="keywordflow">if</span> (!mpi-&gt;<a class="code" href="a00019.html#a6cfd95afd0afebd625b889fb6e58371c">rank</a>) {
<a name="l00271"></a>00271         fprintf(stderr,<span class="stringliteral">&quot;Error in NavierStokes3DInitialize(): %s is not a valid upwinding scheme. &quot;</span>,
<a name="l00272"></a>00272                 physics-&gt;<a class="code" href="a00022.html#a57894a0f53d5b228bf64053367736bf9">upw_choice</a>);
<a name="l00273"></a>00273         fprintf(stderr,<span class="stringliteral">&quot;Choices are %s, %s, %s, and %s.\n&quot;</span>,<a class="code" href="a00047.html#abffeadaaee7a3a2baeeb28e395411d73">_ROE_</a>,<a class="code" href="a00047.html#a51e0f9431973e4cf55e6aeee7dab6d83">_RF_</a>,<a class="code" href="a00047.html#a98a6bcc1b69abface4bef84cf0d51955">_LLF_</a>,<a class="code" href="a00047.html#a68e6f3e8f20e4c3a5874221661141935">_RUSANOV_</a>);
<a name="l00274"></a>00274       }
<a name="l00275"></a>00275       <span class="keywordflow">return</span>(1);
<a name="l00276"></a>00276     }
<a name="l00277"></a>00277   }
<a name="l00278"></a>00278 
<a name="l00279"></a>00279   <span class="comment">/* set the value of gamma in all the boundary objects */</span>
<a name="l00280"></a>00280   <span class="keywordtype">int</span> n;
<a name="l00281"></a>00281   <a class="code" href="a00004.html" title="Structure containing the variables and function pointers defining a boundary.">DomainBoundary</a>  *boundary = (<a class="code" href="a00004.html" title="Structure containing the variables and function pointers defining a boundary.">DomainBoundary</a>*) solver-&gt;<a class="code" href="a00015.html#a6b5109ac1048aa203b8969b91e72c3af">boundary</a>;
<a name="l00282"></a>00282   for (n = 0; n &lt; solver-&gt;<a class="code" href="a00015.html#a3f9a55664d1c8f058828ae9f4de11906">nBoundaryZones</a>; n++)  boundary[n].gamma = physics-&gt;<a class="code" href="a00022.html#a72f9e01745b3a8203067ab84aefc9aea">gamma</a>;
<a name="l00283"></a>00283 
<a name="l00284"></a>00284   <span class="comment">/* finally, hijack the main solver&apos;s dissipation function pointer</span>
<a name="l00285"></a>00285 <span class="comment">   * to this model&apos;s own function, since it&apos;s difficult to express </span>
<a name="l00286"></a>00286 <span class="comment">   * the dissipation terms in the general form                      */</span>
<a name="l00287"></a>00287   solver-&gt;<a class="code" href="a00015.html#a75e8be4ea8c1ae2e99fc1e802e69a573">ParabolicFunction</a> = <a class="code" href="a00285.html#afddc08f58a2046af9ebcc82d06efccb5">NavierStokes3DParabolicFunction</a>;
<a name="l00288"></a>00288 
<a name="l00289"></a>00289   <span class="comment">/* allocate array to hold the gravity field */</span>
<a name="l00290"></a>00290   <span class="keywordtype">int</span> *dim    = solver-&gt;<a class="code" href="a00015.html#a38e0371f331cecbe63a77fa03e202afe">dim_local</a>;
<a name="l00291"></a>00291   <span class="keywordtype">int</span> ghosts  = solver-&gt;<a class="code" href="a00015.html#aafc992b5fa79d5a4036024615d03bce6">ghosts</a>;
<a name="l00292"></a>00292   <span class="keywordtype">int</span> d, size = 1; for (d=0; d&lt;<a class="code" href="a00047.html#a57771c952ec174601addf43e1c0202b2">_MODEL_NDIMS_</a>; d++) size *= (dim[d] + 2*ghosts);
<a name="l00293"></a>00293   physics-&gt;<a class="code" href="a00022.html#aed6abeb9de440ef71c2709218395317d">grav_field_f</a> = (<span class="keywordtype">double</span>*) calloc (size, <span class="keyword">sizeof</span>(<span class="keywordtype">double</span>));
<a name="l00294"></a>00294   physics-&gt;<a class="code" href="a00022.html#ad2261e3953cff99f1593f3b326312f28">grav_field_g</a> = (<span class="keywordtype">double</span>*) calloc (size, <span class="keyword">sizeof</span>(<span class="keywordtype">double</span>));
<a name="l00295"></a>00295   <span class="comment">/* allocate arrays to hold the fast Jacobian for split form of the hyperbolic flux */</span>
<a name="l00296"></a>00296   physics-&gt;<a class="code" href="a00022.html#a14af7516371abe115b3a1aa9269aebb5">fast_jac</a>     = (<span class="keywordtype">double</span>*) calloc (_MODEL_NDIMS_*size*<a class="code" href="a00047.html#ad3395a55a5fde64d6603c7a82d7bf2c7">_MODEL_NVARS_</a>*<a class="code" href="a00047.html#ad3395a55a5fde64d6603c7a82d7bf2c7">_MODEL_NVARS_</a>,<span class="keyword">sizeof</span>(<span class="keywordtype">double</span>));
<a name="l00297"></a>00297   physics-&gt;<a class="code" href="a00022.html#a5e98bc441f5d361be0dd5f13bce1257e">solution</a>     = (<span class="keywordtype">double</span>*) calloc (size*_MODEL_NVARS_,<span class="keyword">sizeof</span>(<span class="keywordtype">double</span>));
<a name="l00298"></a>00298   <span class="comment">/* initialize the gravity fields */</span>
<a name="l00299"></a>00299   <a class="code" href="a00036.html#ad6ab74942c9de13cf0b4c12eb0d91780">IERR</a> <a class="code" href="a00282.html#ab5d4daeb6c2e758d8159c5b059cf9145">NavierStokes3DGravityField</a>(solver,mpi); <a class="code" href="a00036.html#add9cf96ae374934d245a1dc1ab697a42">CHECKERR</a>(ierr);
<a name="l00300"></a>00300 
<a name="l00301"></a>00301   <span class="keywordflow">return</span>(0);
<a name="l00302"></a>00302 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a5467b4e62f223583e901763082eb0d57"></a><!-- doxytag: member="navierstokes3d.h::NavierStokes3DCleanup" ref="a5467b4e62f223583e901763082eb0d57" args="(void *)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int NavierStokes3DCleanup </td>
          <td>(</td>
          <td class="paramtype">void *&nbsp;</td>
          <td class="paramname"> <em>s</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Function to clean up all allocations in the 3D Navier Stokes module. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>s</em>&nbsp;</td><td>Object of type <a class="el" href="a00022.html" title="Structure containing variables and parameters specific to the 3D Navier Stokes equations...">NavierStokes3D</a> </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="a00277_source.html#l00011">11</a> of file <a class="el" href="a00277_source.html">NavierStokes3DCleanup.c</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00012"></a>00012 {
<a name="l00013"></a>00013   <a class="code" href="a00022.html" title="Structure containing variables and parameters specific to the 3D Navier Stokes equations...">NavierStokes3D</a>  *param  = (<a class="code" href="a00022.html" title="Structure containing variables and parameters specific to the 3D Navier Stokes equations...">NavierStokes3D</a>*) s;
<a name="l00014"></a>00014 
<a name="l00015"></a>00015   free(param-&gt;<a class="code" href="a00022.html#aed6abeb9de440ef71c2709218395317d">grav_field_f</a>);
<a name="l00016"></a>00016   free(param-&gt;<a class="code" href="a00022.html#ad2261e3953cff99f1593f3b326312f28">grav_field_g</a>);
<a name="l00017"></a>00017   free(param-&gt;<a class="code" href="a00022.html#a14af7516371abe115b3a1aa9269aebb5">fast_jac</a>);
<a name="l00018"></a>00018   free(param-&gt;<a class="code" href="a00022.html#a5e98bc441f5d361be0dd5f13bce1257e">solution</a>);
<a name="l00019"></a>00019   <span class="keywordflow">return</span>(0);
<a name="l00020"></a>00020 }
</pre></div></p>

</div>
</div>
</div>
<!-- Start of StatCounter Code for Default Guide -->
<script type="text/javascript">
var sc_project=10897352; 
var sc_invisible=1; 
var sc_security="83042f57"; 
var scJsHost = (("https:" == document.location.protocol) ?
"https://secure." : "http://www.");
document.write("<sc"+"ript type='text/javascript' src='" +
scJsHost+
"statcounter.com/counter/counter.js'></"+"script>");
</script>
<noscript><div class="statcounter"><a title="website
statistics" href="http://statcounter.com/"
target="_blank"><img class="statcounter"
src="//c.statcounter.com/10897352/0/83042f57/1/"
alt="website statistics"></a></div></noscript>
<!-- End of StatCounter Code for Default Guide -->
