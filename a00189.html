<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.5"/>
<title>HyPar: include/boundaryconditions.h File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script><script src="http://cdn.mathjax.org/mathjax/latest/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="doxygen_html_style.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">HyPar
   &#160;<span id="projectnumber">1.0</span>
   </div>
   <div id="projectbrief">Finite-Difference Hyperbolic-Parabolic PDE Solver on Cartesian Grids</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.5 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Structures</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>Globals</span></a></li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('a00189.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Data Structures</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Namespaces</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Macros</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Pages</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#nested-classes">Data Structures</a> &#124;
<a href="#define-members">Macros</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">boundaryconditions.h File Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>Containts the structures and definitions for boundary condition implementation.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &lt;<a class="el" href="a00188_source.html">basic.h</a>&gt;</code><br/>
</div>
<p><a href="a00189_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="nested-classes"></a>
Data Structures</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00155.html">DomainBoundary</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Structure containing the variables and function pointers defining a boundary.  <a href="a00155.html#details">More...</a><br/></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:a65ffa4253dee762c65092abcf04ecdee"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00189.html#a65ffa4253dee762c65092abcf04ecdee">_PERIODIC_</a>&#160;&#160;&#160;&quot;periodic&quot;</td></tr>
<tr class="separator:a65ffa4253dee762c65092abcf04ecdee"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a53da239cc00a2394faa0637dad4d0a0c"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00189.html#a53da239cc00a2394faa0637dad4d0a0c">_EXTRAPOLATE_</a>&#160;&#160;&#160;&quot;extrapolate&quot;</td></tr>
<tr class="separator:a53da239cc00a2394faa0637dad4d0a0c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7b8553c8fd765568f7355cf32b93b20d"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00189.html#a7b8553c8fd765568f7355cf32b93b20d">_DIRICHLET_</a>&#160;&#160;&#160;&quot;dirichlet&quot;</td></tr>
<tr class="separator:a7b8553c8fd765568f7355cf32b93b20d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5838171ba57a2dd67065aafce7ff97ac"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00189.html#a5838171ba57a2dd67065aafce7ff97ac">_REFLECT_</a>&#160;&#160;&#160;&quot;reflect&quot;</td></tr>
<tr class="separator:a5838171ba57a2dd67065aafce7ff97ac"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab02c004c9707df0589311375014dc666"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00189.html#ab02c004c9707df0589311375014dc666">_SPONGE_</a>&#160;&#160;&#160;&quot;sponge&quot;</td></tr>
<tr class="separator:ab02c004c9707df0589311375014dc666"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:affb6a9c452f92435e738bd59b9c98935"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00189.html#affb6a9c452f92435e738bd59b9c98935">_NOSLIP_WALL_</a>&#160;&#160;&#160;&quot;noslip-wall&quot;</td></tr>
<tr class="separator:affb6a9c452f92435e738bd59b9c98935"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8e1e1ee6a2a121618e124cad69c8739c"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00189.html#a8e1e1ee6a2a121618e124cad69c8739c">_THERMAL_NOSLIP_WALL_</a>&#160;&#160;&#160;&quot;thermal-noslip-wall&quot;</td></tr>
<tr class="separator:a8e1e1ee6a2a121618e124cad69c8739c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af3a9f3ba15bc914ed0a88295aee147e8"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00189.html#af3a9f3ba15bc914ed0a88295aee147e8">_SLIP_WALL_</a>&#160;&#160;&#160;&quot;slip-wall&quot;</td></tr>
<tr class="separator:af3a9f3ba15bc914ed0a88295aee147e8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1fb5767ea5e8c4f48969ff25eae1ddaf"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00189.html#a1fb5767ea5e8c4f48969ff25eae1ddaf">_THERMAL_SLIP_WALL_</a>&#160;&#160;&#160;&quot;thermal-slip-wall&quot;</td></tr>
<tr class="separator:a1fb5767ea5e8c4f48969ff25eae1ddaf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adba2024137894c96339af50efabe3771"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00189.html#adba2024137894c96339af50efabe3771">_SUBSONIC_INFLOW_</a>&#160;&#160;&#160;&quot;subsonic-inflow&quot;</td></tr>
<tr class="separator:adba2024137894c96339af50efabe3771"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adeb38801d1b832ce3eee3ebc1eed6263"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00189.html#adeb38801d1b832ce3eee3ebc1eed6263">_SUBSONIC_OUTFLOW_</a>&#160;&#160;&#160;&quot;subsonic-outflow&quot;</td></tr>
<tr class="separator:adeb38801d1b832ce3eee3ebc1eed6263"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aac7250bf34e60e7df688d3cf7355855c"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00189.html#aac7250bf34e60e7df688d3cf7355855c">_SUBSONIC_AMBIVALENT_</a>&#160;&#160;&#160;&quot;subsonic-ambivalent&quot;</td></tr>
<tr class="separator:aac7250bf34e60e7df688d3cf7355855c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5c9f9f3c97682664b0fe253e10863b57"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00189.html#a5c9f9f3c97682664b0fe253e10863b57">_SUPERSONIC_INFLOW_</a>&#160;&#160;&#160;&quot;supersonic-inflow&quot;</td></tr>
<tr class="separator:a5c9f9f3c97682664b0fe253e10863b57"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5a9ba63c6c48e0831e379e03a72c0047"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00189.html#a5a9ba63c6c48e0831e379e03a72c0047">_SUPERSONIC_OUTFLOW_</a>&#160;&#160;&#160;&quot;supersonic-outflow&quot;</td></tr>
<tr class="separator:a5a9ba63c6c48e0831e379e03a72c0047"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9b20b4f17d0f550f5da42946cc8a5b4a"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00189.html#a9b20b4f17d0f550f5da42946cc8a5b4a">_TURBULENT_SUPERSONIC_INFLOW_</a>&#160;&#160;&#160;&quot;turbulent-supersonic-inflow&quot;</td></tr>
<tr class="separator:a9b20b4f17d0f550f5da42946cc8a5b4a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af6add2fbe449fa25b80c01abd7564574"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00189.html#af6add2fbe449fa25b80c01abd7564574">_NO_FLUX_BC_</a>&#160;&#160;&#160;&quot;numa-nfbc&quot;</td></tr>
<tr class="separator:af6add2fbe449fa25b80c01abd7564574"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6cd5a586de4ae1a3b73884d62f76bdee"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00189.html#a6cd5a586de4ae1a3b73884d62f76bdee">_SW_SLIP_WALL_</a>&#160;&#160;&#160;&quot;shallow-water-slip-wall&quot;</td></tr>
<tr class="separator:a6cd5a586de4ae1a3b73884d62f76bdee"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab8248be9e215df26dfce851b1acc54ec"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00189.html#ab8248be9e215df26dfce851b1acc54ec">_SW_NOSLIP_WALL_</a>&#160;&#160;&#160;&quot;shallow-water-noslip-wall&quot;</td></tr>
<tr class="separator:ab8248be9e215df26dfce851b1acc54ec"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:ac12085fd970427feca33543fd1257b15"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00189.html#ac12085fd970427feca33543fd1257b15">BCInitialize</a> (void *)</td></tr>
<tr class="separator:ac12085fd970427feca33543fd1257b15"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af38bba62aa7b0f51ee9123ced0c46f24"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00189.html#af38bba62aa7b0f51ee9123ced0c46f24">BCCleanup</a> (void *)</td></tr>
<tr class="separator:af38bba62aa7b0f51ee9123ced0c46f24"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a760f1362e8f287b242b3cd869668f2e9"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00189.html#a760f1362e8f287b242b3cd869668f2e9">BCPeriodicU</a> (void *, void *, int, int, int *, int, double *, double)</td></tr>
<tr class="separator:a760f1362e8f287b242b3cd869668f2e9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aec11d279de28af8bc36e9462485aedbd"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00189.html#aec11d279de28af8bc36e9462485aedbd">BCExtrapolateU</a> (void *, void *, int, int, int *, int, double *, double)</td></tr>
<tr class="separator:aec11d279de28af8bc36e9462485aedbd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad9d2689e44a644319a6cc72249c68e49"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00189.html#ad9d2689e44a644319a6cc72249c68e49">BCDirichletU</a> (void *, void *, int, int, int *, int, double *, double)</td></tr>
<tr class="separator:ad9d2689e44a644319a6cc72249c68e49"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9a0a6df7b555f4eea004e79de223abf8"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00189.html#a9a0a6df7b555f4eea004e79de223abf8">BCReflectU</a> (void *, void *, int, int, int *, int, double *, double)</td></tr>
<tr class="separator:a9a0a6df7b555f4eea004e79de223abf8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae8b2fd391e2c966afad4c4910eff0ffc"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00189.html#ae8b2fd391e2c966afad4c4910eff0ffc">BCNoslipWallU</a> (void *, void *, int, int, int *, int, double *, double)</td></tr>
<tr class="separator:ae8b2fd391e2c966afad4c4910eff0ffc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8beb5adb606b8dbe322d0b2267bc0463"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00189.html#a8beb5adb606b8dbe322d0b2267bc0463">BCThermalNoslipWallU</a> (void *, void *, int, int, int *, int, double *, double)</td></tr>
<tr class="separator:a8beb5adb606b8dbe322d0b2267bc0463"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aba3141eae84ed7f5b2cadefdcc207173"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00189.html#aba3141eae84ed7f5b2cadefdcc207173">BCSlipWallU</a> (void *, void *, int, int, int *, int, double *, double)</td></tr>
<tr class="separator:aba3141eae84ed7f5b2cadefdcc207173"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a30077b675efd008f1cd3bc0e1f0692a3"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00189.html#a30077b675efd008f1cd3bc0e1f0692a3">BCThermalSlipWallU</a> (void *, void *, int, int, int *, int, double *, double)</td></tr>
<tr class="separator:a30077b675efd008f1cd3bc0e1f0692a3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1fa2ad192d85d7f6e958f845d151af10"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00189.html#a1fa2ad192d85d7f6e958f845d151af10">BCSubsonicInflowU</a> (void *, void *, int, int, int *, int, double *, double)</td></tr>
<tr class="separator:a1fa2ad192d85d7f6e958f845d151af10"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a59d7e501f46ad50d2649895a715fe370"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00189.html#a59d7e501f46ad50d2649895a715fe370">BCSubsonicOutflowU</a> (void *, void *, int, int, int *, int, double *, double)</td></tr>
<tr class="separator:a59d7e501f46ad50d2649895a715fe370"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a83bc6c5b45955f8ebe750503f5987a29"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00189.html#a83bc6c5b45955f8ebe750503f5987a29">BCSubsonicAmbivalentU</a> (void *, void *, int, int, int *, int, double *, double)</td></tr>
<tr class="separator:a83bc6c5b45955f8ebe750503f5987a29"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a51cb1555c54105533ae5668cf5ea8a68"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00189.html#a51cb1555c54105533ae5668cf5ea8a68">BCSupersonicInflowU</a> (void *, void *, int, int, int *, int, double *, double)</td></tr>
<tr class="separator:a51cb1555c54105533ae5668cf5ea8a68"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aeceb8d75046193135c6277bf1bf342bd"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00189.html#aeceb8d75046193135c6277bf1bf342bd">BCSupersonicOutflowU</a> (void *, void *, int, int, int *, int, double *, double)</td></tr>
<tr class="separator:aeceb8d75046193135c6277bf1bf342bd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aad04621186800a19145dcf024fbccc3e"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00189.html#aad04621186800a19145dcf024fbccc3e">BCTurbulentSupersonicInflowU</a> (void *, void *, int, int, int *, int, double *, double)</td></tr>
<tr class="separator:aad04621186800a19145dcf024fbccc3e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adb156eee1d509ee6500ffe20dce7811d"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00189.html#adb156eee1d509ee6500ffe20dce7811d">BCNoFluxU</a> (void *, void *, int, int, int *, int, double *, double)</td></tr>
<tr class="separator:adb156eee1d509ee6500ffe20dce7811d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6904fb76cd1fe7638108e1ffdcf1a6ad"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00189.html#a6904fb76cd1fe7638108e1ffdcf1a6ad">BCSWSlipWallU</a> (void *, void *, int, int, int *, int, double *, double)</td></tr>
<tr class="separator:a6904fb76cd1fe7638108e1ffdcf1a6ad"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a49368bf44f300143cd9ec18d10b37a23"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00189.html#a49368bf44f300143cd9ec18d10b37a23">BCSpongeSource</a> (void *, int, int, int, int *, double *, double *, double *)</td></tr>
<tr class="separator:a49368bf44f300143cd9ec18d10b37a23"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a88f1e5079fc6c8b753e77cc85c21cb5b"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00189.html#a88f1e5079fc6c8b753e77cc85c21cb5b">BCSpongeUDummy</a> (void *, void *, int, int, int *, int, double *, double)</td></tr>
<tr class="separator:a88f1e5079fc6c8b753e77cc85c21cb5b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0feed0764d1dafc0d4313a9b12cadd9d"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00189.html#a0feed0764d1dafc0d4313a9b12cadd9d">BCReadTemperatureData</a> (void *, void *, int, int, int *)</td></tr>
<tr class="separator:a0feed0764d1dafc0d4313a9b12cadd9d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6cc369236fbfe94bff52c55175cfaba7"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00189.html#a6cc369236fbfe94bff52c55175cfaba7">BCReadTurbulentInflowData</a> (void *, void *, int, int, int *)</td></tr>
<tr class="separator:a6cc369236fbfe94bff52c55175cfaba7"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Containts the structures and definitions for boundary condition implementation. </p>
<dl class="section author"><dt>Author</dt><dd>Debojyoti Ghosh </dd></dl>

<p>Definition in file <a class="el" href="a00189_source.html">boundaryconditions.h</a>.</p>
</div><h2 class="groupheader">Macro Definition Documentation</h2>
<a class="anchor" id="a65ffa4253dee762c65092abcf04ecdee"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define _PERIODIC_&#160;&#160;&#160;&quot;periodic&quot;</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Periodic boundary conditions </p>
<dl class="section see"><dt>See Also</dt><dd><a class="el" href="a00232.html#ae7c327565752b28cc8313423478efc92">BCPeriodicU</a> </dd></dl>

<p>Definition at line <a class="el" href="a00189_source.html#l00012">12</a> of file <a class="el" href="a00189_source.html">boundaryconditions.h</a>.</p>

</div>
</div>
<a class="anchor" id="a53da239cc00a2394faa0637dad4d0a0c"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define _EXTRAPOLATE_&#160;&#160;&#160;&quot;extrapolate&quot;</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Extrapolative boundary conditions (values at ghost cells are copied from interior) </p>
<dl class="section see"><dt>See Also</dt><dd><a class="el" href="a00227.html#ae25dbd294ea08dc2b5c5bfcdaab0cdfc">BCExtrapolateU</a> </dd></dl>

<p>Definition at line <a class="el" href="a00189_source.html#l00014">14</a> of file <a class="el" href="a00189_source.html">boundaryconditions.h</a>.</p>

</div>
</div>
<a class="anchor" id="a7b8553c8fd765568f7355cf32b93b20d"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define _DIRICHLET_&#160;&#160;&#160;&quot;dirichlet&quot;</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Dirichlet boundary conditions (values at ghost cells specified through input) </p>
<dl class="section see"><dt>See Also</dt><dd><a class="el" href="a00226.html#aff556c3ed9f4a947436d47c58ea5983e">BCDirichletU</a> </dd></dl>

<p>Definition at line <a class="el" href="a00189_source.html#l00016">16</a> of file <a class="el" href="a00189_source.html">boundaryconditions.h</a>.</p>

</div>
</div>
<a class="anchor" id="a5838171ba57a2dd67065aafce7ff97ac"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define _REFLECT_&#160;&#160;&#160;&quot;reflect&quot;</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Reflective boundary conditions (values at ghost cells negative of interior) </p>
<dl class="section see"><dt>See Also</dt><dd><a class="el" href="a00233.html#a262943d07ca8e576f79b36846a43e103">BCReflectU</a> </dd></dl>

<p>Definition at line <a class="el" href="a00189_source.html#l00018">18</a> of file <a class="el" href="a00189_source.html">boundaryconditions.h</a>.</p>

</div>
</div>
<a class="anchor" id="ab02c004c9707df0589311375014dc666"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define _SPONGE_&#160;&#160;&#160;&quot;sponge&quot;</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Sponge boundary conditions </p>
<dl class="section see"><dt>See Also</dt><dd><a class="el" href="a00235.html#a2d82f4205eff408d6cd66cf08c2ed5d6">BCSpongeSource</a>, <a class="el" href="a00235.html#ac58466ec027b61b9f3b23cf2940041da">BCSpongeUDummy</a> </dd></dl>

<p>Definition at line <a class="el" href="a00189_source.html#l00020">20</a> of file <a class="el" href="a00189_source.html">boundaryconditions.h</a>.</p>

</div>
</div>
<a class="anchor" id="affb6a9c452f92435e738bd59b9c98935"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define _NOSLIP_WALL_&#160;&#160;&#160;&quot;noslip-wall&quot;</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Viscous wall boundary condition (specific to Navier-Stokes) </p>
<dl class="section see"><dt>See Also</dt><dd><a class="el" href="a00231.html#a1384d5e7d1060dea6c26b2aa8988c47b">BCNoslipWallU</a> </dd></dl>

<p>Definition at line <a class="el" href="a00189_source.html#l00024">24</a> of file <a class="el" href="a00189_source.html">boundaryconditions.h</a>.</p>

</div>
</div>
<a class="anchor" id="a8e1e1ee6a2a121618e124cad69c8739c"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define _THERMAL_NOSLIP_WALL_&#160;&#160;&#160;&quot;thermal-noslip-wall&quot;</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Viscous thermal wall boundary condition where wall temperature is specified (specific to Navier-Stokes) </p>
<dl class="section see"><dt>See Also</dt><dd><a class="el" href="a00242.html#ab17f965ac7dd617a92c7191ff65ee82b">BCThermalNoslipWallU</a> </dd></dl>

<p>Definition at line <a class="el" href="a00189_source.html#l00026">26</a> of file <a class="el" href="a00189_source.html">boundaryconditions.h</a>.</p>

</div>
</div>
<a class="anchor" id="af3a9f3ba15bc914ed0a88295aee147e8"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define _SLIP_WALL_&#160;&#160;&#160;&quot;slip-wall&quot;</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Inviscid wall boundary condition (specific to Euler/Navier-Stokes) </p>
<dl class="section see"><dt>See Also</dt><dd><a class="el" href="a00234.html#abdeb4e91e1441a25130cb2d3a1be09b0">BCSlipWallU</a> </dd></dl>

<p>Definition at line <a class="el" href="a00189_source.html#l00028">28</a> of file <a class="el" href="a00189_source.html">boundaryconditions.h</a>.</p>

</div>
</div>
<a class="anchor" id="a1fb5767ea5e8c4f48969ff25eae1ddaf"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define _THERMAL_SLIP_WALL_&#160;&#160;&#160;&quot;thermal-slip-wall&quot;</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Inviscid thermal wall boundary condition where wall temperature is specified (specific to Euler/Navier-Stokes) </p>
<dl class="section see"><dt>See Also</dt><dd><a class="el" href="a00243.html#ad95232382b3a4969eb8e2212e00f032a">BCThermalSlipWallU</a> </dd></dl>

<p>Definition at line <a class="el" href="a00189_source.html#l00030">30</a> of file <a class="el" href="a00189_source.html">boundaryconditions.h</a>.</p>

</div>
</div>
<a class="anchor" id="adba2024137894c96339af50efabe3771"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define _SUBSONIC_INFLOW_&#160;&#160;&#160;&quot;subsonic-inflow&quot;</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Subsonic inflow boundary condition: density and velocity are specified in the input, pressure is extrapolated from the interior (specific to Euler/Navier-Stokes) </p>
<dl class="section see"><dt>See Also</dt><dd><a class="el" href="a00237.html#a9c5eb47fb65476896445cc90ec945312">BCSubsonicInflowU</a> </dd></dl>

<p>Definition at line <a class="el" href="a00189_source.html#l00032">32</a> of file <a class="el" href="a00189_source.html">boundaryconditions.h</a>.</p>

</div>
</div>
<a class="anchor" id="adeb38801d1b832ce3eee3ebc1eed6263"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define _SUBSONIC_OUTFLOW_&#160;&#160;&#160;&quot;subsonic-outflow&quot;</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Subsonic outflow boundary condition: pressure is specified in the input, density and velocity are extrapolated from the interior (specific to Euler/Navier-Stokes) </p>
<dl class="section see"><dt>See Also</dt><dd><a class="el" href="a00238.html#aea51db89a0a00f1c9b8288f9ebc059c6">BCSubsonicOutflowU</a> </dd></dl>

<p>Definition at line <a class="el" href="a00189_source.html#l00034">34</a> of file <a class="el" href="a00189_source.html">boundaryconditions.h</a>.</p>

</div>
</div>
<a class="anchor" id="aac7250bf34e60e7df688d3cf7355855c"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define _SUBSONIC_AMBIVALENT_&#160;&#160;&#160;&quot;subsonic-ambivalent&quot;</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Subsonic "ambivalent" boundary condition: (specific to Euler/Navier-Stokes) the velocity at the boundary is extrapolated from the interior, and based on that, either subsonic outflow or inflow boundary conditions are applied. Specify all flow quantities (density, velocity, and pressure) in the input; depending on whether it is inflow or outflow, the appropriate quantities will be used. </p>
<dl class="section see"><dt>See Also</dt><dd><a class="el" href="a00236.html#aa06b35b07659fa413f72a90372e325d0">BCSubsonicAmbivalentU</a> </dd></dl>

<p>Definition at line <a class="el" href="a00189_source.html#l00039">39</a> of file <a class="el" href="a00189_source.html">boundaryconditions.h</a>.</p>

</div>
</div>
<a class="anchor" id="a5c9f9f3c97682664b0fe253e10863b57"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define _SUPERSONIC_INFLOW_&#160;&#160;&#160;&quot;supersonic-inflow&quot;</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Supersonic inflow boundary condition: density, velocity, and pressure are specified in the input (specific to Euler/Navier-Stokes) </p>
<dl class="section see"><dt>See Also</dt><dd><a class="el" href="a00239.html#a27201c4605999bdb8b84e8e19426de85">BCSupersonicInflowU</a> </dd></dl>

<p>Definition at line <a class="el" href="a00189_source.html#l00041">41</a> of file <a class="el" href="a00189_source.html">boundaryconditions.h</a>.</p>

</div>
</div>
<a class="anchor" id="a5a9ba63c6c48e0831e379e03a72c0047"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define _SUPERSONIC_OUTFLOW_&#160;&#160;&#160;&quot;supersonic-outflow&quot;</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Supersonic outflow boundary condition: all flow quantities are extrapolated from the interior (specific to Euler/Navier-Stokes) </p>
<dl class="section see"><dt>See Also</dt><dd><a class="el" href="a00240.html#a791e37fae3c9489d0fc039102c57409e">BCSupersonicOutflowU</a> </dd></dl>

<p>Definition at line <a class="el" href="a00189_source.html#l00043">43</a> of file <a class="el" href="a00189_source.html">boundaryconditions.h</a>.</p>

</div>
</div>
<a class="anchor" id="a9b20b4f17d0f550f5da42946cc8a5b4a"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define _TURBULENT_SUPERSONIC_INFLOW_&#160;&#160;&#160;&quot;turbulent-supersonic-inflow&quot;</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Turbulent, supersonic inflow boundary condition: density, velocity, and pressure are specified in the input, along with turbulent fluctuations (specific to Euler/Navier-Stokes) </p>
<dl class="section see"><dt>See Also</dt><dd><a class="el" href="a00244.html#aff45ce4055fde7a8f9579686e8e08d82">BCTurbulentSupersonicInflowU</a>, <a class="el" href="a00229.html#ae90485b7beacc863180d194634c9e6d5">BCReadTurbulentInflowData</a> </dd></dl>

<p>Definition at line <a class="el" href="a00189_source.html#l00045">45</a> of file <a class="el" href="a00189_source.html">boundaryconditions.h</a>.</p>

</div>
</div>
<a class="anchor" id="af6add2fbe449fa25b80c01abd7564574"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define _NO_FLUX_BC_&#160;&#160;&#160;&quot;numa-nfbc&quot;</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>No-flux boundary condition (specific to NUMA) </p>
<dl class="section see"><dt>See Also</dt><dd><a class="el" href="a00230.html#a47f15d0ef1040bf42b53bd882d612b54">BCNoFluxU</a> </dd></dl>

<p>Definition at line <a class="el" href="a00189_source.html#l00049">49</a> of file <a class="el" href="a00189_source.html">boundaryconditions.h</a>.</p>

</div>
</div>
<a class="anchor" id="a6cd5a586de4ae1a3b73884d62f76bdee"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define _SW_SLIP_WALL_&#160;&#160;&#160;&quot;shallow-water-slip-wall&quot;</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Slip boundary condition (specific to shallow water equations) </p>
<dl class="section see"><dt>See Also</dt><dd><a class="el" href="a00241.html#a7cffeb6ede7dbf886b8970fd0d584961">BCSWSlipWallU</a> </dd></dl>

<p>Definition at line <a class="el" href="a00189_source.html#l00053">53</a> of file <a class="el" href="a00189_source.html">boundaryconditions.h</a>.</p>

</div>
</div>
<a class="anchor" id="ab8248be9e215df26dfce851b1acc54ec"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define _SW_NOSLIP_WALL_&#160;&#160;&#160;&quot;shallow-water-noslip-wall&quot;</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Viscous wall boundary condition (specific to shallow water equations) (not implemented yet) </p>

<p>Definition at line <a class="el" href="a00189_source.html#l00055">55</a> of file <a class="el" href="a00189_source.html">boundaryconditions.h</a>.</p>

</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a class="anchor" id="ac12085fd970427feca33543fd1257b15"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int BCInitialize </td>
          <td>(</td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>b</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Function to initialize the boundary conditions</p>
<p>Assign the function pointers for boundary condition application depending on the boundary type, for a given boundary object </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">b</td><td>Boundary object of type <a class="el" href="a00155.html" title="Structure containing the variables and function pointers defining a boundary. ">DomainBoundary</a> </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="a00228_source.html#l00012">12</a> of file <a class="el" href="a00228_source.html">BCInitialize.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;{</div>
<div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;  <a class="code" href="a00155.html">DomainBoundary</a> *boundary = (<a class="code" href="a00155.html">DomainBoundary</a>*) b;</div>
<div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;</div>
<div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;  <span class="keywordflow">if</span>      (!strcmp(boundary-&gt;<a class="code" href="a00155.html#a430ec6bfcdd38ab8e86545e25bc22613">bctype</a>,<a class="code" href="a00189.html#a65ffa4253dee762c65092abcf04ecdee">_PERIODIC_</a>                    )) boundary-&gt;<a class="code" href="a00155.html#ad74c432793b0da4841b50ee718ed556e">BCFunctionU</a> = <a class="code" href="a00189.html#a760f1362e8f287b242b3cd869668f2e9">BCPeriodicU</a>;</div>
<div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;  <span class="keywordflow">else</span> if (!strcmp(boundary-&gt;<a class="code" href="a00155.html#a430ec6bfcdd38ab8e86545e25bc22613">bctype</a>,<a class="code" href="a00189.html#a53da239cc00a2394faa0637dad4d0a0c">_EXTRAPOLATE_</a>                 )) boundary-&gt;<a class="code" href="a00155.html#ad74c432793b0da4841b50ee718ed556e">BCFunctionU</a> = <a class="code" href="a00189.html#aec11d279de28af8bc36e9462485aedbd">BCExtrapolateU</a>;</div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;  <span class="keywordflow">else</span> if (!strcmp(boundary-&gt;<a class="code" href="a00155.html#a430ec6bfcdd38ab8e86545e25bc22613">bctype</a>,<a class="code" href="a00189.html#a7b8553c8fd765568f7355cf32b93b20d">_DIRICHLET_</a>                   )) boundary-&gt;<a class="code" href="a00155.html#ad74c432793b0da4841b50ee718ed556e">BCFunctionU</a> = <a class="code" href="a00189.html#ad9d2689e44a644319a6cc72249c68e49">BCDirichletU</a>;  </div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;  <span class="keywordflow">else</span> if (!strcmp(boundary-&gt;<a class="code" href="a00155.html#a430ec6bfcdd38ab8e86545e25bc22613">bctype</a>,<a class="code" href="a00189.html#a5838171ba57a2dd67065aafce7ff97ac">_REFLECT_</a>                     )) boundary-&gt;<a class="code" href="a00155.html#ad74c432793b0da4841b50ee718ed556e">BCFunctionU</a> = <a class="code" href="a00189.html#a9a0a6df7b555f4eea004e79de223abf8">BCReflectU</a>;    </div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;  <span class="keywordflow">else</span> if (!strcmp(boundary-&gt;<a class="code" href="a00155.html#a430ec6bfcdd38ab8e86545e25bc22613">bctype</a>,<a class="code" href="a00189.html#ab02c004c9707df0589311375014dc666">_SPONGE_</a>                      )) boundary-&gt;<a class="code" href="a00155.html#ad74c432793b0da4841b50ee718ed556e">BCFunctionU</a> = <a class="code" href="a00189.html#a88f1e5079fc6c8b753e77cc85c21cb5b">BCSpongeUDummy</a>;    </div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;  <span class="keywordflow">else</span> if (!strcmp(boundary-&gt;<a class="code" href="a00155.html#a430ec6bfcdd38ab8e86545e25bc22613">bctype</a>,<a class="code" href="a00189.html#affb6a9c452f92435e738bd59b9c98935">_NOSLIP_WALL_</a>                 )) boundary-&gt;<a class="code" href="a00155.html#ad74c432793b0da4841b50ee718ed556e">BCFunctionU</a> = <a class="code" href="a00189.html#ae8b2fd391e2c966afad4c4910eff0ffc">BCNoslipWallU</a>;    </div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;  <span class="keywordflow">else</span> if (!strcmp(boundary-&gt;<a class="code" href="a00155.html#a430ec6bfcdd38ab8e86545e25bc22613">bctype</a>,<a class="code" href="a00189.html#af3a9f3ba15bc914ed0a88295aee147e8">_SLIP_WALL_</a>                   )) boundary-&gt;<a class="code" href="a00155.html#ad74c432793b0da4841b50ee718ed556e">BCFunctionU</a> = <a class="code" href="a00189.html#aba3141eae84ed7f5b2cadefdcc207173">BCSlipWallU</a>;    </div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;  <span class="keywordflow">else</span> if (!strcmp(boundary-&gt;<a class="code" href="a00155.html#a430ec6bfcdd38ab8e86545e25bc22613">bctype</a>,<a class="code" href="a00189.html#a1fb5767ea5e8c4f48969ff25eae1ddaf">_THERMAL_SLIP_WALL_</a>           )) boundary-&gt;<a class="code" href="a00155.html#ad74c432793b0da4841b50ee718ed556e">BCFunctionU</a> = <a class="code" href="a00189.html#a30077b675efd008f1cd3bc0e1f0692a3">BCThermalSlipWallU</a>;    </div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;  <span class="keywordflow">else</span> if (!strcmp(boundary-&gt;<a class="code" href="a00155.html#a430ec6bfcdd38ab8e86545e25bc22613">bctype</a>,<a class="code" href="a00189.html#a8e1e1ee6a2a121618e124cad69c8739c">_THERMAL_NOSLIP_WALL_</a>         )) boundary-&gt;<a class="code" href="a00155.html#ad74c432793b0da4841b50ee718ed556e">BCFunctionU</a> = <a class="code" href="a00189.html#a8beb5adb606b8dbe322d0b2267bc0463">BCThermalNoslipWallU</a>;    </div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;  <span class="keywordflow">else</span> if (!strcmp(boundary-&gt;<a class="code" href="a00155.html#a430ec6bfcdd38ab8e86545e25bc22613">bctype</a>,<a class="code" href="a00189.html#a6cd5a586de4ae1a3b73884d62f76bdee">_SW_SLIP_WALL_</a>                )) boundary-&gt;<a class="code" href="a00155.html#ad74c432793b0da4841b50ee718ed556e">BCFunctionU</a> = <a class="code" href="a00189.html#a6904fb76cd1fe7638108e1ffdcf1a6ad">BCSWSlipWallU</a>;    </div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;  <span class="keywordflow">else</span> if (!strcmp(boundary-&gt;<a class="code" href="a00155.html#a430ec6bfcdd38ab8e86545e25bc22613">bctype</a>,<a class="code" href="a00189.html#adeb38801d1b832ce3eee3ebc1eed6263">_SUBSONIC_OUTFLOW_</a>            )) boundary-&gt;<a class="code" href="a00155.html#ad74c432793b0da4841b50ee718ed556e">BCFunctionU</a> = <a class="code" href="a00189.html#a59d7e501f46ad50d2649895a715fe370">BCSubsonicOutflowU</a>;    </div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;  <span class="keywordflow">else</span> if (!strcmp(boundary-&gt;<a class="code" href="a00155.html#a430ec6bfcdd38ab8e86545e25bc22613">bctype</a>,<a class="code" href="a00189.html#adba2024137894c96339af50efabe3771">_SUBSONIC_INFLOW_</a>             )) boundary-&gt;<a class="code" href="a00155.html#ad74c432793b0da4841b50ee718ed556e">BCFunctionU</a> = <a class="code" href="a00189.html#a1fa2ad192d85d7f6e958f845d151af10">BCSubsonicInflowU</a>;    </div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;  <span class="keywordflow">else</span> if (!strcmp(boundary-&gt;<a class="code" href="a00155.html#a430ec6bfcdd38ab8e86545e25bc22613">bctype</a>,<a class="code" href="a00189.html#aac7250bf34e60e7df688d3cf7355855c">_SUBSONIC_AMBIVALENT_</a>         )) boundary-&gt;<a class="code" href="a00155.html#ad74c432793b0da4841b50ee718ed556e">BCFunctionU</a> = <a class="code" href="a00189.html#a83bc6c5b45955f8ebe750503f5987a29">BCSubsonicAmbivalentU</a>;    </div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;  <span class="keywordflow">else</span> if (!strcmp(boundary-&gt;<a class="code" href="a00155.html#a430ec6bfcdd38ab8e86545e25bc22613">bctype</a>,<a class="code" href="a00189.html#a5a9ba63c6c48e0831e379e03a72c0047">_SUPERSONIC_OUTFLOW_</a>          )) boundary-&gt;<a class="code" href="a00155.html#ad74c432793b0da4841b50ee718ed556e">BCFunctionU</a> = <a class="code" href="a00189.html#aeceb8d75046193135c6277bf1bf342bd">BCSupersonicOutflowU</a>;    </div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;  <span class="keywordflow">else</span> if (!strcmp(boundary-&gt;<a class="code" href="a00155.html#a430ec6bfcdd38ab8e86545e25bc22613">bctype</a>,<a class="code" href="a00189.html#a5c9f9f3c97682664b0fe253e10863b57">_SUPERSONIC_INFLOW_</a>           )) boundary-&gt;<a class="code" href="a00155.html#ad74c432793b0da4841b50ee718ed556e">BCFunctionU</a> = <a class="code" href="a00189.html#a51cb1555c54105533ae5668cf5ea8a68">BCSupersonicInflowU</a>;    </div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;  <span class="keywordflow">else</span> if (!strcmp(boundary-&gt;<a class="code" href="a00155.html#a430ec6bfcdd38ab8e86545e25bc22613">bctype</a>,<a class="code" href="a00189.html#a9b20b4f17d0f550f5da42946cc8a5b4a">_TURBULENT_SUPERSONIC_INFLOW_</a> )) boundary-&gt;<a class="code" href="a00155.html#ad74c432793b0da4841b50ee718ed556e">BCFunctionU</a> = <a class="code" href="a00189.html#aad04621186800a19145dcf024fbccc3e">BCTurbulentSupersonicInflowU</a>;    </div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;  <span class="keywordflow">else</span> if (!strcmp(boundary-&gt;<a class="code" href="a00155.html#a430ec6bfcdd38ab8e86545e25bc22613">bctype</a>,<a class="code" href="a00189.html#af6add2fbe449fa25b80c01abd7564574">_NO_FLUX_BC_</a>                  )) boundary-&gt;<a class="code" href="a00155.html#ad74c432793b0da4841b50ee718ed556e">BCFunctionU</a> = <a class="code" href="a00189.html#adb156eee1d509ee6500ffe20dce7811d">BCNoFluxU</a>;    </div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;  <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;    fprintf(stderr,<span class="stringliteral">&quot;Error in BCInitialize(): \&quot;%s\&quot; is not a supported boundary condition.\n&quot;</span>,</div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;            boundary-&gt;<a class="code" href="a00155.html#a430ec6bfcdd38ab8e86545e25bc22613">bctype</a>);</div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;    <span class="keywordflow">return</span>(1);</div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;  }</div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;</div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;  <span class="keywordflow">return</span>(0);</div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;}</div>
<div class="ttc" id="a00189_html_a51cb1555c54105533ae5668cf5ea8a68"><div class="ttname"><a href="a00189.html#a51cb1555c54105533ae5668cf5ea8a68">BCSupersonicInflowU</a></div><div class="ttdeci">int BCSupersonicInflowU(void *, void *, int, int, int *, int, double *, double)</div><div class="ttdef"><b>Definition:</b> <a href="a00239_source.html#l00024">BCSupersonicInflow.c:24</a></div></div>
<div class="ttc" id="a00155_html_ad74c432793b0da4841b50ee718ed556e"><div class="ttname"><a href="a00155.html#ad74c432793b0da4841b50ee718ed556e">DomainBoundary::BCFunctionU</a></div><div class="ttdeci">int(* BCFunctionU)(void *, void *, int, int, int *, int, double *, double)</div><div class="ttdef"><b>Definition:</b> <a href="a00189_source.html#l00085">boundaryconditions.h:85</a></div></div>
<div class="ttc" id="a00189_html_adeb38801d1b832ce3eee3ebc1eed6263"><div class="ttname"><a href="a00189.html#adeb38801d1b832ce3eee3ebc1eed6263">_SUBSONIC_OUTFLOW_</a></div><div class="ttdeci">#define _SUBSONIC_OUTFLOW_</div><div class="ttdef"><b>Definition:</b> <a href="a00189_source.html#l00034">boundaryconditions.h:34</a></div></div>
<div class="ttc" id="a00189_html_a8beb5adb606b8dbe322d0b2267bc0463"><div class="ttname"><a href="a00189.html#a8beb5adb606b8dbe322d0b2267bc0463">BCThermalNoslipWallU</a></div><div class="ttdeci">int BCThermalNoslipWallU(void *, void *, int, int, int *, int, double *, double)</div><div class="ttdef"><b>Definition:</b> <a href="a00242_source.html#l00027">BCThermalNoslipWall.c:27</a></div></div>
<div class="ttc" id="a00189_html_a65ffa4253dee762c65092abcf04ecdee"><div class="ttname"><a href="a00189.html#a65ffa4253dee762c65092abcf04ecdee">_PERIODIC_</a></div><div class="ttdeci">#define _PERIODIC_</div><div class="ttdef"><b>Definition:</b> <a href="a00189_source.html#l00012">boundaryconditions.h:12</a></div></div>
<div class="ttc" id="a00189_html_a8e1e1ee6a2a121618e124cad69c8739c"><div class="ttname"><a href="a00189.html#a8e1e1ee6a2a121618e124cad69c8739c">_THERMAL_NOSLIP_WALL_</a></div><div class="ttdeci">#define _THERMAL_NOSLIP_WALL_</div><div class="ttdef"><b>Definition:</b> <a href="a00189_source.html#l00026">boundaryconditions.h:26</a></div></div>
<div class="ttc" id="a00189_html_a5838171ba57a2dd67065aafce7ff97ac"><div class="ttname"><a href="a00189.html#a5838171ba57a2dd67065aafce7ff97ac">_REFLECT_</a></div><div class="ttdeci">#define _REFLECT_</div><div class="ttdef"><b>Definition:</b> <a href="a00189_source.html#l00018">boundaryconditions.h:18</a></div></div>
<div class="ttc" id="a00189_html_a59d7e501f46ad50d2649895a715fe370"><div class="ttname"><a href="a00189.html#a59d7e501f46ad50d2649895a715fe370">BCSubsonicOutflowU</a></div><div class="ttdeci">int BCSubsonicOutflowU(void *, void *, int, int, int *, int, double *, double)</div><div class="ttdef"><b>Definition:</b> <a href="a00238_source.html#l00019">BCSubsonicOutflow.c:19</a></div></div>
<div class="ttc" id="a00189_html_a1fa2ad192d85d7f6e958f845d151af10"><div class="ttname"><a href="a00189.html#a1fa2ad192d85d7f6e958f845d151af10">BCSubsonicInflowU</a></div><div class="ttdeci">int BCSubsonicInflowU(void *, void *, int, int, int *, int, double *, double)</div><div class="ttdef"><b>Definition:</b> <a href="a00237_source.html#l00020">BCSubsonicInflow.c:20</a></div></div>
<div class="ttc" id="a00189_html_a7b8553c8fd765568f7355cf32b93b20d"><div class="ttname"><a href="a00189.html#a7b8553c8fd765568f7355cf32b93b20d">_DIRICHLET_</a></div><div class="ttdeci">#define _DIRICHLET_</div><div class="ttdef"><b>Definition:</b> <a href="a00189_source.html#l00016">boundaryconditions.h:16</a></div></div>
<div class="ttc" id="a00155_html"><div class="ttname"><a href="a00155.html">DomainBoundary</a></div><div class="ttdoc">Structure containing the variables and function pointers defining a boundary. </div><div class="ttdef"><b>Definition:</b> <a href="a00189_source.html#l00068">boundaryconditions.h:68</a></div></div>
<div class="ttc" id="a00189_html_a88f1e5079fc6c8b753e77cc85c21cb5b"><div class="ttname"><a href="a00189.html#a88f1e5079fc6c8b753e77cc85c21cb5b">BCSpongeUDummy</a></div><div class="ttdeci">int BCSpongeUDummy(void *, void *, int, int, int *, int, double *, double)</div><div class="ttdef"><b>Definition:</b> <a href="a00235_source.html#l00073">BCSponge.c:73</a></div></div>
<div class="ttc" id="a00189_html_ab02c004c9707df0589311375014dc666"><div class="ttname"><a href="a00189.html#ab02c004c9707df0589311375014dc666">_SPONGE_</a></div><div class="ttdeci">#define _SPONGE_</div><div class="ttdef"><b>Definition:</b> <a href="a00189_source.html#l00020">boundaryconditions.h:20</a></div></div>
<div class="ttc" id="a00155_html_a430ec6bfcdd38ab8e86545e25bc22613"><div class="ttname"><a href="a00155.html#a430ec6bfcdd38ab8e86545e25bc22613">DomainBoundary::bctype</a></div><div class="ttdeci">char bctype[_MAX_STRING_SIZE_]</div><div class="ttdef"><b>Definition:</b> <a href="a00189_source.html#l00071">boundaryconditions.h:71</a></div></div>
<div class="ttc" id="a00189_html_a1fb5767ea5e8c4f48969ff25eae1ddaf"><div class="ttname"><a href="a00189.html#a1fb5767ea5e8c4f48969ff25eae1ddaf">_THERMAL_SLIP_WALL_</a></div><div class="ttdeci">#define _THERMAL_SLIP_WALL_</div><div class="ttdef"><b>Definition:</b> <a href="a00189_source.html#l00030">boundaryconditions.h:30</a></div></div>
<div class="ttc" id="a00189_html_ae8b2fd391e2c966afad4c4910eff0ffc"><div class="ttname"><a href="a00189.html#ae8b2fd391e2c966afad4c4910eff0ffc">BCNoslipWallU</a></div><div class="ttdeci">int BCNoslipWallU(void *, void *, int, int, int *, int, double *, double)</div><div class="ttdef"><b>Definition:</b> <a href="a00231_source.html#l00020">BCNoslipWall.c:20</a></div></div>
<div class="ttc" id="a00189_html_a9a0a6df7b555f4eea004e79de223abf8"><div class="ttname"><a href="a00189.html#a9a0a6df7b555f4eea004e79de223abf8">BCReflectU</a></div><div class="ttdeci">int BCReflectU(void *, void *, int, int, int *, int, double *, double)</div><div class="ttdef"><b>Definition:</b> <a href="a00233_source.html#l00014">BCReflect.c:14</a></div></div>
<div class="ttc" id="a00189_html_aec11d279de28af8bc36e9462485aedbd"><div class="ttname"><a href="a00189.html#aec11d279de28af8bc36e9462485aedbd">BCExtrapolateU</a></div><div class="ttdeci">int BCExtrapolateU(void *, void *, int, int, int *, int, double *, double)</div><div class="ttdef"><b>Definition:</b> <a href="a00227_source.html#l00013">BCExtrapolate.c:13</a></div></div>
<div class="ttc" id="a00189_html_a53da239cc00a2394faa0637dad4d0a0c"><div class="ttname"><a href="a00189.html#a53da239cc00a2394faa0637dad4d0a0c">_EXTRAPOLATE_</a></div><div class="ttdeci">#define _EXTRAPOLATE_</div><div class="ttdef"><b>Definition:</b> <a href="a00189_source.html#l00014">boundaryconditions.h:14</a></div></div>
<div class="ttc" id="a00189_html_a83bc6c5b45955f8ebe750503f5987a29"><div class="ttname"><a href="a00189.html#a83bc6c5b45955f8ebe750503f5987a29">BCSubsonicAmbivalentU</a></div><div class="ttdeci">int BCSubsonicAmbivalentU(void *, void *, int, int, int *, int, double *, double)</div><div class="ttdef"><b>Definition:</b> <a href="a00236_source.html#l00028">BCSubsonicAmbivalent.c:28</a></div></div>
<div class="ttc" id="a00189_html_a6904fb76cd1fe7638108e1ffdcf1a6ad"><div class="ttname"><a href="a00189.html#a6904fb76cd1fe7638108e1ffdcf1a6ad">BCSWSlipWallU</a></div><div class="ttdeci">int BCSWSlipWallU(void *, void *, int, int, int *, int, double *, double)</div><div class="ttdef"><b>Definition:</b> <a href="a00241_source.html#l00021">BCSWSlipWall.c:21</a></div></div>
<div class="ttc" id="a00189_html_aac7250bf34e60e7df688d3cf7355855c"><div class="ttname"><a href="a00189.html#aac7250bf34e60e7df688d3cf7355855c">_SUBSONIC_AMBIVALENT_</a></div><div class="ttdeci">#define _SUBSONIC_AMBIVALENT_</div><div class="ttdef"><b>Definition:</b> <a href="a00189_source.html#l00039">boundaryconditions.h:39</a></div></div>
<div class="ttc" id="a00189_html_ad9d2689e44a644319a6cc72249c68e49"><div class="ttname"><a href="a00189.html#ad9d2689e44a644319a6cc72249c68e49">BCDirichletU</a></div><div class="ttdeci">int BCDirichletU(void *, void *, int, int, int *, int, double *, double)</div><div class="ttdef"><b>Definition:</b> <a href="a00226_source.html#l00013">BCDirichlet.c:13</a></div></div>
<div class="ttc" id="a00189_html_adba2024137894c96339af50efabe3771"><div class="ttname"><a href="a00189.html#adba2024137894c96339af50efabe3771">_SUBSONIC_INFLOW_</a></div><div class="ttdeci">#define _SUBSONIC_INFLOW_</div><div class="ttdef"><b>Definition:</b> <a href="a00189_source.html#l00032">boundaryconditions.h:32</a></div></div>
<div class="ttc" id="a00189_html_a760f1362e8f287b242b3cd869668f2e9"><div class="ttname"><a href="a00189.html#a760f1362e8f287b242b3cd869668f2e9">BCPeriodicU</a></div><div class="ttdeci">int BCPeriodicU(void *, void *, int, int, int *, int, double *, double)</div><div class="ttdef"><b>Definition:</b> <a href="a00232_source.html#l00019">BCPeriodic.c:19</a></div></div>
<div class="ttc" id="a00189_html_affb6a9c452f92435e738bd59b9c98935"><div class="ttname"><a href="a00189.html#affb6a9c452f92435e738bd59b9c98935">_NOSLIP_WALL_</a></div><div class="ttdeci">#define _NOSLIP_WALL_</div><div class="ttdef"><b>Definition:</b> <a href="a00189_source.html#l00024">boundaryconditions.h:24</a></div></div>
<div class="ttc" id="a00189_html_a6cd5a586de4ae1a3b73884d62f76bdee"><div class="ttname"><a href="a00189.html#a6cd5a586de4ae1a3b73884d62f76bdee">_SW_SLIP_WALL_</a></div><div class="ttdeci">#define _SW_SLIP_WALL_</div><div class="ttdef"><b>Definition:</b> <a href="a00189_source.html#l00053">boundaryconditions.h:53</a></div></div>
<div class="ttc" id="a00189_html_aba3141eae84ed7f5b2cadefdcc207173"><div class="ttname"><a href="a00189.html#aba3141eae84ed7f5b2cadefdcc207173">BCSlipWallU</a></div><div class="ttdeci">int BCSlipWallU(void *, void *, int, int, int *, int, double *, double)</div><div class="ttdef"><b>Definition:</b> <a href="a00234_source.html#l00022">BCSlipWall.c:22</a></div></div>
<div class="ttc" id="a00189_html_a9b20b4f17d0f550f5da42946cc8a5b4a"><div class="ttname"><a href="a00189.html#a9b20b4f17d0f550f5da42946cc8a5b4a">_TURBULENT_SUPERSONIC_INFLOW_</a></div><div class="ttdeci">#define _TURBULENT_SUPERSONIC_INFLOW_</div><div class="ttdef"><b>Definition:</b> <a href="a00189_source.html#l00045">boundaryconditions.h:45</a></div></div>
<div class="ttc" id="a00189_html_adb156eee1d509ee6500ffe20dce7811d"><div class="ttname"><a href="a00189.html#adb156eee1d509ee6500ffe20dce7811d">BCNoFluxU</a></div><div class="ttdeci">int BCNoFluxU(void *, void *, int, int, int *, int, double *, double)</div><div class="ttdef"><b>Definition:</b> <a href="a00230_source.html#l00022">BCNoFlux.c:22</a></div></div>
<div class="ttc" id="a00189_html_af3a9f3ba15bc914ed0a88295aee147e8"><div class="ttname"><a href="a00189.html#af3a9f3ba15bc914ed0a88295aee147e8">_SLIP_WALL_</a></div><div class="ttdeci">#define _SLIP_WALL_</div><div class="ttdef"><b>Definition:</b> <a href="a00189_source.html#l00028">boundaryconditions.h:28</a></div></div>
<div class="ttc" id="a00189_html_a30077b675efd008f1cd3bc0e1f0692a3"><div class="ttname"><a href="a00189.html#a30077b675efd008f1cd3bc0e1f0692a3">BCThermalSlipWallU</a></div><div class="ttdeci">int BCThermalSlipWallU(void *, void *, int, int, int *, int, double *, double)</div><div class="ttdef"><b>Definition:</b> <a href="a00243_source.html#l00027">BCThermalSlipWall.c:27</a></div></div>
<div class="ttc" id="a00189_html_aeceb8d75046193135c6277bf1bf342bd"><div class="ttname"><a href="a00189.html#aeceb8d75046193135c6277bf1bf342bd">BCSupersonicOutflowU</a></div><div class="ttdeci">int BCSupersonicOutflowU(void *, void *, int, int, int *, int, double *, double)</div><div class="ttdef"><b>Definition:</b> <a href="a00240_source.html#l00024">BCSupersonicOutflow.c:24</a></div></div>
<div class="ttc" id="a00189_html_a5c9f9f3c97682664b0fe253e10863b57"><div class="ttname"><a href="a00189.html#a5c9f9f3c97682664b0fe253e10863b57">_SUPERSONIC_INFLOW_</a></div><div class="ttdeci">#define _SUPERSONIC_INFLOW_</div><div class="ttdef"><b>Definition:</b> <a href="a00189_source.html#l00041">boundaryconditions.h:41</a></div></div>
<div class="ttc" id="a00189_html_a5a9ba63c6c48e0831e379e03a72c0047"><div class="ttname"><a href="a00189.html#a5a9ba63c6c48e0831e379e03a72c0047">_SUPERSONIC_OUTFLOW_</a></div><div class="ttdeci">#define _SUPERSONIC_OUTFLOW_</div><div class="ttdef"><b>Definition:</b> <a href="a00189_source.html#l00043">boundaryconditions.h:43</a></div></div>
<div class="ttc" id="a00189_html_af6add2fbe449fa25b80c01abd7564574"><div class="ttname"><a href="a00189.html#af6add2fbe449fa25b80c01abd7564574">_NO_FLUX_BC_</a></div><div class="ttdeci">#define _NO_FLUX_BC_</div><div class="ttdef"><b>Definition:</b> <a href="a00189_source.html#l00049">boundaryconditions.h:49</a></div></div>
<div class="ttc" id="a00189_html_aad04621186800a19145dcf024fbccc3e"><div class="ttname"><a href="a00189.html#aad04621186800a19145dcf024fbccc3e">BCTurbulentSupersonicInflowU</a></div><div class="ttdeci">int BCTurbulentSupersonicInflowU(void *, void *, int, int, int *, int, double *, double)</div><div class="ttdef"><b>Definition:</b> <a href="a00244_source.html#l00021">BCTurbulentSupersonicInflow.c:21</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="af38bba62aa7b0f51ee9123ced0c46f24"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int BCCleanup </td>
          <td>(</td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>b</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Function to clean up boundary conditions-related variables and arrays</p>
<p>Cleans up a boundary object of type <a class="el" href="a00155.html" title="Structure containing the variables and function pointers defining a boundary. ">DomainBoundary</a> </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">b</td><td>Boundary object of type <a class="el" href="a00155.html" title="Structure containing the variables and function pointers defining a boundary. ">DomainBoundary</a> </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="a00225_source.html#l00010">10</a> of file <a class="el" href="a00225_source.html">BCCleanup.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;{</div>
<div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;  <a class="code" href="a00155.html">DomainBoundary</a> *boundary = (<a class="code" href="a00155.html">DomainBoundary</a>*) b;</div>
<div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;  free(boundary-&gt;<a class="code" href="a00155.html#a1e51e79041d5a3dddffb503277703568">xmin</a>);</div>
<div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;  free(boundary-&gt;<a class="code" href="a00155.html#a7ea24a733beddff902459a07bf91ca67">xmax</a>);</div>
<div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;  free(boundary-&gt;<a class="code" href="a00155.html#a481013ba007a99a4237cde5eeb3c9a29">is</a>);</div>
<div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;  free(boundary-&gt;<a class="code" href="a00155.html#a7602de5ebb1b59ec35217e78a35a531e">ie</a>);</div>
<div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;  <span class="keywordflow">if</span> (boundary-&gt;<a class="code" href="a00155.html#a6aa65431c39a8d8177f35c338ddb7a0e">DirichletValue</a>) free(boundary-&gt;<a class="code" href="a00155.html#a6aa65431c39a8d8177f35c338ddb7a0e">DirichletValue</a>);</div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;  <span class="keywordflow">if</span> (boundary-&gt;<a class="code" href="a00155.html#af7eeb4ff3f7c8bc22e0786ddbe62f16d">SpongeValue</a>   ) free(boundary-&gt;<a class="code" href="a00155.html#af7eeb4ff3f7c8bc22e0786ddbe62f16d">SpongeValue</a>   );</div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;  <span class="keywordflow">if</span> (boundary-&gt;<a class="code" href="a00155.html#a0d0d92fab642e1d02a9de254e73a3f21">FlowVelocity</a>  ) free(boundary-&gt;<a class="code" href="a00155.html#a0d0d92fab642e1d02a9de254e73a3f21">FlowVelocity</a>  );</div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;</div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;  <span class="keywordflow">if</span> (boundary-&gt;<a class="code" href="a00155.html#ac3b478217419275ad063182f69cb543d">UnsteadyDirichletSize</a>) free(boundary-&gt;<a class="code" href="a00155.html#ac3b478217419275ad063182f69cb543d">UnsteadyDirichletSize</a>);</div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;  <span class="keywordflow">if</span> (boundary-&gt;<a class="code" href="a00155.html#a48f59fc59e6a86d0b4aad842daea9106">UnsteadyDirichletData</a>) free(boundary-&gt;<a class="code" href="a00155.html#a48f59fc59e6a86d0b4aad842daea9106">UnsteadyDirichletData</a>);</div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;</div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;  <span class="keywordflow">if</span> (boundary-&gt;<a class="code" href="a00155.html#a6f46fcd429eeb105637c0e14d54d79e7">UnsteadyTemperatureSize</a>)  free(boundary-&gt;<a class="code" href="a00155.html#a6f46fcd429eeb105637c0e14d54d79e7">UnsteadyTemperatureSize</a>);</div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;  <span class="keywordflow">if</span> (boundary-&gt;<a class="code" href="a00155.html#af135619149474c2de735f5482e4d0a0e">UnsteadyTimeLevels</a>)       free(boundary-&gt;<a class="code" href="a00155.html#af135619149474c2de735f5482e4d0a0e">UnsteadyTimeLevels</a>);</div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;  <span class="keywordflow">if</span> (boundary-&gt;<a class="code" href="a00155.html#a23dab9053d40cce5ba488290fb1b41c3">UnsteadyTemperatureData</a>)  free(boundary-&gt;<a class="code" href="a00155.html#a23dab9053d40cce5ba488290fb1b41c3">UnsteadyTemperatureData</a>);</div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;  <span class="keywordflow">return</span>(0);</div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;}</div>
<div class="ttc" id="a00155_html_a1e51e79041d5a3dddffb503277703568"><div class="ttname"><a href="a00155.html#a1e51e79041d5a3dddffb503277703568">DomainBoundary::xmin</a></div><div class="ttdeci">double * xmin</div><div class="ttdef"><b>Definition:</b> <a href="a00189_source.html#l00077">boundaryconditions.h:77</a></div></div>
<div class="ttc" id="a00155_html_a481013ba007a99a4237cde5eeb3c9a29"><div class="ttname"><a href="a00155.html#a481013ba007a99a4237cde5eeb3c9a29">DomainBoundary::is</a></div><div class="ttdeci">int * is</div><div class="ttdef"><b>Definition:</b> <a href="a00189_source.html#l00082">boundaryconditions.h:82</a></div></div>
<div class="ttc" id="a00155_html"><div class="ttname"><a href="a00155.html">DomainBoundary</a></div><div class="ttdoc">Structure containing the variables and function pointers defining a boundary. </div><div class="ttdef"><b>Definition:</b> <a href="a00189_source.html#l00068">boundaryconditions.h:68</a></div></div>
<div class="ttc" id="a00155_html_af135619149474c2de735f5482e4d0a0e"><div class="ttname"><a href="a00155.html#af135619149474c2de735f5482e4d0a0e">DomainBoundary::UnsteadyTimeLevels</a></div><div class="ttdeci">double * UnsteadyTimeLevels</div><div class="ttdef"><b>Definition:</b> <a href="a00189_source.html#l00103">boundaryconditions.h:103</a></div></div>
<div class="ttc" id="a00155_html_ac3b478217419275ad063182f69cb543d"><div class="ttname"><a href="a00155.html#ac3b478217419275ad063182f69cb543d">DomainBoundary::UnsteadyDirichletSize</a></div><div class="ttdeci">int * UnsteadyDirichletSize</div><div class="ttdef"><b>Definition:</b> <a href="a00189_source.html#l00090">boundaryconditions.h:90</a></div></div>
<div class="ttc" id="a00155_html_a7602de5ebb1b59ec35217e78a35a531e"><div class="ttname"><a href="a00155.html#a7602de5ebb1b59ec35217e78a35a531e">DomainBoundary::ie</a></div><div class="ttdeci">int * ie</div><div class="ttdef"><b>Definition:</b> <a href="a00189_source.html#l00082">boundaryconditions.h:82</a></div></div>
<div class="ttc" id="a00155_html_a6aa65431c39a8d8177f35c338ddb7a0e"><div class="ttname"><a href="a00155.html#a6aa65431c39a8d8177f35c338ddb7a0e">DomainBoundary::DirichletValue</a></div><div class="ttdeci">double * DirichletValue</div><div class="ttdef"><b>Definition:</b> <a href="a00189_source.html#l00087">boundaryconditions.h:87</a></div></div>
<div class="ttc" id="a00155_html_a6f46fcd429eeb105637c0e14d54d79e7"><div class="ttname"><a href="a00155.html#a6f46fcd429eeb105637c0e14d54d79e7">DomainBoundary::UnsteadyTemperatureSize</a></div><div class="ttdeci">int * UnsteadyTemperatureSize</div><div class="ttdef"><b>Definition:</b> <a href="a00189_source.html#l00102">boundaryconditions.h:102</a></div></div>
<div class="ttc" id="a00155_html_a0d0d92fab642e1d02a9de254e73a3f21"><div class="ttname"><a href="a00155.html#a0d0d92fab642e1d02a9de254e73a3f21">DomainBoundary::FlowVelocity</a></div><div class="ttdeci">double * FlowVelocity</div><div class="ttdef"><b>Definition:</b> <a href="a00189_source.html#l00096">boundaryconditions.h:96</a></div></div>
<div class="ttc" id="a00155_html_a7ea24a733beddff902459a07bf91ca67"><div class="ttname"><a href="a00155.html#a7ea24a733beddff902459a07bf91ca67">DomainBoundary::xmax</a></div><div class="ttdeci">double * xmax</div><div class="ttdef"><b>Definition:</b> <a href="a00189_source.html#l00079">boundaryconditions.h:79</a></div></div>
<div class="ttc" id="a00155_html_a23dab9053d40cce5ba488290fb1b41c3"><div class="ttname"><a href="a00155.html#a23dab9053d40cce5ba488290fb1b41c3">DomainBoundary::UnsteadyTemperatureData</a></div><div class="ttdeci">double * UnsteadyTemperatureData</div><div class="ttdef"><b>Definition:</b> <a href="a00189_source.html#l00104">boundaryconditions.h:104</a></div></div>
<div class="ttc" id="a00155_html_a48f59fc59e6a86d0b4aad842daea9106"><div class="ttname"><a href="a00155.html#a48f59fc59e6a86d0b4aad842daea9106">DomainBoundary::UnsteadyDirichletData</a></div><div class="ttdeci">double * UnsteadyDirichletData</div><div class="ttdef"><b>Definition:</b> <a href="a00189_source.html#l00091">boundaryconditions.h:91</a></div></div>
<div class="ttc" id="a00155_html_af7eeb4ff3f7c8bc22e0786ddbe62f16d"><div class="ttname"><a href="a00155.html#af7eeb4ff3f7c8bc22e0786ddbe62f16d">DomainBoundary::SpongeValue</a></div><div class="ttdeci">double * SpongeValue</div><div class="ttdef"><b>Definition:</b> <a href="a00189_source.html#l00088">boundaryconditions.h:88</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a760f1362e8f287b242b3cd869668f2e9"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int BCPeriodicU </td>
          <td>(</td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>b</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>m</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>ndims</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>nvars</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>size</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>ghosts</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>phi</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>waqt</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Periodic boundary conditions for the solution vector U</p>
<p>Applies periodic boundary conditions: Implemented by copying the solution from the other end of the domain into the physical boundary ghost points. <br/>
<br/>
 Note**: This function only acts if the the number of processors is 1 along the spatial dimension this boundary corresponds to. If there are more than 1 processors along this dimension, periodicity is handled by <a class="el" href="a00204.html#a60ace5964c051fa481e6a1e6f1ef75d7">MPIExchangeBoundariesnD()</a> to minimize communication. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">b</td><td>Boundary object of type <a class="el" href="a00155.html" title="Structure containing the variables and function pointers defining a boundary. ">DomainBoundary</a> </td></tr>
    <tr><td class="paramname">m</td><td>MPI object of type <a class="el" href="a00167.html#a00588" title="Structure of MPI-related variables. ">MPIVariables</a> </td></tr>
    <tr><td class="paramname">ndims</td><td>Number of spatial dimensions </td></tr>
    <tr><td class="paramname">nvars</td><td>Number of variables/DoFs per grid point </td></tr>
    <tr><td class="paramname">size</td><td>Integer array with the number of grid points in each spatial dimension </td></tr>
    <tr><td class="paramname">ghosts</td><td>Number of ghost points </td></tr>
    <tr><td class="paramname">phi</td><td>The solution array on which to apply the boundary condition </td></tr>
    <tr><td class="paramname">waqt</td><td>Current solution time </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="a00232_source.html#l00019">19</a> of file <a class="el" href="a00232_source.html">BCPeriodic.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;{</div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;  <a class="code" href="a00155.html">DomainBoundary</a> *boundary = (<a class="code" href="a00155.html">DomainBoundary</a>*) b;</div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;  <a class="code" href="a00167.html#a00588">MPIVariables</a>   *mpi      = (<a class="code" href="a00167.html#a00588">MPIVariables</a>*)   m;</div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;</div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;  <span class="keywordtype">int</span> dim   = boundary-&gt;<a class="code" href="a00155.html#a70b5e28b5bc3d1b63a7435c5fe50b837">dim</a>;</div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;  <span class="keywordtype">int</span> face  = boundary-&gt;<a class="code" href="a00155.html#a9582c650f117a06449b5ee368b6762ef">face</a>;</div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;</div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;  <span class="keywordflow">if</span> ((boundary-&gt;<a class="code" href="a00155.html#a2eec7e4ee612d5edc985ba81453346e1">on_this_proc</a>) &amp;&amp; (mpi-&gt;<a class="code" href="a00167.html#a0be0f30a83bc3f3d9f6ee3a36bbf2716">iproc</a>[dim] == 1)) {</div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;    <span class="keywordtype">int</span> bounds[ndims], index1[ndims], index2[ndims];</div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;    <a class="code" href="a00187.html#ab49d0f261ea751a17d6beca0504daf78">_ArraySubtract1D_</a>(bounds,boundary-&gt;<a class="code" href="a00155.html#a7602de5ebb1b59ec35217e78a35a531e">ie</a>,boundary-&gt;<a class="code" href="a00155.html#a481013ba007a99a4237cde5eeb3c9a29">is</a>,ndims);</div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;    <a class="code" href="a00187.html#a2b2826031c0cd92495ab351d3e599fc5">_ArraySetValue_</a>(index1,ndims,0);</div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;    <a class="code" href="a00187.html#a2b2826031c0cd92495ab351d3e599fc5">_ArraySetValue_</a>(index2,ndims,0);</div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;    <span class="keywordtype">int</span> done = 0;</div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;    <span class="keywordflow">while</span> (!done) {</div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;      <span class="keywordtype">int</span> p1 = 0, p2 = 0;</div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;      <a class="code" href="a00187.html#a89e8330d9e06dd0666c50833628a125c">_ArrayCopy1D_</a>(index1,index2,ndims);</div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;      <span class="keywordflow">if</span> (face == 1) {</div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;        index2[dim] = index1[dim] + size[dim]-ghosts;</div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;        <a class="code" href="a00187.html#a0739cb538f4d301fad3b45059ddd0738">_ArrayIndex1DWO_</a>(ndims,size,index1,boundary-&gt;<a class="code" href="a00155.html#a481013ba007a99a4237cde5eeb3c9a29">is</a>,ghosts,p1);</div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;        <a class="code" href="a00187.html#afbb862a2fdf5b72b1f9ace42f64b556f">_ArrayIndex1D_</a>(ndims,size,index2,ghosts,p2);</div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;      } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (face == -1) {</div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;        <a class="code" href="a00187.html#a0739cb538f4d301fad3b45059ddd0738">_ArrayIndex1DWO_</a>(ndims,size,index1,boundary-&gt;<a class="code" href="a00155.html#a481013ba007a99a4237cde5eeb3c9a29">is</a>,ghosts,p1);</div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;        <a class="code" href="a00187.html#afbb862a2fdf5b72b1f9ace42f64b556f">_ArrayIndex1D_</a>(ndims,size,index1,ghosts,p2);</div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;      }</div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;      <a class="code" href="a00187.html#a89e8330d9e06dd0666c50833628a125c">_ArrayCopy1D_</a>((phi+nvars*p2),(phi+nvars*p1),nvars);</div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;      <a class="code" href="a00187.html#ac5ec1371623f11d03b0f42adaa24acbc">_ArrayIncrementIndex_</a>(ndims,bounds,index1,done);</div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;    }</div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;  }</div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;  <span class="keywordflow">return</span>(0);</div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;}</div>
<div class="ttc" id="a00167_html_a0be0f30a83bc3f3d9f6ee3a36bbf2716"><div class="ttname"><a href="a00167.html#a0be0f30a83bc3f3d9f6ee3a36bbf2716">MPIVariables::iproc</a></div><div class="ttdeci">int * iproc</div><div class="ttdef"><b>Definition:</b> <a href="a00167_source.html#l00027">mpivars_struct.h:27</a></div></div>
<div class="ttc" id="a00155_html_a70b5e28b5bc3d1b63a7435c5fe50b837"><div class="ttname"><a href="a00155.html#a70b5e28b5bc3d1b63a7435c5fe50b837">DomainBoundary::dim</a></div><div class="ttdeci">int dim</div><div class="ttdef"><b>Definition:</b> <a href="a00189_source.html#l00073">boundaryconditions.h:73</a></div></div>
<div class="ttc" id="a00187_html_a0739cb538f4d301fad3b45059ddd0738"><div class="ttname"><a href="a00187.html#a0739cb538f4d301fad3b45059ddd0738">_ArrayIndex1DWO_</a></div><div class="ttdeci">#define _ArrayIndex1DWO_(N, imax, i, offset, ghost, index)</div><div class="ttdef"><b>Definition:</b> <a href="a00187_source.html#l00082">arrayfunctions.h:82</a></div></div>
<div class="ttc" id="a00155_html_a481013ba007a99a4237cde5eeb3c9a29"><div class="ttname"><a href="a00155.html#a481013ba007a99a4237cde5eeb3c9a29">DomainBoundary::is</a></div><div class="ttdeci">int * is</div><div class="ttdef"><b>Definition:</b> <a href="a00189_source.html#l00082">boundaryconditions.h:82</a></div></div>
<div class="ttc" id="a00155_html"><div class="ttname"><a href="a00155.html">DomainBoundary</a></div><div class="ttdoc">Structure containing the variables and function pointers defining a boundary. </div><div class="ttdef"><b>Definition:</b> <a href="a00189_source.html#l00068">boundaryconditions.h:68</a></div></div>
<div class="ttc" id="a00187_html_ab49d0f261ea751a17d6beca0504daf78"><div class="ttname"><a href="a00187.html#ab49d0f261ea751a17d6beca0504daf78">_ArraySubtract1D_</a></div><div class="ttdeci">#define _ArraySubtract1D_(x, a, b, size)</div><div class="ttdef"><b>Definition:</b> <a href="a00187_source.html#l00200">arrayfunctions.h:200</a></div></div>
<div class="ttc" id="a00187_html_afbb862a2fdf5b72b1f9ace42f64b556f"><div class="ttname"><a href="a00187.html#afbb862a2fdf5b72b1f9ace42f64b556f">_ArrayIndex1D_</a></div><div class="ttdeci">#define _ArrayIndex1D_(N, imax, i, ghost, index)</div><div class="ttdef"><b>Definition:</b> <a href="a00187_source.html#l00039">arrayfunctions.h:39</a></div></div>
<div class="ttc" id="a00187_html_ac5ec1371623f11d03b0f42adaa24acbc"><div class="ttname"><a href="a00187.html#ac5ec1371623f11d03b0f42adaa24acbc">_ArrayIncrementIndex_</a></div><div class="ttdeci">#define _ArrayIncrementIndex_(N, imax, i, done)</div><div class="ttdef"><b>Definition:</b> <a href="a00187_source.html#l00125">arrayfunctions.h:125</a></div></div>
<div class="ttc" id="a00155_html_a7602de5ebb1b59ec35217e78a35a531e"><div class="ttname"><a href="a00155.html#a7602de5ebb1b59ec35217e78a35a531e">DomainBoundary::ie</a></div><div class="ttdeci">int * ie</div><div class="ttdef"><b>Definition:</b> <a href="a00189_source.html#l00082">boundaryconditions.h:82</a></div></div>
<div class="ttc" id="a00167_html_a00588"><div class="ttname"><a href="a00167.html#a00588">MPIVariables</a></div><div class="ttdoc">Structure of MPI-related variables. </div><div class="ttdef"><b>Definition:</b> <a href="a00167_source.html#l00024">mpivars_struct.h:24</a></div></div>
<div class="ttc" id="a00155_html_a9582c650f117a06449b5ee368b6762ef"><div class="ttname"><a href="a00155.html#a9582c650f117a06449b5ee368b6762ef">DomainBoundary::face</a></div><div class="ttdeci">int face</div><div class="ttdef"><b>Definition:</b> <a href="a00189_source.html#l00075">boundaryconditions.h:75</a></div></div>
<div class="ttc" id="a00187_html_a2b2826031c0cd92495ab351d3e599fc5"><div class="ttname"><a href="a00187.html#a2b2826031c0cd92495ab351d3e599fc5">_ArraySetValue_</a></div><div class="ttdeci">#define _ArraySetValue_(x, size, value)</div><div class="ttdef"><b>Definition:</b> <a href="a00187_source.html#l00168">arrayfunctions.h:168</a></div></div>
<div class="ttc" id="a00155_html_a2eec7e4ee612d5edc985ba81453346e1"><div class="ttname"><a href="a00155.html#a2eec7e4ee612d5edc985ba81453346e1">DomainBoundary::on_this_proc</a></div><div class="ttdeci">int on_this_proc</div><div class="ttdef"><b>Definition:</b> <a href="a00189_source.html#l00081">boundaryconditions.h:81</a></div></div>
<div class="ttc" id="a00187_html_a89e8330d9e06dd0666c50833628a125c"><div class="ttname"><a href="a00187.html#a89e8330d9e06dd0666c50833628a125c">_ArrayCopy1D_</a></div><div class="ttdeci">#define _ArrayCopy1D_(x, y, size)</div><div class="ttdef"><b>Definition:</b> <a href="a00187_source.html#l00318">arrayfunctions.h:318</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="aec11d279de28af8bc36e9462485aedbd"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int BCExtrapolateU </td>
          <td>(</td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>b</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>m</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>ndims</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>nvars</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>size</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>ghosts</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>phi</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>waqt</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>extrapolate boundary conditions for the solution vector U</p>
<p>Apply the extrapolative boundary condition: Values at the physical boundary ghost points are extrapolated from the interior points adjacent to the boundary </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">b</td><td>Boundary object of type <a class="el" href="a00155.html" title="Structure containing the variables and function pointers defining a boundary. ">DomainBoundary</a> </td></tr>
    <tr><td class="paramname">m</td><td>MPI object of type <a class="el" href="a00167.html#a00588" title="Structure of MPI-related variables. ">MPIVariables</a> </td></tr>
    <tr><td class="paramname">ndims</td><td>Number of spatial dimensions </td></tr>
    <tr><td class="paramname">nvars</td><td>Number of variables/DoFs per grid point </td></tr>
    <tr><td class="paramname">size</td><td>Integer array with the number of grid points in each spatial dimension </td></tr>
    <tr><td class="paramname">ghosts</td><td>Number of ghost points </td></tr>
    <tr><td class="paramname">phi</td><td>The solution array on which to apply the boundary condition </td></tr>
    <tr><td class="paramname">waqt</td><td>Current solution time </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="a00227_source.html#l00013">13</a> of file <a class="el" href="a00227_source.html">BCExtrapolate.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;{</div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;  <a class="code" href="a00155.html">DomainBoundary</a> *boundary = (<a class="code" href="a00155.html">DomainBoundary</a>*) b;</div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;</div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;  <span class="keywordtype">int</span> dim   = boundary-&gt;<a class="code" href="a00155.html#a70b5e28b5bc3d1b63a7435c5fe50b837">dim</a>;</div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;  <span class="keywordtype">int</span> face  = boundary-&gt;<a class="code" href="a00155.html#a9582c650f117a06449b5ee368b6762ef">face</a>;</div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;</div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;  <span class="keywordflow">if</span> (boundary-&gt;<a class="code" href="a00155.html#a2eec7e4ee612d5edc985ba81453346e1">on_this_proc</a>) {</div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;    <span class="keywordtype">int</span> bounds[ndims], indexb[ndims], indexi[ndims];</div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;    <a class="code" href="a00187.html#ab49d0f261ea751a17d6beca0504daf78">_ArraySubtract1D_</a>(bounds,boundary-&gt;<a class="code" href="a00155.html#a7602de5ebb1b59ec35217e78a35a531e">ie</a>,boundary-&gt;<a class="code" href="a00155.html#a481013ba007a99a4237cde5eeb3c9a29">is</a>,ndims);</div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;    <a class="code" href="a00187.html#a2b2826031c0cd92495ab351d3e599fc5">_ArraySetValue_</a>(indexb,ndims,0);</div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;    <span class="keywordtype">int</span> done = 0;</div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;    <span class="keywordflow">while</span> (!done) {</div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;      <a class="code" href="a00187.html#a89e8330d9e06dd0666c50833628a125c">_ArrayCopy1D_</a>(indexb,indexi,ndims);</div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;      <a class="code" href="a00187.html#a98a3bb5fda2fcafb70a6288d100a0924">_ArrayAdd1D_</a>(indexi,indexi,boundary-&gt;<a class="code" href="a00155.html#a481013ba007a99a4237cde5eeb3c9a29">is</a>,ndims);</div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;      <span class="keywordflow">if</span> (face == 1)        indexi[dim] = ghosts-1-indexb[dim];</div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;      <span class="keywordflow">else</span> <span class="keywordflow">if</span> (face == -1)  indexi[dim] = size[dim]-indexb[dim]-1;</div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;      <span class="keywordflow">else</span>                  <span class="keywordflow">return</span>(1);</div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;      <span class="keywordtype">int</span> p1,p2;</div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;      <a class="code" href="a00187.html#a0739cb538f4d301fad3b45059ddd0738">_ArrayIndex1DWO_</a>(ndims,size,indexb,boundary-&gt;<a class="code" href="a00155.html#a481013ba007a99a4237cde5eeb3c9a29">is</a>,ghosts,p1);</div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;      <a class="code" href="a00187.html#afbb862a2fdf5b72b1f9ace42f64b556f">_ArrayIndex1D_</a>(ndims,size,indexi,ghosts,p2);</div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;      <a class="code" href="a00187.html#a89e8330d9e06dd0666c50833628a125c">_ArrayCopy1D_</a>((phi+nvars*p2),(phi+nvars*p1),nvars);</div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;      <a class="code" href="a00187.html#ac5ec1371623f11d03b0f42adaa24acbc">_ArrayIncrementIndex_</a>(ndims,bounds,indexb,done);</div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;    }</div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;  }</div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;  <span class="keywordflow">return</span>(0);</div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;}</div>
<div class="ttc" id="a00187_html_a98a3bb5fda2fcafb70a6288d100a0924"><div class="ttname"><a href="a00187.html#a98a3bb5fda2fcafb70a6288d100a0924">_ArrayAdd1D_</a></div><div class="ttdeci">#define _ArrayAdd1D_(x, a, b, size)</div><div class="ttdef"><b>Definition:</b> <a href="a00187_source.html#l00211">arrayfunctions.h:211</a></div></div>
<div class="ttc" id="a00155_html_a70b5e28b5bc3d1b63a7435c5fe50b837"><div class="ttname"><a href="a00155.html#a70b5e28b5bc3d1b63a7435c5fe50b837">DomainBoundary::dim</a></div><div class="ttdeci">int dim</div><div class="ttdef"><b>Definition:</b> <a href="a00189_source.html#l00073">boundaryconditions.h:73</a></div></div>
<div class="ttc" id="a00187_html_a0739cb538f4d301fad3b45059ddd0738"><div class="ttname"><a href="a00187.html#a0739cb538f4d301fad3b45059ddd0738">_ArrayIndex1DWO_</a></div><div class="ttdeci">#define _ArrayIndex1DWO_(N, imax, i, offset, ghost, index)</div><div class="ttdef"><b>Definition:</b> <a href="a00187_source.html#l00082">arrayfunctions.h:82</a></div></div>
<div class="ttc" id="a00155_html_a481013ba007a99a4237cde5eeb3c9a29"><div class="ttname"><a href="a00155.html#a481013ba007a99a4237cde5eeb3c9a29">DomainBoundary::is</a></div><div class="ttdeci">int * is</div><div class="ttdef"><b>Definition:</b> <a href="a00189_source.html#l00082">boundaryconditions.h:82</a></div></div>
<div class="ttc" id="a00155_html"><div class="ttname"><a href="a00155.html">DomainBoundary</a></div><div class="ttdoc">Structure containing the variables and function pointers defining a boundary. </div><div class="ttdef"><b>Definition:</b> <a href="a00189_source.html#l00068">boundaryconditions.h:68</a></div></div>
<div class="ttc" id="a00187_html_ab49d0f261ea751a17d6beca0504daf78"><div class="ttname"><a href="a00187.html#ab49d0f261ea751a17d6beca0504daf78">_ArraySubtract1D_</a></div><div class="ttdeci">#define _ArraySubtract1D_(x, a, b, size)</div><div class="ttdef"><b>Definition:</b> <a href="a00187_source.html#l00200">arrayfunctions.h:200</a></div></div>
<div class="ttc" id="a00187_html_afbb862a2fdf5b72b1f9ace42f64b556f"><div class="ttname"><a href="a00187.html#afbb862a2fdf5b72b1f9ace42f64b556f">_ArrayIndex1D_</a></div><div class="ttdeci">#define _ArrayIndex1D_(N, imax, i, ghost, index)</div><div class="ttdef"><b>Definition:</b> <a href="a00187_source.html#l00039">arrayfunctions.h:39</a></div></div>
<div class="ttc" id="a00187_html_ac5ec1371623f11d03b0f42adaa24acbc"><div class="ttname"><a href="a00187.html#ac5ec1371623f11d03b0f42adaa24acbc">_ArrayIncrementIndex_</a></div><div class="ttdeci">#define _ArrayIncrementIndex_(N, imax, i, done)</div><div class="ttdef"><b>Definition:</b> <a href="a00187_source.html#l00125">arrayfunctions.h:125</a></div></div>
<div class="ttc" id="a00155_html_a7602de5ebb1b59ec35217e78a35a531e"><div class="ttname"><a href="a00155.html#a7602de5ebb1b59ec35217e78a35a531e">DomainBoundary::ie</a></div><div class="ttdeci">int * ie</div><div class="ttdef"><b>Definition:</b> <a href="a00189_source.html#l00082">boundaryconditions.h:82</a></div></div>
<div class="ttc" id="a00155_html_a9582c650f117a06449b5ee368b6762ef"><div class="ttname"><a href="a00155.html#a9582c650f117a06449b5ee368b6762ef">DomainBoundary::face</a></div><div class="ttdeci">int face</div><div class="ttdef"><b>Definition:</b> <a href="a00189_source.html#l00075">boundaryconditions.h:75</a></div></div>
<div class="ttc" id="a00187_html_a2b2826031c0cd92495ab351d3e599fc5"><div class="ttname"><a href="a00187.html#a2b2826031c0cd92495ab351d3e599fc5">_ArraySetValue_</a></div><div class="ttdeci">#define _ArraySetValue_(x, size, value)</div><div class="ttdef"><b>Definition:</b> <a href="a00187_source.html#l00168">arrayfunctions.h:168</a></div></div>
<div class="ttc" id="a00155_html_a2eec7e4ee612d5edc985ba81453346e1"><div class="ttname"><a href="a00155.html#a2eec7e4ee612d5edc985ba81453346e1">DomainBoundary::on_this_proc</a></div><div class="ttdeci">int on_this_proc</div><div class="ttdef"><b>Definition:</b> <a href="a00189_source.html#l00081">boundaryconditions.h:81</a></div></div>
<div class="ttc" id="a00187_html_a89e8330d9e06dd0666c50833628a125c"><div class="ttname"><a href="a00187.html#a89e8330d9e06dd0666c50833628a125c">_ArrayCopy1D_</a></div><div class="ttdeci">#define _ArrayCopy1D_(x, y, size)</div><div class="ttdef"><b>Definition:</b> <a href="a00187_source.html#l00318">arrayfunctions.h:318</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ad9d2689e44a644319a6cc72249c68e49"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int BCDirichletU </td>
          <td>(</td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>b</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>m</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>ndims</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>nvars</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>size</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>ghosts</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>phi</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>waqt</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Dirichlet boundary conditions for the solution vector U</p>
<p>Applies (steady) Dirichlet boundary conditions for the solution: the ghost points at the physical boundaries are set to specified values </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">b</td><td>Boundary object of type <a class="el" href="a00155.html" title="Structure containing the variables and function pointers defining a boundary. ">DomainBoundary</a> </td></tr>
    <tr><td class="paramname">m</td><td>MPI object of type <a class="el" href="a00167.html#a00588" title="Structure of MPI-related variables. ">MPIVariables</a> </td></tr>
    <tr><td class="paramname">ndims</td><td>Number of spatial dimensions </td></tr>
    <tr><td class="paramname">nvars</td><td>Number of variables/DoFs per grid point </td></tr>
    <tr><td class="paramname">size</td><td>Integer array with the number of grid points in each spatial dimension </td></tr>
    <tr><td class="paramname">ghosts</td><td>Number of ghost points </td></tr>
    <tr><td class="paramname">phi</td><td>The solution array on which to apply the boundary condition </td></tr>
    <tr><td class="paramname">waqt</td><td>Current solution time </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="a00226_source.html#l00013">13</a> of file <a class="el" href="a00226_source.html">BCDirichlet.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;{</div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;  <a class="code" href="a00155.html">DomainBoundary</a> *boundary = (<a class="code" href="a00155.html">DomainBoundary</a>*) b;</div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;</div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;  <span class="keywordflow">if</span> (boundary-&gt;<a class="code" href="a00155.html#a2eec7e4ee612d5edc985ba81453346e1">on_this_proc</a>) {</div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;    <span class="keywordtype">int</span> bounds[ndims], indexb[ndims];</div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;    <a class="code" href="a00187.html#ab49d0f261ea751a17d6beca0504daf78">_ArraySubtract1D_</a>(bounds,boundary-&gt;<a class="code" href="a00155.html#a7602de5ebb1b59ec35217e78a35a531e">ie</a>,boundary-&gt;<a class="code" href="a00155.html#a481013ba007a99a4237cde5eeb3c9a29">is</a>,ndims);</div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;    <a class="code" href="a00187.html#a2b2826031c0cd92495ab351d3e599fc5">_ArraySetValue_</a>(indexb,ndims,0); </div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;    <span class="keywordtype">int</span> done = 0;</div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;    <span class="keywordflow">while</span> (!done) {</div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;      <span class="keywordtype">int</span> p; <a class="code" href="a00187.html#a0739cb538f4d301fad3b45059ddd0738">_ArrayIndex1DWO_</a>(ndims,size  ,indexb,boundary-&gt;<a class="code" href="a00155.html#a481013ba007a99a4237cde5eeb3c9a29">is</a>,ghosts,p);</div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;      <a class="code" href="a00187.html#a89e8330d9e06dd0666c50833628a125c">_ArrayCopy1D_</a>((boundary-&gt;<a class="code" href="a00155.html#a6aa65431c39a8d8177f35c338ddb7a0e">DirichletValue</a>),(phi+nvars*p),nvars);</div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;      <a class="code" href="a00187.html#ac5ec1371623f11d03b0f42adaa24acbc">_ArrayIncrementIndex_</a>(ndims,bounds,indexb,done);</div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;    }</div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;  }</div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;  <span class="keywordflow">return</span>(0);</div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;}</div>
<div class="ttc" id="a00187_html_a0739cb538f4d301fad3b45059ddd0738"><div class="ttname"><a href="a00187.html#a0739cb538f4d301fad3b45059ddd0738">_ArrayIndex1DWO_</a></div><div class="ttdeci">#define _ArrayIndex1DWO_(N, imax, i, offset, ghost, index)</div><div class="ttdef"><b>Definition:</b> <a href="a00187_source.html#l00082">arrayfunctions.h:82</a></div></div>
<div class="ttc" id="a00155_html_a481013ba007a99a4237cde5eeb3c9a29"><div class="ttname"><a href="a00155.html#a481013ba007a99a4237cde5eeb3c9a29">DomainBoundary::is</a></div><div class="ttdeci">int * is</div><div class="ttdef"><b>Definition:</b> <a href="a00189_source.html#l00082">boundaryconditions.h:82</a></div></div>
<div class="ttc" id="a00155_html"><div class="ttname"><a href="a00155.html">DomainBoundary</a></div><div class="ttdoc">Structure containing the variables and function pointers defining a boundary. </div><div class="ttdef"><b>Definition:</b> <a href="a00189_source.html#l00068">boundaryconditions.h:68</a></div></div>
<div class="ttc" id="a00187_html_ab49d0f261ea751a17d6beca0504daf78"><div class="ttname"><a href="a00187.html#ab49d0f261ea751a17d6beca0504daf78">_ArraySubtract1D_</a></div><div class="ttdeci">#define _ArraySubtract1D_(x, a, b, size)</div><div class="ttdef"><b>Definition:</b> <a href="a00187_source.html#l00200">arrayfunctions.h:200</a></div></div>
<div class="ttc" id="a00187_html_ac5ec1371623f11d03b0f42adaa24acbc"><div class="ttname"><a href="a00187.html#ac5ec1371623f11d03b0f42adaa24acbc">_ArrayIncrementIndex_</a></div><div class="ttdeci">#define _ArrayIncrementIndex_(N, imax, i, done)</div><div class="ttdef"><b>Definition:</b> <a href="a00187_source.html#l00125">arrayfunctions.h:125</a></div></div>
<div class="ttc" id="a00155_html_a7602de5ebb1b59ec35217e78a35a531e"><div class="ttname"><a href="a00155.html#a7602de5ebb1b59ec35217e78a35a531e">DomainBoundary::ie</a></div><div class="ttdeci">int * ie</div><div class="ttdef"><b>Definition:</b> <a href="a00189_source.html#l00082">boundaryconditions.h:82</a></div></div>
<div class="ttc" id="a00155_html_a6aa65431c39a8d8177f35c338ddb7a0e"><div class="ttname"><a href="a00155.html#a6aa65431c39a8d8177f35c338ddb7a0e">DomainBoundary::DirichletValue</a></div><div class="ttdeci">double * DirichletValue</div><div class="ttdef"><b>Definition:</b> <a href="a00189_source.html#l00087">boundaryconditions.h:87</a></div></div>
<div class="ttc" id="a00187_html_a2b2826031c0cd92495ab351d3e599fc5"><div class="ttname"><a href="a00187.html#a2b2826031c0cd92495ab351d3e599fc5">_ArraySetValue_</a></div><div class="ttdeci">#define _ArraySetValue_(x, size, value)</div><div class="ttdef"><b>Definition:</b> <a href="a00187_source.html#l00168">arrayfunctions.h:168</a></div></div>
<div class="ttc" id="a00155_html_a2eec7e4ee612d5edc985ba81453346e1"><div class="ttname"><a href="a00155.html#a2eec7e4ee612d5edc985ba81453346e1">DomainBoundary::on_this_proc</a></div><div class="ttdeci">int on_this_proc</div><div class="ttdef"><b>Definition:</b> <a href="a00189_source.html#l00081">boundaryconditions.h:81</a></div></div>
<div class="ttc" id="a00187_html_a89e8330d9e06dd0666c50833628a125c"><div class="ttname"><a href="a00187.html#a89e8330d9e06dd0666c50833628a125c">_ArrayCopy1D_</a></div><div class="ttdeci">#define _ArrayCopy1D_(x, y, size)</div><div class="ttdef"><b>Definition:</b> <a href="a00187_source.html#l00318">arrayfunctions.h:318</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a9a0a6df7b555f4eea004e79de223abf8"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int BCReflectU </td>
          <td>(</td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>b</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>m</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>ndims</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>nvars</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>size</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>ghosts</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>phi</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>waqt</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Reflection boundary conditions for the solution vector U</p>
<p>Applies the reflection boundary condition: The values at the physical boundary ghost points are set to the negative of the interior values adjacent to the boundary. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">b</td><td>Boundary object of type <a class="el" href="a00155.html" title="Structure containing the variables and function pointers defining a boundary. ">DomainBoundary</a> </td></tr>
    <tr><td class="paramname">m</td><td>MPI object of type <a class="el" href="a00167.html#a00588" title="Structure of MPI-related variables. ">MPIVariables</a> </td></tr>
    <tr><td class="paramname">ndims</td><td>Number of spatial dimensions </td></tr>
    <tr><td class="paramname">nvars</td><td>Number of variables/DoFs per grid point </td></tr>
    <tr><td class="paramname">size</td><td>Integer array with the number of grid points in each spatial dimension </td></tr>
    <tr><td class="paramname">ghosts</td><td>Number of ghost points </td></tr>
    <tr><td class="paramname">phi</td><td>The solution array on which to apply the boundary condition </td></tr>
    <tr><td class="paramname">waqt</td><td>Current solution time </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="a00233_source.html#l00014">14</a> of file <a class="el" href="a00233_source.html">BCReflect.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;{</div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;  <a class="code" href="a00155.html">DomainBoundary</a> *boundary = (<a class="code" href="a00155.html">DomainBoundary</a>*) b;</div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;</div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;  <span class="keywordtype">int</span> dim   = boundary-&gt;<a class="code" href="a00155.html#a70b5e28b5bc3d1b63a7435c5fe50b837">dim</a>;</div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;  <span class="keywordtype">int</span> face  = boundary-&gt;<a class="code" href="a00155.html#a9582c650f117a06449b5ee368b6762ef">face</a>;</div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;</div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;  <span class="keywordflow">if</span> (boundary-&gt;<a class="code" href="a00155.html#a2eec7e4ee612d5edc985ba81453346e1">on_this_proc</a>) {</div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;    <span class="keywordtype">int</span> bounds[ndims], indexb[ndims], indexi[ndims];</div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;    <a class="code" href="a00187.html#ab49d0f261ea751a17d6beca0504daf78">_ArraySubtract1D_</a>(bounds,boundary-&gt;<a class="code" href="a00155.html#a7602de5ebb1b59ec35217e78a35a531e">ie</a>,boundary-&gt;<a class="code" href="a00155.html#a481013ba007a99a4237cde5eeb3c9a29">is</a>,ndims);</div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;    <a class="code" href="a00187.html#a2b2826031c0cd92495ab351d3e599fc5">_ArraySetValue_</a>(indexb,ndims,0);</div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;    <span class="keywordtype">int</span> done = 0;</div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;    <span class="keywordflow">while</span> (!done) {</div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;      <span class="keywordtype">int</span> p1, p2;</div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;      <a class="code" href="a00187.html#a89e8330d9e06dd0666c50833628a125c">_ArrayCopy1D_</a>(indexb,indexi,ndims);</div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;      <a class="code" href="a00187.html#a98a3bb5fda2fcafb70a6288d100a0924">_ArrayAdd1D_</a>(indexi,indexi,boundary-&gt;<a class="code" href="a00155.html#a481013ba007a99a4237cde5eeb3c9a29">is</a>,ndims);</div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;      <span class="keywordflow">if</span>      (face ==  1) indexi[dim] = ghosts-1-indexb[dim];</div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;      <span class="keywordflow">else</span> <span class="keywordflow">if</span> (face == -1) indexi[dim] = size[dim]-indexb[dim]-1;</div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;      <span class="keywordflow">else</span> <span class="keywordflow">return</span>(1);</div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;      <a class="code" href="a00187.html#a0739cb538f4d301fad3b45059ddd0738">_ArrayIndex1DWO_</a>(ndims,size,indexb,boundary-&gt;<a class="code" href="a00155.html#a481013ba007a99a4237cde5eeb3c9a29">is</a>,ghosts,p1);</div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;      <a class="code" href="a00187.html#afbb862a2fdf5b72b1f9ace42f64b556f">_ArrayIndex1D_</a>(ndims,size,indexi,ghosts,p2);</div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;      <a class="code" href="a00187.html#a7d97d4914726fa7cca339356dae28473">_ArrayScaleCopy1D_</a>((phi+nvars*p2),(-1.0),(phi+nvars*p1),nvars);</div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;      <a class="code" href="a00187.html#ac5ec1371623f11d03b0f42adaa24acbc">_ArrayIncrementIndex_</a>(ndims,bounds,indexb,done);</div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;    }</div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;  }</div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;  <span class="keywordflow">return</span>(0);</div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;}</div>
<div class="ttc" id="a00187_html_a98a3bb5fda2fcafb70a6288d100a0924"><div class="ttname"><a href="a00187.html#a98a3bb5fda2fcafb70a6288d100a0924">_ArrayAdd1D_</a></div><div class="ttdeci">#define _ArrayAdd1D_(x, a, b, size)</div><div class="ttdef"><b>Definition:</b> <a href="a00187_source.html#l00211">arrayfunctions.h:211</a></div></div>
<div class="ttc" id="a00155_html_a70b5e28b5bc3d1b63a7435c5fe50b837"><div class="ttname"><a href="a00155.html#a70b5e28b5bc3d1b63a7435c5fe50b837">DomainBoundary::dim</a></div><div class="ttdeci">int dim</div><div class="ttdef"><b>Definition:</b> <a href="a00189_source.html#l00073">boundaryconditions.h:73</a></div></div>
<div class="ttc" id="a00187_html_a0739cb538f4d301fad3b45059ddd0738"><div class="ttname"><a href="a00187.html#a0739cb538f4d301fad3b45059ddd0738">_ArrayIndex1DWO_</a></div><div class="ttdeci">#define _ArrayIndex1DWO_(N, imax, i, offset, ghost, index)</div><div class="ttdef"><b>Definition:</b> <a href="a00187_source.html#l00082">arrayfunctions.h:82</a></div></div>
<div class="ttc" id="a00187_html_a7d97d4914726fa7cca339356dae28473"><div class="ttname"><a href="a00187.html#a7d97d4914726fa7cca339356dae28473">_ArrayScaleCopy1D_</a></div><div class="ttdeci">#define _ArrayScaleCopy1D_(x, a, y, size)</div><div class="ttdef"><b>Definition:</b> <a href="a00187_source.html#l00355">arrayfunctions.h:355</a></div></div>
<div class="ttc" id="a00155_html_a481013ba007a99a4237cde5eeb3c9a29"><div class="ttname"><a href="a00155.html#a481013ba007a99a4237cde5eeb3c9a29">DomainBoundary::is</a></div><div class="ttdeci">int * is</div><div class="ttdef"><b>Definition:</b> <a href="a00189_source.html#l00082">boundaryconditions.h:82</a></div></div>
<div class="ttc" id="a00155_html"><div class="ttname"><a href="a00155.html">DomainBoundary</a></div><div class="ttdoc">Structure containing the variables and function pointers defining a boundary. </div><div class="ttdef"><b>Definition:</b> <a href="a00189_source.html#l00068">boundaryconditions.h:68</a></div></div>
<div class="ttc" id="a00187_html_ab49d0f261ea751a17d6beca0504daf78"><div class="ttname"><a href="a00187.html#ab49d0f261ea751a17d6beca0504daf78">_ArraySubtract1D_</a></div><div class="ttdeci">#define _ArraySubtract1D_(x, a, b, size)</div><div class="ttdef"><b>Definition:</b> <a href="a00187_source.html#l00200">arrayfunctions.h:200</a></div></div>
<div class="ttc" id="a00187_html_afbb862a2fdf5b72b1f9ace42f64b556f"><div class="ttname"><a href="a00187.html#afbb862a2fdf5b72b1f9ace42f64b556f">_ArrayIndex1D_</a></div><div class="ttdeci">#define _ArrayIndex1D_(N, imax, i, ghost, index)</div><div class="ttdef"><b>Definition:</b> <a href="a00187_source.html#l00039">arrayfunctions.h:39</a></div></div>
<div class="ttc" id="a00187_html_ac5ec1371623f11d03b0f42adaa24acbc"><div class="ttname"><a href="a00187.html#ac5ec1371623f11d03b0f42adaa24acbc">_ArrayIncrementIndex_</a></div><div class="ttdeci">#define _ArrayIncrementIndex_(N, imax, i, done)</div><div class="ttdef"><b>Definition:</b> <a href="a00187_source.html#l00125">arrayfunctions.h:125</a></div></div>
<div class="ttc" id="a00155_html_a7602de5ebb1b59ec35217e78a35a531e"><div class="ttname"><a href="a00155.html#a7602de5ebb1b59ec35217e78a35a531e">DomainBoundary::ie</a></div><div class="ttdeci">int * ie</div><div class="ttdef"><b>Definition:</b> <a href="a00189_source.html#l00082">boundaryconditions.h:82</a></div></div>
<div class="ttc" id="a00155_html_a9582c650f117a06449b5ee368b6762ef"><div class="ttname"><a href="a00155.html#a9582c650f117a06449b5ee368b6762ef">DomainBoundary::face</a></div><div class="ttdeci">int face</div><div class="ttdef"><b>Definition:</b> <a href="a00189_source.html#l00075">boundaryconditions.h:75</a></div></div>
<div class="ttc" id="a00187_html_a2b2826031c0cd92495ab351d3e599fc5"><div class="ttname"><a href="a00187.html#a2b2826031c0cd92495ab351d3e599fc5">_ArraySetValue_</a></div><div class="ttdeci">#define _ArraySetValue_(x, size, value)</div><div class="ttdef"><b>Definition:</b> <a href="a00187_source.html#l00168">arrayfunctions.h:168</a></div></div>
<div class="ttc" id="a00155_html_a2eec7e4ee612d5edc985ba81453346e1"><div class="ttname"><a href="a00155.html#a2eec7e4ee612d5edc985ba81453346e1">DomainBoundary::on_this_proc</a></div><div class="ttdeci">int on_this_proc</div><div class="ttdef"><b>Definition:</b> <a href="a00189_source.html#l00081">boundaryconditions.h:81</a></div></div>
<div class="ttc" id="a00187_html_a89e8330d9e06dd0666c50833628a125c"><div class="ttname"><a href="a00187.html#a89e8330d9e06dd0666c50833628a125c">_ArrayCopy1D_</a></div><div class="ttdeci">#define _ArrayCopy1D_(x, y, size)</div><div class="ttdef"><b>Definition:</b> <a href="a00187_source.html#l00318">arrayfunctions.h:318</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ae8b2fd391e2c966afad4c4910eff0ffc"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int BCNoslipWallU </td>
          <td>(</td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>b</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>m</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>ndims</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>nvars</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>size</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>ghosts</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>phi</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>waqt</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>No-slip wall (viscous) boundary conditions for the solution vector U</p>
<p>Applies the no-slip wall boundary conditions: Used to simulate viscous walls. The density and pressure at the physical boundary ghost points are extrapolated from the interior, while the velocities are set such that the interpolated velocity at the boundary face is the specified wall velocity. This boundary condition is specific to the two and three dimensional Navier-Stokes systems (<a class="el" href="a00169.html#a00589" title="Structure containing variables and parameters specific to the 2D Navier Stokes equations. This structure contains the physical parameters, variables, and function pointers specific to the 2D Navier-Stokes equations. ">NavierStokes2D</a>, <a class="el" href="a00170.html#a00590" title="Structure containing variables and parameters specific to the 3D Navier Stokes equations. This structure contains the physical parameters, variables, and function pointers specific to the 3D Navier-Stokes equations. ">NavierStokes3D</a>). </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">b</td><td>Boundary object of type <a class="el" href="a00155.html" title="Structure containing the variables and function pointers defining a boundary. ">DomainBoundary</a> </td></tr>
    <tr><td class="paramname">m</td><td>MPI object of type <a class="el" href="a00167.html#a00588" title="Structure of MPI-related variables. ">MPIVariables</a> </td></tr>
    <tr><td class="paramname">ndims</td><td>Number of spatial dimensions </td></tr>
    <tr><td class="paramname">nvars</td><td>Number of variables/DoFs per grid point </td></tr>
    <tr><td class="paramname">size</td><td>Integer array with the number of grid points in each spatial dimension </td></tr>
    <tr><td class="paramname">ghosts</td><td>Number of ghost points </td></tr>
    <tr><td class="paramname">phi</td><td>The solution array on which to apply the boundary condition </td></tr>
    <tr><td class="paramname">waqt</td><td>Current solution time </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="a00231_source.html#l00020">20</a> of file <a class="el" href="a00231_source.html">BCNoslipWall.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;{</div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;  <a class="code" href="a00155.html">DomainBoundary</a> *boundary = (<a class="code" href="a00155.html">DomainBoundary</a>*) b;</div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;</div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;  <span class="keywordtype">int</span> dim   = boundary-&gt;<a class="code" href="a00155.html#a70b5e28b5bc3d1b63a7435c5fe50b837">dim</a>;</div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;  <span class="keywordtype">int</span> face  = boundary-&gt;<a class="code" href="a00155.html#a9582c650f117a06449b5ee368b6762ef">face</a>;</div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;</div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;  <span class="keywordflow">if</span> (ndims == 2) {</div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;</div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;    <span class="comment">/* create a fake physics object */</span></div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;    <a class="code" href="a00169.html#a00589">NavierStokes2D</a> physics; </div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;    <span class="keywordtype">double</span> gamma;</div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;    gamma = physics.<a class="code" href="a00169.html#a72f9e01745b3a8203067ab84aefc9aea">gamma</a> = boundary-&gt;<a class="code" href="a00155.html#a72f9e01745b3a8203067ab84aefc9aea">gamma</a>;</div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;    <span class="keywordtype">double</span> inv_gamma_m1 = 1.0/(gamma-1.0);</div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;</div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;    <span class="keywordflow">if</span> (boundary-&gt;<a class="code" href="a00155.html#a2eec7e4ee612d5edc985ba81453346e1">on_this_proc</a>) {</div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;      <span class="keywordtype">int</span> bounds[ndims], indexb[ndims], indexi[ndims];</div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;      <a class="code" href="a00187.html#ab49d0f261ea751a17d6beca0504daf78">_ArraySubtract1D_</a>(bounds,boundary-&gt;<a class="code" href="a00155.html#a7602de5ebb1b59ec35217e78a35a531e">ie</a>,boundary-&gt;<a class="code" href="a00155.html#a481013ba007a99a4237cde5eeb3c9a29">is</a>,ndims);</div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;      <a class="code" href="a00187.html#a2b2826031c0cd92495ab351d3e599fc5">_ArraySetValue_</a>(indexb,ndims,0);</div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;      <span class="keywordtype">int</span> done = 0;</div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;      <span class="keywordflow">while</span> (!done) {</div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;        <span class="keywordtype">int</span> p1, p2;</div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;        <a class="code" href="a00187.html#a89e8330d9e06dd0666c50833628a125c">_ArrayCopy1D_</a>(indexb,indexi,ndims);</div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;        <a class="code" href="a00187.html#a98a3bb5fda2fcafb70a6288d100a0924">_ArrayAdd1D_</a>(indexi,indexi,boundary-&gt;<a class="code" href="a00155.html#a481013ba007a99a4237cde5eeb3c9a29">is</a>,ndims);</div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;        <span class="keywordflow">if</span>      (face ==  1) indexi[dim] = ghosts-1-indexb[dim];</div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (face == -1) indexi[dim] = size[dim]-indexb[dim]-1;</div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">return</span>(1);</div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;        <a class="code" href="a00187.html#a0739cb538f4d301fad3b45059ddd0738">_ArrayIndex1DWO_</a>(ndims,size,indexb,boundary-&gt;<a class="code" href="a00155.html#a481013ba007a99a4237cde5eeb3c9a29">is</a>,ghosts,p1);</div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;        <a class="code" href="a00187.html#afbb862a2fdf5b72b1f9ace42f64b556f">_ArrayIndex1D_</a>(ndims,size,indexi,ghosts,p2);</div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;        </div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;        <span class="comment">/* flow variables in the interior */</span></div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;        <span class="keywordtype">double</span> rho, uvel, vvel, energy, pressure;</div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;        <span class="keywordtype">double</span> rho_gpt, uvel_gpt, vvel_gpt, energy_gpt, pressure_gpt;</div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;        <a class="code" href="a00169.html#a90ce369a1f9d490ab6d392a996e5be4c">_NavierStokes2DGetFlowVar_</a>((phi+nvars*p2),rho,uvel,vvel,energy,pressure,(&amp;physics));</div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;        <span class="comment">/* set the ghost point values */</span></div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;        rho_gpt = rho;</div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;        pressure_gpt = pressure;</div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;        uvel_gpt = 2.0*boundary-&gt;<a class="code" href="a00155.html#a0d0d92fab642e1d02a9de254e73a3f21">FlowVelocity</a>[0] - uvel;</div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;        vvel_gpt = 2.0*boundary-&gt;<a class="code" href="a00155.html#a0d0d92fab642e1d02a9de254e73a3f21">FlowVelocity</a>[1] - vvel;</div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;        energy_gpt = inv_gamma_m1*pressure_gpt</div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;                    + 0.5 * rho_gpt * (uvel_gpt*uvel_gpt + vvel_gpt*vvel_gpt);</div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;</div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;        phi[nvars*p1+0] = rho_gpt;</div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;        phi[nvars*p1+1] = rho_gpt * uvel_gpt;</div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;        phi[nvars*p1+2] = rho_gpt * vvel_gpt;</div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;        phi[nvars*p1+3] = energy_gpt;</div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;</div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;        <a class="code" href="a00187.html#ac5ec1371623f11d03b0f42adaa24acbc">_ArrayIncrementIndex_</a>(ndims,bounds,indexb,done);</div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;      }</div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;    }</div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;</div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;  } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (ndims == 3) {</div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;</div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;    <span class="comment">/* create a fake physics object */</span></div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;    <a class="code" href="a00170.html#a00590">NavierStokes3D</a> physics;</div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;    <span class="keywordtype">double</span> gamma;</div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;    gamma = physics.<a class="code" href="a00170.html#a72f9e01745b3a8203067ab84aefc9aea">gamma</a> = boundary-&gt;<a class="code" href="a00155.html#a72f9e01745b3a8203067ab84aefc9aea">gamma</a>;</div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;    <span class="keywordtype">double</span> inv_gamma_m1 = 1.0/(gamma-1.0);</div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;</div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;    <span class="keywordflow">if</span> (boundary-&gt;<a class="code" href="a00155.html#a2eec7e4ee612d5edc985ba81453346e1">on_this_proc</a>) {</div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;      <span class="keywordtype">int</span> bounds[ndims], indexb[ndims], indexi[ndims];</div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;      <a class="code" href="a00187.html#ab49d0f261ea751a17d6beca0504daf78">_ArraySubtract1D_</a>(bounds,boundary-&gt;<a class="code" href="a00155.html#a7602de5ebb1b59ec35217e78a35a531e">ie</a>,boundary-&gt;<a class="code" href="a00155.html#a481013ba007a99a4237cde5eeb3c9a29">is</a>,ndims);</div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;      <a class="code" href="a00187.html#a2b2826031c0cd92495ab351d3e599fc5">_ArraySetValue_</a>(indexb,ndims,0);</div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;      <span class="keywordtype">int</span> done = 0;</div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;      <span class="keywordflow">while</span> (!done) {</div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;        <span class="keywordtype">int</span> p1, p2;</div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;        <a class="code" href="a00187.html#a89e8330d9e06dd0666c50833628a125c">_ArrayCopy1D_</a>(indexb,indexi,ndims);</div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;        <a class="code" href="a00187.html#a98a3bb5fda2fcafb70a6288d100a0924">_ArrayAdd1D_</a>(indexi,indexi,boundary-&gt;<a class="code" href="a00155.html#a481013ba007a99a4237cde5eeb3c9a29">is</a>,ndims);</div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;        <span class="keywordflow">if</span>      (face ==  1) indexi[dim] = ghosts-1-indexb[dim];</div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (face == -1) indexi[dim] = size[dim]-indexb[dim]-1;</div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">return</span>(1);</div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;        <a class="code" href="a00187.html#a0739cb538f4d301fad3b45059ddd0738">_ArrayIndex1DWO_</a>(ndims,size,indexb,boundary-&gt;<a class="code" href="a00155.html#a481013ba007a99a4237cde5eeb3c9a29">is</a>,ghosts,p1);</div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;        <a class="code" href="a00187.html#afbb862a2fdf5b72b1f9ace42f64b556f">_ArrayIndex1D_</a>(ndims,size,indexi,ghosts,p2);</div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;        </div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;        <span class="comment">/* flow variables in the interior */</span></div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;        <span class="keywordtype">double</span> rho, uvel, vvel, wvel, energy, pressure;</div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;        <span class="keywordtype">double</span> rho_gpt, uvel_gpt, vvel_gpt, wvel_gpt, energy_gpt, pressure_gpt;</div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;        <a class="code" href="a00170.html#a47cfbfdecf13cd3336cc049cfe93ed45">_NavierStokes3DGetFlowVar_</a>((phi+nvars*p2),rho,uvel,vvel,wvel,energy,pressure,(&amp;physics));</div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;        <span class="comment">/* set the ghost point values */</span></div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;        rho_gpt = rho;</div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;        pressure_gpt = pressure;</div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;        uvel_gpt = 2.0*boundary-&gt;<a class="code" href="a00155.html#a0d0d92fab642e1d02a9de254e73a3f21">FlowVelocity</a>[0] - uvel;</div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;        vvel_gpt = 2.0*boundary-&gt;<a class="code" href="a00155.html#a0d0d92fab642e1d02a9de254e73a3f21">FlowVelocity</a>[1] - vvel;</div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;        wvel_gpt = 2.0*boundary-&gt;<a class="code" href="a00155.html#a0d0d92fab642e1d02a9de254e73a3f21">FlowVelocity</a>[2] - wvel;</div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;        energy_gpt = inv_gamma_m1*pressure_gpt</div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;                    + 0.5 * rho_gpt </div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;                    * (uvel_gpt*uvel_gpt + vvel_gpt*vvel_gpt + wvel_gpt*wvel_gpt);</div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;</div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;        phi[nvars*p1+0] = rho_gpt;</div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;        phi[nvars*p1+1] = rho_gpt * uvel_gpt;</div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;        phi[nvars*p1+2] = rho_gpt * vvel_gpt;</div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;        phi[nvars*p1+3] = rho_gpt * wvel_gpt;</div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;        phi[nvars*p1+4] = energy_gpt;</div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;</div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;        <a class="code" href="a00187.html#ac5ec1371623f11d03b0f42adaa24acbc">_ArrayIncrementIndex_</a>(ndims,bounds,indexb,done);</div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;      }</div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;    }</div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;</div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;  }</div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;  <span class="keywordflow">return</span>(0);</div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;}</div>
<div class="ttc" id="a00187_html_a98a3bb5fda2fcafb70a6288d100a0924"><div class="ttname"><a href="a00187.html#a98a3bb5fda2fcafb70a6288d100a0924">_ArrayAdd1D_</a></div><div class="ttdeci">#define _ArrayAdd1D_(x, a, b, size)</div><div class="ttdef"><b>Definition:</b> <a href="a00187_source.html#l00211">arrayfunctions.h:211</a></div></div>
<div class="ttc" id="a00155_html_a70b5e28b5bc3d1b63a7435c5fe50b837"><div class="ttname"><a href="a00155.html#a70b5e28b5bc3d1b63a7435c5fe50b837">DomainBoundary::dim</a></div><div class="ttdeci">int dim</div><div class="ttdef"><b>Definition:</b> <a href="a00189_source.html#l00073">boundaryconditions.h:73</a></div></div>
<div class="ttc" id="a00187_html_a0739cb538f4d301fad3b45059ddd0738"><div class="ttname"><a href="a00187.html#a0739cb538f4d301fad3b45059ddd0738">_ArrayIndex1DWO_</a></div><div class="ttdeci">#define _ArrayIndex1DWO_(N, imax, i, offset, ghost, index)</div><div class="ttdef"><b>Definition:</b> <a href="a00187_source.html#l00082">arrayfunctions.h:82</a></div></div>
<div class="ttc" id="a00170_html_a72f9e01745b3a8203067ab84aefc9aea"><div class="ttname"><a href="a00170.html#a72f9e01745b3a8203067ab84aefc9aea">NavierStokes3D::gamma</a></div><div class="ttdeci">double gamma</div><div class="ttdef"><b>Definition:</b> <a href="a00170_source.html#l00485">navierstokes3d.h:485</a></div></div>
<div class="ttc" id="a00155_html_a481013ba007a99a4237cde5eeb3c9a29"><div class="ttname"><a href="a00155.html#a481013ba007a99a4237cde5eeb3c9a29">DomainBoundary::is</a></div><div class="ttdeci">int * is</div><div class="ttdef"><b>Definition:</b> <a href="a00189_source.html#l00082">boundaryconditions.h:82</a></div></div>
<div class="ttc" id="a00170_html_a47cfbfdecf13cd3336cc049cfe93ed45"><div class="ttname"><a href="a00170.html#a47cfbfdecf13cd3336cc049cfe93ed45">_NavierStokes3DGetFlowVar_</a></div><div class="ttdeci">#define _NavierStokes3DGetFlowVar_(u, rho, vx, vy, vz, e, P, p)</div><div class="ttdef"><b>Definition:</b> <a href="a00170_source.html#l00098">navierstokes3d.h:98</a></div></div>
<div class="ttc" id="a00155_html"><div class="ttname"><a href="a00155.html">DomainBoundary</a></div><div class="ttdoc">Structure containing the variables and function pointers defining a boundary. </div><div class="ttdef"><b>Definition:</b> <a href="a00189_source.html#l00068">boundaryconditions.h:68</a></div></div>
<div class="ttc" id="a00187_html_ab49d0f261ea751a17d6beca0504daf78"><div class="ttname"><a href="a00187.html#ab49d0f261ea751a17d6beca0504daf78">_ArraySubtract1D_</a></div><div class="ttdeci">#define _ArraySubtract1D_(x, a, b, size)</div><div class="ttdef"><b>Definition:</b> <a href="a00187_source.html#l00200">arrayfunctions.h:200</a></div></div>
<div class="ttc" id="a00170_html_a00590"><div class="ttname"><a href="a00170.html#a00590">NavierStokes3D</a></div><div class="ttdoc">Structure containing variables and parameters specific to the 3D Navier Stokes equations. This structure contains the physical parameters, variables, and function pointers specific to the 3D Navier-Stokes equations. </div><div class="ttdef"><b>Definition:</b> <a href="a00170_source.html#l00484">navierstokes3d.h:484</a></div></div>
<div class="ttc" id="a00187_html_afbb862a2fdf5b72b1f9ace42f64b556f"><div class="ttname"><a href="a00187.html#afbb862a2fdf5b72b1f9ace42f64b556f">_ArrayIndex1D_</a></div><div class="ttdeci">#define _ArrayIndex1D_(N, imax, i, ghost, index)</div><div class="ttdef"><b>Definition:</b> <a href="a00187_source.html#l00039">arrayfunctions.h:39</a></div></div>
<div class="ttc" id="a00169_html_a90ce369a1f9d490ab6d392a996e5be4c"><div class="ttname"><a href="a00169.html#a90ce369a1f9d490ab6d392a996e5be4c">_NavierStokes2DGetFlowVar_</a></div><div class="ttdeci">#define _NavierStokes2DGetFlowVar_(u, rho, vx, vy, e, P, p)</div><div class="ttdef"><b>Definition:</b> <a href="a00169_source.html#l00081">navierstokes2d.h:81</a></div></div>
<div class="ttc" id="a00169_html_a72f9e01745b3a8203067ab84aefc9aea"><div class="ttname"><a href="a00169.html#a72f9e01745b3a8203067ab84aefc9aea">NavierStokes2D::gamma</a></div><div class="ttdeci">double gamma</div><div class="ttdef"><b>Definition:</b> <a href="a00169_source.html#l00377">navierstokes2d.h:377</a></div></div>
<div class="ttc" id="a00169_html_a00589"><div class="ttname"><a href="a00169.html#a00589">NavierStokes2D</a></div><div class="ttdoc">Structure containing variables and parameters specific to the 2D Navier Stokes equations. This structure contains the physical parameters, variables, and function pointers specific to the 2D Navier-Stokes equations. </div><div class="ttdef"><b>Definition:</b> <a href="a00169_source.html#l00376">navierstokes2d.h:376</a></div></div>
<div class="ttc" id="a00187_html_ac5ec1371623f11d03b0f42adaa24acbc"><div class="ttname"><a href="a00187.html#ac5ec1371623f11d03b0f42adaa24acbc">_ArrayIncrementIndex_</a></div><div class="ttdeci">#define _ArrayIncrementIndex_(N, imax, i, done)</div><div class="ttdef"><b>Definition:</b> <a href="a00187_source.html#l00125">arrayfunctions.h:125</a></div></div>
<div class="ttc" id="a00155_html_a7602de5ebb1b59ec35217e78a35a531e"><div class="ttname"><a href="a00155.html#a7602de5ebb1b59ec35217e78a35a531e">DomainBoundary::ie</a></div><div class="ttdeci">int * ie</div><div class="ttdef"><b>Definition:</b> <a href="a00189_source.html#l00082">boundaryconditions.h:82</a></div></div>
<div class="ttc" id="a00155_html_a9582c650f117a06449b5ee368b6762ef"><div class="ttname"><a href="a00155.html#a9582c650f117a06449b5ee368b6762ef">DomainBoundary::face</a></div><div class="ttdeci">int face</div><div class="ttdef"><b>Definition:</b> <a href="a00189_source.html#l00075">boundaryconditions.h:75</a></div></div>
<div class="ttc" id="a00155_html_a72f9e01745b3a8203067ab84aefc9aea"><div class="ttname"><a href="a00155.html#a72f9e01745b3a8203067ab84aefc9aea">DomainBoundary::gamma</a></div><div class="ttdeci">double gamma</div><div class="ttdef"><b>Definition:</b> <a href="a00189_source.html#l00096">boundaryconditions.h:96</a></div></div>
<div class="ttc" id="a00187_html_a2b2826031c0cd92495ab351d3e599fc5"><div class="ttname"><a href="a00187.html#a2b2826031c0cd92495ab351d3e599fc5">_ArraySetValue_</a></div><div class="ttdeci">#define _ArraySetValue_(x, size, value)</div><div class="ttdef"><b>Definition:</b> <a href="a00187_source.html#l00168">arrayfunctions.h:168</a></div></div>
<div class="ttc" id="a00155_html_a2eec7e4ee612d5edc985ba81453346e1"><div class="ttname"><a href="a00155.html#a2eec7e4ee612d5edc985ba81453346e1">DomainBoundary::on_this_proc</a></div><div class="ttdeci">int on_this_proc</div><div class="ttdef"><b>Definition:</b> <a href="a00189_source.html#l00081">boundaryconditions.h:81</a></div></div>
<div class="ttc" id="a00155_html_a0d0d92fab642e1d02a9de254e73a3f21"><div class="ttname"><a href="a00155.html#a0d0d92fab642e1d02a9de254e73a3f21">DomainBoundary::FlowVelocity</a></div><div class="ttdeci">double * FlowVelocity</div><div class="ttdef"><b>Definition:</b> <a href="a00189_source.html#l00096">boundaryconditions.h:96</a></div></div>
<div class="ttc" id="a00187_html_a89e8330d9e06dd0666c50833628a125c"><div class="ttname"><a href="a00187.html#a89e8330d9e06dd0666c50833628a125c">_ArrayCopy1D_</a></div><div class="ttdeci">#define _ArrayCopy1D_(x, y, size)</div><div class="ttdef"><b>Definition:</b> <a href="a00187_source.html#l00318">arrayfunctions.h:318</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a8beb5adb606b8dbe322d0b2267bc0463"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int BCThermalNoslipWallU </td>
          <td>(</td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>b</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>m</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>ndims</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>nvars</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>size</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>ghosts</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>phi</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>waqt</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>No-slip thermal wall (viscous) boundary conditions for the solution vector U</p>
<p>Applies the thermal no-slip-wall boundary condition: This is specific to the 3D Navier-Stokes system (<a class="el" href="a00170.html#a00590" title="Structure containing variables and parameters specific to the 3D Navier Stokes equations. This structure contains the physical parameters, variables, and function pointers specific to the 3D Navier-Stokes equations. ">NavierStokes3D</a>). It is used for simulating walls boundaries, where the temperature is specified. The density at the ghost points is extrapolated from the interior. The velocity at the ghost points is set such that the interpolated velocity at the boundary face is the specified wall velocity. The pressure at the ghost points is set by multiplying the extrapolated density by the specified temperature.</p>
<p><b>Note:</b> It is assumed that the temperature already contains the gas constant factor, i.e., \( T = P/\rho\). </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">b</td><td>Boundary object of type <a class="el" href="a00155.html" title="Structure containing the variables and function pointers defining a boundary. ">DomainBoundary</a> </td></tr>
    <tr><td class="paramname">m</td><td>MPI object of type <a class="el" href="a00167.html#a00588" title="Structure of MPI-related variables. ">MPIVariables</a> </td></tr>
    <tr><td class="paramname">ndims</td><td>Number of spatial dimensions </td></tr>
    <tr><td class="paramname">nvars</td><td>Number of variables/DoFs per grid point </td></tr>
    <tr><td class="paramname">size</td><td>Integer array with the number of grid points in each spatial dimension </td></tr>
    <tr><td class="paramname">ghosts</td><td>Number of ghost points </td></tr>
    <tr><td class="paramname">phi</td><td>The solution array on which to apply the boundary condition </td></tr>
    <tr><td class="paramname">waqt</td><td>Current solution time </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="a00242_source.html#l00027">27</a> of file <a class="el" href="a00242_source.html">BCThermalNoslipWall.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;{</div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;  <a class="code" href="a00155.html">DomainBoundary</a> *boundary = (<a class="code" href="a00155.html">DomainBoundary</a>*) b;</div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;</div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;  <span class="keywordtype">int</span> dim   = boundary-&gt;<a class="code" href="a00155.html#a70b5e28b5bc3d1b63a7435c5fe50b837">dim</a>;</div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;  <span class="keywordtype">int</span> face  = boundary-&gt;<a class="code" href="a00155.html#a9582c650f117a06449b5ee368b6762ef">face</a>;</div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;</div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;  <span class="keywordflow">if</span> (ndims == 3) {</div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;</div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;    <span class="comment">/* create a fake physics object */</span></div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;    <a class="code" href="a00170.html#a00590">NavierStokes3D</a> physics; </div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;    <span class="keywordtype">double</span> gamma; </div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;    gamma = physics.<a class="code" href="a00170.html#a72f9e01745b3a8203067ab84aefc9aea">gamma</a> = boundary-&gt;<a class="code" href="a00155.html#a72f9e01745b3a8203067ab84aefc9aea">gamma</a>;</div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;    <span class="keywordtype">double</span> inv_gamma_m1 = 1.0/(gamma-1.0);</div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;</div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;    <span class="keywordflow">if</span> (boundary-&gt;<a class="code" href="a00155.html#a2eec7e4ee612d5edc985ba81453346e1">on_this_proc</a>) {</div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;</div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;      <span class="keywordtype">int</span>     *temperature_field_size = boundary-&gt;<a class="code" href="a00155.html#a6f46fcd429eeb105637c0e14d54d79e7">UnsteadyTemperatureSize</a>;</div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;      <span class="keywordtype">int</span>     n_time_levels           = temperature_field_size[dim];</div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;      <span class="keywordtype">double</span>  *time_levels            = boundary-&gt;<a class="code" href="a00155.html#af135619149474c2de735f5482e4d0a0e">UnsteadyTimeLevels</a>;</div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;      <span class="keywordtype">double</span>  *temperature_data       = boundary-&gt;<a class="code" href="a00155.html#a23dab9053d40cce5ba488290fb1b41c3">UnsteadyTemperatureData</a>;</div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;    </div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;      <span class="keywordtype">int</span> it = n_time_levels - 1;</div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;      <span class="keywordflow">while</span> ((time_levels[it] &gt; waqt) &amp;&amp; (it &gt; 0))  it--;</div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;</div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;      <span class="keywordtype">int</span> bounds[ndims], indexb[ndims], indexi[ndims];</div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;      <a class="code" href="a00187.html#ab49d0f261ea751a17d6beca0504daf78">_ArraySubtract1D_</a>(bounds,boundary-&gt;<a class="code" href="a00155.html#a7602de5ebb1b59ec35217e78a35a531e">ie</a>,boundary-&gt;<a class="code" href="a00155.html#a481013ba007a99a4237cde5eeb3c9a29">is</a>,ndims);</div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;      <a class="code" href="a00187.html#a2b2826031c0cd92495ab351d3e599fc5">_ArraySetValue_</a>(indexb,ndims,0);</div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;</div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;      <span class="keywordtype">int</span> done = 0;</div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;      <span class="keywordflow">while</span> (!done) {</div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;</div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;        <span class="keywordtype">int</span> p1, p2;</div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;        <a class="code" href="a00187.html#a89e8330d9e06dd0666c50833628a125c">_ArrayCopy1D_</a>(indexb,indexi,ndims);</div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;        <a class="code" href="a00187.html#a98a3bb5fda2fcafb70a6288d100a0924">_ArrayAdd1D_</a>(indexi,indexi,boundary-&gt;<a class="code" href="a00155.html#a481013ba007a99a4237cde5eeb3c9a29">is</a>,ndims);</div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;        <span class="keywordflow">if</span>      (face ==  1) indexi[dim] = ghosts-1-indexb[dim];</div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (face == -1) indexi[dim] = size[dim]-indexb[dim]-1;</div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">return</span>(1);</div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;        <a class="code" href="a00187.html#a0739cb538f4d301fad3b45059ddd0738">_ArrayIndex1DWO_</a>(ndims,size,indexb,boundary-&gt;<a class="code" href="a00155.html#a481013ba007a99a4237cde5eeb3c9a29">is</a>,ghosts,p1);</div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;        <a class="code" href="a00187.html#afbb862a2fdf5b72b1f9ace42f64b556f">_ArrayIndex1D_</a>(ndims,size,indexi,ghosts,p2);</div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;</div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;        <span class="comment">/* get the specified temperature */</span></div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;        <span class="keywordtype">int</span> index1[ndims]; <a class="code" href="a00187.html#a89e8330d9e06dd0666c50833628a125c">_ArrayCopy1D_</a>(indexb,index1,ndims);</div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;        index1[dim] = it;</div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;        <span class="keywordtype">int</span> q; <a class="code" href="a00187.html#afbb862a2fdf5b72b1f9ace42f64b556f">_ArrayIndex1D_</a>(ndims,temperature_field_size,index1,0,q);</div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;        <span class="keywordtype">double</span> temperature_b = temperature_data[q];</div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;        </div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;        <span class="comment">/* flow variables in the interior */</span></div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;        <span class="keywordtype">double</span> rho, uvel, vvel, wvel, energy, pressure;</div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;        <a class="code" href="a00170.html#a47cfbfdecf13cd3336cc049cfe93ed45">_NavierStokes3DGetFlowVar_</a>((phi+nvars*p2),rho,uvel,vvel,wvel,energy,pressure,(&amp;physics));</div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;        <span class="comment">/* set the ghost point values */</span></div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;        <span class="keywordtype">double</span> rho_gpt, uvel_gpt, vvel_gpt, wvel_gpt, energy_gpt, pressure_gpt;</div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;        rho_gpt = rho;</div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;        uvel_gpt = 2.0*boundary-&gt;<a class="code" href="a00155.html#a0d0d92fab642e1d02a9de254e73a3f21">FlowVelocity</a>[0] - uvel;</div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;        vvel_gpt = 2.0*boundary-&gt;<a class="code" href="a00155.html#a0d0d92fab642e1d02a9de254e73a3f21">FlowVelocity</a>[1] - vvel;</div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;        wvel_gpt = 2.0*boundary-&gt;<a class="code" href="a00155.html#a0d0d92fab642e1d02a9de254e73a3f21">FlowVelocity</a>[2] - wvel;</div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;        pressure_gpt = rho_gpt * temperature_b;</div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;        energy_gpt = inv_gamma_m1*pressure_gpt </div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;                    + 0.5 * rho_gpt </div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;                    * (uvel_gpt*uvel_gpt + vvel_gpt*vvel_gpt + wvel_gpt*wvel_gpt);</div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;</div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;        phi[nvars*p1+0] = rho_gpt;</div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;        phi[nvars*p1+1] = rho_gpt * uvel_gpt;</div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;        phi[nvars*p1+2] = rho_gpt * vvel_gpt;</div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;        phi[nvars*p1+3] = rho_gpt * wvel_gpt;</div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;        phi[nvars*p1+4] = energy_gpt;</div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;</div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;        <a class="code" href="a00187.html#ac5ec1371623f11d03b0f42adaa24acbc">_ArrayIncrementIndex_</a>(ndims,bounds,indexb,done);</div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;      }</div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;    }</div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;</div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;  }</div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;  <span class="keywordflow">return</span>(0);</div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;}</div>
<div class="ttc" id="a00187_html_a98a3bb5fda2fcafb70a6288d100a0924"><div class="ttname"><a href="a00187.html#a98a3bb5fda2fcafb70a6288d100a0924">_ArrayAdd1D_</a></div><div class="ttdeci">#define _ArrayAdd1D_(x, a, b, size)</div><div class="ttdef"><b>Definition:</b> <a href="a00187_source.html#l00211">arrayfunctions.h:211</a></div></div>
<div class="ttc" id="a00155_html_a70b5e28b5bc3d1b63a7435c5fe50b837"><div class="ttname"><a href="a00155.html#a70b5e28b5bc3d1b63a7435c5fe50b837">DomainBoundary::dim</a></div><div class="ttdeci">int dim</div><div class="ttdef"><b>Definition:</b> <a href="a00189_source.html#l00073">boundaryconditions.h:73</a></div></div>
<div class="ttc" id="a00187_html_a0739cb538f4d301fad3b45059ddd0738"><div class="ttname"><a href="a00187.html#a0739cb538f4d301fad3b45059ddd0738">_ArrayIndex1DWO_</a></div><div class="ttdeci">#define _ArrayIndex1DWO_(N, imax, i, offset, ghost, index)</div><div class="ttdef"><b>Definition:</b> <a href="a00187_source.html#l00082">arrayfunctions.h:82</a></div></div>
<div class="ttc" id="a00170_html_a72f9e01745b3a8203067ab84aefc9aea"><div class="ttname"><a href="a00170.html#a72f9e01745b3a8203067ab84aefc9aea">NavierStokes3D::gamma</a></div><div class="ttdeci">double gamma</div><div class="ttdef"><b>Definition:</b> <a href="a00170_source.html#l00485">navierstokes3d.h:485</a></div></div>
<div class="ttc" id="a00155_html_a481013ba007a99a4237cde5eeb3c9a29"><div class="ttname"><a href="a00155.html#a481013ba007a99a4237cde5eeb3c9a29">DomainBoundary::is</a></div><div class="ttdeci">int * is</div><div class="ttdef"><b>Definition:</b> <a href="a00189_source.html#l00082">boundaryconditions.h:82</a></div></div>
<div class="ttc" id="a00170_html_a47cfbfdecf13cd3336cc049cfe93ed45"><div class="ttname"><a href="a00170.html#a47cfbfdecf13cd3336cc049cfe93ed45">_NavierStokes3DGetFlowVar_</a></div><div class="ttdeci">#define _NavierStokes3DGetFlowVar_(u, rho, vx, vy, vz, e, P, p)</div><div class="ttdef"><b>Definition:</b> <a href="a00170_source.html#l00098">navierstokes3d.h:98</a></div></div>
<div class="ttc" id="a00155_html"><div class="ttname"><a href="a00155.html">DomainBoundary</a></div><div class="ttdoc">Structure containing the variables and function pointers defining a boundary. </div><div class="ttdef"><b>Definition:</b> <a href="a00189_source.html#l00068">boundaryconditions.h:68</a></div></div>
<div class="ttc" id="a00155_html_af135619149474c2de735f5482e4d0a0e"><div class="ttname"><a href="a00155.html#af135619149474c2de735f5482e4d0a0e">DomainBoundary::UnsteadyTimeLevels</a></div><div class="ttdeci">double * UnsteadyTimeLevels</div><div class="ttdef"><b>Definition:</b> <a href="a00189_source.html#l00103">boundaryconditions.h:103</a></div></div>
<div class="ttc" id="a00187_html_ab49d0f261ea751a17d6beca0504daf78"><div class="ttname"><a href="a00187.html#ab49d0f261ea751a17d6beca0504daf78">_ArraySubtract1D_</a></div><div class="ttdeci">#define _ArraySubtract1D_(x, a, b, size)</div><div class="ttdef"><b>Definition:</b> <a href="a00187_source.html#l00200">arrayfunctions.h:200</a></div></div>
<div class="ttc" id="a00170_html_a00590"><div class="ttname"><a href="a00170.html#a00590">NavierStokes3D</a></div><div class="ttdoc">Structure containing variables and parameters specific to the 3D Navier Stokes equations. This structure contains the physical parameters, variables, and function pointers specific to the 3D Navier-Stokes equations. </div><div class="ttdef"><b>Definition:</b> <a href="a00170_source.html#l00484">navierstokes3d.h:484</a></div></div>
<div class="ttc" id="a00187_html_afbb862a2fdf5b72b1f9ace42f64b556f"><div class="ttname"><a href="a00187.html#afbb862a2fdf5b72b1f9ace42f64b556f">_ArrayIndex1D_</a></div><div class="ttdeci">#define _ArrayIndex1D_(N, imax, i, ghost, index)</div><div class="ttdef"><b>Definition:</b> <a href="a00187_source.html#l00039">arrayfunctions.h:39</a></div></div>
<div class="ttc" id="a00187_html_ac5ec1371623f11d03b0f42adaa24acbc"><div class="ttname"><a href="a00187.html#ac5ec1371623f11d03b0f42adaa24acbc">_ArrayIncrementIndex_</a></div><div class="ttdeci">#define _ArrayIncrementIndex_(N, imax, i, done)</div><div class="ttdef"><b>Definition:</b> <a href="a00187_source.html#l00125">arrayfunctions.h:125</a></div></div>
<div class="ttc" id="a00155_html_a7602de5ebb1b59ec35217e78a35a531e"><div class="ttname"><a href="a00155.html#a7602de5ebb1b59ec35217e78a35a531e">DomainBoundary::ie</a></div><div class="ttdeci">int * ie</div><div class="ttdef"><b>Definition:</b> <a href="a00189_source.html#l00082">boundaryconditions.h:82</a></div></div>
<div class="ttc" id="a00155_html_a9582c650f117a06449b5ee368b6762ef"><div class="ttname"><a href="a00155.html#a9582c650f117a06449b5ee368b6762ef">DomainBoundary::face</a></div><div class="ttdeci">int face</div><div class="ttdef"><b>Definition:</b> <a href="a00189_source.html#l00075">boundaryconditions.h:75</a></div></div>
<div class="ttc" id="a00155_html_a72f9e01745b3a8203067ab84aefc9aea"><div class="ttname"><a href="a00155.html#a72f9e01745b3a8203067ab84aefc9aea">DomainBoundary::gamma</a></div><div class="ttdeci">double gamma</div><div class="ttdef"><b>Definition:</b> <a href="a00189_source.html#l00096">boundaryconditions.h:96</a></div></div>
<div class="ttc" id="a00155_html_a6f46fcd429eeb105637c0e14d54d79e7"><div class="ttname"><a href="a00155.html#a6f46fcd429eeb105637c0e14d54d79e7">DomainBoundary::UnsteadyTemperatureSize</a></div><div class="ttdeci">int * UnsteadyTemperatureSize</div><div class="ttdef"><b>Definition:</b> <a href="a00189_source.html#l00102">boundaryconditions.h:102</a></div></div>
<div class="ttc" id="a00187_html_a2b2826031c0cd92495ab351d3e599fc5"><div class="ttname"><a href="a00187.html#a2b2826031c0cd92495ab351d3e599fc5">_ArraySetValue_</a></div><div class="ttdeci">#define _ArraySetValue_(x, size, value)</div><div class="ttdef"><b>Definition:</b> <a href="a00187_source.html#l00168">arrayfunctions.h:168</a></div></div>
<div class="ttc" id="a00155_html_a2eec7e4ee612d5edc985ba81453346e1"><div class="ttname"><a href="a00155.html#a2eec7e4ee612d5edc985ba81453346e1">DomainBoundary::on_this_proc</a></div><div class="ttdeci">int on_this_proc</div><div class="ttdef"><b>Definition:</b> <a href="a00189_source.html#l00081">boundaryconditions.h:81</a></div></div>
<div class="ttc" id="a00155_html_a0d0d92fab642e1d02a9de254e73a3f21"><div class="ttname"><a href="a00155.html#a0d0d92fab642e1d02a9de254e73a3f21">DomainBoundary::FlowVelocity</a></div><div class="ttdeci">double * FlowVelocity</div><div class="ttdef"><b>Definition:</b> <a href="a00189_source.html#l00096">boundaryconditions.h:96</a></div></div>
<div class="ttc" id="a00155_html_a23dab9053d40cce5ba488290fb1b41c3"><div class="ttname"><a href="a00155.html#a23dab9053d40cce5ba488290fb1b41c3">DomainBoundary::UnsteadyTemperatureData</a></div><div class="ttdeci">double * UnsteadyTemperatureData</div><div class="ttdef"><b>Definition:</b> <a href="a00189_source.html#l00104">boundaryconditions.h:104</a></div></div>
<div class="ttc" id="a00187_html_a89e8330d9e06dd0666c50833628a125c"><div class="ttname"><a href="a00187.html#a89e8330d9e06dd0666c50833628a125c">_ArrayCopy1D_</a></div><div class="ttdeci">#define _ArrayCopy1D_(x, y, size)</div><div class="ttdef"><b>Definition:</b> <a href="a00187_source.html#l00318">arrayfunctions.h:318</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="aba3141eae84ed7f5b2cadefdcc207173"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int BCSlipWallU </td>
          <td>(</td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>b</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>m</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>ndims</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>nvars</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>size</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>ghosts</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>phi</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>waqt</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Slip (inviscid) wall boundary conditions for the solution vector U</p>
<p>Applies the slip-wall boundary condition: This is specific to the two and three dimensional Euler and Navier-Stokes systems (<a class="el" href="a00158.html#a00576">Euler2D</a>, <a class="el" href="a00169.html#a00589" title="Structure containing variables and parameters specific to the 2D Navier Stokes equations. This structure contains the physical parameters, variables, and function pointers specific to the 2D Navier-Stokes equations. ">NavierStokes2D</a>, <a class="el" href="a00170.html#a00590" title="Structure containing variables and parameters specific to the 3D Navier Stokes equations. This structure contains the physical parameters, variables, and function pointers specific to the 3D Navier-Stokes equations. ">NavierStokes3D</a>). It is used for simulating inviscid walls or symmetric boundaries. The pressure, density, and tangential velocity at the ghost points are extrapolated from the interior, while the normal velocity at the ghost points is set such that the interpolated value at the boundary face is equal to the specified wall velocity. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">b</td><td>Boundary object of type <a class="el" href="a00155.html" title="Structure containing the variables and function pointers defining a boundary. ">DomainBoundary</a> </td></tr>
    <tr><td class="paramname">m</td><td>MPI object of type <a class="el" href="a00167.html#a00588" title="Structure of MPI-related variables. ">MPIVariables</a> </td></tr>
    <tr><td class="paramname">ndims</td><td>Number of spatial dimensions </td></tr>
    <tr><td class="paramname">nvars</td><td>Number of variables/DoFs per grid point </td></tr>
    <tr><td class="paramname">size</td><td>Integer array with the number of grid points in each spatial dimension </td></tr>
    <tr><td class="paramname">ghosts</td><td>Number of ghost points </td></tr>
    <tr><td class="paramname">phi</td><td>The solution array on which to apply the boundary condition </td></tr>
    <tr><td class="paramname">waqt</td><td>Current solution time </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="a00234_source.html#l00022">22</a> of file <a class="el" href="a00234_source.html">BCSlipWall.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;{</div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;  <a class="code" href="a00155.html">DomainBoundary</a> *boundary = (<a class="code" href="a00155.html">DomainBoundary</a>*) b;</div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;</div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;  <span class="keywordtype">int</span> dim   = boundary-&gt;<a class="code" href="a00155.html#a70b5e28b5bc3d1b63a7435c5fe50b837">dim</a>;</div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;  <span class="keywordtype">int</span> face  = boundary-&gt;<a class="code" href="a00155.html#a9582c650f117a06449b5ee368b6762ef">face</a>;</div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;</div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;  <span class="keywordflow">if</span> (ndims == 1) {</div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;</div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;    <span class="comment">/* create a fake physics object */</span></div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;    <a class="code" href="a00157.html">Euler1D</a> physics; </div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;    <span class="keywordtype">double</span> gamma; </div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;    gamma = physics.<a class="code" href="a00157.html#a72f9e01745b3a8203067ab84aefc9aea">gamma</a> = boundary-&gt;<a class="code" href="a00155.html#a72f9e01745b3a8203067ab84aefc9aea">gamma</a>;</div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;    <span class="keywordtype">double</span> inv_gamma_m1 = 1.0/(gamma-1.0);</div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;</div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;    <span class="keywordflow">if</span> (boundary-&gt;<a class="code" href="a00155.html#a2eec7e4ee612d5edc985ba81453346e1">on_this_proc</a>) {</div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;      <span class="keywordtype">int</span> bounds[ndims], indexb[ndims], indexi[ndims];</div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;      <a class="code" href="a00187.html#ab49d0f261ea751a17d6beca0504daf78">_ArraySubtract1D_</a>(bounds,boundary-&gt;<a class="code" href="a00155.html#a7602de5ebb1b59ec35217e78a35a531e">ie</a>,boundary-&gt;<a class="code" href="a00155.html#a481013ba007a99a4237cde5eeb3c9a29">is</a>,ndims);</div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;      <a class="code" href="a00187.html#a2b2826031c0cd92495ab351d3e599fc5">_ArraySetValue_</a>(indexb,ndims,0);</div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;      <span class="keywordtype">int</span> done = 0;</div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;      <span class="keywordflow">while</span> (!done) {</div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;        <span class="keywordtype">int</span> p1, p2;</div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;        <a class="code" href="a00187.html#a89e8330d9e06dd0666c50833628a125c">_ArrayCopy1D_</a>(indexb,indexi,ndims);</div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;        <a class="code" href="a00187.html#a98a3bb5fda2fcafb70a6288d100a0924">_ArrayAdd1D_</a>(indexi,indexi,boundary-&gt;<a class="code" href="a00155.html#a481013ba007a99a4237cde5eeb3c9a29">is</a>,ndims);</div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;        <span class="keywordflow">if</span>      (face ==  1) indexi[dim] = ghosts-1-indexb[dim];</div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (face == -1) indexi[dim] = size[dim]-indexb[dim]-1;</div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">return</span>(1);</div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;        <a class="code" href="a00187.html#a0739cb538f4d301fad3b45059ddd0738">_ArrayIndex1DWO_</a>(ndims,size,indexb,boundary-&gt;<a class="code" href="a00155.html#a481013ba007a99a4237cde5eeb3c9a29">is</a>,ghosts,p1);</div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;        <a class="code" href="a00187.html#afbb862a2fdf5b72b1f9ace42f64b556f">_ArrayIndex1D_</a>(ndims,size,indexi,ghosts,p2);</div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;        </div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;        <span class="comment">/* flow variables in the interior */</span></div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;        <span class="keywordtype">double</span> rho, uvel, energy, pressure;</div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;        <span class="keywordtype">double</span> rho_gpt, uvel_gpt, energy_gpt, pressure_gpt;</div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;        <a class="code" href="a00206.html#af35510fb1477577f57c57cc2a862b1e7">_Euler1DGetFlowVar_</a>((phi+nvars*p2),rho,uvel,energy,pressure,(&amp;physics));</div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;        <span class="comment">/* set the ghost point values */</span></div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;        rho_gpt = rho;</div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;        pressure_gpt = pressure;</div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;        uvel_gpt = 2.0*boundary-&gt;<a class="code" href="a00155.html#a0d0d92fab642e1d02a9de254e73a3f21">FlowVelocity</a>[<a class="code" href="a00206.html#a6a44057228e5f4b86e1c4d04b2a28977">_XDIR_</a>] - uvel;</div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;        energy_gpt = inv_gamma_m1*pressure_gpt </div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;                    + 0.5 * rho_gpt * uvel_gpt*uvel_gpt;</div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;</div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;        phi[nvars*p1+0] = rho_gpt;</div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;        phi[nvars*p1+1] = rho_gpt * uvel_gpt;</div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;        phi[nvars*p1+2] = energy_gpt;</div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;</div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;        <a class="code" href="a00187.html#ac5ec1371623f11d03b0f42adaa24acbc">_ArrayIncrementIndex_</a>(ndims,bounds,indexb,done);</div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;      }</div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;    }</div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;</div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;  } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (ndims == 2) {</div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;</div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;    <span class="comment">/* create a fake physics object */</span></div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;    <a class="code" href="a00158.html#a00576">Euler2D</a> physics; </div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;    <span class="keywordtype">double</span> gamma; </div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;    gamma = physics.<a class="code" href="a00158.html#a72f9e01745b3a8203067ab84aefc9aea">gamma</a> = boundary-&gt;<a class="code" href="a00155.html#a72f9e01745b3a8203067ab84aefc9aea">gamma</a>;</div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;    <span class="keywordtype">double</span> inv_gamma_m1 = 1.0/(gamma-1.0);</div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;</div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;    <span class="keywordflow">if</span> (boundary-&gt;<a class="code" href="a00155.html#a2eec7e4ee612d5edc985ba81453346e1">on_this_proc</a>) {</div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;      <span class="keywordtype">int</span> bounds[ndims], indexb[ndims], indexi[ndims];</div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;      <a class="code" href="a00187.html#ab49d0f261ea751a17d6beca0504daf78">_ArraySubtract1D_</a>(bounds,boundary-&gt;<a class="code" href="a00155.html#a7602de5ebb1b59ec35217e78a35a531e">ie</a>,boundary-&gt;<a class="code" href="a00155.html#a481013ba007a99a4237cde5eeb3c9a29">is</a>,ndims);</div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;      <a class="code" href="a00187.html#a2b2826031c0cd92495ab351d3e599fc5">_ArraySetValue_</a>(indexb,ndims,0);</div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;      <span class="keywordtype">int</span> done = 0;</div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;      <span class="keywordflow">while</span> (!done) {</div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;        <span class="keywordtype">int</span> p1, p2;</div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;        <a class="code" href="a00187.html#a89e8330d9e06dd0666c50833628a125c">_ArrayCopy1D_</a>(indexb,indexi,ndims);</div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;        <a class="code" href="a00187.html#a98a3bb5fda2fcafb70a6288d100a0924">_ArrayAdd1D_</a>(indexi,indexi,boundary-&gt;<a class="code" href="a00155.html#a481013ba007a99a4237cde5eeb3c9a29">is</a>,ndims);</div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;        <span class="keywordflow">if</span>      (face ==  1) indexi[dim] = ghosts-1-indexb[dim];</div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (face == -1) indexi[dim] = size[dim]-indexb[dim]-1;</div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">return</span>(1);</div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;        <a class="code" href="a00187.html#a0739cb538f4d301fad3b45059ddd0738">_ArrayIndex1DWO_</a>(ndims,size,indexb,boundary-&gt;<a class="code" href="a00155.html#a481013ba007a99a4237cde5eeb3c9a29">is</a>,ghosts,p1);</div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;        <a class="code" href="a00187.html#afbb862a2fdf5b72b1f9ace42f64b556f">_ArrayIndex1D_</a>(ndims,size,indexi,ghosts,p2);</div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;        </div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;        <span class="comment">/* flow variables in the interior */</span></div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;        <span class="keywordtype">double</span> rho, uvel, vvel, energy, pressure;</div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;        <span class="keywordtype">double</span> rho_gpt, uvel_gpt, vvel_gpt, energy_gpt, pressure_gpt;</div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;        <a class="code" href="a00158.html#afff338b9964cae67fd9b3f4dc224e77b">_Euler2DGetFlowVar_</a>((phi+nvars*p2),rho,uvel,vvel,energy,pressure,(&amp;physics));</div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;        <span class="comment">/* set the ghost point values */</span></div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;        rho_gpt = rho;</div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;        pressure_gpt = pressure;</div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;        <span class="keywordflow">if</span> (dim == <a class="code" href="a00206.html#a6a44057228e5f4b86e1c4d04b2a28977">_XDIR_</a>) {</div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;          uvel_gpt = 2.0*boundary-&gt;<a class="code" href="a00155.html#a0d0d92fab642e1d02a9de254e73a3f21">FlowVelocity</a>[<a class="code" href="a00206.html#a6a44057228e5f4b86e1c4d04b2a28977">_XDIR_</a>] - uvel;</div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;          vvel_gpt = vvel;</div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;        } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (dim == <a class="code" href="a00158.html#a7fd32e06617f4489079bc50ce9bfc00c">_YDIR_</a>) {</div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;          uvel_gpt = uvel;</div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;          vvel_gpt = 2.0*boundary-&gt;<a class="code" href="a00155.html#a0d0d92fab642e1d02a9de254e73a3f21">FlowVelocity</a>[<a class="code" href="a00158.html#a7fd32e06617f4489079bc50ce9bfc00c">_YDIR_</a>] - vvel;</div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;          uvel_gpt = 0.0;</div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;          vvel_gpt = 0.0;</div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;        }</div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;        energy_gpt = inv_gamma_m1*pressure_gpt </div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;                    + 0.5 * rho_gpt * (uvel_gpt*uvel_gpt + vvel_gpt*vvel_gpt);</div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;</div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;        phi[nvars*p1+0] = rho_gpt;</div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;        phi[nvars*p1+1] = rho_gpt * uvel_gpt;</div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;        phi[nvars*p1+2] = rho_gpt * vvel_gpt;</div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;        phi[nvars*p1+3] = energy_gpt;</div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;</div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;        <a class="code" href="a00187.html#ac5ec1371623f11d03b0f42adaa24acbc">_ArrayIncrementIndex_</a>(ndims,bounds,indexb,done);</div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;      }</div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;    }</div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;</div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;  } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (ndims == 3) {</div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;</div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;    <span class="comment">/* create a fake physics object */</span></div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;    <a class="code" href="a00170.html#a00590">NavierStokes3D</a> physics; </div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;    <span class="keywordtype">double</span> gamma; </div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;    gamma = physics.<a class="code" href="a00170.html#a72f9e01745b3a8203067ab84aefc9aea">gamma</a> = boundary-&gt;<a class="code" href="a00155.html#a72f9e01745b3a8203067ab84aefc9aea">gamma</a>;</div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;    <span class="keywordtype">double</span> inv_gamma_m1 = 1.0/(gamma-1.0);</div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;</div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;    <span class="keywordflow">if</span> (boundary-&gt;<a class="code" href="a00155.html#a2eec7e4ee612d5edc985ba81453346e1">on_this_proc</a>) {</div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;      <span class="keywordtype">int</span> bounds[ndims], indexb[ndims], indexi[ndims];</div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;      <a class="code" href="a00187.html#ab49d0f261ea751a17d6beca0504daf78">_ArraySubtract1D_</a>(bounds,boundary-&gt;<a class="code" href="a00155.html#a7602de5ebb1b59ec35217e78a35a531e">ie</a>,boundary-&gt;<a class="code" href="a00155.html#a481013ba007a99a4237cde5eeb3c9a29">is</a>,ndims);</div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;      <a class="code" href="a00187.html#a2b2826031c0cd92495ab351d3e599fc5">_ArraySetValue_</a>(indexb,ndims,0);</div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;      <span class="keywordtype">int</span> done = 0;</div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;      <span class="keywordflow">while</span> (!done) {</div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;        <span class="keywordtype">int</span> p1, p2;</div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;        <a class="code" href="a00187.html#a89e8330d9e06dd0666c50833628a125c">_ArrayCopy1D_</a>(indexb,indexi,ndims);</div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;        <a class="code" href="a00187.html#a98a3bb5fda2fcafb70a6288d100a0924">_ArrayAdd1D_</a>(indexi,indexi,boundary-&gt;<a class="code" href="a00155.html#a481013ba007a99a4237cde5eeb3c9a29">is</a>,ndims);</div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;        <span class="keywordflow">if</span>      (face ==  1) indexi[dim] = ghosts-1-indexb[dim];</div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (face == -1) indexi[dim] = size[dim]-indexb[dim]-1;</div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">return</span>(1);</div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;        <a class="code" href="a00187.html#a0739cb538f4d301fad3b45059ddd0738">_ArrayIndex1DWO_</a>(ndims,size,indexb,boundary-&gt;<a class="code" href="a00155.html#a481013ba007a99a4237cde5eeb3c9a29">is</a>,ghosts,p1);</div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;        <a class="code" href="a00187.html#afbb862a2fdf5b72b1f9ace42f64b556f">_ArrayIndex1D_</a>(ndims,size,indexi,ghosts,p2);</div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;        </div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;        <span class="comment">/* flow variables in the interior */</span></div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;        <span class="keywordtype">double</span> rho, uvel, vvel, wvel, energy, pressure;</div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;        <span class="keywordtype">double</span> rho_gpt, uvel_gpt, vvel_gpt, wvel_gpt, energy_gpt, pressure_gpt;</div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;        <a class="code" href="a00170.html#a47cfbfdecf13cd3336cc049cfe93ed45">_NavierStokes3DGetFlowVar_</a>((phi+nvars*p2),rho,uvel,vvel,wvel,energy,pressure,(&amp;physics));</div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;        <span class="comment">/* set the ghost point values */</span></div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;        rho_gpt = rho;</div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;        pressure_gpt = pressure;</div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;        <span class="keywordflow">if</span> (dim == <a class="code" href="a00206.html#a6a44057228e5f4b86e1c4d04b2a28977">_XDIR_</a>) {</div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;          uvel_gpt = 2.0*boundary-&gt;<a class="code" href="a00155.html#a0d0d92fab642e1d02a9de254e73a3f21">FlowVelocity</a>[<a class="code" href="a00206.html#a6a44057228e5f4b86e1c4d04b2a28977">_XDIR_</a>] - uvel;</div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;          vvel_gpt = vvel;</div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;          wvel_gpt = wvel;</div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;        } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (dim == <a class="code" href="a00158.html#a7fd32e06617f4489079bc50ce9bfc00c">_YDIR_</a>) {</div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;          uvel_gpt = uvel;</div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;          vvel_gpt = 2.0*boundary-&gt;<a class="code" href="a00155.html#a0d0d92fab642e1d02a9de254e73a3f21">FlowVelocity</a>[<a class="code" href="a00158.html#a7fd32e06617f4489079bc50ce9bfc00c">_YDIR_</a>] - vvel;</div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;          wvel_gpt = wvel;</div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;        } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (dim == <a class="code" href="a00170.html#a227beecac6bef022707512c15d39e30b">_ZDIR_</a>) {</div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;          uvel_gpt = uvel;</div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;          vvel_gpt = vvel;</div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;          wvel_gpt = 2.0*boundary-&gt;<a class="code" href="a00155.html#a0d0d92fab642e1d02a9de254e73a3f21">FlowVelocity</a>[<a class="code" href="a00170.html#a227beecac6bef022707512c15d39e30b">_ZDIR_</a>] - wvel;</div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;          uvel_gpt = 0.0;</div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;          vvel_gpt = 0.0;</div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;          wvel_gpt = 0.0;</div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;        }</div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;        energy_gpt = inv_gamma_m1*pressure_gpt </div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;                    + 0.5 * rho_gpt </div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;                    * (uvel_gpt*uvel_gpt + vvel_gpt*vvel_gpt + wvel_gpt*wvel_gpt);</div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;</div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;        phi[nvars*p1+0] = rho_gpt;</div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;        phi[nvars*p1+1] = rho_gpt * uvel_gpt;</div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;        phi[nvars*p1+2] = rho_gpt * vvel_gpt;</div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;        phi[nvars*p1+3] = rho_gpt * wvel_gpt;</div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;        phi[nvars*p1+4] = energy_gpt;</div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;</div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;        <a class="code" href="a00187.html#ac5ec1371623f11d03b0f42adaa24acbc">_ArrayIncrementIndex_</a>(ndims,bounds,indexb,done);</div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;      }</div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;    }</div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;</div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;  }</div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;  <span class="keywordflow">return</span>(0);</div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;}</div>
<div class="ttc" id="a00158_html_afff338b9964cae67fd9b3f4dc224e77b"><div class="ttname"><a href="a00158.html#afff338b9964cae67fd9b3f4dc224e77b">_Euler2DGetFlowVar_</a></div><div class="ttdeci">#define _Euler2DGetFlowVar_(u, rho, vx, vy, e, P, p)</div><div class="ttdef"><b>Definition:</b> <a href="a00158_source.html#l00044">euler2d.h:44</a></div></div>
<div class="ttc" id="a00187_html_a98a3bb5fda2fcafb70a6288d100a0924"><div class="ttname"><a href="a00187.html#a98a3bb5fda2fcafb70a6288d100a0924">_ArrayAdd1D_</a></div><div class="ttdeci">#define _ArrayAdd1D_(x, a, b, size)</div><div class="ttdef"><b>Definition:</b> <a href="a00187_source.html#l00211">arrayfunctions.h:211</a></div></div>
<div class="ttc" id="a00157_html_a72f9e01745b3a8203067ab84aefc9aea"><div class="ttname"><a href="a00157.html#a72f9e01745b3a8203067ab84aefc9aea">Euler1D::gamma</a></div><div class="ttdeci">double gamma</div><div class="ttdef"><b>Definition:</b> <a href="a00206_source.html#l00274">euler1d.h:274</a></div></div>
<div class="ttc" id="a00155_html_a70b5e28b5bc3d1b63a7435c5fe50b837"><div class="ttname"><a href="a00155.html#a70b5e28b5bc3d1b63a7435c5fe50b837">DomainBoundary::dim</a></div><div class="ttdeci">int dim</div><div class="ttdef"><b>Definition:</b> <a href="a00189_source.html#l00073">boundaryconditions.h:73</a></div></div>
<div class="ttc" id="a00187_html_a0739cb538f4d301fad3b45059ddd0738"><div class="ttname"><a href="a00187.html#a0739cb538f4d301fad3b45059ddd0738">_ArrayIndex1DWO_</a></div><div class="ttdeci">#define _ArrayIndex1DWO_(N, imax, i, offset, ghost, index)</div><div class="ttdef"><b>Definition:</b> <a href="a00187_source.html#l00082">arrayfunctions.h:82</a></div></div>
<div class="ttc" id="a00170_html_a72f9e01745b3a8203067ab84aefc9aea"><div class="ttname"><a href="a00170.html#a72f9e01745b3a8203067ab84aefc9aea">NavierStokes3D::gamma</a></div><div class="ttdeci">double gamma</div><div class="ttdef"><b>Definition:</b> <a href="a00170_source.html#l00485">navierstokes3d.h:485</a></div></div>
<div class="ttc" id="a00158_html_a72f9e01745b3a8203067ab84aefc9aea"><div class="ttname"><a href="a00158.html#a72f9e01745b3a8203067ab84aefc9aea">Euler2D::gamma</a></div><div class="ttdeci">double gamma</div><div class="ttdef"><b>Definition:</b> <a href="a00158_source.html#l00245">euler2d.h:245</a></div></div>
<div class="ttc" id="a00155_html_a481013ba007a99a4237cde5eeb3c9a29"><div class="ttname"><a href="a00155.html#a481013ba007a99a4237cde5eeb3c9a29">DomainBoundary::is</a></div><div class="ttdeci">int * is</div><div class="ttdef"><b>Definition:</b> <a href="a00189_source.html#l00082">boundaryconditions.h:82</a></div></div>
<div class="ttc" id="a00170_html_a47cfbfdecf13cd3336cc049cfe93ed45"><div class="ttname"><a href="a00170.html#a47cfbfdecf13cd3336cc049cfe93ed45">_NavierStokes3DGetFlowVar_</a></div><div class="ttdeci">#define _NavierStokes3DGetFlowVar_(u, rho, vx, vy, vz, e, P, p)</div><div class="ttdef"><b>Definition:</b> <a href="a00170_source.html#l00098">navierstokes3d.h:98</a></div></div>
<div class="ttc" id="a00155_html"><div class="ttname"><a href="a00155.html">DomainBoundary</a></div><div class="ttdoc">Structure containing the variables and function pointers defining a boundary. </div><div class="ttdef"><b>Definition:</b> <a href="a00189_source.html#l00068">boundaryconditions.h:68</a></div></div>
<div class="ttc" id="a00187_html_ab49d0f261ea751a17d6beca0504daf78"><div class="ttname"><a href="a00187.html#ab49d0f261ea751a17d6beca0504daf78">_ArraySubtract1D_</a></div><div class="ttdeci">#define _ArraySubtract1D_(x, a, b, size)</div><div class="ttdef"><b>Definition:</b> <a href="a00187_source.html#l00200">arrayfunctions.h:200</a></div></div>
<div class="ttc" id="a00170_html_a00590"><div class="ttname"><a href="a00170.html#a00590">NavierStokes3D</a></div><div class="ttdoc">Structure containing variables and parameters specific to the 3D Navier Stokes equations. This structure contains the physical parameters, variables, and function pointers specific to the 3D Navier-Stokes equations. </div><div class="ttdef"><b>Definition:</b> <a href="a00170_source.html#l00484">navierstokes3d.h:484</a></div></div>
<div class="ttc" id="a00187_html_afbb862a2fdf5b72b1f9ace42f64b556f"><div class="ttname"><a href="a00187.html#afbb862a2fdf5b72b1f9ace42f64b556f">_ArrayIndex1D_</a></div><div class="ttdeci">#define _ArrayIndex1D_(N, imax, i, ghost, index)</div><div class="ttdef"><b>Definition:</b> <a href="a00187_source.html#l00039">arrayfunctions.h:39</a></div></div>
<div class="ttc" id="a00170_html_a227beecac6bef022707512c15d39e30b"><div class="ttname"><a href="a00170.html#a227beecac6bef022707512c15d39e30b">_ZDIR_</a></div><div class="ttdeci">#define _ZDIR_</div><div class="ttdef"><b>Definition:</b> <a href="a00170_source.html#l00076">navierstokes3d.h:76</a></div></div>
<div class="ttc" id="a00187_html_ac5ec1371623f11d03b0f42adaa24acbc"><div class="ttname"><a href="a00187.html#ac5ec1371623f11d03b0f42adaa24acbc">_ArrayIncrementIndex_</a></div><div class="ttdeci">#define _ArrayIncrementIndex_(N, imax, i, done)</div><div class="ttdef"><b>Definition:</b> <a href="a00187_source.html#l00125">arrayfunctions.h:125</a></div></div>
<div class="ttc" id="a00155_html_a7602de5ebb1b59ec35217e78a35a531e"><div class="ttname"><a href="a00155.html#a7602de5ebb1b59ec35217e78a35a531e">DomainBoundary::ie</a></div><div class="ttdeci">int * ie</div><div class="ttdef"><b>Definition:</b> <a href="a00189_source.html#l00082">boundaryconditions.h:82</a></div></div>
<div class="ttc" id="a00155_html_a9582c650f117a06449b5ee368b6762ef"><div class="ttname"><a href="a00155.html#a9582c650f117a06449b5ee368b6762ef">DomainBoundary::face</a></div><div class="ttdeci">int face</div><div class="ttdef"><b>Definition:</b> <a href="a00189_source.html#l00075">boundaryconditions.h:75</a></div></div>
<div class="ttc" id="a00155_html_a72f9e01745b3a8203067ab84aefc9aea"><div class="ttname"><a href="a00155.html#a72f9e01745b3a8203067ab84aefc9aea">DomainBoundary::gamma</a></div><div class="ttdeci">double gamma</div><div class="ttdef"><b>Definition:</b> <a href="a00189_source.html#l00096">boundaryconditions.h:96</a></div></div>
<div class="ttc" id="a00206_html_a6a44057228e5f4b86e1c4d04b2a28977"><div class="ttname"><a href="a00206.html#a6a44057228e5f4b86e1c4d04b2a28977">_XDIR_</a></div><div class="ttdeci">#define _XDIR_</div><div class="ttdef"><b>Definition:</b> <a href="a00206_source.html#l00075">euler1d.h:75</a></div></div>
<div class="ttc" id="a00206_html_af35510fb1477577f57c57cc2a862b1e7"><div class="ttname"><a href="a00206.html#af35510fb1477577f57c57cc2a862b1e7">_Euler1DGetFlowVar_</a></div><div class="ttdeci">#define _Euler1DGetFlowVar_(u, rho, v, e, P, p)</div><div class="ttdef"><b>Definition:</b> <a href="a00206_source.html#l00081">euler1d.h:81</a></div></div>
<div class="ttc" id="a00187_html_a2b2826031c0cd92495ab351d3e599fc5"><div class="ttname"><a href="a00187.html#a2b2826031c0cd92495ab351d3e599fc5">_ArraySetValue_</a></div><div class="ttdeci">#define _ArraySetValue_(x, size, value)</div><div class="ttdef"><b>Definition:</b> <a href="a00187_source.html#l00168">arrayfunctions.h:168</a></div></div>
<div class="ttc" id="a00157_html"><div class="ttname"><a href="a00157.html">Euler1D</a></div><div class="ttdoc">Structure containing variables and parameters specific to the 1D Euler equations. This structure cont...</div><div class="ttdef"><b>Definition:</b> <a href="a00206_source.html#l00273">euler1d.h:273</a></div></div>
<div class="ttc" id="a00155_html_a2eec7e4ee612d5edc985ba81453346e1"><div class="ttname"><a href="a00155.html#a2eec7e4ee612d5edc985ba81453346e1">DomainBoundary::on_this_proc</a></div><div class="ttdeci">int on_this_proc</div><div class="ttdef"><b>Definition:</b> <a href="a00189_source.html#l00081">boundaryconditions.h:81</a></div></div>
<div class="ttc" id="a00158_html_a00576"><div class="ttname"><a href="a00158.html#a00576">Euler2D</a></div><div class="ttdef"><b>Definition:</b> <a href="a00158_source.html#l00244">euler2d.h:244</a></div></div>
<div class="ttc" id="a00155_html_a0d0d92fab642e1d02a9de254e73a3f21"><div class="ttname"><a href="a00155.html#a0d0d92fab642e1d02a9de254e73a3f21">DomainBoundary::FlowVelocity</a></div><div class="ttdeci">double * FlowVelocity</div><div class="ttdef"><b>Definition:</b> <a href="a00189_source.html#l00096">boundaryconditions.h:96</a></div></div>
<div class="ttc" id="a00158_html_a7fd32e06617f4489079bc50ce9bfc00c"><div class="ttname"><a href="a00158.html#a7fd32e06617f4489079bc50ce9bfc00c">_YDIR_</a></div><div class="ttdeci">#define _YDIR_</div><div class="ttdef"><b>Definition:</b> <a href="a00158_source.html#l00041">euler2d.h:41</a></div></div>
<div class="ttc" id="a00187_html_a89e8330d9e06dd0666c50833628a125c"><div class="ttname"><a href="a00187.html#a89e8330d9e06dd0666c50833628a125c">_ArrayCopy1D_</a></div><div class="ttdeci">#define _ArrayCopy1D_(x, y, size)</div><div class="ttdef"><b>Definition:</b> <a href="a00187_source.html#l00318">arrayfunctions.h:318</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a30077b675efd008f1cd3bc0e1f0692a3"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int BCThermalSlipWallU </td>
          <td>(</td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>b</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>m</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>ndims</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>nvars</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>size</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>ghosts</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>phi</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>waqt</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Slip (inviscid) thermal wall boundary conditions for the solution vector U</p>
<p>Applies the thermal slip-wall boundary condition: This is specific to the 3D Navier-Stokes system (<a class="el" href="a00170.html#a00590" title="Structure containing variables and parameters specific to the 3D Navier Stokes equations. This structure contains the physical parameters, variables, and function pointers specific to the 3D Navier-Stokes equations. ">NavierStokes3D</a>). It is used for simulating inviscid walls or symmetric boundaries, where the temperature is specified. The density and the tangential velocity at the ghost points are extrapolated for the interior. The normal velocity at the ghost points is set such that the interpolated velocity at the boundary face is the specified wall velocity. The pressure at the ghost points is set by multiplying the extrapolated density by the specified temperature.</p>
<p><b>Note:</b> It is assumed that the temperature already contains the gas constant factor, i.e., \( T = P/\rho\). </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">b</td><td>Boundary object of type <a class="el" href="a00155.html" title="Structure containing the variables and function pointers defining a boundary. ">DomainBoundary</a> </td></tr>
    <tr><td class="paramname">m</td><td>MPI object of type <a class="el" href="a00167.html#a00588" title="Structure of MPI-related variables. ">MPIVariables</a> </td></tr>
    <tr><td class="paramname">ndims</td><td>Number of spatial dimensions </td></tr>
    <tr><td class="paramname">nvars</td><td>Number of variables/DoFs per grid point </td></tr>
    <tr><td class="paramname">size</td><td>Integer array with the number of grid points in each spatial dimension </td></tr>
    <tr><td class="paramname">ghosts</td><td>Number of ghost points </td></tr>
    <tr><td class="paramname">phi</td><td>The solution array on which to apply the boundary condition </td></tr>
    <tr><td class="paramname">waqt</td><td>Current solution time </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="a00243_source.html#l00027">27</a> of file <a class="el" href="a00243_source.html">BCThermalSlipWall.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;{</div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;  <a class="code" href="a00155.html">DomainBoundary</a> *boundary = (<a class="code" href="a00155.html">DomainBoundary</a>*) b;</div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;</div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;  <span class="keywordtype">int</span> dim   = boundary-&gt;<a class="code" href="a00155.html#a70b5e28b5bc3d1b63a7435c5fe50b837">dim</a>;</div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;  <span class="keywordtype">int</span> face  = boundary-&gt;<a class="code" href="a00155.html#a9582c650f117a06449b5ee368b6762ef">face</a>;</div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;</div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;  <span class="keywordflow">if</span> (ndims == 3) {</div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;</div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;    <span class="comment">/* create a fake physics object */</span></div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;    <a class="code" href="a00170.html#a00590">NavierStokes3D</a> physics; </div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;    <span class="keywordtype">double</span> gamma; </div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;    gamma = physics.<a class="code" href="a00170.html#a72f9e01745b3a8203067ab84aefc9aea">gamma</a> = boundary-&gt;<a class="code" href="a00155.html#a72f9e01745b3a8203067ab84aefc9aea">gamma</a>;</div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;    <span class="keywordtype">double</span> inv_gamma_m1 = 1.0/(gamma-1.0);</div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;</div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;    <span class="keywordflow">if</span> (boundary-&gt;<a class="code" href="a00155.html#a2eec7e4ee612d5edc985ba81453346e1">on_this_proc</a>) {</div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;</div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;      <span class="keywordtype">int</span>     *temperature_field_size = boundary-&gt;<a class="code" href="a00155.html#a6f46fcd429eeb105637c0e14d54d79e7">UnsteadyTemperatureSize</a>;</div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;      <span class="keywordtype">int</span>     n_time_levels           = temperature_field_size[dim];</div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;      <span class="keywordtype">double</span>  *time_levels            = boundary-&gt;<a class="code" href="a00155.html#af135619149474c2de735f5482e4d0a0e">UnsteadyTimeLevels</a>;</div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;      <span class="keywordtype">double</span>  *temperature_data       = boundary-&gt;<a class="code" href="a00155.html#a23dab9053d40cce5ba488290fb1b41c3">UnsteadyTemperatureData</a>;</div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;    </div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;      <span class="keywordtype">int</span> it = n_time_levels - 1;</div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;      <span class="keywordflow">while</span> ((time_levels[it] &gt; waqt) &amp;&amp; (it &gt; 0))  it--;</div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;</div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;      <span class="keywordtype">int</span> bounds[ndims], indexb[ndims], indexi[ndims];</div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;      <a class="code" href="a00187.html#ab49d0f261ea751a17d6beca0504daf78">_ArraySubtract1D_</a>(bounds,boundary-&gt;<a class="code" href="a00155.html#a7602de5ebb1b59ec35217e78a35a531e">ie</a>,boundary-&gt;<a class="code" href="a00155.html#a481013ba007a99a4237cde5eeb3c9a29">is</a>,ndims);</div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;      <a class="code" href="a00187.html#a2b2826031c0cd92495ab351d3e599fc5">_ArraySetValue_</a>(indexb,ndims,0);</div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;</div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;      <span class="keywordtype">int</span> done = 0;</div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;      <span class="keywordflow">while</span> (!done) {</div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;</div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;        <span class="keywordtype">int</span> p1, p2;</div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;        <a class="code" href="a00187.html#a89e8330d9e06dd0666c50833628a125c">_ArrayCopy1D_</a>(indexb,indexi,ndims);</div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;        <a class="code" href="a00187.html#a98a3bb5fda2fcafb70a6288d100a0924">_ArrayAdd1D_</a>(indexi,indexi,boundary-&gt;<a class="code" href="a00155.html#a481013ba007a99a4237cde5eeb3c9a29">is</a>,ndims);</div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;        <span class="keywordflow">if</span>      (face ==  1) indexi[dim] = ghosts-1-indexb[dim];</div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (face == -1) indexi[dim] = size[dim]-indexb[dim]-1;</div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">return</span>(1);</div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;        <a class="code" href="a00187.html#a0739cb538f4d301fad3b45059ddd0738">_ArrayIndex1DWO_</a>(ndims,size,indexb,boundary-&gt;<a class="code" href="a00155.html#a481013ba007a99a4237cde5eeb3c9a29">is</a>,ghosts,p1);</div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;        <a class="code" href="a00187.html#afbb862a2fdf5b72b1f9ace42f64b556f">_ArrayIndex1D_</a>(ndims,size,indexi,ghosts,p2);</div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;</div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;        <span class="comment">/* get the specified temperature */</span></div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;        <span class="keywordtype">int</span> index1[ndims]; <a class="code" href="a00187.html#a89e8330d9e06dd0666c50833628a125c">_ArrayCopy1D_</a>(indexb,index1,ndims);</div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;        index1[dim] = it;</div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;        <span class="keywordtype">int</span> q; <a class="code" href="a00187.html#afbb862a2fdf5b72b1f9ace42f64b556f">_ArrayIndex1D_</a>(ndims,temperature_field_size,index1,0,q);</div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;        <span class="keywordtype">double</span> temperature_b = temperature_data[q];</div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;        </div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;        <span class="comment">/* flow variables in the interior */</span></div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;        <span class="keywordtype">double</span> rho, uvel, vvel, wvel, energy, pressure;</div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;        <a class="code" href="a00170.html#a47cfbfdecf13cd3336cc049cfe93ed45">_NavierStokes3DGetFlowVar_</a>((phi+nvars*p2),rho,uvel,vvel,wvel,energy,pressure,(&amp;physics));</div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;        <span class="comment">/* set the ghost point values */</span></div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;        <span class="keywordtype">double</span> rho_gpt, uvel_gpt, vvel_gpt, wvel_gpt, energy_gpt, pressure_gpt;</div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;        rho_gpt = rho;</div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;        <span class="keywordflow">if</span> (dim == <a class="code" href="a00206.html#a6a44057228e5f4b86e1c4d04b2a28977">_XDIR_</a>) {</div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;          uvel_gpt = 2.0*boundary-&gt;<a class="code" href="a00155.html#a0d0d92fab642e1d02a9de254e73a3f21">FlowVelocity</a>[<a class="code" href="a00206.html#a6a44057228e5f4b86e1c4d04b2a28977">_XDIR_</a>] - uvel;</div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;          vvel_gpt = vvel;</div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;          wvel_gpt = wvel;</div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;        } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (dim == <a class="code" href="a00158.html#a7fd32e06617f4489079bc50ce9bfc00c">_YDIR_</a>) {</div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;          uvel_gpt = uvel;</div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;          vvel_gpt = 2.0*boundary-&gt;<a class="code" href="a00155.html#a0d0d92fab642e1d02a9de254e73a3f21">FlowVelocity</a>[<a class="code" href="a00158.html#a7fd32e06617f4489079bc50ce9bfc00c">_YDIR_</a>] - vvel;</div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;          wvel_gpt = wvel;</div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;        } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (dim == <a class="code" href="a00170.html#a227beecac6bef022707512c15d39e30b">_ZDIR_</a>) {</div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;          uvel_gpt = uvel;</div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;          vvel_gpt = vvel;</div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;          wvel_gpt = 2.0*boundary-&gt;<a class="code" href="a00155.html#a0d0d92fab642e1d02a9de254e73a3f21">FlowVelocity</a>[<a class="code" href="a00170.html#a227beecac6bef022707512c15d39e30b">_ZDIR_</a>] - wvel;</div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;          uvel_gpt = 0.0;</div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;          vvel_gpt = 0.0;</div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;          wvel_gpt = 0.0;</div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;        }</div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;        pressure_gpt = rho_gpt * temperature_b;</div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;        energy_gpt = inv_gamma_m1*pressure_gpt </div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;                    + 0.5 * rho_gpt </div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;                    * (uvel_gpt*uvel_gpt + vvel_gpt*vvel_gpt + wvel_gpt*wvel_gpt);</div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;</div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;        phi[nvars*p1+0] = rho_gpt;</div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;        phi[nvars*p1+1] = rho_gpt * uvel_gpt;</div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;        phi[nvars*p1+2] = rho_gpt * vvel_gpt;</div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;        phi[nvars*p1+3] = rho_gpt * wvel_gpt;</div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;        phi[nvars*p1+4] = energy_gpt;</div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;</div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;        <a class="code" href="a00187.html#ac5ec1371623f11d03b0f42adaa24acbc">_ArrayIncrementIndex_</a>(ndims,bounds,indexb,done);</div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;      }</div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;    }</div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;</div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;  }</div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;  <span class="keywordflow">return</span>(0);</div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;}</div>
<div class="ttc" id="a00187_html_a98a3bb5fda2fcafb70a6288d100a0924"><div class="ttname"><a href="a00187.html#a98a3bb5fda2fcafb70a6288d100a0924">_ArrayAdd1D_</a></div><div class="ttdeci">#define _ArrayAdd1D_(x, a, b, size)</div><div class="ttdef"><b>Definition:</b> <a href="a00187_source.html#l00211">arrayfunctions.h:211</a></div></div>
<div class="ttc" id="a00155_html_a70b5e28b5bc3d1b63a7435c5fe50b837"><div class="ttname"><a href="a00155.html#a70b5e28b5bc3d1b63a7435c5fe50b837">DomainBoundary::dim</a></div><div class="ttdeci">int dim</div><div class="ttdef"><b>Definition:</b> <a href="a00189_source.html#l00073">boundaryconditions.h:73</a></div></div>
<div class="ttc" id="a00187_html_a0739cb538f4d301fad3b45059ddd0738"><div class="ttname"><a href="a00187.html#a0739cb538f4d301fad3b45059ddd0738">_ArrayIndex1DWO_</a></div><div class="ttdeci">#define _ArrayIndex1DWO_(N, imax, i, offset, ghost, index)</div><div class="ttdef"><b>Definition:</b> <a href="a00187_source.html#l00082">arrayfunctions.h:82</a></div></div>
<div class="ttc" id="a00170_html_a72f9e01745b3a8203067ab84aefc9aea"><div class="ttname"><a href="a00170.html#a72f9e01745b3a8203067ab84aefc9aea">NavierStokes3D::gamma</a></div><div class="ttdeci">double gamma</div><div class="ttdef"><b>Definition:</b> <a href="a00170_source.html#l00485">navierstokes3d.h:485</a></div></div>
<div class="ttc" id="a00155_html_a481013ba007a99a4237cde5eeb3c9a29"><div class="ttname"><a href="a00155.html#a481013ba007a99a4237cde5eeb3c9a29">DomainBoundary::is</a></div><div class="ttdeci">int * is</div><div class="ttdef"><b>Definition:</b> <a href="a00189_source.html#l00082">boundaryconditions.h:82</a></div></div>
<div class="ttc" id="a00170_html_a47cfbfdecf13cd3336cc049cfe93ed45"><div class="ttname"><a href="a00170.html#a47cfbfdecf13cd3336cc049cfe93ed45">_NavierStokes3DGetFlowVar_</a></div><div class="ttdeci">#define _NavierStokes3DGetFlowVar_(u, rho, vx, vy, vz, e, P, p)</div><div class="ttdef"><b>Definition:</b> <a href="a00170_source.html#l00098">navierstokes3d.h:98</a></div></div>
<div class="ttc" id="a00155_html"><div class="ttname"><a href="a00155.html">DomainBoundary</a></div><div class="ttdoc">Structure containing the variables and function pointers defining a boundary. </div><div class="ttdef"><b>Definition:</b> <a href="a00189_source.html#l00068">boundaryconditions.h:68</a></div></div>
<div class="ttc" id="a00155_html_af135619149474c2de735f5482e4d0a0e"><div class="ttname"><a href="a00155.html#af135619149474c2de735f5482e4d0a0e">DomainBoundary::UnsteadyTimeLevels</a></div><div class="ttdeci">double * UnsteadyTimeLevels</div><div class="ttdef"><b>Definition:</b> <a href="a00189_source.html#l00103">boundaryconditions.h:103</a></div></div>
<div class="ttc" id="a00187_html_ab49d0f261ea751a17d6beca0504daf78"><div class="ttname"><a href="a00187.html#ab49d0f261ea751a17d6beca0504daf78">_ArraySubtract1D_</a></div><div class="ttdeci">#define _ArraySubtract1D_(x, a, b, size)</div><div class="ttdef"><b>Definition:</b> <a href="a00187_source.html#l00200">arrayfunctions.h:200</a></div></div>
<div class="ttc" id="a00170_html_a00590"><div class="ttname"><a href="a00170.html#a00590">NavierStokes3D</a></div><div class="ttdoc">Structure containing variables and parameters specific to the 3D Navier Stokes equations. This structure contains the physical parameters, variables, and function pointers specific to the 3D Navier-Stokes equations. </div><div class="ttdef"><b>Definition:</b> <a href="a00170_source.html#l00484">navierstokes3d.h:484</a></div></div>
<div class="ttc" id="a00187_html_afbb862a2fdf5b72b1f9ace42f64b556f"><div class="ttname"><a href="a00187.html#afbb862a2fdf5b72b1f9ace42f64b556f">_ArrayIndex1D_</a></div><div class="ttdeci">#define _ArrayIndex1D_(N, imax, i, ghost, index)</div><div class="ttdef"><b>Definition:</b> <a href="a00187_source.html#l00039">arrayfunctions.h:39</a></div></div>
<div class="ttc" id="a00170_html_a227beecac6bef022707512c15d39e30b"><div class="ttname"><a href="a00170.html#a227beecac6bef022707512c15d39e30b">_ZDIR_</a></div><div class="ttdeci">#define _ZDIR_</div><div class="ttdef"><b>Definition:</b> <a href="a00170_source.html#l00076">navierstokes3d.h:76</a></div></div>
<div class="ttc" id="a00187_html_ac5ec1371623f11d03b0f42adaa24acbc"><div class="ttname"><a href="a00187.html#ac5ec1371623f11d03b0f42adaa24acbc">_ArrayIncrementIndex_</a></div><div class="ttdeci">#define _ArrayIncrementIndex_(N, imax, i, done)</div><div class="ttdef"><b>Definition:</b> <a href="a00187_source.html#l00125">arrayfunctions.h:125</a></div></div>
<div class="ttc" id="a00155_html_a7602de5ebb1b59ec35217e78a35a531e"><div class="ttname"><a href="a00155.html#a7602de5ebb1b59ec35217e78a35a531e">DomainBoundary::ie</a></div><div class="ttdeci">int * ie</div><div class="ttdef"><b>Definition:</b> <a href="a00189_source.html#l00082">boundaryconditions.h:82</a></div></div>
<div class="ttc" id="a00155_html_a9582c650f117a06449b5ee368b6762ef"><div class="ttname"><a href="a00155.html#a9582c650f117a06449b5ee368b6762ef">DomainBoundary::face</a></div><div class="ttdeci">int face</div><div class="ttdef"><b>Definition:</b> <a href="a00189_source.html#l00075">boundaryconditions.h:75</a></div></div>
<div class="ttc" id="a00155_html_a72f9e01745b3a8203067ab84aefc9aea"><div class="ttname"><a href="a00155.html#a72f9e01745b3a8203067ab84aefc9aea">DomainBoundary::gamma</a></div><div class="ttdeci">double gamma</div><div class="ttdef"><b>Definition:</b> <a href="a00189_source.html#l00096">boundaryconditions.h:96</a></div></div>
<div class="ttc" id="a00155_html_a6f46fcd429eeb105637c0e14d54d79e7"><div class="ttname"><a href="a00155.html#a6f46fcd429eeb105637c0e14d54d79e7">DomainBoundary::UnsteadyTemperatureSize</a></div><div class="ttdeci">int * UnsteadyTemperatureSize</div><div class="ttdef"><b>Definition:</b> <a href="a00189_source.html#l00102">boundaryconditions.h:102</a></div></div>
<div class="ttc" id="a00206_html_a6a44057228e5f4b86e1c4d04b2a28977"><div class="ttname"><a href="a00206.html#a6a44057228e5f4b86e1c4d04b2a28977">_XDIR_</a></div><div class="ttdeci">#define _XDIR_</div><div class="ttdef"><b>Definition:</b> <a href="a00206_source.html#l00075">euler1d.h:75</a></div></div>
<div class="ttc" id="a00187_html_a2b2826031c0cd92495ab351d3e599fc5"><div class="ttname"><a href="a00187.html#a2b2826031c0cd92495ab351d3e599fc5">_ArraySetValue_</a></div><div class="ttdeci">#define _ArraySetValue_(x, size, value)</div><div class="ttdef"><b>Definition:</b> <a href="a00187_source.html#l00168">arrayfunctions.h:168</a></div></div>
<div class="ttc" id="a00155_html_a2eec7e4ee612d5edc985ba81453346e1"><div class="ttname"><a href="a00155.html#a2eec7e4ee612d5edc985ba81453346e1">DomainBoundary::on_this_proc</a></div><div class="ttdeci">int on_this_proc</div><div class="ttdef"><b>Definition:</b> <a href="a00189_source.html#l00081">boundaryconditions.h:81</a></div></div>
<div class="ttc" id="a00155_html_a0d0d92fab642e1d02a9de254e73a3f21"><div class="ttname"><a href="a00155.html#a0d0d92fab642e1d02a9de254e73a3f21">DomainBoundary::FlowVelocity</a></div><div class="ttdeci">double * FlowVelocity</div><div class="ttdef"><b>Definition:</b> <a href="a00189_source.html#l00096">boundaryconditions.h:96</a></div></div>
<div class="ttc" id="a00158_html_a7fd32e06617f4489079bc50ce9bfc00c"><div class="ttname"><a href="a00158.html#a7fd32e06617f4489079bc50ce9bfc00c">_YDIR_</a></div><div class="ttdeci">#define _YDIR_</div><div class="ttdef"><b>Definition:</b> <a href="a00158_source.html#l00041">euler2d.h:41</a></div></div>
<div class="ttc" id="a00155_html_a23dab9053d40cce5ba488290fb1b41c3"><div class="ttname"><a href="a00155.html#a23dab9053d40cce5ba488290fb1b41c3">DomainBoundary::UnsteadyTemperatureData</a></div><div class="ttdeci">double * UnsteadyTemperatureData</div><div class="ttdef"><b>Definition:</b> <a href="a00189_source.html#l00104">boundaryconditions.h:104</a></div></div>
<div class="ttc" id="a00187_html_a89e8330d9e06dd0666c50833628a125c"><div class="ttname"><a href="a00187.html#a89e8330d9e06dd0666c50833628a125c">_ArrayCopy1D_</a></div><div class="ttdeci">#define _ArrayCopy1D_(x, y, size)</div><div class="ttdef"><b>Definition:</b> <a href="a00187_source.html#l00318">arrayfunctions.h:318</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a1fa2ad192d85d7f6e958f845d151af10"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int BCSubsonicInflowU </td>
          <td>(</td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>b</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>m</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>ndims</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>nvars</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>size</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>ghosts</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>phi</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>waqt</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Subsonic inflow boundary conditions for the solution vector U</p>
<p>Applies the subsonic inflow boundary condition: The density and velocity at the physical boundary ghost points are specified, while the pressure is extrapolated from the interior of the domain. This boundary condition is specific to two and three dimension Euler and Navier-Stokes systems (<a class="el" href="a00158.html#a00576">Euler2D</a>, <a class="el" href="a00169.html#a00589" title="Structure containing variables and parameters specific to the 2D Navier Stokes equations. This structure contains the physical parameters, variables, and function pointers specific to the 2D Navier-Stokes equations. ">NavierStokes2D</a>, <a class="el" href="a00170.html#a00590" title="Structure containing variables and parameters specific to the 3D Navier Stokes equations. This structure contains the physical parameters, variables, and function pointers specific to the 3D Navier-Stokes equations. ">NavierStokes3D</a>). </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">b</td><td>Boundary object of type <a class="el" href="a00155.html" title="Structure containing the variables and function pointers defining a boundary. ">DomainBoundary</a> </td></tr>
    <tr><td class="paramname">m</td><td>MPI object of type <a class="el" href="a00167.html#a00588" title="Structure of MPI-related variables. ">MPIVariables</a> </td></tr>
    <tr><td class="paramname">ndims</td><td>Number of spatial dimensions </td></tr>
    <tr><td class="paramname">nvars</td><td>Number of variables/DoFs per grid point </td></tr>
    <tr><td class="paramname">size</td><td>Integer array with the number of grid points in each spatial dimension </td></tr>
    <tr><td class="paramname">ghosts</td><td>Number of ghost points </td></tr>
    <tr><td class="paramname">phi</td><td>The solution array on which to apply the boundary condition </td></tr>
    <tr><td class="paramname">waqt</td><td>Current solution time </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="a00237_source.html#l00020">20</a> of file <a class="el" href="a00237_source.html">BCSubsonicInflow.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;{</div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;  <a class="code" href="a00155.html">DomainBoundary</a> *boundary = (<a class="code" href="a00155.html">DomainBoundary</a>*) b;</div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;</div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;  <span class="keywordtype">int</span> dim   = boundary-&gt;<a class="code" href="a00155.html#a70b5e28b5bc3d1b63a7435c5fe50b837">dim</a>;</div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;  <span class="keywordtype">int</span> face  = boundary-&gt;<a class="code" href="a00155.html#a9582c650f117a06449b5ee368b6762ef">face</a>;</div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;</div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;  <span class="keywordflow">if</span> (ndims == 2) {</div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;</div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;    <span class="comment">/* create a fake physics object */</span></div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;    <a class="code" href="a00158.html#a00576">Euler2D</a> physics; </div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;    <span class="keywordtype">double</span> gamma;</div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;    gamma = physics.<a class="code" href="a00158.html#a72f9e01745b3a8203067ab84aefc9aea">gamma</a> = boundary-&gt;<a class="code" href="a00155.html#a72f9e01745b3a8203067ab84aefc9aea">gamma</a>;</div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;    <span class="keywordtype">double</span> inv_gamma_m1 = 1.0/(gamma-1.0);</div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;</div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;    <span class="keywordflow">if</span> (boundary-&gt;<a class="code" href="a00155.html#a2eec7e4ee612d5edc985ba81453346e1">on_this_proc</a>) {</div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;      <span class="keywordtype">int</span> bounds[ndims], indexb[ndims], indexi[ndims];</div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;      <a class="code" href="a00187.html#ab49d0f261ea751a17d6beca0504daf78">_ArraySubtract1D_</a>(bounds,boundary-&gt;<a class="code" href="a00155.html#a7602de5ebb1b59ec35217e78a35a531e">ie</a>,boundary-&gt;<a class="code" href="a00155.html#a481013ba007a99a4237cde5eeb3c9a29">is</a>,ndims);</div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;      <a class="code" href="a00187.html#a2b2826031c0cd92495ab351d3e599fc5">_ArraySetValue_</a>(indexb,ndims,0);</div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;      <span class="keywordtype">int</span> done = 0;</div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;      <span class="keywordflow">while</span> (!done) {</div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;        <span class="keywordtype">int</span> p1, p2;</div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;        <a class="code" href="a00187.html#a89e8330d9e06dd0666c50833628a125c">_ArrayCopy1D_</a>(indexb,indexi,ndims);</div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;        <a class="code" href="a00187.html#a98a3bb5fda2fcafb70a6288d100a0924">_ArrayAdd1D_</a>(indexi,indexi,boundary-&gt;<a class="code" href="a00155.html#a481013ba007a99a4237cde5eeb3c9a29">is</a>,ndims);</div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;        <span class="keywordflow">if</span>      (face ==  1) indexi[dim] = ghosts-1-indexb[dim];</div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (face == -1) indexi[dim] = size[dim]-indexb[dim]-1;</div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">return</span>(1);</div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;        <a class="code" href="a00187.html#a0739cb538f4d301fad3b45059ddd0738">_ArrayIndex1DWO_</a>(ndims,size,indexb,boundary-&gt;<a class="code" href="a00155.html#a481013ba007a99a4237cde5eeb3c9a29">is</a>,ghosts,p1);</div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;        <a class="code" href="a00187.html#afbb862a2fdf5b72b1f9ace42f64b556f">_ArrayIndex1D_</a>(ndims,size,indexi,ghosts,p2);</div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;        </div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;        <span class="comment">/* flow variables in the interior */</span></div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;        <span class="keywordtype">double</span> rho, uvel, vvel, energy, pressure;</div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;        <span class="keywordtype">double</span> rho_gpt, uvel_gpt, vvel_gpt, energy_gpt, pressure_gpt;</div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;        <a class="code" href="a00158.html#afff338b9964cae67fd9b3f4dc224e77b">_Euler2DGetFlowVar_</a>((phi+nvars*p2),rho,uvel,vvel,energy,pressure,(&amp;physics));</div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;        <span class="comment">/* set the ghost point values */</span></div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;        rho_gpt = boundary-&gt;<a class="code" href="a00155.html#aa92ee9d8efc5ca49f4a83d8dabf0b15d">FlowDensity</a>;</div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;        pressure_gpt = pressure;</div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;        uvel_gpt = boundary-&gt;<a class="code" href="a00155.html#a0d0d92fab642e1d02a9de254e73a3f21">FlowVelocity</a>[0];</div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;        vvel_gpt = boundary-&gt;<a class="code" href="a00155.html#a0d0d92fab642e1d02a9de254e73a3f21">FlowVelocity</a>[1];</div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;        energy_gpt = inv_gamma_m1*pressure_gpt</div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;                    + 0.5 * rho_gpt * (uvel_gpt*uvel_gpt + vvel_gpt*vvel_gpt);</div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;</div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;        phi[nvars*p1+0] = rho_gpt;</div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;        phi[nvars*p1+1] = rho_gpt * uvel_gpt;</div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;        phi[nvars*p1+2] = rho_gpt * vvel_gpt;</div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;        phi[nvars*p1+3] = energy_gpt;</div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;</div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;        <a class="code" href="a00187.html#ac5ec1371623f11d03b0f42adaa24acbc">_ArrayIncrementIndex_</a>(ndims,bounds,indexb,done);</div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;      }</div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;    }</div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;</div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;  } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (ndims == 3) {</div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;</div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;    <span class="comment">/* create a fake physics object */</span></div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;    <a class="code" href="a00170.html#a00590">NavierStokes3D</a> physics;</div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;    <span class="keywordtype">double</span> gamma;</div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;    gamma = physics.<a class="code" href="a00170.html#a72f9e01745b3a8203067ab84aefc9aea">gamma</a> = boundary-&gt;<a class="code" href="a00155.html#a72f9e01745b3a8203067ab84aefc9aea">gamma</a>;</div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;    <span class="keywordtype">double</span> inv_gamma_m1 = 1.0/(gamma-1.0);</div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;</div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;    <span class="keywordflow">if</span> (boundary-&gt;<a class="code" href="a00155.html#a2eec7e4ee612d5edc985ba81453346e1">on_this_proc</a>) {</div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;      <span class="keywordtype">int</span> bounds[ndims], indexb[ndims], indexi[ndims];</div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;      <a class="code" href="a00187.html#ab49d0f261ea751a17d6beca0504daf78">_ArraySubtract1D_</a>(bounds,boundary-&gt;<a class="code" href="a00155.html#a7602de5ebb1b59ec35217e78a35a531e">ie</a>,boundary-&gt;<a class="code" href="a00155.html#a481013ba007a99a4237cde5eeb3c9a29">is</a>,ndims);</div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;      <a class="code" href="a00187.html#a2b2826031c0cd92495ab351d3e599fc5">_ArraySetValue_</a>(indexb,ndims,0);</div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;      <span class="keywordtype">int</span> done = 0;</div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;      <span class="keywordflow">while</span> (!done) {</div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;        <span class="keywordtype">int</span> p1, p2;</div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;        <a class="code" href="a00187.html#a89e8330d9e06dd0666c50833628a125c">_ArrayCopy1D_</a>(indexb,indexi,ndims);</div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;        <a class="code" href="a00187.html#a98a3bb5fda2fcafb70a6288d100a0924">_ArrayAdd1D_</a>(indexi,indexi,boundary-&gt;<a class="code" href="a00155.html#a481013ba007a99a4237cde5eeb3c9a29">is</a>,ndims);</div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;        <span class="keywordflow">if</span>      (face ==  1) indexi[dim] = ghosts-1-indexb[dim];</div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (face == -1) indexi[dim] = size[dim]-indexb[dim]-1;</div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">return</span>(1);</div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;        <a class="code" href="a00187.html#a0739cb538f4d301fad3b45059ddd0738">_ArrayIndex1DWO_</a>(ndims,size,indexb,boundary-&gt;<a class="code" href="a00155.html#a481013ba007a99a4237cde5eeb3c9a29">is</a>,ghosts,p1);</div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;        <a class="code" href="a00187.html#afbb862a2fdf5b72b1f9ace42f64b556f">_ArrayIndex1D_</a>(ndims,size,indexi,ghosts,p2);</div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;        </div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;        <span class="comment">/* flow variables in the interior */</span></div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;        <span class="keywordtype">double</span> rho, uvel, vvel, wvel, energy, pressure;</div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;        <span class="keywordtype">double</span> rho_gpt, uvel_gpt, vvel_gpt, wvel_gpt, energy_gpt, pressure_gpt;</div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;        <a class="code" href="a00170.html#a47cfbfdecf13cd3336cc049cfe93ed45">_NavierStokes3DGetFlowVar_</a>((phi+nvars*p2),rho,uvel,vvel,wvel,energy,pressure,(&amp;physics));</div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;        <span class="comment">/* set the ghost point values */</span></div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;        rho_gpt = boundary-&gt;<a class="code" href="a00155.html#aa92ee9d8efc5ca49f4a83d8dabf0b15d">FlowDensity</a>;</div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;        pressure_gpt = pressure;</div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;        uvel_gpt = boundary-&gt;<a class="code" href="a00155.html#a0d0d92fab642e1d02a9de254e73a3f21">FlowVelocity</a>[0];</div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;        vvel_gpt = boundary-&gt;<a class="code" href="a00155.html#a0d0d92fab642e1d02a9de254e73a3f21">FlowVelocity</a>[1];</div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;        wvel_gpt = boundary-&gt;<a class="code" href="a00155.html#a0d0d92fab642e1d02a9de254e73a3f21">FlowVelocity</a>[2];</div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;        energy_gpt = inv_gamma_m1*pressure_gpt</div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;                    + 0.5 * rho_gpt </div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;                    * (uvel_gpt*uvel_gpt + vvel_gpt*vvel_gpt + wvel_gpt*wvel_gpt);</div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;</div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;        phi[nvars*p1+0] = rho_gpt;</div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;        phi[nvars*p1+1] = rho_gpt * uvel_gpt;</div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;        phi[nvars*p1+2] = rho_gpt * vvel_gpt;</div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;        phi[nvars*p1+3] = rho_gpt * wvel_gpt;</div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;        phi[nvars*p1+4] = energy_gpt;</div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;</div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;        <a class="code" href="a00187.html#ac5ec1371623f11d03b0f42adaa24acbc">_ArrayIncrementIndex_</a>(ndims,bounds,indexb,done);</div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;      }</div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;    }</div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;</div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;  }</div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;  <span class="keywordflow">return</span>(0);</div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;}</div>
<div class="ttc" id="a00158_html_afff338b9964cae67fd9b3f4dc224e77b"><div class="ttname"><a href="a00158.html#afff338b9964cae67fd9b3f4dc224e77b">_Euler2DGetFlowVar_</a></div><div class="ttdeci">#define _Euler2DGetFlowVar_(u, rho, vx, vy, e, P, p)</div><div class="ttdef"><b>Definition:</b> <a href="a00158_source.html#l00044">euler2d.h:44</a></div></div>
<div class="ttc" id="a00155_html_aa92ee9d8efc5ca49f4a83d8dabf0b15d"><div class="ttname"><a href="a00155.html#aa92ee9d8efc5ca49f4a83d8dabf0b15d">DomainBoundary::FlowDensity</a></div><div class="ttdeci">double FlowDensity</div><div class="ttdef"><b>Definition:</b> <a href="a00189_source.html#l00096">boundaryconditions.h:96</a></div></div>
<div class="ttc" id="a00187_html_a98a3bb5fda2fcafb70a6288d100a0924"><div class="ttname"><a href="a00187.html#a98a3bb5fda2fcafb70a6288d100a0924">_ArrayAdd1D_</a></div><div class="ttdeci">#define _ArrayAdd1D_(x, a, b, size)</div><div class="ttdef"><b>Definition:</b> <a href="a00187_source.html#l00211">arrayfunctions.h:211</a></div></div>
<div class="ttc" id="a00155_html_a70b5e28b5bc3d1b63a7435c5fe50b837"><div class="ttname"><a href="a00155.html#a70b5e28b5bc3d1b63a7435c5fe50b837">DomainBoundary::dim</a></div><div class="ttdeci">int dim</div><div class="ttdef"><b>Definition:</b> <a href="a00189_source.html#l00073">boundaryconditions.h:73</a></div></div>
<div class="ttc" id="a00187_html_a0739cb538f4d301fad3b45059ddd0738"><div class="ttname"><a href="a00187.html#a0739cb538f4d301fad3b45059ddd0738">_ArrayIndex1DWO_</a></div><div class="ttdeci">#define _ArrayIndex1DWO_(N, imax, i, offset, ghost, index)</div><div class="ttdef"><b>Definition:</b> <a href="a00187_source.html#l00082">arrayfunctions.h:82</a></div></div>
<div class="ttc" id="a00170_html_a72f9e01745b3a8203067ab84aefc9aea"><div class="ttname"><a href="a00170.html#a72f9e01745b3a8203067ab84aefc9aea">NavierStokes3D::gamma</a></div><div class="ttdeci">double gamma</div><div class="ttdef"><b>Definition:</b> <a href="a00170_source.html#l00485">navierstokes3d.h:485</a></div></div>
<div class="ttc" id="a00158_html_a72f9e01745b3a8203067ab84aefc9aea"><div class="ttname"><a href="a00158.html#a72f9e01745b3a8203067ab84aefc9aea">Euler2D::gamma</a></div><div class="ttdeci">double gamma</div><div class="ttdef"><b>Definition:</b> <a href="a00158_source.html#l00245">euler2d.h:245</a></div></div>
<div class="ttc" id="a00155_html_a481013ba007a99a4237cde5eeb3c9a29"><div class="ttname"><a href="a00155.html#a481013ba007a99a4237cde5eeb3c9a29">DomainBoundary::is</a></div><div class="ttdeci">int * is</div><div class="ttdef"><b>Definition:</b> <a href="a00189_source.html#l00082">boundaryconditions.h:82</a></div></div>
<div class="ttc" id="a00170_html_a47cfbfdecf13cd3336cc049cfe93ed45"><div class="ttname"><a href="a00170.html#a47cfbfdecf13cd3336cc049cfe93ed45">_NavierStokes3DGetFlowVar_</a></div><div class="ttdeci">#define _NavierStokes3DGetFlowVar_(u, rho, vx, vy, vz, e, P, p)</div><div class="ttdef"><b>Definition:</b> <a href="a00170_source.html#l00098">navierstokes3d.h:98</a></div></div>
<div class="ttc" id="a00155_html"><div class="ttname"><a href="a00155.html">DomainBoundary</a></div><div class="ttdoc">Structure containing the variables and function pointers defining a boundary. </div><div class="ttdef"><b>Definition:</b> <a href="a00189_source.html#l00068">boundaryconditions.h:68</a></div></div>
<div class="ttc" id="a00187_html_ab49d0f261ea751a17d6beca0504daf78"><div class="ttname"><a href="a00187.html#ab49d0f261ea751a17d6beca0504daf78">_ArraySubtract1D_</a></div><div class="ttdeci">#define _ArraySubtract1D_(x, a, b, size)</div><div class="ttdef"><b>Definition:</b> <a href="a00187_source.html#l00200">arrayfunctions.h:200</a></div></div>
<div class="ttc" id="a00170_html_a00590"><div class="ttname"><a href="a00170.html#a00590">NavierStokes3D</a></div><div class="ttdoc">Structure containing variables and parameters specific to the 3D Navier Stokes equations. This structure contains the physical parameters, variables, and function pointers specific to the 3D Navier-Stokes equations. </div><div class="ttdef"><b>Definition:</b> <a href="a00170_source.html#l00484">navierstokes3d.h:484</a></div></div>
<div class="ttc" id="a00187_html_afbb862a2fdf5b72b1f9ace42f64b556f"><div class="ttname"><a href="a00187.html#afbb862a2fdf5b72b1f9ace42f64b556f">_ArrayIndex1D_</a></div><div class="ttdeci">#define _ArrayIndex1D_(N, imax, i, ghost, index)</div><div class="ttdef"><b>Definition:</b> <a href="a00187_source.html#l00039">arrayfunctions.h:39</a></div></div>
<div class="ttc" id="a00187_html_ac5ec1371623f11d03b0f42adaa24acbc"><div class="ttname"><a href="a00187.html#ac5ec1371623f11d03b0f42adaa24acbc">_ArrayIncrementIndex_</a></div><div class="ttdeci">#define _ArrayIncrementIndex_(N, imax, i, done)</div><div class="ttdef"><b>Definition:</b> <a href="a00187_source.html#l00125">arrayfunctions.h:125</a></div></div>
<div class="ttc" id="a00155_html_a7602de5ebb1b59ec35217e78a35a531e"><div class="ttname"><a href="a00155.html#a7602de5ebb1b59ec35217e78a35a531e">DomainBoundary::ie</a></div><div class="ttdeci">int * ie</div><div class="ttdef"><b>Definition:</b> <a href="a00189_source.html#l00082">boundaryconditions.h:82</a></div></div>
<div class="ttc" id="a00155_html_a9582c650f117a06449b5ee368b6762ef"><div class="ttname"><a href="a00155.html#a9582c650f117a06449b5ee368b6762ef">DomainBoundary::face</a></div><div class="ttdeci">int face</div><div class="ttdef"><b>Definition:</b> <a href="a00189_source.html#l00075">boundaryconditions.h:75</a></div></div>
<div class="ttc" id="a00155_html_a72f9e01745b3a8203067ab84aefc9aea"><div class="ttname"><a href="a00155.html#a72f9e01745b3a8203067ab84aefc9aea">DomainBoundary::gamma</a></div><div class="ttdeci">double gamma</div><div class="ttdef"><b>Definition:</b> <a href="a00189_source.html#l00096">boundaryconditions.h:96</a></div></div>
<div class="ttc" id="a00187_html_a2b2826031c0cd92495ab351d3e599fc5"><div class="ttname"><a href="a00187.html#a2b2826031c0cd92495ab351d3e599fc5">_ArraySetValue_</a></div><div class="ttdeci">#define _ArraySetValue_(x, size, value)</div><div class="ttdef"><b>Definition:</b> <a href="a00187_source.html#l00168">arrayfunctions.h:168</a></div></div>
<div class="ttc" id="a00155_html_a2eec7e4ee612d5edc985ba81453346e1"><div class="ttname"><a href="a00155.html#a2eec7e4ee612d5edc985ba81453346e1">DomainBoundary::on_this_proc</a></div><div class="ttdeci">int on_this_proc</div><div class="ttdef"><b>Definition:</b> <a href="a00189_source.html#l00081">boundaryconditions.h:81</a></div></div>
<div class="ttc" id="a00158_html_a00576"><div class="ttname"><a href="a00158.html#a00576">Euler2D</a></div><div class="ttdef"><b>Definition:</b> <a href="a00158_source.html#l00244">euler2d.h:244</a></div></div>
<div class="ttc" id="a00155_html_a0d0d92fab642e1d02a9de254e73a3f21"><div class="ttname"><a href="a00155.html#a0d0d92fab642e1d02a9de254e73a3f21">DomainBoundary::FlowVelocity</a></div><div class="ttdeci">double * FlowVelocity</div><div class="ttdef"><b>Definition:</b> <a href="a00189_source.html#l00096">boundaryconditions.h:96</a></div></div>
<div class="ttc" id="a00187_html_a89e8330d9e06dd0666c50833628a125c"><div class="ttname"><a href="a00187.html#a89e8330d9e06dd0666c50833628a125c">_ArrayCopy1D_</a></div><div class="ttdeci">#define _ArrayCopy1D_(x, y, size)</div><div class="ttdef"><b>Definition:</b> <a href="a00187_source.html#l00318">arrayfunctions.h:318</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a59d7e501f46ad50d2649895a715fe370"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int BCSubsonicOutflowU </td>
          <td>(</td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>b</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>m</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>ndims</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>nvars</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>size</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>ghosts</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>phi</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>waqt</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Subsonic outflow boundary conditions for the solution vector U</p>
<p>Applies the subsonic outflow boundary condition: The pressure at the physical boundary ghost points is specified, while the density and velocity are extrapolated from the interior. This boundary condition is specific to two and three dimensional Euler/ Navier-Stokes systems (<a class="el" href="a00158.html#a00576">Euler2D</a>, <a class="el" href="a00169.html#a00589" title="Structure containing variables and parameters specific to the 2D Navier Stokes equations. This structure contains the physical parameters, variables, and function pointers specific to the 2D Navier-Stokes equations. ">NavierStokes2D</a>, <a class="el" href="a00170.html#a00590" title="Structure containing variables and parameters specific to the 3D Navier Stokes equations. This structure contains the physical parameters, variables, and function pointers specific to the 3D Navier-Stokes equations. ">NavierStokes3D</a>). </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">b</td><td>Boundary object of type <a class="el" href="a00155.html" title="Structure containing the variables and function pointers defining a boundary. ">DomainBoundary</a> </td></tr>
    <tr><td class="paramname">m</td><td>MPI object of type <a class="el" href="a00167.html#a00588" title="Structure of MPI-related variables. ">MPIVariables</a> </td></tr>
    <tr><td class="paramname">ndims</td><td>Number of spatial dimensions </td></tr>
    <tr><td class="paramname">nvars</td><td>Number of variables/DoFs per grid point </td></tr>
    <tr><td class="paramname">size</td><td>Integer array with the number of grid points in each spatial dimension </td></tr>
    <tr><td class="paramname">ghosts</td><td>Number of ghost points </td></tr>
    <tr><td class="paramname">phi</td><td>The solution array on which to apply the boundary condition </td></tr>
    <tr><td class="paramname">waqt</td><td>Current solution time </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="a00238_source.html#l00019">19</a> of file <a class="el" href="a00238_source.html">BCSubsonicOutflow.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;{</div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;  <a class="code" href="a00155.html">DomainBoundary</a> *boundary = (<a class="code" href="a00155.html">DomainBoundary</a>*) b;</div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;</div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;  <span class="keywordtype">int</span> dim   = boundary-&gt;<a class="code" href="a00155.html#a70b5e28b5bc3d1b63a7435c5fe50b837">dim</a>;</div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;  <span class="keywordtype">int</span> face  = boundary-&gt;<a class="code" href="a00155.html#a9582c650f117a06449b5ee368b6762ef">face</a>;</div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;</div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;  <span class="keywordflow">if</span> (ndims == 2) {</div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;</div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;    <span class="comment">/* create a fake physics object */</span></div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;    <a class="code" href="a00158.html#a00576">Euler2D</a> physics; </div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;    <span class="keywordtype">double</span> gamma;</div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;    gamma = physics.<a class="code" href="a00158.html#a72f9e01745b3a8203067ab84aefc9aea">gamma</a> = boundary-&gt;<a class="code" href="a00155.html#a72f9e01745b3a8203067ab84aefc9aea">gamma</a>;</div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;    <span class="keywordtype">double</span> inv_gamma_m1 = 1.0/(gamma-1.0);</div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;</div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;    <span class="keywordflow">if</span> (boundary-&gt;<a class="code" href="a00155.html#a2eec7e4ee612d5edc985ba81453346e1">on_this_proc</a>) {</div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;      <span class="keywordtype">int</span> bounds[ndims], indexb[ndims], indexi[ndims];</div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;      <a class="code" href="a00187.html#ab49d0f261ea751a17d6beca0504daf78">_ArraySubtract1D_</a>(bounds,boundary-&gt;<a class="code" href="a00155.html#a7602de5ebb1b59ec35217e78a35a531e">ie</a>,boundary-&gt;<a class="code" href="a00155.html#a481013ba007a99a4237cde5eeb3c9a29">is</a>,ndims);</div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;      <a class="code" href="a00187.html#a2b2826031c0cd92495ab351d3e599fc5">_ArraySetValue_</a>(indexb,ndims,0);</div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;      <span class="keywordtype">int</span> done = 0;</div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;      <span class="keywordflow">while</span> (!done) {</div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;        <span class="keywordtype">int</span> p1, p2;</div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;        <a class="code" href="a00187.html#a89e8330d9e06dd0666c50833628a125c">_ArrayCopy1D_</a>(indexb,indexi,ndims);</div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;        <a class="code" href="a00187.html#a98a3bb5fda2fcafb70a6288d100a0924">_ArrayAdd1D_</a>(indexi,indexi,boundary-&gt;<a class="code" href="a00155.html#a481013ba007a99a4237cde5eeb3c9a29">is</a>,ndims);</div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;        <span class="keywordflow">if</span>      (face ==  1) indexi[dim] = ghosts-1-indexb[dim];</div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (face == -1) indexi[dim] = size[dim]-indexb[dim]-1;</div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">return</span>(1);</div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;        <a class="code" href="a00187.html#a0739cb538f4d301fad3b45059ddd0738">_ArrayIndex1DWO_</a>(ndims,size,indexb,boundary-&gt;<a class="code" href="a00155.html#a481013ba007a99a4237cde5eeb3c9a29">is</a>,ghosts,p1);</div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;        <a class="code" href="a00187.html#afbb862a2fdf5b72b1f9ace42f64b556f">_ArrayIndex1D_</a>(ndims,size,indexi,ghosts,p2);</div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;        </div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;        <span class="comment">/* flow variables in the interior */</span></div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;        <span class="keywordtype">double</span> rho, uvel, vvel, energy, pressure;</div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;        <span class="keywordtype">double</span> rho_gpt, uvel_gpt, vvel_gpt, energy_gpt, pressure_gpt;</div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;        <a class="code" href="a00158.html#afff338b9964cae67fd9b3f4dc224e77b">_Euler2DGetFlowVar_</a>((phi+nvars*p2),rho,uvel,vvel,energy,pressure,(&amp;physics));</div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;        <span class="comment">/* set the ghost point values */</span></div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;        rho_gpt = rho;</div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;        pressure_gpt = pressure; <span class="comment">/* useless statement to avoid compiler warning */</span></div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;        pressure_gpt = boundary-&gt;<a class="code" href="a00155.html#a0a3c5af6bdb8fbdb746fd4edb374bb18">FlowPressure</a>;</div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;        uvel_gpt = uvel;</div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;        vvel_gpt = vvel;</div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;        energy_gpt = inv_gamma_m1*pressure_gpt</div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;                    + 0.5 * rho_gpt * (uvel_gpt*uvel_gpt + vvel_gpt*vvel_gpt);</div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;</div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;        phi[nvars*p1+0] = rho_gpt;</div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;        phi[nvars*p1+1] = rho_gpt * uvel_gpt;</div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;        phi[nvars*p1+2] = rho_gpt * vvel_gpt;</div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;        phi[nvars*p1+3] = energy_gpt;</div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;</div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;        <a class="code" href="a00187.html#ac5ec1371623f11d03b0f42adaa24acbc">_ArrayIncrementIndex_</a>(ndims,bounds,indexb,done);</div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;      }</div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;    }</div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;</div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;  } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (ndims == 3) {</div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;</div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;    <span class="comment">/* create a fake physics object */</span></div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;    <a class="code" href="a00170.html#a00590">NavierStokes3D</a> physics;</div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;    <span class="keywordtype">double</span> gamma;</div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;    gamma = physics.<a class="code" href="a00170.html#a72f9e01745b3a8203067ab84aefc9aea">gamma</a> = boundary-&gt;<a class="code" href="a00155.html#a72f9e01745b3a8203067ab84aefc9aea">gamma</a>;</div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;    <span class="keywordtype">double</span> inv_gamma_m1 = 1.0/(gamma-1.0);</div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;</div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;    <span class="keywordflow">if</span> (boundary-&gt;<a class="code" href="a00155.html#a2eec7e4ee612d5edc985ba81453346e1">on_this_proc</a>) {</div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;      <span class="keywordtype">int</span> bounds[ndims], indexb[ndims], indexi[ndims];</div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;      <a class="code" href="a00187.html#ab49d0f261ea751a17d6beca0504daf78">_ArraySubtract1D_</a>(bounds,boundary-&gt;<a class="code" href="a00155.html#a7602de5ebb1b59ec35217e78a35a531e">ie</a>,boundary-&gt;<a class="code" href="a00155.html#a481013ba007a99a4237cde5eeb3c9a29">is</a>,ndims);</div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;      <a class="code" href="a00187.html#a2b2826031c0cd92495ab351d3e599fc5">_ArraySetValue_</a>(indexb,ndims,0);</div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;      <span class="keywordtype">int</span> done = 0;</div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;      <span class="keywordflow">while</span> (!done) {</div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;        <span class="keywordtype">int</span> p1, p2;</div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;        <a class="code" href="a00187.html#a89e8330d9e06dd0666c50833628a125c">_ArrayCopy1D_</a>(indexb,indexi,ndims);</div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;        <a class="code" href="a00187.html#a98a3bb5fda2fcafb70a6288d100a0924">_ArrayAdd1D_</a>(indexi,indexi,boundary-&gt;<a class="code" href="a00155.html#a481013ba007a99a4237cde5eeb3c9a29">is</a>,ndims);</div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;        <span class="keywordflow">if</span>      (face ==  1) indexi[dim] = ghosts-1-indexb[dim];</div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (face == -1) indexi[dim] = size[dim]-indexb[dim]-1;</div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">return</span>(1);</div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;        <a class="code" href="a00187.html#a0739cb538f4d301fad3b45059ddd0738">_ArrayIndex1DWO_</a>(ndims,size,indexb,boundary-&gt;<a class="code" href="a00155.html#a481013ba007a99a4237cde5eeb3c9a29">is</a>,ghosts,p1);</div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;        <a class="code" href="a00187.html#afbb862a2fdf5b72b1f9ace42f64b556f">_ArrayIndex1D_</a>(ndims,size,indexi,ghosts,p2);</div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;        </div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;        <span class="comment">/* flow variables in the interior */</span></div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;        <span class="keywordtype">double</span> rho, uvel, vvel, wvel, energy, pressure;</div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;        <span class="keywordtype">double</span> rho_gpt, uvel_gpt, vvel_gpt, wvel_gpt, energy_gpt, pressure_gpt;</div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;        <a class="code" href="a00170.html#a47cfbfdecf13cd3336cc049cfe93ed45">_NavierStokes3DGetFlowVar_</a>((phi+nvars*p2),rho,uvel,vvel,wvel,energy,pressure,(&amp;physics));</div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;        <span class="comment">/* set the ghost point values */</span></div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;        rho_gpt = rho;</div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;        pressure_gpt = pressure; <span class="comment">/* useless statement to avoid compiler warning */</span></div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;        pressure_gpt = boundary-&gt;<a class="code" href="a00155.html#a0a3c5af6bdb8fbdb746fd4edb374bb18">FlowPressure</a>;</div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;        uvel_gpt = uvel;</div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;        vvel_gpt = vvel;</div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;        wvel_gpt = wvel;</div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;        energy_gpt = inv_gamma_m1*pressure_gpt</div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;                    + 0.5 * rho_gpt </div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;                    * (uvel_gpt*uvel_gpt + vvel_gpt*vvel_gpt + wvel_gpt*wvel_gpt);</div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;</div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;        phi[nvars*p1+0] = rho_gpt;</div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;        phi[nvars*p1+1] = rho_gpt * uvel_gpt;</div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;        phi[nvars*p1+2] = rho_gpt * vvel_gpt;</div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;        phi[nvars*p1+3] = rho_gpt * wvel_gpt;</div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;        phi[nvars*p1+4] = energy_gpt;</div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;</div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;        <a class="code" href="a00187.html#ac5ec1371623f11d03b0f42adaa24acbc">_ArrayIncrementIndex_</a>(ndims,bounds,indexb,done);</div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;      }</div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;    }</div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;</div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;  }</div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;  <span class="keywordflow">return</span>(0);</div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;}</div>
<div class="ttc" id="a00158_html_afff338b9964cae67fd9b3f4dc224e77b"><div class="ttname"><a href="a00158.html#afff338b9964cae67fd9b3f4dc224e77b">_Euler2DGetFlowVar_</a></div><div class="ttdeci">#define _Euler2DGetFlowVar_(u, rho, vx, vy, e, P, p)</div><div class="ttdef"><b>Definition:</b> <a href="a00158_source.html#l00044">euler2d.h:44</a></div></div>
<div class="ttc" id="a00187_html_a98a3bb5fda2fcafb70a6288d100a0924"><div class="ttname"><a href="a00187.html#a98a3bb5fda2fcafb70a6288d100a0924">_ArrayAdd1D_</a></div><div class="ttdeci">#define _ArrayAdd1D_(x, a, b, size)</div><div class="ttdef"><b>Definition:</b> <a href="a00187_source.html#l00211">arrayfunctions.h:211</a></div></div>
<div class="ttc" id="a00155_html_a70b5e28b5bc3d1b63a7435c5fe50b837"><div class="ttname"><a href="a00155.html#a70b5e28b5bc3d1b63a7435c5fe50b837">DomainBoundary::dim</a></div><div class="ttdeci">int dim</div><div class="ttdef"><b>Definition:</b> <a href="a00189_source.html#l00073">boundaryconditions.h:73</a></div></div>
<div class="ttc" id="a00187_html_a0739cb538f4d301fad3b45059ddd0738"><div class="ttname"><a href="a00187.html#a0739cb538f4d301fad3b45059ddd0738">_ArrayIndex1DWO_</a></div><div class="ttdeci">#define _ArrayIndex1DWO_(N, imax, i, offset, ghost, index)</div><div class="ttdef"><b>Definition:</b> <a href="a00187_source.html#l00082">arrayfunctions.h:82</a></div></div>
<div class="ttc" id="a00170_html_a72f9e01745b3a8203067ab84aefc9aea"><div class="ttname"><a href="a00170.html#a72f9e01745b3a8203067ab84aefc9aea">NavierStokes3D::gamma</a></div><div class="ttdeci">double gamma</div><div class="ttdef"><b>Definition:</b> <a href="a00170_source.html#l00485">navierstokes3d.h:485</a></div></div>
<div class="ttc" id="a00158_html_a72f9e01745b3a8203067ab84aefc9aea"><div class="ttname"><a href="a00158.html#a72f9e01745b3a8203067ab84aefc9aea">Euler2D::gamma</a></div><div class="ttdeci">double gamma</div><div class="ttdef"><b>Definition:</b> <a href="a00158_source.html#l00245">euler2d.h:245</a></div></div>
<div class="ttc" id="a00155_html_a481013ba007a99a4237cde5eeb3c9a29"><div class="ttname"><a href="a00155.html#a481013ba007a99a4237cde5eeb3c9a29">DomainBoundary::is</a></div><div class="ttdeci">int * is</div><div class="ttdef"><b>Definition:</b> <a href="a00189_source.html#l00082">boundaryconditions.h:82</a></div></div>
<div class="ttc" id="a00170_html_a47cfbfdecf13cd3336cc049cfe93ed45"><div class="ttname"><a href="a00170.html#a47cfbfdecf13cd3336cc049cfe93ed45">_NavierStokes3DGetFlowVar_</a></div><div class="ttdeci">#define _NavierStokes3DGetFlowVar_(u, rho, vx, vy, vz, e, P, p)</div><div class="ttdef"><b>Definition:</b> <a href="a00170_source.html#l00098">navierstokes3d.h:98</a></div></div>
<div class="ttc" id="a00155_html"><div class="ttname"><a href="a00155.html">DomainBoundary</a></div><div class="ttdoc">Structure containing the variables and function pointers defining a boundary. </div><div class="ttdef"><b>Definition:</b> <a href="a00189_source.html#l00068">boundaryconditions.h:68</a></div></div>
<div class="ttc" id="a00187_html_ab49d0f261ea751a17d6beca0504daf78"><div class="ttname"><a href="a00187.html#ab49d0f261ea751a17d6beca0504daf78">_ArraySubtract1D_</a></div><div class="ttdeci">#define _ArraySubtract1D_(x, a, b, size)</div><div class="ttdef"><b>Definition:</b> <a href="a00187_source.html#l00200">arrayfunctions.h:200</a></div></div>
<div class="ttc" id="a00170_html_a00590"><div class="ttname"><a href="a00170.html#a00590">NavierStokes3D</a></div><div class="ttdoc">Structure containing variables and parameters specific to the 3D Navier Stokes equations. This structure contains the physical parameters, variables, and function pointers specific to the 3D Navier-Stokes equations. </div><div class="ttdef"><b>Definition:</b> <a href="a00170_source.html#l00484">navierstokes3d.h:484</a></div></div>
<div class="ttc" id="a00187_html_afbb862a2fdf5b72b1f9ace42f64b556f"><div class="ttname"><a href="a00187.html#afbb862a2fdf5b72b1f9ace42f64b556f">_ArrayIndex1D_</a></div><div class="ttdeci">#define _ArrayIndex1D_(N, imax, i, ghost, index)</div><div class="ttdef"><b>Definition:</b> <a href="a00187_source.html#l00039">arrayfunctions.h:39</a></div></div>
<div class="ttc" id="a00187_html_ac5ec1371623f11d03b0f42adaa24acbc"><div class="ttname"><a href="a00187.html#ac5ec1371623f11d03b0f42adaa24acbc">_ArrayIncrementIndex_</a></div><div class="ttdeci">#define _ArrayIncrementIndex_(N, imax, i, done)</div><div class="ttdef"><b>Definition:</b> <a href="a00187_source.html#l00125">arrayfunctions.h:125</a></div></div>
<div class="ttc" id="a00155_html_a7602de5ebb1b59ec35217e78a35a531e"><div class="ttname"><a href="a00155.html#a7602de5ebb1b59ec35217e78a35a531e">DomainBoundary::ie</a></div><div class="ttdeci">int * ie</div><div class="ttdef"><b>Definition:</b> <a href="a00189_source.html#l00082">boundaryconditions.h:82</a></div></div>
<div class="ttc" id="a00155_html_a9582c650f117a06449b5ee368b6762ef"><div class="ttname"><a href="a00155.html#a9582c650f117a06449b5ee368b6762ef">DomainBoundary::face</a></div><div class="ttdeci">int face</div><div class="ttdef"><b>Definition:</b> <a href="a00189_source.html#l00075">boundaryconditions.h:75</a></div></div>
<div class="ttc" id="a00155_html_a72f9e01745b3a8203067ab84aefc9aea"><div class="ttname"><a href="a00155.html#a72f9e01745b3a8203067ab84aefc9aea">DomainBoundary::gamma</a></div><div class="ttdeci">double gamma</div><div class="ttdef"><b>Definition:</b> <a href="a00189_source.html#l00096">boundaryconditions.h:96</a></div></div>
<div class="ttc" id="a00187_html_a2b2826031c0cd92495ab351d3e599fc5"><div class="ttname"><a href="a00187.html#a2b2826031c0cd92495ab351d3e599fc5">_ArraySetValue_</a></div><div class="ttdeci">#define _ArraySetValue_(x, size, value)</div><div class="ttdef"><b>Definition:</b> <a href="a00187_source.html#l00168">arrayfunctions.h:168</a></div></div>
<div class="ttc" id="a00155_html_a2eec7e4ee612d5edc985ba81453346e1"><div class="ttname"><a href="a00155.html#a2eec7e4ee612d5edc985ba81453346e1">DomainBoundary::on_this_proc</a></div><div class="ttdeci">int on_this_proc</div><div class="ttdef"><b>Definition:</b> <a href="a00189_source.html#l00081">boundaryconditions.h:81</a></div></div>
<div class="ttc" id="a00158_html_a00576"><div class="ttname"><a href="a00158.html#a00576">Euler2D</a></div><div class="ttdef"><b>Definition:</b> <a href="a00158_source.html#l00244">euler2d.h:244</a></div></div>
<div class="ttc" id="a00155_html_a0a3c5af6bdb8fbdb746fd4edb374bb18"><div class="ttname"><a href="a00155.html#a0a3c5af6bdb8fbdb746fd4edb374bb18">DomainBoundary::FlowPressure</a></div><div class="ttdeci">double FlowPressure</div><div class="ttdef"><b>Definition:</b> <a href="a00189_source.html#l00096">boundaryconditions.h:96</a></div></div>
<div class="ttc" id="a00187_html_a89e8330d9e06dd0666c50833628a125c"><div class="ttname"><a href="a00187.html#a89e8330d9e06dd0666c50833628a125c">_ArrayCopy1D_</a></div><div class="ttdeci">#define _ArrayCopy1D_(x, y, size)</div><div class="ttdef"><b>Definition:</b> <a href="a00187_source.html#l00318">arrayfunctions.h:318</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a83bc6c5b45955f8ebe750503f5987a29"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int BCSubsonicAmbivalentU </td>
          <td>(</td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>b</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>m</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>ndims</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>nvars</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>size</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>ghosts</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>phi</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>waqt</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Subsonic "ambivalent" boundary conditions for the solution vector U</p>
<p>Applies the subsonic "ambivalent" boundary condition: The velocity at the boundary face is extrapolated from the interior and its dot product with the boundary normal (pointing into the domain) is computed.</p>
<ul>
<li>If it is positive, subsonic inflow boundary conditions are applied: the density and velocity at the physical boundary ghost points are specified, while the pressure is extrapolated from the interior of the domain.</li>
<li>If it is negative, subsonic outflow boundary conditions are applied: the pressure at the physical boundary ghost points is specified, while the density and velocity are extrapolated from the interior.</li>
</ul>
<p>This boundary condition is specific to two and three dimension Euler and Navier-Stokes systems (<a class="el" href="a00158.html#a00576">Euler2D</a>, <a class="el" href="a00169.html#a00589" title="Structure containing variables and parameters specific to the 2D Navier Stokes equations. This structure contains the physical parameters, variables, and function pointers specific to the 2D Navier-Stokes equations. ">NavierStokes2D</a>, <a class="el" href="a00170.html#a00590" title="Structure containing variables and parameters specific to the 3D Navier Stokes equations. This structure contains the physical parameters, variables, and function pointers specific to the 3D Navier-Stokes equations. ">NavierStokes3D</a>). </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">b</td><td>Boundary object of type <a class="el" href="a00155.html" title="Structure containing the variables and function pointers defining a boundary. ">DomainBoundary</a> </td></tr>
    <tr><td class="paramname">m</td><td>MPI object of type <a class="el" href="a00167.html#a00588" title="Structure of MPI-related variables. ">MPIVariables</a> </td></tr>
    <tr><td class="paramname">ndims</td><td>Number of spatial dimensions </td></tr>
    <tr><td class="paramname">nvars</td><td>Number of variables/DoFs per grid point </td></tr>
    <tr><td class="paramname">size</td><td>Integer array with the number of grid points in each spatial dimension </td></tr>
    <tr><td class="paramname">ghosts</td><td>Number of ghost points </td></tr>
    <tr><td class="paramname">phi</td><td>The solution array on which to apply the boundary condition </td></tr>
    <tr><td class="paramname">waqt</td><td>Current solution time </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="a00236_source.html#l00028">28</a> of file <a class="el" href="a00236_source.html">BCSubsonicAmbivalent.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;{</div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;  <a class="code" href="a00155.html">DomainBoundary</a> *boundary = (<a class="code" href="a00155.html">DomainBoundary</a>*) b;</div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;</div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;  <span class="keywordtype">int</span> dim   = boundary-&gt;<a class="code" href="a00155.html#a70b5e28b5bc3d1b63a7435c5fe50b837">dim</a>;</div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;  <span class="keywordtype">int</span> face  = boundary-&gt;<a class="code" href="a00155.html#a9582c650f117a06449b5ee368b6762ef">face</a>;</div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;</div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;  <span class="keywordflow">if</span> (ndims == 2) {</div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;</div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;    <span class="comment">/* create a fake physics object */</span></div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;    <a class="code" href="a00158.html#a00576">Euler2D</a> physics; </div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;    <span class="keywordtype">double</span> gamma;</div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;    gamma = physics.<a class="code" href="a00158.html#a72f9e01745b3a8203067ab84aefc9aea">gamma</a> = boundary-&gt;<a class="code" href="a00155.html#a72f9e01745b3a8203067ab84aefc9aea">gamma</a>;</div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;    <span class="keywordtype">double</span> inv_gamma_m1 = 1.0/(gamma-1.0);</div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;</div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;    <span class="comment">/* boundary normal (pointing into the domain) */</span></div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;    <span class="keywordtype">double</span> nx, ny;</div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;    <span class="keywordflow">if</span> (dim == 0) {</div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;      nx = 1.0;</div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;      ny = 0.0;</div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (dim == 1) {</div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;      nx = 0.0;</div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;      ny = 1.0;</div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;    }</div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;    nx *= (double) face;</div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;    ny *= (double) face;</div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;</div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;    <span class="keywordflow">if</span> (boundary-&gt;<a class="code" href="a00155.html#a2eec7e4ee612d5edc985ba81453346e1">on_this_proc</a>) {</div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;      <span class="keywordtype">int</span> bounds[ndims], indexb[ndims], indexi[ndims], indexj[ndims];</div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;      <a class="code" href="a00187.html#ab49d0f261ea751a17d6beca0504daf78">_ArraySubtract1D_</a>(bounds,boundary-&gt;<a class="code" href="a00155.html#a7602de5ebb1b59ec35217e78a35a531e">ie</a>,boundary-&gt;<a class="code" href="a00155.html#a481013ba007a99a4237cde5eeb3c9a29">is</a>,ndims);</div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;      <a class="code" href="a00187.html#a2b2826031c0cd92495ab351d3e599fc5">_ArraySetValue_</a>(indexb,ndims,0);</div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;      <span class="keywordtype">int</span> done = 0;</div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;      <span class="keywordflow">while</span> (!done) {</div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;        <span class="keywordtype">int</span> p1, p2;</div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;        <span class="keywordtype">double</span> rho, uvel, vvel, energy, pressure;</div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;</div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;        <span class="comment">/* compute boundary face velocity  - 2nd order */</span></div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;        <a class="code" href="a00187.html#a89e8330d9e06dd0666c50833628a125c">_ArrayCopy1D_</a>(indexb,indexi,ndims);</div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;        <a class="code" href="a00187.html#a98a3bb5fda2fcafb70a6288d100a0924">_ArrayAdd1D_</a>(indexi,indexi,boundary-&gt;<a class="code" href="a00155.html#a481013ba007a99a4237cde5eeb3c9a29">is</a>,ndims);</div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;        <a class="code" href="a00187.html#a89e8330d9e06dd0666c50833628a125c">_ArrayCopy1D_</a>(indexi,indexj,ndims);</div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;        <span class="keywordflow">if</span> (face ==  1) {</div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;          indexi[dim] = 0;</div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;          indexj[dim] = indexi[dim] + 1;</div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;        } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (face == -1) {</div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;          indexi[dim] = size[dim]-1;</div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;          indexj[dim] = indexi[dim] - 1;</div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;        }</div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;        <a class="code" href="a00187.html#afbb862a2fdf5b72b1f9ace42f64b556f">_ArrayIndex1D_</a>(ndims,size,indexi,ghosts,p1);</div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;        <a class="code" href="a00187.html#afbb862a2fdf5b72b1f9ace42f64b556f">_ArrayIndex1D_</a>(ndims,size,indexj,ghosts,p2);</div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;        <span class="keywordtype">double</span> uvel1, uvel2, uvelb,</div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;               vvel1, vvel2, vvelb;</div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;        <a class="code" href="a00158.html#afff338b9964cae67fd9b3f4dc224e77b">_Euler2DGetFlowVar_</a>((phi+nvars*p1),rho,uvel1,vvel1,energy,pressure,(&amp;physics));</div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;        <a class="code" href="a00158.html#afff338b9964cae67fd9b3f4dc224e77b">_Euler2DGetFlowVar_</a>((phi+nvars*p2),rho,uvel2,vvel2,energy,pressure,(&amp;physics));</div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;        uvelb = 1.5*uvel1 - 0.5*uvel2;</div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;        vvelb = 1.5*vvel1 - 0.5*vvel2;</div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;        <span class="keywordtype">double</span> vel_normal = uvelb*nx + vvelb*ny;</div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;</div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;        <a class="code" href="a00187.html#a89e8330d9e06dd0666c50833628a125c">_ArrayCopy1D_</a>(indexb,indexi,ndims);</div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;        <a class="code" href="a00187.html#a98a3bb5fda2fcafb70a6288d100a0924">_ArrayAdd1D_</a>(indexi,indexi,boundary-&gt;<a class="code" href="a00155.html#a481013ba007a99a4237cde5eeb3c9a29">is</a>,ndims);</div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;        <span class="keywordflow">if</span>      (face ==  1) indexi[dim] = ghosts-1-indexb[dim];</div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (face == -1) indexi[dim] = size[dim]-indexb[dim]-1;</div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">return</span>(1);</div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;        <a class="code" href="a00187.html#a0739cb538f4d301fad3b45059ddd0738">_ArrayIndex1DWO_</a>(ndims,size,indexb,boundary-&gt;<a class="code" href="a00155.html#a481013ba007a99a4237cde5eeb3c9a29">is</a>,ghosts,p1);</div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;        <a class="code" href="a00187.html#afbb862a2fdf5b72b1f9ace42f64b556f">_ArrayIndex1D_</a>(ndims,size,indexi,ghosts,p2);</div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;        </div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;        <span class="comment">/* flow variables in the interior */</span></div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;        <a class="code" href="a00158.html#afff338b9964cae67fd9b3f4dc224e77b">_Euler2DGetFlowVar_</a>((phi+nvars*p2),rho,uvel,vvel,energy,pressure,(&amp;physics));</div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;</div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;        <span class="comment">/* set the ghost point values */</span></div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;        <span class="keywordtype">double</span> rho_gpt, uvel_gpt, vvel_gpt, energy_gpt, pressure_gpt;</div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;        <span class="keywordflow">if</span> (vel_normal &gt; 0) {</div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;          <span class="comment">/* inflow */</span></div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;          rho_gpt = boundary-&gt;<a class="code" href="a00155.html#aa92ee9d8efc5ca49f4a83d8dabf0b15d">FlowDensity</a>;</div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;          pressure_gpt = pressure;</div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;          uvel_gpt = boundary-&gt;<a class="code" href="a00155.html#a0d0d92fab642e1d02a9de254e73a3f21">FlowVelocity</a>[0];</div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;          vvel_gpt = boundary-&gt;<a class="code" href="a00155.html#a0d0d92fab642e1d02a9de254e73a3f21">FlowVelocity</a>[1];</div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;          <span class="comment">/* outflow */</span></div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;          rho_gpt = rho;</div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;          pressure_gpt = boundary-&gt;<a class="code" href="a00155.html#a0a3c5af6bdb8fbdb746fd4edb374bb18">FlowPressure</a>;</div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;          uvel_gpt = uvel;</div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;          vvel_gpt = vvel;</div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;        }</div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;        energy_gpt = inv_gamma_m1*pressure_gpt</div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;                    + 0.5 * rho_gpt * (uvel_gpt*uvel_gpt + vvel_gpt*vvel_gpt);</div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;</div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;        phi[nvars*p1+0] = rho_gpt;</div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;        phi[nvars*p1+1] = rho_gpt * uvel_gpt;</div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;        phi[nvars*p1+2] = rho_gpt * vvel_gpt;</div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;        phi[nvars*p1+3] = energy_gpt;</div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;</div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;        <a class="code" href="a00187.html#ac5ec1371623f11d03b0f42adaa24acbc">_ArrayIncrementIndex_</a>(ndims,bounds,indexb,done);</div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;      }</div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;    }</div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;</div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;  } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (ndims == 3) {</div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;</div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;    <span class="comment">/* create a fake physics object */</span></div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;    <a class="code" href="a00170.html#a00590">NavierStokes3D</a> physics;</div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;    <span class="keywordtype">double</span> gamma;</div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;    gamma = physics.<a class="code" href="a00170.html#a72f9e01745b3a8203067ab84aefc9aea">gamma</a> = boundary-&gt;<a class="code" href="a00155.html#a72f9e01745b3a8203067ab84aefc9aea">gamma</a>;</div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;    <span class="keywordtype">double</span> inv_gamma_m1 = 1.0/(gamma-1.0);</div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;</div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;    <span class="comment">/* boundary normal (pointing into the domain) */</span></div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;    <span class="keywordtype">double</span> nx, ny, nz;</div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;    <span class="keywordflow">if</span> (dim == 0) {</div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;      nx = 1.0;</div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;      ny = 0.0;</div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;      nz = 0.0;</div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (dim == 1) {</div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;      nx = 0.0;</div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;      ny = 1.0;</div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;      nz = 0.0;</div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (dim == 2) {</div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;      nx = 0.0;</div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;      ny = 0.0;</div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;      nz = 1.0;</div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;    }</div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;    nx *= (double) face;</div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;    ny *= (double) face;</div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;    nz *= (double) face;</div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;</div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;    <span class="keywordflow">if</span> (boundary-&gt;<a class="code" href="a00155.html#a2eec7e4ee612d5edc985ba81453346e1">on_this_proc</a>) {</div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;      <span class="keywordtype">int</span> bounds[ndims], indexb[ndims], indexi[ndims], indexj[ndims];</div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;      <a class="code" href="a00187.html#ab49d0f261ea751a17d6beca0504daf78">_ArraySubtract1D_</a>(bounds,boundary-&gt;<a class="code" href="a00155.html#a7602de5ebb1b59ec35217e78a35a531e">ie</a>,boundary-&gt;<a class="code" href="a00155.html#a481013ba007a99a4237cde5eeb3c9a29">is</a>,ndims);</div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;      <a class="code" href="a00187.html#a2b2826031c0cd92495ab351d3e599fc5">_ArraySetValue_</a>(indexb,ndims,0);</div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;      <span class="keywordtype">int</span> done = 0;</div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;      <span class="keywordflow">while</span> (!done) {</div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;        <span class="keywordtype">int</span> p1, p2;</div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;        <span class="keywordtype">double</span> rho, uvel, vvel, wvel, energy, pressure;</div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;</div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;        <span class="comment">/* compute boundary face velocity  - 2nd order */</span></div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;        <a class="code" href="a00187.html#a89e8330d9e06dd0666c50833628a125c">_ArrayCopy1D_</a>(indexb,indexi,ndims);</div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;        <a class="code" href="a00187.html#a98a3bb5fda2fcafb70a6288d100a0924">_ArrayAdd1D_</a>(indexi,indexi,boundary-&gt;<a class="code" href="a00155.html#a481013ba007a99a4237cde5eeb3c9a29">is</a>,ndims);</div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;        <a class="code" href="a00187.html#a89e8330d9e06dd0666c50833628a125c">_ArrayCopy1D_</a>(indexi,indexj,ndims);</div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;        <span class="keywordflow">if</span> (face ==  1) {</div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;          indexi[dim] = 0;</div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;          indexj[dim] = indexi[dim] + 1;</div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;        } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (face == -1) {</div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;          indexi[dim] = size[dim]-1;</div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;          indexj[dim] = indexi[dim] - 1;</div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;        }</div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;        <a class="code" href="a00187.html#afbb862a2fdf5b72b1f9ace42f64b556f">_ArrayIndex1D_</a>(ndims,size,indexi,ghosts,p1);</div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;        <a class="code" href="a00187.html#afbb862a2fdf5b72b1f9ace42f64b556f">_ArrayIndex1D_</a>(ndims,size,indexj,ghosts,p2);</div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;        <span class="keywordtype">double</span> uvel1, uvel2, uvelb,</div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;               vvel1, vvel2, vvelb,</div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;               wvel1, wvel2, wvelb;</div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;        <a class="code" href="a00170.html#a47cfbfdecf13cd3336cc049cfe93ed45">_NavierStokes3DGetFlowVar_</a>((phi+nvars*p1),rho,uvel1,vvel1,wvel1,energy,pressure,(&amp;physics));</div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;        <a class="code" href="a00170.html#a47cfbfdecf13cd3336cc049cfe93ed45">_NavierStokes3DGetFlowVar_</a>((phi+nvars*p2),rho,uvel2,vvel2,wvel2,energy,pressure,(&amp;physics));</div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;        uvelb = 1.5*uvel1 - 0.5*uvel2;</div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;        vvelb = 1.5*vvel1 - 0.5*vvel2;</div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;        wvelb = 1.5*wvel1 - 0.5*wvel2;</div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;        <span class="keywordtype">double</span> vel_normal = uvelb*nx + vvelb*ny + wvelb*nz;</div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;</div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;        <a class="code" href="a00187.html#a89e8330d9e06dd0666c50833628a125c">_ArrayCopy1D_</a>(indexb,indexi,ndims);</div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;        <a class="code" href="a00187.html#a98a3bb5fda2fcafb70a6288d100a0924">_ArrayAdd1D_</a>(indexi,indexi,boundary-&gt;<a class="code" href="a00155.html#a481013ba007a99a4237cde5eeb3c9a29">is</a>,ndims);</div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;        <span class="keywordflow">if</span>      (face ==  1) indexi[dim] = ghosts-1-indexb[dim];</div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (face == -1) indexi[dim] = size[dim]-indexb[dim]-1;</div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">return</span>(1);</div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;        <a class="code" href="a00187.html#a0739cb538f4d301fad3b45059ddd0738">_ArrayIndex1DWO_</a>(ndims,size,indexb,boundary-&gt;<a class="code" href="a00155.html#a481013ba007a99a4237cde5eeb3c9a29">is</a>,ghosts,p1);</div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;        <a class="code" href="a00187.html#afbb862a2fdf5b72b1f9ace42f64b556f">_ArrayIndex1D_</a>(ndims,size,indexi,ghosts,p2);</div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;        </div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;        <span class="comment">/* flow variables in the interior */</span></div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;        <a class="code" href="a00170.html#a47cfbfdecf13cd3336cc049cfe93ed45">_NavierStokes3DGetFlowVar_</a>((phi+nvars*p2),rho,uvel,vvel,wvel,energy,pressure,(&amp;physics));</div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;</div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;        <span class="comment">/* set the ghost point values */</span></div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;        <span class="keywordtype">double</span> rho_gpt, uvel_gpt, vvel_gpt, wvel_gpt, energy_gpt, pressure_gpt;</div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;        <span class="keywordflow">if</span> (vel_normal &gt; 0) {</div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;          <span class="comment">/* inflow */</span></div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;          rho_gpt = boundary-&gt;<a class="code" href="a00155.html#aa92ee9d8efc5ca49f4a83d8dabf0b15d">FlowDensity</a>;</div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;          pressure_gpt = pressure;</div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;          uvel_gpt = boundary-&gt;<a class="code" href="a00155.html#a0d0d92fab642e1d02a9de254e73a3f21">FlowVelocity</a>[0];</div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;          vvel_gpt = boundary-&gt;<a class="code" href="a00155.html#a0d0d92fab642e1d02a9de254e73a3f21">FlowVelocity</a>[1];</div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;          wvel_gpt = boundary-&gt;<a class="code" href="a00155.html#a0d0d92fab642e1d02a9de254e73a3f21">FlowVelocity</a>[2];</div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;          <span class="comment">/* outflow */</span></div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;          rho_gpt = rho;</div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;          pressure_gpt = boundary-&gt;<a class="code" href="a00155.html#a0a3c5af6bdb8fbdb746fd4edb374bb18">FlowPressure</a>;</div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;          uvel_gpt = uvel;</div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;          vvel_gpt = vvel;</div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;          wvel_gpt = wvel;</div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;        }</div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;        energy_gpt = inv_gamma_m1*pressure_gpt</div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;                    + 0.5 * rho_gpt </div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;                    * (uvel_gpt*uvel_gpt + vvel_gpt*vvel_gpt + wvel_gpt*wvel_gpt);</div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;</div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;        phi[nvars*p1+0] = rho_gpt;</div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;        phi[nvars*p1+1] = rho_gpt * uvel_gpt;</div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;        phi[nvars*p1+2] = rho_gpt * vvel_gpt;</div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;        phi[nvars*p1+3] = rho_gpt * wvel_gpt;</div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;        phi[nvars*p1+4] = energy_gpt;</div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;</div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;        <a class="code" href="a00187.html#ac5ec1371623f11d03b0f42adaa24acbc">_ArrayIncrementIndex_</a>(ndims,bounds,indexb,done);</div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;      }</div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;    }</div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;</div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;  }</div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;  <span class="keywordflow">return</span>(0);</div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;}</div>
<div class="ttc" id="a00158_html_afff338b9964cae67fd9b3f4dc224e77b"><div class="ttname"><a href="a00158.html#afff338b9964cae67fd9b3f4dc224e77b">_Euler2DGetFlowVar_</a></div><div class="ttdeci">#define _Euler2DGetFlowVar_(u, rho, vx, vy, e, P, p)</div><div class="ttdef"><b>Definition:</b> <a href="a00158_source.html#l00044">euler2d.h:44</a></div></div>
<div class="ttc" id="a00155_html_aa92ee9d8efc5ca49f4a83d8dabf0b15d"><div class="ttname"><a href="a00155.html#aa92ee9d8efc5ca49f4a83d8dabf0b15d">DomainBoundary::FlowDensity</a></div><div class="ttdeci">double FlowDensity</div><div class="ttdef"><b>Definition:</b> <a href="a00189_source.html#l00096">boundaryconditions.h:96</a></div></div>
<div class="ttc" id="a00187_html_a98a3bb5fda2fcafb70a6288d100a0924"><div class="ttname"><a href="a00187.html#a98a3bb5fda2fcafb70a6288d100a0924">_ArrayAdd1D_</a></div><div class="ttdeci">#define _ArrayAdd1D_(x, a, b, size)</div><div class="ttdef"><b>Definition:</b> <a href="a00187_source.html#l00211">arrayfunctions.h:211</a></div></div>
<div class="ttc" id="a00155_html_a70b5e28b5bc3d1b63a7435c5fe50b837"><div class="ttname"><a href="a00155.html#a70b5e28b5bc3d1b63a7435c5fe50b837">DomainBoundary::dim</a></div><div class="ttdeci">int dim</div><div class="ttdef"><b>Definition:</b> <a href="a00189_source.html#l00073">boundaryconditions.h:73</a></div></div>
<div class="ttc" id="a00187_html_a0739cb538f4d301fad3b45059ddd0738"><div class="ttname"><a href="a00187.html#a0739cb538f4d301fad3b45059ddd0738">_ArrayIndex1DWO_</a></div><div class="ttdeci">#define _ArrayIndex1DWO_(N, imax, i, offset, ghost, index)</div><div class="ttdef"><b>Definition:</b> <a href="a00187_source.html#l00082">arrayfunctions.h:82</a></div></div>
<div class="ttc" id="a00170_html_a72f9e01745b3a8203067ab84aefc9aea"><div class="ttname"><a href="a00170.html#a72f9e01745b3a8203067ab84aefc9aea">NavierStokes3D::gamma</a></div><div class="ttdeci">double gamma</div><div class="ttdef"><b>Definition:</b> <a href="a00170_source.html#l00485">navierstokes3d.h:485</a></div></div>
<div class="ttc" id="a00158_html_a72f9e01745b3a8203067ab84aefc9aea"><div class="ttname"><a href="a00158.html#a72f9e01745b3a8203067ab84aefc9aea">Euler2D::gamma</a></div><div class="ttdeci">double gamma</div><div class="ttdef"><b>Definition:</b> <a href="a00158_source.html#l00245">euler2d.h:245</a></div></div>
<div class="ttc" id="a00155_html_a481013ba007a99a4237cde5eeb3c9a29"><div class="ttname"><a href="a00155.html#a481013ba007a99a4237cde5eeb3c9a29">DomainBoundary::is</a></div><div class="ttdeci">int * is</div><div class="ttdef"><b>Definition:</b> <a href="a00189_source.html#l00082">boundaryconditions.h:82</a></div></div>
<div class="ttc" id="a00170_html_a47cfbfdecf13cd3336cc049cfe93ed45"><div class="ttname"><a href="a00170.html#a47cfbfdecf13cd3336cc049cfe93ed45">_NavierStokes3DGetFlowVar_</a></div><div class="ttdeci">#define _NavierStokes3DGetFlowVar_(u, rho, vx, vy, vz, e, P, p)</div><div class="ttdef"><b>Definition:</b> <a href="a00170_source.html#l00098">navierstokes3d.h:98</a></div></div>
<div class="ttc" id="a00155_html"><div class="ttname"><a href="a00155.html">DomainBoundary</a></div><div class="ttdoc">Structure containing the variables and function pointers defining a boundary. </div><div class="ttdef"><b>Definition:</b> <a href="a00189_source.html#l00068">boundaryconditions.h:68</a></div></div>
<div class="ttc" id="a00187_html_ab49d0f261ea751a17d6beca0504daf78"><div class="ttname"><a href="a00187.html#ab49d0f261ea751a17d6beca0504daf78">_ArraySubtract1D_</a></div><div class="ttdeci">#define _ArraySubtract1D_(x, a, b, size)</div><div class="ttdef"><b>Definition:</b> <a href="a00187_source.html#l00200">arrayfunctions.h:200</a></div></div>
<div class="ttc" id="a00170_html_a00590"><div class="ttname"><a href="a00170.html#a00590">NavierStokes3D</a></div><div class="ttdoc">Structure containing variables and parameters specific to the 3D Navier Stokes equations. This structure contains the physical parameters, variables, and function pointers specific to the 3D Navier-Stokes equations. </div><div class="ttdef"><b>Definition:</b> <a href="a00170_source.html#l00484">navierstokes3d.h:484</a></div></div>
<div class="ttc" id="a00187_html_afbb862a2fdf5b72b1f9ace42f64b556f"><div class="ttname"><a href="a00187.html#afbb862a2fdf5b72b1f9ace42f64b556f">_ArrayIndex1D_</a></div><div class="ttdeci">#define _ArrayIndex1D_(N, imax, i, ghost, index)</div><div class="ttdef"><b>Definition:</b> <a href="a00187_source.html#l00039">arrayfunctions.h:39</a></div></div>
<div class="ttc" id="a00187_html_ac5ec1371623f11d03b0f42adaa24acbc"><div class="ttname"><a href="a00187.html#ac5ec1371623f11d03b0f42adaa24acbc">_ArrayIncrementIndex_</a></div><div class="ttdeci">#define _ArrayIncrementIndex_(N, imax, i, done)</div><div class="ttdef"><b>Definition:</b> <a href="a00187_source.html#l00125">arrayfunctions.h:125</a></div></div>
<div class="ttc" id="a00155_html_a7602de5ebb1b59ec35217e78a35a531e"><div class="ttname"><a href="a00155.html#a7602de5ebb1b59ec35217e78a35a531e">DomainBoundary::ie</a></div><div class="ttdeci">int * ie</div><div class="ttdef"><b>Definition:</b> <a href="a00189_source.html#l00082">boundaryconditions.h:82</a></div></div>
<div class="ttc" id="a00155_html_a9582c650f117a06449b5ee368b6762ef"><div class="ttname"><a href="a00155.html#a9582c650f117a06449b5ee368b6762ef">DomainBoundary::face</a></div><div class="ttdeci">int face</div><div class="ttdef"><b>Definition:</b> <a href="a00189_source.html#l00075">boundaryconditions.h:75</a></div></div>
<div class="ttc" id="a00155_html_a72f9e01745b3a8203067ab84aefc9aea"><div class="ttname"><a href="a00155.html#a72f9e01745b3a8203067ab84aefc9aea">DomainBoundary::gamma</a></div><div class="ttdeci">double gamma</div><div class="ttdef"><b>Definition:</b> <a href="a00189_source.html#l00096">boundaryconditions.h:96</a></div></div>
<div class="ttc" id="a00187_html_a2b2826031c0cd92495ab351d3e599fc5"><div class="ttname"><a href="a00187.html#a2b2826031c0cd92495ab351d3e599fc5">_ArraySetValue_</a></div><div class="ttdeci">#define _ArraySetValue_(x, size, value)</div><div class="ttdef"><b>Definition:</b> <a href="a00187_source.html#l00168">arrayfunctions.h:168</a></div></div>
<div class="ttc" id="a00155_html_a2eec7e4ee612d5edc985ba81453346e1"><div class="ttname"><a href="a00155.html#a2eec7e4ee612d5edc985ba81453346e1">DomainBoundary::on_this_proc</a></div><div class="ttdeci">int on_this_proc</div><div class="ttdef"><b>Definition:</b> <a href="a00189_source.html#l00081">boundaryconditions.h:81</a></div></div>
<div class="ttc" id="a00158_html_a00576"><div class="ttname"><a href="a00158.html#a00576">Euler2D</a></div><div class="ttdef"><b>Definition:</b> <a href="a00158_source.html#l00244">euler2d.h:244</a></div></div>
<div class="ttc" id="a00155_html_a0d0d92fab642e1d02a9de254e73a3f21"><div class="ttname"><a href="a00155.html#a0d0d92fab642e1d02a9de254e73a3f21">DomainBoundary::FlowVelocity</a></div><div class="ttdeci">double * FlowVelocity</div><div class="ttdef"><b>Definition:</b> <a href="a00189_source.html#l00096">boundaryconditions.h:96</a></div></div>
<div class="ttc" id="a00155_html_a0a3c5af6bdb8fbdb746fd4edb374bb18"><div class="ttname"><a href="a00155.html#a0a3c5af6bdb8fbdb746fd4edb374bb18">DomainBoundary::FlowPressure</a></div><div class="ttdeci">double FlowPressure</div><div class="ttdef"><b>Definition:</b> <a href="a00189_source.html#l00096">boundaryconditions.h:96</a></div></div>
<div class="ttc" id="a00187_html_a89e8330d9e06dd0666c50833628a125c"><div class="ttname"><a href="a00187.html#a89e8330d9e06dd0666c50833628a125c">_ArrayCopy1D_</a></div><div class="ttdeci">#define _ArrayCopy1D_(x, y, size)</div><div class="ttdef"><b>Definition:</b> <a href="a00187_source.html#l00318">arrayfunctions.h:318</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a51cb1555c54105533ae5668cf5ea8a68"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int BCSupersonicInflowU </td>
          <td>(</td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>b</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>m</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>ndims</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>nvars</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>size</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>ghosts</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>phi</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>waqt</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Supersonic inflow boundary conditions for the solution vector U</p>
<p>Applies the supersonic (steady) inflow boundary condition: All the flow variables (density, pressure, velocity) are specified at the physical boundary ghost points, since it is supersonic inflow. This boundary condition is specific to two and three dimensional Euler/Navier-Stokes systems (<a class="el" href="a00158.html#a00576">Euler2D</a>, <a class="el" href="a00169.html#a00589" title="Structure containing variables and parameters specific to the 2D Navier Stokes equations. This structure contains the physical parameters, variables, and function pointers specific to the 2D Navier-Stokes equations. ">NavierStokes2D</a>, <a class="el" href="a00170.html#a00590" title="Structure containing variables and parameters specific to the 3D Navier Stokes equations. This structure contains the physical parameters, variables, and function pointers specific to the 3D Navier-Stokes equations. ">NavierStokes3D</a>). <br/>
<br/>
Note: the Dirichlet boundary condition (<a class="el" href="a00189.html#a7b8553c8fd765568f7355cf32b93b20d">_DIRICHLET_</a>) could be used as well for supersonic inflow; however the specified Dirichlet state should be in terms of the conserved variables, while the specified supersonic inflow state here is in terms of the flow variables. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">b</td><td>Boundary object of type <a class="el" href="a00155.html" title="Structure containing the variables and function pointers defining a boundary. ">DomainBoundary</a> </td></tr>
    <tr><td class="paramname">m</td><td>MPI object of type <a class="el" href="a00167.html#a00588" title="Structure of MPI-related variables. ">MPIVariables</a> </td></tr>
    <tr><td class="paramname">ndims</td><td>Number of spatial dimensions </td></tr>
    <tr><td class="paramname">nvars</td><td>Number of variables/DoFs per grid point </td></tr>
    <tr><td class="paramname">size</td><td>Integer array with the number of grid points in each spatial dimension </td></tr>
    <tr><td class="paramname">ghosts</td><td>Number of ghost points </td></tr>
    <tr><td class="paramname">phi</td><td>The solution array on which to apply the boundary condition </td></tr>
    <tr><td class="paramname">waqt</td><td>Current solution time </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="a00239_source.html#l00024">24</a> of file <a class="el" href="a00239_source.html">BCSupersonicInflow.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;{</div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;  <a class="code" href="a00155.html">DomainBoundary</a> *boundary = (<a class="code" href="a00155.html">DomainBoundary</a>*) b;</div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;</div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;  <span class="keywordflow">if</span> (ndims == 2) {</div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;</div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;    <span class="keywordtype">double</span> gamma;</div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;    gamma = boundary-&gt;<a class="code" href="a00155.html#a72f9e01745b3a8203067ab84aefc9aea">gamma</a>;</div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;    <span class="keywordtype">double</span> inv_gamma_m1 = 1.0/(gamma-1.0);</div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;</div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;    <span class="keywordflow">if</span> (boundary-&gt;<a class="code" href="a00155.html#a2eec7e4ee612d5edc985ba81453346e1">on_this_proc</a>) {</div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;      <span class="keywordtype">int</span> bounds[ndims], indexb[ndims];</div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;      <a class="code" href="a00187.html#ab49d0f261ea751a17d6beca0504daf78">_ArraySubtract1D_</a>(bounds,boundary-&gt;<a class="code" href="a00155.html#a7602de5ebb1b59ec35217e78a35a531e">ie</a>,boundary-&gt;<a class="code" href="a00155.html#a481013ba007a99a4237cde5eeb3c9a29">is</a>,ndims);</div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;      <a class="code" href="a00187.html#a2b2826031c0cd92495ab351d3e599fc5">_ArraySetValue_</a>(indexb,ndims,0);</div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;      <span class="keywordtype">int</span> done = 0;</div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;      <span class="keywordflow">while</span> (!done) {</div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;        <span class="keywordtype">int</span> p1; <a class="code" href="a00187.html#a0739cb538f4d301fad3b45059ddd0738">_ArrayIndex1DWO_</a>(ndims,size,indexb,boundary-&gt;<a class="code" href="a00155.html#a481013ba007a99a4237cde5eeb3c9a29">is</a>,ghosts,p1);</div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;        </div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;        <span class="comment">/* set the ghost point values */</span></div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;        <span class="keywordtype">double</span> rho_gpt, uvel_gpt, vvel_gpt, energy_gpt, pressure_gpt;</div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;        rho_gpt      = boundary-&gt;<a class="code" href="a00155.html#aa92ee9d8efc5ca49f4a83d8dabf0b15d">FlowDensity</a>;</div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;        pressure_gpt = boundary-&gt;<a class="code" href="a00155.html#a0a3c5af6bdb8fbdb746fd4edb374bb18">FlowPressure</a>;</div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;        uvel_gpt     = boundary-&gt;<a class="code" href="a00155.html#a0d0d92fab642e1d02a9de254e73a3f21">FlowVelocity</a>[0];</div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;        vvel_gpt     = boundary-&gt;<a class="code" href="a00155.html#a0d0d92fab642e1d02a9de254e73a3f21">FlowVelocity</a>[1];</div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;        energy_gpt   = inv_gamma_m1*pressure_gpt</div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;                       + 0.5 * rho_gpt * (uvel_gpt*uvel_gpt + vvel_gpt*vvel_gpt);</div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;</div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;        phi[nvars*p1+0] = rho_gpt;</div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;        phi[nvars*p1+1] = rho_gpt * uvel_gpt;</div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;        phi[nvars*p1+2] = rho_gpt * vvel_gpt;</div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;        phi[nvars*p1+3] = energy_gpt;</div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;</div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;        <a class="code" href="a00187.html#ac5ec1371623f11d03b0f42adaa24acbc">_ArrayIncrementIndex_</a>(ndims,bounds,indexb,done);</div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;      }</div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;    }</div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;</div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;  } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (ndims == 3) {</div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;</div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;    <span class="keywordtype">double</span> gamma;</div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;    gamma = boundary-&gt;<a class="code" href="a00155.html#a72f9e01745b3a8203067ab84aefc9aea">gamma</a>;</div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;    <span class="keywordtype">double</span> inv_gamma_m1 = 1.0/(gamma-1.0);</div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;</div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;    <span class="keywordflow">if</span> (boundary-&gt;<a class="code" href="a00155.html#a2eec7e4ee612d5edc985ba81453346e1">on_this_proc</a>) {</div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;      <span class="keywordtype">int</span> bounds[ndims], indexb[ndims];</div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;      <a class="code" href="a00187.html#ab49d0f261ea751a17d6beca0504daf78">_ArraySubtract1D_</a>(bounds,boundary-&gt;<a class="code" href="a00155.html#a7602de5ebb1b59ec35217e78a35a531e">ie</a>,boundary-&gt;<a class="code" href="a00155.html#a481013ba007a99a4237cde5eeb3c9a29">is</a>,ndims);</div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;      <a class="code" href="a00187.html#a2b2826031c0cd92495ab351d3e599fc5">_ArraySetValue_</a>(indexb,ndims,0);</div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;      <span class="keywordtype">int</span> done = 0;</div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;      <span class="keywordflow">while</span> (!done) {</div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;        <span class="keywordtype">int</span> p1; <a class="code" href="a00187.html#a0739cb538f4d301fad3b45059ddd0738">_ArrayIndex1DWO_</a>(ndims,size,indexb,boundary-&gt;<a class="code" href="a00155.html#a481013ba007a99a4237cde5eeb3c9a29">is</a>,ghosts,p1);</div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;        </div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;        <span class="comment">/* set the ghost point values */</span></div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;        <span class="keywordtype">double</span> rho_gpt, uvel_gpt, vvel_gpt, wvel_gpt, energy_gpt, pressure_gpt;</div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;        rho_gpt      = boundary-&gt;<a class="code" href="a00155.html#aa92ee9d8efc5ca49f4a83d8dabf0b15d">FlowDensity</a>;</div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;        pressure_gpt = boundary-&gt;<a class="code" href="a00155.html#a0a3c5af6bdb8fbdb746fd4edb374bb18">FlowPressure</a>;</div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;        uvel_gpt     = boundary-&gt;<a class="code" href="a00155.html#a0d0d92fab642e1d02a9de254e73a3f21">FlowVelocity</a>[0];</div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;        vvel_gpt     = boundary-&gt;<a class="code" href="a00155.html#a0d0d92fab642e1d02a9de254e73a3f21">FlowVelocity</a>[1];</div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;        wvel_gpt     = boundary-&gt;<a class="code" href="a00155.html#a0d0d92fab642e1d02a9de254e73a3f21">FlowVelocity</a>[2];</div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;        energy_gpt   = inv_gamma_m1*pressure_gpt</div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;                       + 0.5 * rho_gpt </div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;                       * (uvel_gpt*uvel_gpt + vvel_gpt*vvel_gpt + wvel_gpt*wvel_gpt);</div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;</div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;        phi[nvars*p1+0] = rho_gpt;</div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;        phi[nvars*p1+1] = rho_gpt * uvel_gpt;</div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;        phi[nvars*p1+2] = rho_gpt * vvel_gpt;</div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;        phi[nvars*p1+3] = rho_gpt * wvel_gpt;</div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;        phi[nvars*p1+4] = energy_gpt;</div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;</div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;        <a class="code" href="a00187.html#ac5ec1371623f11d03b0f42adaa24acbc">_ArrayIncrementIndex_</a>(ndims,bounds,indexb,done);</div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;      }</div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;    }</div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;</div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;  }</div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;  <span class="keywordflow">return</span>(0);</div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;}</div>
<div class="ttc" id="a00155_html_aa92ee9d8efc5ca49f4a83d8dabf0b15d"><div class="ttname"><a href="a00155.html#aa92ee9d8efc5ca49f4a83d8dabf0b15d">DomainBoundary::FlowDensity</a></div><div class="ttdeci">double FlowDensity</div><div class="ttdef"><b>Definition:</b> <a href="a00189_source.html#l00096">boundaryconditions.h:96</a></div></div>
<div class="ttc" id="a00187_html_a0739cb538f4d301fad3b45059ddd0738"><div class="ttname"><a href="a00187.html#a0739cb538f4d301fad3b45059ddd0738">_ArrayIndex1DWO_</a></div><div class="ttdeci">#define _ArrayIndex1DWO_(N, imax, i, offset, ghost, index)</div><div class="ttdef"><b>Definition:</b> <a href="a00187_source.html#l00082">arrayfunctions.h:82</a></div></div>
<div class="ttc" id="a00155_html_a481013ba007a99a4237cde5eeb3c9a29"><div class="ttname"><a href="a00155.html#a481013ba007a99a4237cde5eeb3c9a29">DomainBoundary::is</a></div><div class="ttdeci">int * is</div><div class="ttdef"><b>Definition:</b> <a href="a00189_source.html#l00082">boundaryconditions.h:82</a></div></div>
<div class="ttc" id="a00155_html"><div class="ttname"><a href="a00155.html">DomainBoundary</a></div><div class="ttdoc">Structure containing the variables and function pointers defining a boundary. </div><div class="ttdef"><b>Definition:</b> <a href="a00189_source.html#l00068">boundaryconditions.h:68</a></div></div>
<div class="ttc" id="a00187_html_ab49d0f261ea751a17d6beca0504daf78"><div class="ttname"><a href="a00187.html#ab49d0f261ea751a17d6beca0504daf78">_ArraySubtract1D_</a></div><div class="ttdeci">#define _ArraySubtract1D_(x, a, b, size)</div><div class="ttdef"><b>Definition:</b> <a href="a00187_source.html#l00200">arrayfunctions.h:200</a></div></div>
<div class="ttc" id="a00187_html_ac5ec1371623f11d03b0f42adaa24acbc"><div class="ttname"><a href="a00187.html#ac5ec1371623f11d03b0f42adaa24acbc">_ArrayIncrementIndex_</a></div><div class="ttdeci">#define _ArrayIncrementIndex_(N, imax, i, done)</div><div class="ttdef"><b>Definition:</b> <a href="a00187_source.html#l00125">arrayfunctions.h:125</a></div></div>
<div class="ttc" id="a00155_html_a7602de5ebb1b59ec35217e78a35a531e"><div class="ttname"><a href="a00155.html#a7602de5ebb1b59ec35217e78a35a531e">DomainBoundary::ie</a></div><div class="ttdeci">int * ie</div><div class="ttdef"><b>Definition:</b> <a href="a00189_source.html#l00082">boundaryconditions.h:82</a></div></div>
<div class="ttc" id="a00155_html_a72f9e01745b3a8203067ab84aefc9aea"><div class="ttname"><a href="a00155.html#a72f9e01745b3a8203067ab84aefc9aea">DomainBoundary::gamma</a></div><div class="ttdeci">double gamma</div><div class="ttdef"><b>Definition:</b> <a href="a00189_source.html#l00096">boundaryconditions.h:96</a></div></div>
<div class="ttc" id="a00187_html_a2b2826031c0cd92495ab351d3e599fc5"><div class="ttname"><a href="a00187.html#a2b2826031c0cd92495ab351d3e599fc5">_ArraySetValue_</a></div><div class="ttdeci">#define _ArraySetValue_(x, size, value)</div><div class="ttdef"><b>Definition:</b> <a href="a00187_source.html#l00168">arrayfunctions.h:168</a></div></div>
<div class="ttc" id="a00155_html_a2eec7e4ee612d5edc985ba81453346e1"><div class="ttname"><a href="a00155.html#a2eec7e4ee612d5edc985ba81453346e1">DomainBoundary::on_this_proc</a></div><div class="ttdeci">int on_this_proc</div><div class="ttdef"><b>Definition:</b> <a href="a00189_source.html#l00081">boundaryconditions.h:81</a></div></div>
<div class="ttc" id="a00155_html_a0d0d92fab642e1d02a9de254e73a3f21"><div class="ttname"><a href="a00155.html#a0d0d92fab642e1d02a9de254e73a3f21">DomainBoundary::FlowVelocity</a></div><div class="ttdeci">double * FlowVelocity</div><div class="ttdef"><b>Definition:</b> <a href="a00189_source.html#l00096">boundaryconditions.h:96</a></div></div>
<div class="ttc" id="a00155_html_a0a3c5af6bdb8fbdb746fd4edb374bb18"><div class="ttname"><a href="a00155.html#a0a3c5af6bdb8fbdb746fd4edb374bb18">DomainBoundary::FlowPressure</a></div><div class="ttdeci">double FlowPressure</div><div class="ttdef"><b>Definition:</b> <a href="a00189_source.html#l00096">boundaryconditions.h:96</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="aeceb8d75046193135c6277bf1bf342bd"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int BCSupersonicOutflowU </td>
          <td>(</td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>b</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>m</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>ndims</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>nvars</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>size</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>ghosts</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>phi</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>waqt</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Supersonic outflow boundary conditions for the solution vector U</p>
<p>Applies the supersonic outflow boundary condition: All flow variables (density, pressure, velocity) are extrapolated from the interior since the outflow is supersonic. This boundary condition is specific to two and three dimensional Euler/Navier-Stokes systems (<a class="el" href="a00158.html#a00576">Euler2D</a>, <a class="el" href="a00169.html#a00589" title="Structure containing variables and parameters specific to the 2D Navier Stokes equations. This structure contains the physical parameters, variables, and function pointers specific to the 2D Navier-Stokes equations. ">NavierStokes2D</a>, <a class="el" href="a00170.html#a00590" title="Structure containing variables and parameters specific to the 3D Navier Stokes equations. This structure contains the physical parameters, variables, and function pointers specific to the 3D Navier-Stokes equations. ">NavierStokes3D</a>). <br/>
<br/>
Note: The extrapolate boundary condition (<a class="el" href="a00189.html#a53da239cc00a2394faa0637dad4d0a0c">_EXTRAPOLATE_</a>) can be used as well for this boundary. I am not entirely sure why I wrote the code for this boundary in such a complicated fashion. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">b</td><td>Boundary object of type <a class="el" href="a00155.html" title="Structure containing the variables and function pointers defining a boundary. ">DomainBoundary</a> </td></tr>
    <tr><td class="paramname">m</td><td>MPI object of type <a class="el" href="a00167.html#a00588" title="Structure of MPI-related variables. ">MPIVariables</a> </td></tr>
    <tr><td class="paramname">ndims</td><td>Number of spatial dimensions </td></tr>
    <tr><td class="paramname">nvars</td><td>Number of variables/DoFs per grid point </td></tr>
    <tr><td class="paramname">size</td><td>Integer array with the number of grid points in each spatial dimension </td></tr>
    <tr><td class="paramname">ghosts</td><td>Number of ghost points </td></tr>
    <tr><td class="paramname">phi</td><td>The solution array on which to apply the boundary condition </td></tr>
    <tr><td class="paramname">waqt</td><td>Current solution time </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="a00240_source.html#l00024">24</a> of file <a class="el" href="a00240_source.html">BCSupersonicOutflow.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;{</div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;  <a class="code" href="a00155.html">DomainBoundary</a> *boundary = (<a class="code" href="a00155.html">DomainBoundary</a>*) b;</div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;</div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;  <span class="keywordtype">int</span> dim   = boundary-&gt;<a class="code" href="a00155.html#a70b5e28b5bc3d1b63a7435c5fe50b837">dim</a>;</div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;  <span class="keywordtype">int</span> face  = boundary-&gt;<a class="code" href="a00155.html#a9582c650f117a06449b5ee368b6762ef">face</a>;</div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;</div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;  <span class="keywordflow">if</span> (ndims == 2) {</div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;</div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;    <span class="comment">/* create a fake physics object */</span></div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;    <a class="code" href="a00158.html#a00576">Euler2D</a> physics; </div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;    <span class="keywordtype">double</span> gamma;</div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;    gamma = physics.<a class="code" href="a00158.html#a72f9e01745b3a8203067ab84aefc9aea">gamma</a> = boundary-&gt;<a class="code" href="a00155.html#a72f9e01745b3a8203067ab84aefc9aea">gamma</a>;</div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;    <span class="keywordtype">double</span> inv_gamma_m1 = 1.0/(gamma-1.0);</div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;</div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;    <span class="keywordflow">if</span> (boundary-&gt;<a class="code" href="a00155.html#a2eec7e4ee612d5edc985ba81453346e1">on_this_proc</a>) {</div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;      <span class="keywordtype">int</span> bounds[ndims], indexb[ndims], indexi[ndims];</div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;      <a class="code" href="a00187.html#ab49d0f261ea751a17d6beca0504daf78">_ArraySubtract1D_</a>(bounds,boundary-&gt;<a class="code" href="a00155.html#a7602de5ebb1b59ec35217e78a35a531e">ie</a>,boundary-&gt;<a class="code" href="a00155.html#a481013ba007a99a4237cde5eeb3c9a29">is</a>,ndims);</div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;      <a class="code" href="a00187.html#a2b2826031c0cd92495ab351d3e599fc5">_ArraySetValue_</a>(indexb,ndims,0);</div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;      <span class="keywordtype">int</span> done = 0;</div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;      <span class="keywordflow">while</span> (!done) {</div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;        <span class="keywordtype">int</span> p1, p2;</div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;        <a class="code" href="a00187.html#a89e8330d9e06dd0666c50833628a125c">_ArrayCopy1D_</a>(indexb,indexi,ndims);</div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;        <a class="code" href="a00187.html#a98a3bb5fda2fcafb70a6288d100a0924">_ArrayAdd1D_</a>(indexi,indexi,boundary-&gt;<a class="code" href="a00155.html#a481013ba007a99a4237cde5eeb3c9a29">is</a>,ndims);</div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;        <span class="keywordflow">if</span>      (face ==  1) indexi[dim] = ghosts-1-indexb[dim];</div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (face == -1) indexi[dim] = size[dim]-indexb[dim]-1;</div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">return</span>(1);</div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;        <a class="code" href="a00187.html#a0739cb538f4d301fad3b45059ddd0738">_ArrayIndex1DWO_</a>(ndims,size,indexb,boundary-&gt;<a class="code" href="a00155.html#a481013ba007a99a4237cde5eeb3c9a29">is</a>,ghosts,p1);</div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;        <a class="code" href="a00187.html#afbb862a2fdf5b72b1f9ace42f64b556f">_ArrayIndex1D_</a>(ndims,size,indexi,ghosts,p2);</div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;        </div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;        <span class="comment">/* flow variables in the interior */</span></div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;        <span class="keywordtype">double</span> rho, uvel, vvel, energy, pressure;</div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;        <span class="keywordtype">double</span> rho_gpt, uvel_gpt, vvel_gpt, energy_gpt, pressure_gpt;</div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;        <a class="code" href="a00158.html#afff338b9964cae67fd9b3f4dc224e77b">_Euler2DGetFlowVar_</a>((phi+nvars*p2),rho,uvel,vvel,energy,pressure,(&amp;physics));</div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;        <span class="comment">/* set the ghost point values */</span></div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;        rho_gpt       = rho;</div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;        pressure_gpt  = pressure;</div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;        uvel_gpt      = uvel;</div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;        vvel_gpt      = vvel;</div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;        energy_gpt    = inv_gamma_m1*pressure_gpt</div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;                        + 0.5 * rho_gpt * (uvel_gpt*uvel_gpt + vvel_gpt*vvel_gpt);</div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;</div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;        phi[nvars*p1+0] = rho_gpt;</div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;        phi[nvars*p1+1] = rho_gpt * uvel_gpt;</div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;        phi[nvars*p1+2] = rho_gpt * vvel_gpt;</div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;        phi[nvars*p1+3] = energy_gpt;</div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;</div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;        <a class="code" href="a00187.html#ac5ec1371623f11d03b0f42adaa24acbc">_ArrayIncrementIndex_</a>(ndims,bounds,indexb,done);</div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;      }</div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;    }</div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;</div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;  } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (ndims == 3) {</div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;</div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;    <span class="comment">/* create a fake physics object */</span></div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;    <a class="code" href="a00170.html#a00590">NavierStokes3D</a> physics;</div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;    <span class="keywordtype">double</span> gamma;</div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;    gamma = physics.<a class="code" href="a00170.html#a72f9e01745b3a8203067ab84aefc9aea">gamma</a> = boundary-&gt;<a class="code" href="a00155.html#a72f9e01745b3a8203067ab84aefc9aea">gamma</a>;</div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;    <span class="keywordtype">double</span> inv_gamma_m1 = 1.0/(gamma-1.0);</div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;</div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;    <span class="keywordflow">if</span> (boundary-&gt;<a class="code" href="a00155.html#a2eec7e4ee612d5edc985ba81453346e1">on_this_proc</a>) {</div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;      <span class="keywordtype">int</span> bounds[ndims], indexb[ndims], indexi[ndims];</div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;      <a class="code" href="a00187.html#ab49d0f261ea751a17d6beca0504daf78">_ArraySubtract1D_</a>(bounds,boundary-&gt;<a class="code" href="a00155.html#a7602de5ebb1b59ec35217e78a35a531e">ie</a>,boundary-&gt;<a class="code" href="a00155.html#a481013ba007a99a4237cde5eeb3c9a29">is</a>,ndims);</div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;      <a class="code" href="a00187.html#a2b2826031c0cd92495ab351d3e599fc5">_ArraySetValue_</a>(indexb,ndims,0);</div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;      <span class="keywordtype">int</span> done = 0;</div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;      <span class="keywordflow">while</span> (!done) {</div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;        <span class="keywordtype">int</span> p1, p2;</div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;        <a class="code" href="a00187.html#a89e8330d9e06dd0666c50833628a125c">_ArrayCopy1D_</a>(indexb,indexi,ndims);</div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;        <a class="code" href="a00187.html#a98a3bb5fda2fcafb70a6288d100a0924">_ArrayAdd1D_</a>(indexi,indexi,boundary-&gt;<a class="code" href="a00155.html#a481013ba007a99a4237cde5eeb3c9a29">is</a>,ndims);</div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;        <span class="keywordflow">if</span>      (face ==  1) indexi[dim] = ghosts-1-indexb[dim];</div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (face == -1) indexi[dim] = size[dim]-indexb[dim]-1;</div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">return</span>(1);</div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;        <a class="code" href="a00187.html#a0739cb538f4d301fad3b45059ddd0738">_ArrayIndex1DWO_</a>(ndims,size,indexb,boundary-&gt;<a class="code" href="a00155.html#a481013ba007a99a4237cde5eeb3c9a29">is</a>,ghosts,p1);</div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;        <a class="code" href="a00187.html#afbb862a2fdf5b72b1f9ace42f64b556f">_ArrayIndex1D_</a>(ndims,size,indexi,ghosts,p2);</div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;        </div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;        <span class="comment">/* flow variables in the interior */</span></div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;        <span class="keywordtype">double</span> rho, uvel, vvel, wvel, energy, pressure;</div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;        <span class="keywordtype">double</span> rho_gpt, uvel_gpt, vvel_gpt, wvel_gpt, energy_gpt, pressure_gpt;</div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;        <a class="code" href="a00170.html#a47cfbfdecf13cd3336cc049cfe93ed45">_NavierStokes3DGetFlowVar_</a>((phi+nvars*p2),rho,uvel,vvel,wvel,energy,pressure,(&amp;physics));</div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;        <span class="comment">/* set the ghost point values */</span></div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;        rho_gpt       = rho;</div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;        pressure_gpt  = pressure;</div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;        uvel_gpt      = uvel;</div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;        vvel_gpt      = vvel;</div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;        wvel_gpt      = wvel;</div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;        energy_gpt    = inv_gamma_m1*pressure_gpt</div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;                        + 0.5 * rho_gpt </div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;                        * (uvel_gpt*uvel_gpt + vvel_gpt*vvel_gpt + wvel_gpt*wvel_gpt);</div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;</div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;        phi[nvars*p1+0] = rho_gpt;</div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;        phi[nvars*p1+1] = rho_gpt * uvel_gpt;</div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;        phi[nvars*p1+2] = rho_gpt * vvel_gpt;</div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;        phi[nvars*p1+3] = rho_gpt * wvel_gpt;</div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;        phi[nvars*p1+4] = energy_gpt;</div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;</div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;        <a class="code" href="a00187.html#ac5ec1371623f11d03b0f42adaa24acbc">_ArrayIncrementIndex_</a>(ndims,bounds,indexb,done);</div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;      }</div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;    }</div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;</div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;  }</div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;  <span class="keywordflow">return</span>(0);</div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;}</div>
<div class="ttc" id="a00158_html_afff338b9964cae67fd9b3f4dc224e77b"><div class="ttname"><a href="a00158.html#afff338b9964cae67fd9b3f4dc224e77b">_Euler2DGetFlowVar_</a></div><div class="ttdeci">#define _Euler2DGetFlowVar_(u, rho, vx, vy, e, P, p)</div><div class="ttdef"><b>Definition:</b> <a href="a00158_source.html#l00044">euler2d.h:44</a></div></div>
<div class="ttc" id="a00187_html_a98a3bb5fda2fcafb70a6288d100a0924"><div class="ttname"><a href="a00187.html#a98a3bb5fda2fcafb70a6288d100a0924">_ArrayAdd1D_</a></div><div class="ttdeci">#define _ArrayAdd1D_(x, a, b, size)</div><div class="ttdef"><b>Definition:</b> <a href="a00187_source.html#l00211">arrayfunctions.h:211</a></div></div>
<div class="ttc" id="a00155_html_a70b5e28b5bc3d1b63a7435c5fe50b837"><div class="ttname"><a href="a00155.html#a70b5e28b5bc3d1b63a7435c5fe50b837">DomainBoundary::dim</a></div><div class="ttdeci">int dim</div><div class="ttdef"><b>Definition:</b> <a href="a00189_source.html#l00073">boundaryconditions.h:73</a></div></div>
<div class="ttc" id="a00187_html_a0739cb538f4d301fad3b45059ddd0738"><div class="ttname"><a href="a00187.html#a0739cb538f4d301fad3b45059ddd0738">_ArrayIndex1DWO_</a></div><div class="ttdeci">#define _ArrayIndex1DWO_(N, imax, i, offset, ghost, index)</div><div class="ttdef"><b>Definition:</b> <a href="a00187_source.html#l00082">arrayfunctions.h:82</a></div></div>
<div class="ttc" id="a00170_html_a72f9e01745b3a8203067ab84aefc9aea"><div class="ttname"><a href="a00170.html#a72f9e01745b3a8203067ab84aefc9aea">NavierStokes3D::gamma</a></div><div class="ttdeci">double gamma</div><div class="ttdef"><b>Definition:</b> <a href="a00170_source.html#l00485">navierstokes3d.h:485</a></div></div>
<div class="ttc" id="a00158_html_a72f9e01745b3a8203067ab84aefc9aea"><div class="ttname"><a href="a00158.html#a72f9e01745b3a8203067ab84aefc9aea">Euler2D::gamma</a></div><div class="ttdeci">double gamma</div><div class="ttdef"><b>Definition:</b> <a href="a00158_source.html#l00245">euler2d.h:245</a></div></div>
<div class="ttc" id="a00155_html_a481013ba007a99a4237cde5eeb3c9a29"><div class="ttname"><a href="a00155.html#a481013ba007a99a4237cde5eeb3c9a29">DomainBoundary::is</a></div><div class="ttdeci">int * is</div><div class="ttdef"><b>Definition:</b> <a href="a00189_source.html#l00082">boundaryconditions.h:82</a></div></div>
<div class="ttc" id="a00170_html_a47cfbfdecf13cd3336cc049cfe93ed45"><div class="ttname"><a href="a00170.html#a47cfbfdecf13cd3336cc049cfe93ed45">_NavierStokes3DGetFlowVar_</a></div><div class="ttdeci">#define _NavierStokes3DGetFlowVar_(u, rho, vx, vy, vz, e, P, p)</div><div class="ttdef"><b>Definition:</b> <a href="a00170_source.html#l00098">navierstokes3d.h:98</a></div></div>
<div class="ttc" id="a00155_html"><div class="ttname"><a href="a00155.html">DomainBoundary</a></div><div class="ttdoc">Structure containing the variables and function pointers defining a boundary. </div><div class="ttdef"><b>Definition:</b> <a href="a00189_source.html#l00068">boundaryconditions.h:68</a></div></div>
<div class="ttc" id="a00187_html_ab49d0f261ea751a17d6beca0504daf78"><div class="ttname"><a href="a00187.html#ab49d0f261ea751a17d6beca0504daf78">_ArraySubtract1D_</a></div><div class="ttdeci">#define _ArraySubtract1D_(x, a, b, size)</div><div class="ttdef"><b>Definition:</b> <a href="a00187_source.html#l00200">arrayfunctions.h:200</a></div></div>
<div class="ttc" id="a00170_html_a00590"><div class="ttname"><a href="a00170.html#a00590">NavierStokes3D</a></div><div class="ttdoc">Structure containing variables and parameters specific to the 3D Navier Stokes equations. This structure contains the physical parameters, variables, and function pointers specific to the 3D Navier-Stokes equations. </div><div class="ttdef"><b>Definition:</b> <a href="a00170_source.html#l00484">navierstokes3d.h:484</a></div></div>
<div class="ttc" id="a00187_html_afbb862a2fdf5b72b1f9ace42f64b556f"><div class="ttname"><a href="a00187.html#afbb862a2fdf5b72b1f9ace42f64b556f">_ArrayIndex1D_</a></div><div class="ttdeci">#define _ArrayIndex1D_(N, imax, i, ghost, index)</div><div class="ttdef"><b>Definition:</b> <a href="a00187_source.html#l00039">arrayfunctions.h:39</a></div></div>
<div class="ttc" id="a00187_html_ac5ec1371623f11d03b0f42adaa24acbc"><div class="ttname"><a href="a00187.html#ac5ec1371623f11d03b0f42adaa24acbc">_ArrayIncrementIndex_</a></div><div class="ttdeci">#define _ArrayIncrementIndex_(N, imax, i, done)</div><div class="ttdef"><b>Definition:</b> <a href="a00187_source.html#l00125">arrayfunctions.h:125</a></div></div>
<div class="ttc" id="a00155_html_a7602de5ebb1b59ec35217e78a35a531e"><div class="ttname"><a href="a00155.html#a7602de5ebb1b59ec35217e78a35a531e">DomainBoundary::ie</a></div><div class="ttdeci">int * ie</div><div class="ttdef"><b>Definition:</b> <a href="a00189_source.html#l00082">boundaryconditions.h:82</a></div></div>
<div class="ttc" id="a00155_html_a9582c650f117a06449b5ee368b6762ef"><div class="ttname"><a href="a00155.html#a9582c650f117a06449b5ee368b6762ef">DomainBoundary::face</a></div><div class="ttdeci">int face</div><div class="ttdef"><b>Definition:</b> <a href="a00189_source.html#l00075">boundaryconditions.h:75</a></div></div>
<div class="ttc" id="a00155_html_a72f9e01745b3a8203067ab84aefc9aea"><div class="ttname"><a href="a00155.html#a72f9e01745b3a8203067ab84aefc9aea">DomainBoundary::gamma</a></div><div class="ttdeci">double gamma</div><div class="ttdef"><b>Definition:</b> <a href="a00189_source.html#l00096">boundaryconditions.h:96</a></div></div>
<div class="ttc" id="a00187_html_a2b2826031c0cd92495ab351d3e599fc5"><div class="ttname"><a href="a00187.html#a2b2826031c0cd92495ab351d3e599fc5">_ArraySetValue_</a></div><div class="ttdeci">#define _ArraySetValue_(x, size, value)</div><div class="ttdef"><b>Definition:</b> <a href="a00187_source.html#l00168">arrayfunctions.h:168</a></div></div>
<div class="ttc" id="a00155_html_a2eec7e4ee612d5edc985ba81453346e1"><div class="ttname"><a href="a00155.html#a2eec7e4ee612d5edc985ba81453346e1">DomainBoundary::on_this_proc</a></div><div class="ttdeci">int on_this_proc</div><div class="ttdef"><b>Definition:</b> <a href="a00189_source.html#l00081">boundaryconditions.h:81</a></div></div>
<div class="ttc" id="a00158_html_a00576"><div class="ttname"><a href="a00158.html#a00576">Euler2D</a></div><div class="ttdef"><b>Definition:</b> <a href="a00158_source.html#l00244">euler2d.h:244</a></div></div>
<div class="ttc" id="a00187_html_a89e8330d9e06dd0666c50833628a125c"><div class="ttname"><a href="a00187.html#a89e8330d9e06dd0666c50833628a125c">_ArrayCopy1D_</a></div><div class="ttdeci">#define _ArrayCopy1D_(x, y, size)</div><div class="ttdef"><b>Definition:</b> <a href="a00187_source.html#l00318">arrayfunctions.h:318</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="aad04621186800a19145dcf024fbccc3e"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int BCTurbulentSupersonicInflowU </td>
          <td>(</td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>b</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>m</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>ndims</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>nvars</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>size</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>ghosts</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>phi</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>waqt</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Turbulent Supersonic inflow boundary conditions for the solution vector U</p>
<p>Applies the turbulent supersonic inflow boundary condition: The inflow consists of a mean supersonic inflow on which turbulent flow fluctuations are added. This boundary condition is specific to the 3D Navier-Stokes system (<a class="el" href="a00170.html#a00590" title="Structure containing variables and parameters specific to the 3D Navier Stokes equations. This structure contains the physical parameters, variables, and function pointers specific to the 3D Navier-Stokes equations. ">NavierStokes3D</a>). <br/>
<br/>
Note: Some parts of the code may be hardcoded for use with the shock-turbulence interaction problem (for which this boundary condition was written). </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">b</td><td>Boundary object of type <a class="el" href="a00155.html" title="Structure containing the variables and function pointers defining a boundary. ">DomainBoundary</a> </td></tr>
    <tr><td class="paramname">m</td><td>MPI object of type <a class="el" href="a00167.html#a00588" title="Structure of MPI-related variables. ">MPIVariables</a> </td></tr>
    <tr><td class="paramname">ndims</td><td>Number of spatial dimensions </td></tr>
    <tr><td class="paramname">nvars</td><td>Number of variables/DoFs per grid point </td></tr>
    <tr><td class="paramname">size</td><td>Integer array with the number of grid points in each spatial dimension </td></tr>
    <tr><td class="paramname">ghosts</td><td>Number of ghost points </td></tr>
    <tr><td class="paramname">phi</td><td>The solution array on which to apply the boundary condition </td></tr>
    <tr><td class="paramname">waqt</td><td>Current solution time </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="a00244_source.html#l00021">21</a> of file <a class="el" href="a00244_source.html">BCTurbulentSupersonicInflow.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;{</div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;  <a class="code" href="a00155.html">DomainBoundary</a> *boundary = (<a class="code" href="a00155.html">DomainBoundary</a>*) b;</div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;</div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;  <span class="keywordtype">int</span> dim   = boundary-&gt;<a class="code" href="a00155.html#a70b5e28b5bc3d1b63a7435c5fe50b837">dim</a>;</div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;</div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;  <span class="keywordtype">double</span> *inflow_data = boundary-&gt;<a class="code" href="a00155.html#a48f59fc59e6a86d0b4aad842daea9106">UnsteadyDirichletData</a>;</div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;  <span class="keywordtype">int</span>    *inflow_size = boundary-&gt;<a class="code" href="a00155.html#ac3b478217419275ad063182f69cb543d">UnsteadyDirichletSize</a>;</div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;</div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;  <span class="keywordflow">if</span> (ndims == 3) {</div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;</div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;    <span class="comment">/* create a fake physics object */</span></div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;    <span class="keywordtype">double</span> gamma;</div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;    gamma = boundary-&gt;<a class="code" href="a00155.html#a72f9e01745b3a8203067ab84aefc9aea">gamma</a>;</div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;    <span class="keywordtype">double</span> inv_gamma_m1 = 1.0/(gamma-1.0);</div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;</div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;    <span class="keywordflow">if</span> (boundary-&gt;<a class="code" href="a00155.html#a2eec7e4ee612d5edc985ba81453346e1">on_this_proc</a>) {</div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;      <span class="comment">/* the following bit is hardcoded for the inflow data</span></div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;<span class="comment">       * representing fluctuations in a domain of length 2pi */</span></div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;      <span class="keywordtype">double</span>  xt = boundary-&gt;<a class="code" href="a00155.html#a0d0d92fab642e1d02a9de254e73a3f21">FlowVelocity</a>[dim] * waqt;</div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;      <span class="keywordtype">int</span>     N  = inflow_size[dim];</div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;      <span class="keywordtype">double</span>  L  = 2.0 * (4.0*atan(1.0));</div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;      <span class="keywordtype">int</span>     it = ((int) ((xt/L) * ((double)N))) % N;</div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;</div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;      <span class="keywordtype">int</span> bounds[ndims], indexb[ndims];</div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;      <a class="code" href="a00187.html#ab49d0f261ea751a17d6beca0504daf78">_ArraySubtract1D_</a>(bounds,boundary-&gt;<a class="code" href="a00155.html#a7602de5ebb1b59ec35217e78a35a531e">ie</a>,boundary-&gt;<a class="code" href="a00155.html#a481013ba007a99a4237cde5eeb3c9a29">is</a>,ndims);</div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;      <a class="code" href="a00187.html#a2b2826031c0cd92495ab351d3e599fc5">_ArraySetValue_</a>(indexb,ndims,0);</div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;      <span class="keywordtype">int</span> done = 0;</div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;      <span class="keywordflow">while</span> (!done) {</div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;        <span class="keywordtype">int</span> p1; <a class="code" href="a00187.html#a0739cb538f4d301fad3b45059ddd0738">_ArrayIndex1DWO_</a>(ndims,size,indexb,boundary-&gt;<a class="code" href="a00155.html#a481013ba007a99a4237cde5eeb3c9a29">is</a>,ghosts,p1);</div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;        </div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;        <span class="comment">/* set the ghost point values - mean flow */</span></div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;        <span class="keywordtype">double</span> rho_gpt, uvel_gpt, vvel_gpt, wvel_gpt, energy_gpt, pressure_gpt;</div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;        rho_gpt      = boundary-&gt;<a class="code" href="a00155.html#aa92ee9d8efc5ca49f4a83d8dabf0b15d">FlowDensity</a>;</div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;        pressure_gpt = boundary-&gt;<a class="code" href="a00155.html#a0a3c5af6bdb8fbdb746fd4edb374bb18">FlowPressure</a>;</div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;        uvel_gpt     = boundary-&gt;<a class="code" href="a00155.html#a0d0d92fab642e1d02a9de254e73a3f21">FlowVelocity</a>[0];</div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;        vvel_gpt     = boundary-&gt;<a class="code" href="a00155.html#a0d0d92fab642e1d02a9de254e73a3f21">FlowVelocity</a>[1];</div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;        wvel_gpt     = boundary-&gt;<a class="code" href="a00155.html#a0d0d92fab642e1d02a9de254e73a3f21">FlowVelocity</a>[2];</div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;</div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;        <span class="comment">/* calculate the turbulent fluctuations */</span></div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;        <span class="keywordtype">double</span> duvel , dvvel , dwvel ;</div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;        <span class="keywordtype">int</span> index1[ndims]; <a class="code" href="a00187.html#a89e8330d9e06dd0666c50833628a125c">_ArrayCopy1D_</a>(indexb,index1,ndims);</div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;        index1[dim] = it;</div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;        <span class="keywordtype">int</span> q; <a class="code" href="a00187.html#afbb862a2fdf5b72b1f9ace42f64b556f">_ArrayIndex1D_</a>(ndims,inflow_size,index1,0,q);</div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;        duvel = inflow_data[q*nvars+1];</div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;        dvvel = inflow_data[q*nvars+2];</div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;        dwvel = inflow_data[q*nvars+3];</div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;</div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;        <span class="comment">/* add the turbulent fluctuations to the velocity field */</span></div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;        uvel_gpt      += duvel;</div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;        vvel_gpt      += dvvel;</div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;        wvel_gpt      += dwvel;</div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;</div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;        <span class="comment">/* set the ghost point values */</span></div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;        energy_gpt   = inv_gamma_m1*pressure_gpt</div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;                       + 0.5 * rho_gpt </div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;                       * (uvel_gpt*uvel_gpt + vvel_gpt*vvel_gpt + wvel_gpt*wvel_gpt);</div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;        phi[nvars*p1+0] = rho_gpt;</div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;        phi[nvars*p1+1] = rho_gpt * uvel_gpt;</div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;        phi[nvars*p1+2] = rho_gpt * vvel_gpt;</div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;        phi[nvars*p1+3] = rho_gpt * wvel_gpt;</div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;        phi[nvars*p1+4] = energy_gpt;</div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;</div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;        <a class="code" href="a00187.html#ac5ec1371623f11d03b0f42adaa24acbc">_ArrayIncrementIndex_</a>(ndims,bounds,indexb,done);</div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;      }</div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;    }</div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;</div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;  }</div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;  <span class="keywordflow">return</span>(0);</div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;}</div>
<div class="ttc" id="a00155_html_aa92ee9d8efc5ca49f4a83d8dabf0b15d"><div class="ttname"><a href="a00155.html#aa92ee9d8efc5ca49f4a83d8dabf0b15d">DomainBoundary::FlowDensity</a></div><div class="ttdeci">double FlowDensity</div><div class="ttdef"><b>Definition:</b> <a href="a00189_source.html#l00096">boundaryconditions.h:96</a></div></div>
<div class="ttc" id="a00155_html_a70b5e28b5bc3d1b63a7435c5fe50b837"><div class="ttname"><a href="a00155.html#a70b5e28b5bc3d1b63a7435c5fe50b837">DomainBoundary::dim</a></div><div class="ttdeci">int dim</div><div class="ttdef"><b>Definition:</b> <a href="a00189_source.html#l00073">boundaryconditions.h:73</a></div></div>
<div class="ttc" id="a00187_html_a0739cb538f4d301fad3b45059ddd0738"><div class="ttname"><a href="a00187.html#a0739cb538f4d301fad3b45059ddd0738">_ArrayIndex1DWO_</a></div><div class="ttdeci">#define _ArrayIndex1DWO_(N, imax, i, offset, ghost, index)</div><div class="ttdef"><b>Definition:</b> <a href="a00187_source.html#l00082">arrayfunctions.h:82</a></div></div>
<div class="ttc" id="a00155_html_a481013ba007a99a4237cde5eeb3c9a29"><div class="ttname"><a href="a00155.html#a481013ba007a99a4237cde5eeb3c9a29">DomainBoundary::is</a></div><div class="ttdeci">int * is</div><div class="ttdef"><b>Definition:</b> <a href="a00189_source.html#l00082">boundaryconditions.h:82</a></div></div>
<div class="ttc" id="a00155_html"><div class="ttname"><a href="a00155.html">DomainBoundary</a></div><div class="ttdoc">Structure containing the variables and function pointers defining a boundary. </div><div class="ttdef"><b>Definition:</b> <a href="a00189_source.html#l00068">boundaryconditions.h:68</a></div></div>
<div class="ttc" id="a00155_html_ac3b478217419275ad063182f69cb543d"><div class="ttname"><a href="a00155.html#ac3b478217419275ad063182f69cb543d">DomainBoundary::UnsteadyDirichletSize</a></div><div class="ttdeci">int * UnsteadyDirichletSize</div><div class="ttdef"><b>Definition:</b> <a href="a00189_source.html#l00090">boundaryconditions.h:90</a></div></div>
<div class="ttc" id="a00187_html_ab49d0f261ea751a17d6beca0504daf78"><div class="ttname"><a href="a00187.html#ab49d0f261ea751a17d6beca0504daf78">_ArraySubtract1D_</a></div><div class="ttdeci">#define _ArraySubtract1D_(x, a, b, size)</div><div class="ttdef"><b>Definition:</b> <a href="a00187_source.html#l00200">arrayfunctions.h:200</a></div></div>
<div class="ttc" id="a00187_html_afbb862a2fdf5b72b1f9ace42f64b556f"><div class="ttname"><a href="a00187.html#afbb862a2fdf5b72b1f9ace42f64b556f">_ArrayIndex1D_</a></div><div class="ttdeci">#define _ArrayIndex1D_(N, imax, i, ghost, index)</div><div class="ttdef"><b>Definition:</b> <a href="a00187_source.html#l00039">arrayfunctions.h:39</a></div></div>
<div class="ttc" id="a00187_html_ac5ec1371623f11d03b0f42adaa24acbc"><div class="ttname"><a href="a00187.html#ac5ec1371623f11d03b0f42adaa24acbc">_ArrayIncrementIndex_</a></div><div class="ttdeci">#define _ArrayIncrementIndex_(N, imax, i, done)</div><div class="ttdef"><b>Definition:</b> <a href="a00187_source.html#l00125">arrayfunctions.h:125</a></div></div>
<div class="ttc" id="a00155_html_a7602de5ebb1b59ec35217e78a35a531e"><div class="ttname"><a href="a00155.html#a7602de5ebb1b59ec35217e78a35a531e">DomainBoundary::ie</a></div><div class="ttdeci">int * ie</div><div class="ttdef"><b>Definition:</b> <a href="a00189_source.html#l00082">boundaryconditions.h:82</a></div></div>
<div class="ttc" id="a00155_html_a72f9e01745b3a8203067ab84aefc9aea"><div class="ttname"><a href="a00155.html#a72f9e01745b3a8203067ab84aefc9aea">DomainBoundary::gamma</a></div><div class="ttdeci">double gamma</div><div class="ttdef"><b>Definition:</b> <a href="a00189_source.html#l00096">boundaryconditions.h:96</a></div></div>
<div class="ttc" id="a00187_html_a2b2826031c0cd92495ab351d3e599fc5"><div class="ttname"><a href="a00187.html#a2b2826031c0cd92495ab351d3e599fc5">_ArraySetValue_</a></div><div class="ttdeci">#define _ArraySetValue_(x, size, value)</div><div class="ttdef"><b>Definition:</b> <a href="a00187_source.html#l00168">arrayfunctions.h:168</a></div></div>
<div class="ttc" id="a00155_html_a2eec7e4ee612d5edc985ba81453346e1"><div class="ttname"><a href="a00155.html#a2eec7e4ee612d5edc985ba81453346e1">DomainBoundary::on_this_proc</a></div><div class="ttdeci">int on_this_proc</div><div class="ttdef"><b>Definition:</b> <a href="a00189_source.html#l00081">boundaryconditions.h:81</a></div></div>
<div class="ttc" id="a00155_html_a0d0d92fab642e1d02a9de254e73a3f21"><div class="ttname"><a href="a00155.html#a0d0d92fab642e1d02a9de254e73a3f21">DomainBoundary::FlowVelocity</a></div><div class="ttdeci">double * FlowVelocity</div><div class="ttdef"><b>Definition:</b> <a href="a00189_source.html#l00096">boundaryconditions.h:96</a></div></div>
<div class="ttc" id="a00155_html_a0a3c5af6bdb8fbdb746fd4edb374bb18"><div class="ttname"><a href="a00155.html#a0a3c5af6bdb8fbdb746fd4edb374bb18">DomainBoundary::FlowPressure</a></div><div class="ttdeci">double FlowPressure</div><div class="ttdef"><b>Definition:</b> <a href="a00189_source.html#l00096">boundaryconditions.h:96</a></div></div>
<div class="ttc" id="a00187_html_a89e8330d9e06dd0666c50833628a125c"><div class="ttname"><a href="a00187.html#a89e8330d9e06dd0666c50833628a125c">_ArrayCopy1D_</a></div><div class="ttdeci">#define _ArrayCopy1D_(x, y, size)</div><div class="ttdef"><b>Definition:</b> <a href="a00187_source.html#l00318">arrayfunctions.h:318</a></div></div>
<div class="ttc" id="a00155_html_a48f59fc59e6a86d0b4aad842daea9106"><div class="ttname"><a href="a00155.html#a48f59fc59e6a86d0b4aad842daea9106">DomainBoundary::UnsteadyDirichletData</a></div><div class="ttdeci">double * UnsteadyDirichletData</div><div class="ttdef"><b>Definition:</b> <a href="a00189_source.html#l00091">boundaryconditions.h:91</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="adb156eee1d509ee6500ffe20dce7811d"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int BCNoFluxU </td>
          <td>(</td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>b</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>m</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>ndims</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>nvars</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>size</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>ghosts</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>phi</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>waqt</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>No-Flux (inviscid wall) boundary conditions for the solution vector U</p>
<p>Applies the no-flux boundary conditions: This boundary condition is specific to the NUMA 2D/3D (<a class="el" href="a00171.html">Numa2D</a>, <a class="el" href="a00172.html">Numa3D</a>). Used for simulating inviscid walls or symmetry boundaries. It's equivalent to the slip-wall BC of the Euler/Navier- Stokes system.<br/>
<br/>
The density, potential temperature, and tangential velocity are extrapolated, while the normal velocity at the ghost point is set to the negative of that in the interior (to enforce zero-normal velocity at the boundary face). </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">b</td><td>Boundary object of type <a class="el" href="a00155.html" title="Structure containing the variables and function pointers defining a boundary. ">DomainBoundary</a> </td></tr>
    <tr><td class="paramname">m</td><td>MPI object of type <a class="el" href="a00167.html#a00588" title="Structure of MPI-related variables. ">MPIVariables</a> </td></tr>
    <tr><td class="paramname">ndims</td><td>Number of spatial dimensions </td></tr>
    <tr><td class="paramname">nvars</td><td>Number of variables/DoFs per grid point </td></tr>
    <tr><td class="paramname">size</td><td>Integer array with the number of grid points in each spatial dimension </td></tr>
    <tr><td class="paramname">ghosts</td><td>Number of ghost points </td></tr>
    <tr><td class="paramname">phi</td><td>The solution array on which to apply the boundary condition </td></tr>
    <tr><td class="paramname">waqt</td><td>Current solution time </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="a00230_source.html#l00022">22</a> of file <a class="el" href="a00230_source.html">BCNoFlux.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;{</div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;  <a class="code" href="a00155.html">DomainBoundary</a> *boundary = (<a class="code" href="a00155.html">DomainBoundary</a>*) b;</div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;</div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;  <span class="keywordtype">int</span> dim   = boundary-&gt;<a class="code" href="a00155.html#a70b5e28b5bc3d1b63a7435c5fe50b837">dim</a>;</div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;  <span class="keywordtype">int</span> face  = boundary-&gt;<a class="code" href="a00155.html#a9582c650f117a06449b5ee368b6762ef">face</a>;</div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;</div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;  <span class="keywordflow">if</span> (boundary-&gt;<a class="code" href="a00155.html#a2eec7e4ee612d5edc985ba81453346e1">on_this_proc</a>) {</div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;    <span class="keywordtype">int</span> bounds[ndims], indexb[ndims], indexi[ndims];</div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;    <a class="code" href="a00187.html#ab49d0f261ea751a17d6beca0504daf78">_ArraySubtract1D_</a> (bounds,boundary-&gt;<a class="code" href="a00155.html#a7602de5ebb1b59ec35217e78a35a531e">ie</a>,boundary-&gt;<a class="code" href="a00155.html#a481013ba007a99a4237cde5eeb3c9a29">is</a>,ndims);</div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;    <a class="code" href="a00187.html#a2b2826031c0cd92495ab351d3e599fc5">_ArraySetValue_</a>   (indexb,ndims,0);</div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;    <span class="keywordtype">int</span> done = 0;</div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;    <span class="keywordflow">while</span> (!done) {</div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;      <span class="keywordtype">int</span> p1, p2;</div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;      <a class="code" href="a00187.html#a89e8330d9e06dd0666c50833628a125c">_ArrayCopy1D_</a> (indexb,indexi,ndims);</div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;      <a class="code" href="a00187.html#a98a3bb5fda2fcafb70a6288d100a0924">_ArrayAdd1D_</a>  (indexi,indexi,boundary-&gt;<a class="code" href="a00155.html#a481013ba007a99a4237cde5eeb3c9a29">is</a>,ndims);</div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;      <span class="keywordflow">if</span>      (face ==  1) indexi[dim] = ghosts-1-indexb[dim];</div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;      <span class="keywordflow">else</span> <span class="keywordflow">if</span> (face == -1) indexi[dim] = size[dim]-indexb[dim]-1;</div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;      <span class="keywordflow">else</span> <span class="keywordflow">return</span>(1);</div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;      <a class="code" href="a00187.html#a0739cb538f4d301fad3b45059ddd0738">_ArrayIndex1DWO_</a>  (ndims,size,indexb,boundary-&gt;<a class="code" href="a00155.html#a481013ba007a99a4237cde5eeb3c9a29">is</a>,ghosts,p1);</div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;      <a class="code" href="a00187.html#afbb862a2fdf5b72b1f9ace42f64b556f">_ArrayIndex1D_</a>    (ndims,size,indexi,ghosts,p2);</div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;      </div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;      <span class="keywordflow">if</span> (nvars == 4) {</div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;        phi[nvars*p1+0] = phi[nvars*p2+0];</div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;        phi[nvars*p1+1] = (dim == <a class="code" href="a00206.html#a6a44057228e5f4b86e1c4d04b2a28977">_XDIR_</a> ? -phi[nvars*p2+1] : phi[nvars*p2+1] );</div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;        phi[nvars*p1+2] = (dim == <a class="code" href="a00158.html#a7fd32e06617f4489079bc50ce9bfc00c">_YDIR_</a> ? -phi[nvars*p2+2] : phi[nvars*p2+2] );</div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;        phi[nvars*p1+3] = phi[nvars*p2+3];</div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;      } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (nvars == 5) {</div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;        phi[nvars*p1+0] = phi[nvars*p2+0];</div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;        phi[nvars*p1+1] = (dim == <a class="code" href="a00206.html#a6a44057228e5f4b86e1c4d04b2a28977">_XDIR_</a> ? -phi[nvars*p2+1] : phi[nvars*p2+1] );</div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;        phi[nvars*p1+2] = (dim == <a class="code" href="a00158.html#a7fd32e06617f4489079bc50ce9bfc00c">_YDIR_</a> ? -phi[nvars*p2+2] : phi[nvars*p2+2] );</div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;        phi[nvars*p1+3] = (dim == <a class="code" href="a00170.html#a227beecac6bef022707512c15d39e30b">_ZDIR_</a> ? -phi[nvars*p2+3] : phi[nvars*p2+3] );</div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;        phi[nvars*p1+4] = phi[nvars*p2+4];</div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;      }</div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;</div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;      <a class="code" href="a00187.html#ac5ec1371623f11d03b0f42adaa24acbc">_ArrayIncrementIndex_</a>(ndims,bounds,indexb,done);</div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;    }</div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;  }</div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;  <span class="keywordflow">return</span>(0);</div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;}</div>
<div class="ttc" id="a00187_html_a98a3bb5fda2fcafb70a6288d100a0924"><div class="ttname"><a href="a00187.html#a98a3bb5fda2fcafb70a6288d100a0924">_ArrayAdd1D_</a></div><div class="ttdeci">#define _ArrayAdd1D_(x, a, b, size)</div><div class="ttdef"><b>Definition:</b> <a href="a00187_source.html#l00211">arrayfunctions.h:211</a></div></div>
<div class="ttc" id="a00155_html_a70b5e28b5bc3d1b63a7435c5fe50b837"><div class="ttname"><a href="a00155.html#a70b5e28b5bc3d1b63a7435c5fe50b837">DomainBoundary::dim</a></div><div class="ttdeci">int dim</div><div class="ttdef"><b>Definition:</b> <a href="a00189_source.html#l00073">boundaryconditions.h:73</a></div></div>
<div class="ttc" id="a00187_html_a0739cb538f4d301fad3b45059ddd0738"><div class="ttname"><a href="a00187.html#a0739cb538f4d301fad3b45059ddd0738">_ArrayIndex1DWO_</a></div><div class="ttdeci">#define _ArrayIndex1DWO_(N, imax, i, offset, ghost, index)</div><div class="ttdef"><b>Definition:</b> <a href="a00187_source.html#l00082">arrayfunctions.h:82</a></div></div>
<div class="ttc" id="a00155_html_a481013ba007a99a4237cde5eeb3c9a29"><div class="ttname"><a href="a00155.html#a481013ba007a99a4237cde5eeb3c9a29">DomainBoundary::is</a></div><div class="ttdeci">int * is</div><div class="ttdef"><b>Definition:</b> <a href="a00189_source.html#l00082">boundaryconditions.h:82</a></div></div>
<div class="ttc" id="a00155_html"><div class="ttname"><a href="a00155.html">DomainBoundary</a></div><div class="ttdoc">Structure containing the variables and function pointers defining a boundary. </div><div class="ttdef"><b>Definition:</b> <a href="a00189_source.html#l00068">boundaryconditions.h:68</a></div></div>
<div class="ttc" id="a00187_html_ab49d0f261ea751a17d6beca0504daf78"><div class="ttname"><a href="a00187.html#ab49d0f261ea751a17d6beca0504daf78">_ArraySubtract1D_</a></div><div class="ttdeci">#define _ArraySubtract1D_(x, a, b, size)</div><div class="ttdef"><b>Definition:</b> <a href="a00187_source.html#l00200">arrayfunctions.h:200</a></div></div>
<div class="ttc" id="a00187_html_afbb862a2fdf5b72b1f9ace42f64b556f"><div class="ttname"><a href="a00187.html#afbb862a2fdf5b72b1f9ace42f64b556f">_ArrayIndex1D_</a></div><div class="ttdeci">#define _ArrayIndex1D_(N, imax, i, ghost, index)</div><div class="ttdef"><b>Definition:</b> <a href="a00187_source.html#l00039">arrayfunctions.h:39</a></div></div>
<div class="ttc" id="a00170_html_a227beecac6bef022707512c15d39e30b"><div class="ttname"><a href="a00170.html#a227beecac6bef022707512c15d39e30b">_ZDIR_</a></div><div class="ttdeci">#define _ZDIR_</div><div class="ttdef"><b>Definition:</b> <a href="a00170_source.html#l00076">navierstokes3d.h:76</a></div></div>
<div class="ttc" id="a00187_html_ac5ec1371623f11d03b0f42adaa24acbc"><div class="ttname"><a href="a00187.html#ac5ec1371623f11d03b0f42adaa24acbc">_ArrayIncrementIndex_</a></div><div class="ttdeci">#define _ArrayIncrementIndex_(N, imax, i, done)</div><div class="ttdef"><b>Definition:</b> <a href="a00187_source.html#l00125">arrayfunctions.h:125</a></div></div>
<div class="ttc" id="a00155_html_a7602de5ebb1b59ec35217e78a35a531e"><div class="ttname"><a href="a00155.html#a7602de5ebb1b59ec35217e78a35a531e">DomainBoundary::ie</a></div><div class="ttdeci">int * ie</div><div class="ttdef"><b>Definition:</b> <a href="a00189_source.html#l00082">boundaryconditions.h:82</a></div></div>
<div class="ttc" id="a00155_html_a9582c650f117a06449b5ee368b6762ef"><div class="ttname"><a href="a00155.html#a9582c650f117a06449b5ee368b6762ef">DomainBoundary::face</a></div><div class="ttdeci">int face</div><div class="ttdef"><b>Definition:</b> <a href="a00189_source.html#l00075">boundaryconditions.h:75</a></div></div>
<div class="ttc" id="a00206_html_a6a44057228e5f4b86e1c4d04b2a28977"><div class="ttname"><a href="a00206.html#a6a44057228e5f4b86e1c4d04b2a28977">_XDIR_</a></div><div class="ttdeci">#define _XDIR_</div><div class="ttdef"><b>Definition:</b> <a href="a00206_source.html#l00075">euler1d.h:75</a></div></div>
<div class="ttc" id="a00187_html_a2b2826031c0cd92495ab351d3e599fc5"><div class="ttname"><a href="a00187.html#a2b2826031c0cd92495ab351d3e599fc5">_ArraySetValue_</a></div><div class="ttdeci">#define _ArraySetValue_(x, size, value)</div><div class="ttdef"><b>Definition:</b> <a href="a00187_source.html#l00168">arrayfunctions.h:168</a></div></div>
<div class="ttc" id="a00155_html_a2eec7e4ee612d5edc985ba81453346e1"><div class="ttname"><a href="a00155.html#a2eec7e4ee612d5edc985ba81453346e1">DomainBoundary::on_this_proc</a></div><div class="ttdeci">int on_this_proc</div><div class="ttdef"><b>Definition:</b> <a href="a00189_source.html#l00081">boundaryconditions.h:81</a></div></div>
<div class="ttc" id="a00158_html_a7fd32e06617f4489079bc50ce9bfc00c"><div class="ttname"><a href="a00158.html#a7fd32e06617f4489079bc50ce9bfc00c">_YDIR_</a></div><div class="ttdeci">#define _YDIR_</div><div class="ttdef"><b>Definition:</b> <a href="a00158_source.html#l00041">euler2d.h:41</a></div></div>
<div class="ttc" id="a00187_html_a89e8330d9e06dd0666c50833628a125c"><div class="ttname"><a href="a00187.html#a89e8330d9e06dd0666c50833628a125c">_ArrayCopy1D_</a></div><div class="ttdeci">#define _ArrayCopy1D_(x, y, size)</div><div class="ttdef"><b>Definition:</b> <a href="a00187_source.html#l00318">arrayfunctions.h:318</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a6904fb76cd1fe7638108e1ffdcf1a6ad"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int BCSWSlipWallU </td>
          <td>(</td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>b</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>m</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>ndims</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>nvars</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>size</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>ghosts</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>phi</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>waqt</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Slip (inviscid) wall boundary conditions for the solution vector U</p>
<p>Applies the slip-wall boundary condition: This is specific to the one and two dimenstional shallow water equations (<a class="el" href="a00175.html" title="Structure containing variables and parameters specific to the 1D Shallow Water equations. This structure contains the physical parameters, variables, and function pointers specific to the 1D ShallowWater equations. ">ShallowWater1D</a>, <a class="el" href="a00176.html" title="Structure containing variables and parameters specific to the 2D Shallow Water equations. This structure contains the physical parameters, variables, and function pointers specific to the 2D ShallowWater equations. ">ShallowWater2D</a>). It is used for simulating inviscid walls or symmetric boundaries. The height, and tangential velocity at the ghost points are extrapolated from the interior, while the normal velocity at the ghost points is set such that the interpolated value at the boundary face is equal to the specified wall velocity. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">b</td><td>Boundary object of type <a class="el" href="a00155.html" title="Structure containing the variables and function pointers defining a boundary. ">DomainBoundary</a> </td></tr>
    <tr><td class="paramname">m</td><td>MPI object of type <a class="el" href="a00167.html#a00588" title="Structure of MPI-related variables. ">MPIVariables</a> </td></tr>
    <tr><td class="paramname">ndims</td><td>Number of spatial dimensions </td></tr>
    <tr><td class="paramname">nvars</td><td>Number of variables/DoFs per grid point </td></tr>
    <tr><td class="paramname">size</td><td>Integer array with the number of grid points in each spatial dimension </td></tr>
    <tr><td class="paramname">ghosts</td><td>Number of ghost points </td></tr>
    <tr><td class="paramname">phi</td><td>The solution array on which to apply the boundary condition </td></tr>
    <tr><td class="paramname">waqt</td><td>Current solution time </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="a00241_source.html#l00021">21</a> of file <a class="el" href="a00241_source.html">BCSWSlipWall.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;{</div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;  <a class="code" href="a00155.html">DomainBoundary</a> *boundary = (<a class="code" href="a00155.html">DomainBoundary</a>*) b;</div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;</div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;  <span class="keywordtype">int</span> dim   = boundary-&gt;<a class="code" href="a00155.html#a70b5e28b5bc3d1b63a7435c5fe50b837">dim</a>;</div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;  <span class="keywordtype">int</span> face  = boundary-&gt;<a class="code" href="a00155.html#a9582c650f117a06449b5ee368b6762ef">face</a>;</div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;</div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;  <span class="keywordflow">if</span> (ndims == 1) {</div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;</div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;    <span class="keywordflow">if</span> (boundary-&gt;<a class="code" href="a00155.html#a2eec7e4ee612d5edc985ba81453346e1">on_this_proc</a>) {</div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;      <span class="keywordtype">int</span> bounds[ndims], indexb[ndims], indexi[ndims];</div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;      <a class="code" href="a00187.html#ab49d0f261ea751a17d6beca0504daf78">_ArraySubtract1D_</a>(bounds,boundary-&gt;<a class="code" href="a00155.html#a7602de5ebb1b59ec35217e78a35a531e">ie</a>,boundary-&gt;<a class="code" href="a00155.html#a481013ba007a99a4237cde5eeb3c9a29">is</a>,ndims);</div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;      <a class="code" href="a00187.html#a2b2826031c0cd92495ab351d3e599fc5">_ArraySetValue_</a>(indexb,ndims,0);</div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;      <span class="keywordtype">int</span> done = 0;</div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;      <span class="keywordflow">while</span> (!done) {</div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;        <span class="keywordtype">int</span> p1, p2;</div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;        <a class="code" href="a00187.html#a89e8330d9e06dd0666c50833628a125c">_ArrayCopy1D_</a>(indexb,indexi,ndims);</div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;        <a class="code" href="a00187.html#a98a3bb5fda2fcafb70a6288d100a0924">_ArrayAdd1D_</a>(indexi,indexi,boundary-&gt;<a class="code" href="a00155.html#a481013ba007a99a4237cde5eeb3c9a29">is</a>,ndims);</div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;        <span class="keywordflow">if</span>      (face ==  1) indexi[dim] = ghosts-1-indexb[dim];</div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (face == -1) indexi[dim] = size[dim]-indexb[dim]-1;</div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">return</span>(1);</div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;        <a class="code" href="a00187.html#a0739cb538f4d301fad3b45059ddd0738">_ArrayIndex1DWO_</a>(ndims,size,indexb,boundary-&gt;<a class="code" href="a00155.html#a481013ba007a99a4237cde5eeb3c9a29">is</a>,ghosts,p1);</div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;        <a class="code" href="a00187.html#afbb862a2fdf5b72b1f9ace42f64b556f">_ArrayIndex1D_</a>(ndims,size,indexi,ghosts,p2);</div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;        </div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;        <span class="comment">/* flow variables in the interior */</span></div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;        <span class="keywordtype">double</span> h, uvel;</div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;        <span class="keywordtype">double</span> h_gpt, uvel_gpt;</div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;        <a class="code" href="a00209.html#ab6d0702f0bacbdb3f2644bd1f60938c0">_ShallowWater1DGetFlowVar_</a>((phi+nvars*p2),h,uvel);</div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;        <span class="comment">/* set the ghost point values */</span></div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;        h_gpt = h;</div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;        uvel_gpt = 2.0*boundary-&gt;<a class="code" href="a00155.html#a0d0d92fab642e1d02a9de254e73a3f21">FlowVelocity</a>[<a class="code" href="a00206.html#a6a44057228e5f4b86e1c4d04b2a28977">_XDIR_</a>] - uvel;</div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;</div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;        phi[nvars*p1+0] = h_gpt;</div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;        phi[nvars*p1+1] = h_gpt * uvel_gpt;</div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;</div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;        <a class="code" href="a00187.html#ac5ec1371623f11d03b0f42adaa24acbc">_ArrayIncrementIndex_</a>(ndims,bounds,indexb,done);</div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;      }</div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;    }</div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;</div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;  } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (ndims == 2) {</div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;</div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;    <span class="keywordflow">if</span> (boundary-&gt;<a class="code" href="a00155.html#a2eec7e4ee612d5edc985ba81453346e1">on_this_proc</a>) {</div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;      <span class="keywordtype">int</span> bounds[ndims], indexb[ndims], indexi[ndims];</div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;      <a class="code" href="a00187.html#ab49d0f261ea751a17d6beca0504daf78">_ArraySubtract1D_</a>(bounds,boundary-&gt;<a class="code" href="a00155.html#a7602de5ebb1b59ec35217e78a35a531e">ie</a>,boundary-&gt;<a class="code" href="a00155.html#a481013ba007a99a4237cde5eeb3c9a29">is</a>,ndims);</div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;      <a class="code" href="a00187.html#a2b2826031c0cd92495ab351d3e599fc5">_ArraySetValue_</a>(indexb,ndims,0);</div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;      <span class="keywordtype">int</span> done = 0;</div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;      <span class="keywordflow">while</span> (!done) {</div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;        <span class="keywordtype">int</span> p1, p2;</div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;        <a class="code" href="a00187.html#a89e8330d9e06dd0666c50833628a125c">_ArrayCopy1D_</a>(indexb,indexi,ndims);</div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;        <a class="code" href="a00187.html#a98a3bb5fda2fcafb70a6288d100a0924">_ArrayAdd1D_</a>(indexi,indexi,boundary-&gt;<a class="code" href="a00155.html#a481013ba007a99a4237cde5eeb3c9a29">is</a>,ndims);</div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;        <span class="keywordflow">if</span>      (face ==  1) indexi[dim] = ghosts-1-indexb[dim];</div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (face == -1) indexi[dim] = size[dim]-indexb[dim]-1;</div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">return</span>(1);</div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;        <a class="code" href="a00187.html#a0739cb538f4d301fad3b45059ddd0738">_ArrayIndex1DWO_</a>(ndims,size,indexb,boundary-&gt;<a class="code" href="a00155.html#a481013ba007a99a4237cde5eeb3c9a29">is</a>,ghosts,p1);</div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;        <a class="code" href="a00187.html#afbb862a2fdf5b72b1f9ace42f64b556f">_ArrayIndex1D_</a>(ndims,size,indexi,ghosts,p2);</div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;        </div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;        <span class="comment">/* flow variables in the interior */</span></div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;        <span class="keywordtype">double</span> h, uvel, vvel;</div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;        <span class="keywordtype">double</span> h_gpt, uvel_gpt, vvel_gpt;</div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;        <a class="code" href="a00210.html#a66b88d6a05555a192a0e455ed99341a4">_ShallowWater2DGetFlowVar_</a>((phi+nvars*p2),h,uvel,vvel);</div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;        <span class="comment">/* set the ghost point values */</span></div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;        h_gpt = h;</div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;        <span class="keywordflow">if</span> (dim == <a class="code" href="a00206.html#a6a44057228e5f4b86e1c4d04b2a28977">_XDIR_</a>) {</div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;          uvel_gpt = 2.0*boundary-&gt;<a class="code" href="a00155.html#a0d0d92fab642e1d02a9de254e73a3f21">FlowVelocity</a>[<a class="code" href="a00206.html#a6a44057228e5f4b86e1c4d04b2a28977">_XDIR_</a>] - uvel;</div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;          vvel_gpt = vvel;</div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;        } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (dim == <a class="code" href="a00158.html#a7fd32e06617f4489079bc50ce9bfc00c">_YDIR_</a>) {</div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;          uvel_gpt = uvel;</div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;          vvel_gpt = 2.0*boundary-&gt;<a class="code" href="a00155.html#a0d0d92fab642e1d02a9de254e73a3f21">FlowVelocity</a>[<a class="code" href="a00158.html#a7fd32e06617f4489079bc50ce9bfc00c">_YDIR_</a>] - vvel;</div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;          uvel_gpt = 0.0;</div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;          vvel_gpt = 0.0;</div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;        }</div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;</div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;        phi[nvars*p1+0] = h_gpt;</div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;        phi[nvars*p1+1] = h_gpt * uvel_gpt;</div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;        phi[nvars*p1+2] = h_gpt * vvel_gpt;</div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;</div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;        <a class="code" href="a00187.html#ac5ec1371623f11d03b0f42adaa24acbc">_ArrayIncrementIndex_</a>(ndims,bounds,indexb,done);</div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;      }</div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;    }</div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;</div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;  }</div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;  <span class="keywordflow">return</span>(0);</div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;}</div>
<div class="ttc" id="a00187_html_a98a3bb5fda2fcafb70a6288d100a0924"><div class="ttname"><a href="a00187.html#a98a3bb5fda2fcafb70a6288d100a0924">_ArrayAdd1D_</a></div><div class="ttdeci">#define _ArrayAdd1D_(x, a, b, size)</div><div class="ttdef"><b>Definition:</b> <a href="a00187_source.html#l00211">arrayfunctions.h:211</a></div></div>
<div class="ttc" id="a00155_html_a70b5e28b5bc3d1b63a7435c5fe50b837"><div class="ttname"><a href="a00155.html#a70b5e28b5bc3d1b63a7435c5fe50b837">DomainBoundary::dim</a></div><div class="ttdeci">int dim</div><div class="ttdef"><b>Definition:</b> <a href="a00189_source.html#l00073">boundaryconditions.h:73</a></div></div>
<div class="ttc" id="a00187_html_a0739cb538f4d301fad3b45059ddd0738"><div class="ttname"><a href="a00187.html#a0739cb538f4d301fad3b45059ddd0738">_ArrayIndex1DWO_</a></div><div class="ttdeci">#define _ArrayIndex1DWO_(N, imax, i, offset, ghost, index)</div><div class="ttdef"><b>Definition:</b> <a href="a00187_source.html#l00082">arrayfunctions.h:82</a></div></div>
<div class="ttc" id="a00210_html_a66b88d6a05555a192a0e455ed99341a4"><div class="ttname"><a href="a00210.html#a66b88d6a05555a192a0e455ed99341a4">_ShallowWater2DGetFlowVar_</a></div><div class="ttdeci">#define _ShallowWater2DGetFlowVar_(u, h, uvel, vvel)</div><div class="ttdef"><b>Definition:</b> <a href="a00210_source.html#l00073">shallowwater2d.h:73</a></div></div>
<div class="ttc" id="a00155_html_a481013ba007a99a4237cde5eeb3c9a29"><div class="ttname"><a href="a00155.html#a481013ba007a99a4237cde5eeb3c9a29">DomainBoundary::is</a></div><div class="ttdeci">int * is</div><div class="ttdef"><b>Definition:</b> <a href="a00189_source.html#l00082">boundaryconditions.h:82</a></div></div>
<div class="ttc" id="a00155_html"><div class="ttname"><a href="a00155.html">DomainBoundary</a></div><div class="ttdoc">Structure containing the variables and function pointers defining a boundary. </div><div class="ttdef"><b>Definition:</b> <a href="a00189_source.html#l00068">boundaryconditions.h:68</a></div></div>
<div class="ttc" id="a00209_html_ab6d0702f0bacbdb3f2644bd1f60938c0"><div class="ttname"><a href="a00209.html#ab6d0702f0bacbdb3f2644bd1f60938c0">_ShallowWater1DGetFlowVar_</a></div><div class="ttdeci">#define _ShallowWater1DGetFlowVar_(u, h, v)</div><div class="ttdef"><b>Definition:</b> <a href="a00209_source.html#l00054">shallowwater1d.h:54</a></div></div>
<div class="ttc" id="a00187_html_ab49d0f261ea751a17d6beca0504daf78"><div class="ttname"><a href="a00187.html#ab49d0f261ea751a17d6beca0504daf78">_ArraySubtract1D_</a></div><div class="ttdeci">#define _ArraySubtract1D_(x, a, b, size)</div><div class="ttdef"><b>Definition:</b> <a href="a00187_source.html#l00200">arrayfunctions.h:200</a></div></div>
<div class="ttc" id="a00187_html_afbb862a2fdf5b72b1f9ace42f64b556f"><div class="ttname"><a href="a00187.html#afbb862a2fdf5b72b1f9ace42f64b556f">_ArrayIndex1D_</a></div><div class="ttdeci">#define _ArrayIndex1D_(N, imax, i, ghost, index)</div><div class="ttdef"><b>Definition:</b> <a href="a00187_source.html#l00039">arrayfunctions.h:39</a></div></div>
<div class="ttc" id="a00187_html_ac5ec1371623f11d03b0f42adaa24acbc"><div class="ttname"><a href="a00187.html#ac5ec1371623f11d03b0f42adaa24acbc">_ArrayIncrementIndex_</a></div><div class="ttdeci">#define _ArrayIncrementIndex_(N, imax, i, done)</div><div class="ttdef"><b>Definition:</b> <a href="a00187_source.html#l00125">arrayfunctions.h:125</a></div></div>
<div class="ttc" id="a00155_html_a7602de5ebb1b59ec35217e78a35a531e"><div class="ttname"><a href="a00155.html#a7602de5ebb1b59ec35217e78a35a531e">DomainBoundary::ie</a></div><div class="ttdeci">int * ie</div><div class="ttdef"><b>Definition:</b> <a href="a00189_source.html#l00082">boundaryconditions.h:82</a></div></div>
<div class="ttc" id="a00155_html_a9582c650f117a06449b5ee368b6762ef"><div class="ttname"><a href="a00155.html#a9582c650f117a06449b5ee368b6762ef">DomainBoundary::face</a></div><div class="ttdeci">int face</div><div class="ttdef"><b>Definition:</b> <a href="a00189_source.html#l00075">boundaryconditions.h:75</a></div></div>
<div class="ttc" id="a00206_html_a6a44057228e5f4b86e1c4d04b2a28977"><div class="ttname"><a href="a00206.html#a6a44057228e5f4b86e1c4d04b2a28977">_XDIR_</a></div><div class="ttdeci">#define _XDIR_</div><div class="ttdef"><b>Definition:</b> <a href="a00206_source.html#l00075">euler1d.h:75</a></div></div>
<div class="ttc" id="a00187_html_a2b2826031c0cd92495ab351d3e599fc5"><div class="ttname"><a href="a00187.html#a2b2826031c0cd92495ab351d3e599fc5">_ArraySetValue_</a></div><div class="ttdeci">#define _ArraySetValue_(x, size, value)</div><div class="ttdef"><b>Definition:</b> <a href="a00187_source.html#l00168">arrayfunctions.h:168</a></div></div>
<div class="ttc" id="a00155_html_a2eec7e4ee612d5edc985ba81453346e1"><div class="ttname"><a href="a00155.html#a2eec7e4ee612d5edc985ba81453346e1">DomainBoundary::on_this_proc</a></div><div class="ttdeci">int on_this_proc</div><div class="ttdef"><b>Definition:</b> <a href="a00189_source.html#l00081">boundaryconditions.h:81</a></div></div>
<div class="ttc" id="a00155_html_a0d0d92fab642e1d02a9de254e73a3f21"><div class="ttname"><a href="a00155.html#a0d0d92fab642e1d02a9de254e73a3f21">DomainBoundary::FlowVelocity</a></div><div class="ttdeci">double * FlowVelocity</div><div class="ttdef"><b>Definition:</b> <a href="a00189_source.html#l00096">boundaryconditions.h:96</a></div></div>
<div class="ttc" id="a00158_html_a7fd32e06617f4489079bc50ce9bfc00c"><div class="ttname"><a href="a00158.html#a7fd32e06617f4489079bc50ce9bfc00c">_YDIR_</a></div><div class="ttdeci">#define _YDIR_</div><div class="ttdef"><b>Definition:</b> <a href="a00158_source.html#l00041">euler2d.h:41</a></div></div>
<div class="ttc" id="a00187_html_a89e8330d9e06dd0666c50833628a125c"><div class="ttname"><a href="a00187.html#a89e8330d9e06dd0666c50833628a125c">_ArrayCopy1D_</a></div><div class="ttdeci">#define _ArrayCopy1D_(x, y, size)</div><div class="ttdef"><b>Definition:</b> <a href="a00187_source.html#l00318">arrayfunctions.h:318</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a49368bf44f300143cd9ec18d10b37a23"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int BCSpongeSource </td>
          <td>(</td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>b</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>ndims</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>nvars</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>ghosts</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>size</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>grid</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>u</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>source</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>a special BC enforcement - an absorbent sponge - enforced through a source term</p>
<p>Applies the sponge boundary condition: This function computes the source term required to apply a sponge boundary condition that gradually relaxes the solution to a specified state. This boundary condition is different from other boundary conditions in the sense that it is applied at interior grid points (but within the defined sponge zone). <br/>
<br/>
The source term for the sponge is computed as: </p>
<p class="formulaDsp">
\begin{align} {\bf S}_i &amp;= \sigma_i \left( {\bf U}_i - {\bf U}_{\rm ref} \right),\\ \sigma_i &amp;= \frac {x_i - x_{\rm start}} {x_{\rm end} - x_{\rm start}} \end{align}
</p>
<p> where \(i\) is the grid index along the spatial dimension of the sponge, \({\bf U}_{\rm ref}\) is the specified state to which the solution is relaxed, and \(x_i\), \(x_{\rm start}\), and \(x_{\rm end}\) are the spatial coordinates of the grid point, sponge start, and sponge end, respectively, along the spatial dimension of the sponge. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">b</td><td>Boundary object of type <a class="el" href="a00155.html" title="Structure containing the variables and function pointers defining a boundary. ">DomainBoundary</a> </td></tr>
    <tr><td class="paramname">ndims</td><td>Number of spatial dimensions </td></tr>
    <tr><td class="paramname">nvars</td><td>Number of variables/DoFs per grid point </td></tr>
    <tr><td class="paramname">ghosts</td><td>Number of ghost points </td></tr>
    <tr><td class="paramname">size</td><td>Integer array with the number of grid points in each spatial dimension </td></tr>
    <tr><td class="paramname">grid</td><td>1D array with the spatial coordinates of the grid points, one dimension after the other </td></tr>
    <tr><td class="paramname">u</td><td>Solution </td></tr>
    <tr><td class="paramname">source</td><td>Source term to which the sponge term is added </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="a00235_source.html#l00026">26</a> of file <a class="el" href="a00235_source.html">BCSponge.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;{</div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;  <a class="code" href="a00155.html">DomainBoundary</a> *boundary = (<a class="code" href="a00155.html">DomainBoundary</a>*) b;</div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;  <span class="keywordtype">int</span>            dim       = boundary-&gt;<a class="code" href="a00155.html#a70b5e28b5bc3d1b63a7435c5fe50b837">dim</a>;</div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;  <span class="keywordtype">int</span>            face      = boundary-&gt;<a class="code" href="a00155.html#a9582c650f117a06449b5ee368b6762ef">face</a>;</div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;  <span class="keywordtype">double</span>         *uref     = boundary-&gt;<a class="code" href="a00155.html#af7eeb4ff3f7c8bc22e0786ddbe62f16d">SpongeValue</a>;</div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;  <span class="keywordtype">double</span>         *xmin     = boundary-&gt;<a class="code" href="a00155.html#a1e51e79041d5a3dddffb503277703568">xmin</a>;</div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;  <span class="keywordtype">double</span>         *xmax     = boundary-&gt;<a class="code" href="a00155.html#a7ea24a733beddff902459a07bf91ca67">xmax</a>;</div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;  <span class="keywordtype">int</span>            v;</div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;</div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;  <span class="keywordflow">if</span> (boundary-&gt;<a class="code" href="a00155.html#a2eec7e4ee612d5edc985ba81453346e1">on_this_proc</a>) {</div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;    <span class="keywordtype">int</span> bounds[ndims], indexb[ndims];</div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;    <a class="code" href="a00187.html#ab49d0f261ea751a17d6beca0504daf78">_ArraySubtract1D_</a>(bounds,boundary-&gt;<a class="code" href="a00155.html#a7602de5ebb1b59ec35217e78a35a531e">ie</a>,boundary-&gt;<a class="code" href="a00155.html#a481013ba007a99a4237cde5eeb3c9a29">is</a>,ndims);</div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;    <a class="code" href="a00187.html#a2b2826031c0cd92495ab351d3e599fc5">_ArraySetValue_</a>(indexb,ndims,0); </div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;    <span class="keywordtype">int</span> done = 0;</div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;    <span class="keywordflow">while</span> (!done) {</div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;      <span class="keywordtype">int</span> i = indexb[dim] + boundary-&gt;<a class="code" href="a00155.html#a481013ba007a99a4237cde5eeb3c9a29">is</a>[dim];</div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;      <span class="keywordtype">double</span> x, xstart, xend;</div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;      <a class="code" href="a00188.html#a9aa9bad8531d6733731a850ccc471a42">_GetCoordinate_</a>(dim,i,size,ghosts,grid,x);</div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;      xstart = xmin[dim];</div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;      xend   = xmax[dim];</div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;      <span class="comment">/* calculate sigma */</span></div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;      <span class="keywordtype">double</span> sigma;</div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;      <span class="keywordflow">if</span> (face &gt; 0) sigma = (x - xstart) / (xend - xstart);</div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;      <span class="keywordflow">else</span>          sigma = (x - xend  ) / (xstart - xend);</div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;      <span class="comment">/* add to the source term */</span></div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;      <span class="keywordtype">int</span> p; <a class="code" href="a00187.html#a0739cb538f4d301fad3b45059ddd0738">_ArrayIndex1DWO_</a>(ndims,size,indexb,boundary-&gt;<a class="code" href="a00155.html#a481013ba007a99a4237cde5eeb3c9a29">is</a>,ghosts,p);</div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;      <span class="keywordflow">for</span> (v=0; v&lt;nvars; v++) source[nvars*p+v] -= (sigma * (u[nvars*p+v]-uref[v]));</div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;      <a class="code" href="a00187.html#ac5ec1371623f11d03b0f42adaa24acbc">_ArrayIncrementIndex_</a>(ndims,bounds,indexb,done);</div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;    }</div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;  }</div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;  <span class="keywordflow">return</span>(0);</div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;}</div>
<div class="ttc" id="a00155_html_a1e51e79041d5a3dddffb503277703568"><div class="ttname"><a href="a00155.html#a1e51e79041d5a3dddffb503277703568">DomainBoundary::xmin</a></div><div class="ttdeci">double * xmin</div><div class="ttdef"><b>Definition:</b> <a href="a00189_source.html#l00077">boundaryconditions.h:77</a></div></div>
<div class="ttc" id="a00155_html_a70b5e28b5bc3d1b63a7435c5fe50b837"><div class="ttname"><a href="a00155.html#a70b5e28b5bc3d1b63a7435c5fe50b837">DomainBoundary::dim</a></div><div class="ttdeci">int dim</div><div class="ttdef"><b>Definition:</b> <a href="a00189_source.html#l00073">boundaryconditions.h:73</a></div></div>
<div class="ttc" id="a00187_html_a0739cb538f4d301fad3b45059ddd0738"><div class="ttname"><a href="a00187.html#a0739cb538f4d301fad3b45059ddd0738">_ArrayIndex1DWO_</a></div><div class="ttdeci">#define _ArrayIndex1DWO_(N, imax, i, offset, ghost, index)</div><div class="ttdef"><b>Definition:</b> <a href="a00187_source.html#l00082">arrayfunctions.h:82</a></div></div>
<div class="ttc" id="a00155_html_a481013ba007a99a4237cde5eeb3c9a29"><div class="ttname"><a href="a00155.html#a481013ba007a99a4237cde5eeb3c9a29">DomainBoundary::is</a></div><div class="ttdeci">int * is</div><div class="ttdef"><b>Definition:</b> <a href="a00189_source.html#l00082">boundaryconditions.h:82</a></div></div>
<div class="ttc" id="a00155_html"><div class="ttname"><a href="a00155.html">DomainBoundary</a></div><div class="ttdoc">Structure containing the variables and function pointers defining a boundary. </div><div class="ttdef"><b>Definition:</b> <a href="a00189_source.html#l00068">boundaryconditions.h:68</a></div></div>
<div class="ttc" id="a00187_html_ab49d0f261ea751a17d6beca0504daf78"><div class="ttname"><a href="a00187.html#ab49d0f261ea751a17d6beca0504daf78">_ArraySubtract1D_</a></div><div class="ttdeci">#define _ArraySubtract1D_(x, a, b, size)</div><div class="ttdef"><b>Definition:</b> <a href="a00187_source.html#l00200">arrayfunctions.h:200</a></div></div>
<div class="ttc" id="a00187_html_ac5ec1371623f11d03b0f42adaa24acbc"><div class="ttname"><a href="a00187.html#ac5ec1371623f11d03b0f42adaa24acbc">_ArrayIncrementIndex_</a></div><div class="ttdeci">#define _ArrayIncrementIndex_(N, imax, i, done)</div><div class="ttdef"><b>Definition:</b> <a href="a00187_source.html#l00125">arrayfunctions.h:125</a></div></div>
<div class="ttc" id="a00155_html_a7602de5ebb1b59ec35217e78a35a531e"><div class="ttname"><a href="a00155.html#a7602de5ebb1b59ec35217e78a35a531e">DomainBoundary::ie</a></div><div class="ttdeci">int * ie</div><div class="ttdef"><b>Definition:</b> <a href="a00189_source.html#l00082">boundaryconditions.h:82</a></div></div>
<div class="ttc" id="a00155_html_a9582c650f117a06449b5ee368b6762ef"><div class="ttname"><a href="a00155.html#a9582c650f117a06449b5ee368b6762ef">DomainBoundary::face</a></div><div class="ttdeci">int face</div><div class="ttdef"><b>Definition:</b> <a href="a00189_source.html#l00075">boundaryconditions.h:75</a></div></div>
<div class="ttc" id="a00188_html_a9aa9bad8531d6733731a850ccc471a42"><div class="ttname"><a href="a00188.html#a9aa9bad8531d6733731a850ccc471a42">_GetCoordinate_</a></div><div class="ttdeci">#define _GetCoordinate_(dir, i, dim, ghosts, x, coord)</div><div class="ttdef"><b>Definition:</b> <a href="a00188_source.html#l00027">basic.h:27</a></div></div>
<div class="ttc" id="a00187_html_a2b2826031c0cd92495ab351d3e599fc5"><div class="ttname"><a href="a00187.html#a2b2826031c0cd92495ab351d3e599fc5">_ArraySetValue_</a></div><div class="ttdeci">#define _ArraySetValue_(x, size, value)</div><div class="ttdef"><b>Definition:</b> <a href="a00187_source.html#l00168">arrayfunctions.h:168</a></div></div>
<div class="ttc" id="a00155_html_a2eec7e4ee612d5edc985ba81453346e1"><div class="ttname"><a href="a00155.html#a2eec7e4ee612d5edc985ba81453346e1">DomainBoundary::on_this_proc</a></div><div class="ttdeci">int on_this_proc</div><div class="ttdef"><b>Definition:</b> <a href="a00189_source.html#l00081">boundaryconditions.h:81</a></div></div>
<div class="ttc" id="a00155_html_a7ea24a733beddff902459a07bf91ca67"><div class="ttname"><a href="a00155.html#a7ea24a733beddff902459a07bf91ca67">DomainBoundary::xmax</a></div><div class="ttdeci">double * xmax</div><div class="ttdef"><b>Definition:</b> <a href="a00189_source.html#l00079">boundaryconditions.h:79</a></div></div>
<div class="ttc" id="a00155_html_af7eeb4ff3f7c8bc22e0786ddbe62f16d"><div class="ttname"><a href="a00155.html#af7eeb4ff3f7c8bc22e0786ddbe62f16d">DomainBoundary::SpongeValue</a></div><div class="ttdeci">double * SpongeValue</div><div class="ttdef"><b>Definition:</b> <a href="a00189_source.html#l00088">boundaryconditions.h:88</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a88f1e5079fc6c8b753e77cc85c21cb5b"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int BCSpongeUDummy </td>
          <td>(</td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>b</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>m</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>ndims</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>nvars</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>size</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>ghosts</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>phi</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>waqt</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>dummy function that get called during applying BCs - they don't do anything</p>
<p>Dummy function to ensure consistency with the overall boundary condition implementation. The actual sponge boundary condition is implemented by <a class="el" href="a00189.html#a49368bf44f300143cd9ec18d10b37a23">BCSpongeSource()</a> </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">b</td><td>Boundary object of type <a class="el" href="a00155.html" title="Structure containing the variables and function pointers defining a boundary. ">DomainBoundary</a> </td></tr>
    <tr><td class="paramname">m</td><td>MPI object of type <a class="el" href="a00167.html#a00588" title="Structure of MPI-related variables. ">MPIVariables</a> </td></tr>
    <tr><td class="paramname">ndims</td><td>Number of spatial dimensions </td></tr>
    <tr><td class="paramname">nvars</td><td>Number of variables/DoFs per grid point </td></tr>
    <tr><td class="paramname">size</td><td>Integer array with the number of grid points in each spatial dimension </td></tr>
    <tr><td class="paramname">ghosts</td><td>Number of ghost points </td></tr>
    <tr><td class="paramname">phi</td><td>The solution array on which to apply the boundary condition </td></tr>
    <tr><td class="paramname">waqt</td><td>Current solution time </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="a00235_source.html#l00073">73</a> of file <a class="el" href="a00235_source.html">BCSponge.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;{</div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;  <span class="keywordflow">return</span>(0);</div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a0feed0764d1dafc0d4313a9b12cadd9d"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int BCReadTemperatureData </td>
          <td>(</td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>b</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>m</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>ndims</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>nvars</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>DomainSize</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Function to read in unsteady temperature data for thermal slip wall BC (<a class="el" href="a00189.html#a30077b675efd008f1cd3bc0e1f0692a3">BCThermalSlipWallU()</a>)</p>
<p>Read in the temperature data: The temperature data needs to be provided as a binary file. For parallel runs, only rank 0 reads the file, and then distributes the data to the other processors. <br/>
<br/>
This function needs to be better documented. </p>

<p>Definition at line <a class="el" href="a00229_source.html#l00146">146</a> of file <a class="el" href="a00229_source.html">BCIO.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;{</div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;  <a class="code" href="a00155.html">DomainBoundary</a> *boundary = (<a class="code" href="a00155.html">DomainBoundary</a>*) b;</div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;  <a class="code" href="a00167.html#a00588">MPIVariables</a>   *mpi      = (<a class="code" href="a00167.html#a00588">MPIVariables</a>*)   m;</div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;</div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;  <span class="keywordtype">char</span>    *filename = boundary-&gt;<a class="code" href="a00155.html#aad72794e4e965697c3827e2f236b6934">UnsteadyTemperatureFilename</a>;</div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;  <span class="keywordtype">int</span>     *temperature_field_size  = NULL;</div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;  <span class="keywordtype">double</span>  *time_level_data         = NULL;</div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;  <span class="keywordtype">double</span>  *temperature_field_data  = NULL;</div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;  <span class="keywordtype">double</span>  *time_buffer = NULL;</div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;  <span class="keywordtype">double</span>  *data_buffer = NULL;</div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;  </div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;  <span class="keywordtype">int</span> dim = boundary-&gt;<a class="code" href="a00155.html#a70b5e28b5bc3d1b63a7435c5fe50b837">dim</a>;</div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;  <span class="keywordtype">int</span> face= boundary-&gt;<a class="code" href="a00155.html#a9582c650f117a06449b5ee368b6762ef">face</a>;</div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;  <span class="keywordtype">int</span> d;</div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;</div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;  <span class="keywordflow">if</span> (!mpi-&gt;<a class="code" href="a00167.html#a6cfd95afd0afebd625b889fb6e58371c">rank</a>) {</div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;</div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;    printf(<span class="stringliteral">&quot;Reading boundary temperature data from %s.\n&quot;</span>,filename);</div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;</div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;    FILE *in;</div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;    <span class="keywordtype">int</span>  ferr;</div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;</div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;    <span class="comment">/* calculate the number of processors that sit on this temperature boundary */</span></div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;    <span class="keywordtype">int</span> nproc = 1;</div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;    <span class="keywordflow">for</span> (d=0; d&lt;ndims; d++) nproc *= mpi-&gt;<a class="code" href="a00167.html#a0be0f30a83bc3f3d9f6ee3a36bbf2716">iproc</a>[d]; nproc /= mpi-&gt;<a class="code" href="a00167.html#a0be0f30a83bc3f3d9f6ee3a36bbf2716">iproc</a>[dim];</div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;</div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;    in = fopen(filename,<span class="stringliteral">&quot;rb&quot;</span>);</div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;    <span class="keywordflow">if</span> (!in) {</div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;      fprintf(stderr,<span class="stringliteral">&quot;Error in BCReadTemperatureData(): cannot open boundary temperature data file %s.\n&quot;</span>,filename);</div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;      <span class="keywordflow">return</span>(1);</div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;    }</div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;</div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;    <span class="keywordtype">int</span> count = 0;</div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;    <span class="keywordflow">while</span> ((!feof(in)) &amp;&amp; (count &lt; nproc)) {</div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;</div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;      <span class="keywordtype">int</span> rank[ndims], size[ndims];</div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;      ferr = fread(rank,<span class="keyword">sizeof</span>(<span class="keywordtype">int</span>),ndims,in);</div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;      <span class="keywordflow">if</span> (ferr != ndims) {</div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;        fprintf(stderr,<span class="stringliteral">&quot;Error in BCReadTemperatureData(): Error (1) in file reading, count %d.\n&quot;</span>,count);</div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;        <span class="keywordflow">return</span>(1);</div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;      }</div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;      <span class="keywordflow">if</span> (rank[dim] != (face &gt; 0 ? 0 : mpi-&gt;<a class="code" href="a00167.html#a0be0f30a83bc3f3d9f6ee3a36bbf2716">iproc</a>[dim]-1) ) {</div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;        fprintf(stderr,<span class="stringliteral">&quot;Error in BCReadTemperatureData(): Error (2) in file reading, count %d.\n&quot;</span>,count);</div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;        <span class="keywordflow">return</span>(1);</div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;      }</div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;      ferr = fread(size,<span class="keyword">sizeof</span>(<span class="keywordtype">int</span>),ndims,in);</div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;      <span class="keywordflow">if</span> (ferr != ndims) {</div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;        fprintf(stderr,<span class="stringliteral">&quot;Error in BCReadTemperatureData(): Error (3) in file reading, count %d.\n&quot;</span>,count);</div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;        <span class="keywordflow">return</span>(1);</div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;      }</div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;</div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;      <span class="keywordtype">int</span> n_data = size[dim]; <span class="comment">/* number of time levels for which temperature data is provided */</span></div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;      time_buffer = (<span class="keywordtype">double</span>*) calloc (n_data,<span class="keyword">sizeof</span>(<span class="keywordtype">double</span>));</div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;      ferr = fread(time_buffer,<span class="keyword">sizeof</span>(<span class="keywordtype">double</span>),n_data,in);</div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;      <span class="keywordflow">if</span> (ferr != n_data) {</div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;        fprintf(stderr,<span class="stringliteral">&quot;Error in BCReadTemperatureData(): Error (5) in file reading, count %d.\n&quot;</span>,count);</div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;        <span class="keywordflow">return</span>(1);</div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;      }</div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;</div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;      <span class="keywordtype">int</span> data_size = 1;</div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;      <span class="keywordflow">for</span> (d=0; d&lt;ndims; d++) data_size *= size[d];</div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;      data_buffer = (<span class="keywordtype">double</span>*) calloc (data_size,<span class="keyword">sizeof</span>(<span class="keywordtype">double</span>));</div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;      ferr = fread(data_buffer,<span class="keyword">sizeof</span>(<span class="keywordtype">double</span>),data_size,in);</div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;      <span class="keywordflow">if</span> (ferr != data_size) {</div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;        fprintf(stderr,<span class="stringliteral">&quot;Error in BCReadTemperatureData(): Error (6) in file reading, count %d.\n&quot;</span>,count);</div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;        <span class="keywordflow">return</span>(1);</div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;      }</div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;</div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;      <span class="keywordtype">int</span> rank1D = <a class="code" href="a00204.html#a36e2be86c7dc0d9dd088ed2f5842f556">MPIRank1D</a>(ndims,mpi-&gt;<a class="code" href="a00167.html#a0be0f30a83bc3f3d9f6ee3a36bbf2716">iproc</a>,rank);</div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;</div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;      <span class="keywordflow">if</span> (!rank1D) {</div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;</div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;        <span class="keywordtype">int</span> index[ndims];</div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;</div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;        temperature_field_size = (<span class="keywordtype">int</span>*) calloc (ndims, <span class="keyword">sizeof</span>(<span class="keywordtype">int</span>));</div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;        <a class="code" href="a00187.html#a89e8330d9e06dd0666c50833628a125c">_ArrayCopy1D_</a>(size,temperature_field_size,ndims);</div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;</div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;        time_level_data = (<span class="keywordtype">double</span>*) calloc (size[dim], <span class="keyword">sizeof</span>(<span class="keywordtype">double</span>));</div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;        <a class="code" href="a00187.html#a89e8330d9e06dd0666c50833628a125c">_ArrayCopy1D_</a>(time_buffer,time_level_data,size[dim]);</div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;</div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;        temperature_field_data = (<span class="keywordtype">double</span>*) calloc (data_size, <span class="keyword">sizeof</span>(<span class="keywordtype">double</span>));</div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;        <a class="code" href="a00187.html#ac4ae1109cf287763cef63cc38d52589f">ArrayCopynD</a>(ndims,data_buffer,temperature_field_data,size,0,0,index,1);</div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;</div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;      } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;</div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;<span class="preprocessor">#ifndef serial</span></div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;<span class="preprocessor"></span>        MPI_Request req[3] = {MPI_REQUEST_NULL,MPI_REQUEST_NULL,MPI_REQUEST_NULL};</div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;        MPI_Isend(size,ndims,MPI_INT,rank1D,2152,mpi-&gt;<a class="code" href="a00167.html#adad7a6f85831f3ac84d854b6c80aef43">world</a>,&amp;req[0]);</div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;        MPI_Isend(time_buffer,size[dim],MPI_DOUBLE,rank1D,2154,mpi-&gt;<a class="code" href="a00167.html#adad7a6f85831f3ac84d854b6c80aef43">world</a>,&amp;req[2]);</div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;        MPI_Isend(data_buffer,data_size,MPI_DOUBLE,rank1D,2153,mpi-&gt;<a class="code" href="a00167.html#adad7a6f85831f3ac84d854b6c80aef43">world</a>,&amp;req[1]);</div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;        MPI_Waitall(3,&amp;req[0],MPI_STATUS_IGNORE);</div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;<span class="preprocessor">#else</span></div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;<span class="preprocessor"></span>        fprintf(stderr,<span class="stringliteral">&quot;Error in BCReadTemperatureData(): This is a serial run. Invalid (non-zero) rank read.\n&quot;</span>);</div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;<span class="preprocessor"></span></div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;      }</div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;</div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;      free(time_buffer);</div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;      free(data_buffer);</div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;      count++;</div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;    }</div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;</div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;    <span class="keywordflow">if</span> (count &lt; nproc) {</div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;      fprintf(stderr,<span class="stringliteral">&quot;Error in BCReadTemperatureData(): missing data in unsteady boundary data file %s.\n&quot;</span>,filename);</div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;      fprintf(stderr,<span class="stringliteral">&quot;Error in BCReadTemperatureData(): should contain data for %d processors, &quot;</span>, nproc);</div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;      fprintf(stderr,<span class="stringliteral">&quot;Error in BCReadTemperatureData(): but contains data for %d processors!\n&quot;</span>, count);</div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;      <span class="keywordflow">return</span>(1);</div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;    }</div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;</div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;    fclose(in);</div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;</div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;  } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;</div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;<span class="preprocessor">#ifndef serial</span></div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;<span class="preprocessor"></span>    <span class="keywordflow">if</span> (mpi-&gt;<a class="code" href="a00167.html#aa3c28612a64b8a97bde66b720e15c700">ip</a>[dim] == (face &gt; 0 ? 0 : mpi-&gt;<a class="code" href="a00167.html#a0be0f30a83bc3f3d9f6ee3a36bbf2716">iproc</a>[dim]-1) ) {</div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;</div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;      MPI_Request req = MPI_REQUEST_NULL;</div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;</div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;      temperature_field_size = (<span class="keywordtype">int</span>*) calloc (ndims,<span class="keyword">sizeof</span>(<span class="keywordtype">int</span>));</div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;      MPI_Irecv(temperature_field_size,ndims,MPI_INT,0,2152,mpi-&gt;<a class="code" href="a00167.html#adad7a6f85831f3ac84d854b6c80aef43">world</a>,&amp;req);</div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;      MPI_Wait(&amp;req,MPI_STATUS_IGNORE);</div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;</div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;      <span class="keywordtype">int</span> flag = 1;</div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;      <span class="keywordflow">for</span> (d=0; d&lt;ndims; d++) <span class="keywordflow">if</span> ((d != dim) &amp;&amp; (temperature_field_size[d] != DomainSize[d])) flag = 0;</div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;      <span class="keywordflow">if</span> (!flag) {</div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;        fprintf(stderr,<span class="stringliteral">&quot;Error in BCReadTemperatureData(): Error (4) (dimension mismatch) in file reading, rank %d.\n&quot;</span>,mpi-&gt;<a class="code" href="a00167.html#a6cfd95afd0afebd625b889fb6e58371c">rank</a>);</div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;        <span class="keywordflow">return</span>(1);</div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;      }</div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;</div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;      time_level_data = (<span class="keywordtype">double</span>*) calloc (temperature_field_size[dim],<span class="keyword">sizeof</span>(<span class="keywordtype">double</span>));</div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;      MPI_Irecv(time_level_data, temperature_field_size[dim], MPI_DOUBLE,0,2154,mpi-&gt;<a class="code" href="a00167.html#adad7a6f85831f3ac84d854b6c80aef43">world</a>,&amp;req);</div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;      MPI_Wait(&amp;req,MPI_STATUS_IGNORE);</div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;</div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;      <span class="keywordtype">int</span> data_size = 1;</div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;      <span class="keywordflow">for</span> (d=0; d&lt;ndims; d++) data_size *= temperature_field_size[d];</div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;      temperature_field_data = (<span class="keywordtype">double</span>*) calloc (data_size,<span class="keyword">sizeof</span>(<span class="keywordtype">double</span>));</div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;      MPI_Irecv(temperature_field_data,data_size,MPI_DOUBLE,0,2153,mpi-&gt;<a class="code" href="a00167.html#adad7a6f85831f3ac84d854b6c80aef43">world</a>,&amp;req);</div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;      MPI_Wait(&amp;req,MPI_STATUS_IGNORE);</div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;</div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;    }</div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;<span class="preprocessor">#else</span></div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;<span class="preprocessor"></span>    fprintf(stderr,<span class="stringliteral">&quot;Error in BCReadTemperatureData(): Serial code should not be here!.\n&quot;</span>);</div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;<span class="preprocessor"></span></div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;  }</div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;  </div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;  boundary-&gt;<a class="code" href="a00155.html#a6f46fcd429eeb105637c0e14d54d79e7">UnsteadyTemperatureSize</a> = temperature_field_size;</div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;  boundary-&gt;<a class="code" href="a00155.html#af135619149474c2de735f5482e4d0a0e">UnsteadyTimeLevels</a>      = time_level_data;</div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;  boundary-&gt;<a class="code" href="a00155.html#a23dab9053d40cce5ba488290fb1b41c3">UnsteadyTemperatureData</a> = temperature_field_data;</div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;</div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;  <span class="keywordflow">return</span>(0);</div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;}</div>
<div class="ttc" id="a00167_html_a0be0f30a83bc3f3d9f6ee3a36bbf2716"><div class="ttname"><a href="a00167.html#a0be0f30a83bc3f3d9f6ee3a36bbf2716">MPIVariables::iproc</a></div><div class="ttdeci">int * iproc</div><div class="ttdef"><b>Definition:</b> <a href="a00167_source.html#l00027">mpivars_struct.h:27</a></div></div>
<div class="ttc" id="a00167_html_adad7a6f85831f3ac84d854b6c80aef43"><div class="ttname"><a href="a00167.html#adad7a6f85831f3ac84d854b6c80aef43">MPIVariables::world</a></div><div class="ttdeci">MPI_Comm world</div><div class="ttdef"><b>Definition:</b> <a href="a00167_source.html#l00037">mpivars_struct.h:37</a></div></div>
<div class="ttc" id="a00155_html_a70b5e28b5bc3d1b63a7435c5fe50b837"><div class="ttname"><a href="a00155.html#a70b5e28b5bc3d1b63a7435c5fe50b837">DomainBoundary::dim</a></div><div class="ttdeci">int dim</div><div class="ttdef"><b>Definition:</b> <a href="a00189_source.html#l00073">boundaryconditions.h:73</a></div></div>
<div class="ttc" id="a00204_html_a36e2be86c7dc0d9dd088ed2f5842f556"><div class="ttname"><a href="a00204.html#a36e2be86c7dc0d9dd088ed2f5842f556">MPIRank1D</a></div><div class="ttdeci">int MPIRank1D(int, int *, int *)</div><div class="ttdef"><b>Definition:</b> <a href="a00338_source.html#l00026">MPIRank1D.c:26</a></div></div>
<div class="ttc" id="a00155_html"><div class="ttname"><a href="a00155.html">DomainBoundary</a></div><div class="ttdoc">Structure containing the variables and function pointers defining a boundary. </div><div class="ttdef"><b>Definition:</b> <a href="a00189_source.html#l00068">boundaryconditions.h:68</a></div></div>
<div class="ttc" id="a00155_html_af135619149474c2de735f5482e4d0a0e"><div class="ttname"><a href="a00155.html#af135619149474c2de735f5482e4d0a0e">DomainBoundary::UnsteadyTimeLevels</a></div><div class="ttdeci">double * UnsteadyTimeLevels</div><div class="ttdef"><b>Definition:</b> <a href="a00189_source.html#l00103">boundaryconditions.h:103</a></div></div>
<div class="ttc" id="a00167_html_a00588"><div class="ttname"><a href="a00167.html#a00588">MPIVariables</a></div><div class="ttdoc">Structure of MPI-related variables. </div><div class="ttdef"><b>Definition:</b> <a href="a00167_source.html#l00024">mpivars_struct.h:24</a></div></div>
<div class="ttc" id="a00155_html_a9582c650f117a06449b5ee368b6762ef"><div class="ttname"><a href="a00155.html#a9582c650f117a06449b5ee368b6762ef">DomainBoundary::face</a></div><div class="ttdeci">int face</div><div class="ttdef"><b>Definition:</b> <a href="a00189_source.html#l00075">boundaryconditions.h:75</a></div></div>
<div class="ttc" id="a00155_html_a6f46fcd429eeb105637c0e14d54d79e7"><div class="ttname"><a href="a00155.html#a6f46fcd429eeb105637c0e14d54d79e7">DomainBoundary::UnsteadyTemperatureSize</a></div><div class="ttdeci">int * UnsteadyTemperatureSize</div><div class="ttdef"><b>Definition:</b> <a href="a00189_source.html#l00102">boundaryconditions.h:102</a></div></div>
<div class="ttc" id="a00155_html_aad72794e4e965697c3827e2f236b6934"><div class="ttname"><a href="a00155.html#aad72794e4e965697c3827e2f236b6934">DomainBoundary::UnsteadyTemperatureFilename</a></div><div class="ttdeci">char UnsteadyTemperatureFilename[_MAX_STRING_SIZE_]</div><div class="ttdef"><b>Definition:</b> <a href="a00189_source.html#l00106">boundaryconditions.h:106</a></div></div>
<div class="ttc" id="a00167_html_a6cfd95afd0afebd625b889fb6e58371c"><div class="ttname"><a href="a00167.html#a6cfd95afd0afebd625b889fb6e58371c">MPIVariables::rank</a></div><div class="ttdeci">int rank</div><div class="ttdef"><b>Definition:</b> <a href="a00167_source.html#l00025">mpivars_struct.h:25</a></div></div>
<div class="ttc" id="a00155_html_a23dab9053d40cce5ba488290fb1b41c3"><div class="ttname"><a href="a00155.html#a23dab9053d40cce5ba488290fb1b41c3">DomainBoundary::UnsteadyTemperatureData</a></div><div class="ttdeci">double * UnsteadyTemperatureData</div><div class="ttdef"><b>Definition:</b> <a href="a00189_source.html#l00104">boundaryconditions.h:104</a></div></div>
<div class="ttc" id="a00167_html_aa3c28612a64b8a97bde66b720e15c700"><div class="ttname"><a href="a00167.html#aa3c28612a64b8a97bde66b720e15c700">MPIVariables::ip</a></div><div class="ttdeci">int * ip</div><div class="ttdef"><b>Definition:</b> <a href="a00167_source.html#l00028">mpivars_struct.h:28</a></div></div>
<div class="ttc" id="a00187_html_a89e8330d9e06dd0666c50833628a125c"><div class="ttname"><a href="a00187.html#a89e8330d9e06dd0666c50833628a125c">_ArrayCopy1D_</a></div><div class="ttdeci">#define _ArrayCopy1D_(x, y, size)</div><div class="ttdef"><b>Definition:</b> <a href="a00187_source.html#l00318">arrayfunctions.h:318</a></div></div>
<div class="ttc" id="a00187_html_ac4ae1109cf287763cef63cc38d52589f"><div class="ttname"><a href="a00187.html#ac4ae1109cf287763cef63cc38d52589f">ArrayCopynD</a></div><div class="ttdeci">INLINE int ArrayCopynD(int, double *, double *, int *, int, int, int *, int)</div><div class="ttdef"><b>Definition:</b> <a href="a00187_source.html#l00407">arrayfunctions.h:407</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a6cc369236fbfe94bff52c55175cfaba7"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int BCReadTurbulentInflowData </td>
          <td>(</td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>b</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>m</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>ndims</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>nvars</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>DomainSize</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Function to read in unsteady boundary data for turbulent inflow</p>
<p>Read in the turbulent inflow data: The turbulent inflow data needs to be provided as a binary file. For parallel runs, only rank 0 reads the file, and then distributes the data to the other processors. <br/>
<br/>
This function needs to be better documented. </p>

<p>Definition at line <a class="el" href="a00229_source.html#l00019">19</a> of file <a class="el" href="a00229_source.html">BCIO.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;{</div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;  <a class="code" href="a00155.html">DomainBoundary</a> *boundary = (<a class="code" href="a00155.html">DomainBoundary</a>*) b;</div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;  <a class="code" href="a00167.html#a00588">MPIVariables</a>   *mpi      = (<a class="code" href="a00167.html#a00588">MPIVariables</a>*)   m;</div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;</div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;  <span class="keywordtype">char</span>    *filename     = boundary-&gt;<a class="code" href="a00155.html#a81c76294457e5d469798d16ab027c9a2">UnsteadyDirichletFilename</a>;</div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;  <span class="keywordtype">int</span>     *inflow_size  = NULL;</div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;  <span class="keywordtype">double</span>  *inflow_data  = NULL;</div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;  <span class="keywordtype">double</span>  *buffer       = NULL;</div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;  </div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;  <span class="keywordtype">int</span> dim = boundary-&gt;<a class="code" href="a00155.html#a70b5e28b5bc3d1b63a7435c5fe50b837">dim</a>;</div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;  <span class="keywordtype">int</span> face= boundary-&gt;<a class="code" href="a00155.html#a9582c650f117a06449b5ee368b6762ef">face</a>;</div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;  <span class="keywordtype">int</span> d;</div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;</div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;  <span class="keywordflow">if</span> (!mpi-&gt;<a class="code" href="a00167.html#a6cfd95afd0afebd625b889fb6e58371c">rank</a>) {</div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;</div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;    printf(<span class="stringliteral">&quot;Reading turbulent inflow boundary data from %s.\n&quot;</span>,filename);</div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;</div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;    FILE *in;</div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;    <span class="keywordtype">int</span>  ferr;</div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;</div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;    <span class="comment">/* calculate the number of processors that sit on unsteady boundary */</span></div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;    <span class="keywordtype">int</span> nproc = 1;</div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;    <span class="keywordflow">for</span> (d=0; d&lt;ndims; d++) nproc *= mpi-&gt;<a class="code" href="a00167.html#a0be0f30a83bc3f3d9f6ee3a36bbf2716">iproc</a>[d]; nproc /= mpi-&gt;<a class="code" href="a00167.html#a0be0f30a83bc3f3d9f6ee3a36bbf2716">iproc</a>[dim];</div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;</div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;    in = fopen(filename,<span class="stringliteral">&quot;rb&quot;</span>);</div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;    <span class="keywordflow">if</span> (!in) {</div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;      fprintf(stderr,<span class="stringliteral">&quot;Error in BCReadTurbulentInflowData(): cannot open unsteady boundary data file %s.\n&quot;</span>,filename);</div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;      <span class="keywordflow">return</span>(1);</div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;    }</div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;    <span class="keywordtype">int</span> count = 0;</div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;    <span class="keywordflow">while</span> ((!feof(in)) &amp;&amp; (count &lt; nproc)) {</div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;      <span class="keywordtype">int</span> rank[ndims], size[ndims];</div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;      ferr = fread(rank,<span class="keyword">sizeof</span>(<span class="keywordtype">int</span>),ndims,in);</div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;      <span class="keywordflow">if</span> (ferr != ndims) {</div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;        fprintf(stderr,<span class="stringliteral">&quot;Error in BCReadTurbulentInflowData(): Error (1) in file reading, count %d.\n&quot;</span>,count);</div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;        <span class="keywordflow">return</span>(1);</div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;      }</div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;      <span class="keywordflow">if</span> (rank[dim] != (face &gt; 0 ? 0 : mpi-&gt;<a class="code" href="a00167.html#a0be0f30a83bc3f3d9f6ee3a36bbf2716">iproc</a>[dim]-1) ) {</div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;        fprintf(stderr,<span class="stringliteral">&quot;Error in BCReadTurbulentInflowData(): Error (2) in file reading, count %d.\n&quot;</span>,count);</div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;        <span class="keywordflow">return</span>(1);</div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;      }</div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;      ferr = fread(size,<span class="keyword">sizeof</span>(<span class="keywordtype">int</span>),ndims,in);</div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;      <span class="keywordflow">if</span> (ferr != ndims) {</div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;        fprintf(stderr,<span class="stringliteral">&quot;Error in BCReadTurbulentInflowData(): Error (3) in file reading, count %d.\n&quot;</span>,count);</div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;        <span class="keywordflow">return</span>(1);</div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;      }</div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;      <span class="keywordtype">int</span> flag = 1;</div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;      <span class="keywordflow">for</span> (d=0; d&lt;ndims; d++) <span class="keywordflow">if</span> ((d != dim) &amp;&amp; (size[d] != DomainSize[d])) flag = 0;</div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;      <span class="keywordflow">if</span> (!flag) {</div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;        fprintf(stderr,<span class="stringliteral">&quot;Error in BCReadTurbulentInflowData(): Error (4) (dimension mismatch) in file reading, count %d.\n&quot;</span>,count);</div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;        <span class="keywordflow">return</span>(1);</div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;      }</div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;</div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;      <span class="keywordtype">int</span> data_size = nvars;</div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;      <span class="keywordflow">for</span> (d=0; d&lt;ndims; d++) data_size *= size[d];</div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;      buffer = (<span class="keywordtype">double</span>*) calloc (data_size,<span class="keyword">sizeof</span>(<span class="keywordtype">double</span>));</div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;      ferr = fread(buffer,<span class="keyword">sizeof</span>(<span class="keywordtype">double</span>),data_size,in);</div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;      <span class="keywordflow">if</span> (ferr != data_size) {</div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;        fprintf(stderr,<span class="stringliteral">&quot;Error in BCReadTurbulentInflowData(): Error (6) in file reading, count %d.\n&quot;</span>,count);</div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;        <span class="keywordflow">return</span>(1);</div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;      }</div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;</div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;      <span class="keywordtype">int</span> rank1D = <a class="code" href="a00204.html#a36e2be86c7dc0d9dd088ed2f5842f556">MPIRank1D</a>(ndims,mpi-&gt;<a class="code" href="a00167.html#a0be0f30a83bc3f3d9f6ee3a36bbf2716">iproc</a>,rank);</div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;</div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;      <span class="keywordflow">if</span> (!rank1D) {</div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;</div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;        <span class="keywordtype">int</span> index[ndims];</div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;        inflow_size = (<span class="keywordtype">int</span>*) calloc (ndims, <span class="keyword">sizeof</span>(<span class="keywordtype">int</span>));</div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;        <a class="code" href="a00187.html#a89e8330d9e06dd0666c50833628a125c">_ArrayCopy1D_</a>(size,inflow_size,ndims);</div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;        inflow_data = (<span class="keywordtype">double</span>*) calloc (data_size, <span class="keyword">sizeof</span>(<span class="keywordtype">double</span>));</div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;        <a class="code" href="a00187.html#ac4ae1109cf287763cef63cc38d52589f">ArrayCopynD</a>(ndims,buffer,inflow_data,size,0,0,index,nvars);</div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;</div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;      } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;<span class="preprocessor">#ifndef serial</span></div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;<span class="preprocessor"></span>        MPI_Request req[2] = {MPI_REQUEST_NULL,MPI_REQUEST_NULL};</div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;        MPI_Isend(size,ndims,MPI_INT,rank1D,2152,mpi-&gt;<a class="code" href="a00167.html#adad7a6f85831f3ac84d854b6c80aef43">world</a>,&amp;req[0]);</div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;        MPI_Isend(buffer,data_size,MPI_DOUBLE,rank1D,2153,mpi-&gt;<a class="code" href="a00167.html#adad7a6f85831f3ac84d854b6c80aef43">world</a>,&amp;req[1]);</div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;        MPI_Waitall(2,&amp;req[0],MPI_STATUS_IGNORE);</div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;<span class="preprocessor">#else</span></div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;<span class="preprocessor"></span>        fprintf(stderr,<span class="stringliteral">&quot;Error in BCReadTurbulentInflowData(): This is a serial run. Invalid (non-zero) rank read.\n&quot;</span>);</div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;<span class="preprocessor"></span>      }</div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;</div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;      free(buffer);</div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;      count++;</div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;    }</div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;</div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;    <span class="keywordflow">if</span> (count &lt; nproc) {</div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;      fprintf(stderr,<span class="stringliteral">&quot;Error in BCReadTurbulentInflowData(): missing data in unsteady boundary data file %s.\n&quot;</span>,filename);</div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;      fprintf(stderr,<span class="stringliteral">&quot;Error in BCReadTurbulentInflowData(): should contain data for %d processors, &quot;</span>, nproc);</div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;      fprintf(stderr,<span class="stringliteral">&quot;Error in BCReadTurbulentInflowData(): but contains data for %d processors!\n&quot;</span>, count);</div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;      <span class="keywordflow">return</span>(1);</div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;    }</div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;</div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;    fclose(in);</div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;</div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;  } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;<span class="preprocessor">#ifndef serial</span></div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;<span class="preprocessor"></span>    <span class="keywordflow">if</span> (mpi-&gt;<a class="code" href="a00167.html#aa3c28612a64b8a97bde66b720e15c700">ip</a>[dim] == (face &gt; 0 ? 0 : mpi-&gt;<a class="code" href="a00167.html#a0be0f30a83bc3f3d9f6ee3a36bbf2716">iproc</a>[dim]-1) ) {</div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;      MPI_Request req = MPI_REQUEST_NULL;</div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;      inflow_size = (<span class="keywordtype">int</span>*) calloc (ndims,<span class="keyword">sizeof</span>(<span class="keywordtype">int</span>));</div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;      MPI_Irecv(inflow_size,ndims,MPI_INT,0,2152,mpi-&gt;<a class="code" href="a00167.html#adad7a6f85831f3ac84d854b6c80aef43">world</a>,&amp;req);</div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;      MPI_Wait(&amp;req,MPI_STATUS_IGNORE);</div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;      <span class="keywordtype">int</span> data_size = nvars;</div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;      <span class="keywordflow">for</span> (d=0; d&lt;ndims; d++) data_size *= inflow_size[d];</div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;      inflow_data = (<span class="keywordtype">double</span>*) calloc (data_size,<span class="keyword">sizeof</span>(<span class="keywordtype">double</span>));</div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;      MPI_Irecv(inflow_data,data_size,MPI_DOUBLE,0,2153,mpi-&gt;<a class="code" href="a00167.html#adad7a6f85831f3ac84d854b6c80aef43">world</a>,&amp;req);</div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;      MPI_Wait(&amp;req,MPI_STATUS_IGNORE);</div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;    }</div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;<span class="preprocessor">#else</span></div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;<span class="preprocessor"></span>    fprintf(stderr,<span class="stringliteral">&quot;Error in BCReadTurbulentInflowData(): Serial code should not be here!.\n&quot;</span>);</div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;<span class="preprocessor"></span>  }</div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;  </div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;  boundary-&gt;<a class="code" href="a00155.html#ac3b478217419275ad063182f69cb543d">UnsteadyDirichletSize</a> = inflow_size;</div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;  boundary-&gt;<a class="code" href="a00155.html#a48f59fc59e6a86d0b4aad842daea9106">UnsteadyDirichletData</a> = inflow_data;</div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;</div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;  <span class="keywordflow">return</span>(0);</div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;}</div>
<div class="ttc" id="a00167_html_a0be0f30a83bc3f3d9f6ee3a36bbf2716"><div class="ttname"><a href="a00167.html#a0be0f30a83bc3f3d9f6ee3a36bbf2716">MPIVariables::iproc</a></div><div class="ttdeci">int * iproc</div><div class="ttdef"><b>Definition:</b> <a href="a00167_source.html#l00027">mpivars_struct.h:27</a></div></div>
<div class="ttc" id="a00167_html_adad7a6f85831f3ac84d854b6c80aef43"><div class="ttname"><a href="a00167.html#adad7a6f85831f3ac84d854b6c80aef43">MPIVariables::world</a></div><div class="ttdeci">MPI_Comm world</div><div class="ttdef"><b>Definition:</b> <a href="a00167_source.html#l00037">mpivars_struct.h:37</a></div></div>
<div class="ttc" id="a00155_html_a70b5e28b5bc3d1b63a7435c5fe50b837"><div class="ttname"><a href="a00155.html#a70b5e28b5bc3d1b63a7435c5fe50b837">DomainBoundary::dim</a></div><div class="ttdeci">int dim</div><div class="ttdef"><b>Definition:</b> <a href="a00189_source.html#l00073">boundaryconditions.h:73</a></div></div>
<div class="ttc" id="a00155_html_a81c76294457e5d469798d16ab027c9a2"><div class="ttname"><a href="a00155.html#a81c76294457e5d469798d16ab027c9a2">DomainBoundary::UnsteadyDirichletFilename</a></div><div class="ttdeci">char UnsteadyDirichletFilename[_MAX_STRING_SIZE_]</div><div class="ttdef"><b>Definition:</b> <a href="a00189_source.html#l00093">boundaryconditions.h:93</a></div></div>
<div class="ttc" id="a00204_html_a36e2be86c7dc0d9dd088ed2f5842f556"><div class="ttname"><a href="a00204.html#a36e2be86c7dc0d9dd088ed2f5842f556">MPIRank1D</a></div><div class="ttdeci">int MPIRank1D(int, int *, int *)</div><div class="ttdef"><b>Definition:</b> <a href="a00338_source.html#l00026">MPIRank1D.c:26</a></div></div>
<div class="ttc" id="a00155_html"><div class="ttname"><a href="a00155.html">DomainBoundary</a></div><div class="ttdoc">Structure containing the variables and function pointers defining a boundary. </div><div class="ttdef"><b>Definition:</b> <a href="a00189_source.html#l00068">boundaryconditions.h:68</a></div></div>
<div class="ttc" id="a00155_html_ac3b478217419275ad063182f69cb543d"><div class="ttname"><a href="a00155.html#ac3b478217419275ad063182f69cb543d">DomainBoundary::UnsteadyDirichletSize</a></div><div class="ttdeci">int * UnsteadyDirichletSize</div><div class="ttdef"><b>Definition:</b> <a href="a00189_source.html#l00090">boundaryconditions.h:90</a></div></div>
<div class="ttc" id="a00167_html_a00588"><div class="ttname"><a href="a00167.html#a00588">MPIVariables</a></div><div class="ttdoc">Structure of MPI-related variables. </div><div class="ttdef"><b>Definition:</b> <a href="a00167_source.html#l00024">mpivars_struct.h:24</a></div></div>
<div class="ttc" id="a00155_html_a9582c650f117a06449b5ee368b6762ef"><div class="ttname"><a href="a00155.html#a9582c650f117a06449b5ee368b6762ef">DomainBoundary::face</a></div><div class="ttdeci">int face</div><div class="ttdef"><b>Definition:</b> <a href="a00189_source.html#l00075">boundaryconditions.h:75</a></div></div>
<div class="ttc" id="a00167_html_a6cfd95afd0afebd625b889fb6e58371c"><div class="ttname"><a href="a00167.html#a6cfd95afd0afebd625b889fb6e58371c">MPIVariables::rank</a></div><div class="ttdeci">int rank</div><div class="ttdef"><b>Definition:</b> <a href="a00167_source.html#l00025">mpivars_struct.h:25</a></div></div>
<div class="ttc" id="a00167_html_aa3c28612a64b8a97bde66b720e15c700"><div class="ttname"><a href="a00167.html#aa3c28612a64b8a97bde66b720e15c700">MPIVariables::ip</a></div><div class="ttdeci">int * ip</div><div class="ttdef"><b>Definition:</b> <a href="a00167_source.html#l00028">mpivars_struct.h:28</a></div></div>
<div class="ttc" id="a00187_html_a89e8330d9e06dd0666c50833628a125c"><div class="ttname"><a href="a00187.html#a89e8330d9e06dd0666c50833628a125c">_ArrayCopy1D_</a></div><div class="ttdeci">#define _ArrayCopy1D_(x, y, size)</div><div class="ttdef"><b>Definition:</b> <a href="a00187_source.html#l00318">arrayfunctions.h:318</a></div></div>
<div class="ttc" id="a00155_html_a48f59fc59e6a86d0b4aad842daea9106"><div class="ttname"><a href="a00155.html#a48f59fc59e6a86d0b4aad842daea9106">DomainBoundary::UnsteadyDirichletData</a></div><div class="ttdeci">double * UnsteadyDirichletData</div><div class="ttdef"><b>Definition:</b> <a href="a00189_source.html#l00091">boundaryconditions.h:91</a></div></div>
<div class="ttc" id="a00187_html_ac4ae1109cf287763cef63cc38d52589f"><div class="ttname"><a href="a00187.html#ac4ae1109cf287763cef63cc38d52589f">ArrayCopynD</a></div><div class="ttdeci">INLINE int ArrayCopynD(int, double *, double *, int *, int, int, int *, int)</div><div class="ttdef"><b>Definition:</b> <a href="a00187_source.html#l00407">arrayfunctions.h:407</a></div></div>
</div><!-- fragment -->
</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- Start of StatCounter Code for Default Guide -->
<script type="text/javascript">
var sc_project=10897352; 
var sc_invisible=1; 
var sc_security="83042f57"; 
var scJsHost = (("https:" == document.location.protocol) ?
"https://secure." : "http://www.");
document.write("<sc"+"ript type='text/javascript' src='" +
scJsHost+
"statcounter.com/counter/counter.js'></"+"script>");
</script>
<noscript><div class="statcounter"><a title="website
statistics" href="http://statcounter.com/"
target="_blank"><img class="statcounter"
src="//c.statcounter.com/10897352/0/83042f57/1/"
alt="website statistics"></a></div></noscript>
<!-- End of StatCounter Code for Default Guide -->
