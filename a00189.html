<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.5"/>
<title>HyPar: include/immersedboundaries.h File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script><script src="http://cdn.mathjax.org/mathjax/latest/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="doxygen_html_style.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">HyPar
   &#160;<span id="projectnumber">1.0</span>
   </div>
   <div id="projectbrief">Finite-Difference Hyperbolic-Parabolic PDE Solver on Cartesian Grids</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.5 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Structures</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>Globals</span></a></li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('a00189.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Data Structures</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Namespaces</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(9)"><span class="SelectionMark">&#160;</span>Macros</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(10)"><span class="SelectionMark">&#160;</span>Pages</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#nested-classes">Data Structures</a> &#124;
<a href="#define-members">Macros</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">immersedboundaries.h File Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>Structures and function definitions for immersed boundaries.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &lt;<a class="el" href="a00231_source.html">basic.h</a>&gt;</code><br/>
</div>
<p><a href="a00189_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="nested-classes"></a>
Data Structures</h2></td></tr>
<tr class="memitem:a00653"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00189.html#a00653">Facet3D</a></td></tr>
<tr class="memdesc:a00653"><td class="mdescLeft">&#160;</td><td class="mdescRight">Structure defining a facet.  <a href="a00189.html#a00653">More...</a><br/></td></tr>
<tr class="separator:a00653"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a00654"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00189.html#a00654">FacetMap</a></td></tr>
<tr class="memdesc:a00654"><td class="mdescLeft">&#160;</td><td class="mdescRight">Structure defining a facet map.  <a href="a00189.html#a00654">More...</a><br/></td></tr>
<tr class="separator:a00654"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a00648"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00189.html#a00648">Body3D</a></td></tr>
<tr class="memdesc:a00648"><td class="mdescLeft">&#160;</td><td class="mdescRight">Structure defining a body.  <a href="a00189.html#a00648">More...</a><br/></td></tr>
<tr class="separator:a00648"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a00660"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00189.html#a00660">IBNode</a></td></tr>
<tr class="memdesc:a00660"><td class="mdescLeft">&#160;</td><td class="mdescRight">Structure defining an immersed boundary node.  <a href="a00189.html#a00660">More...</a><br/></td></tr>
<tr class="separator:a00660"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a00661"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00189.html#a00661">ImmersedBoundary</a></td></tr>
<tr class="memdesc:a00661"><td class="mdescLeft">&#160;</td><td class="mdescRight">Structure containing variables for immersed boundary implementation.  <a href="a00189.html#a00661">More...</a><br/></td></tr>
<tr class="separator:a00661"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:a0f59ba2c552bae2f35a03ce3964a2b4a"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00189.html#a0f59ba2c552bae2f35a03ce3964a2b4a">_IB_NDIMS_</a>&#160;&#160;&#160;3</td></tr>
<tr class="separator:a0f59ba2c552bae2f35a03ce3964a2b4a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9e114382f922a879776df13fd2f414a5"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00189.html#a9e114382f922a879776df13fd2f414a5">_IB_NNODES_</a>&#160;&#160;&#160;8</td></tr>
<tr class="separator:a9e114382f922a879776df13fd2f414a5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6f872a36881067ae3dbd5a14042cb2d6"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00189.html#a6f872a36881067ae3dbd5a14042cb2d6">_IB_XY_</a>&#160;&#160;&#160;&quot;2d (xy)&quot;</td></tr>
<tr class="separator:a6f872a36881067ae3dbd5a14042cb2d6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a948cb38cc6d11f9f4c9030994e9a3367"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00189.html#a948cb38cc6d11f9f4c9030994e9a3367">_IB_XZ_</a>&#160;&#160;&#160;&quot;2d (xz)&quot;</td></tr>
<tr class="separator:a948cb38cc6d11f9f4c9030994e9a3367"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa2d4d0cc81beab5f62c5527941655474"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00189.html#aa2d4d0cc81beab5f62c5527941655474">_IB_YZ_</a>&#160;&#160;&#160;&quot;2d (yz)&quot;</td></tr>
<tr class="separator:aa2d4d0cc81beab5f62c5527941655474"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a80bdbbd2624bd70748ffd44c11ffd1fb"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00189.html#a80bdbbd2624bd70748ffd44c11ffd1fb">_IB_3D_</a>&#160;&#160;&#160;&quot;3d&quot;</td></tr>
<tr class="separator:a80bdbbd2624bd70748ffd44c11ffd1fb"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a4246de81fa9366c4e377b927c9cfd2ed"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00189.html#a4246de81fa9366c4e377b927c9cfd2ed">IBReadBodySTL</a> (<a class="el" href="a00189.html#a00648">Body3D</a> **, char *, void *, int *)</td></tr>
<tr class="separator:a4246de81fa9366c4e377b927c9cfd2ed"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a21e563d4573e891bc5e8aec755af4085"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00189.html#a21e563d4573e891bc5e8aec755af4085">IBWriteBodySTL</a> (<a class="el" href="a00189.html#a00648">Body3D</a> *, char *, void *, int, int *)</td></tr>
<tr class="separator:a21e563d4573e891bc5e8aec755af4085"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a783bf18458c856297374e733c1d503ff"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00189.html#a783bf18458c856297374e733c1d503ff">IBCleanup</a> (void *)</td></tr>
<tr class="separator:a783bf18458c856297374e733c1d503ff"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a59296c4f43deabbc6a9b511ba559a4b4"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00189.html#a59296c4f43deabbc6a9b511ba559a4b4">IBComputeBoundingBox</a> (<a class="el" href="a00189.html#a00648">Body3D</a> *)</td></tr>
<tr class="separator:a59296c4f43deabbc6a9b511ba559a4b4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0575b5233bc22af6797e2c7b0d95f469"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00189.html#a0575b5233bc22af6797e2c7b0d95f469">IBCreateFacetMapping</a> (void *, void *, double *, int *, int)</td></tr>
<tr class="separator:a0575b5233bc22af6797e2c7b0d95f469"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9b7a52f65913c3f33f902400fa18239d"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00189.html#a9b7a52f65913c3f33f902400fa18239d">IBIdentifyBody</a> (void *, int *, int *, int, void *, double *, double *)</td></tr>
<tr class="separator:a9b7a52f65913c3f33f902400fa18239d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af70e331f0896000fe1b0edf69676296c"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00189.html#af70e331f0896000fe1b0edf69676296c">IBIdentifyBoundary</a> (void *, void *, int *, int, double *)</td></tr>
<tr class="separator:af70e331f0896000fe1b0edf69676296c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aafa48e01069cbd264052995cffeb6ea0"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00189.html#aafa48e01069cbd264052995cffeb6ea0">IBIdentifyMode</a> (double *, int *, void *)</td></tr>
<tr class="separator:aafa48e01069cbd264052995cffeb6ea0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac877ecf361b72916a491e4759f8af040"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00189.html#ac877ecf361b72916a491e4759f8af040">IBNearestFacetNormal</a> (void *, void *, double *, double, int *, int)</td></tr>
<tr class="separator:ac877ecf361b72916a491e4759f8af040"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0175a349146a94c667dc90f2bffdb7ef"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00189.html#a0175a349146a94c667dc90f2bffdb7ef">IBInterpCoeffs</a> (void *, void *, double *, int *, int, double *)</td></tr>
<tr class="separator:a0175a349146a94c667dc90f2bffdb7ef"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1b5b1eb59ced4b1ece449774787b83b4"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00189.html#a1b5b1eb59ced4b1ece449774787b83b4">IBAssembleGlobalFacetData</a> (void *, void *, const double *const, double **const, int)</td></tr>
<tr class="separator:a1b5b1eb59ced4b1ece449774787b83b4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac0612f5f652fe65361752db0226cc18b"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00189.html#ac0612f5f652fe65361752db0226cc18b">IBComputeNormalGradient</a> (void *, void *, const double *const, int, double **const)</td></tr>
<tr class="separator:ac0612f5f652fe65361752db0226cc18b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9d52a5a358d7e754089a2b3818fde152"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00189.html#a9d52a5a358d7e754089a2b3818fde152">IBComputeFacetVar</a> (void *, void *, const double *const, int, double **const)</td></tr>
<tr class="separator:a9d52a5a358d7e754089a2b3818fde152"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Structures and function definitions for immersed boundaries. </p>
<dl class="section author"><dt>Author</dt><dd>Debojyoti Ghosh </dd></dl>

<p>Definition in file <a class="el" href="a00189_source.html">immersedboundaries.h</a>.</p>
</div><hr/><h2 class="groupheader">Data Structure Documentation</h2>
<a name="a00653" id="a00653"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct Facet3D</td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="textblock"><p>Structure defining a facet. </p>
<p>A "facet" is the basic unit of a tessellated surface in 3D: It is a triangle in an unstructured triangulated surface, defined by its vertices and surface normal. </p>
<dl class="section see"><dt>See Also</dt><dd><a href="https://en.wikipedia.org/wiki/STL_(file_format)">https://en.wikipedia.org/wiki/STL_(file_format)</a> </dd></dl>

<p>Definition at line <a class="el" href="a00189_source.html#l00039">39</a> of file <a class="el" href="a00189_source.html">immersedboundaries.h</a>.</p>
</div><table class="fieldtable">
<tr><th colspan="3">Data Fields</th></tr>
<tr><td class="fieldtype">
<a class="anchor" id="ac75b803b570527306e1e744bfb7a604f"></a>double</td>
<td class="fieldname">
x1</td>
<td class="fielddoc">
<p>x-coordinate of vertex 1 </p>
</td></tr>
<tr><td class="fieldtype">
<a class="anchor" id="adcf04f5f1964d18b332643939561da0d"></a>double</td>
<td class="fieldname">
x2</td>
<td class="fielddoc">
<p>x-coordinate of vertex 2 </p>
</td></tr>
<tr><td class="fieldtype">
<a class="anchor" id="a98e99f64ddf7321e4eae52beca4b580f"></a>double</td>
<td class="fieldname">
x3</td>
<td class="fielddoc">
<p>x-coordinate of vertex 3 </p>
</td></tr>
<tr><td class="fieldtype">
<a class="anchor" id="ac3b72e5b77595ca2340ecf8ccfe5fd99"></a>double</td>
<td class="fieldname">
y1</td>
<td class="fielddoc">
<p>y-coordinate of vertex 1 </p>
</td></tr>
<tr><td class="fieldtype">
<a class="anchor" id="a5347e514ebe985fb371754ffd2b5ff83"></a>double</td>
<td class="fieldname">
y2</td>
<td class="fielddoc">
<p>y-coordinate of vertex 2 </p>
</td></tr>
<tr><td class="fieldtype">
<a class="anchor" id="a786634d3d364cf94d8eb600ce7136355"></a>double</td>
<td class="fieldname">
y3</td>
<td class="fielddoc">
<p>y-coordinate of vertex 3 </p>
</td></tr>
<tr><td class="fieldtype">
<a class="anchor" id="a0e1fe82df628138c8f3907ecddb514ae"></a>double</td>
<td class="fieldname">
z1</td>
<td class="fielddoc">
<p>z-coordinate of vertex 1 </p>
</td></tr>
<tr><td class="fieldtype">
<a class="anchor" id="a822ab991099a420eb62b3f0e2b0021a2"></a>double</td>
<td class="fieldname">
z2</td>
<td class="fielddoc">
<p>z-coordinate of vertex 2 </p>
</td></tr>
<tr><td class="fieldtype">
<a class="anchor" id="a270503fb34041aa050ec80858f7820a7"></a>double</td>
<td class="fieldname">
z3</td>
<td class="fielddoc">
<p>z-coordinate of vertex 3 </p>
</td></tr>
<tr><td class="fieldtype">
<a class="anchor" id="a74d07ed95c86939416c6a88f1daf8e1a"></a>double</td>
<td class="fieldname">
nx</td>
<td class="fielddoc">
<p>x-component of surface normal </p>
</td></tr>
<tr><td class="fieldtype">
<a class="anchor" id="a147a8b14bbd79c0f1a3457805e2065ba"></a>double</td>
<td class="fieldname">
ny</td>
<td class="fielddoc">
<p>y-component of surface normal </p>
</td></tr>
<tr><td class="fieldtype">
<a class="anchor" id="a463bf8b21578003b62221acf2e522134"></a>double</td>
<td class="fieldname">
nz</td>
<td class="fielddoc">
<p>z-component of surface normal </p>
</td></tr>
</table>

</div>
</div>
<a name="a00654" id="a00654"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct FacetMap</td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="textblock"><p>Structure defining a facet map. </p>
<p>A facet map contains information for facets that lie within the local computational domain of this MPI rank. </p>

<p>Definition at line <a class="el" href="a00189_source.html#l00067">67</a> of file <a class="el" href="a00189_source.html">immersedboundaries.h</a>.</p>
</div><table class="fieldtable">
<tr><th colspan="3">Data Fields</th></tr>
<tr><td class="fieldtype">
<a class="anchor" id="adc15fcdbb3aaff6ced4ab10162781055"></a><a class="el" href="a00189.html#a00653">Facet3D</a> *</td>
<td class="fieldname">
facet</td>
<td class="fielddoc">
<p>pointer to the facet </p>
</td></tr>
<tr><td class="fieldtype">
<a class="anchor" id="a750b5d744c39a06bfb13e6eb010e35d0"></a>int</td>
<td class="fieldname">
index</td>
<td class="fielddoc">
<p>index of this facet in the array <a class="el" href="a00189.html#aa7bdafcc50881d7f0f4db707755698ce">Body3D::surface</a> </p>
</td></tr>
<tr><td class="fieldtype">
<a class="anchor" id="a849cc8a5a571348a4d50a0332d9816f8"></a>int</td>
<td class="fieldname">
interp_nodes[<a class="el" href="a00189.html#a9e114382f922a879776df13fd2f414a5">_IB_NNODES_</a>]</td>
<td class="fielddoc">
<p>indices of grid points surrounding the facet centroid </p>
</td></tr>
<tr><td class="fieldtype">
<a class="anchor" id="a4855c244bb3e3ba9b245312a375eed76"></a>double</td>
<td class="fieldname">
interp_coeffs[<a class="el" href="a00189.html#a9e114382f922a879776df13fd2f414a5">_IB_NNODES_</a>]</td>
<td class="fielddoc">
<p>interpolation coefficients corresponding to <a class="el" href="a00189.html#a849cc8a5a571348a4d50a0332d9816f8">FacetMap::interp_nodes</a> </p>
</td></tr>
<tr><td class="fieldtype">
<a class="anchor" id="ae7231c0798d24ebed4aec9c288cb8d4f"></a>int</td>
<td class="fieldname">
interp_nodes_ns[<a class="el" href="a00189.html#a9e114382f922a879776df13fd2f414a5">_IB_NNODES_</a>]</td>
<td class="fielddoc">
<p>indices of grid points surrounding the "near-surface" point near the centroid </p>
</td></tr>
<tr><td class="fieldtype">
<a class="anchor" id="a047220645840c2812b0c4b0a714ce824"></a>double</td>
<td class="fieldname">
interp_coeffs_ns[<a class="el" href="a00189.html#a9e114382f922a879776df13fd2f414a5">_IB_NNODES_</a>]</td>
<td class="fielddoc">
<p>interpolation coefficients corresponding to <a class="el" href="a00189.html#ae7231c0798d24ebed4aec9c288cb8d4f">FacetMap::interp_nodes_ns</a> </p>
</td></tr>
<tr><td class="fieldtype">
<a class="anchor" id="abaefdeffb1a6c37ecbbba1abe183a288"></a>double</td>
<td class="fieldname">
xc</td>
<td class="fielddoc">
<p>x-coordinate of centroid of <a class="el" href="a00189.html#adc15fcdbb3aaff6ced4ab10162781055">FacetMap::facet</a> </p>
</td></tr>
<tr><td class="fieldtype">
<a class="anchor" id="a31d2d6327e76038cd2aee5b972f6a9b3"></a>double</td>
<td class="fieldname">
yc</td>
<td class="fielddoc">
<p>y-coordinate of centroid of <a class="el" href="a00189.html#adc15fcdbb3aaff6ced4ab10162781055">FacetMap::facet</a> </p>
</td></tr>
<tr><td class="fieldtype">
<a class="anchor" id="ae4077e68c108b9ac7d51ef8560c3eebb"></a>double</td>
<td class="fieldname">
zc</td>
<td class="fielddoc">
<p>z-coordinate of centroid of <a class="el" href="a00189.html#adc15fcdbb3aaff6ced4ab10162781055">FacetMap::facet</a> </p>
</td></tr>
<tr><td class="fieldtype">
<a class="anchor" id="abf8de9bed877f84e1b3f7c2ff2808e83"></a>double</td>
<td class="fieldname">
xns</td>
<td class="fielddoc">
<p>x-coordinate of "near surface" point of <a class="el" href="a00189.html#adc15fcdbb3aaff6ced4ab10162781055">FacetMap::facet</a> </p>
</td></tr>
<tr><td class="fieldtype">
<a class="anchor" id="acf05b1f50e224b31597de630f9f3764a"></a>double</td>
<td class="fieldname">
yns</td>
<td class="fielddoc">
<p>y-coordinate of "near surface" point of <a class="el" href="a00189.html#adc15fcdbb3aaff6ced4ab10162781055">FacetMap::facet</a> </p>
</td></tr>
<tr><td class="fieldtype">
<a class="anchor" id="a4f04b6a68b187a8a079dcb6c23630c92"></a>double</td>
<td class="fieldname">
zns</td>
<td class="fielddoc">
<p>z-coordinate of "near surface" point of <a class="el" href="a00189.html#adc15fcdbb3aaff6ced4ab10162781055">FacetMap::facet</a> </p>
</td></tr>
<tr><td class="fieldtype">
<a class="anchor" id="a229d11aff11a7482259d1296b9b70b8a"></a>double</td>
<td class="fieldname">
dx</td>
<td class="fielddoc">
<p><a class="el" href="a00189.html#abf8de9bed877f84e1b3f7c2ff2808e83">FacetMap::xns</a> - <a class="el" href="a00189.html#abaefdeffb1a6c37ecbbba1abe183a288">FacetMap::xc</a> </p>
</td></tr>
<tr><td class="fieldtype">
<a class="anchor" id="a9deb6f886b19d50e714d890c3c268efc"></a>double</td>
<td class="fieldname">
dy</td>
<td class="fielddoc">
<p><a class="el" href="a00189.html#acf05b1f50e224b31597de630f9f3764a">FacetMap::yns</a> - <a class="el" href="a00189.html#a31d2d6327e76038cd2aee5b972f6a9b3">FacetMap::yc</a> </p>
</td></tr>
<tr><td class="fieldtype">
<a class="anchor" id="a5a198de8c3f38514f4e55231aa69cd10"></a>double</td>
<td class="fieldname">
dz</td>
<td class="fielddoc">
<p><a class="el" href="a00189.html#a4f04b6a68b187a8a079dcb6c23630c92">FacetMap::zns</a> - <a class="el" href="a00189.html#ae4077e68c108b9ac7d51ef8560c3eebb">FacetMap::zc</a> </p>
</td></tr>
</table>

</div>
</div>
<a name="a00648" id="a00648"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct Body3D</td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="textblock"><p>Structure defining a body. </p>
<p>A 3D body whose surface is represented as a collection of faces of type <a class="el" href="a00189.html#a00653" title="Structure defining a facet. ">Facet3D</a>. </p>
<dl class="section see"><dt>See Also</dt><dd><a href="https://en.wikipedia.org/wiki/STL_(file_format)">https://en.wikipedia.org/wiki/STL_(file_format)</a> </dd></dl>

<p>Definition at line <a class="el" href="a00189_source.html#l00100">100</a> of file <a class="el" href="a00189_source.html">immersedboundaries.h</a>.</p>
</div><table class="fieldtable">
<tr><th colspan="3">Data Fields</th></tr>
<tr><td class="fieldtype">
<a class="anchor" id="afd755b081f4d9ca3558ef9ca9f3c35d0"></a>int</td>
<td class="fieldname">
nfacets</td>
<td class="fielddoc">
<p>number of surface facets </p>
</td></tr>
<tr><td class="fieldtype">
<a class="anchor" id="aa7bdafcc50881d7f0f4db707755698ce"></a><a class="el" href="a00189.html#a00653">Facet3D</a> *</td>
<td class="fieldname">
surface</td>
<td class="fielddoc">
<p>array of surface facets </p>
</td></tr>
<tr><td class="fieldtype">
<a class="anchor" id="ab5bbe897a0c25c58341c216a1b31fbbf"></a>double</td>
<td class="fieldname">
xmin</td>
<td class="fielddoc">
<p>x-coordinate of lower end of bounding box </p>
</td></tr>
<tr><td class="fieldtype">
<a class="anchor" id="a30554afc6599846bcd01cbf986d0998a"></a>double</td>
<td class="fieldname">
xmax</td>
<td class="fielddoc">
<p>x-coordinate of higher end of bounding box </p>
</td></tr>
<tr><td class="fieldtype">
<a class="anchor" id="a8c17b15efd6e0337c596d98616e9b9da"></a>double</td>
<td class="fieldname">
ymin</td>
<td class="fielddoc">
<p>y-coordinate of lower end of bounding box </p>
</td></tr>
<tr><td class="fieldtype">
<a class="anchor" id="afc6ae6b11b9521d908c52e4fb3ea09ce"></a>double</td>
<td class="fieldname">
ymax</td>
<td class="fielddoc">
<p>y-coordinate of higher end of bounding box </p>
</td></tr>
<tr><td class="fieldtype">
<a class="anchor" id="aaea53ab3c236de8e4f167c3807d35b47"></a>double</td>
<td class="fieldname">
zmin</td>
<td class="fielddoc">
<p>z-coordinate of lower end of bounding box </p>
</td></tr>
<tr><td class="fieldtype">
<a class="anchor" id="ade09ae0d27b0b7a2d1e886efc6d1a500"></a>double</td>
<td class="fieldname">
zmax</td>
<td class="fielddoc">
<p>z-coordinate of higher end of bounding box </p>
</td></tr>
</table>

</div>
</div>
<a name="a00660" id="a00660"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct IBNode</td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="textblock"><p>Structure defining an immersed boundary node. </p>
<p>An immersed boundary node is a grid point inside the immersed body but within stencil-width-distance of a point outside the body. </p>

<p>Definition at line <a class="el" href="a00189_source.html#l00125">125</a> of file <a class="el" href="a00189_source.html">immersedboundaries.h</a>.</p>
</div><table class="fieldtable">
<tr><th colspan="3">Data Fields</th></tr>
<tr><td class="fieldtype">
<a class="anchor" id="acb559820d9ca11295b4500f179ef6392"></a>int</td>
<td class="fieldname">
i</td>
<td class="fielddoc">
<p>grid index along x </p>
</td></tr>
<tr><td class="fieldtype">
<a class="anchor" id="a37d972ae0b47b9099e30983131d31916"></a>int</td>
<td class="fieldname">
j</td>
<td class="fielddoc">
<p>grid index along y </p>
</td></tr>
<tr><td class="fieldtype">
<a class="anchor" id="ab66ed8e0098c0a86b458672a55a9cca9"></a>int</td>
<td class="fieldname">
k</td>
<td class="fielddoc">
<p>grid index along z </p>
</td></tr>
<tr><td class="fieldtype">
<a class="anchor" id="a533391314665d6bf1b5575e9a9cd8552"></a>int</td>
<td class="fieldname">
p</td>
<td class="fielddoc">
<p>array index of this point </p>
</td></tr>
<tr><td class="fieldtype">
<a class="anchor" id="af88b946fb90d5f08b5fb740c70e98c10"></a>double</td>
<td class="fieldname">
x</td>
<td class="fielddoc">
<p>x-coordinate of the boundary node </p>
</td></tr>
<tr><td class="fieldtype">
<a class="anchor" id="ab927965981178aa1fba979a37168db2a"></a>double</td>
<td class="fieldname">
y</td>
<td class="fielddoc">
<p>y-coordinate of the boundary node </p>
</td></tr>
<tr><td class="fieldtype">
<a class="anchor" id="ab3e6ed577a7c669c19de1f9c1b46c872"></a>double</td>
<td class="fieldname">
z</td>
<td class="fielddoc">
<p>z-coordinate of the boundary node </p>
</td></tr>
<tr><td class="fieldtype">
<a class="anchor" id="a84f780956fce41006ca0d5bd16478490"></a><a class="el" href="a00189.html#a00653">Facet3D</a> *</td>
<td class="fieldname">
face</td>
<td class="fielddoc">
<p>the nearest facet of <a class="el" href="a00189.html#af858f0e9bc4a6cb1c16ad2931cf4b43d">ImmersedBoundary::body</a> </p>
</td></tr>
<tr><td class="fieldtype">
<a class="anchor" id="a849cc8a5a571348a4d50a0332d9816f8"></a>int</td>
<td class="fieldname">
interp_nodes[<a class="el" href="a00189.html#a9e114382f922a879776df13fd2f414a5">_IB_NNODES_</a>]</td>
<td class="fielddoc">
<p>indices of interior nodes from which to extrapolate </p>
</td></tr>
<tr><td class="fieldtype">
<a class="anchor" id="a4855c244bb3e3ba9b245312a375eed76"></a>double</td>
<td class="fieldname">
interp_coeffs[<a class="el" href="a00189.html#a9e114382f922a879776df13fd2f414a5">_IB_NNODES_</a>]</td>
<td class="fielddoc">
<p>interpolation coefficients corresponding to <a class="el" href="a00189.html#a849cc8a5a571348a4d50a0332d9816f8">IBNode::interp_nodes</a> </p>
</td></tr>
<tr><td class="fieldtype">
<a class="anchor" id="a9ba638c4f33720c7289cac3bf73ca088"></a>double</td>
<td class="fieldname">
interp_node_distance</td>
<td class="fielddoc">
<p>Distance from the immersed body surface to the interior node from which to extrapolate </p>
</td></tr>
<tr><td class="fieldtype">
<a class="anchor" id="a7b34733bcf53c70cfe86f22bbb05b309"></a>double</td>
<td class="fieldname">
surface_distance</td>
<td class="fielddoc">
<p>Distance from this node to the immersed body surface </p>
</td></tr>
</table>

</div>
</div>
<a name="a00661" id="a00661"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct ImmersedBoundary</td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="textblock"><p>Structure containing variables for immersed boundary implementation. </p>
<p>This structure contains all the variables needed to implement immersed boundaries. </p>

<p>Definition at line <a class="el" href="a00189_source.html#l00153">153</a> of file <a class="el" href="a00189_source.html">immersedboundaries.h</a>.</p>
</div><table class="fieldtable">
<tr><th colspan="3">Data Fields</th></tr>
<tr><td class="fieldtype">
<a class="anchor" id="af858f0e9bc4a6cb1c16ad2931cf4b43d"></a><a class="el" href="a00189.html#a00648">Body3D</a> *</td>
<td class="fieldname">
body</td>
<td class="fielddoc">
<p>immersed body </p>
</td></tr>
<tr><td class="fieldtype">
<a class="anchor" id="aeab4c13a1e3fce2920ce0ff616d0fac5"></a><a class="el" href="a00189.html#a00660">IBNode</a> *</td>
<td class="fieldname">
boundary</td>
<td class="fielddoc">
<p>immersed boundary nodes </p>
</td></tr>
<tr><td class="fieldtype">
<a class="anchor" id="a83fe29d69e04c222af5c68e38142336c"></a><a class="el" href="a00189.html#a00654">FacetMap</a> *</td>
<td class="fieldname">
fmap</td>
<td class="fielddoc">
<p>list of "local" facets </p>
</td></tr>
<tr><td class="fieldtype">
<a class="anchor" id="a97eab6d709b80585fe9e8a54b1e3da27"></a>double</td>
<td class="fieldname">
tolerance</td>
<td class="fielddoc">
<p>zero tolerance </p>
</td></tr>
<tr><td class="fieldtype">
<a class="anchor" id="a9ea1a8f5ef3e6d20b362385e1288c72c"></a>double</td>
<td class="fieldname">
delta</td>
<td class="fielddoc">
<p>small number </p>
</td></tr>
<tr><td class="fieldtype">
<a class="anchor" id="a5a34c6ed89d3769fb1200fdfbdc8ae33"></a>int</td>
<td class="fieldname">
itr_max</td>
<td class="fielddoc">
<p>maximum intersections in ray-tracing method </p>
</td></tr>
<tr><td class="fieldtype">
<a class="anchor" id="a7f578e3fbaeeea97b65e3ade80f60a78"></a>int</td>
<td class="fieldname">
n_boundary_nodes</td>
<td class="fielddoc">
<p>number of immersed boundary nodes </p>
</td></tr>
<tr><td class="fieldtype">
<a class="anchor" id="ab3583871695c8f2fc06011d14e092d09"></a>int</td>
<td class="fieldname">
nfacets_local</td>
<td class="fielddoc">
<p>number of "local" facets </p>
</td></tr>
<tr><td class="fieldtype">
<a class="anchor" id="a935394e510d17282c5697cd76a6e2667"></a>char</td>
<td class="fieldname">
mode[<a class="el" href="a00211.html#a51efea86a4d76d1259893f606b776573">_MAX_STRING_SIZE_</a>]</td>
<td class="fielddoc">
<p>identifies if the simulation is 2D along a plane or truly 3D. </p>
<dl class="section see"><dt>See Also</dt><dd><a class="el" href="a00189.html#aafa48e01069cbd264052995cffeb6ea0">IBIdentifyMode()</a> </dd></dl>
</td></tr>
</table>

</div>
</div>
<h2 class="groupheader">Macro Definition Documentation</h2>
<a class="anchor" id="a0f59ba2c552bae2f35a03ce3964a2b4a"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define _IB_NDIMS_&#160;&#160;&#160;3</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Immersed boundaries are implemented only for 3-dimensional simulations. </p>

<p>Definition at line <a class="el" href="a00189_source.html#l00010">10</a> of file <a class="el" href="a00189_source.html">immersedboundaries.h</a>.</p>

</div>
</div>
<a class="anchor" id="a9e114382f922a879776df13fd2f414a5"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define _IB_NNODES_&#160;&#160;&#160;8</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Number of grid points surrounding a random point in space, i.e., number of corners of a cube. </p>

<p>Definition at line <a class="el" href="a00189_source.html#l00013">13</a> of file <a class="el" href="a00189_source.html">immersedboundaries.h</a>.</p>

</div>
</div>
<a class="anchor" id="a6f872a36881067ae3dbd5a14042cb2d6"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define _IB_XY_&#160;&#160;&#160;&quot;2d (xy)&quot;</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>"Pseudo-2D" simulation in the x-y plane </p>

<p>Definition at line <a class="el" href="a00189_source.html#l00016">16</a> of file <a class="el" href="a00189_source.html">immersedboundaries.h</a>.</p>

</div>
</div>
<a class="anchor" id="a948cb38cc6d11f9f4c9030994e9a3367"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define _IB_XZ_&#160;&#160;&#160;&quot;2d (xz)&quot;</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>"Pseudo-2D" simulation in the x-z plane </p>

<p>Definition at line <a class="el" href="a00189_source.html#l00018">18</a> of file <a class="el" href="a00189_source.html">immersedboundaries.h</a>.</p>

</div>
</div>
<a class="anchor" id="aa2d4d0cc81beab5f62c5527941655474"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define _IB_YZ_&#160;&#160;&#160;&quot;2d (yz)&quot;</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>"Pseudo-2D" simulation in the y-z plane </p>

<p>Definition at line <a class="el" href="a00189_source.html#l00020">20</a> of file <a class="el" href="a00189_source.html">immersedboundaries.h</a>.</p>

</div>
</div>
<a class="anchor" id="a80bdbbd2624bd70748ffd44c11ffd1fb"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define _IB_3D_&#160;&#160;&#160;&quot;3d&quot;</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>3D simulation </p>

<p>Definition at line <a class="el" href="a00189_source.html#l00022">22</a> of file <a class="el" href="a00189_source.html">immersedboundaries.h</a>.</p>

</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a class="anchor" id="a4246de81fa9366c4e377b927c9cfd2ed"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int IBReadBodySTL </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="a00189.html#a00648">Body3D</a> **&#160;</td>
          <td class="paramname"><em>body</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>filename</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>m</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>stat</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Function to read a 3D surface from a STL file. See <a href="https://en.wikipedia.org/wiki/STL_(file_format)">https://en.wikipedia.org/wiki/STL_(file_format)</a> for details of the STL file format. <b>Notes:</b> </p>
<ul>
<li>This function only reads ASCII STL files.</li>
<li>The body read from this file is distributed to all MPI ranks. </li>
</ul>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">body</td><td>3D body to be allocated and read from file </td></tr>
    <tr><td class="paramname">filename</td><td>Filename </td></tr>
    <tr><td class="paramname">m</td><td>MPI object of type <a class="el" href="a00205.html#a00663" title="Structure of MPI-related variables. ">MPIVariables</a> </td></tr>
    <tr><td class="paramname">stat</td><td>Status (0: success; non-0: failure) </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="a00332_source.html#l00021">21</a> of file <a class="el" href="a00332_source.html">IBReadBodySTL.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;{</div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;  <a class="code" href="a00205.html#a00663">MPIVariables</a>  *mpi = (<a class="code" href="a00205.html#a00663">MPIVariables</a>*) m;</div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;  <span class="keywordtype">int</span> n, ierr;</div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;  *stat = 0;</div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;</div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;  <span class="keywordflow">if</span> ((*body) != NULL) {</div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;    <span class="keywordflow">if</span> (!mpi-&gt;<a class="code" href="a00205.html#a6cfd95afd0afebd625b889fb6e58371c">rank</a>) {</div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;      fprintf(stderr,<span class="stringliteral">&quot;Error in IBReadBodySTL(): pointer to immersed body not NULL.\n&quot;</span>);</div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;    }</div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;    *stat = -1;</div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;    <span class="keywordflow">return</span>(0);</div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;  }</div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;</div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;  <span class="comment">/* Rank 0 reads in file */</span></div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;  <span class="keywordflow">if</span> (!mpi-&gt;<a class="code" href="a00205.html#a6cfd95afd0afebd625b889fb6e58371c">rank</a>) {</div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;</div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;    FILE  *in;</div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;    in = fopen(filename,<span class="stringliteral">&quot;r&quot;</span>);</div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;    <span class="keywordflow">if</span> (!in) {</div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;      fprintf(stderr,<span class="stringliteral">&quot;Error in IBReadBodySTL(): file %s not found or cannot be opened.\n&quot;</span>,</div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;              filename);</div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;      *stat = 1;</div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;    }</div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;    <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;</div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;      <span class="keywordtype">int</span>   nfacets = 0;</div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;        <span class="keywordtype">char</span>  word[<a class="code" href="a00231.html#a51efea86a4d76d1259893f606b776573">_MAX_STRING_SIZE_</a>];</div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;      <span class="comment">/* Count number of facets in STL file */</span></div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;      ierr = fscanf(in,<span class="stringliteral">&quot;%s&quot;</span>,word);</div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;      <span class="keywordflow">if</span> (!strcmp(word, <span class="stringliteral">&quot;solid&quot;</span>)) {</div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;        nfacets = 0;</div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;        <span class="keywordflow">while</span> (strcmp(word, <span class="stringliteral">&quot;endsolid&quot;</span>)) {</div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;          ierr = fscanf(in,<span class="stringliteral">&quot;%s&quot;</span>,word);</div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;          <span class="keywordflow">if</span> (!strcmp(word, <span class="stringliteral">&quot;facet&quot;</span>)) nfacets++;</div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;        }</div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;      }</div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;      fclose(in);</div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;</div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;      <span class="keywordflow">if</span> (nfacets &gt; 0) {</div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;        (*body) = (<a class="code" href="a00189.html#a00648">Body3D</a>*) calloc (1,<span class="keyword">sizeof</span>(<a class="code" href="a00189.html#a00648">Body3D</a>));</div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;        (*body)-&gt;nfacets = nfacets;</div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;        (*body)-&gt;surface = (<a class="code" href="a00189.html#a00653">Facet3D</a>*) calloc (nfacets,<span class="keyword">sizeof</span>(<a class="code" href="a00189.html#a00653">Facet3D</a>));</div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;</div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;        <span class="comment">/* Read in STL data */</span></div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;        in = fopen(filename,<span class="stringliteral">&quot;r&quot;</span>);</div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;        ierr = fscanf(in,<span class="stringliteral">&quot;%s&quot;</span>,word);</div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;        n = 0;</div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;        <span class="keywordflow">while</span> (strcmp(word, <span class="stringliteral">&quot;endsolid&quot;</span>)) {</div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;          <span class="keywordtype">double</span> t1, t2, t3;</div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;          ierr = fscanf(in,<span class="stringliteral">&quot;%s&quot;</span>,word);</div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;          <span class="keywordflow">if</span> (!strcmp(word, <span class="stringliteral">&quot;facet&quot;</span>)) {</div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;            ierr = fscanf(in,<span class="stringliteral">&quot;%s&quot;</span>,word);</div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;            <span class="keywordflow">if</span> (strcmp(word, <span class="stringliteral">&quot;normal&quot;</span>)) {</div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;              fprintf(stderr,<span class="stringliteral">&quot;Error in IBReadBodySTL(): Illegal keyword read in %s.\n&quot;</span>,filename);</div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;            } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;              ierr = fscanf(in,<span class="stringliteral">&quot;%lf&quot;</span>,&amp;t1);</div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;              ierr = fscanf(in,<span class="stringliteral">&quot;%lf&quot;</span>,&amp;t2);</div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;              ierr = fscanf(in,<span class="stringliteral">&quot;%lf&quot;</span>,&amp;t3);</div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;              (*body)-&gt;surface[n].nx = t1; </div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;              (*body)-&gt;surface[n].ny = t2; </div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;              (*body)-&gt;surface[n].nz = t3;</div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;            }</div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;            ierr = fscanf(in,<span class="stringliteral">&quot;%s&quot;</span>,word);</div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;            <span class="keywordflow">if</span> (strcmp(word, <span class="stringliteral">&quot;outer&quot;</span>)) {</div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;              fprintf(stderr,<span class="stringliteral">&quot;Error in IBReadBodySTL(): Illegal keyword read in %s.\n&quot;</span>,filename);</div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;              *stat = 1;</div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;            } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;              ierr = fscanf(in,<span class="stringliteral">&quot;%s&quot;</span>,word);</div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;              <span class="keywordflow">if</span> (strcmp(word, <span class="stringliteral">&quot;loop&quot;</span>)) {</div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;                fprintf(stderr,<span class="stringliteral">&quot;Error in IBReadBodySTL(): Illegal keyword read in %s.\n&quot;</span>,filename);</div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;                *stat = 1;</div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;              } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;                ierr = fscanf(in,<span class="stringliteral">&quot;%s&quot;</span>,word);</div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;                <span class="keywordflow">if</span> (strcmp(word, <span class="stringliteral">&quot;vertex&quot;</span>)) {</div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;                  fprintf(stderr,<span class="stringliteral">&quot;Error in IBReadBodySTL(): Illegal keyword read in %s.\n&quot;</span>,filename);</div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;                  *stat = 1;</div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;                } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;                  ierr = fscanf(in,<span class="stringliteral">&quot;%lf&quot;</span>,&amp;t1);</div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;                  ierr = fscanf(in,<span class="stringliteral">&quot;%lf&quot;</span>,&amp;t2);</div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;                  ierr = fscanf(in,<span class="stringliteral">&quot;%lf&quot;</span>,&amp;t3);</div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;                  (*body)-&gt;surface[n].x1 = t1; </div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;                  (*body)-&gt;surface[n].y1 = t2; </div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;                  (*body)-&gt;surface[n].z1 = t3;</div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;                }</div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;                ierr = fscanf(in,<span class="stringliteral">&quot;%s&quot;</span>,word);</div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;                <span class="keywordflow">if</span> (strcmp(word, <span class="stringliteral">&quot;vertex&quot;</span>)) {</div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;                  fprintf(stderr,<span class="stringliteral">&quot;Error in IBReadBodySTL(): Illegal keyword read in %s.\n&quot;</span>,filename);</div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;                  *stat = 1;</div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;                } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;                  ierr = fscanf(in,<span class="stringliteral">&quot;%lf&quot;</span>,&amp;t1);</div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;                  ierr = fscanf(in,<span class="stringliteral">&quot;%lf&quot;</span>,&amp;t2);</div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;                  ierr = fscanf(in,<span class="stringliteral">&quot;%lf&quot;</span>,&amp;t3);</div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;                  (*body)-&gt;surface[n].x2 = t1; </div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;                  (*body)-&gt;surface[n].y2 = t2; </div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;                  (*body)-&gt;surface[n].z2 = t3;</div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;                }</div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;                ierr = fscanf(in,<span class="stringliteral">&quot;%s&quot;</span>,word);</div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;                <span class="keywordflow">if</span> (strcmp(word, <span class="stringliteral">&quot;vertex&quot;</span>)) {</div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;                  fprintf(stderr,<span class="stringliteral">&quot;Error in IBReadBodySTL(): Illegal keyword read in %s.\n&quot;</span>,filename);</div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;                  *stat = 1;</div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;                } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;                  ierr = fscanf(in,<span class="stringliteral">&quot;%lf&quot;</span>,&amp;t1);</div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;                  ierr = fscanf(in,<span class="stringliteral">&quot;%lf&quot;</span>,&amp;t2);</div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;                  ierr = fscanf(in,<span class="stringliteral">&quot;%lf&quot;</span>,&amp;t3);</div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;                  (*body)-&gt;surface[n].x3 = t1; </div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;                  (*body)-&gt;surface[n].y3 = t2; </div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;                  (*body)-&gt;surface[n].z3 = t3;</div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;                }</div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;              }</div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;            }</div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;            n++;</div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;          }</div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;        }</div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;        fclose(in);</div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;        <span class="comment">/* done reading STL file */</span></div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;        <span class="keywordflow">if</span> (n != nfacets) {</div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;          fprintf(stderr,<span class="stringliteral">&quot;Error in IBReadBodySTL(): Inconsistency in number of facets read.\n&quot;</span>);</div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;          free((*body)-&gt;surface);</div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;          free(*body);</div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;          *stat = 1;</div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;        }</div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;      } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;        fprintf(stderr,<span class="stringliteral">&quot;Error in IBReadBodySTL(): nfacets = 0!!\n&quot;</span>);</div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;        *stat = 1;</div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;      }</div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;</div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;    }</div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;  }</div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;  <a class="code" href="a00248.html#acd7957559b9206224c7da3cab4f22b27">MPIBroadcast_integer</a>(stat,1,0,&amp;mpi-&gt;<a class="code" href="a00205.html#adad7a6f85831f3ac84d854b6c80aef43">world</a>);</div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;</div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;  <span class="keywordflow">if</span> ((*stat)) <span class="keywordflow">return</span>(0);</div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;</div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;  <span class="comment">/* Distribute the body to all MPI ranks */</span></div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;  <span class="keywordtype">int</span> nfacets;</div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;  <span class="keywordflow">if</span> (!mpi-&gt;<a class="code" href="a00205.html#a6cfd95afd0afebd625b889fb6e58371c">rank</a>) nfacets = (*body)-&gt;nfacets;</div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;  <a class="code" href="a00248.html#acd7957559b9206224c7da3cab4f22b27">MPIBroadcast_integer</a>(&amp;nfacets,1,0,&amp;mpi-&gt;<a class="code" href="a00205.html#adad7a6f85831f3ac84d854b6c80aef43">world</a>);</div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;</div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;  <span class="keywordflow">if</span> (mpi-&gt;<a class="code" href="a00205.html#a6cfd95afd0afebd625b889fb6e58371c">rank</a>) {</div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;    (*body) = (<a class="code" href="a00189.html#a00648">Body3D</a>*) calloc (1,<span class="keyword">sizeof</span>(<a class="code" href="a00189.html#a00648">Body3D</a>));</div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;    (*body)-&gt;nfacets = nfacets;</div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;    (*body)-&gt;surface = (<a class="code" href="a00189.html#a00653">Facet3D</a>*) calloc (nfacets,<span class="keyword">sizeof</span>(<a class="code" href="a00189.html#a00653">Facet3D</a>));</div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;  }</div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;</div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;  <span class="keywordtype">int</span> bufdim = 12;</div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;  <span class="keywordtype">double</span> *buffer = (<span class="keywordtype">double</span>*) calloc (bufdim*nfacets,<span class="keyword">sizeof</span>(<span class="keywordtype">double</span>));</div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;  <span class="keywordflow">if</span> (!mpi-&gt;<a class="code" href="a00205.html#a6cfd95afd0afebd625b889fb6e58371c">rank</a>) {</div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;    <span class="keywordflow">for</span> (n=0; n&lt;nfacets; n++) {</div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;      buffer[n*bufdim+ 0] = (*body)-&gt;surface[n].x1;</div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;      buffer[n*bufdim+ 1] = (*body)-&gt;surface[n].x2;</div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;      buffer[n*bufdim+ 2] = (*body)-&gt;surface[n].x3;</div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;      buffer[n*bufdim+ 3] = (*body)-&gt;surface[n].y1;</div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;      buffer[n*bufdim+ 4] = (*body)-&gt;surface[n].y2;</div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;      buffer[n*bufdim+ 5] = (*body)-&gt;surface[n].y3;</div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;      buffer[n*bufdim+ 6] = (*body)-&gt;surface[n].z1;</div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;      buffer[n*bufdim+ 7] = (*body)-&gt;surface[n].z2;</div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;      buffer[n*bufdim+ 8] = (*body)-&gt;surface[n].z3;</div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;      buffer[n*bufdim+ 9] = (*body)-&gt;surface[n].nx;</div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;      buffer[n*bufdim+10] = (*body)-&gt;surface[n].ny;</div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;      buffer[n*bufdim+11] = (*body)-&gt;surface[n].nz;</div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;    }</div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;  }</div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;  <a class="code" href="a00248.html#a45dcb265863a65d862bb16222e7e623c">MPIBroadcast_double</a>(buffer,(nfacets*bufdim),0,&amp;mpi-&gt;<a class="code" href="a00205.html#adad7a6f85831f3ac84d854b6c80aef43">world</a>);</div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;  <span class="keywordflow">if</span> (mpi-&gt;<a class="code" href="a00205.html#a6cfd95afd0afebd625b889fb6e58371c">rank</a>) {</div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;    <span class="keywordflow">for</span> (n=0; n&lt;nfacets; n++) {</div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;      (*body)-&gt;surface[n].x1 = buffer[n*bufdim+ 0];</div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;      (*body)-&gt;surface[n].x2 = buffer[n*bufdim+ 1];</div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;      (*body)-&gt;surface[n].x3 = buffer[n*bufdim+ 2];</div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;      (*body)-&gt;surface[n].y1 = buffer[n*bufdim+ 3];</div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;      (*body)-&gt;surface[n].y2 = buffer[n*bufdim+ 4];</div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;      (*body)-&gt;surface[n].y3 = buffer[n*bufdim+ 5];</div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;      (*body)-&gt;surface[n].z1 = buffer[n*bufdim+ 6];</div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;      (*body)-&gt;surface[n].z2 = buffer[n*bufdim+ 7];</div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;      (*body)-&gt;surface[n].z3 = buffer[n*bufdim+ 8];</div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;      (*body)-&gt;surface[n].nx = buffer[n*bufdim+ 9];</div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;      (*body)-&gt;surface[n].ny = buffer[n*bufdim+10];</div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;      (*body)-&gt;surface[n].nz = buffer[n*bufdim+11];</div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;    }</div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;  }</div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;  free(buffer);</div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;</div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;  <span class="keywordflow">return</span>(0);</div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;}</div>
<div class="ttc" id="a00248_html_acd7957559b9206224c7da3cab4f22b27"><div class="ttname"><a href="a00248.html#acd7957559b9206224c7da3cab4f22b27">MPIBroadcast_integer</a></div><div class="ttdeci">int MPIBroadcast_integer(int *, int, int, void *)</div><div class="ttdef"><b>Definition:</b> <a href="a00380_source.html#l00023">MPIBroadcast.c:23</a></div></div>
<div class="ttc" id="a00189_html_a00653"><div class="ttname"><a href="a00189.html#a00653">Facet3D</a></div><div class="ttdoc">Structure defining a facet. </div><div class="ttdef"><b>Definition:</b> <a href="a00189_source.html#l00039">immersedboundaries.h:39</a></div></div>
<div class="ttc" id="a00189_html_a00648"><div class="ttname"><a href="a00189.html#a00648">Body3D</a></div><div class="ttdoc">Structure defining a body. </div><div class="ttdef"><b>Definition:</b> <a href="a00189_source.html#l00100">immersedboundaries.h:100</a></div></div>
<div class="ttc" id="a00205_html_a00663"><div class="ttname"><a href="a00205.html#a00663">MPIVariables</a></div><div class="ttdoc">Structure of MPI-related variables. </div><div class="ttdef"><b>Definition:</b> <a href="a00205_source.html#l00024">mpivars_struct.h:24</a></div></div>
<div class="ttc" id="a00231_html_a51efea86a4d76d1259893f606b776573"><div class="ttname"><a href="a00231.html#a51efea86a4d76d1259893f606b776573">_MAX_STRING_SIZE_</a></div><div class="ttdeci">#define _MAX_STRING_SIZE_</div><div class="ttdef"><b>Definition:</b> <a href="a00231_source.html#l00014">basic.h:14</a></div></div>
<div class="ttc" id="a00205_html_a6cfd95afd0afebd625b889fb6e58371c"><div class="ttname"><a href="a00205.html#a6cfd95afd0afebd625b889fb6e58371c">MPIVariables::rank</a></div><div class="ttdeci">int rank</div><div class="ttdef"><b>Definition:</b> <a href="a00205_source.html#l00025">mpivars_struct.h:25</a></div></div>
<div class="ttc" id="a00205_html_adad7a6f85831f3ac84d854b6c80aef43"><div class="ttname"><a href="a00205.html#adad7a6f85831f3ac84d854b6c80aef43">MPIVariables::world</a></div><div class="ttdeci">MPI_Comm world</div><div class="ttdef"><b>Definition:</b> <a href="a00205_source.html#l00037">mpivars_struct.h:37</a></div></div>
<div class="ttc" id="a00248_html_a45dcb265863a65d862bb16222e7e623c"><div class="ttname"><a href="a00248.html#a45dcb265863a65d862bb16222e7e623c">MPIBroadcast_double</a></div><div class="ttdeci">int MPIBroadcast_double(double *, int, int, void *)</div><div class="ttdef"><b>Definition:</b> <a href="a00380_source.html#l00009">MPIBroadcast.c:9</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a21e563d4573e891bc5e8aec755af4085"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int IBWriteBodySTL </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="a00189.html#a00648">Body3D</a> *&#160;</td>
          <td class="paramname"><em>body</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>filename</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>m</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>rank</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>stat</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Function to write a 3D surface from a STL file. See <a href="https://en.wikipedia.org/wiki/STL_(file_format)">https://en.wikipedia.org/wiki/STL_(file_format)</a> for details of the STL file format. <b>Notes:</b> </p>
<ul>
<li>This function only writes ASCII STL files.</li>
</ul>
<p>It is assumed that all MPI ranks have the body data. The MPI rank specified as the input <em>rank</em> will actually write the file. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">body</td><td>3D body to write to file </td></tr>
    <tr><td class="paramname">filename</td><td>Filename </td></tr>
    <tr><td class="paramname">m</td><td>MPI object of type <a class="el" href="a00205.html#a00663" title="Structure of MPI-related variables. ">MPIVariables</a> </td></tr>
    <tr><td class="paramname">rank</td><td>MPI rank that does the writing </td></tr>
    <tr><td class="paramname">stat</td><td>Status (0: success; non-0: failure) </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="a00333_source.html#l00023">23</a> of file <a class="el" href="a00333_source.html">IBWriteBodySTL.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;{</div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;  <a class="code" href="a00205.html#a00663">MPIVariables</a>  *mpi = (<a class="code" href="a00205.html#a00663">MPIVariables</a>*) m;</div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;</div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;  <span class="keywordflow">if</span> (mpi-&gt;<a class="code" href="a00205.html#a6cfd95afd0afebd625b889fb6e58371c">rank</a> == rank) {</div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;    FILE *out;</div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;    out = fopen(filename,<span class="stringliteral">&quot;w&quot;</span>);</div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;    <span class="keywordflow">if</span> (!out) {</div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;      fprintf(stderr,<span class="stringliteral">&quot;Error in IBWriteBodySTL(): Unable to open file &quot;</span>);</div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;      fprintf(stderr,<span class="stringliteral">&quot;%s for writing on rank %d.\n&quot;</span>,filename,mpi-&gt;<a class="code" href="a00205.html#a6cfd95afd0afebd625b889fb6e58371c">rank</a>);</div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;      *stat = 1;</div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;      fprintf(out,<span class="stringliteral">&quot;solid TEST\n&quot;</span>);</div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;      <span class="keywordtype">int</span> n;</div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;      <span class="keywordflow">for</span> (n = 0; n &lt; body-&gt;<a class="code" href="a00189.html#afd755b081f4d9ca3558ef9ca9f3c35d0">nfacets</a>; n++) {</div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;        fprintf(out,<span class="stringliteral">&quot;  facet normal %1.16e %1.16e %1.16e\n&quot;</span>,</div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;                body-&gt;<a class="code" href="a00189.html#aa7bdafcc50881d7f0f4db707755698ce">surface</a>[n].<a class="code" href="a00189.html#a74d07ed95c86939416c6a88f1daf8e1a">nx</a>,body-&gt;<a class="code" href="a00189.html#aa7bdafcc50881d7f0f4db707755698ce">surface</a>[n].<a class="code" href="a00189.html#a147a8b14bbd79c0f1a3457805e2065ba">ny</a>,body-&gt;<a class="code" href="a00189.html#aa7bdafcc50881d7f0f4db707755698ce">surface</a>[n].<a class="code" href="a00189.html#a463bf8b21578003b62221acf2e522134">nz</a>);</div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;        fprintf(out,<span class="stringliteral">&quot;    outer loop\n&quot;</span>);</div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;        fprintf(out,<span class="stringliteral">&quot;      vertex %1.16e %1.16e %1.16e\n&quot;</span>,</div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;                body-&gt;<a class="code" href="a00189.html#aa7bdafcc50881d7f0f4db707755698ce">surface</a>[n].<a class="code" href="a00189.html#ac75b803b570527306e1e744bfb7a604f">x1</a>,body-&gt;<a class="code" href="a00189.html#aa7bdafcc50881d7f0f4db707755698ce">surface</a>[n].<a class="code" href="a00189.html#ac3b72e5b77595ca2340ecf8ccfe5fd99">y1</a>,body-&gt;<a class="code" href="a00189.html#aa7bdafcc50881d7f0f4db707755698ce">surface</a>[n].<a class="code" href="a00189.html#a0e1fe82df628138c8f3907ecddb514ae">z1</a>);</div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;        fprintf(out,<span class="stringliteral">&quot;      vertex %1.16e %1.16e %1.16e\n&quot;</span>,</div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;                body-&gt;<a class="code" href="a00189.html#aa7bdafcc50881d7f0f4db707755698ce">surface</a>[n].<a class="code" href="a00189.html#adcf04f5f1964d18b332643939561da0d">x2</a>,body-&gt;<a class="code" href="a00189.html#aa7bdafcc50881d7f0f4db707755698ce">surface</a>[n].<a class="code" href="a00189.html#a5347e514ebe985fb371754ffd2b5ff83">y2</a>,body-&gt;<a class="code" href="a00189.html#aa7bdafcc50881d7f0f4db707755698ce">surface</a>[n].<a class="code" href="a00189.html#a822ab991099a420eb62b3f0e2b0021a2">z2</a>);</div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;        fprintf(out,<span class="stringliteral">&quot;      vertex %1.16e %1.16e %1.16e\n&quot;</span>,</div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;                body-&gt;<a class="code" href="a00189.html#aa7bdafcc50881d7f0f4db707755698ce">surface</a>[n].<a class="code" href="a00189.html#a98e99f64ddf7321e4eae52beca4b580f">x3</a>,body-&gt;<a class="code" href="a00189.html#aa7bdafcc50881d7f0f4db707755698ce">surface</a>[n].<a class="code" href="a00189.html#a786634d3d364cf94d8eb600ce7136355">y3</a>,body-&gt;<a class="code" href="a00189.html#aa7bdafcc50881d7f0f4db707755698ce">surface</a>[n].<a class="code" href="a00189.html#a270503fb34041aa050ec80858f7820a7">z3</a>);</div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;        fprintf(out,<span class="stringliteral">&quot;    endloop\n&quot;</span>);</div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;        fprintf(out,<span class="stringliteral">&quot;  endfacet\n&quot;</span>);</div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;      }</div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;      fprintf(out,<span class="stringliteral">&quot;endsolid TEST\n&quot;</span>);</div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;      *stat = 0;</div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;    }</div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;  }</div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;  <span class="keywordflow">return</span>(0);</div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;}</div>
<div class="ttc" id="a00189_html_ac75b803b570527306e1e744bfb7a604f"><div class="ttname"><a href="a00189.html#ac75b803b570527306e1e744bfb7a604f">Facet3D::x1</a></div><div class="ttdeci">double x1</div><div class="ttdef"><b>Definition:</b> <a href="a00189_source.html#l00040">immersedboundaries.h:40</a></div></div>
<div class="ttc" id="a00189_html_a5347e514ebe985fb371754ffd2b5ff83"><div class="ttname"><a href="a00189.html#a5347e514ebe985fb371754ffd2b5ff83">Facet3D::y2</a></div><div class="ttdeci">double y2</div><div class="ttdef"><b>Definition:</b> <a href="a00189_source.html#l00040">immersedboundaries.h:40</a></div></div>
<div class="ttc" id="a00189_html_ac3b72e5b77595ca2340ecf8ccfe5fd99"><div class="ttname"><a href="a00189.html#ac3b72e5b77595ca2340ecf8ccfe5fd99">Facet3D::y1</a></div><div class="ttdeci">double y1</div><div class="ttdef"><b>Definition:</b> <a href="a00189_source.html#l00040">immersedboundaries.h:40</a></div></div>
<div class="ttc" id="a00189_html_a74d07ed95c86939416c6a88f1daf8e1a"><div class="ttname"><a href="a00189.html#a74d07ed95c86939416c6a88f1daf8e1a">Facet3D::nx</a></div><div class="ttdeci">double nx</div><div class="ttdef"><b>Definition:</b> <a href="a00189_source.html#l00040">immersedboundaries.h:40</a></div></div>
<div class="ttc" id="a00189_html_a822ab991099a420eb62b3f0e2b0021a2"><div class="ttname"><a href="a00189.html#a822ab991099a420eb62b3f0e2b0021a2">Facet3D::z2</a></div><div class="ttdeci">double z2</div><div class="ttdef"><b>Definition:</b> <a href="a00189_source.html#l00040">immersedboundaries.h:40</a></div></div>
<div class="ttc" id="a00189_html_adcf04f5f1964d18b332643939561da0d"><div class="ttname"><a href="a00189.html#adcf04f5f1964d18b332643939561da0d">Facet3D::x2</a></div><div class="ttdeci">double x2</div><div class="ttdef"><b>Definition:</b> <a href="a00189_source.html#l00040">immersedboundaries.h:40</a></div></div>
<div class="ttc" id="a00189_html_a98e99f64ddf7321e4eae52beca4b580f"><div class="ttname"><a href="a00189.html#a98e99f64ddf7321e4eae52beca4b580f">Facet3D::x3</a></div><div class="ttdeci">double x3</div><div class="ttdef"><b>Definition:</b> <a href="a00189_source.html#l00040">immersedboundaries.h:40</a></div></div>
<div class="ttc" id="a00189_html_a147a8b14bbd79c0f1a3457805e2065ba"><div class="ttname"><a href="a00189.html#a147a8b14bbd79c0f1a3457805e2065ba">Facet3D::ny</a></div><div class="ttdeci">double ny</div><div class="ttdef"><b>Definition:</b> <a href="a00189_source.html#l00040">immersedboundaries.h:40</a></div></div>
<div class="ttc" id="a00205_html_a00663"><div class="ttname"><a href="a00205.html#a00663">MPIVariables</a></div><div class="ttdoc">Structure of MPI-related variables. </div><div class="ttdef"><b>Definition:</b> <a href="a00205_source.html#l00024">mpivars_struct.h:24</a></div></div>
<div class="ttc" id="a00189_html_a463bf8b21578003b62221acf2e522134"><div class="ttname"><a href="a00189.html#a463bf8b21578003b62221acf2e522134">Facet3D::nz</a></div><div class="ttdeci">double nz</div><div class="ttdef"><b>Definition:</b> <a href="a00189_source.html#l00040">immersedboundaries.h:40</a></div></div>
<div class="ttc" id="a00205_html_a6cfd95afd0afebd625b889fb6e58371c"><div class="ttname"><a href="a00205.html#a6cfd95afd0afebd625b889fb6e58371c">MPIVariables::rank</a></div><div class="ttdeci">int rank</div><div class="ttdef"><b>Definition:</b> <a href="a00205_source.html#l00025">mpivars_struct.h:25</a></div></div>
<div class="ttc" id="a00189_html_a270503fb34041aa050ec80858f7820a7"><div class="ttname"><a href="a00189.html#a270503fb34041aa050ec80858f7820a7">Facet3D::z3</a></div><div class="ttdeci">double z3</div><div class="ttdef"><b>Definition:</b> <a href="a00189_source.html#l00040">immersedboundaries.h:40</a></div></div>
<div class="ttc" id="a00189_html_a786634d3d364cf94d8eb600ce7136355"><div class="ttname"><a href="a00189.html#a786634d3d364cf94d8eb600ce7136355">Facet3D::y3</a></div><div class="ttdeci">double y3</div><div class="ttdef"><b>Definition:</b> <a href="a00189_source.html#l00040">immersedboundaries.h:40</a></div></div>
<div class="ttc" id="a00189_html_afd755b081f4d9ca3558ef9ca9f3c35d0"><div class="ttname"><a href="a00189.html#afd755b081f4d9ca3558ef9ca9f3c35d0">Body3D::nfacets</a></div><div class="ttdeci">int nfacets</div><div class="ttdef"><b>Definition:</b> <a href="a00189_source.html#l00101">immersedboundaries.h:101</a></div></div>
<div class="ttc" id="a00189_html_aa7bdafcc50881d7f0f4db707755698ce"><div class="ttname"><a href="a00189.html#aa7bdafcc50881d7f0f4db707755698ce">Body3D::surface</a></div><div class="ttdeci">Facet3D * surface</div><div class="ttdef"><b>Definition:</b> <a href="a00189_source.html#l00102">immersedboundaries.h:102</a></div></div>
<div class="ttc" id="a00189_html_a0e1fe82df628138c8f3907ecddb514ae"><div class="ttname"><a href="a00189.html#a0e1fe82df628138c8f3907ecddb514ae">Facet3D::z1</a></div><div class="ttdeci">double z1</div><div class="ttdef"><b>Definition:</b> <a href="a00189_source.html#l00040">immersedboundaries.h:40</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a783bf18458c856297374e733c1d503ff"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int IBCleanup </td>
          <td>(</td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="a00322_source.html#l00011">11</a> of file <a class="el" href="a00322_source.html">IBCleanup.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;{</div>
<div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;  <a class="code" href="a00189.html#a00661">ImmersedBoundary</a> *ib = (<a class="code" href="a00189.html#a00661">ImmersedBoundary</a>*) s;</div>
<div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;  <span class="keywordflow">if</span> (!ib) <span class="keywordflow">return</span>(0);</div>
<div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;</div>
<div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;  free(ib-&gt;<a class="code" href="a00189.html#af858f0e9bc4a6cb1c16ad2931cf4b43d">body</a>-&gt;<a class="code" href="a00189.html#aa7bdafcc50881d7f0f4db707755698ce">surface</a>);</div>
<div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;  free(ib-&gt;<a class="code" href="a00189.html#af858f0e9bc4a6cb1c16ad2931cf4b43d">body</a>);</div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;</div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;  <span class="keywordflow">if</span> (ib-&gt;<a class="code" href="a00189.html#a7f578e3fbaeeea97b65e3ade80f60a78">n_boundary_nodes</a> &gt; 0) free(ib-&gt;<a class="code" href="a00189.html#aeab4c13a1e3fce2920ce0ff616d0fac5">boundary</a>);</div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;  <span class="keywordflow">if</span> (ib-&gt;<a class="code" href="a00189.html#ab3583871695c8f2fc06011d14e092d09">nfacets_local</a> &gt; 0) free(ib-&gt;<a class="code" href="a00189.html#a83fe29d69e04c222af5c68e38142336c">fmap</a>);</div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;</div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;  <span class="keywordflow">return</span>(0);</div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;}</div>
<div class="ttc" id="a00189_html_af858f0e9bc4a6cb1c16ad2931cf4b43d"><div class="ttname"><a href="a00189.html#af858f0e9bc4a6cb1c16ad2931cf4b43d">ImmersedBoundary::body</a></div><div class="ttdeci">Body3D * body</div><div class="ttdef"><b>Definition:</b> <a href="a00189_source.html#l00154">immersedboundaries.h:154</a></div></div>
<div class="ttc" id="a00189_html_aeab4c13a1e3fce2920ce0ff616d0fac5"><div class="ttname"><a href="a00189.html#aeab4c13a1e3fce2920ce0ff616d0fac5">ImmersedBoundary::boundary</a></div><div class="ttdeci">IBNode * boundary</div><div class="ttdef"><b>Definition:</b> <a href="a00189_source.html#l00155">immersedboundaries.h:155</a></div></div>
<div class="ttc" id="a00189_html_a00661"><div class="ttname"><a href="a00189.html#a00661">ImmersedBoundary</a></div><div class="ttdoc">Structure containing variables for immersed boundary implementation. </div><div class="ttdef"><b>Definition:</b> <a href="a00189_source.html#l00153">immersedboundaries.h:153</a></div></div>
<div class="ttc" id="a00189_html_a7f578e3fbaeeea97b65e3ade80f60a78"><div class="ttname"><a href="a00189.html#a7f578e3fbaeeea97b65e3ade80f60a78">ImmersedBoundary::n_boundary_nodes</a></div><div class="ttdeci">int n_boundary_nodes</div><div class="ttdef"><b>Definition:</b> <a href="a00189_source.html#l00161">immersedboundaries.h:161</a></div></div>
<div class="ttc" id="a00189_html_ab3583871695c8f2fc06011d14e092d09"><div class="ttname"><a href="a00189.html#ab3583871695c8f2fc06011d14e092d09">ImmersedBoundary::nfacets_local</a></div><div class="ttdeci">int nfacets_local</div><div class="ttdef"><b>Definition:</b> <a href="a00189_source.html#l00162">immersedboundaries.h:162</a></div></div>
<div class="ttc" id="a00189_html_aa7bdafcc50881d7f0f4db707755698ce"><div class="ttname"><a href="a00189.html#aa7bdafcc50881d7f0f4db707755698ce">Body3D::surface</a></div><div class="ttdeci">Facet3D * surface</div><div class="ttdef"><b>Definition:</b> <a href="a00189_source.html#l00102">immersedboundaries.h:102</a></div></div>
<div class="ttc" id="a00189_html_a83fe29d69e04c222af5c68e38142336c"><div class="ttname"><a href="a00189.html#a83fe29d69e04c222af5c68e38142336c">ImmersedBoundary::fmap</a></div><div class="ttdeci">FacetMap * fmap</div><div class="ttdef"><b>Definition:</b> <a href="a00189_source.html#l00156">immersedboundaries.h:156</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a59296c4f43deabbc6a9b511ba559a4b4"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int IBComputeBoundingBox </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="a00189.html#a00648">Body3D</a> *&#160;</td>
          <td class="paramname"><em>b</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Compute the bounding box for a given body. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">b</td><td>The body </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="a00323_source.html#l00009">9</a> of file <a class="el" href="a00323_source.html">IBComputeBoundingBox.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;{</div>
<div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;  b-&gt;<a class="code" href="a00189.html#ab5bbe897a0c25c58341c216a1b31fbbf">xmin</a> = b-&gt;<a class="code" href="a00189.html#a30554afc6599846bcd01cbf986d0998a">xmax</a> = b-&gt;<a class="code" href="a00189.html#aa7bdafcc50881d7f0f4db707755698ce">surface</a>[0].<a class="code" href="a00189.html#ac75b803b570527306e1e744bfb7a604f">x1</a>;</div>
<div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;  b-&gt;<a class="code" href="a00189.html#a8c17b15efd6e0337c596d98616e9b9da">ymin</a> = b-&gt;<a class="code" href="a00189.html#afc6ae6b11b9521d908c52e4fb3ea09ce">ymax</a> = b-&gt;<a class="code" href="a00189.html#aa7bdafcc50881d7f0f4db707755698ce">surface</a>[0].<a class="code" href="a00189.html#ac3b72e5b77595ca2340ecf8ccfe5fd99">y1</a>;</div>
<div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;  b-&gt;<a class="code" href="a00189.html#aaea53ab3c236de8e4f167c3807d35b47">zmin</a> = b-&gt;<a class="code" href="a00189.html#ade09ae0d27b0b7a2d1e886efc6d1a500">zmax</a> = b-&gt;<a class="code" href="a00189.html#aa7bdafcc50881d7f0f4db707755698ce">surface</a>[0].<a class="code" href="a00189.html#a0e1fe82df628138c8f3907ecddb514ae">z1</a>;</div>
<div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;</div>
<div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;  <span class="keywordtype">int</span> n;</div>
<div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;  <span class="keywordflow">for</span> (n = 0; n &lt; b-&gt;<a class="code" href="a00189.html#afd755b081f4d9ca3558ef9ca9f3c35d0">nfacets</a>; n++) {</div>
<div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;    <span class="keywordflow">if</span> (b-&gt;<a class="code" href="a00189.html#aa7bdafcc50881d7f0f4db707755698ce">surface</a>[n].<a class="code" href="a00189.html#ac75b803b570527306e1e744bfb7a604f">x1</a> &lt; b-&gt;<a class="code" href="a00189.html#ab5bbe897a0c25c58341c216a1b31fbbf">xmin</a>) b-&gt;<a class="code" href="a00189.html#ab5bbe897a0c25c58341c216a1b31fbbf">xmin</a> = b-&gt;<a class="code" href="a00189.html#aa7bdafcc50881d7f0f4db707755698ce">surface</a>[n].<a class="code" href="a00189.html#ac75b803b570527306e1e744bfb7a604f">x1</a>;</div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;    <span class="keywordflow">if</span> (b-&gt;<a class="code" href="a00189.html#aa7bdafcc50881d7f0f4db707755698ce">surface</a>[n].<a class="code" href="a00189.html#adcf04f5f1964d18b332643939561da0d">x2</a> &lt; b-&gt;<a class="code" href="a00189.html#ab5bbe897a0c25c58341c216a1b31fbbf">xmin</a>) b-&gt;<a class="code" href="a00189.html#ab5bbe897a0c25c58341c216a1b31fbbf">xmin</a> = b-&gt;<a class="code" href="a00189.html#aa7bdafcc50881d7f0f4db707755698ce">surface</a>[n].<a class="code" href="a00189.html#adcf04f5f1964d18b332643939561da0d">x2</a>;</div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;    <span class="keywordflow">if</span> (b-&gt;<a class="code" href="a00189.html#aa7bdafcc50881d7f0f4db707755698ce">surface</a>[n].<a class="code" href="a00189.html#a98e99f64ddf7321e4eae52beca4b580f">x3</a> &lt; b-&gt;<a class="code" href="a00189.html#ab5bbe897a0c25c58341c216a1b31fbbf">xmin</a>) b-&gt;<a class="code" href="a00189.html#ab5bbe897a0c25c58341c216a1b31fbbf">xmin</a> = b-&gt;<a class="code" href="a00189.html#aa7bdafcc50881d7f0f4db707755698ce">surface</a>[n].<a class="code" href="a00189.html#a98e99f64ddf7321e4eae52beca4b580f">x3</a>;</div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;</div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;    <span class="keywordflow">if</span> (b-&gt;<a class="code" href="a00189.html#aa7bdafcc50881d7f0f4db707755698ce">surface</a>[n].<a class="code" href="a00189.html#ac3b72e5b77595ca2340ecf8ccfe5fd99">y1</a> &lt; b-&gt;<a class="code" href="a00189.html#a8c17b15efd6e0337c596d98616e9b9da">ymin</a>) b-&gt;<a class="code" href="a00189.html#a8c17b15efd6e0337c596d98616e9b9da">ymin</a> = b-&gt;<a class="code" href="a00189.html#aa7bdafcc50881d7f0f4db707755698ce">surface</a>[n].<a class="code" href="a00189.html#ac3b72e5b77595ca2340ecf8ccfe5fd99">y1</a>;</div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;    <span class="keywordflow">if</span> (b-&gt;<a class="code" href="a00189.html#aa7bdafcc50881d7f0f4db707755698ce">surface</a>[n].<a class="code" href="a00189.html#a5347e514ebe985fb371754ffd2b5ff83">y2</a> &lt; b-&gt;<a class="code" href="a00189.html#a8c17b15efd6e0337c596d98616e9b9da">ymin</a>) b-&gt;<a class="code" href="a00189.html#a8c17b15efd6e0337c596d98616e9b9da">ymin</a> = b-&gt;<a class="code" href="a00189.html#aa7bdafcc50881d7f0f4db707755698ce">surface</a>[n].<a class="code" href="a00189.html#a5347e514ebe985fb371754ffd2b5ff83">y2</a>;</div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;    <span class="keywordflow">if</span> (b-&gt;<a class="code" href="a00189.html#aa7bdafcc50881d7f0f4db707755698ce">surface</a>[n].<a class="code" href="a00189.html#a786634d3d364cf94d8eb600ce7136355">y3</a> &lt; b-&gt;<a class="code" href="a00189.html#a8c17b15efd6e0337c596d98616e9b9da">ymin</a>) b-&gt;<a class="code" href="a00189.html#a8c17b15efd6e0337c596d98616e9b9da">ymin</a> = b-&gt;<a class="code" href="a00189.html#aa7bdafcc50881d7f0f4db707755698ce">surface</a>[n].<a class="code" href="a00189.html#a786634d3d364cf94d8eb600ce7136355">y3</a>;</div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;</div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;    <span class="keywordflow">if</span> (b-&gt;<a class="code" href="a00189.html#aa7bdafcc50881d7f0f4db707755698ce">surface</a>[n].<a class="code" href="a00189.html#a0e1fe82df628138c8f3907ecddb514ae">z1</a> &lt; b-&gt;<a class="code" href="a00189.html#aaea53ab3c236de8e4f167c3807d35b47">zmin</a>) b-&gt;<a class="code" href="a00189.html#aaea53ab3c236de8e4f167c3807d35b47">zmin</a> = b-&gt;<a class="code" href="a00189.html#aa7bdafcc50881d7f0f4db707755698ce">surface</a>[n].<a class="code" href="a00189.html#a0e1fe82df628138c8f3907ecddb514ae">z1</a>;</div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;    <span class="keywordflow">if</span> (b-&gt;<a class="code" href="a00189.html#aa7bdafcc50881d7f0f4db707755698ce">surface</a>[n].<a class="code" href="a00189.html#a822ab991099a420eb62b3f0e2b0021a2">z2</a> &lt; b-&gt;<a class="code" href="a00189.html#aaea53ab3c236de8e4f167c3807d35b47">zmin</a>) b-&gt;<a class="code" href="a00189.html#aaea53ab3c236de8e4f167c3807d35b47">zmin</a> = b-&gt;<a class="code" href="a00189.html#aa7bdafcc50881d7f0f4db707755698ce">surface</a>[n].<a class="code" href="a00189.html#a822ab991099a420eb62b3f0e2b0021a2">z2</a>;</div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;    <span class="keywordflow">if</span> (b-&gt;<a class="code" href="a00189.html#aa7bdafcc50881d7f0f4db707755698ce">surface</a>[n].<a class="code" href="a00189.html#a270503fb34041aa050ec80858f7820a7">z3</a> &lt; b-&gt;<a class="code" href="a00189.html#aaea53ab3c236de8e4f167c3807d35b47">zmin</a>) b-&gt;<a class="code" href="a00189.html#aaea53ab3c236de8e4f167c3807d35b47">zmin</a> = b-&gt;<a class="code" href="a00189.html#aa7bdafcc50881d7f0f4db707755698ce">surface</a>[n].<a class="code" href="a00189.html#a270503fb34041aa050ec80858f7820a7">z3</a>;</div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;</div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;    <span class="keywordflow">if</span> (b-&gt;<a class="code" href="a00189.html#aa7bdafcc50881d7f0f4db707755698ce">surface</a>[n].<a class="code" href="a00189.html#ac75b803b570527306e1e744bfb7a604f">x1</a> &gt; b-&gt;<a class="code" href="a00189.html#a30554afc6599846bcd01cbf986d0998a">xmax</a>) b-&gt;<a class="code" href="a00189.html#a30554afc6599846bcd01cbf986d0998a">xmax</a> = b-&gt;<a class="code" href="a00189.html#aa7bdafcc50881d7f0f4db707755698ce">surface</a>[n].<a class="code" href="a00189.html#ac75b803b570527306e1e744bfb7a604f">x1</a>;</div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;    <span class="keywordflow">if</span> (b-&gt;<a class="code" href="a00189.html#aa7bdafcc50881d7f0f4db707755698ce">surface</a>[n].<a class="code" href="a00189.html#adcf04f5f1964d18b332643939561da0d">x2</a> &gt; b-&gt;<a class="code" href="a00189.html#a30554afc6599846bcd01cbf986d0998a">xmax</a>) b-&gt;<a class="code" href="a00189.html#a30554afc6599846bcd01cbf986d0998a">xmax</a> = b-&gt;<a class="code" href="a00189.html#aa7bdafcc50881d7f0f4db707755698ce">surface</a>[n].<a class="code" href="a00189.html#adcf04f5f1964d18b332643939561da0d">x2</a>;</div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;    <span class="keywordflow">if</span> (b-&gt;<a class="code" href="a00189.html#aa7bdafcc50881d7f0f4db707755698ce">surface</a>[n].<a class="code" href="a00189.html#a98e99f64ddf7321e4eae52beca4b580f">x3</a> &gt; b-&gt;<a class="code" href="a00189.html#a30554afc6599846bcd01cbf986d0998a">xmax</a>) b-&gt;<a class="code" href="a00189.html#a30554afc6599846bcd01cbf986d0998a">xmax</a> = b-&gt;<a class="code" href="a00189.html#aa7bdafcc50881d7f0f4db707755698ce">surface</a>[n].<a class="code" href="a00189.html#a98e99f64ddf7321e4eae52beca4b580f">x3</a>;</div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;</div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;    <span class="keywordflow">if</span> (b-&gt;<a class="code" href="a00189.html#aa7bdafcc50881d7f0f4db707755698ce">surface</a>[n].<a class="code" href="a00189.html#ac3b72e5b77595ca2340ecf8ccfe5fd99">y1</a> &gt; b-&gt;<a class="code" href="a00189.html#afc6ae6b11b9521d908c52e4fb3ea09ce">ymax</a>) b-&gt;<a class="code" href="a00189.html#afc6ae6b11b9521d908c52e4fb3ea09ce">ymax</a> = b-&gt;<a class="code" href="a00189.html#aa7bdafcc50881d7f0f4db707755698ce">surface</a>[n].<a class="code" href="a00189.html#ac3b72e5b77595ca2340ecf8ccfe5fd99">y1</a>;</div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;    <span class="keywordflow">if</span> (b-&gt;<a class="code" href="a00189.html#aa7bdafcc50881d7f0f4db707755698ce">surface</a>[n].<a class="code" href="a00189.html#a5347e514ebe985fb371754ffd2b5ff83">y2</a> &gt; b-&gt;<a class="code" href="a00189.html#afc6ae6b11b9521d908c52e4fb3ea09ce">ymax</a>) b-&gt;<a class="code" href="a00189.html#afc6ae6b11b9521d908c52e4fb3ea09ce">ymax</a> = b-&gt;<a class="code" href="a00189.html#aa7bdafcc50881d7f0f4db707755698ce">surface</a>[n].<a class="code" href="a00189.html#a5347e514ebe985fb371754ffd2b5ff83">y2</a>;</div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;    <span class="keywordflow">if</span> (b-&gt;<a class="code" href="a00189.html#aa7bdafcc50881d7f0f4db707755698ce">surface</a>[n].<a class="code" href="a00189.html#a786634d3d364cf94d8eb600ce7136355">y3</a> &gt; b-&gt;<a class="code" href="a00189.html#afc6ae6b11b9521d908c52e4fb3ea09ce">ymax</a>) b-&gt;<a class="code" href="a00189.html#afc6ae6b11b9521d908c52e4fb3ea09ce">ymax</a> = b-&gt;<a class="code" href="a00189.html#aa7bdafcc50881d7f0f4db707755698ce">surface</a>[n].<a class="code" href="a00189.html#a786634d3d364cf94d8eb600ce7136355">y3</a>;</div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;</div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;    <span class="keywordflow">if</span> (b-&gt;<a class="code" href="a00189.html#aa7bdafcc50881d7f0f4db707755698ce">surface</a>[n].<a class="code" href="a00189.html#a0e1fe82df628138c8f3907ecddb514ae">z1</a> &gt; b-&gt;<a class="code" href="a00189.html#ade09ae0d27b0b7a2d1e886efc6d1a500">zmax</a>) b-&gt;<a class="code" href="a00189.html#ade09ae0d27b0b7a2d1e886efc6d1a500">zmax</a> = b-&gt;<a class="code" href="a00189.html#aa7bdafcc50881d7f0f4db707755698ce">surface</a>[n].<a class="code" href="a00189.html#a0e1fe82df628138c8f3907ecddb514ae">z1</a>;</div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;    <span class="keywordflow">if</span> (b-&gt;<a class="code" href="a00189.html#aa7bdafcc50881d7f0f4db707755698ce">surface</a>[n].<a class="code" href="a00189.html#a822ab991099a420eb62b3f0e2b0021a2">z2</a> &gt; b-&gt;<a class="code" href="a00189.html#ade09ae0d27b0b7a2d1e886efc6d1a500">zmax</a>) b-&gt;<a class="code" href="a00189.html#ade09ae0d27b0b7a2d1e886efc6d1a500">zmax</a> = b-&gt;<a class="code" href="a00189.html#aa7bdafcc50881d7f0f4db707755698ce">surface</a>[n].<a class="code" href="a00189.html#a822ab991099a420eb62b3f0e2b0021a2">z2</a>;</div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;    <span class="keywordflow">if</span> (b-&gt;<a class="code" href="a00189.html#aa7bdafcc50881d7f0f4db707755698ce">surface</a>[n].<a class="code" href="a00189.html#a270503fb34041aa050ec80858f7820a7">z3</a> &gt; b-&gt;<a class="code" href="a00189.html#ade09ae0d27b0b7a2d1e886efc6d1a500">zmax</a>) b-&gt;<a class="code" href="a00189.html#ade09ae0d27b0b7a2d1e886efc6d1a500">zmax</a> = b-&gt;<a class="code" href="a00189.html#aa7bdafcc50881d7f0f4db707755698ce">surface</a>[n].<a class="code" href="a00189.html#a270503fb34041aa050ec80858f7820a7">z3</a>;</div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;  }</div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;  <span class="keywordflow">return</span>(0);</div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;}</div>
<div class="ttc" id="a00189_html_ac75b803b570527306e1e744bfb7a604f"><div class="ttname"><a href="a00189.html#ac75b803b570527306e1e744bfb7a604f">Facet3D::x1</a></div><div class="ttdeci">double x1</div><div class="ttdef"><b>Definition:</b> <a href="a00189_source.html#l00040">immersedboundaries.h:40</a></div></div>
<div class="ttc" id="a00189_html_a5347e514ebe985fb371754ffd2b5ff83"><div class="ttname"><a href="a00189.html#a5347e514ebe985fb371754ffd2b5ff83">Facet3D::y2</a></div><div class="ttdeci">double y2</div><div class="ttdef"><b>Definition:</b> <a href="a00189_source.html#l00040">immersedboundaries.h:40</a></div></div>
<div class="ttc" id="a00189_html_ac3b72e5b77595ca2340ecf8ccfe5fd99"><div class="ttname"><a href="a00189.html#ac3b72e5b77595ca2340ecf8ccfe5fd99">Facet3D::y1</a></div><div class="ttdeci">double y1</div><div class="ttdef"><b>Definition:</b> <a href="a00189_source.html#l00040">immersedboundaries.h:40</a></div></div>
<div class="ttc" id="a00189_html_ade09ae0d27b0b7a2d1e886efc6d1a500"><div class="ttname"><a href="a00189.html#ade09ae0d27b0b7a2d1e886efc6d1a500">Body3D::zmax</a></div><div class="ttdeci">double zmax</div><div class="ttdef"><b>Definition:</b> <a href="a00189_source.html#l00104">immersedboundaries.h:104</a></div></div>
<div class="ttc" id="a00189_html_a822ab991099a420eb62b3f0e2b0021a2"><div class="ttname"><a href="a00189.html#a822ab991099a420eb62b3f0e2b0021a2">Facet3D::z2</a></div><div class="ttdeci">double z2</div><div class="ttdef"><b>Definition:</b> <a href="a00189_source.html#l00040">immersedboundaries.h:40</a></div></div>
<div class="ttc" id="a00189_html_adcf04f5f1964d18b332643939561da0d"><div class="ttname"><a href="a00189.html#adcf04f5f1964d18b332643939561da0d">Facet3D::x2</a></div><div class="ttdeci">double x2</div><div class="ttdef"><b>Definition:</b> <a href="a00189_source.html#l00040">immersedboundaries.h:40</a></div></div>
<div class="ttc" id="a00189_html_afc6ae6b11b9521d908c52e4fb3ea09ce"><div class="ttname"><a href="a00189.html#afc6ae6b11b9521d908c52e4fb3ea09ce">Body3D::ymax</a></div><div class="ttdeci">double ymax</div><div class="ttdef"><b>Definition:</b> <a href="a00189_source.html#l00104">immersedboundaries.h:104</a></div></div>
<div class="ttc" id="a00189_html_a98e99f64ddf7321e4eae52beca4b580f"><div class="ttname"><a href="a00189.html#a98e99f64ddf7321e4eae52beca4b580f">Facet3D::x3</a></div><div class="ttdeci">double x3</div><div class="ttdef"><b>Definition:</b> <a href="a00189_source.html#l00040">immersedboundaries.h:40</a></div></div>
<div class="ttc" id="a00189_html_a8c17b15efd6e0337c596d98616e9b9da"><div class="ttname"><a href="a00189.html#a8c17b15efd6e0337c596d98616e9b9da">Body3D::ymin</a></div><div class="ttdeci">double ymin</div><div class="ttdef"><b>Definition:</b> <a href="a00189_source.html#l00104">immersedboundaries.h:104</a></div></div>
<div class="ttc" id="a00189_html_a30554afc6599846bcd01cbf986d0998a"><div class="ttname"><a href="a00189.html#a30554afc6599846bcd01cbf986d0998a">Body3D::xmax</a></div><div class="ttdeci">double xmax</div><div class="ttdef"><b>Definition:</b> <a href="a00189_source.html#l00104">immersedboundaries.h:104</a></div></div>
<div class="ttc" id="a00189_html_ab5bbe897a0c25c58341c216a1b31fbbf"><div class="ttname"><a href="a00189.html#ab5bbe897a0c25c58341c216a1b31fbbf">Body3D::xmin</a></div><div class="ttdeci">double xmin</div><div class="ttdef"><b>Definition:</b> <a href="a00189_source.html#l00104">immersedboundaries.h:104</a></div></div>
<div class="ttc" id="a00189_html_aaea53ab3c236de8e4f167c3807d35b47"><div class="ttname"><a href="a00189.html#aaea53ab3c236de8e4f167c3807d35b47">Body3D::zmin</a></div><div class="ttdeci">double zmin</div><div class="ttdef"><b>Definition:</b> <a href="a00189_source.html#l00104">immersedboundaries.h:104</a></div></div>
<div class="ttc" id="a00189_html_a270503fb34041aa050ec80858f7820a7"><div class="ttname"><a href="a00189.html#a270503fb34041aa050ec80858f7820a7">Facet3D::z3</a></div><div class="ttdeci">double z3</div><div class="ttdef"><b>Definition:</b> <a href="a00189_source.html#l00040">immersedboundaries.h:40</a></div></div>
<div class="ttc" id="a00189_html_a786634d3d364cf94d8eb600ce7136355"><div class="ttname"><a href="a00189.html#a786634d3d364cf94d8eb600ce7136355">Facet3D::y3</a></div><div class="ttdeci">double y3</div><div class="ttdef"><b>Definition:</b> <a href="a00189_source.html#l00040">immersedboundaries.h:40</a></div></div>
<div class="ttc" id="a00189_html_afd755b081f4d9ca3558ef9ca9f3c35d0"><div class="ttname"><a href="a00189.html#afd755b081f4d9ca3558ef9ca9f3c35d0">Body3D::nfacets</a></div><div class="ttdeci">int nfacets</div><div class="ttdef"><b>Definition:</b> <a href="a00189_source.html#l00101">immersedboundaries.h:101</a></div></div>
<div class="ttc" id="a00189_html_aa7bdafcc50881d7f0f4db707755698ce"><div class="ttname"><a href="a00189.html#aa7bdafcc50881d7f0f4db707755698ce">Body3D::surface</a></div><div class="ttdeci">Facet3D * surface</div><div class="ttdef"><b>Definition:</b> <a href="a00189_source.html#l00102">immersedboundaries.h:102</a></div></div>
<div class="ttc" id="a00189_html_a0e1fe82df628138c8f3907ecddb514ae"><div class="ttname"><a href="a00189.html#a0e1fe82df628138c8f3907ecddb514ae">Facet3D::z1</a></div><div class="ttdeci">double z1</div><div class="ttdef"><b>Definition:</b> <a href="a00189_source.html#l00040">immersedboundaries.h:40</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a0575b5233bc22af6797e2c7b0d95f469"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int IBCreateFacetMapping </td>
          <td>(</td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>ib</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>m</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>X</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>dim</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>ghosts</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>This function creates a "facet map", i.e., on each MPI rank, it does the following:</p>
<ul>
<li>Makes a list of facets (defining the immersed body surface) that lie within the local computational domain of this MPI rank ("local facets").</li>
<li>For each local facet, finds and stores the indices of the grid points that surround it, as well as the trilinear interpolation coefficients.</li>
<li>For each local facet, finds a "near-surface" point, i.e., a point near the surface ("near" in terms of the local grid spacing) along the outward surface normal (i.e., outside the body), and finds and stores the indices of the grid points that surround it, as well as the trilinear interpolation coefficients.</li>
</ul>
<p>Note: each MPI rank has a copy of the entire immersed body, i.e., all the facets. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ib</td><td>Immersed boundary object of type <a class="el" href="a00189.html#a00661" title="Structure containing variables for immersed boundary implementation. ">ImmersedBoundary</a> </td></tr>
    <tr><td class="paramname">m</td><td>MPI object of type <a class="el" href="a00205.html#a00663" title="Structure of MPI-related variables. ">MPIVariables</a> </td></tr>
    <tr><td class="paramname">X</td><td>Array of local spatial coordinates </td></tr>
    <tr><td class="paramname">dim</td><td>Local dimensions </td></tr>
    <tr><td class="paramname">ghosts</td><td>Number of ghost points </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="a00326_source.html#l00143">143</a> of file <a class="el" href="a00326_source.html">IBCreateFacetMapping.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;{</div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;  <a class="code" href="a00189.html#a00661">ImmersedBoundary</a>  *IB     = (<a class="code" href="a00189.html#a00661">ImmersedBoundary</a>*) ib;</div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;  <a class="code" href="a00205.html#a00663">MPIVariables</a>      *mpi    = (<a class="code" href="a00205.html#a00663">MPIVariables</a>*) m;</div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;  <a class="code" href="a00189.html#a00648">Body3D</a>            *body   = IB-&gt;<a class="code" href="a00189.html#af858f0e9bc4a6cb1c16ad2931cf4b43d">body</a>;</div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;  <span class="keywordtype">int</span>               nfacets = body-&gt;<a class="code" href="a00189.html#afd755b081f4d9ca3558ef9ca9f3c35d0">nfacets</a>, n, count, ierr;</div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;  <a class="code" href="a00189.html#a00653">Facet3D</a>           *facets = body-&gt;<a class="code" href="a00189.html#aa7bdafcc50881d7f0f4db707755698ce">surface</a>;</div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;</div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;  <span class="keywordtype">double</span>  *x = X, </div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;          *y = (x + dim[0] + 2*ghosts), </div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;          *z = (y + dim[1] + 2*ghosts);</div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;</div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;  <span class="keywordtype">double</span>  xmin = 0.5 * (x[ghosts-1]         + x[ghosts]),</div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;          xmax = 0.5 * (x[dim[0]+ghosts-1]  + x[dim[0]+ghosts]),</div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;          ymin = 0.5 * (y[ghosts-1]         + y[ghosts]),</div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;          ymax = 0.5 * (y[dim[1]+ghosts-1]  + y[dim[1]+ghosts]),</div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;          zmin = 0.5 * (z[ghosts-1]         + z[ghosts]),</div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;          zmax = 0.5 * (z[dim[2]+ghosts-1]  + z[dim[2]+ghosts]);</div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;</div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;  count = 0;</div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;  <span class="keywordflow">for</span> (n = 0; n &lt; nfacets; n++) {</div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;</div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;    <span class="comment">/* find facet centroid */</span></div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;    <span class="keywordtype">double</span> xc, yc, zc;</div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;    xc = (facets[n].<a class="code" href="a00189.html#ac75b803b570527306e1e744bfb7a604f">x1</a> + facets[n].<a class="code" href="a00189.html#adcf04f5f1964d18b332643939561da0d">x2</a> + facets[n].<a class="code" href="a00189.html#a98e99f64ddf7321e4eae52beca4b580f">x3</a>) / 3.0;</div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;    yc = (facets[n].<a class="code" href="a00189.html#ac3b72e5b77595ca2340ecf8ccfe5fd99">y1</a> + facets[n].<a class="code" href="a00189.html#a5347e514ebe985fb371754ffd2b5ff83">y2</a> + facets[n].<a class="code" href="a00189.html#a786634d3d364cf94d8eb600ce7136355">y3</a>) / 3.0;</div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;    zc = (facets[n].<a class="code" href="a00189.html#a0e1fe82df628138c8f3907ecddb514ae">z1</a> + facets[n].<a class="code" href="a00189.html#a822ab991099a420eb62b3f0e2b0021a2">z2</a> + facets[n].<a class="code" href="a00189.html#a270503fb34041aa050ec80858f7820a7">z3</a>) / 3.0;</div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;</div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;    <span class="keywordflow">if</span> (!strcmp(IB-&gt;<a class="code" href="a00189.html#a935394e510d17282c5697cd76a6e2667">mode</a>,<a class="code" href="a00189.html#a80bdbbd2624bd70748ffd44c11ffd1fb">_IB_3D_</a>)) {</div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="a00326.html#ae5fc4cce9be29ebb8c3d80c534e55720">isInside</a>(xc,xmin,xmax) &amp;&amp; <a class="code" href="a00326.html#ae5fc4cce9be29ebb8c3d80c534e55720">isInside</a>(yc,ymin,ymax) &amp;&amp; <a class="code" href="a00326.html#ae5fc4cce9be29ebb8c3d80c534e55720">isInside</a>(zc,zmin,zmax)) count++;</div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcmp(IB-&gt;<a class="code" href="a00189.html#a935394e510d17282c5697cd76a6e2667">mode</a>,<a class="code" href="a00189.html#a6f872a36881067ae3dbd5a14042cb2d6">_IB_XY_</a>)) {</div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="a00326.html#ae5fc4cce9be29ebb8c3d80c534e55720">isInside</a>(xc,xmin,xmax) &amp;&amp; <a class="code" href="a00326.html#ae5fc4cce9be29ebb8c3d80c534e55720">isInside</a>(yc,ymin,ymax)) count++;</div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcmp(IB-&gt;<a class="code" href="a00189.html#a935394e510d17282c5697cd76a6e2667">mode</a>,<a class="code" href="a00189.html#a948cb38cc6d11f9f4c9030994e9a3367">_IB_XZ_</a>)) {</div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="a00326.html#ae5fc4cce9be29ebb8c3d80c534e55720">isInside</a>(xc,xmin,xmax) &amp;&amp; <a class="code" href="a00326.html#ae5fc4cce9be29ebb8c3d80c534e55720">isInside</a>(zc,zmin,zmax)) count++;</div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcmp(IB-&gt;<a class="code" href="a00189.html#a935394e510d17282c5697cd76a6e2667">mode</a>,<a class="code" href="a00189.html#aa2d4d0cc81beab5f62c5527941655474">_IB_YZ_</a>)) {</div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="a00326.html#ae5fc4cce9be29ebb8c3d80c534e55720">isInside</a>(yc,ymin,ymax) &amp;&amp; <a class="code" href="a00326.html#ae5fc4cce9be29ebb8c3d80c534e55720">isInside</a>(zc,zmin,zmax)) count++;</div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;    }</div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;  }</div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;</div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;  <span class="keywordtype">int</span> nfacets_local = count;</div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;  <span class="keywordflow">if</span> (nfacets_local &gt; 0) {</div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;</div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;    <a class="code" href="a00189.html#a00654">FacetMap</a> *fmap = (<a class="code" href="a00189.html#a00654">FacetMap</a>*) calloc (nfacets_local, <span class="keyword">sizeof</span>(<a class="code" href="a00189.html#a00654">FacetMap</a>));</div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;    count = 0;</div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;</div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;    <span class="keywordflow">for</span> (n = 0; n &lt; nfacets; n++) {</div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;</div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;      <span class="keywordtype">double</span> xc, yc, zc;</div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;      xc = (facets[n].<a class="code" href="a00189.html#ac75b803b570527306e1e744bfb7a604f">x1</a> + facets[n].<a class="code" href="a00189.html#adcf04f5f1964d18b332643939561da0d">x2</a> + facets[n].<a class="code" href="a00189.html#a98e99f64ddf7321e4eae52beca4b580f">x3</a>) / 3.0;</div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;      yc = (facets[n].<a class="code" href="a00189.html#ac3b72e5b77595ca2340ecf8ccfe5fd99">y1</a> + facets[n].<a class="code" href="a00189.html#a5347e514ebe985fb371754ffd2b5ff83">y2</a> + facets[n].<a class="code" href="a00189.html#a786634d3d364cf94d8eb600ce7136355">y3</a>) / 3.0;</div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;      zc = (facets[n].<a class="code" href="a00189.html#a0e1fe82df628138c8f3907ecddb514ae">z1</a> + facets[n].<a class="code" href="a00189.html#a822ab991099a420eb62b3f0e2b0021a2">z2</a> + facets[n].<a class="code" href="a00189.html#a270503fb34041aa050ec80858f7820a7">z3</a>) / 3.0;</div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;</div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;      <span class="keywordtype">int</span> flag = 0;</div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;      <span class="keywordflow">if</span> (!strcmp(IB-&gt;<a class="code" href="a00189.html#a935394e510d17282c5697cd76a6e2667">mode</a>,<a class="code" href="a00189.html#a80bdbbd2624bd70748ffd44c11ffd1fb">_IB_3D_</a>)) {</div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="a00326.html#ae5fc4cce9be29ebb8c3d80c534e55720">isInside</a>(xc,xmin,xmax) &amp;&amp; <a class="code" href="a00326.html#ae5fc4cce9be29ebb8c3d80c534e55720">isInside</a>(yc,ymin,ymax) &amp;&amp; <a class="code" href="a00326.html#ae5fc4cce9be29ebb8c3d80c534e55720">isInside</a>(zc,zmin,zmax)) flag = 1;</div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;      } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcmp(IB-&gt;<a class="code" href="a00189.html#a935394e510d17282c5697cd76a6e2667">mode</a>,<a class="code" href="a00189.html#a6f872a36881067ae3dbd5a14042cb2d6">_IB_XY_</a>)) {</div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="a00326.html#ae5fc4cce9be29ebb8c3d80c534e55720">isInside</a>(xc,xmin,xmax) &amp;&amp; <a class="code" href="a00326.html#ae5fc4cce9be29ebb8c3d80c534e55720">isInside</a>(yc,ymin,ymax)) flag = 1;</div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;      } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcmp(IB-&gt;<a class="code" href="a00189.html#a935394e510d17282c5697cd76a6e2667">mode</a>,<a class="code" href="a00189.html#a948cb38cc6d11f9f4c9030994e9a3367">_IB_XZ_</a>)) {</div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="a00326.html#ae5fc4cce9be29ebb8c3d80c534e55720">isInside</a>(xc,xmin,xmax) &amp;&amp; <a class="code" href="a00326.html#ae5fc4cce9be29ebb8c3d80c534e55720">isInside</a>(zc,zmin,zmax)) flag = 1;</div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;      } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcmp(IB-&gt;<a class="code" href="a00189.html#a935394e510d17282c5697cd76a6e2667">mode</a>,<a class="code" href="a00189.html#aa2d4d0cc81beab5f62c5527941655474">_IB_YZ_</a>)) {</div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="a00326.html#ae5fc4cce9be29ebb8c3d80c534e55720">isInside</a>(yc,ymin,ymax) &amp;&amp; <a class="code" href="a00326.html#ae5fc4cce9be29ebb8c3d80c534e55720">isInside</a>(zc,zmin,zmax)) flag = 1;</div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;      }</div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;</div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;      <span class="keywordflow">if</span> (flag == 1) {</div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;        fmap[count].<a class="code" href="a00189.html#adc15fcdbb3aaff6ced4ab10162781055">facet</a> = facets + n;</div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;        fmap[count].<a class="code" href="a00189.html#a750b5d744c39a06bfb13e6eb010e35d0">index</a> = n;</div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;        </div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;        fmap[count].<a class="code" href="a00189.html#abaefdeffb1a6c37ecbbba1abe183a288">xc</a> = xc;</div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;        fmap[count].<a class="code" href="a00189.html#a31d2d6327e76038cd2aee5b972f6a9b3">yc</a> = yc;</div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;        fmap[count].<a class="code" href="a00189.html#ae4077e68c108b9ac7d51ef8560c3eebb">zc</a> = zc;</div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;</div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;        <span class="keywordtype">int</span> ic,jc, kc;</div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;</div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;        ierr = <a class="code" href="a00326.html#ac8dd87df944e8659dedfa3171e832f44">interpNodesCoeffs</a>( mpi,</div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;                                  xc, yc, zc,</div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;                                  x, y, z,</div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;                                  dim,</div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;                                  ghosts,</div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;                                  IB-&gt;<a class="code" href="a00189.html#a935394e510d17282c5697cd76a6e2667">mode</a>,</div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;                                  &amp;ic, &amp;jc, &amp;kc,</div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;                                  fmap[count].<a class="code" href="a00189.html#a849cc8a5a571348a4d50a0332d9816f8">interp_nodes</a>,</div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;                                  fmap[count].<a class="code" href="a00189.html#a4855c244bb3e3ba9b245312a375eed76">interp_coeffs</a> );</div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;        <span class="keywordflow">if</span> (ierr) {</div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;          fprintf(stderr, <span class="stringliteral">&quot;Error in IBCreateFacetMapping(): \n&quot;</span>);</div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;          fprintf(stderr, <span class="stringliteral">&quot;  interpNodesCoeffs() returned with error code %d on rank %d.\n&quot;</span>,</div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;                  ierr, mpi-&gt;<a class="code" href="a00205.html#a6cfd95afd0afebd625b889fb6e58371c">rank</a> );</div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;          <span class="keywordflow">return</span>(ierr);</div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;        }</div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;</div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;        <span class="keywordtype">double</span> dx = x[ic] - x[ic-1];</div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;        <span class="keywordtype">double</span> dy = y[jc] - y[jc-1];</div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;        <span class="keywordtype">double</span> dz = z[kc] - z[kc-1];</div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;        <span class="keywordtype">double</span> ds;</div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;        <span class="keywordflow">if</span>      (!strcmp(IB-&gt;<a class="code" href="a00189.html#a935394e510d17282c5697cd76a6e2667">mode</a>,<a class="code" href="a00189.html#a6f872a36881067ae3dbd5a14042cb2d6">_IB_XY_</a>)) ds = <a class="code" href="a00243.html#ac6afabdc09a49a433ee19d8a9486056d">min</a>(dx,dy);</div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcmp(IB-&gt;<a class="code" href="a00189.html#a935394e510d17282c5697cd76a6e2667">mode</a>,<a class="code" href="a00189.html#a948cb38cc6d11f9f4c9030994e9a3367">_IB_XZ_</a>)) ds = <a class="code" href="a00243.html#ac6afabdc09a49a433ee19d8a9486056d">min</a>(dx,dz);</div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcmp(IB-&gt;<a class="code" href="a00189.html#a935394e510d17282c5697cd76a6e2667">mode</a>,<a class="code" href="a00189.html#aa2d4d0cc81beab5f62c5527941655474">_IB_YZ_</a>)) ds = <a class="code" href="a00243.html#ac6afabdc09a49a433ee19d8a9486056d">min</a>(dy,dz);</div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;        <span class="keywordflow">else</span>                                ds = <a class="code" href="a00243.html#ab1e1ffb6aa15887fa3bda4cfdef1f53a">min3</a>(dx,dy,dz);</div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;</div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;        <span class="keywordtype">double</span> nx = fmap[count].<a class="code" href="a00189.html#adc15fcdbb3aaff6ced4ab10162781055">facet</a>-&gt;<a class="code" href="a00189.html#a74d07ed95c86939416c6a88f1daf8e1a">nx</a>;</div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;        <span class="keywordtype">double</span> ny = fmap[count].<a class="code" href="a00189.html#adc15fcdbb3aaff6ced4ab10162781055">facet</a>-&gt;<a class="code" href="a00189.html#a147a8b14bbd79c0f1a3457805e2065ba">ny</a>;</div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;        <span class="keywordtype">double</span> nz = fmap[count].<a class="code" href="a00189.html#adc15fcdbb3aaff6ced4ab10162781055">facet</a>-&gt;<a class="code" href="a00189.html#a463bf8b21578003b62221acf2e522134">nz</a>;</div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;</div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;        <span class="keywordflow">if</span> (nx == 0.0) nx += IB-&gt;<a class="code" href="a00189.html#a9ea1a8f5ef3e6d20b362385e1288c72c">delta</a>*ds;</div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;        <span class="keywordflow">if</span> (ny == 0.0) ny += IB-&gt;<a class="code" href="a00189.html#a9ea1a8f5ef3e6d20b362385e1288c72c">delta</a>*ds;</div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;        <span class="keywordflow">if</span> (nz == 0.0) nz += IB-&gt;<a class="code" href="a00189.html#a9ea1a8f5ef3e6d20b362385e1288c72c">delta</a>*ds;</div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;</div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;        <span class="keywordtype">double</span> xns = xc + <a class="code" href="a00243.html#a1e471b644e7fd684cd5dbb144e00ee81">sign</a>(nx)*ds;</div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;        <span class="keywordtype">double</span> yns = yc + <a class="code" href="a00243.html#a1e471b644e7fd684cd5dbb144e00ee81">sign</a>(ny)*ds;</div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;        <span class="keywordtype">double</span> zns = zc + <a class="code" href="a00243.html#a1e471b644e7fd684cd5dbb144e00ee81">sign</a>(nz)*ds;</div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;</div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;        fmap[count].<a class="code" href="a00189.html#a229d11aff11a7482259d1296b9b70b8a">dx</a> = xns - xc;</div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;        fmap[count].<a class="code" href="a00189.html#a9deb6f886b19d50e714d890c3c268efc">dy</a> = yns - yc;</div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;        fmap[count].<a class="code" href="a00189.html#a5a198de8c3f38514f4e55231aa69cd10">dz</a> = zns - zc;</div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;</div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;        ierr = <a class="code" href="a00326.html#ac8dd87df944e8659dedfa3171e832f44">interpNodesCoeffs</a>( mpi,</div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;                                  xns, yns, zns,</div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;                                  x, y, z,</div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;                                  dim,</div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;                                  ghosts,</div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;                                  IB-&gt;<a class="code" href="a00189.html#a935394e510d17282c5697cd76a6e2667">mode</a>,</div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;                                  NULL,NULL,NULL,</div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;                                  fmap[count].<a class="code" href="a00189.html#ae7231c0798d24ebed4aec9c288cb8d4f">interp_nodes_ns</a>,</div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;                                  fmap[count].<a class="code" href="a00189.html#a047220645840c2812b0c4b0a714ce824">interp_coeffs_ns</a> );</div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;        <span class="keywordflow">if</span> (ierr) {</div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;          fprintf(stderr, <span class="stringliteral">&quot;Error in IBCreateFacetMapping(): \n&quot;</span>);</div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;          fprintf(stderr, <span class="stringliteral">&quot;  interpNodesCoeffs() returned with error code %d on rank %d.\n&quot;</span>,</div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;                  ierr, mpi-&gt;<a class="code" href="a00205.html#a6cfd95afd0afebd625b889fb6e58371c">rank</a> );</div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;          <span class="keywordflow">return</span>(ierr);</div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;        }</div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;</div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;        count++;</div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;      }</div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;    }</div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;</div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;    IB-&gt;<a class="code" href="a00189.html#ab3583871695c8f2fc06011d14e092d09">nfacets_local</a> = nfacets_local;</div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;    IB-&gt;<a class="code" href="a00189.html#a83fe29d69e04c222af5c68e38142336c">fmap</a> = fmap;  </div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;</div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;  } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;</div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;    IB-&gt;<a class="code" href="a00189.html#ab3583871695c8f2fc06011d14e092d09">nfacets_local</a> = 0;</div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;    IB-&gt;<a class="code" href="a00189.html#a83fe29d69e04c222af5c68e38142336c">fmap</a> = NULL;</div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;</div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;  }</div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;</div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;  <span class="keywordflow">return</span>(0);</div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;}</div>
<div class="ttc" id="a00189_html_ac75b803b570527306e1e744bfb7a604f"><div class="ttname"><a href="a00189.html#ac75b803b570527306e1e744bfb7a604f">Facet3D::x1</a></div><div class="ttdeci">double x1</div><div class="ttdef"><b>Definition:</b> <a href="a00189_source.html#l00040">immersedboundaries.h:40</a></div></div>
<div class="ttc" id="a00189_html_a948cb38cc6d11f9f4c9030994e9a3367"><div class="ttname"><a href="a00189.html#a948cb38cc6d11f9f4c9030994e9a3367">_IB_XZ_</a></div><div class="ttdeci">#define _IB_XZ_</div><div class="ttdef"><b>Definition:</b> <a href="a00189_source.html#l00018">immersedboundaries.h:18</a></div></div>
<div class="ttc" id="a00189_html_adc15fcdbb3aaff6ced4ab10162781055"><div class="ttname"><a href="a00189.html#adc15fcdbb3aaff6ced4ab10162781055">FacetMap::facet</a></div><div class="ttdeci">Facet3D * facet</div><div class="ttdef"><b>Definition:</b> <a href="a00189_source.html#l00068">immersedboundaries.h:68</a></div></div>
<div class="ttc" id="a00189_html_a9ea1a8f5ef3e6d20b362385e1288c72c"><div class="ttname"><a href="a00189.html#a9ea1a8f5ef3e6d20b362385e1288c72c">ImmersedBoundary::delta</a></div><div class="ttdeci">double delta</div><div class="ttdef"><b>Definition:</b> <a href="a00189_source.html#l00159">immersedboundaries.h:159</a></div></div>
<div class="ttc" id="a00189_html_a5a198de8c3f38514f4e55231aa69cd10"><div class="ttname"><a href="a00189.html#a5a198de8c3f38514f4e55231aa69cd10">FacetMap::dz</a></div><div class="ttdeci">double dz</div><div class="ttdef"><b>Definition:</b> <a href="a00189_source.html#l00082">immersedboundaries.h:82</a></div></div>
<div class="ttc" id="a00189_html_a5347e514ebe985fb371754ffd2b5ff83"><div class="ttname"><a href="a00189.html#a5347e514ebe985fb371754ffd2b5ff83">Facet3D::y2</a></div><div class="ttdeci">double y2</div><div class="ttdef"><b>Definition:</b> <a href="a00189_source.html#l00040">immersedboundaries.h:40</a></div></div>
<div class="ttc" id="a00189_html_a750b5d744c39a06bfb13e6eb010e35d0"><div class="ttname"><a href="a00189.html#a750b5d744c39a06bfb13e6eb010e35d0">FacetMap::index</a></div><div class="ttdeci">int index</div><div class="ttdef"><b>Definition:</b> <a href="a00189_source.html#l00069">immersedboundaries.h:69</a></div></div>
<div class="ttc" id="a00189_html_ac3b72e5b77595ca2340ecf8ccfe5fd99"><div class="ttname"><a href="a00189.html#ac3b72e5b77595ca2340ecf8ccfe5fd99">Facet3D::y1</a></div><div class="ttdeci">double y1</div><div class="ttdef"><b>Definition:</b> <a href="a00189_source.html#l00040">immersedboundaries.h:40</a></div></div>
<div class="ttc" id="a00243_html_ac6afabdc09a49a433ee19d8a9486056d"><div class="ttname"><a href="a00243.html#ac6afabdc09a49a433ee19d8a9486056d">min</a></div><div class="ttdeci">#define min(a, b)</div><div class="ttdef"><b>Definition:</b> <a href="a00243_source.html#l00014">math_ops.h:14</a></div></div>
<div class="ttc" id="a00326_html_ac8dd87df944e8659dedfa3171e832f44"><div class="ttname"><a href="a00326.html#ac8dd87df944e8659dedfa3171e832f44">interpNodesCoeffs</a></div><div class="ttdeci">static int interpNodesCoeffs(void *m, double xc, double yc, double zc, double *x, double *y, double *z, int *dim, int ghosts, char *mode, int *ii, int *jj, int *kk, int *inodes, double *icoeffs)</div><div class="ttdef"><b>Definition:</b> <a href="a00326_source.html#l00028">IBCreateFacetMapping.c:28</a></div></div>
<div class="ttc" id="a00189_html_a74d07ed95c86939416c6a88f1daf8e1a"><div class="ttname"><a href="a00189.html#a74d07ed95c86939416c6a88f1daf8e1a">Facet3D::nx</a></div><div class="ttdeci">double nx</div><div class="ttdef"><b>Definition:</b> <a href="a00189_source.html#l00040">immersedboundaries.h:40</a></div></div>
<div class="ttc" id="a00326_html_ae5fc4cce9be29ebb8c3d80c534e55720"><div class="ttname"><a href="a00326.html#ae5fc4cce9be29ebb8c3d80c534e55720">isInside</a></div><div class="ttdeci">static int isInside(double x, double a, double b)</div><div class="ttdef"><b>Definition:</b> <a href="a00326_source.html#l00014">IBCreateFacetMapping.c:14</a></div></div>
<div class="ttc" id="a00189_html_a935394e510d17282c5697cd76a6e2667"><div class="ttname"><a href="a00189.html#a935394e510d17282c5697cd76a6e2667">ImmersedBoundary::mode</a></div><div class="ttdeci">char mode[_MAX_STRING_SIZE_]</div><div class="ttdef"><b>Definition:</b> <a href="a00189_source.html#l00164">immersedboundaries.h:164</a></div></div>
<div class="ttc" id="a00189_html_a822ab991099a420eb62b3f0e2b0021a2"><div class="ttname"><a href="a00189.html#a822ab991099a420eb62b3f0e2b0021a2">Facet3D::z2</a></div><div class="ttdeci">double z2</div><div class="ttdef"><b>Definition:</b> <a href="a00189_source.html#l00040">immersedboundaries.h:40</a></div></div>
<div class="ttc" id="a00189_html_abaefdeffb1a6c37ecbbba1abe183a288"><div class="ttname"><a href="a00189.html#abaefdeffb1a6c37ecbbba1abe183a288">FacetMap::xc</a></div><div class="ttdeci">double xc</div><div class="ttdef"><b>Definition:</b> <a href="a00189_source.html#l00075">immersedboundaries.h:75</a></div></div>
<div class="ttc" id="a00189_html_a31d2d6327e76038cd2aee5b972f6a9b3"><div class="ttname"><a href="a00189.html#a31d2d6327e76038cd2aee5b972f6a9b3">FacetMap::yc</a></div><div class="ttdeci">double yc</div><div class="ttdef"><b>Definition:</b> <a href="a00189_source.html#l00075">immersedboundaries.h:75</a></div></div>
<div class="ttc" id="a00189_html_adcf04f5f1964d18b332643939561da0d"><div class="ttname"><a href="a00189.html#adcf04f5f1964d18b332643939561da0d">Facet3D::x2</a></div><div class="ttdeci">double x2</div><div class="ttdef"><b>Definition:</b> <a href="a00189_source.html#l00040">immersedboundaries.h:40</a></div></div>
<div class="ttc" id="a00189_html_a98e99f64ddf7321e4eae52beca4b580f"><div class="ttname"><a href="a00189.html#a98e99f64ddf7321e4eae52beca4b580f">Facet3D::x3</a></div><div class="ttdeci">double x3</div><div class="ttdef"><b>Definition:</b> <a href="a00189_source.html#l00040">immersedboundaries.h:40</a></div></div>
<div class="ttc" id="a00189_html_af858f0e9bc4a6cb1c16ad2931cf4b43d"><div class="ttname"><a href="a00189.html#af858f0e9bc4a6cb1c16ad2931cf4b43d">ImmersedBoundary::body</a></div><div class="ttdeci">Body3D * body</div><div class="ttdef"><b>Definition:</b> <a href="a00189_source.html#l00154">immersedboundaries.h:154</a></div></div>
<div class="ttc" id="a00189_html_a147a8b14bbd79c0f1a3457805e2065ba"><div class="ttname"><a href="a00189.html#a147a8b14bbd79c0f1a3457805e2065ba">Facet3D::ny</a></div><div class="ttdeci">double ny</div><div class="ttdef"><b>Definition:</b> <a href="a00189_source.html#l00040">immersedboundaries.h:40</a></div></div>
<div class="ttc" id="a00189_html_a00661"><div class="ttname"><a href="a00189.html#a00661">ImmersedBoundary</a></div><div class="ttdoc">Structure containing variables for immersed boundary implementation. </div><div class="ttdef"><b>Definition:</b> <a href="a00189_source.html#l00153">immersedboundaries.h:153</a></div></div>
<div class="ttc" id="a00189_html_a00653"><div class="ttname"><a href="a00189.html#a00653">Facet3D</a></div><div class="ttdoc">Structure defining a facet. </div><div class="ttdef"><b>Definition:</b> <a href="a00189_source.html#l00039">immersedboundaries.h:39</a></div></div>
<div class="ttc" id="a00189_html_a00654"><div class="ttname"><a href="a00189.html#a00654">FacetMap</a></div><div class="ttdoc">Structure defining a facet map. </div><div class="ttdef"><b>Definition:</b> <a href="a00189_source.html#l00067">immersedboundaries.h:67</a></div></div>
<div class="ttc" id="a00189_html_a00648"><div class="ttname"><a href="a00189.html#a00648">Body3D</a></div><div class="ttdoc">Structure defining a body. </div><div class="ttdef"><b>Definition:</b> <a href="a00189_source.html#l00100">immersedboundaries.h:100</a></div></div>
<div class="ttc" id="a00189_html_ae4077e68c108b9ac7d51ef8560c3eebb"><div class="ttname"><a href="a00189.html#ae4077e68c108b9ac7d51ef8560c3eebb">FacetMap::zc</a></div><div class="ttdeci">double zc</div><div class="ttdef"><b>Definition:</b> <a href="a00189_source.html#l00075">immersedboundaries.h:75</a></div></div>
<div class="ttc" id="a00189_html_a4855c244bb3e3ba9b245312a375eed76"><div class="ttname"><a href="a00189.html#a4855c244bb3e3ba9b245312a375eed76">FacetMap::interp_coeffs</a></div><div class="ttdeci">double interp_coeffs[_IB_NNODES_]</div><div class="ttdef"><b>Definition:</b> <a href="a00189_source.html#l00071">immersedboundaries.h:71</a></div></div>
<div class="ttc" id="a00189_html_a849cc8a5a571348a4d50a0332d9816f8"><div class="ttname"><a href="a00189.html#a849cc8a5a571348a4d50a0332d9816f8">FacetMap::interp_nodes</a></div><div class="ttdeci">int interp_nodes[_IB_NNODES_]</div><div class="ttdef"><b>Definition:</b> <a href="a00189_source.html#l00070">immersedboundaries.h:70</a></div></div>
<div class="ttc" id="a00189_html_ae7231c0798d24ebed4aec9c288cb8d4f"><div class="ttname"><a href="a00189.html#ae7231c0798d24ebed4aec9c288cb8d4f">FacetMap::interp_nodes_ns</a></div><div class="ttdeci">int interp_nodes_ns[_IB_NNODES_]</div><div class="ttdef"><b>Definition:</b> <a href="a00189_source.html#l00072">immersedboundaries.h:72</a></div></div>
<div class="ttc" id="a00189_html_a047220645840c2812b0c4b0a714ce824"><div class="ttname"><a href="a00189.html#a047220645840c2812b0c4b0a714ce824">FacetMap::interp_coeffs_ns</a></div><div class="ttdeci">double interp_coeffs_ns[_IB_NNODES_]</div><div class="ttdef"><b>Definition:</b> <a href="a00189_source.html#l00073">immersedboundaries.h:73</a></div></div>
<div class="ttc" id="a00189_html_a9deb6f886b19d50e714d890c3c268efc"><div class="ttname"><a href="a00189.html#a9deb6f886b19d50e714d890c3c268efc">FacetMap::dy</a></div><div class="ttdeci">double dy</div><div class="ttdef"><b>Definition:</b> <a href="a00189_source.html#l00082">immersedboundaries.h:82</a></div></div>
<div class="ttc" id="a00205_html_a00663"><div class="ttname"><a href="a00205.html#a00663">MPIVariables</a></div><div class="ttdoc">Structure of MPI-related variables. </div><div class="ttdef"><b>Definition:</b> <a href="a00205_source.html#l00024">mpivars_struct.h:24</a></div></div>
<div class="ttc" id="a00189_html_a463bf8b21578003b62221acf2e522134"><div class="ttname"><a href="a00189.html#a463bf8b21578003b62221acf2e522134">Facet3D::nz</a></div><div class="ttdeci">double nz</div><div class="ttdef"><b>Definition:</b> <a href="a00189_source.html#l00040">immersedboundaries.h:40</a></div></div>
<div class="ttc" id="a00243_html_a1e471b644e7fd684cd5dbb144e00ee81"><div class="ttname"><a href="a00243.html#a1e471b644e7fd684cd5dbb144e00ee81">sign</a></div><div class="ttdeci">#define sign(a)</div><div class="ttdef"><b>Definition:</b> <a href="a00243_source.html#l00054">math_ops.h:54</a></div></div>
<div class="ttc" id="a00189_html_aa2d4d0cc81beab5f62c5527941655474"><div class="ttname"><a href="a00189.html#aa2d4d0cc81beab5f62c5527941655474">_IB_YZ_</a></div><div class="ttdeci">#define _IB_YZ_</div><div class="ttdef"><b>Definition:</b> <a href="a00189_source.html#l00020">immersedboundaries.h:20</a></div></div>
<div class="ttc" id="a00205_html_a6cfd95afd0afebd625b889fb6e58371c"><div class="ttname"><a href="a00205.html#a6cfd95afd0afebd625b889fb6e58371c">MPIVariables::rank</a></div><div class="ttdeci">int rank</div><div class="ttdef"><b>Definition:</b> <a href="a00205_source.html#l00025">mpivars_struct.h:25</a></div></div>
<div class="ttc" id="a00189_html_ab3583871695c8f2fc06011d14e092d09"><div class="ttname"><a href="a00189.html#ab3583871695c8f2fc06011d14e092d09">ImmersedBoundary::nfacets_local</a></div><div class="ttdeci">int nfacets_local</div><div class="ttdef"><b>Definition:</b> <a href="a00189_source.html#l00162">immersedboundaries.h:162</a></div></div>
<div class="ttc" id="a00189_html_a270503fb34041aa050ec80858f7820a7"><div class="ttname"><a href="a00189.html#a270503fb34041aa050ec80858f7820a7">Facet3D::z3</a></div><div class="ttdeci">double z3</div><div class="ttdef"><b>Definition:</b> <a href="a00189_source.html#l00040">immersedboundaries.h:40</a></div></div>
<div class="ttc" id="a00189_html_a786634d3d364cf94d8eb600ce7136355"><div class="ttname"><a href="a00189.html#a786634d3d364cf94d8eb600ce7136355">Facet3D::y3</a></div><div class="ttdeci">double y3</div><div class="ttdef"><b>Definition:</b> <a href="a00189_source.html#l00040">immersedboundaries.h:40</a></div></div>
<div class="ttc" id="a00189_html_a80bdbbd2624bd70748ffd44c11ffd1fb"><div class="ttname"><a href="a00189.html#a80bdbbd2624bd70748ffd44c11ffd1fb">_IB_3D_</a></div><div class="ttdeci">#define _IB_3D_</div><div class="ttdef"><b>Definition:</b> <a href="a00189_source.html#l00022">immersedboundaries.h:22</a></div></div>
<div class="ttc" id="a00189_html_afd755b081f4d9ca3558ef9ca9f3c35d0"><div class="ttname"><a href="a00189.html#afd755b081f4d9ca3558ef9ca9f3c35d0">Body3D::nfacets</a></div><div class="ttdeci">int nfacets</div><div class="ttdef"><b>Definition:</b> <a href="a00189_source.html#l00101">immersedboundaries.h:101</a></div></div>
<div class="ttc" id="a00189_html_aa7bdafcc50881d7f0f4db707755698ce"><div class="ttname"><a href="a00189.html#aa7bdafcc50881d7f0f4db707755698ce">Body3D::surface</a></div><div class="ttdeci">Facet3D * surface</div><div class="ttdef"><b>Definition:</b> <a href="a00189_source.html#l00102">immersedboundaries.h:102</a></div></div>
<div class="ttc" id="a00189_html_a0e1fe82df628138c8f3907ecddb514ae"><div class="ttname"><a href="a00189.html#a0e1fe82df628138c8f3907ecddb514ae">Facet3D::z1</a></div><div class="ttdeci">double z1</div><div class="ttdef"><b>Definition:</b> <a href="a00189_source.html#l00040">immersedboundaries.h:40</a></div></div>
<div class="ttc" id="a00243_html_ab1e1ffb6aa15887fa3bda4cfdef1f53a"><div class="ttname"><a href="a00243.html#ab1e1ffb6aa15887fa3bda4cfdef1f53a">min3</a></div><div class="ttdeci">#define min3(a, b, c)</div><div class="ttdef"><b>Definition:</b> <a href="a00243_source.html#l00023">math_ops.h:23</a></div></div>
<div class="ttc" id="a00189_html_a6f872a36881067ae3dbd5a14042cb2d6"><div class="ttname"><a href="a00189.html#a6f872a36881067ae3dbd5a14042cb2d6">_IB_XY_</a></div><div class="ttdeci">#define _IB_XY_</div><div class="ttdef"><b>Definition:</b> <a href="a00189_source.html#l00016">immersedboundaries.h:16</a></div></div>
<div class="ttc" id="a00189_html_a229d11aff11a7482259d1296b9b70b8a"><div class="ttname"><a href="a00189.html#a229d11aff11a7482259d1296b9b70b8a">FacetMap::dx</a></div><div class="ttdeci">double dx</div><div class="ttdef"><b>Definition:</b> <a href="a00189_source.html#l00082">immersedboundaries.h:82</a></div></div>
<div class="ttc" id="a00189_html_a83fe29d69e04c222af5c68e38142336c"><div class="ttname"><a href="a00189.html#a83fe29d69e04c222af5c68e38142336c">ImmersedBoundary::fmap</a></div><div class="ttdeci">FacetMap * fmap</div><div class="ttdef"><b>Definition:</b> <a href="a00189_source.html#l00156">immersedboundaries.h:156</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a9b7a52f65913c3f33f902400fa18239d"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int IBIdentifyBody </td>
          <td>(</td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>ib</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>dim_g</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>dim_l</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>ghosts</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>m</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>X</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>blank</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Identify the grid points of the given grid that are inside a given body whose surface is defined as an unstructured triangulation. This function uses the ray-tracing method and is a copy of a FORTRAN function originally written by Dr. Jay Sitaraman. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ib</td><td>Immersed boundary object of type <a class="el" href="a00189.html#a00661" title="Structure containing variables for immersed boundary implementation. ">ImmersedBoundary</a> </td></tr>
    <tr><td class="paramname">dim_g</td><td>global dimensions </td></tr>
    <tr><td class="paramname">dim_l</td><td>local dimensions </td></tr>
    <tr><td class="paramname">ghosts</td><td>number of ghost points </td></tr>
    <tr><td class="paramname">m</td><td>MPI object of type <a class="el" href="a00205.html#a00663" title="Structure of MPI-related variables. ">MPIVariables</a> </td></tr>
    <tr><td class="paramname">X</td><td>Array of global spatial coordinates </td></tr>
    <tr><td class="paramname">blank</td><td>Blanking array: for grid points within the body, this value will be set to 0 </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="a00327_source.html#l00020">20</a> of file <a class="el" href="a00327_source.html">IBIdentifyBody.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;{</div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;  <a class="code" href="a00189.html#a00661">ImmersedBoundary</a>  *IB     = (<a class="code" href="a00189.html#a00661">ImmersedBoundary</a>*) ib;</div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;  <a class="code" href="a00205.html#a00663">MPIVariables</a>      *mpi    = (<a class="code" href="a00205.html#a00663">MPIVariables</a>*) m;</div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;  <a class="code" href="a00189.html#a00648">Body3D</a>            *body   = IB-&gt;<a class="code" href="a00189.html#af858f0e9bc4a6cb1c16ad2931cf4b43d">body</a>;</div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;  <span class="keywordtype">double</span>            *x      = X, </div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;                    *y      = X+dim_g[0], </div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;                    *z      = X+dim_g[0]+dim_g[1],</div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;                    eps     = IB-&gt;<a class="code" href="a00189.html#a97eab6d709b80585fe9e8a54b1e3da27">tolerance</a>;</div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;  <span class="keywordtype">int</span>               itr_max = IB-&gt;<a class="code" href="a00189.html#a5a34c6ed89d3769fb1200fdfbdc8ae33">itr_max</a>,</div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;                      i, j, k, n, v;</div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;</div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;    <span class="keywordtype">double</span> xmax = body-&gt;<a class="code" href="a00189.html#a30554afc6599846bcd01cbf986d0998a">xmax</a>, </div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;         xmin = body-&gt;<a class="code" href="a00189.html#ab5bbe897a0c25c58341c216a1b31fbbf">xmin</a>, </div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;         ymax = body-&gt;<a class="code" href="a00189.html#afc6ae6b11b9521d908c52e4fb3ea09ce">ymax</a>, </div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;         ymin = body-&gt;<a class="code" href="a00189.html#a8c17b15efd6e0337c596d98616e9b9da">ymin</a>, </div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;         zmax = body-&gt;<a class="code" href="a00189.html#ade09ae0d27b0b7a2d1e886efc6d1a500">zmax</a>, </div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;         zmin = body-&gt;<a class="code" href="a00189.html#aaea53ab3c236de8e4f167c3807d35b47">zmin</a>;</div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;  </div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;  <span class="keywordtype">double</span> fac = 1.5;</div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;    <span class="keywordtype">double</span> Lx, Ly, Lz;</div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;    Lx = (xmax - xmin);</div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;    Ly = (ymax - ymin);</div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;    Lz = (zmax - zmin);</div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;    <span class="keywordtype">double</span> xc, yc, zc;</div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;    xc = 0.5 * (xmin + xmax);</div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;    yc = 0.5 * (ymin + ymax);</div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;    zc = 0.5 * (zmin + zmax);</div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;    xmax = xc + fac * Lx/2;</div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;    xmin = xc - fac * Lx/2;</div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;    ymax = yc + fac * Ly/2;</div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;    ymin = yc - fac * Ly/2;</div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;    zmax = zc + fac * Lz/2;</div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;    zmin = zc - fac * Lz/2;</div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;</div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;    <span class="keywordtype">int</span> imin, imax, jmin, jmax, kmin, kmax;</div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;    imin = dim_g[0]-1;  imax = 0;</div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;    jmin = dim_g[1]-1;  jmax = 0;</div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;    kmin = dim_g[2]-1;  kmax = 0;</div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;    <span class="keywordflow">for</span> (i = 0; i &lt; dim_g[0]; i++) {</div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;        <span class="keywordflow">for</span> (j = 0; j &lt; dim_g[1]; j++) {</div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;            <span class="keywordflow">for</span> (k = 0; k &lt; dim_g[2]; k++) {</div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;                <span class="keywordflow">if</span> (   ((x[i]-xmin)*(x[i]-xmax) &lt; 0) </div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;            &amp;&amp; ((y[j]-ymin)*(y[j]-ymax) &lt; 0) </div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;            &amp;&amp; ((z[k]-zmin)*(z[k]-zmax) &lt; 0)) {</div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;                    imin = <a class="code" href="a00243.html#ac6afabdc09a49a433ee19d8a9486056d">min</a>(i, imin);</div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;                    imax = <a class="code" href="a00243.html#affe776513b24d84b39af8ab0930fef7f">max</a>(i, imax);</div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;                    jmin = <a class="code" href="a00243.html#ac6afabdc09a49a433ee19d8a9486056d">min</a>(j, jmin);</div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;                    jmax = <a class="code" href="a00243.html#affe776513b24d84b39af8ab0930fef7f">max</a>(j, jmax);</div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;                    kmin = <a class="code" href="a00243.html#ac6afabdc09a49a433ee19d8a9486056d">min</a>(k, kmin);</div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;                    kmax = <a class="code" href="a00243.html#affe776513b24d84b39af8ab0930fef7f">max</a>(k, kmax);</div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;                }</div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;            }</div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;        }</div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;    }</div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;</div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;    <span class="keywordtype">double</span> *cof[5], *xd, *dist;</div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;  xd    = (<span class="keywordtype">double</span>*) calloc (itr_max,<span class="keyword">sizeof</span>(<span class="keywordtype">double</span>));</div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;  dist  = (<span class="keywordtype">double</span>*) calloc (itr_max,<span class="keyword">sizeof</span>(<span class="keywordtype">double</span>));</div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;    <span class="keywordflow">for</span> (v = 0; v &lt; 5; v++) cof[v] = (<span class="keywordtype">double</span>*) calloc(body-&gt;<a class="code" href="a00189.html#afd755b081f4d9ca3558ef9ca9f3c35d0">nfacets</a>, <span class="keyword">sizeof</span>(<span class="keywordtype">double</span>));</div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;</div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;    <span class="keywordflow">for</span> (n = 0; n &lt; body-&gt;<a class="code" href="a00189.html#afd755b081f4d9ca3558ef9ca9f3c35d0">nfacets</a>; n++) {</div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;        cof[0][n] = body-&gt;<a class="code" href="a00189.html#aa7bdafcc50881d7f0f4db707755698ce">surface</a>[n].<a class="code" href="a00189.html#ac3b72e5b77595ca2340ecf8ccfe5fd99">y1</a> - body-&gt;<a class="code" href="a00189.html#aa7bdafcc50881d7f0f4db707755698ce">surface</a>[n].<a class="code" href="a00189.html#a786634d3d364cf94d8eb600ce7136355">y3</a>;</div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;        cof[1][n] = body-&gt;<a class="code" href="a00189.html#aa7bdafcc50881d7f0f4db707755698ce">surface</a>[n].<a class="code" href="a00189.html#a5347e514ebe985fb371754ffd2b5ff83">y2</a> - body-&gt;<a class="code" href="a00189.html#aa7bdafcc50881d7f0f4db707755698ce">surface</a>[n].<a class="code" href="a00189.html#a786634d3d364cf94d8eb600ce7136355">y3</a>;</div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;    cof[2][n] = body-&gt;<a class="code" href="a00189.html#aa7bdafcc50881d7f0f4db707755698ce">surface</a>[n].<a class="code" href="a00189.html#a0e1fe82df628138c8f3907ecddb514ae">z1</a> - body-&gt;<a class="code" href="a00189.html#aa7bdafcc50881d7f0f4db707755698ce">surface</a>[n].<a class="code" href="a00189.html#a270503fb34041aa050ec80858f7820a7">z3</a>;</div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;    cof[3][n] = body-&gt;<a class="code" href="a00189.html#aa7bdafcc50881d7f0f4db707755698ce">surface</a>[n].<a class="code" href="a00189.html#a822ab991099a420eb62b3f0e2b0021a2">z2</a> - body-&gt;<a class="code" href="a00189.html#aa7bdafcc50881d7f0f4db707755698ce">surface</a>[n].<a class="code" href="a00189.html#a270503fb34041aa050ec80858f7820a7">z3</a>;</div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;        <span class="keywordtype">double</span> den = cof[0][n]*cof[3][n] - cof[1][n]*cof[2][n];</div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="a00243.html#adf1be5ccbb7a2522b4f3a64043c72880">absolute</a>(den) &gt; eps)    cof[4][n] = 1.0 / den;</div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;        <span class="keywordflow">else</span>                            cof[4][n] = 0;      </div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;    }</div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;</div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;  <span class="keywordtype">int</span> count = 0;</div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;    <span class="keywordflow">for</span> (j = jmin; j &lt;= jmax; j++) {</div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;        <span class="keywordflow">for</span> (k = kmin; k &lt;= kmax; k++) {</div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;            <span class="keywordtype">int</span> itr = 0;</div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;            <span class="keywordflow">for</span> (n = 0; n &lt; body-&gt;<a class="code" href="a00189.html#afd755b081f4d9ca3558ef9ca9f3c35d0">nfacets</a>; n++) {</div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;                <span class="keywordflow">if</span> (cof[4][n] != 0) {</div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;                    <span class="keywordtype">double</span> yy, zz;</div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;                    yy = body-&gt;<a class="code" href="a00189.html#aa7bdafcc50881d7f0f4db707755698ce">surface</a>[n].<a class="code" href="a00189.html#a786634d3d364cf94d8eb600ce7136355">y3</a> - y[j];</div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;                    zz = body-&gt;<a class="code" href="a00189.html#aa7bdafcc50881d7f0f4db707755698ce">surface</a>[n].<a class="code" href="a00189.html#a270503fb34041aa050ec80858f7820a7">z3</a> - z[k];</div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;                    <span class="keywordtype">double</span> l1, l2, l3;</div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;                    l1 = (cof[1][n]*zz - cof[3][n]*yy) * cof[4][n];</div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;                    l2 = (cof[2][n]*yy - cof[0][n]*zz) * cof[4][n];</div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;                    l3 = 1 - l1 - l2;</div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;                    <span class="keywordflow">if</span> ((l1 &gt; -eps) &amp;&amp; (l2 &gt; -eps) &amp;&amp; (l3 &gt; -eps)){</div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;                        xd[itr]   = l1*body-&gt;<a class="code" href="a00189.html#aa7bdafcc50881d7f0f4db707755698ce">surface</a>[n].<a class="code" href="a00189.html#ac75b803b570527306e1e744bfb7a604f">x1</a> + l2*body-&gt;<a class="code" href="a00189.html#aa7bdafcc50881d7f0f4db707755698ce">surface</a>[n].<a class="code" href="a00189.html#adcf04f5f1964d18b332643939561da0d">x2</a> + l3*body-&gt;<a class="code" href="a00189.html#aa7bdafcc50881d7f0f4db707755698ce">surface</a>[n].<a class="code" href="a00189.html#a98e99f64ddf7321e4eae52beca4b580f">x3</a>;</div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;                        dist[itr] = <a class="code" href="a00243.html#adf1be5ccbb7a2522b4f3a64043c72880">absolute</a>(x[imin]-xd[itr]);</div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;                        itr++;</div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;                    }</div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;                }</div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;            }</div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;            <span class="keywordflow">if</span> (itr &gt; itr_max) {</div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;        <span class="keywordflow">if</span> (!mpi-&gt;<a class="code" href="a00205.html#a6cfd95afd0afebd625b889fb6e58371c">rank</a>) {</div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;                  fprintf(stderr,<span class="stringliteral">&quot;Error: In IBIdentyBody() - itr &gt; %d. Recompilation of code needed.\n&quot;</span>,itr_max);</div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;                  fprintf(stderr,<span class="stringliteral">&quot;Increase the value of \&quot;itr_max\&quot; in IBIdentyBody().\n&quot;</span>);</div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;        }</div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;        <span class="keywordflow">return</span>(1);</div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;            }</div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;    </div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;            <span class="keywordflow">if</span> (itr &gt; 0) {</div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;                <span class="keywordtype">int</span> ii, jj;</div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;    </div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;                <span class="keywordflow">for</span> (ii = 0; ii &lt; itr; ii++) {</div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;                    <span class="keywordflow">for</span> (jj = ii+1; jj &lt; itr; jj++) {</div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;                        <span class="keywordflow">if</span> (dist[jj] &lt; dist[ii]) {</div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;                            <span class="keywordtype">double</span> temp;</div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;                            temp     = dist[ii];</div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;                            dist[ii] = dist[jj];</div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;                            dist[jj] = temp;</div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;                            temp     = xd[ii];</div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;                            xd[ii]   = xd[jj];</div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;                            xd[jj]   = temp;</div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;                        }</div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;                    }</div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;                }</div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;</div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;                <span class="keywordflow">for</span> (ii = 1; ii &lt; itr-1; ii++) {</div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;                    <span class="keywordflow">if</span> (<a class="code" href="a00243.html#adf1be5ccbb7a2522b4f3a64043c72880">absolute</a>(xd[ii]-xd[ii-1]) &lt; eps) {</div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;                        <span class="keywordflow">for</span> (jj = ii+1; jj &lt; itr; jj++) {</div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;                            xd[jj-1]    = xd[jj];</div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;                            dist[jj-1]  = dist[jj];</div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;                        }</div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;                        itr--;</div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;                        ii--;</div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;                    }</div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;                }</div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;</div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;                ii = 0;</div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;                <span class="keywordtype">int</span> inside = 0;</div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;                <span class="keywordflow">for</span> (i = imin; i &lt;= imax; i++) {</div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;                    <span class="keywordflow">if</span> ((x[i]-xd[ii])*(x[i]-xd[ii+1]) &lt; eps) {</div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;                        inside = 1;</div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;            <span class="comment">/* this point is inside                      */</span></div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;            <span class="comment">/* check if (i,j,k) lies within this process */</span></div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;            <span class="comment">/* if so, set blank                          */</span></div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;            <span class="keywordflow">if</span> (   ((i-mpi-&gt;<a class="code" href="a00205.html#a481013ba007a99a4237cde5eeb3c9a29">is</a>[0])*(i-mpi-&gt;<a class="code" href="a00205.html#a7602de5ebb1b59ec35217e78a35a531e">ie</a>[0]) &lt;= 0) </div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;                &amp;&amp; ((j-mpi-&gt;<a class="code" href="a00205.html#a481013ba007a99a4237cde5eeb3c9a29">is</a>[1])*(j-mpi-&gt;<a class="code" href="a00205.html#a7602de5ebb1b59ec35217e78a35a531e">ie</a>[1]) &lt;= 0) </div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;                &amp;&amp; ((k-mpi-&gt;<a class="code" href="a00205.html#a481013ba007a99a4237cde5eeb3c9a29">is</a>[2])*(k-mpi-&gt;<a class="code" href="a00205.html#a7602de5ebb1b59ec35217e78a35a531e">ie</a>[2]) &lt;= 0)) {</div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;              <span class="comment">/* calculate local indices */</span></div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;              <span class="keywordtype">int</span> index[<a class="code" href="a00189.html#a0f59ba2c552bae2f35a03ce3964a2b4a">_IB_NDIMS_</a>];</div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;              index[0] = i-mpi-&gt;<a class="code" href="a00205.html#a481013ba007a99a4237cde5eeb3c9a29">is</a>[0];</div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;              index[1] = j-mpi-&gt;<a class="code" href="a00205.html#a481013ba007a99a4237cde5eeb3c9a29">is</a>[1];</div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;              index[2] = k-mpi-&gt;<a class="code" href="a00205.html#a481013ba007a99a4237cde5eeb3c9a29">is</a>[2];</div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;              <span class="keywordtype">int</span> p; <a class="code" href="a00229.html#afbb862a2fdf5b72b1f9ace42f64b556f">_ArrayIndex1D_</a>(<a class="code" href="a00189.html#a0f59ba2c552bae2f35a03ce3964a2b4a">_IB_NDIMS_</a>,dim_l,index,ghosts,p);</div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;              blank[p] = 0;</div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;              count++;</div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;            }</div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;                    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;                        <span class="keywordflow">if</span> (inside) {</div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;                            <span class="keywordflow">if</span> (ii+2 &lt; itr-1)   ii += 2;</div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;                            inside = 0;</div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;                        }</div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;                    }</div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;                }</div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;</div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;            }</div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;        }</div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;    }</div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;</div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;  free(xd);</div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;  free(dist);</div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;  <span class="keywordflow">return</span>(count);</div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;}</div>
<div class="ttc" id="a00189_html_ac75b803b570527306e1e744bfb7a604f"><div class="ttname"><a href="a00189.html#ac75b803b570527306e1e744bfb7a604f">Facet3D::x1</a></div><div class="ttdeci">double x1</div><div class="ttdef"><b>Definition:</b> <a href="a00189_source.html#l00040">immersedboundaries.h:40</a></div></div>
<div class="ttc" id="a00243_html_affe776513b24d84b39af8ab0930fef7f"><div class="ttname"><a href="a00243.html#affe776513b24d84b39af8ab0930fef7f">max</a></div><div class="ttdeci">#define max(a, b)</div><div class="ttdef"><b>Definition:</b> <a href="a00243_source.html#l00018">math_ops.h:18</a></div></div>
<div class="ttc" id="a00189_html_a5347e514ebe985fb371754ffd2b5ff83"><div class="ttname"><a href="a00189.html#a5347e514ebe985fb371754ffd2b5ff83">Facet3D::y2</a></div><div class="ttdeci">double y2</div><div class="ttdef"><b>Definition:</b> <a href="a00189_source.html#l00040">immersedboundaries.h:40</a></div></div>
<div class="ttc" id="a00189_html_ac3b72e5b77595ca2340ecf8ccfe5fd99"><div class="ttname"><a href="a00189.html#ac3b72e5b77595ca2340ecf8ccfe5fd99">Facet3D::y1</a></div><div class="ttdeci">double y1</div><div class="ttdef"><b>Definition:</b> <a href="a00189_source.html#l00040">immersedboundaries.h:40</a></div></div>
<div class="ttc" id="a00243_html_ac6afabdc09a49a433ee19d8a9486056d"><div class="ttname"><a href="a00243.html#ac6afabdc09a49a433ee19d8a9486056d">min</a></div><div class="ttdeci">#define min(a, b)</div><div class="ttdef"><b>Definition:</b> <a href="a00243_source.html#l00014">math_ops.h:14</a></div></div>
<div class="ttc" id="a00229_html_afbb862a2fdf5b72b1f9ace42f64b556f"><div class="ttname"><a href="a00229.html#afbb862a2fdf5b72b1f9ace42f64b556f">_ArrayIndex1D_</a></div><div class="ttdeci">#define _ArrayIndex1D_(N, imax, i, ghost, index)</div><div class="ttdef"><b>Definition:</b> <a href="a00229_source.html#l00040">arrayfunctions.h:40</a></div></div>
<div class="ttc" id="a00189_html_ade09ae0d27b0b7a2d1e886efc6d1a500"><div class="ttname"><a href="a00189.html#ade09ae0d27b0b7a2d1e886efc6d1a500">Body3D::zmax</a></div><div class="ttdeci">double zmax</div><div class="ttdef"><b>Definition:</b> <a href="a00189_source.html#l00104">immersedboundaries.h:104</a></div></div>
<div class="ttc" id="a00189_html_a5a34c6ed89d3769fb1200fdfbdc8ae33"><div class="ttname"><a href="a00189.html#a5a34c6ed89d3769fb1200fdfbdc8ae33">ImmersedBoundary::itr_max</a></div><div class="ttdeci">int itr_max</div><div class="ttdef"><b>Definition:</b> <a href="a00189_source.html#l00160">immersedboundaries.h:160</a></div></div>
<div class="ttc" id="a00189_html_a822ab991099a420eb62b3f0e2b0021a2"><div class="ttname"><a href="a00189.html#a822ab991099a420eb62b3f0e2b0021a2">Facet3D::z2</a></div><div class="ttdeci">double z2</div><div class="ttdef"><b>Definition:</b> <a href="a00189_source.html#l00040">immersedboundaries.h:40</a></div></div>
<div class="ttc" id="a00205_html_a481013ba007a99a4237cde5eeb3c9a29"><div class="ttname"><a href="a00205.html#a481013ba007a99a4237cde5eeb3c9a29">MPIVariables::is</a></div><div class="ttdeci">int * is</div><div class="ttdef"><b>Definition:</b> <a href="a00205_source.html#l00029">mpivars_struct.h:29</a></div></div>
<div class="ttc" id="a00189_html_adcf04f5f1964d18b332643939561da0d"><div class="ttname"><a href="a00189.html#adcf04f5f1964d18b332643939561da0d">Facet3D::x2</a></div><div class="ttdeci">double x2</div><div class="ttdef"><b>Definition:</b> <a href="a00189_source.html#l00040">immersedboundaries.h:40</a></div></div>
<div class="ttc" id="a00189_html_afc6ae6b11b9521d908c52e4fb3ea09ce"><div class="ttname"><a href="a00189.html#afc6ae6b11b9521d908c52e4fb3ea09ce">Body3D::ymax</a></div><div class="ttdeci">double ymax</div><div class="ttdef"><b>Definition:</b> <a href="a00189_source.html#l00104">immersedboundaries.h:104</a></div></div>
<div class="ttc" id="a00189_html_a98e99f64ddf7321e4eae52beca4b580f"><div class="ttname"><a href="a00189.html#a98e99f64ddf7321e4eae52beca4b580f">Facet3D::x3</a></div><div class="ttdeci">double x3</div><div class="ttdef"><b>Definition:</b> <a href="a00189_source.html#l00040">immersedboundaries.h:40</a></div></div>
<div class="ttc" id="a00205_html_a7602de5ebb1b59ec35217e78a35a531e"><div class="ttname"><a href="a00205.html#a7602de5ebb1b59ec35217e78a35a531e">MPIVariables::ie</a></div><div class="ttdeci">int * ie</div><div class="ttdef"><b>Definition:</b> <a href="a00205_source.html#l00029">mpivars_struct.h:29</a></div></div>
<div class="ttc" id="a00189_html_a8c17b15efd6e0337c596d98616e9b9da"><div class="ttname"><a href="a00189.html#a8c17b15efd6e0337c596d98616e9b9da">Body3D::ymin</a></div><div class="ttdeci">double ymin</div><div class="ttdef"><b>Definition:</b> <a href="a00189_source.html#l00104">immersedboundaries.h:104</a></div></div>
<div class="ttc" id="a00189_html_af858f0e9bc4a6cb1c16ad2931cf4b43d"><div class="ttname"><a href="a00189.html#af858f0e9bc4a6cb1c16ad2931cf4b43d">ImmersedBoundary::body</a></div><div class="ttdeci">Body3D * body</div><div class="ttdef"><b>Definition:</b> <a href="a00189_source.html#l00154">immersedboundaries.h:154</a></div></div>
<div class="ttc" id="a00189_html_a97eab6d709b80585fe9e8a54b1e3da27"><div class="ttname"><a href="a00189.html#a97eab6d709b80585fe9e8a54b1e3da27">ImmersedBoundary::tolerance</a></div><div class="ttdeci">double tolerance</div><div class="ttdef"><b>Definition:</b> <a href="a00189_source.html#l00158">immersedboundaries.h:158</a></div></div>
<div class="ttc" id="a00189_html_a30554afc6599846bcd01cbf986d0998a"><div class="ttname"><a href="a00189.html#a30554afc6599846bcd01cbf986d0998a">Body3D::xmax</a></div><div class="ttdeci">double xmax</div><div class="ttdef"><b>Definition:</b> <a href="a00189_source.html#l00104">immersedboundaries.h:104</a></div></div>
<div class="ttc" id="a00189_html_a00661"><div class="ttname"><a href="a00189.html#a00661">ImmersedBoundary</a></div><div class="ttdoc">Structure containing variables for immersed boundary implementation. </div><div class="ttdef"><b>Definition:</b> <a href="a00189_source.html#l00153">immersedboundaries.h:153</a></div></div>
<div class="ttc" id="a00189_html_a00648"><div class="ttname"><a href="a00189.html#a00648">Body3D</a></div><div class="ttdoc">Structure defining a body. </div><div class="ttdef"><b>Definition:</b> <a href="a00189_source.html#l00100">immersedboundaries.h:100</a></div></div>
<div class="ttc" id="a00189_html_ab5bbe897a0c25c58341c216a1b31fbbf"><div class="ttname"><a href="a00189.html#ab5bbe897a0c25c58341c216a1b31fbbf">Body3D::xmin</a></div><div class="ttdeci">double xmin</div><div class="ttdef"><b>Definition:</b> <a href="a00189_source.html#l00104">immersedboundaries.h:104</a></div></div>
<div class="ttc" id="a00205_html_a00663"><div class="ttname"><a href="a00205.html#a00663">MPIVariables</a></div><div class="ttdoc">Structure of MPI-related variables. </div><div class="ttdef"><b>Definition:</b> <a href="a00205_source.html#l00024">mpivars_struct.h:24</a></div></div>
<div class="ttc" id="a00189_html_a0f59ba2c552bae2f35a03ce3964a2b4a"><div class="ttname"><a href="a00189.html#a0f59ba2c552bae2f35a03ce3964a2b4a">_IB_NDIMS_</a></div><div class="ttdeci">#define _IB_NDIMS_</div><div class="ttdef"><b>Definition:</b> <a href="a00189_source.html#l00010">immersedboundaries.h:10</a></div></div>
<div class="ttc" id="a00189_html_aaea53ab3c236de8e4f167c3807d35b47"><div class="ttname"><a href="a00189.html#aaea53ab3c236de8e4f167c3807d35b47">Body3D::zmin</a></div><div class="ttdeci">double zmin</div><div class="ttdef"><b>Definition:</b> <a href="a00189_source.html#l00104">immersedboundaries.h:104</a></div></div>
<div class="ttc" id="a00205_html_a6cfd95afd0afebd625b889fb6e58371c"><div class="ttname"><a href="a00205.html#a6cfd95afd0afebd625b889fb6e58371c">MPIVariables::rank</a></div><div class="ttdeci">int rank</div><div class="ttdef"><b>Definition:</b> <a href="a00205_source.html#l00025">mpivars_struct.h:25</a></div></div>
<div class="ttc" id="a00189_html_a270503fb34041aa050ec80858f7820a7"><div class="ttname"><a href="a00189.html#a270503fb34041aa050ec80858f7820a7">Facet3D::z3</a></div><div class="ttdeci">double z3</div><div class="ttdef"><b>Definition:</b> <a href="a00189_source.html#l00040">immersedboundaries.h:40</a></div></div>
<div class="ttc" id="a00189_html_a786634d3d364cf94d8eb600ce7136355"><div class="ttname"><a href="a00189.html#a786634d3d364cf94d8eb600ce7136355">Facet3D::y3</a></div><div class="ttdeci">double y3</div><div class="ttdef"><b>Definition:</b> <a href="a00189_source.html#l00040">immersedboundaries.h:40</a></div></div>
<div class="ttc" id="a00189_html_afd755b081f4d9ca3558ef9ca9f3c35d0"><div class="ttname"><a href="a00189.html#afd755b081f4d9ca3558ef9ca9f3c35d0">Body3D::nfacets</a></div><div class="ttdeci">int nfacets</div><div class="ttdef"><b>Definition:</b> <a href="a00189_source.html#l00101">immersedboundaries.h:101</a></div></div>
<div class="ttc" id="a00189_html_aa7bdafcc50881d7f0f4db707755698ce"><div class="ttname"><a href="a00189.html#aa7bdafcc50881d7f0f4db707755698ce">Body3D::surface</a></div><div class="ttdeci">Facet3D * surface</div><div class="ttdef"><b>Definition:</b> <a href="a00189_source.html#l00102">immersedboundaries.h:102</a></div></div>
<div class="ttc" id="a00189_html_a0e1fe82df628138c8f3907ecddb514ae"><div class="ttname"><a href="a00189.html#a0e1fe82df628138c8f3907ecddb514ae">Facet3D::z1</a></div><div class="ttdeci">double z1</div><div class="ttdef"><b>Definition:</b> <a href="a00189_source.html#l00040">immersedboundaries.h:40</a></div></div>
<div class="ttc" id="a00243_html_adf1be5ccbb7a2522b4f3a64043c72880"><div class="ttname"><a href="a00243.html#adf1be5ccbb7a2522b4f3a64043c72880">absolute</a></div><div class="ttdeci">#define absolute(a)</div><div class="ttdef"><b>Definition:</b> <a href="a00243_source.html#l00032">math_ops.h:32</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="af70e331f0896000fe1b0edf69676296c"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int IBIdentifyBoundary </td>
          <td>(</td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>ib</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>m</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>dim_l</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>ghosts</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>blank</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Identify the immersed boundary points: an immersed boundary point is any grid point inside the immersed body that is within stencil-width-distance of a grid point outside the immersed body. This function does the following:</p>
<ul>
<li>count the number of immersed boundary points.</li>
<li>allocate the array of immersed boundary points and set their indices. </li>
</ul>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ib</td><td>Immersed boundary object of type <a class="el" href="a00189.html#a00661" title="Structure containing variables for immersed boundary implementation. ">ImmersedBoundary</a> </td></tr>
    <tr><td class="paramname">m</td><td>MPI object of type <a class="el" href="a00205.html#a00663" title="Structure of MPI-related variables. ">MPIVariables</a> </td></tr>
    <tr><td class="paramname">dim_l</td><td>local dimensions </td></tr>
    <tr><td class="paramname">ghosts</td><td>number of ghost points </td></tr>
    <tr><td class="paramname">blank</td><td>Blanking array: for grid points within the immersed body, this value will be set to 0 </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="a00328_source.html#l00158">158</a> of file <a class="el" href="a00328_source.html">IBIdentifyBoundary.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;{</div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;  <a class="code" href="a00189.html#a00661">ImmersedBoundary</a>  *IB     = (<a class="code" href="a00189.html#a00661">ImmersedBoundary</a>*) ib;</div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;  <a class="code" href="a00205.html#a00663">MPIVariables</a>      *mpi    = (<a class="code" href="a00205.html#a00663">MPIVariables</a>*) m;</div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;  <a class="code" href="a00189.html#a00648">Body3D</a>            *body   = IB-&gt;<a class="code" href="a00189.html#af858f0e9bc4a6cb1c16ad2931cf4b43d">body</a>;</div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;</div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;  <span class="keywordtype">int</span> imax = dim_l[0],</div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;      jmax = dim_l[1],</div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;      kmax = dim_l[2];</div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;</div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;  <span class="keywordtype">int</span> n_boundary_nodes = <a class="code" href="a00328.html#ac20a15dad8cdc1021b559f08cd60bdf4">CountBoundaryPoints</a>(imax,jmax,kmax,ghosts,blank);</div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;  IB-&gt;<a class="code" href="a00189.html#a7f578e3fbaeeea97b65e3ade80f60a78">n_boundary_nodes</a> = n_boundary_nodes;</div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;  <span class="keywordflow">if</span> (n_boundary_nodes == 0) IB-&gt;<a class="code" href="a00189.html#aeab4c13a1e3fce2920ce0ff616d0fac5">boundary</a> = NULL;</div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;  <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;    IB-&gt;<a class="code" href="a00189.html#aeab4c13a1e3fce2920ce0ff616d0fac5">boundary</a> = (<a class="code" href="a00189.html#a00660">IBNode</a>*) calloc (n_boundary_nodes, <span class="keyword">sizeof</span>(<a class="code" href="a00189.html#a00660">IBNode</a>));</div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;    <span class="keywordtype">int</span> check = <a class="code" href="a00328.html#a684729950453b8313d61c1731acf5e5c">SetBoundaryPoints</a>(imax,jmax,kmax,ghosts,blank,IB-&gt;<a class="code" href="a00189.html#aeab4c13a1e3fce2920ce0ff616d0fac5">boundary</a>);</div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;    <span class="keywordflow">if</span> (check != n_boundary_nodes) {</div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;      fprintf(stderr,<span class="stringliteral">&quot;Error in IBIdentifyBoundary(): Inconsistency encountered when setting boundary indices. &quot;</span>);</div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;      fprintf(stderr,<span class="stringliteral">&quot;on rank %d.\n&quot;</span>,mpi-&gt;<a class="code" href="a00205.html#a6cfd95afd0afebd625b889fb6e58371c">rank</a>);</div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;      fprintf(stderr,<span class="stringliteral">&quot;SetBoundaryPoints() returned %d, while n_boundary_nodes is %d.\n&quot;</span>,check,n_boundary_nodes);</div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;    }</div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;  }</div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;</div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;  <span class="keywordflow">return</span>(n_boundary_nodes);</div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;}</div>
<div class="ttc" id="a00189_html_af858f0e9bc4a6cb1c16ad2931cf4b43d"><div class="ttname"><a href="a00189.html#af858f0e9bc4a6cb1c16ad2931cf4b43d">ImmersedBoundary::body</a></div><div class="ttdeci">Body3D * body</div><div class="ttdef"><b>Definition:</b> <a href="a00189_source.html#l00154">immersedboundaries.h:154</a></div></div>
<div class="ttc" id="a00189_html_aeab4c13a1e3fce2920ce0ff616d0fac5"><div class="ttname"><a href="a00189.html#aeab4c13a1e3fce2920ce0ff616d0fac5">ImmersedBoundary::boundary</a></div><div class="ttdeci">IBNode * boundary</div><div class="ttdef"><b>Definition:</b> <a href="a00189_source.html#l00155">immersedboundaries.h:155</a></div></div>
<div class="ttc" id="a00328_html_ac20a15dad8cdc1021b559f08cd60bdf4"><div class="ttname"><a href="a00328.html#ac20a15dad8cdc1021b559f08cd60bdf4">CountBoundaryPoints</a></div><div class="ttdeci">static int CountBoundaryPoints(int imax, int jmax, int kmax, int ghosts, double *blank)</div><div class="ttdef"><b>Definition:</b> <a href="a00328_source.html#l00015">IBIdentifyBoundary.c:15</a></div></div>
<div class="ttc" id="a00328_html_a684729950453b8313d61c1731acf5e5c"><div class="ttname"><a href="a00328.html#a684729950453b8313d61c1731acf5e5c">SetBoundaryPoints</a></div><div class="ttdeci">static int SetBoundaryPoints(int imax, int jmax, int kmax, int ghosts, double *blank, void *b)</div><div class="ttdef"><b>Definition:</b> <a href="a00328_source.html#l00080">IBIdentifyBoundary.c:80</a></div></div>
<div class="ttc" id="a00189_html_a00660"><div class="ttname"><a href="a00189.html#a00660">IBNode</a></div><div class="ttdoc">Structure defining an immersed boundary node. </div><div class="ttdef"><b>Definition:</b> <a href="a00189_source.html#l00125">immersedboundaries.h:125</a></div></div>
<div class="ttc" id="a00189_html_a00661"><div class="ttname"><a href="a00189.html#a00661">ImmersedBoundary</a></div><div class="ttdoc">Structure containing variables for immersed boundary implementation. </div><div class="ttdef"><b>Definition:</b> <a href="a00189_source.html#l00153">immersedboundaries.h:153</a></div></div>
<div class="ttc" id="a00189_html_a00648"><div class="ttname"><a href="a00189.html#a00648">Body3D</a></div><div class="ttdoc">Structure defining a body. </div><div class="ttdef"><b>Definition:</b> <a href="a00189_source.html#l00100">immersedboundaries.h:100</a></div></div>
<div class="ttc" id="a00205_html_a00663"><div class="ttname"><a href="a00205.html#a00663">MPIVariables</a></div><div class="ttdoc">Structure of MPI-related variables. </div><div class="ttdef"><b>Definition:</b> <a href="a00205_source.html#l00024">mpivars_struct.h:24</a></div></div>
<div class="ttc" id="a00189_html_a7f578e3fbaeeea97b65e3ade80f60a78"><div class="ttname"><a href="a00189.html#a7f578e3fbaeeea97b65e3ade80f60a78">ImmersedBoundary::n_boundary_nodes</a></div><div class="ttdeci">int n_boundary_nodes</div><div class="ttdef"><b>Definition:</b> <a href="a00189_source.html#l00161">immersedboundaries.h:161</a></div></div>
<div class="ttc" id="a00205_html_a6cfd95afd0afebd625b889fb6e58371c"><div class="ttname"><a href="a00205.html#a6cfd95afd0afebd625b889fb6e58371c">MPIVariables::rank</a></div><div class="ttdeci">int rank</div><div class="ttdef"><b>Definition:</b> <a href="a00205_source.html#l00025">mpivars_struct.h:25</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="aafa48e01069cbd264052995cffeb6ea0"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int IBIdentifyMode </td>
          <td>(</td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>X</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>dim</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>ib</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Identify the "mode", i.e., whether the simulation is a true 3D simulation, or a 2D simulation being run in 3D. If extent of the immersed body is larger than the grid along a particular axis (say, x), then we assume that the intention is to simulate a 2D case around a 2D body in the plane normal to that axis ( y-z plane ).</p>
<p>For example, to simulate a 2D cylinder in the x-y plane, we consider a cylinder whose extent along z is larger than the extent of the grid along z, i.e., it sticks out of the computational domain at both ends.</p>
<p>If the immersed body is completely contained within the computational domain, or sticks out only on one end along a particular dimension, we assume it's a 3D simulation. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">X</td><td>Array of global spatial coordinates </td></tr>
    <tr><td class="paramname">dim</td><td>global dimensions </td></tr>
    <tr><td class="paramname">ib</td><td>Immersed boundary object of type <a class="el" href="a00189.html#a00661" title="Structure containing variables for immersed boundary implementation. ">ImmersedBoundary</a> </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="a00329_source.html#l00024">24</a> of file <a class="el" href="a00329_source.html">IBIdentifyMode.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;{</div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;  <a class="code" href="a00189.html#a00661">ImmersedBoundary</a>  *IB = (<a class="code" href="a00189.html#a00661">ImmersedBoundary</a>*) ib;</div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;  <a class="code" href="a00189.html#a00648">Body3D</a>            *body   = IB-&gt;<a class="code" href="a00189.html#af858f0e9bc4a6cb1c16ad2931cf4b43d">body</a>;</div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;</div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;  <span class="keywordtype">double</span> *x = X, *y = x + dim[0], *z = y + dim[1];</div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;</div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;  <span class="keywordtype">double</span> grid_xmin = x[0],</div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;         grid_xmax = x[dim[0]-1],</div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;         grid_ymin = y[0],</div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;         grid_ymax = y[dim[1]-1],</div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;         grid_zmin = z[0],</div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;         grid_zmax = z[dim[2]-1];</div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;</div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;  <span class="keywordflow">if</span>      ( (grid_xmin &gt; body-&gt;<a class="code" href="a00189.html#ab5bbe897a0c25c58341c216a1b31fbbf">xmin</a>) &amp;&amp; (grid_xmax &lt; body-&gt;<a class="code" href="a00189.html#a30554afc6599846bcd01cbf986d0998a">xmax</a>) ) strcpy(IB-&gt;<a class="code" href="a00189.html#a935394e510d17282c5697cd76a6e2667">mode</a>,<a class="code" href="a00189.html#aa2d4d0cc81beab5f62c5527941655474">_IB_YZ_</a>);</div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span> ( (grid_ymin &gt; body-&gt;<a class="code" href="a00189.html#a8c17b15efd6e0337c596d98616e9b9da">ymin</a>) &amp;&amp; (grid_ymax &lt; body-&gt;ymax) ) strcpy(IB-&gt;<a class="code" href="a00189.html#a935394e510d17282c5697cd76a6e2667">mode</a>,<a class="code" href="a00189.html#a948cb38cc6d11f9f4c9030994e9a3367">_IB_XZ_</a>);</div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span> ( (grid_zmin &gt; body-&gt;<a class="code" href="a00189.html#aaea53ab3c236de8e4f167c3807d35b47">zmin</a>) &amp;&amp; (grid_zmax &lt; body-&gt;zmax) ) strcpy(IB-&gt;<a class="code" href="a00189.html#a935394e510d17282c5697cd76a6e2667">mode</a>,<a class="code" href="a00189.html#a6f872a36881067ae3dbd5a14042cb2d6">_IB_XY_</a>);</div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;  <span class="keywordflow">else</span>                                                             strcpy(IB-&gt;<a class="code" href="a00189.html#a935394e510d17282c5697cd76a6e2667">mode</a>,<a class="code" href="a00189.html#a80bdbbd2624bd70748ffd44c11ffd1fb">_IB_3D_</a>);</div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;</div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;  <span class="keywordflow">return</span>(0);</div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;}</div>
<div class="ttc" id="a00189_html_a948cb38cc6d11f9f4c9030994e9a3367"><div class="ttname"><a href="a00189.html#a948cb38cc6d11f9f4c9030994e9a3367">_IB_XZ_</a></div><div class="ttdeci">#define _IB_XZ_</div><div class="ttdef"><b>Definition:</b> <a href="a00189_source.html#l00018">immersedboundaries.h:18</a></div></div>
<div class="ttc" id="a00189_html_a935394e510d17282c5697cd76a6e2667"><div class="ttname"><a href="a00189.html#a935394e510d17282c5697cd76a6e2667">ImmersedBoundary::mode</a></div><div class="ttdeci">char mode[_MAX_STRING_SIZE_]</div><div class="ttdef"><b>Definition:</b> <a href="a00189_source.html#l00164">immersedboundaries.h:164</a></div></div>
<div class="ttc" id="a00189_html_a8c17b15efd6e0337c596d98616e9b9da"><div class="ttname"><a href="a00189.html#a8c17b15efd6e0337c596d98616e9b9da">Body3D::ymin</a></div><div class="ttdeci">double ymin</div><div class="ttdef"><b>Definition:</b> <a href="a00189_source.html#l00104">immersedboundaries.h:104</a></div></div>
<div class="ttc" id="a00189_html_af858f0e9bc4a6cb1c16ad2931cf4b43d"><div class="ttname"><a href="a00189.html#af858f0e9bc4a6cb1c16ad2931cf4b43d">ImmersedBoundary::body</a></div><div class="ttdeci">Body3D * body</div><div class="ttdef"><b>Definition:</b> <a href="a00189_source.html#l00154">immersedboundaries.h:154</a></div></div>
<div class="ttc" id="a00189_html_a30554afc6599846bcd01cbf986d0998a"><div class="ttname"><a href="a00189.html#a30554afc6599846bcd01cbf986d0998a">Body3D::xmax</a></div><div class="ttdeci">double xmax</div><div class="ttdef"><b>Definition:</b> <a href="a00189_source.html#l00104">immersedboundaries.h:104</a></div></div>
<div class="ttc" id="a00189_html_a00661"><div class="ttname"><a href="a00189.html#a00661">ImmersedBoundary</a></div><div class="ttdoc">Structure containing variables for immersed boundary implementation. </div><div class="ttdef"><b>Definition:</b> <a href="a00189_source.html#l00153">immersedboundaries.h:153</a></div></div>
<div class="ttc" id="a00189_html_a00648"><div class="ttname"><a href="a00189.html#a00648">Body3D</a></div><div class="ttdoc">Structure defining a body. </div><div class="ttdef"><b>Definition:</b> <a href="a00189_source.html#l00100">immersedboundaries.h:100</a></div></div>
<div class="ttc" id="a00189_html_ab5bbe897a0c25c58341c216a1b31fbbf"><div class="ttname"><a href="a00189.html#ab5bbe897a0c25c58341c216a1b31fbbf">Body3D::xmin</a></div><div class="ttdeci">double xmin</div><div class="ttdef"><b>Definition:</b> <a href="a00189_source.html#l00104">immersedboundaries.h:104</a></div></div>
<div class="ttc" id="a00189_html_aa2d4d0cc81beab5f62c5527941655474"><div class="ttname"><a href="a00189.html#aa2d4d0cc81beab5f62c5527941655474">_IB_YZ_</a></div><div class="ttdeci">#define _IB_YZ_</div><div class="ttdef"><b>Definition:</b> <a href="a00189_source.html#l00020">immersedboundaries.h:20</a></div></div>
<div class="ttc" id="a00189_html_aaea53ab3c236de8e4f167c3807d35b47"><div class="ttname"><a href="a00189.html#aaea53ab3c236de8e4f167c3807d35b47">Body3D::zmin</a></div><div class="ttdeci">double zmin</div><div class="ttdef"><b>Definition:</b> <a href="a00189_source.html#l00104">immersedboundaries.h:104</a></div></div>
<div class="ttc" id="a00189_html_a80bdbbd2624bd70748ffd44c11ffd1fb"><div class="ttname"><a href="a00189.html#a80bdbbd2624bd70748ffd44c11ffd1fb">_IB_3D_</a></div><div class="ttdeci">#define _IB_3D_</div><div class="ttdef"><b>Definition:</b> <a href="a00189_source.html#l00022">immersedboundaries.h:22</a></div></div>
<div class="ttc" id="a00189_html_a6f872a36881067ae3dbd5a14042cb2d6"><div class="ttname"><a href="a00189.html#a6f872a36881067ae3dbd5a14042cb2d6">_IB_XY_</a></div><div class="ttdeci">#define _IB_XY_</div><div class="ttdef"><b>Definition:</b> <a href="a00189_source.html#l00016">immersedboundaries.h:16</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ac877ecf361b72916a491e4759f8af040"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int IBNearestFacetNormal </td>
          <td>(</td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>ib</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>m</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>X</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>large_distance</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>dim_l</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>ghosts</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>For each immersed boundary point, find the nearest facet (<a class="el" href="a00189.html#a00653" title="Structure defining a facet. ">Facet3D</a>) of the immersed body (<a class="el" href="a00189.html#af858f0e9bc4a6cb1c16ad2931cf4b43d">ImmersedBoundary::body</a>). The "nearest" facet is the one which is closest to the boundary point in terms of the distance along the normal defined for that facet.</p>
<ul>
<li>The function will first try to find the nearest facet for which a line starting from the boundary point along the direction defind by the facet normal passes through that facet.</li>
<li>Failing the above criterion, the function will find the nearest facet.</li>
</ul>
<p><b>Note:</b> This function is sensitive to the fact that the normals defined for the immersed body are the <b>outward</b> normals, i.e., pointing away from the body. If this function returns an error, make sure this is true in the STL file the body is defined in. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ib</td><td>Immersed boundary object of type <a class="el" href="a00189.html#a00661" title="Structure containing variables for immersed boundary implementation. ">ImmersedBoundary</a> </td></tr>
    <tr><td class="paramname">m</td><td>MPI object of type <a class="el" href="a00205.html#a00663" title="Structure of MPI-related variables. ">MPIVariables</a> </td></tr>
    <tr><td class="paramname">X</td><td>Array of (local) spatial coordinates </td></tr>
    <tr><td class="paramname">large_distance</td><td>A large distance </td></tr>
    <tr><td class="paramname">dim_l</td><td>Integer array of local grid size in each spatial dimension </td></tr>
    <tr><td class="paramname">ghosts</td><td>Number of ghost points </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="a00331_source.html#l00025">25</a> of file <a class="el" href="a00331_source.html">IBNearestFacetNormal.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;{</div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;  <a class="code" href="a00189.html#a00661">ImmersedBoundary</a>  *IB       = (<a class="code" href="a00189.html#a00661">ImmersedBoundary</a>*) ib;</div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;  <a class="code" href="a00205.html#a00663">MPIVariables</a>      *mpi      = (<a class="code" href="a00205.html#a00663">MPIVariables</a>*) m;</div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;  <a class="code" href="a00189.html#a00648">Body3D</a>            *body     = IB-&gt;<a class="code" href="a00189.html#af858f0e9bc4a6cb1c16ad2931cf4b43d">body</a>;</div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;  <a class="code" href="a00189.html#a00653">Facet3D</a>           *surface  = body-&gt;<a class="code" href="a00189.html#aa7bdafcc50881d7f0f4db707755698ce">surface</a>;</div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;  <a class="code" href="a00189.html#a00660">IBNode</a>            *boundary = IB-&gt;<a class="code" href="a00189.html#aeab4c13a1e3fce2920ce0ff616d0fac5">boundary</a>;</div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;</div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;  <span class="keywordtype">double</span>  eps = IB-&gt;<a class="code" href="a00189.html#a97eab6d709b80585fe9e8a54b1e3da27">tolerance</a>;</div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;  <span class="keywordtype">int</span>     nb  = IB-&gt;<a class="code" href="a00189.html#a7f578e3fbaeeea97b65e3ade80f60a78">n_boundary_nodes</a>,</div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;          nf  = body-&gt;<a class="code" href="a00189.html#afd755b081f4d9ca3558ef9ca9f3c35d0">nfacets</a>;</div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;</div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;    <span class="keywordtype">int</span> i, j, k, dg, n;</div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;    <span class="keywordflow">for</span> (dg = 0; dg &lt; nb; dg++) {</div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;        i = boundary[dg].<a class="code" href="a00189.html#acb559820d9ca11295b4500f179ef6392">i</a>;</div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;        j = boundary[dg].<a class="code" href="a00189.html#a37d972ae0b47b9099e30983131d31916">j</a>;</div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;        k = boundary[dg].<a class="code" href="a00189.html#ab66ed8e0098c0a86b458672a55a9cca9">k</a>;</div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;</div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;    <span class="keywordtype">double</span> xp, yp, zp;</div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;    <a class="code" href="a00231.html#a9aa9bad8531d6733731a850ccc471a42">_GetCoordinate_</a>(0,i,dim_l,ghosts,X,xp);</div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;    <a class="code" href="a00231.html#a9aa9bad8531d6733731a850ccc471a42">_GetCoordinate_</a>(1,j,dim_l,ghosts,X,yp);</div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;    <a class="code" href="a00231.html#a9aa9bad8531d6733731a850ccc471a42">_GetCoordinate_</a>(2,k,dim_l,ghosts,X,zp);</div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;    boundary[dg].<a class="code" href="a00189.html#af88b946fb90d5f08b5fb740c70e98c10">x</a> = xp;</div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;    boundary[dg].<a class="code" href="a00189.html#ab927965981178aa1fba979a37168db2a">y</a> = yp;</div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;    boundary[dg].<a class="code" href="a00189.html#ab3e6ed577a7c669c19de1f9c1b46c872">z</a> = zp;</div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;</div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;        <span class="keywordtype">double</span>  dist_min = large_distance;</div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;        <span class="keywordtype">int</span>     n_min    = -1;</div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;</div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;        <span class="keywordflow">for</span> (n = 0; n &lt; nf; n++) {</div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;            <span class="keywordtype">double</span> x1, x2, x3;</div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;            <span class="keywordtype">double</span> y1, y2, y3;</div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;            <span class="keywordtype">double</span> z1, z2, z3;</div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;            x1 = surface[n].<a class="code" href="a00189.html#ac75b803b570527306e1e744bfb7a604f">x1</a>; x2 = surface[n].<a class="code" href="a00189.html#adcf04f5f1964d18b332643939561da0d">x2</a>; x3 = surface[n].<a class="code" href="a00189.html#a98e99f64ddf7321e4eae52beca4b580f">x3</a>;</div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;            y1 = surface[n].<a class="code" href="a00189.html#ac3b72e5b77595ca2340ecf8ccfe5fd99">y1</a>; y2 = surface[n].<a class="code" href="a00189.html#a5347e514ebe985fb371754ffd2b5ff83">y2</a>; y3 = surface[n].<a class="code" href="a00189.html#a786634d3d364cf94d8eb600ce7136355">y3</a>;</div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;            z1 = surface[n].<a class="code" href="a00189.html#a0e1fe82df628138c8f3907ecddb514ae">z1</a>; z2 = surface[n].<a class="code" href="a00189.html#a822ab991099a420eb62b3f0e2b0021a2">z2</a>; z3 = surface[n].<a class="code" href="a00189.html#a270503fb34041aa050ec80858f7820a7">z3</a>;</div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;            <span class="keywordtype">double</span> dist =   surface[n].<a class="code" href="a00189.html#a74d07ed95c86939416c6a88f1daf8e1a">nx</a>*(xp-surface[n].<a class="code" href="a00189.html#ac75b803b570527306e1e744bfb7a604f">x1</a>) </div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;                    + surface[n].ny*(yp-surface[n].y1) </div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;                    + surface[n].<a class="code" href="a00189.html#a463bf8b21578003b62221acf2e522134">nz</a>*(zp-surface[n].<a class="code" href="a00189.html#a0e1fe82df628138c8f3907ecddb514ae">z1</a>);</div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;            <span class="keywordflow">if</span> (dist &gt; 0)   <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="a00243.html#adf1be5ccbb7a2522b4f3a64043c72880">absolute</a>(dist) &lt; dist_min) {</div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;                <span class="keywordtype">short</span>   is_it_in = 0;</div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;                <span class="keywordtype">double</span>  x_int, y_int, z_int;</div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;                x_int = xp - dist * surface[n].<a class="code" href="a00189.html#a74d07ed95c86939416c6a88f1daf8e1a">nx</a>;</div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;                y_int = yp - dist * surface[n].<a class="code" href="a00189.html#a147a8b14bbd79c0f1a3457805e2065ba">ny</a>;</div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;                z_int = zp - dist * surface[n].<a class="code" href="a00189.html#a463bf8b21578003b62221acf2e522134">nz</a>;</div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;                <span class="keywordflow">if</span> (<a class="code" href="a00243.html#adf1be5ccbb7a2522b4f3a64043c72880">absolute</a>(surface[n].nx) &gt; eps) {</div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;                    <span class="keywordtype">double</span> den = (z2-z3)*(y1-y3)-(y2-y3)*(z1-z3);</div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;                    <span class="keywordtype">double</span> l1, l2, l3;</div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;                    l1 = ((y2-y3)*(z3-z_int)-(z2-z3)*(y3-y_int)) / den;</div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;                    l2 = ((z1-z3)*(y3-y_int)-(y1-y3)*(z3-z_int)) / den;</div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;                    l3 = 1 - l1 - l2;</div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;                    <span class="keywordflow">if</span> ((l1 &gt; -eps) &amp;&amp; (l2 &gt; -eps) &amp;&amp; (l3 &gt; -eps))  is_it_in = 1;</div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;                } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="a00243.html#adf1be5ccbb7a2522b4f3a64043c72880">absolute</a>(surface[n].ny) &gt; eps) {</div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;                    <span class="keywordtype">double</span> den = (x2-x3)*(z1-z3)-(z2-z3)*(x1-x3);</div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;                    <span class="keywordtype">double</span> l1, l2, l3;</div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;                    l1 = ((z2-z3)*(x3-x_int)-(x2-x3)*(z3-z_int)) / den;</div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;                    l2 = ((x1-x3)*(z3-z_int)-(z1-z3)*(x3-x_int)) / den;</div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;                    l3 = 1 - l1 - l2;</div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;                    <span class="keywordflow">if</span> ((l1 &gt; -eps) &amp;&amp; (l2 &gt; -eps) &amp;&amp; (l3 &gt; -eps))  is_it_in = 1;</div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;                } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;                    <span class="keywordtype">double</span> den = (y2-y3)*(x1-x3)-(x2-x3)*(y1-y3);</div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;                    <span class="keywordtype">double</span> l1, l2, l3;</div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;                    l1 = ((x2-x3)*(y3-y_int)-(y2-y3)*(x3-x_int)) / den;</div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;                    l2 = ((y1-y3)*(x3-x_int)-(x1-x3)*(y3-y_int)) / den;</div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;                    l3 = 1 - l1 - l2;</div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;                    <span class="keywordflow">if</span> ((l1 &gt; -eps) &amp;&amp; (l2 &gt; -eps) &amp;&amp; (l3 &gt; -eps))  is_it_in = 1;</div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;                }</div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;                <span class="keywordflow">if</span> (is_it_in) {</div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;                    dist_min = <a class="code" href="a00243.html#adf1be5ccbb7a2522b4f3a64043c72880">absolute</a>(dist);</div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;                    n_min = n; </div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;                }</div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;            }</div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;        }</div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;        <span class="keywordflow">if</span> (n_min == -1) {</div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;            <span class="keywordflow">for</span> (n = 0; n &lt; nf; n++) {</div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;                <span class="keywordtype">double</span> dist =   surface[n].<a class="code" href="a00189.html#a74d07ed95c86939416c6a88f1daf8e1a">nx</a>*(xp-surface[n].<a class="code" href="a00189.html#ac75b803b570527306e1e744bfb7a604f">x1</a>) </div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;                      + surface[n].ny*(yp-surface[n].y1) </div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;                      + surface[n].<a class="code" href="a00189.html#a463bf8b21578003b62221acf2e522134">nz</a>*(zp-surface[n].<a class="code" href="a00189.html#a0e1fe82df628138c8f3907ecddb514ae">z1</a>);</div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;                <span class="keywordflow">if</span> (dist &gt; eps) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;                <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;                    <span class="keywordflow">if</span> (<a class="code" href="a00243.html#adf1be5ccbb7a2522b4f3a64043c72880">absolute</a>(dist) &lt; dist_min) {</div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;                        dist_min = <a class="code" href="a00243.html#adf1be5ccbb7a2522b4f3a64043c72880">absolute</a>(dist);</div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;                        n_min = n;</div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;                    }</div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;                }</div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;            }</div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;        }</div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;</div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;        <span class="keywordflow">if</span> (n_min == -1)    {</div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;      fprintf(stderr,<span class="stringliteral">&quot;Error in IBNearestFacetNormal(): no nearest normal found for boundary node (%d,%d,%d) &quot;</span>,i,j,k);</div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;      fprintf(stderr,<span class="stringliteral">&quot;on rank %d.\n&quot;</span>,mpi-&gt;<a class="code" href="a00205.html#a6cfd95afd0afebd625b889fb6e58371c">rank</a>);</div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;      <span class="keywordflow">return</span>(1);</div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;    } <span class="keywordflow">else</span> boundary[dg].<a class="code" href="a00189.html#a84f780956fce41006ca0d5bd16478490">face</a> = &amp;surface[n_min];</div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;    }</div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;</div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;  <span class="keywordflow">return</span>(0);</div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;}</div>
<div class="ttc" id="a00189_html_ac75b803b570527306e1e744bfb7a604f"><div class="ttname"><a href="a00189.html#ac75b803b570527306e1e744bfb7a604f">Facet3D::x1</a></div><div class="ttdeci">double x1</div><div class="ttdef"><b>Definition:</b> <a href="a00189_source.html#l00040">immersedboundaries.h:40</a></div></div>
<div class="ttc" id="a00189_html_af88b946fb90d5f08b5fb740c70e98c10"><div class="ttname"><a href="a00189.html#af88b946fb90d5f08b5fb740c70e98c10">IBNode::x</a></div><div class="ttdeci">double x</div><div class="ttdef"><b>Definition:</b> <a href="a00189_source.html#l00130">immersedboundaries.h:130</a></div></div>
<div class="ttc" id="a00189_html_a5347e514ebe985fb371754ffd2b5ff83"><div class="ttname"><a href="a00189.html#a5347e514ebe985fb371754ffd2b5ff83">Facet3D::y2</a></div><div class="ttdeci">double y2</div><div class="ttdef"><b>Definition:</b> <a href="a00189_source.html#l00040">immersedboundaries.h:40</a></div></div>
<div class="ttc" id="a00189_html_ac3b72e5b77595ca2340ecf8ccfe5fd99"><div class="ttname"><a href="a00189.html#ac3b72e5b77595ca2340ecf8ccfe5fd99">Facet3D::y1</a></div><div class="ttdeci">double y1</div><div class="ttdef"><b>Definition:</b> <a href="a00189_source.html#l00040">immersedboundaries.h:40</a></div></div>
<div class="ttc" id="a00189_html_a37d972ae0b47b9099e30983131d31916"><div class="ttname"><a href="a00189.html#a37d972ae0b47b9099e30983131d31916">IBNode::j</a></div><div class="ttdeci">int j</div><div class="ttdef"><b>Definition:</b> <a href="a00189_source.html#l00126">immersedboundaries.h:126</a></div></div>
<div class="ttc" id="a00189_html_ab66ed8e0098c0a86b458672a55a9cca9"><div class="ttname"><a href="a00189.html#ab66ed8e0098c0a86b458672a55a9cca9">IBNode::k</a></div><div class="ttdeci">int k</div><div class="ttdef"><b>Definition:</b> <a href="a00189_source.html#l00126">immersedboundaries.h:126</a></div></div>
<div class="ttc" id="a00189_html_a74d07ed95c86939416c6a88f1daf8e1a"><div class="ttname"><a href="a00189.html#a74d07ed95c86939416c6a88f1daf8e1a">Facet3D::nx</a></div><div class="ttdeci">double nx</div><div class="ttdef"><b>Definition:</b> <a href="a00189_source.html#l00040">immersedboundaries.h:40</a></div></div>
<div class="ttc" id="a00189_html_a822ab991099a420eb62b3f0e2b0021a2"><div class="ttname"><a href="a00189.html#a822ab991099a420eb62b3f0e2b0021a2">Facet3D::z2</a></div><div class="ttdeci">double z2</div><div class="ttdef"><b>Definition:</b> <a href="a00189_source.html#l00040">immersedboundaries.h:40</a></div></div>
<div class="ttc" id="a00189_html_adcf04f5f1964d18b332643939561da0d"><div class="ttname"><a href="a00189.html#adcf04f5f1964d18b332643939561da0d">Facet3D::x2</a></div><div class="ttdeci">double x2</div><div class="ttdef"><b>Definition:</b> <a href="a00189_source.html#l00040">immersedboundaries.h:40</a></div></div>
<div class="ttc" id="a00189_html_a98e99f64ddf7321e4eae52beca4b580f"><div class="ttname"><a href="a00189.html#a98e99f64ddf7321e4eae52beca4b580f">Facet3D::x3</a></div><div class="ttdeci">double x3</div><div class="ttdef"><b>Definition:</b> <a href="a00189_source.html#l00040">immersedboundaries.h:40</a></div></div>
<div class="ttc" id="a00189_html_af858f0e9bc4a6cb1c16ad2931cf4b43d"><div class="ttname"><a href="a00189.html#af858f0e9bc4a6cb1c16ad2931cf4b43d">ImmersedBoundary::body</a></div><div class="ttdeci">Body3D * body</div><div class="ttdef"><b>Definition:</b> <a href="a00189_source.html#l00154">immersedboundaries.h:154</a></div></div>
<div class="ttc" id="a00189_html_aeab4c13a1e3fce2920ce0ff616d0fac5"><div class="ttname"><a href="a00189.html#aeab4c13a1e3fce2920ce0ff616d0fac5">ImmersedBoundary::boundary</a></div><div class="ttdeci">IBNode * boundary</div><div class="ttdef"><b>Definition:</b> <a href="a00189_source.html#l00155">immersedboundaries.h:155</a></div></div>
<div class="ttc" id="a00189_html_a97eab6d709b80585fe9e8a54b1e3da27"><div class="ttname"><a href="a00189.html#a97eab6d709b80585fe9e8a54b1e3da27">ImmersedBoundary::tolerance</a></div><div class="ttdeci">double tolerance</div><div class="ttdef"><b>Definition:</b> <a href="a00189_source.html#l00158">immersedboundaries.h:158</a></div></div>
<div class="ttc" id="a00189_html_a147a8b14bbd79c0f1a3457805e2065ba"><div class="ttname"><a href="a00189.html#a147a8b14bbd79c0f1a3457805e2065ba">Facet3D::ny</a></div><div class="ttdeci">double ny</div><div class="ttdef"><b>Definition:</b> <a href="a00189_source.html#l00040">immersedboundaries.h:40</a></div></div>
<div class="ttc" id="a00189_html_a00660"><div class="ttname"><a href="a00189.html#a00660">IBNode</a></div><div class="ttdoc">Structure defining an immersed boundary node. </div><div class="ttdef"><b>Definition:</b> <a href="a00189_source.html#l00125">immersedboundaries.h:125</a></div></div>
<div class="ttc" id="a00189_html_a00661"><div class="ttname"><a href="a00189.html#a00661">ImmersedBoundary</a></div><div class="ttdoc">Structure containing variables for immersed boundary implementation. </div><div class="ttdef"><b>Definition:</b> <a href="a00189_source.html#l00153">immersedboundaries.h:153</a></div></div>
<div class="ttc" id="a00189_html_a84f780956fce41006ca0d5bd16478490"><div class="ttname"><a href="a00189.html#a84f780956fce41006ca0d5bd16478490">IBNode::face</a></div><div class="ttdeci">Facet3D * face</div><div class="ttdef"><b>Definition:</b> <a href="a00189_source.html#l00133">immersedboundaries.h:133</a></div></div>
<div class="ttc" id="a00189_html_a00653"><div class="ttname"><a href="a00189.html#a00653">Facet3D</a></div><div class="ttdoc">Structure defining a facet. </div><div class="ttdef"><b>Definition:</b> <a href="a00189_source.html#l00039">immersedboundaries.h:39</a></div></div>
<div class="ttc" id="a00189_html_a00648"><div class="ttname"><a href="a00189.html#a00648">Body3D</a></div><div class="ttdoc">Structure defining a body. </div><div class="ttdef"><b>Definition:</b> <a href="a00189_source.html#l00100">immersedboundaries.h:100</a></div></div>
<div class="ttc" id="a00231_html_a9aa9bad8531d6733731a850ccc471a42"><div class="ttname"><a href="a00231.html#a9aa9bad8531d6733731a850ccc471a42">_GetCoordinate_</a></div><div class="ttdeci">#define _GetCoordinate_(dir, i, dim, ghosts, x, coord)</div><div class="ttdef"><b>Definition:</b> <a href="a00231_source.html#l00031">basic.h:31</a></div></div>
<div class="ttc" id="a00205_html_a00663"><div class="ttname"><a href="a00205.html#a00663">MPIVariables</a></div><div class="ttdoc">Structure of MPI-related variables. </div><div class="ttdef"><b>Definition:</b> <a href="a00205_source.html#l00024">mpivars_struct.h:24</a></div></div>
<div class="ttc" id="a00189_html_a463bf8b21578003b62221acf2e522134"><div class="ttname"><a href="a00189.html#a463bf8b21578003b62221acf2e522134">Facet3D::nz</a></div><div class="ttdeci">double nz</div><div class="ttdef"><b>Definition:</b> <a href="a00189_source.html#l00040">immersedboundaries.h:40</a></div></div>
<div class="ttc" id="a00189_html_ab3e6ed577a7c669c19de1f9c1b46c872"><div class="ttname"><a href="a00189.html#ab3e6ed577a7c669c19de1f9c1b46c872">IBNode::z</a></div><div class="ttdeci">double z</div><div class="ttdef"><b>Definition:</b> <a href="a00189_source.html#l00130">immersedboundaries.h:130</a></div></div>
<div class="ttc" id="a00189_html_a7f578e3fbaeeea97b65e3ade80f60a78"><div class="ttname"><a href="a00189.html#a7f578e3fbaeeea97b65e3ade80f60a78">ImmersedBoundary::n_boundary_nodes</a></div><div class="ttdeci">int n_boundary_nodes</div><div class="ttdef"><b>Definition:</b> <a href="a00189_source.html#l00161">immersedboundaries.h:161</a></div></div>
<div class="ttc" id="a00189_html_acb559820d9ca11295b4500f179ef6392"><div class="ttname"><a href="a00189.html#acb559820d9ca11295b4500f179ef6392">IBNode::i</a></div><div class="ttdeci">int i</div><div class="ttdef"><b>Definition:</b> <a href="a00189_source.html#l00126">immersedboundaries.h:126</a></div></div>
<div class="ttc" id="a00205_html_a6cfd95afd0afebd625b889fb6e58371c"><div class="ttname"><a href="a00205.html#a6cfd95afd0afebd625b889fb6e58371c">MPIVariables::rank</a></div><div class="ttdeci">int rank</div><div class="ttdef"><b>Definition:</b> <a href="a00205_source.html#l00025">mpivars_struct.h:25</a></div></div>
<div class="ttc" id="a00189_html_a270503fb34041aa050ec80858f7820a7"><div class="ttname"><a href="a00189.html#a270503fb34041aa050ec80858f7820a7">Facet3D::z3</a></div><div class="ttdeci">double z3</div><div class="ttdef"><b>Definition:</b> <a href="a00189_source.html#l00040">immersedboundaries.h:40</a></div></div>
<div class="ttc" id="a00189_html_a786634d3d364cf94d8eb600ce7136355"><div class="ttname"><a href="a00189.html#a786634d3d364cf94d8eb600ce7136355">Facet3D::y3</a></div><div class="ttdeci">double y3</div><div class="ttdef"><b>Definition:</b> <a href="a00189_source.html#l00040">immersedboundaries.h:40</a></div></div>
<div class="ttc" id="a00189_html_afd755b081f4d9ca3558ef9ca9f3c35d0"><div class="ttname"><a href="a00189.html#afd755b081f4d9ca3558ef9ca9f3c35d0">Body3D::nfacets</a></div><div class="ttdeci">int nfacets</div><div class="ttdef"><b>Definition:</b> <a href="a00189_source.html#l00101">immersedboundaries.h:101</a></div></div>
<div class="ttc" id="a00189_html_aa7bdafcc50881d7f0f4db707755698ce"><div class="ttname"><a href="a00189.html#aa7bdafcc50881d7f0f4db707755698ce">Body3D::surface</a></div><div class="ttdeci">Facet3D * surface</div><div class="ttdef"><b>Definition:</b> <a href="a00189_source.html#l00102">immersedboundaries.h:102</a></div></div>
<div class="ttc" id="a00189_html_a0e1fe82df628138c8f3907ecddb514ae"><div class="ttname"><a href="a00189.html#a0e1fe82df628138c8f3907ecddb514ae">Facet3D::z1</a></div><div class="ttdeci">double z1</div><div class="ttdef"><b>Definition:</b> <a href="a00189_source.html#l00040">immersedboundaries.h:40</a></div></div>
<div class="ttc" id="a00243_html_adf1be5ccbb7a2522b4f3a64043c72880"><div class="ttname"><a href="a00243.html#adf1be5ccbb7a2522b4f3a64043c72880">absolute</a></div><div class="ttdeci">#define absolute(a)</div><div class="ttdef"><b>Definition:</b> <a href="a00243_source.html#l00032">math_ops.h:32</a></div></div>
<div class="ttc" id="a00189_html_ab927965981178aa1fba979a37168db2a"><div class="ttname"><a href="a00189.html#ab927965981178aa1fba979a37168db2a">IBNode::y</a></div><div class="ttdeci">double y</div><div class="ttdef"><b>Definition:</b> <a href="a00189_source.html#l00130">immersedboundaries.h:130</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a0175a349146a94c667dc90f2bffdb7ef"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int IBInterpCoeffs </td>
          <td>(</td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>ib</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>m</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>X</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>dim_l</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>ghosts</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>blank</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Compute the interpolation nodes and coefficients for immersed boundary points: For each immersed boundary point, do the following:</p>
<ul>
<li>From the immersed boundary point, extend a probe in the direction defined by the outward normal of the "nearest" facet (computed in <a class="el" href="a00189.html#ac877ecf361b72916a491e4759f8af040">IBNearestFacetNormal()</a>), till the probe tip reaches a point in space such that all surrounding (<a class="el" href="a00189.html#a9e114382f922a879776df13fd2f414a5">_IB_NNODES_</a>) grid points are "interior" points, i.e., outside the immersed body (they are "interior" to the computational domain).</li>
<li>Store the indices of the surrounding grid points, as well as the trilinear interpolation coefficients to interpolate a variable from the surrounding points to the probe tip. </li>
</ul>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ib</td><td>Immersed boundary object of type <a class="el" href="a00189.html#a00661" title="Structure containing variables for immersed boundary implementation. ">ImmersedBoundary</a> </td></tr>
    <tr><td class="paramname">m</td><td>MPI object of type <a class="el" href="a00205.html#a00663" title="Structure of MPI-related variables. ">MPIVariables</a> </td></tr>
    <tr><td class="paramname">X</td><td>Array of (local) spatial coordinates </td></tr>
    <tr><td class="paramname">dim_l</td><td>Integer array of local grid size in each spatial dimension </td></tr>
    <tr><td class="paramname">ghosts</td><td>Number of ghost points </td></tr>
    <tr><td class="paramname">blank</td><td>Blanking array: for grid points within the body, this value will be set to 0 </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="a00330_source.html#l00022">22</a> of file <a class="el" href="a00330_source.html">IBInterpCoeffs.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;{</div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;  <a class="code" href="a00189.html#a00661">ImmersedBoundary</a>  *IB       = (<a class="code" href="a00189.html#a00661">ImmersedBoundary</a>*) ib;</div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;  <a class="code" href="a00205.html#a00663">MPIVariables</a>      *mpi      = (<a class="code" href="a00205.html#a00663">MPIVariables</a>*) m;</div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;  <a class="code" href="a00189.html#a00660">IBNode</a>            *boundary = IB-&gt;<a class="code" href="a00189.html#aeab4c13a1e3fce2920ce0ff616d0fac5">boundary</a>;</div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;</div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;  <span class="keywordtype">double</span>  eps         = IB-&gt;<a class="code" href="a00189.html#a97eab6d709b80585fe9e8a54b1e3da27">tolerance</a>;</div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;  <span class="keywordtype">int</span>     maxiter     = IB-&gt;<a class="code" href="a00189.html#a5a34c6ed89d3769fb1200fdfbdc8ae33">itr_max</a>,</div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;          n_boundary  = IB-&gt;<a class="code" href="a00189.html#a7f578e3fbaeeea97b65e3ade80f60a78">n_boundary_nodes</a>;</div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;</div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;  <span class="keywordtype">int</span> imax        = dim_l[0],</div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;      jmax        = dim_l[1],</div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;      kmax        = dim_l[2];</div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;</div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;  <span class="keywordtype">int</span> is = mpi-&gt;<a class="code" href="a00205.html#a481013ba007a99a4237cde5eeb3c9a29">is</a>[0],</div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;      js = mpi-&gt;<a class="code" href="a00205.html#a481013ba007a99a4237cde5eeb3c9a29">is</a>[1],</div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;      ks = mpi-&gt;<a class="code" href="a00205.html#a481013ba007a99a4237cde5eeb3c9a29">is</a>[2];</div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;</div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;  <span class="keyword">static</span> <span class="keywordtype">int</span> index[<a class="code" href="a00189.html#a0f59ba2c552bae2f35a03ce3964a2b4a">_IB_NDIMS_</a>];</div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;</div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;    <span class="keywordtype">int</span> dg;</div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;    <span class="keywordflow">for</span> (dg = 0; dg &lt; n_boundary; dg++) {</div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;        <span class="keywordtype">int</span>    i, j, k, p;</div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;        <span class="keywordtype">double</span> xb, yb, zb;</div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;        <span class="keywordtype">double</span> nx, ny, nz;</div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;        <span class="keywordtype">double</span> xx, yy, zz;</div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;        <span class="keywordtype">double</span> dx, dy, dz;</div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;    <span class="keywordtype">double</span> ds, dist;</div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;        <span class="keywordtype">double</span> xtip, ytip, ztip;</div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;</div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;        index[0] = i = boundary[dg].<a class="code" href="a00189.html#acb559820d9ca11295b4500f179ef6392">i</a>;</div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;        index[1] = j = boundary[dg].<a class="code" href="a00189.html#a37d972ae0b47b9099e30983131d31916">j</a>;</div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;        index[2] = k = boundary[dg].<a class="code" href="a00189.html#ab66ed8e0098c0a86b458672a55a9cca9">k</a>;</div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;    <a class="code" href="a00229.html#afbb862a2fdf5b72b1f9ace42f64b556f">_ArrayIndex1D_</a>(<a class="code" href="a00189.html#a0f59ba2c552bae2f35a03ce3964a2b4a">_IB_NDIMS_</a>,dim_l,index,ghosts,p);</div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;</div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;        xb = boundary[dg].<a class="code" href="a00189.html#af88b946fb90d5f08b5fb740c70e98c10">x</a>;</div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;        yb = boundary[dg].<a class="code" href="a00189.html#ab927965981178aa1fba979a37168db2a">y</a>;</div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;        zb = boundary[dg].<a class="code" href="a00189.html#ab3e6ed577a7c669c19de1f9c1b46c872">z</a>;</div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;</div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;        nx = boundary[dg].<a class="code" href="a00189.html#a84f780956fce41006ca0d5bd16478490">face</a>-&gt;<a class="code" href="a00189.html#a74d07ed95c86939416c6a88f1daf8e1a">nx</a>;</div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;        ny = boundary[dg].<a class="code" href="a00189.html#a84f780956fce41006ca0d5bd16478490">face</a>-&gt;<a class="code" href="a00189.html#a147a8b14bbd79c0f1a3457805e2065ba">ny</a>;</div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;        nz = boundary[dg].<a class="code" href="a00189.html#a84f780956fce41006ca0d5bd16478490">face</a>-&gt;<a class="code" href="a00189.html#a463bf8b21578003b62221acf2e522134">nz</a>;</div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;        xx = boundary[dg].<a class="code" href="a00189.html#a84f780956fce41006ca0d5bd16478490">face</a>-&gt;<a class="code" href="a00189.html#ac75b803b570527306e1e744bfb7a604f">x1</a>;</div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;        yy = boundary[dg].<a class="code" href="a00189.html#a84f780956fce41006ca0d5bd16478490">face</a>-&gt;<a class="code" href="a00189.html#ac3b72e5b77595ca2340ecf8ccfe5fd99">y1</a>;</div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;        zz = boundary[dg].<a class="code" href="a00189.html#a84f780956fce41006ca0d5bd16478490">face</a>-&gt;<a class="code" href="a00189.html#a0e1fe82df628138c8f3907ecddb514ae">z1</a>;</div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;</div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;        dist = nx*(xx-xb) + ny*(yy-yb) + nz*(zz-zb);</div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;</div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;    <span class="keywordtype">double</span> x1, x2, y1, y2, z1, z2;</div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;    <a class="code" href="a00231.html#a9aa9bad8531d6733731a850ccc471a42">_GetCoordinate_</a>(0,(i+1),dim_l,ghosts,X,x1);</div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;    <a class="code" href="a00231.html#a9aa9bad8531d6733731a850ccc471a42">_GetCoordinate_</a>(0,(i-1),dim_l,ghosts,X,x2);</div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;    <a class="code" href="a00231.html#a9aa9bad8531d6733731a850ccc471a42">_GetCoordinate_</a>(1,(j+1),dim_l,ghosts,X,y1);</div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;    <a class="code" href="a00231.html#a9aa9bad8531d6733731a850ccc471a42">_GetCoordinate_</a>(1,(j-1),dim_l,ghosts,X,y2);</div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;    <a class="code" href="a00231.html#a9aa9bad8531d6733731a850ccc471a42">_GetCoordinate_</a>(2,(k+1),dim_l,ghosts,X,z1);</div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;    <a class="code" href="a00231.html#a9aa9bad8531d6733731a850ccc471a42">_GetCoordinate_</a>(2,(k-1),dim_l,ghosts,X,z2);</div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;    dx = 0.5 * (x1 - x2);</div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;    dy = 0.5 * (y1 - y2);</div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;    dz = 0.5 * (z1 - z2);</div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;        ds = <a class="code" href="a00243.html#ab1e1ffb6aa15887fa3bda4cfdef1f53a">min3</a>(dx, dy, dz);</div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;</div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;        xtip = xb + dist*nx;</div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;        ytip = yb + dist*ny;</div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;        ztip = zb + dist*nz;</div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;</div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;        <span class="keywordtype">int</span> is_it_in = 0;</div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;        <span class="keywordtype">int</span> iter = 0;</div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;        <span class="keywordtype">int</span> itip, jtip, ktip;</div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;        <span class="keywordflow">while</span>(!is_it_in &amp;&amp; (iter &lt; maxiter)) {</div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;            iter++;</div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;            itip = i;</div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;            jtip = j;</div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;            ktip = k;</div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;          </div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;            <span class="keywordflow">if</span> (xtip &gt; xb)  {</div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;        <span class="keywordtype">double</span> xx;</div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;        <a class="code" href="a00231.html#a9aa9bad8531d6733731a850ccc471a42">_GetCoordinate_</a>(0,itip,dim_l,ghosts,X,xx);</div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;        <span class="keywordflow">while</span> ((xx &lt; xtip) &amp;&amp; (itip &lt; imax+ghosts-1)) {</div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;          itip++;</div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;          <a class="code" href="a00231.html#a9aa9bad8531d6733731a850ccc471a42">_GetCoordinate_</a>(0,itip,dim_l,ghosts,X,xx);</div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;        }</div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;      } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;        <span class="keywordtype">double</span> xx;</div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;        <a class="code" href="a00231.html#a9aa9bad8531d6733731a850ccc471a42">_GetCoordinate_</a>(0,(itip-1),dim_l,ghosts,X,xx);</div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;        <span class="keywordflow">while</span> ((xx &gt; xtip) &amp;&amp; (itip &gt; -ghosts)) {</div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;          itip--;</div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;          <a class="code" href="a00231.html#a9aa9bad8531d6733731a850ccc471a42">_GetCoordinate_</a>(0,(itip-1),dim_l,ghosts,X,xx);</div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;        }</div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;      }</div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;</div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;            <span class="keywordflow">if</span> (ytip &gt; yb) {</div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;        <span class="keywordtype">double</span> yy;</div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;        <a class="code" href="a00231.html#a9aa9bad8531d6733731a850ccc471a42">_GetCoordinate_</a>(1,jtip,dim_l,ghosts,X,yy);</div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;        <span class="keywordflow">while</span> ((yy &lt; ytip) &amp;&amp; (jtip &lt; jmax+ghosts-1)) {</div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;          jtip++;</div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;          <a class="code" href="a00231.html#a9aa9bad8531d6733731a850ccc471a42">_GetCoordinate_</a>(1,jtip,dim_l,ghosts,X,yy);</div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;        }</div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;      } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;        <span class="keywordtype">double</span> yy;</div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;        <a class="code" href="a00231.html#a9aa9bad8531d6733731a850ccc471a42">_GetCoordinate_</a>(1,(jtip-1),dim_l,ghosts,X,yy);</div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;        <span class="keywordflow">while</span> ((yy &gt; ytip) &amp;&amp; (jtip &gt; -ghosts)) {</div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;          jtip--;</div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;          <a class="code" href="a00231.html#a9aa9bad8531d6733731a850ccc471a42">_GetCoordinate_</a>(1,(jtip-1),dim_l,ghosts,X,yy);</div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;        }</div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;      }</div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;</div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;            <span class="keywordflow">if</span> (ztip &gt; zb) {</div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;        <span class="keywordtype">double</span> zz;</div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;        <a class="code" href="a00231.html#a9aa9bad8531d6733731a850ccc471a42">_GetCoordinate_</a>(2,ktip,dim_l,ghosts,X,zz);</div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;        <span class="keywordflow">while</span> ((zz &lt; ztip) &amp;&amp; (ktip &lt; kmax+ghosts-1))   {</div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;          ktip++;</div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;          <a class="code" href="a00231.html#a9aa9bad8531d6733731a850ccc471a42">_GetCoordinate_</a>(2,ktip,dim_l,ghosts,X,zz);</div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;        }</div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;      } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;        <span class="keywordtype">double</span> zz;</div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;        <a class="code" href="a00231.html#a9aa9bad8531d6733731a850ccc471a42">_GetCoordinate_</a>(2,(ktip-1),dim_l,ghosts,X,zz);</div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;        <span class="keywordflow">while</span> ((zz &gt; ztip) &amp;&amp; (ktip &gt; -ghosts)) {</div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;          ktip--;</div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;          <a class="code" href="a00231.html#a9aa9bad8531d6733731a850ccc471a42">_GetCoordinate_</a>(2,(ktip-1),dim_l,ghosts,X,zz);</div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;        }</div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;      }</div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;</div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;      <span class="keywordtype">int</span> ptip[<a class="code" href="a00189.html#a9e114382f922a879776df13fd2f414a5">_IB_NNODES_</a>];</div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;      index[0] = itip  ; index[1] = jtip  ; index[2] = ktip  ; <a class="code" href="a00229.html#afbb862a2fdf5b72b1f9ace42f64b556f">_ArrayIndex1D_</a>(<a class="code" href="a00189.html#a0f59ba2c552bae2f35a03ce3964a2b4a">_IB_NDIMS_</a>,dim_l,index,ghosts,ptip[0]);</div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;      index[0] = itip-1; index[1] = jtip  ; index[2] = ktip  ; <a class="code" href="a00229.html#afbb862a2fdf5b72b1f9ace42f64b556f">_ArrayIndex1D_</a>(<a class="code" href="a00189.html#a0f59ba2c552bae2f35a03ce3964a2b4a">_IB_NDIMS_</a>,dim_l,index,ghosts,ptip[1]);</div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;      index[0] = itip  ; index[1] = jtip-1; index[2] = ktip  ; <a class="code" href="a00229.html#afbb862a2fdf5b72b1f9ace42f64b556f">_ArrayIndex1D_</a>(<a class="code" href="a00189.html#a0f59ba2c552bae2f35a03ce3964a2b4a">_IB_NDIMS_</a>,dim_l,index,ghosts,ptip[2]);</div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;      index[0] = itip  ; index[1] = jtip  ; index[2] = ktip-1; <a class="code" href="a00229.html#afbb862a2fdf5b72b1f9ace42f64b556f">_ArrayIndex1D_</a>(<a class="code" href="a00189.html#a0f59ba2c552bae2f35a03ce3964a2b4a">_IB_NDIMS_</a>,dim_l,index,ghosts,ptip[3]);</div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;      index[0] = itip-1; index[1] = jtip-1; index[2] = ktip  ; <a class="code" href="a00229.html#afbb862a2fdf5b72b1f9ace42f64b556f">_ArrayIndex1D_</a>(<a class="code" href="a00189.html#a0f59ba2c552bae2f35a03ce3964a2b4a">_IB_NDIMS_</a>,dim_l,index,ghosts,ptip[4]);</div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;      index[0] = itip  ; index[1] = jtip-1; index[2] = ktip-1; <a class="code" href="a00229.html#afbb862a2fdf5b72b1f9ace42f64b556f">_ArrayIndex1D_</a>(<a class="code" href="a00189.html#a0f59ba2c552bae2f35a03ce3964a2b4a">_IB_NDIMS_</a>,dim_l,index,ghosts,ptip[5]);</div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;      index[0] = itip-1; index[1] = jtip  ; index[2] = ktip-1; <a class="code" href="a00229.html#afbb862a2fdf5b72b1f9ace42f64b556f">_ArrayIndex1D_</a>(<a class="code" href="a00189.html#a0f59ba2c552bae2f35a03ce3964a2b4a">_IB_NDIMS_</a>,dim_l,index,ghosts,ptip[6]);</div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;      index[0] = itip-1; index[1] = jtip-1; index[2] = ktip-1; <a class="code" href="a00229.html#afbb862a2fdf5b72b1f9ace42f64b556f">_ArrayIndex1D_</a>(<a class="code" href="a00189.html#a0f59ba2c552bae2f35a03ce3964a2b4a">_IB_NDIMS_</a>,dim_l,index,ghosts,ptip[7]);</div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;</div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;            <span class="keywordtype">int</span> nflow = 0;</div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;            nflow += blank[ptip[0]];</div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;            nflow += blank[ptip[1]];</div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;            nflow += blank[ptip[2]];</div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;            nflow += blank[ptip[3]];</div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;            nflow += blank[ptip[4]];</div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;            nflow += blank[ptip[5]];</div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;            nflow += blank[ptip[6]];</div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;            nflow += blank[ptip[7]];</div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;            <span class="keywordflow">if</span> (nflow == <a class="code" href="a00189.html#a9e114382f922a879776df13fd2f414a5">_IB_NNODES_</a>) {</div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;                is_it_in = 1;</div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;            } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (nflow &lt; <a class="code" href="a00189.html#a9e114382f922a879776df13fd2f414a5">_IB_NNODES_</a>) {</div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;                is_it_in = 0;</div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;                xtip += nx*<a class="code" href="a00243.html#adf1be5ccbb7a2522b4f3a64043c72880">absolute</a>(ds);</div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;                ytip += ny*<a class="code" href="a00243.html#adf1be5ccbb7a2522b4f3a64043c72880">absolute</a>(ds);</div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;                ztip += nz*<a class="code" href="a00243.html#adf1be5ccbb7a2522b4f3a64043c72880">absolute</a>(ds);</div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;            } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;                fprintf(stderr,<span class="stringliteral">&quot;Error in IBInterpCoeffs() (Bug in code) - counting interior points surrounding probe tip \n&quot;</span>);</div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;        fprintf(stderr,<span class="stringliteral">&quot;on rank %d.\n&quot;</span>, mpi-&gt;<a class="code" href="a00205.html#a6cfd95afd0afebd625b889fb6e58371c">rank</a>);</div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;        fprintf(stderr,<span class="stringliteral">&quot;Value of nflow is %d but can only be positive and &lt;= %d.\n&quot;</span>,nflow,<a class="code" href="a00189.html#a9e114382f922a879776df13fd2f414a5">_IB_NNODES_</a>);</div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;        <span class="keywordflow">return</span>(1);</div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;            }</div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;        }</div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;</div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;    <span class="keywordflow">if</span> (!is_it_in) {</div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;      fprintf(stderr,<span class="stringliteral">&quot;Error in IBInterpCoeffs() on rank %d - interior point not found for immersed boundary point (%d,%d,%d)!\n&quot;</span>,</div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;              mpi-&gt;<a class="code" href="a00205.html#a6cfd95afd0afebd625b889fb6e58371c">rank</a>, i, j, k);</div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;      <span class="keywordflow">return</span>(1);</div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;    }    </div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;    </div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;        <span class="keywordtype">double</span> tlx[2],tly[2],tlz[2];</div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;    <a class="code" href="a00231.html#a9aa9bad8531d6733731a850ccc471a42">_GetCoordinate_</a>(0,(itip-1),dim_l,ghosts,X,tlx[0]);</div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;    <a class="code" href="a00231.html#a9aa9bad8531d6733731a850ccc471a42">_GetCoordinate_</a>(0,(itip  ),dim_l,ghosts,X,tlx[1]);</div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;    <a class="code" href="a00231.html#a9aa9bad8531d6733731a850ccc471a42">_GetCoordinate_</a>(1,(jtip-1),dim_l,ghosts,X,tly[0]);</div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;    <a class="code" href="a00231.html#a9aa9bad8531d6733731a850ccc471a42">_GetCoordinate_</a>(1,(jtip  ),dim_l,ghosts,X,tly[1]);</div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;    <a class="code" href="a00231.html#a9aa9bad8531d6733731a850ccc471a42">_GetCoordinate_</a>(2,(ktip-1),dim_l,ghosts,X,tlz[0]);</div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;    <a class="code" href="a00231.html#a9aa9bad8531d6733731a850ccc471a42">_GetCoordinate_</a>(2,(ktip  ),dim_l,ghosts,X,tlz[1]);</div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;</div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;    <span class="keywordtype">int</span> ptip[<a class="code" href="a00189.html#a9e114382f922a879776df13fd2f414a5">_IB_NNODES_</a>];</div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;    index[0]=itip-1; index[1]=jtip-1; index[2]=ktip-1; <a class="code" href="a00229.html#afbb862a2fdf5b72b1f9ace42f64b556f">_ArrayIndex1D_</a>(<a class="code" href="a00189.html#a0f59ba2c552bae2f35a03ce3964a2b4a">_IB_NDIMS_</a>,dim_l,index,ghosts,ptip[0]);</div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;    index[0]=itip  ; index[1]=jtip-1; index[2]=ktip-1; <a class="code" href="a00229.html#afbb862a2fdf5b72b1f9ace42f64b556f">_ArrayIndex1D_</a>(<a class="code" href="a00189.html#a0f59ba2c552bae2f35a03ce3964a2b4a">_IB_NDIMS_</a>,dim_l,index,ghosts,ptip[1]);</div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;    index[0]=itip-1; index[1]=jtip  ; index[2]=ktip-1; <a class="code" href="a00229.html#afbb862a2fdf5b72b1f9ace42f64b556f">_ArrayIndex1D_</a>(<a class="code" href="a00189.html#a0f59ba2c552bae2f35a03ce3964a2b4a">_IB_NDIMS_</a>,dim_l,index,ghosts,ptip[2]);</div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;    index[0]=itip  ; index[1]=jtip  ; index[2]=ktip-1; <a class="code" href="a00229.html#afbb862a2fdf5b72b1f9ace42f64b556f">_ArrayIndex1D_</a>(<a class="code" href="a00189.html#a0f59ba2c552bae2f35a03ce3964a2b4a">_IB_NDIMS_</a>,dim_l,index,ghosts,ptip[3]);</div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;    index[0]=itip-1; index[1]=jtip-1; index[2]=ktip  ; <a class="code" href="a00229.html#afbb862a2fdf5b72b1f9ace42f64b556f">_ArrayIndex1D_</a>(<a class="code" href="a00189.html#a0f59ba2c552bae2f35a03ce3964a2b4a">_IB_NDIMS_</a>,dim_l,index,ghosts,ptip[4]);</div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;    index[0]=itip  ; index[1]=jtip-1; index[2]=ktip  ; <a class="code" href="a00229.html#afbb862a2fdf5b72b1f9ace42f64b556f">_ArrayIndex1D_</a>(<a class="code" href="a00189.html#a0f59ba2c552bae2f35a03ce3964a2b4a">_IB_NDIMS_</a>,dim_l,index,ghosts,ptip[5]);</div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;    index[0]=itip-1; index[1]=jtip  ; index[2]=ktip  ; <a class="code" href="a00229.html#afbb862a2fdf5b72b1f9ace42f64b556f">_ArrayIndex1D_</a>(<a class="code" href="a00189.html#a0f59ba2c552bae2f35a03ce3964a2b4a">_IB_NDIMS_</a>,dim_l,index,ghosts,ptip[6]);</div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;    index[0]=itip  ; index[1]=jtip  ; index[2]=ktip  ; <a class="code" href="a00229.html#afbb862a2fdf5b72b1f9ace42f64b556f">_ArrayIndex1D_</a>(<a class="code" href="a00189.html#a0f59ba2c552bae2f35a03ce3964a2b4a">_IB_NDIMS_</a>,dim_l,index,ghosts,ptip[7]);</div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;    <a class="code" href="a00229.html#a89e8330d9e06dd0666c50833628a125c">_ArrayCopy1D_</a>(ptip,boundary[dg].interp_nodes,<a class="code" href="a00189.html#a9e114382f922a879776df13fd2f414a5">_IB_NNODES_</a>);</div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;</div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;    <span class="keywordtype">double</span> coeffs[<a class="code" href="a00189.html#a9e114382f922a879776df13fd2f414a5">_IB_NNODES_</a>];</div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;    <a class="code" href="a00244.html#a04d4e04f1f9112958dca24fc68c1818a">TrilinearInterpCoeffs</a>(tlx[0],tlx[1],tly[0],tly[1],tlz[0],tlz[1],xtip,ytip,ztip,&amp;coeffs[0]);</div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;    <a class="code" href="a00229.html#a89e8330d9e06dd0666c50833628a125c">_ArrayCopy1D_</a>(coeffs,boundary[dg].interp_coeffs,<a class="code" href="a00189.html#a9e114382f922a879776df13fd2f414a5">_IB_NNODES_</a>);</div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;</div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;        <span class="keywordtype">double</span> tipdist = <a class="code" href="a00243.html#adf1be5ccbb7a2522b4f3a64043c72880">absolute</a>(nx*(xx-xtip) + ny*(yy-ytip) + nz*(zz-ztip));</div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;    boundary[dg].<a class="code" href="a00189.html#a9ba638c4f33720c7289cac3bf73ca088">interp_node_distance</a> = tipdist;</div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;    boundary[dg].<a class="code" href="a00189.html#a7b34733bcf53c70cfe86f22bbb05b309">surface_distance</a> = <a class="code" href="a00243.html#adf1be5ccbb7a2522b4f3a64043c72880">absolute</a>(dist);</div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;        <span class="keywordflow">if</span> (tipdist &lt; eps) {</div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;            fprintf(stderr,<span class="stringliteral">&quot;Warning in IBInterpCoeffs() on rank %d - how can probe tip be on surface? Tipdist = %e\n&quot;</span>,</div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;              mpi-&gt;<a class="code" href="a00205.html#a6cfd95afd0afebd625b889fb6e58371c">rank</a>,tipdist);</div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;        }</div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;</div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;    }</div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;  <span class="keywordflow">return</span>(0);</div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;}</div>
<div class="ttc" id="a00189_html_ac75b803b570527306e1e744bfb7a604f"><div class="ttname"><a href="a00189.html#ac75b803b570527306e1e744bfb7a604f">Facet3D::x1</a></div><div class="ttdeci">double x1</div><div class="ttdef"><b>Definition:</b> <a href="a00189_source.html#l00040">immersedboundaries.h:40</a></div></div>
<div class="ttc" id="a00189_html_af88b946fb90d5f08b5fb740c70e98c10"><div class="ttname"><a href="a00189.html#af88b946fb90d5f08b5fb740c70e98c10">IBNode::x</a></div><div class="ttdeci">double x</div><div class="ttdef"><b>Definition:</b> <a href="a00189_source.html#l00130">immersedboundaries.h:130</a></div></div>
<div class="ttc" id="a00189_html_ac3b72e5b77595ca2340ecf8ccfe5fd99"><div class="ttname"><a href="a00189.html#ac3b72e5b77595ca2340ecf8ccfe5fd99">Facet3D::y1</a></div><div class="ttdeci">double y1</div><div class="ttdef"><b>Definition:</b> <a href="a00189_source.html#l00040">immersedboundaries.h:40</a></div></div>
<div class="ttc" id="a00229_html_afbb862a2fdf5b72b1f9ace42f64b556f"><div class="ttname"><a href="a00229.html#afbb862a2fdf5b72b1f9ace42f64b556f">_ArrayIndex1D_</a></div><div class="ttdeci">#define _ArrayIndex1D_(N, imax, i, ghost, index)</div><div class="ttdef"><b>Definition:</b> <a href="a00229_source.html#l00040">arrayfunctions.h:40</a></div></div>
<div class="ttc" id="a00189_html_a37d972ae0b47b9099e30983131d31916"><div class="ttname"><a href="a00189.html#a37d972ae0b47b9099e30983131d31916">IBNode::j</a></div><div class="ttdeci">int j</div><div class="ttdef"><b>Definition:</b> <a href="a00189_source.html#l00126">immersedboundaries.h:126</a></div></div>
<div class="ttc" id="a00229_html_a89e8330d9e06dd0666c50833628a125c"><div class="ttname"><a href="a00229.html#a89e8330d9e06dd0666c50833628a125c">_ArrayCopy1D_</a></div><div class="ttdeci">#define _ArrayCopy1D_(x, y, size)</div><div class="ttdef"><b>Definition:</b> <a href="a00229_source.html#l00319">arrayfunctions.h:319</a></div></div>
<div class="ttc" id="a00189_html_a5a34c6ed89d3769fb1200fdfbdc8ae33"><div class="ttname"><a href="a00189.html#a5a34c6ed89d3769fb1200fdfbdc8ae33">ImmersedBoundary::itr_max</a></div><div class="ttdeci">int itr_max</div><div class="ttdef"><b>Definition:</b> <a href="a00189_source.html#l00160">immersedboundaries.h:160</a></div></div>
<div class="ttc" id="a00189_html_ab66ed8e0098c0a86b458672a55a9cca9"><div class="ttname"><a href="a00189.html#ab66ed8e0098c0a86b458672a55a9cca9">IBNode::k</a></div><div class="ttdeci">int k</div><div class="ttdef"><b>Definition:</b> <a href="a00189_source.html#l00126">immersedboundaries.h:126</a></div></div>
<div class="ttc" id="a00189_html_a74d07ed95c86939416c6a88f1daf8e1a"><div class="ttname"><a href="a00189.html#a74d07ed95c86939416c6a88f1daf8e1a">Facet3D::nx</a></div><div class="ttdeci">double nx</div><div class="ttdef"><b>Definition:</b> <a href="a00189_source.html#l00040">immersedboundaries.h:40</a></div></div>
<div class="ttc" id="a00205_html_a481013ba007a99a4237cde5eeb3c9a29"><div class="ttname"><a href="a00205.html#a481013ba007a99a4237cde5eeb3c9a29">MPIVariables::is</a></div><div class="ttdeci">int * is</div><div class="ttdef"><b>Definition:</b> <a href="a00205_source.html#l00029">mpivars_struct.h:29</a></div></div>
<div class="ttc" id="a00244_html_a04d4e04f1f9112958dca24fc68c1818a"><div class="ttname"><a href="a00244.html#a04d4e04f1f9112958dca24fc68c1818a">TrilinearInterpCoeffs</a></div><div class="ttdeci">void TrilinearInterpCoeffs(double, double, double, double, double, double, double, double, double, double *)</div><div class="ttdef"><b>Definition:</b> <a href="a00379_source.html#l00022">TrilinearInterpolation.c:22</a></div></div>
<div class="ttc" id="a00189_html_aeab4c13a1e3fce2920ce0ff616d0fac5"><div class="ttname"><a href="a00189.html#aeab4c13a1e3fce2920ce0ff616d0fac5">ImmersedBoundary::boundary</a></div><div class="ttdeci">IBNode * boundary</div><div class="ttdef"><b>Definition:</b> <a href="a00189_source.html#l00155">immersedboundaries.h:155</a></div></div>
<div class="ttc" id="a00189_html_a97eab6d709b80585fe9e8a54b1e3da27"><div class="ttname"><a href="a00189.html#a97eab6d709b80585fe9e8a54b1e3da27">ImmersedBoundary::tolerance</a></div><div class="ttdeci">double tolerance</div><div class="ttdef"><b>Definition:</b> <a href="a00189_source.html#l00158">immersedboundaries.h:158</a></div></div>
<div class="ttc" id="a00189_html_a147a8b14bbd79c0f1a3457805e2065ba"><div class="ttname"><a href="a00189.html#a147a8b14bbd79c0f1a3457805e2065ba">Facet3D::ny</a></div><div class="ttdeci">double ny</div><div class="ttdef"><b>Definition:</b> <a href="a00189_source.html#l00040">immersedboundaries.h:40</a></div></div>
<div class="ttc" id="a00189_html_a7b34733bcf53c70cfe86f22bbb05b309"><div class="ttname"><a href="a00189.html#a7b34733bcf53c70cfe86f22bbb05b309">IBNode::surface_distance</a></div><div class="ttdeci">double surface_distance</div><div class="ttdef"><b>Definition:</b> <a href="a00189_source.html#l00136">immersedboundaries.h:136</a></div></div>
<div class="ttc" id="a00189_html_a00660"><div class="ttname"><a href="a00189.html#a00660">IBNode</a></div><div class="ttdoc">Structure defining an immersed boundary node. </div><div class="ttdef"><b>Definition:</b> <a href="a00189_source.html#l00125">immersedboundaries.h:125</a></div></div>
<div class="ttc" id="a00189_html_a00661"><div class="ttname"><a href="a00189.html#a00661">ImmersedBoundary</a></div><div class="ttdoc">Structure containing variables for immersed boundary implementation. </div><div class="ttdef"><b>Definition:</b> <a href="a00189_source.html#l00153">immersedboundaries.h:153</a></div></div>
<div class="ttc" id="a00189_html_a84f780956fce41006ca0d5bd16478490"><div class="ttname"><a href="a00189.html#a84f780956fce41006ca0d5bd16478490">IBNode::face</a></div><div class="ttdeci">Facet3D * face</div><div class="ttdef"><b>Definition:</b> <a href="a00189_source.html#l00133">immersedboundaries.h:133</a></div></div>
<div class="ttc" id="a00189_html_a9ba638c4f33720c7289cac3bf73ca088"><div class="ttname"><a href="a00189.html#a9ba638c4f33720c7289cac3bf73ca088">IBNode::interp_node_distance</a></div><div class="ttdeci">double interp_node_distance</div><div class="ttdef"><b>Definition:</b> <a href="a00189_source.html#l00136">immersedboundaries.h:136</a></div></div>
<div class="ttc" id="a00231_html_a9aa9bad8531d6733731a850ccc471a42"><div class="ttname"><a href="a00231.html#a9aa9bad8531d6733731a850ccc471a42">_GetCoordinate_</a></div><div class="ttdeci">#define _GetCoordinate_(dir, i, dim, ghosts, x, coord)</div><div class="ttdef"><b>Definition:</b> <a href="a00231_source.html#l00031">basic.h:31</a></div></div>
<div class="ttc" id="a00205_html_a00663"><div class="ttname"><a href="a00205.html#a00663">MPIVariables</a></div><div class="ttdoc">Structure of MPI-related variables. </div><div class="ttdef"><b>Definition:</b> <a href="a00205_source.html#l00024">mpivars_struct.h:24</a></div></div>
<div class="ttc" id="a00189_html_a463bf8b21578003b62221acf2e522134"><div class="ttname"><a href="a00189.html#a463bf8b21578003b62221acf2e522134">Facet3D::nz</a></div><div class="ttdeci">double nz</div><div class="ttdef"><b>Definition:</b> <a href="a00189_source.html#l00040">immersedboundaries.h:40</a></div></div>
<div class="ttc" id="a00189_html_ab3e6ed577a7c669c19de1f9c1b46c872"><div class="ttname"><a href="a00189.html#ab3e6ed577a7c669c19de1f9c1b46c872">IBNode::z</a></div><div class="ttdeci">double z</div><div class="ttdef"><b>Definition:</b> <a href="a00189_source.html#l00130">immersedboundaries.h:130</a></div></div>
<div class="ttc" id="a00189_html_a0f59ba2c552bae2f35a03ce3964a2b4a"><div class="ttname"><a href="a00189.html#a0f59ba2c552bae2f35a03ce3964a2b4a">_IB_NDIMS_</a></div><div class="ttdeci">#define _IB_NDIMS_</div><div class="ttdef"><b>Definition:</b> <a href="a00189_source.html#l00010">immersedboundaries.h:10</a></div></div>
<div class="ttc" id="a00189_html_a7f578e3fbaeeea97b65e3ade80f60a78"><div class="ttname"><a href="a00189.html#a7f578e3fbaeeea97b65e3ade80f60a78">ImmersedBoundary::n_boundary_nodes</a></div><div class="ttdeci">int n_boundary_nodes</div><div class="ttdef"><b>Definition:</b> <a href="a00189_source.html#l00161">immersedboundaries.h:161</a></div></div>
<div class="ttc" id="a00189_html_acb559820d9ca11295b4500f179ef6392"><div class="ttname"><a href="a00189.html#acb559820d9ca11295b4500f179ef6392">IBNode::i</a></div><div class="ttdeci">int i</div><div class="ttdef"><b>Definition:</b> <a href="a00189_source.html#l00126">immersedboundaries.h:126</a></div></div>
<div class="ttc" id="a00205_html_a6cfd95afd0afebd625b889fb6e58371c"><div class="ttname"><a href="a00205.html#a6cfd95afd0afebd625b889fb6e58371c">MPIVariables::rank</a></div><div class="ttdeci">int rank</div><div class="ttdef"><b>Definition:</b> <a href="a00205_source.html#l00025">mpivars_struct.h:25</a></div></div>
<div class="ttc" id="a00189_html_a9e114382f922a879776df13fd2f414a5"><div class="ttname"><a href="a00189.html#a9e114382f922a879776df13fd2f414a5">_IB_NNODES_</a></div><div class="ttdeci">#define _IB_NNODES_</div><div class="ttdef"><b>Definition:</b> <a href="a00189_source.html#l00013">immersedboundaries.h:13</a></div></div>
<div class="ttc" id="a00189_html_a0e1fe82df628138c8f3907ecddb514ae"><div class="ttname"><a href="a00189.html#a0e1fe82df628138c8f3907ecddb514ae">Facet3D::z1</a></div><div class="ttdeci">double z1</div><div class="ttdef"><b>Definition:</b> <a href="a00189_source.html#l00040">immersedboundaries.h:40</a></div></div>
<div class="ttc" id="a00243_html_ab1e1ffb6aa15887fa3bda4cfdef1f53a"><div class="ttname"><a href="a00243.html#ab1e1ffb6aa15887fa3bda4cfdef1f53a">min3</a></div><div class="ttdeci">#define min3(a, b, c)</div><div class="ttdef"><b>Definition:</b> <a href="a00243_source.html#l00023">math_ops.h:23</a></div></div>
<div class="ttc" id="a00243_html_adf1be5ccbb7a2522b4f3a64043c72880"><div class="ttname"><a href="a00243.html#adf1be5ccbb7a2522b4f3a64043c72880">absolute</a></div><div class="ttdeci">#define absolute(a)</div><div class="ttdef"><b>Definition:</b> <a href="a00243_source.html#l00032">math_ops.h:32</a></div></div>
<div class="ttc" id="a00189_html_ab927965981178aa1fba979a37168db2a"><div class="ttname"><a href="a00189.html#ab927965981178aa1fba979a37168db2a">IBNode::y</a></div><div class="ttdeci">double y</div><div class="ttdef"><b>Definition:</b> <a href="a00189_source.html#l00130">immersedboundaries.h:130</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a1b5b1eb59ced4b1ece449774787b83b4"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int IBAssembleGlobalFacetData </td>
          <td>(</td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>m</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>ib</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double *const&#160;</td>
          <td class="paramname"><em>local_var</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double **const&#160;</td>
          <td class="paramname"><em>global_var</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>nvars</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Assemble any local data computed at immersed body surface (facet centroids) into a global array.</p>
<p>The local array <em>must</em> be of length (<a class="el" href="a00189.html#ab3583871695c8f2fc06011d14e092d09">ImmersedBoundary::nfacets_local</a> X nvars).</p>
<p>The global array must be NULL at input; it will have the size (<a class="el" href="a00189.html#afd755b081f4d9ca3558ef9ca9f3c35d0">Body3D::nfacets</a> X nvars) at output on rank 0; it will remain NULL on other ranks. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">m</td><td>MPI object of type <a class="el" href="a00205.html#a00663" title="Structure of MPI-related variables. ">MPIVariables</a> </td></tr>
    <tr><td class="paramname">ib</td><td>Immersed boundary object of type <a class="el" href="a00189.html#a00661" title="Structure containing variables for immersed boundary implementation. ">ImmersedBoundary</a> </td></tr>
    <tr><td class="paramname">local_var</td><td>Local array </td></tr>
    <tr><td class="paramname">global_var</td><td>Array to store the gradient; must be NULL at input </td></tr>
    <tr><td class="paramname">nvars</td><td>Number of components in var </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="a00321_source.html#l00022">22</a> of file <a class="el" href="a00321_source.html">IBAssembleGlobalFacetData.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;{</div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;  <a class="code" href="a00205.html#a00663">MPIVariables</a>     *mpi = (<a class="code" href="a00205.html#a00663">MPIVariables</a>*) m; </div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;  <a class="code" href="a00189.html#a00661">ImmersedBoundary</a> *IB  = (<a class="code" href="a00189.html#a00661">ImmersedBoundary</a>*) ib;</div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;</div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;  <span class="keywordflow">if</span> ((*global_var) != NULL) {</div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;    fprintf(stderr,<span class="stringliteral">&quot;Error in IBAssembleGlobalFacetData()\n&quot;</span>);</div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;    fprintf(stderr,<span class="stringliteral">&quot; global_var is not NULL on rank %d\n&quot;</span>,</div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;            mpi-&gt;<a class="code" href="a00205.html#a6cfd95afd0afebd625b889fb6e58371c">rank</a> );</div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;    <span class="keywordflow">return</span> 1;</div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;  }</div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;</div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;  <span class="keywordtype">int</span> nfacets_local = IB-&gt;<a class="code" href="a00189.html#ab3583871695c8f2fc06011d14e092d09">nfacets_local</a>;</div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;  <a class="code" href="a00189.html#a00654">FacetMap</a> *fmap = IB-&gt;<a class="code" href="a00189.html#a83fe29d69e04c222af5c68e38142336c">fmap</a>;</div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;</div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;  <span class="keywordflow">if</span> ((nfacets_local == 0) &amp;&amp; (local_var != NULL)) {</div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;    fprintf(stderr, <span class="stringliteral">&quot;Error in IBAssembleGlobalFacetData()\n&quot;</span>);</div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;    fprintf(stderr, <span class="stringliteral">&quot; nfacets_local is 0 but local_var is not NULL!\n&quot;</span>);</div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;    <span class="keywordflow">return</span> 1;</div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;  }</div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;  <span class="keywordflow">if</span> ((nfacets_local &gt; 0) &amp;&amp; (local_var == NULL)) {</div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;    fprintf(stderr, <span class="stringliteral">&quot;Error in IBAssembleGlobalFacetData()\n&quot;</span>);</div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;    fprintf(stderr, <span class="stringliteral">&quot; nfacets_local &gt; 0 but local_var is NULL!\n&quot;</span>);</div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;    <span class="keywordflow">return</span> 1;</div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;  }</div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;</div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;<span class="preprocessor">#ifndef serial</span></div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;<span class="preprocessor"></span>  MPI_Status status;</div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;<span class="preprocessor"></span></div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;    <span class="keywordflow">if</span> (!mpi-&gt;<a class="code" href="a00205.html#a6cfd95afd0afebd625b889fb6e58371c">rank</a>) {</div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;</div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;    <span class="keywordtype">int</span> nfacets_global = IB-&gt;<a class="code" href="a00189.html#af858f0e9bc4a6cb1c16ad2931cf4b43d">body</a>-&gt;<a class="code" href="a00189.html#afd755b081f4d9ca3558ef9ca9f3c35d0">nfacets</a>;</div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;</div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;    <span class="comment">/* allocate arrays for whole domain */</span></div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;        *global_var = (<span class="keywordtype">double</span>*) calloc (nfacets_global*nvars, <span class="keyword">sizeof</span>(<span class="keywordtype">double</span>));</div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;    <a class="code" href="a00229.html#a2b2826031c0cd92495ab351d3e599fc5">_ArraySetValue_</a>((*global_var), (nfacets_global*nvars), 0.0);</div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;</div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;    <span class="comment">/* check array - to avoid double counting of facets */</span></div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;        <span class="keywordtype">int</span> *check = (<span class="keywordtype">int</span>*) calloc (nfacets_global, <span class="keyword">sizeof</span>(<span class="keywordtype">int</span>));</div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;    <a class="code" href="a00229.html#a2b2826031c0cd92495ab351d3e599fc5">_ArraySetValue_</a>(check, nfacets_global, 0);</div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;</div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;    <span class="comment">/* local data */</span></div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> n = 0; n &lt; nfacets_local; n++) {</div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;      <a class="code" href="a00229.html#a4cd66304bc41a7751842230af3063b62">_ArrayAXPY_</a>((local_var+n), 1.0, ((*global_var)+fmap[n].index), nvars);</div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;          check[fmap[n].<a class="code" href="a00189.html#a750b5d744c39a06bfb13e6eb010e35d0">index</a>]++;</div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;        }</div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;</div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;<span class="preprocessor">#ifndef serial</span></div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;<span class="preprocessor"></span>        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> proc = 1; proc &lt; mpi-&gt;<a class="code" href="a00205.html#ae68326adc3b3862f1162832f70727b06">nproc</a>; proc++) {</div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;</div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;            <span class="keywordtype">int</span> nf_incoming;</div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;            MPI_Recv(&amp;nf_incoming, 1, MPI_INT, proc, 98927, MPI_COMM_WORLD, &amp;status);</div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;</div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;      <span class="keywordflow">if</span> (nf_incoming &gt; 0) {</div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;</div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;              <span class="keywordtype">int</span>    *indices_incoming = (<span class="keywordtype">int</span>*)    calloc(nf_incoming, <span class="keyword">sizeof</span>(<span class="keywordtype">int</span>));</div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;              <span class="keywordtype">double</span> *var_incoming     = (<span class="keywordtype">double</span>*) calloc(nf_incoming*nvars, <span class="keyword">sizeof</span>(<span class="keywordtype">double</span>));</div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;</div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;              MPI_Recv(indices_incoming, nf_incoming, MPI_INT, proc, 98928, mpi-&gt;<a class="code" href="a00205.html#adad7a6f85831f3ac84d854b6c80aef43">world</a>, &amp;status);</div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;              MPI_Recv(var_incoming, nf_incoming*nvars, MPI_DOUBLE, proc, 98929, mpi-&gt;<a class="code" href="a00205.html#adad7a6f85831f3ac84d854b6c80aef43">world</a>, &amp;status);</div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;</div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;              <span class="keywordflow">for</span> (<span class="keywordtype">int</span> n = 0; n &lt; nf_incoming; n++) {</div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;          <a class="code" href="a00229.html#a4cd66304bc41a7751842230af3063b62">_ArrayAXPY_</a>((var_incoming+n), 1.0, ((*global_var)+indices_incoming[n]), nvars);</div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;                  check[indices_incoming[n]]++;</div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;              }</div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;        </div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;        free(indices_incoming);</div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;        free(var_incoming);</div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;      }</div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;        }</div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;<span class="preprocessor"></span></div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> n = 0; n &lt; nfacets_global; n++) {</div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;      <span class="keywordflow">if</span> (check[n] == 0) {</div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;        fprintf(stderr, <span class="stringliteral">&quot;Error in IBAssembleGlobalFacetData()\n&quot;</span>);</div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;        fprintf(stderr, <span class="stringliteral">&quot;  No data received for facet %d\n&quot;</span>, n);</div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;        <span class="keywordflow">return</span> 1;</div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;      } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;        <a class="code" href="a00229.html#a1dab5f429ccd03c4a7fbb605d8ef75b6">_ArrayScale1D_</a>(((*global_var)+n), (1.0/(<span class="keywordtype">double</span>)check[n]), nvars);</div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;      }</div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;    }</div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;</div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;</div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;<span class="preprocessor">#ifndef serial</span></div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;<span class="preprocessor"></span></div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;        MPI_Send(&amp;nfacets_local, 1, MPI_INT, 0, 98927, MPI_COMM_WORLD);</div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;</div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;    <span class="keywordflow">if</span> (nfacets_local &gt; 0) {</div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;</div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;      <span class="keywordtype">int</span> i, *indices = (<span class="keywordtype">int</span>*) calloc (nfacets_local, <span class="keyword">sizeof</span>(<span class="keywordtype">int</span>));</div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;      <span class="keywordflow">for</span> (i = 0; i &lt; nfacets_local; i++) indices[i] = fmap[i].index;</div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;</div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;          MPI_Send(indices, nfacets_local, MPI_INT, 0, 98928, mpi-&gt;<a class="code" href="a00205.html#adad7a6f85831f3ac84d854b6c80aef43">world</a>);</div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;          MPI_Send(local_var, nfacets_local*nvars, MPI_DOUBLE, 0, 98929, mpi-&gt;<a class="code" href="a00205.html#adad7a6f85831f3ac84d854b6c80aef43">world</a>);</div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;</div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;      free(indices);</div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;    }</div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;<span class="preprocessor"></span></div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;    }</div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;</div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;  <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;}</div>
<div class="ttc" id="a00229_html_a1dab5f429ccd03c4a7fbb605d8ef75b6"><div class="ttname"><a href="a00229.html#a1dab5f429ccd03c4a7fbb605d8ef75b6">_ArrayScale1D_</a></div><div class="ttdeci">#define _ArrayScale1D_(x, a, size)</div><div class="ttdef"><b>Definition:</b> <a href="a00229_source.html#l00190">arrayfunctions.h:190</a></div></div>
<div class="ttc" id="a00229_html_a2b2826031c0cd92495ab351d3e599fc5"><div class="ttname"><a href="a00229.html#a2b2826031c0cd92495ab351d3e599fc5">_ArraySetValue_</a></div><div class="ttdeci">#define _ArraySetValue_(x, size, value)</div><div class="ttdef"><b>Definition:</b> <a href="a00229_source.html#l00169">arrayfunctions.h:169</a></div></div>
<div class="ttc" id="a00189_html_a750b5d744c39a06bfb13e6eb010e35d0"><div class="ttname"><a href="a00189.html#a750b5d744c39a06bfb13e6eb010e35d0">FacetMap::index</a></div><div class="ttdeci">int index</div><div class="ttdef"><b>Definition:</b> <a href="a00189_source.html#l00069">immersedboundaries.h:69</a></div></div>
<div class="ttc" id="a00229_html_a4cd66304bc41a7751842230af3063b62"><div class="ttname"><a href="a00229.html#a4cd66304bc41a7751842230af3063b62">_ArrayAXPY_</a></div><div class="ttdeci">#define _ArrayAXPY_(x, a, y, size)</div><div class="ttdef"><b>Definition:</b> <a href="a00229_source.html#l00271">arrayfunctions.h:271</a></div></div>
<div class="ttc" id="a00189_html_af858f0e9bc4a6cb1c16ad2931cf4b43d"><div class="ttname"><a href="a00189.html#af858f0e9bc4a6cb1c16ad2931cf4b43d">ImmersedBoundary::body</a></div><div class="ttdeci">Body3D * body</div><div class="ttdef"><b>Definition:</b> <a href="a00189_source.html#l00154">immersedboundaries.h:154</a></div></div>
<div class="ttc" id="a00189_html_a00661"><div class="ttname"><a href="a00189.html#a00661">ImmersedBoundary</a></div><div class="ttdoc">Structure containing variables for immersed boundary implementation. </div><div class="ttdef"><b>Definition:</b> <a href="a00189_source.html#l00153">immersedboundaries.h:153</a></div></div>
<div class="ttc" id="a00189_html_a00654"><div class="ttname"><a href="a00189.html#a00654">FacetMap</a></div><div class="ttdoc">Structure defining a facet map. </div><div class="ttdef"><b>Definition:</b> <a href="a00189_source.html#l00067">immersedboundaries.h:67</a></div></div>
<div class="ttc" id="a00205_html_a00663"><div class="ttname"><a href="a00205.html#a00663">MPIVariables</a></div><div class="ttdoc">Structure of MPI-related variables. </div><div class="ttdef"><b>Definition:</b> <a href="a00205_source.html#l00024">mpivars_struct.h:24</a></div></div>
<div class="ttc" id="a00205_html_ae68326adc3b3862f1162832f70727b06"><div class="ttname"><a href="a00205.html#ae68326adc3b3862f1162832f70727b06">MPIVariables::nproc</a></div><div class="ttdeci">int nproc</div><div class="ttdef"><b>Definition:</b> <a href="a00205_source.html#l00026">mpivars_struct.h:26</a></div></div>
<div class="ttc" id="a00205_html_a6cfd95afd0afebd625b889fb6e58371c"><div class="ttname"><a href="a00205.html#a6cfd95afd0afebd625b889fb6e58371c">MPIVariables::rank</a></div><div class="ttdeci">int rank</div><div class="ttdef"><b>Definition:</b> <a href="a00205_source.html#l00025">mpivars_struct.h:25</a></div></div>
<div class="ttc" id="a00189_html_ab3583871695c8f2fc06011d14e092d09"><div class="ttname"><a href="a00189.html#ab3583871695c8f2fc06011d14e092d09">ImmersedBoundary::nfacets_local</a></div><div class="ttdeci">int nfacets_local</div><div class="ttdef"><b>Definition:</b> <a href="a00189_source.html#l00162">immersedboundaries.h:162</a></div></div>
<div class="ttc" id="a00189_html_afd755b081f4d9ca3558ef9ca9f3c35d0"><div class="ttname"><a href="a00189.html#afd755b081f4d9ca3558ef9ca9f3c35d0">Body3D::nfacets</a></div><div class="ttdeci">int nfacets</div><div class="ttdef"><b>Definition:</b> <a href="a00189_source.html#l00101">immersedboundaries.h:101</a></div></div>
<div class="ttc" id="a00205_html_adad7a6f85831f3ac84d854b6c80aef43"><div class="ttname"><a href="a00205.html#adad7a6f85831f3ac84d854b6c80aef43">MPIVariables::world</a></div><div class="ttdeci">MPI_Comm world</div><div class="ttdef"><b>Definition:</b> <a href="a00205_source.html#l00037">mpivars_struct.h:37</a></div></div>
<div class="ttc" id="a00189_html_a83fe29d69e04c222af5c68e38142336c"><div class="ttname"><a href="a00189.html#a83fe29d69e04c222af5c68e38142336c">ImmersedBoundary::fmap</a></div><div class="ttdeci">FacetMap * fmap</div><div class="ttdef"><b>Definition:</b> <a href="a00189_source.html#l00156">immersedboundaries.h:156</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ac0612f5f652fe65361752db0226cc18b"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int IBComputeNormalGradient </td>
          <td>(</td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>s</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>m</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double *const&#160;</td>
          <td class="paramname"><em>var</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>nvars</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double **const&#160;</td>
          <td class="paramname"><em>grad_var</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Calculate the normal gradient of a provided variables on the immersed body surface: for each "local facet", i.e., facets (of the immersed body surface) that lie within the local computational domain of this MPI rank, compute the normal gradient.</p>
<p>The variable should be a grid variable with size/layout the same as the solution variable (<a class="el" href="a00202.html#a3b6b999a764f1e2ea94bb5f28c7a558c">HyPar::u</a>) with the appropriate number of ghost points.</p>
<p>If the incoming variable has multiple components, this function will calculate normal gradient of each component.</p>
<p>The grad var array should be NULL at input; at output, it will point to an array of size (<a class="el" href="a00189.html#ab3583871695c8f2fc06011d14e092d09">ImmersedBoundary::nfacets_local</a> X nvars) that contains the normal gradient at each local facet. If there are no local facets, it will remain NULL.</p>
<p>The gradient calculation is currently first-order. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">s</td><td>Solver object of type <a class="el" href="a00202.html" title="Structure containing all solver-specific variables and functions. ">HyPar</a> </td></tr>
    <tr><td class="paramname">m</td><td>MPI object of type <a class="el" href="a00205.html#a00663" title="Structure of MPI-related variables. ">MPIVariables</a> </td></tr>
    <tr><td class="paramname">var</td><td>Variable to compute the gradient of </td></tr>
    <tr><td class="paramname">nvars</td><td>Number of components in var </td></tr>
    <tr><td class="paramname">grad_var</td><td>Array to store the gradient; must be NULL at input </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="a00325_source.html#l00033">33</a> of file <a class="el" href="a00325_source.html">IBComputeNormalGradient.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;{</div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;  <a class="code" href="a00202.html">HyPar</a>             *solver  = (<a class="code" href="a00202.html">HyPar</a>*)          s;</div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;  <a class="code" href="a00205.html#a00663">MPIVariables</a>      *mpi     = (<a class="code" href="a00205.html#a00663">MPIVariables</a>*)   m; </div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;  <a class="code" href="a00189.html#a00661">ImmersedBoundary</a>  *IB      = (<a class="code" href="a00189.html#a00661">ImmersedBoundary</a>*) solver-&gt;<a class="code" href="a00202.html#a8419c1760256467c117ef5932b943259">ib</a>;</div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;</div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;  if (!solver-&gt;<a class="code" href="a00202.html#ae83b1b0117b6a805ead2e4728945814c">flag_ib</a>) <span class="keywordflow">return</span>(0);</div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;</div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;  <span class="keywordflow">if</span> ((*grad_var) != NULL) {</div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;    fprintf(stderr,<span class="stringliteral">&quot;Error in IBComputeNormalGradient()\n&quot;</span>);</div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;    fprintf(stderr,<span class="stringliteral">&quot; grad_var is not NULL on rank %d\n&quot;</span>,</div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;            mpi-&gt;<a class="code" href="a00205.html#a6cfd95afd0afebd625b889fb6e58371c">rank</a> );</div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;    <span class="keywordflow">return</span> 1;</div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;  }</div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;</div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;  <span class="keywordtype">int</span> nfacets_local = IB-&gt;<a class="code" href="a00189.html#ab3583871695c8f2fc06011d14e092d09">nfacets_local</a>;</div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;  <a class="code" href="a00189.html#a00654">FacetMap</a> *fmap = IB-&gt;<a class="code" href="a00189.html#a83fe29d69e04c222af5c68e38142336c">fmap</a>;</div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;</div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;  <span class="keywordflow">if</span> (nfacets_local &gt; 0) {</div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;    (*grad_var) = (<span class="keywordtype">double</span>*) calloc (nvars*nfacets_local, <span class="keyword">sizeof</span>(<span class="keywordtype">double</span>));</div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;</div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> n = 0; n &lt; nfacets_local; n++) {</div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;  </div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;      <span class="keywordtype">double</span> *alpha;</div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;      <span class="keywordtype">int</span>    *nodes, j, k;</div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;  </div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;      <span class="keywordtype">double</span> v_c[nvars];</div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;      alpha = &amp;(fmap[n].<a class="code" href="a00189.html#a4855c244bb3e3ba9b245312a375eed76">interp_coeffs</a>[0]);</div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;      nodes = &amp;(fmap[n].<a class="code" href="a00189.html#a849cc8a5a571348a4d50a0332d9816f8">interp_nodes</a>[0]);</div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;      <a class="code" href="a00229.html#a2b2826031c0cd92495ab351d3e599fc5">_ArraySetValue_</a>(v_c,nvars,0.0);</div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;      <span class="keywordflow">for</span> (j=0; j&lt;<a class="code" href="a00189.html#a9e114382f922a879776df13fd2f414a5">_IB_NNODES_</a>; j++) {</div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;        <span class="keywordflow">for</span> (k=0; k&lt;nvars; k++) {</div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;          v_c[k] += ( alpha[j] * var[nvars*nodes[j]+k] );</div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;        }</div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;      }</div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;  </div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;      <span class="keywordtype">double</span> v_ns[nvars];</div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;      alpha = &amp;(fmap[n].<a class="code" href="a00189.html#a047220645840c2812b0c4b0a714ce824">interp_coeffs_ns</a>[0]);</div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;      nodes = &amp;(fmap[n].<a class="code" href="a00189.html#ae7231c0798d24ebed4aec9c288cb8d4f">interp_nodes_ns</a>[0]);</div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;      <a class="code" href="a00229.html#a2b2826031c0cd92495ab351d3e599fc5">_ArraySetValue_</a>(v_ns,nvars,0.0);</div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;      <span class="keywordflow">for</span> (j=0; j&lt;<a class="code" href="a00189.html#a9e114382f922a879776df13fd2f414a5">_IB_NNODES_</a>; j++) {</div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;        <span class="keywordflow">for</span> (k=0; k&lt;nvars; k++) {</div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;          v_ns[k] += ( alpha[j] * var[nvars*nodes[j]+k] );</div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;        }</div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;      }</div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;  </div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;     <span class="keywordtype">double</span> nx = fmap[n].<a class="code" href="a00189.html#adc15fcdbb3aaff6ced4ab10162781055">facet</a>-&gt;<a class="code" href="a00189.html#a74d07ed95c86939416c6a88f1daf8e1a">nx</a>;</div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;     <span class="keywordtype">double</span> ny = fmap[n].<a class="code" href="a00189.html#adc15fcdbb3aaff6ced4ab10162781055">facet</a>-&gt;<a class="code" href="a00189.html#a147a8b14bbd79c0f1a3457805e2065ba">ny</a>;</div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;     <span class="keywordtype">double</span> nz = fmap[n].<a class="code" href="a00189.html#adc15fcdbb3aaff6ced4ab10162781055">facet</a>-&gt;<a class="code" href="a00189.html#a463bf8b21578003b62221acf2e522134">nz</a>;</div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;  </div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;      <span class="keywordflow">for</span> (k=0; k&lt;nvars; k++) {</div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;        <span class="keywordtype">double</span> dv_dx = (v_ns[k] - v_c[k]) / fmap[n].dx;</div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;        <span class="keywordtype">double</span> dv_dy = (v_ns[k] - v_c[k]) / fmap[n].dy;</div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;        <span class="keywordtype">double</span> dv_dz = (v_ns[k] - v_c[k]) / fmap[n].dz;</div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;        (*grad_var)[n*nvars+k] = dv_dx*nx + dv_dy*ny + dv_dz*nz;</div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;      }</div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;  </div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;    }</div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;</div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;  }</div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;</div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;  <span class="keywordflow">return</span>(0);</div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;}</div>
<div class="ttc" id="a00189_html_adc15fcdbb3aaff6ced4ab10162781055"><div class="ttname"><a href="a00189.html#adc15fcdbb3aaff6ced4ab10162781055">FacetMap::facet</a></div><div class="ttdeci">Facet3D * facet</div><div class="ttdef"><b>Definition:</b> <a href="a00189_source.html#l00068">immersedboundaries.h:68</a></div></div>
<div class="ttc" id="a00229_html_a2b2826031c0cd92495ab351d3e599fc5"><div class="ttname"><a href="a00229.html#a2b2826031c0cd92495ab351d3e599fc5">_ArraySetValue_</a></div><div class="ttdeci">#define _ArraySetValue_(x, size, value)</div><div class="ttdef"><b>Definition:</b> <a href="a00229_source.html#l00169">arrayfunctions.h:169</a></div></div>
<div class="ttc" id="a00202_html_a8419c1760256467c117ef5932b943259"><div class="ttname"><a href="a00202.html#a8419c1760256467c117ef5932b943259">HyPar::ib</a></div><div class="ttdeci">void * ib</div><div class="ttdef"><b>Definition:</b> <a href="a00238_source.html#l00438">hypar.h:438</a></div></div>
<div class="ttc" id="a00189_html_a74d07ed95c86939416c6a88f1daf8e1a"><div class="ttname"><a href="a00189.html#a74d07ed95c86939416c6a88f1daf8e1a">Facet3D::nx</a></div><div class="ttdeci">double nx</div><div class="ttdef"><b>Definition:</b> <a href="a00189_source.html#l00040">immersedboundaries.h:40</a></div></div>
<div class="ttc" id="a00189_html_a147a8b14bbd79c0f1a3457805e2065ba"><div class="ttname"><a href="a00189.html#a147a8b14bbd79c0f1a3457805e2065ba">Facet3D::ny</a></div><div class="ttdeci">double ny</div><div class="ttdef"><b>Definition:</b> <a href="a00189_source.html#l00040">immersedboundaries.h:40</a></div></div>
<div class="ttc" id="a00189_html_a00661"><div class="ttname"><a href="a00189.html#a00661">ImmersedBoundary</a></div><div class="ttdoc">Structure containing variables for immersed boundary implementation. </div><div class="ttdef"><b>Definition:</b> <a href="a00189_source.html#l00153">immersedboundaries.h:153</a></div></div>
<div class="ttc" id="a00189_html_a00654"><div class="ttname"><a href="a00189.html#a00654">FacetMap</a></div><div class="ttdoc">Structure defining a facet map. </div><div class="ttdef"><b>Definition:</b> <a href="a00189_source.html#l00067">immersedboundaries.h:67</a></div></div>
<div class="ttc" id="a00189_html_a4855c244bb3e3ba9b245312a375eed76"><div class="ttname"><a href="a00189.html#a4855c244bb3e3ba9b245312a375eed76">FacetMap::interp_coeffs</a></div><div class="ttdeci">double interp_coeffs[_IB_NNODES_]</div><div class="ttdef"><b>Definition:</b> <a href="a00189_source.html#l00071">immersedboundaries.h:71</a></div></div>
<div class="ttc" id="a00189_html_a849cc8a5a571348a4d50a0332d9816f8"><div class="ttname"><a href="a00189.html#a849cc8a5a571348a4d50a0332d9816f8">FacetMap::interp_nodes</a></div><div class="ttdeci">int interp_nodes[_IB_NNODES_]</div><div class="ttdef"><b>Definition:</b> <a href="a00189_source.html#l00070">immersedboundaries.h:70</a></div></div>
<div class="ttc" id="a00189_html_ae7231c0798d24ebed4aec9c288cb8d4f"><div class="ttname"><a href="a00189.html#ae7231c0798d24ebed4aec9c288cb8d4f">FacetMap::interp_nodes_ns</a></div><div class="ttdeci">int interp_nodes_ns[_IB_NNODES_]</div><div class="ttdef"><b>Definition:</b> <a href="a00189_source.html#l00072">immersedboundaries.h:72</a></div></div>
<div class="ttc" id="a00189_html_a047220645840c2812b0c4b0a714ce824"><div class="ttname"><a href="a00189.html#a047220645840c2812b0c4b0a714ce824">FacetMap::interp_coeffs_ns</a></div><div class="ttdeci">double interp_coeffs_ns[_IB_NNODES_]</div><div class="ttdef"><b>Definition:</b> <a href="a00189_source.html#l00073">immersedboundaries.h:73</a></div></div>
<div class="ttc" id="a00205_html_a00663"><div class="ttname"><a href="a00205.html#a00663">MPIVariables</a></div><div class="ttdoc">Structure of MPI-related variables. </div><div class="ttdef"><b>Definition:</b> <a href="a00205_source.html#l00024">mpivars_struct.h:24</a></div></div>
<div class="ttc" id="a00189_html_a463bf8b21578003b62221acf2e522134"><div class="ttname"><a href="a00189.html#a463bf8b21578003b62221acf2e522134">Facet3D::nz</a></div><div class="ttdeci">double nz</div><div class="ttdef"><b>Definition:</b> <a href="a00189_source.html#l00040">immersedboundaries.h:40</a></div></div>
<div class="ttc" id="a00205_html_a6cfd95afd0afebd625b889fb6e58371c"><div class="ttname"><a href="a00205.html#a6cfd95afd0afebd625b889fb6e58371c">MPIVariables::rank</a></div><div class="ttdeci">int rank</div><div class="ttdef"><b>Definition:</b> <a href="a00205_source.html#l00025">mpivars_struct.h:25</a></div></div>
<div class="ttc" id="a00202_html_ae83b1b0117b6a805ead2e4728945814c"><div class="ttname"><a href="a00202.html#ae83b1b0117b6a805ead2e4728945814c">HyPar::flag_ib</a></div><div class="ttdeci">int flag_ib</div><div class="ttdef"><b>Definition:</b> <a href="a00238_source.html#l00436">hypar.h:436</a></div></div>
<div class="ttc" id="a00189_html_ab3583871695c8f2fc06011d14e092d09"><div class="ttname"><a href="a00189.html#ab3583871695c8f2fc06011d14e092d09">ImmersedBoundary::nfacets_local</a></div><div class="ttdeci">int nfacets_local</div><div class="ttdef"><b>Definition:</b> <a href="a00189_source.html#l00162">immersedboundaries.h:162</a></div></div>
<div class="ttc" id="a00189_html_a9e114382f922a879776df13fd2f414a5"><div class="ttname"><a href="a00189.html#a9e114382f922a879776df13fd2f414a5">_IB_NNODES_</a></div><div class="ttdeci">#define _IB_NNODES_</div><div class="ttdef"><b>Definition:</b> <a href="a00189_source.html#l00013">immersedboundaries.h:13</a></div></div>
<div class="ttc" id="a00202_html"><div class="ttname"><a href="a00202.html">HyPar</a></div><div class="ttdoc">Structure containing all solver-specific variables and functions. </div><div class="ttdef"><b>Definition:</b> <a href="a00238_source.html#l00023">hypar.h:23</a></div></div>
<div class="ttc" id="a00189_html_a83fe29d69e04c222af5c68e38142336c"><div class="ttname"><a href="a00189.html#a83fe29d69e04c222af5c68e38142336c">ImmersedBoundary::fmap</a></div><div class="ttdeci">FacetMap * fmap</div><div class="ttdef"><b>Definition:</b> <a href="a00189_source.html#l00156">immersedboundaries.h:156</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a9d52a5a358d7e754089a2b3818fde152"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int IBComputeFacetVar </td>
          <td>(</td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>s</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>m</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double *const&#160;</td>
          <td class="paramname"><em>var</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>nvars</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double **const&#160;</td>
          <td class="paramname"><em>face_var</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Calculate the interpolated value of a provided variables on the immersed body surface: for each "local facet", i.e., facets (of the immersed body surface) that lie within the local computational domain of this MPI rank, compute the interpolated value.</p>
<p>The variable should be a grid variable with size/layout the same as the solution variable (<a class="el" href="a00202.html#a3b6b999a764f1e2ea94bb5f28c7a558c">HyPar::u</a>) with the appropriate number of ghost points.</p>
<p>If the incoming variable has multiple components, this function will calculate interpolated value of each component.</p>
<p>The grad var array should be NULL at input; at output, it will point to an array of size (<a class="el" href="a00189.html#ab3583871695c8f2fc06011d14e092d09">ImmersedBoundary::nfacets_local</a> X nvars) that contains the interpolated value at each local facet. If there are no local facets, it will remain NULL.</p>
<p>The interpolation is bi/tri-linear (second-order). </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">s</td><td>Solver object of type <a class="el" href="a00202.html" title="Structure containing all solver-specific variables and functions. ">HyPar</a> </td></tr>
    <tr><td class="paramname">m</td><td>MPI object of type <a class="el" href="a00205.html#a00663" title="Structure of MPI-related variables. ">MPIVariables</a> </td></tr>
    <tr><td class="paramname">var</td><td>Variable to compute the interpolated value of </td></tr>
    <tr><td class="paramname">nvars</td><td>Number of components in var </td></tr>
    <tr><td class="paramname">face_var</td><td>Array to store the interpolated value; must be NULL at input </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="a00324_source.html#l00033">33</a> of file <a class="el" href="a00324_source.html">IBComputeFacetVar.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;{</div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;  <a class="code" href="a00202.html">HyPar</a>             *solver  = (<a class="code" href="a00202.html">HyPar</a>*)          s;</div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;  <a class="code" href="a00205.html#a00663">MPIVariables</a>      *mpi     = (<a class="code" href="a00205.html#a00663">MPIVariables</a>*)   m; </div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;  <a class="code" href="a00189.html#a00661">ImmersedBoundary</a>  *IB      = (<a class="code" href="a00189.html#a00661">ImmersedBoundary</a>*) solver-&gt;<a class="code" href="a00202.html#a8419c1760256467c117ef5932b943259">ib</a>;</div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;</div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;  if (!solver-&gt;<a class="code" href="a00202.html#ae83b1b0117b6a805ead2e4728945814c">flag_ib</a>) <span class="keywordflow">return</span>(0);</div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;</div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;  <span class="keywordflow">if</span> ((*face_var) != NULL) {</div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;    fprintf(stderr,<span class="stringliteral">&quot;Error in IBComputeFacetVar()\n&quot;</span>);</div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;    fprintf(stderr,<span class="stringliteral">&quot; face_var is not NULL on rank %d\n&quot;</span>,</div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;            mpi-&gt;<a class="code" href="a00205.html#a6cfd95afd0afebd625b889fb6e58371c">rank</a> );</div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;    <span class="keywordflow">return</span> 1;</div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;  }</div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;</div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;  <span class="keywordtype">int</span> nfacets_local = IB-&gt;<a class="code" href="a00189.html#ab3583871695c8f2fc06011d14e092d09">nfacets_local</a>;</div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;  <a class="code" href="a00189.html#a00654">FacetMap</a> *fmap = IB-&gt;<a class="code" href="a00189.html#a83fe29d69e04c222af5c68e38142336c">fmap</a>;</div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;</div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;  <span class="keywordflow">if</span> (nfacets_local &gt; 0) {</div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;    (*face_var) = (<span class="keywordtype">double</span>*) calloc (nvars*nfacets_local, <span class="keyword">sizeof</span>(<span class="keywordtype">double</span>));</div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;</div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> n = 0; n &lt; nfacets_local; n++) {</div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;  </div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;      <span class="keywordtype">double</span> *alpha;</div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;      <span class="keywordtype">int</span>    *nodes, j, k;</div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;  </div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;      <span class="keywordtype">double</span> *v_c = (*face_var) + n*nvars;</div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;      alpha = &amp;(fmap[n].<a class="code" href="a00189.html#a4855c244bb3e3ba9b245312a375eed76">interp_coeffs</a>[0]);</div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;      nodes = &amp;(fmap[n].<a class="code" href="a00189.html#a849cc8a5a571348a4d50a0332d9816f8">interp_nodes</a>[0]);</div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;      <a class="code" href="a00229.html#a2b2826031c0cd92495ab351d3e599fc5">_ArraySetValue_</a>(v_c,nvars,0.0);</div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;      <span class="keywordflow">for</span> (j=0; j&lt;<a class="code" href="a00189.html#a9e114382f922a879776df13fd2f414a5">_IB_NNODES_</a>; j++) {</div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;        <span class="keywordflow">for</span> (k=0; k&lt;nvars; k++) {</div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;          v_c[k] += ( alpha[j] * var[nvars*nodes[j]+k] );</div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;        }</div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;      }</div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;    }</div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;</div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;  }</div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;</div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;  <span class="keywordflow">return</span>(0);</div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;}</div>
<div class="ttc" id="a00229_html_a2b2826031c0cd92495ab351d3e599fc5"><div class="ttname"><a href="a00229.html#a2b2826031c0cd92495ab351d3e599fc5">_ArraySetValue_</a></div><div class="ttdeci">#define _ArraySetValue_(x, size, value)</div><div class="ttdef"><b>Definition:</b> <a href="a00229_source.html#l00169">arrayfunctions.h:169</a></div></div>
<div class="ttc" id="a00202_html_a8419c1760256467c117ef5932b943259"><div class="ttname"><a href="a00202.html#a8419c1760256467c117ef5932b943259">HyPar::ib</a></div><div class="ttdeci">void * ib</div><div class="ttdef"><b>Definition:</b> <a href="a00238_source.html#l00438">hypar.h:438</a></div></div>
<div class="ttc" id="a00189_html_a00661"><div class="ttname"><a href="a00189.html#a00661">ImmersedBoundary</a></div><div class="ttdoc">Structure containing variables for immersed boundary implementation. </div><div class="ttdef"><b>Definition:</b> <a href="a00189_source.html#l00153">immersedboundaries.h:153</a></div></div>
<div class="ttc" id="a00189_html_a00654"><div class="ttname"><a href="a00189.html#a00654">FacetMap</a></div><div class="ttdoc">Structure defining a facet map. </div><div class="ttdef"><b>Definition:</b> <a href="a00189_source.html#l00067">immersedboundaries.h:67</a></div></div>
<div class="ttc" id="a00189_html_a4855c244bb3e3ba9b245312a375eed76"><div class="ttname"><a href="a00189.html#a4855c244bb3e3ba9b245312a375eed76">FacetMap::interp_coeffs</a></div><div class="ttdeci">double interp_coeffs[_IB_NNODES_]</div><div class="ttdef"><b>Definition:</b> <a href="a00189_source.html#l00071">immersedboundaries.h:71</a></div></div>
<div class="ttc" id="a00189_html_a849cc8a5a571348a4d50a0332d9816f8"><div class="ttname"><a href="a00189.html#a849cc8a5a571348a4d50a0332d9816f8">FacetMap::interp_nodes</a></div><div class="ttdeci">int interp_nodes[_IB_NNODES_]</div><div class="ttdef"><b>Definition:</b> <a href="a00189_source.html#l00070">immersedboundaries.h:70</a></div></div>
<div class="ttc" id="a00205_html_a00663"><div class="ttname"><a href="a00205.html#a00663">MPIVariables</a></div><div class="ttdoc">Structure of MPI-related variables. </div><div class="ttdef"><b>Definition:</b> <a href="a00205_source.html#l00024">mpivars_struct.h:24</a></div></div>
<div class="ttc" id="a00205_html_a6cfd95afd0afebd625b889fb6e58371c"><div class="ttname"><a href="a00205.html#a6cfd95afd0afebd625b889fb6e58371c">MPIVariables::rank</a></div><div class="ttdeci">int rank</div><div class="ttdef"><b>Definition:</b> <a href="a00205_source.html#l00025">mpivars_struct.h:25</a></div></div>
<div class="ttc" id="a00202_html_ae83b1b0117b6a805ead2e4728945814c"><div class="ttname"><a href="a00202.html#ae83b1b0117b6a805ead2e4728945814c">HyPar::flag_ib</a></div><div class="ttdeci">int flag_ib</div><div class="ttdef"><b>Definition:</b> <a href="a00238_source.html#l00436">hypar.h:436</a></div></div>
<div class="ttc" id="a00189_html_ab3583871695c8f2fc06011d14e092d09"><div class="ttname"><a href="a00189.html#ab3583871695c8f2fc06011d14e092d09">ImmersedBoundary::nfacets_local</a></div><div class="ttdeci">int nfacets_local</div><div class="ttdef"><b>Definition:</b> <a href="a00189_source.html#l00162">immersedboundaries.h:162</a></div></div>
<div class="ttc" id="a00189_html_a9e114382f922a879776df13fd2f414a5"><div class="ttname"><a href="a00189.html#a9e114382f922a879776df13fd2f414a5">_IB_NNODES_</a></div><div class="ttdeci">#define _IB_NNODES_</div><div class="ttdef"><b>Definition:</b> <a href="a00189_source.html#l00013">immersedboundaries.h:13</a></div></div>
<div class="ttc" id="a00202_html"><div class="ttname"><a href="a00202.html">HyPar</a></div><div class="ttdoc">Structure containing all solver-specific variables and functions. </div><div class="ttdef"><b>Definition:</b> <a href="a00238_source.html#l00023">hypar.h:23</a></div></div>
<div class="ttc" id="a00189_html_a83fe29d69e04c222af5c68e38142336c"><div class="ttname"><a href="a00189.html#a83fe29d69e04c222af5c68e38142336c">ImmersedBoundary::fmap</a></div><div class="ttdeci">FacetMap * fmap</div><div class="ttdef"><b>Definition:</b> <a href="a00189_source.html#l00156">immersedboundaries.h:156</a></div></div>
</div><!-- fragment -->
</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- Start of StatCounter Code for Default Guide -->
<script type="text/javascript">
var sc_project=10897352; 
var sc_invisible=1; 
var sc_security="83042f57"; 
var scJsHost = (("https:" == document.location.protocol) ?
"https://secure." : "http://www.");
document.write("<sc"+"ript type='text/javascript' src='" +
scJsHost+
"statcounter.com/counter/counter.js'></"+"script>");
</script>
<noscript><div class="statcounter"><a title="website
statistics" href="http://statcounter.com/"
target="_blank"><img class="statcounter"
src="//c.statcounter.com/10897352/0/83042f57/1/"
alt="website statistics"></a></div></noscript>
<!-- End of StatCounter Code for Default Guide -->
