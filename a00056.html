<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.5"/>
<title>HyPar: 2D Shallow Water Equations - Latitude Belt Flow</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script><script src="http://cdn.mathjax.org/mathjax/latest/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="doxygen_html_style.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">HyPar
   &#160;<span id="projectnumber">1.0</span>
   </div>
   <div id="projectbrief">Finite-Difference Hyperbolic-Parabolic PDE Solver on Cartesian Grids</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.5 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li class="current"><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Structures</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('a00056.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Data Structures</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Namespaces</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Macros</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Pages</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">2D Shallow Water Equations - Latitude Belt Flow </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>Location: <b>hypar/Examples/2D/ShallowWater2D/LatitudeBeltFlow</b> (This directory contains all the input files needed to run this case. If there is a <em>Run.m</em>, run it in MATLAB to quickly set up, run, and visualize the example).</p>
<p>Governing equations: 2D Shallow Water Equations (<a class="el" href="a00210.html" title="2D Shallow Water Equations ">shallowwater2d.h</a>)</p>
<p>References:</p>
<ul>
<li>Zhu, Et. al., "Variational Data Assimilation with a Variable Resolution
   Finite-Element Shallow-Water Equations Model", Monthly Weather Review, 122, 1994, pp. 946&ndash;965.<br/>
 Govering equations and approximation of Coriolis forces: Eqns (2.1)-(2.4)<br/>
 Problem definition: Eqns. (4.1)-(4.3)</li>
</ul>
<p>Domain: \(0 \le x \le 6,000,000\,{\rm m}, 0\le y \le 4,400,000\,{\rm m}\), <em>"periodic"</em> (<a class="el" href="a00189.html#a65ffa4253dee762c65092abcf04ecdee">_PERIODIC_</a>) boundaries along <em>x</em>, <em>"slip wall"</em> (<a class="el" href="a00189.html#a6cd5a586de4ae1a3b73884d62f76bdee">_SW_SLIP_WALL_</a>) boundaries along <em>y</em>.</p>
<p>Initial solution: See equations (4.1) and (4.2) in reference, constant (zero) bottom topography</p>
<p>Other parameters:</p>
<ul>
<li>\(g=10\) (<a class="el" href="a00176.html#ab30c765b9be1b7776c97c899a12a66bb">ShallowWater2D::g</a>)</li>
<li>\(\hat{f}=0.0001\) (<a class="el" href="a00176.html#acc808f03e31ad5612b724fe23dea05ab">ShallowWater2D::fhat</a>)</li>
<li>\(\beta = 1.5\times 10^{-11}\) (<a class="el" href="a00176.html#a9424343761f8c4f4c1afe8f5b6bf471b">ShallowWater2D::beta</a>)</li>
<li>\(D=4400000\) (<a class="el" href="a00176.html#ad8657a5ec76e12f3066fb4b4eb75ace9">ShallowWater2D::D</a>)</li>
</ul>
<p>Numerical Method:</p>
<ul>
<li>Spatial discretization (hyperbolic): 5th order WENO (<a class="el" href="a00153.html#af2195885ad055989a1b2b11655843343" title="5th order WENO reconstruction (component-wise) on a uniform grid ">Interp1PrimFifthOrderWENO()</a>)</li>
<li>Time integration: RK4 (<a class="el" href="a00217.html#aca6ebec6e6998f0c509bb38fa91f3321">TimeRK()</a>, <a class="el" href="a00159.html#a47de987716954223b3c26bb842b21bf8">_RK_44_</a>)</li>
</ul>
<h2>Input files required: </h2>
<p>Note: in addition to the usual input files that <a class="el" href="a00164.html" title="Structure containing all solver-specific variables and functions. ">HyPar</a> needs, this physical model needs the following input file(s):</p>
<ul>
<li><b>topography.inp</b> : file containing the bottom topography (same format as <b>initial.inp</b>).</li>
</ul>
<p>However, this case has a constant (zero) bottom topography, and thus this file can be skipped.</p>
<p><b>solver.inp</b> </p>
<div class="fragment"><div class="line">begin</div>
<div class="line">    ndims              2</div>
<div class="line">    nvars              3</div>
<div class="line">    size               150 120</div>
<div class="line">    iproc              2 2</div>
<div class="line">    ghost              3</div>
<div class="line">    n_iter             2000</div>
<div class="line">    restart_iter       0 </div>
<div class="line">    time_scheme        rk</div>
<div class="line">    time_scheme_type   44</div>
<div class="line">    hyp_space_scheme   weno5</div>
<div class="line">    hyp_interp_type    components</div>
<div class="line">    dt                 180</div>
<div class="line">    conservation_check yes</div>
<div class="line">    screen_op_iter     20</div>
<div class="line">    file_op_iter       20</div>
<div class="line">    op_file_format     text</div>
<div class="line">    ip_file_type       ascii</div>
<div class="line">    input_mode         serial</div>
<div class="line">    output_mode        serial</div>
<div class="line">    op_overwrite       no</div>
<div class="line">    model              shallow-water-2d</div>
<div class="line">end</div>
</div><!-- fragment --><p><b>boundary.inp</b> </p>
<div class="fragment"><div class="line">4</div>
<div class="line">periodic                  0       1    0    0           0   4400000.0</div>
<div class="line">periodic                  0      -1    0    0           0   4400000.0</div>
<div class="line">shallow-water-slip-wall   1       1    0    6000000.0   0   0 </div>
<div class="line">0.0 0.0</div>
<div class="line">shallow-water-slip-wall   1      -1    0    6000000.0   0   0</div>
<div class="line">0.0 0.0</div>
</div><!-- fragment --><p><b>physics.inp</b> </p>
<div class="fragment"><div class="line">begin</div>
<div class="line">  gravity         10.0</div>
<div class="line">  topography_type 0</div>
<div class="line">  coriolis_fhat   0.0001</div>
<div class="line">  coriolis_beta   1.5e-11</div>
<div class="line">  coriolis_D      4400000</div>
<div class="line">  upwinding       llf-<span class="keywordtype">char</span></div>
<div class="line">end</div>
</div><!-- fragment --><p><b>weno.inp</b> (optional) </p>
<div class="fragment"><div class="line">begin</div>
<div class="line">    mapped               0</div>
<div class="line">    borges               0</div>
<div class="line">    yc                   1</div>
<div class="line">    no_limiting          0</div>
<div class="line">    epsilon              1.0e-6</div>
<div class="line">    p                    2</div>
<div class="line">    rc                   0.3</div>
<div class="line">    xi                   0.001</div>
<div class="line">    tol                  1e-16</div>
<div class="line">end</div>
</div><!-- fragment --><p>To generate <b>initial.inp</b> and <b>topography.inp</b>, compile and run the following code in the run directory (note: topography.inp can be skipped since this case involves a uniform topography). </p>
<div class="fragment"><div class="line"><span class="comment">/*</span></div>
<div class="line"><span class="comment">  Code to generate the initial solution for:</span></div>
<div class="line"><span class="comment">  Case: Limited Area Channel Flow</span></div>
<div class="line"><span class="comment">  Model: ShallowWater2D</span></div>
<div class="line"><span class="comment"></span></div>
<div class="line"><span class="comment">  References:</span></div>
<div class="line"><span class="comment">  Zhu, Et. al., &quot;Variational Data Assimilation with a Variable Resolution </span></div>
<div class="line"><span class="comment">  Finite-Element Shallow-Water Equations Model&quot;, Monthly Weather Review,</span></div>
<div class="line"><span class="comment">  122, 1994, pp. 946--965</span></div>
<div class="line"><span class="comment">  http://dx.doi.org/10.1175/1520-0493(1994)122%3C0946:VDAWAV%3E2.0.CO;2</span></div>
<div class="line"><span class="comment">  Eqns. (4.1)-(4.3)</span></div>
<div class="line"><span class="comment"></span></div>
<div class="line"><span class="comment">  Needs: solver.inp</span></div>
<div class="line"><span class="comment">  Writes out: initial.inp</span></div>
<div class="line"><span class="comment">*/</span></div>
<div class="line"></div>
<div class="line"><span class="preprocessor">#include &lt;stdio.h&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;stdlib.h&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;math.h&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;string.h&gt;</span></div>
<div class="line"></div>
<div class="line">  <span class="comment">/* some global parameters */</span></div>
<div class="line"><span class="keywordtype">double</span> L = 6000000.0,</div>
<div class="line">       D = 4400000.0,</div>
<div class="line">       g = 10.0,</div>
<div class="line">       fhat = 1e-4,</div>
<div class="line">       beta = 1.5e-11,</div>
<div class="line">       H0 = 2000.0,</div>
<div class="line">       H1 = 220.0,</div>
<div class="line">       H2 = 133.0;</div>
<div class="line"></div>
<div class="line"><span class="keywordtype">double</span> hfunction(<span class="keywordtype">double</span> x,<span class="keywordtype">double</span> y) {</div>
<div class="line">  <span class="keywordtype">double</span> pi = 4.0*atan(1.0);</div>
<div class="line">  <span class="keywordtype">double</span> h = H0 + H1*tanh((9.0*(0.5*D-y))/(2.0*D))</div>
<div class="line">             + H2 * (1.0/cosh(9.0*(0.5*D-y)/D)) * (1.0/cosh(9.0*(0.5*D-y)/D)) * sin(2*pi*x/L);</div>
<div class="line">  <span class="keywordflow">return</span>(h);</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"><span class="keywordtype">int</span> <a class="code" href="a00318.html#a3c04138a5bfe5d72780bb7e82a18e627">main</a>(){</div>
<div class="line">    <span class="keywordtype">int</span>   NI = 15, NJ = 12, ndims = 2;</div>
<div class="line">  <span class="keywordtype">char</span>  ip_file_type[50]; </div>
<div class="line">  strcpy(ip_file_type,<span class="stringliteral">&quot;ascii&quot;</span>);</div>
<div class="line"></div>
<div class="line">  FILE *in;</div>
<div class="line">  printf(<span class="stringliteral">&quot;Reading file \&quot;solver.inp\&quot;...\n&quot;</span>);</div>
<div class="line">  in = fopen(<span class="stringliteral">&quot;solver.inp&quot;</span>,<span class="stringliteral">&quot;r&quot;</span>);</div>
<div class="line">  <span class="keywordflow">if</span> (!in) {</div>
<div class="line">    printf(<span class="stringliteral">&quot;Error: Input file \&quot;solver.inp\&quot; not found.\n&quot;</span>);</div>
<div class="line">    <span class="keywordflow">return</span>(0);</div>
<div class="line">  } <span class="keywordflow">else</span> {</div>
<div class="line">    <span class="keywordtype">char</span> word[500];</div>
<div class="line">    fscanf(in,<span class="stringliteral">&quot;%s&quot;</span>,word);</div>
<div class="line">    <span class="keywordflow">if</span> (!strcmp(word, <span class="stringliteral">&quot;begin&quot;</span>)) {</div>
<div class="line">      <span class="keywordflow">while</span> (strcmp(word, <span class="stringliteral">&quot;end&quot;</span>)) {</div>
<div class="line">        fscanf(in,<span class="stringliteral">&quot;%s&quot;</span>,word);</div>
<div class="line">        <span class="keywordflow">if</span> (!strcmp(word, <span class="stringliteral">&quot;ndims&quot;</span>)) fscanf(in,<span class="stringliteral">&quot;%d&quot;</span>,&amp;ndims);</div>
<div class="line">        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcmp(word, <span class="stringliteral">&quot;size&quot;</span>)) {</div>
<div class="line">          fscanf(in,<span class="stringliteral">&quot;%d&quot;</span>,&amp;NI);</div>
<div class="line">          fscanf(in,<span class="stringliteral">&quot;%d&quot;</span>,&amp;NJ);</div>
<div class="line">        } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcmp(word, <span class="stringliteral">&quot;ip_file_type&quot;</span>)) fscanf(in,<span class="stringliteral">&quot;%s&quot;</span>,ip_file_type);</div>
<div class="line">      }</div>
<div class="line">    } <span class="keywordflow">else</span> printf(<span class="stringliteral">&quot;Error: Illegal format in solver.inp. Crash and burn!\n&quot;</span>);</div>
<div class="line">  }</div>
<div class="line">  fclose(in);</div>
<div class="line"></div>
<div class="line">  <span class="keywordflow">if</span> (ndims != 2) {</div>
<div class="line">    printf(<span class="stringliteral">&quot;ndims is not 2 in solver.inp. this code is to generate 2D initial conditions\n&quot;</span>);</div>
<div class="line">    <span class="keywordflow">return</span>(0);</div>
<div class="line">  }</div>
<div class="line">    printf(<span class="stringliteral">&quot;Grid:\t\t\t%d X %d\n&quot;</span>,NI,NJ);</div>
<div class="line"></div>
<div class="line">    <span class="keywordtype">int</span> i,j;</div>
<div class="line">    <span class="keywordtype">double</span> dx = L / ((double)NI);</div>
<div class="line">    <span class="keywordtype">double</span> dy = D / ((double)NJ-1);</div>
<div class="line"></div>
<div class="line">    <span class="keywordtype">double</span> *x, *y, *u0, *u1, *u2;</div>
<div class="line">    x  = (<span class="keywordtype">double</span>*) calloc (NI   , <span class="keyword">sizeof</span>(<span class="keywordtype">double</span>));</div>
<div class="line">    y  = (<span class="keywordtype">double</span>*) calloc (NJ   , <span class="keyword">sizeof</span>(<span class="keywordtype">double</span>));</div>
<div class="line">    u0 = (<span class="keywordtype">double</span>*) calloc (NI*NJ, <span class="keyword">sizeof</span>(<span class="keywordtype">double</span>));</div>
<div class="line">    u1 = (<span class="keywordtype">double</span>*) calloc (NI*NJ, <span class="keyword">sizeof</span>(<span class="keywordtype">double</span>));</div>
<div class="line">    u2 = (<span class="keywordtype">double</span>*) calloc (NI*NJ, <span class="keyword">sizeof</span>(<span class="keywordtype">double</span>));</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">for</span> (i = 0; i &lt; NI; i++){</div>
<div class="line">    <span class="keywordflow">for</span> (j = 0; j &lt; NJ; j++){</div>
<div class="line">        x[i] = i*dx;</div>
<div class="line">        y[j] = j*dy;</div>
<div class="line">      <span class="keywordtype">int</span> p = NI*j + i;</div>
<div class="line">      <span class="keywordtype">double</span> h, u, v, hE, hW, hN, hS;</div>
<div class="line">      h  = hfunction(x[i],y[j]);</div>
<div class="line">      hE = hfunction(x[i]+dx,y[j]);</div>
<div class="line">      hW = hfunction(x[i]-dx,y[j]);</div>
<div class="line">      hN = hfunction(x[i],y[j]+dy);</div>
<div class="line">      hS = hfunction(x[i],y[j]-dy);</div>
<div class="line"></div>
<div class="line">      <span class="keywordtype">double</span> f = fhat + beta * (y[j] - 0.5*D);</div>
<div class="line">      <span class="keywordtype">double</span> h_x, h_y;</div>
<div class="line">      h_x = (hE - hW) / (2*dx);</div>
<div class="line">      h_y = (hN - hS) / (2*dy);</div>
<div class="line"></div>
<div class="line">      u = -(g/f) * h_y;</div>
<div class="line">      v =  (g/f) * h_x;</div>
<div class="line"></div>
<div class="line">      u0[p] = h;</div>
<div class="line">      u1[p] = h*u;</div>
<div class="line">      u2[p] = h*v;</div>
<div class="line">      }</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">  FILE *out;</div>
<div class="line">  <span class="keywordflow">if</span> (!strcmp(ip_file_type,<span class="stringliteral">&quot;ascii&quot;</span>)) {</div>
<div class="line">    printf(<span class="stringliteral">&quot;Writing ASCII initial solution file initial.inp\n&quot;</span>);</div>
<div class="line">    out = fopen(<span class="stringliteral">&quot;initial.inp&quot;</span>,<span class="stringliteral">&quot;w&quot;</span>);</div>
<div class="line">    <span class="keywordflow">for</span> (i = 0; i &lt; NI; i++) fprintf(out,<span class="stringliteral">&quot;%1.16e &quot;</span>,x[i]);</div>
<div class="line">    fprintf(out,<span class="stringliteral">&quot;\n&quot;</span>);</div>
<div class="line">    <span class="keywordflow">for</span> (j = 0; j &lt; NJ; j++) fprintf(out,<span class="stringliteral">&quot;%1.16e &quot;</span>,y[j]);</div>
<div class="line">    fprintf(out,<span class="stringliteral">&quot;\n&quot;</span>);</div>
<div class="line">    <span class="keywordflow">for</span> (j = 0; j &lt; NJ; j++)    {</div>
<div class="line">        <span class="keywordflow">for</span> (i = 0; i &lt; NI; i++)    {</div>
<div class="line">        <span class="keywordtype">int</span> p = NI*j + i;</div>
<div class="line">        fprintf(out,<span class="stringliteral">&quot;%1.16e &quot;</span>,u0[p]);</div>
<div class="line">      }</div>
<div class="line">    }</div>
<div class="line">    fprintf(out,<span class="stringliteral">&quot;\n&quot;</span>);</div>
<div class="line">    <span class="keywordflow">for</span> (j = 0; j &lt; NJ; j++)    {</div>
<div class="line">        <span class="keywordflow">for</span> (i = 0; i &lt; NI; i++)    {</div>
<div class="line">        <span class="keywordtype">int</span> p = NI*j + i;</div>
<div class="line">        fprintf(out,<span class="stringliteral">&quot;%1.16e &quot;</span>,u1[p]);</div>
<div class="line">      }</div>
<div class="line">    }</div>
<div class="line">    fprintf(out,<span class="stringliteral">&quot;\n&quot;</span>);</div>
<div class="line">    <span class="keywordflow">for</span> (j = 0; j &lt; NJ; j++)    {</div>
<div class="line">        <span class="keywordflow">for</span> (i = 0; i &lt; NI; i++)    {</div>
<div class="line">        <span class="keywordtype">int</span> p = NI*j + i;</div>
<div class="line">        fprintf(out,<span class="stringliteral">&quot;%1.16e &quot;</span>,u2[p]);</div>
<div class="line">      }</div>
<div class="line">    }</div>
<div class="line">    fprintf(out,<span class="stringliteral">&quot;\n&quot;</span>);</div>
<div class="line">      fclose(out);</div>
<div class="line">  } <span class="keywordflow">else</span> <span class="keywordflow">if</span> ((!strcmp(ip_file_type,<span class="stringliteral">&quot;binary&quot;</span>)) || (!strcmp(ip_file_type,<span class="stringliteral">&quot;bin&quot;</span>))) {</div>
<div class="line">    printf(<span class="stringliteral">&quot;Writing binary initial solution file initial.inp\n&quot;</span>);</div>
<div class="line">    out = fopen(<span class="stringliteral">&quot;initial.inp&quot;</span>,<span class="stringliteral">&quot;wb&quot;</span>);</div>
<div class="line">    fwrite(x,<span class="keyword">sizeof</span>(<span class="keywordtype">double</span>),NI,out);</div>
<div class="line">    fwrite(y,<span class="keyword">sizeof</span>(<span class="keywordtype">double</span>),NJ,out);</div>
<div class="line">    <span class="keywordtype">double</span> *U = (<span class="keywordtype">double</span>*) calloc (3*NI*NJ,<span class="keyword">sizeof</span>(<span class="keywordtype">double</span>));</div>
<div class="line">    <span class="keywordflow">for</span> (i=0; i &lt; NI; i++) {</div>
<div class="line">      <span class="keywordflow">for</span> (j = 0; j &lt; NJ; j++) {</div>
<div class="line">        <span class="keywordtype">int</span> p = NI*j + i;</div>
<div class="line">        U[3*p+0] = u0[p];</div>
<div class="line">        U[3*p+1] = u1[p];</div>
<div class="line">        U[3*p+2] = u2[p];</div>
<div class="line">      }</div>
<div class="line">    }</div>
<div class="line">    fwrite(U,<span class="keyword">sizeof</span>(<span class="keywordtype">double</span>),3*NI*NJ,out);</div>
<div class="line">    free(U);</div>
<div class="line">    fclose(out);</div>
<div class="line">  }</div>
<div class="line"></div>
<div class="line">    free(x);</div>
<div class="line">    free(y);</div>
<div class="line">    free(u0);</div>
<div class="line">    free(u1);</div>
<div class="line">    free(u2);</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">return</span>(0);</div>
<div class="line">}</div>
</div><!-- fragment --><h2>Output: </h2>
<p>Note that <b>iproc</b> is set to </p>
<pre class="fragment">  2 2
</pre><p>in <b>solver.inp</b> (i.e., 2 processors along <em>x</em>, and 2 processors along <em>y</em>). Thus, this example should be run with 4 MPI ranks (or change <b>iproc</b>).</p>
<p>After running the code, there should be 101 solution output files <b>op_00000.dat</b>, ..., <b>op_00100.dat</b>; the first one is the solution at \(t=0\) and the final one is the solution at \(t=360000\). Since <a class="el" href="a00164.html#a4e93cb107e180ef982b74cef7726b70f">HyPar::op_overwrite</a> is set to <em>no</em> in <b>solver.inp</b>, separate files are written for solutions at each output time.</p>
<p><a class="el" href="a00164.html#a51a3b8c19b86e9e1df5be02b05a6613c">HyPar::op_file_format</a> is set to <em>text</em> in <b>solver.inp</b>, and thus, all the files are in plain text (ASCII) format. In these files, the data is written out as: the first two columns are grid indices, the next two columns are the x and y coordinates, and the remaining columns are the three solution components. <a class="el" href="a00164.html#a51a3b8c19b86e9e1df5be02b05a6613c">HyPar::op_file_format</a> can also be set to <em>tecplot2d</em> to get the solution files in the Tecplot format (that can be read using any visualization software that supports Tecplot format).</p>
<p>The following plot shows an animation of the solution: </p>
<div class="image">
<img src="Solution_2DShallowWater_LatitudeBelt.gif" alt="Solution_2DShallowWater_LatitudeBelt.gif"/>
</div>
<p> It was obtained by using the following MATLAB code: </p>
<div class="fragment"><div class="line">clear all;</div>
<div class="line">close all;</div>
<div class="line"></div>
<div class="line">fname_indices = input(<span class="stringliteral">&#39;Enter range of file indices to plot: &#39;</span>);</div>
<div class="line"></div>
<div class="line">% Load initial solution file</div>
<div class="line">data = load(<span class="stringliteral">&#39;op_00000.dat&#39;</span>);</div>
<div class="line"></div>
<div class="line">% find out <a class="code" href="a00199.html#affe776513b24d84b39af8ab0930fef7f">max</a> grid sizes</div>
<div class="line">imax = <a class="code" href="a00199.html#affe776513b24d84b39af8ab0930fef7f">max</a>(data(:,1)) + 1;</div>
<div class="line">jmax = <a class="code" href="a00199.html#affe776513b24d84b39af8ab0930fef7f">max</a>(data(:,2)) + 1;</div>
<div class="line"></div>
<div class="line">%spatial coordinates</div>
<div class="line">x = reshape(data(:,3),imax,jmax);</div>
<div class="line">y = reshape(data(:,4),imax,jmax);</div>
<div class="line"></div>
<div class="line">count = 0;</div>
<div class="line"><span class="keywordflow">for</span> i = fname_indices</div>
<div class="line">    fname = strcat(<span class="stringliteral">&#39;op_&#39;</span>,sprintf(<span class="stringliteral">&#39;%05d&#39;</span>,i),<span class="stringliteral">&#39;.dat&#39;</span>);</div>
<div class="line">    % read solution</div>
<div class="line">    data = load(fname);</div>
<div class="line">    h = reshape(data(:,5),imax,jmax);</div>
<div class="line">    u = reshape(data(:,6),imax,jmax)./h;</div>
<div class="line">    v = reshape(data(:,7),imax,jmax)./h;</div>
<div class="line"></div>
<div class="line">    % plot</div>
<div class="line">    scrsz = <span class="keyword">get</span>(0,<span class="stringliteral">&#39;screensize&#39;</span>);</div>
<div class="line">    width = 0.9*scrsz(3);</div>
<div class="line">    figure(1);</div>
<div class="line">    set(1,<span class="stringliteral">&#39;Position&#39;</span>,[0 0 width 0.8*width]);</div>
<div class="line">    surf(x,y,h);</div>
<div class="line">    view(100,60);</div>
<div class="line">    colorbar;</div>
<div class="line">    </div>
<div class="line">    filename = [&#39;fig_&#39;,sprintf(&#39;%05d&#39;,count),&#39;.png&#39;];</div>
<div class="line">    print(1,filename,<span class="stringliteral">&#39;-dpng&#39;</span>);</div>
<div class="line">    </div>
<div class="line">    count = count+1;</div>
<div class="line">end</div>
</div><!-- fragment --><p>Since <a class="el" href="a00164.html#ac92c34fe456d92c694eacd2231f5a7b1">HyPar::ConservationCheck</a> is set to <em>yes</em> in <b>solver.inp</b>, the code checks for conservation error and prints it to screen, as well as the file <b>conservation.dat:</b> </p>
<div class="fragment"><div class="line"> 150  120    2    2 1.8000000000000000E+02  3.0050505050505077E-16 5.4521365427062857E-04 1.5985329391656518E+15 </div>
</div><!-- fragment --><p> The numbers are: number of grid points in each dimension (<a class="el" href="a00164.html#aa989ebb755986852177779cdf7bd8c85">HyPar::dim_global</a>), number of processors in each dimension (<a class="el" href="a00167.html#a0be0f30a83bc3f3d9f6ee3a36bbf2716">MPIVariables::iproc</a>), time step size (<a class="el" href="a00164.html#a03e28be41881b703c836edbfe9b51b17">HyPar::dt</a>), and conservation error of each component(<a class="el" href="a00164.html#a965363cd64ce50ae17705dfb285dd0ab">HyPar::ConservationError</a>). Note that that conservation error for the water height is zero to machine precision (the non-zero conservation "error" for the momentum components is due to the non-zero source term - Coriolis force).</p>
<p>Expected screen output: </p>
<div class="fragment"><div class="line"><a class="code" href="a00164.html">HyPar</a> - Parallel (MPI) version with 4 processes</div>
<div class="line">Compiled with PETSc time integration.</div>
<div class="line">Reading solver inputs from file &quot;solver.inp&quot;.</div>
<div class="line">    No. of dimensions                          : 2</div>
<div class="line">    No. of variables                           : 3</div>
<div class="line">    Domain size                                : 150 120 </div>
<div class="line">    Processes along each dimension             : 2 2 </div>
<div class="line">    No. of ghosts pts                          : 3</div>
<div class="line">    No. of iter.                               : 2000</div>
<div class="line">    Restart iteration                          : 0</div>
<div class="line">    Time integration scheme                    : rk (44)</div>
<div class="line">    Spatial discretization scheme (hyperbolic) : weno5</div>
<div class="line">    Split hyperbolic flux term?                : no</div>
<div class="line">    Interpolation type for hyperbolic term     : components</div>
<div class="line">    Spatial discretization type   (parabolic ) : nonconservative-1stage</div>
<div class="line">    Spatial discretization scheme (parabolic ) : 2</div>
<div class="line">    Time Step                                  : 1.800000E+02</div>
<div class="line">    Check for conservation                     : yes</div>
<div class="line">    Screen output iterations                   : 20</div>
<div class="line">    File output iterations                     : 20</div>
<div class="line">    Initial solution file type                 : ascii</div>
<div class="line">    Initial solution read mode                 : serial</div>
<div class="line">    Solution file write mode                   : serial</div>
<div class="line">    Solution file format                       : text</div>
<div class="line">    Overwrite solution file                    : no</div>
<div class="line">    Physical model                             : shallow-water-2d</div>
<div class="line">Partitioning domain.</div>
<div class="line">Allocating data arrays.</div>
<div class="line">Reading array from ASCII file initial.inp (Serial mode).</div>
<div class="line">Volume integral of the initial solution:</div>
<div class="line"> 0:  5.3243697478991552E+16</div>
<div class="line"> 1:  5.2823596148641619E+17</div>
<div class="line"> 2:  -5.9375000000000000E+00</div>
<div class="line">Reading boundary conditions from &quot;boundary.inp&quot;.</div>
<div class="line">  Boundary                       periodic:  Along dimension  0 and face +1</div>
<div class="line">  Boundary                       periodic:  Along dimension  0 and face -1</div>
<div class="line">  Boundary        shallow-water-slip-wall:  Along dimension  1 and face +1</div>
<div class="line">  Boundary        shallow-water-slip-wall:  Along dimension  1 and face -1</div>
<div class="line">4 boundary condition(s) read.</div>
<div class="line">Initializing solvers.</div>
<div class="line">Reading WENO parameters from weno.inp.</div>
<div class="line">Initializing physics. Model = &quot;shallow-water-2d&quot;</div>
<div class="line">Reading physical model inputs from file &quot;physics.inp&quot;.</div>
<div class="line">Setting up time integration.</div>
<div class="line">Solving in time (from 0 to 2000 iterations)</div>
<div class="line">Writing solution file op_00000.dat.</div>
<div class="line">Iteration:      20  Time: 3.600E+03  Max CFL: 8.283E-01  Max Diff. No.: -1.000E+00  Norm: 4.4377E+02  Conservation loss: 1.5678E+13</div>
<div class="line">Writing solution file op_00001.dat.</div>
<div class="line">Iteration:      40  Time: 7.200E+03  Max CFL: 8.317E-01  Max Diff. No.: -1.000E+00  Norm: 3.9860E+02  Conservation loss: 3.1416E+13</div>
<div class="line">Writing solution file op_00002.dat.</div>
<div class="line">Iteration:      60  Time: 1.080E+04  Max CFL: 8.309E-01  Max Diff. No.: -1.000E+00  Norm: 3.3905E+02  Conservation loss: 4.7255E+13</div>
<div class="line">Writing solution file op_00003.dat.</div>
<div class="line">Iteration:      80  Time: 1.440E+04  Max CFL: 8.313E-01  Max Diff. No.: -1.000E+00  Norm: 3.0518E+02  Conservation loss: 6.3217E+13</div>
<div class="line">Writing solution file op_00004.dat.</div>
<div class="line">Iteration:     100  Time: 1.800E+04  Max CFL: 8.289E-01  Max Diff. No.: -1.000E+00  Norm: 2.4485E+02  Conservation loss: 7.9308E+13</div>
<div class="line">Writing solution file op_00005.dat.</div>
<div class="line">Iteration:     120  Time: 2.160E+04  Max CFL: 8.247E-01  Max Diff. No.: -1.000E+00  Norm: 3.8857E+02  Conservation loss: 9.5503E+13</div>
<div class="line">Writing solution file op_00006.dat.</div>
<div class="line">Iteration:     140  Time: 2.520E+04  Max CFL: 8.258E-01  Max Diff. No.: -1.000E+00  Norm: 4.4309E+02  Conservation loss: 1.1174E+14</div>
<div class="line">Writing solution file op_00007.dat.</div>
<div class="line">Iteration:     160  Time: 2.880E+04  Max CFL: 8.270E-01  Max Diff. No.: -1.000E+00  Norm: 4.9726E+02  Conservation loss: 1.2797E+14</div>
<div class="line">Writing solution file op_00008.dat.</div>
<div class="line">Iteration:     180  Time: 3.240E+04  Max CFL: 8.291E-01  Max Diff. No.: -1.000E+00  Norm: 5.0514E+02  Conservation loss: 1.4414E+14</div>
<div class="line">Writing solution file op_00009.dat.</div>
<div class="line">Iteration:     200  Time: 3.600E+04  Max CFL: 8.401E-01  Max Diff. No.: -1.000E+00  Norm: 5.2483E+02  Conservation loss: 1.6016E+14</div>
<div class="line">Writing solution file op_00010.dat.</div>
<div class="line">Iteration:     220  Time: 3.960E+04  Max CFL: 8.306E-01  Max Diff. No.: -1.000E+00  Norm: 4.9425E+02  Conservation loss: 1.7616E+14</div>
<div class="line">Writing solution file op_00011.dat.</div>
<div class="line">Iteration:     240  Time: 4.320E+04  Max CFL: 8.215E-01  Max Diff. No.: -1.000E+00  Norm: 4.6916E+02  Conservation loss: 1.9223E+14</div>
<div class="line">Writing solution file op_00012.dat.</div>
<div class="line">Iteration:     260  Time: 4.680E+04  Max CFL: 8.213E-01  Max Diff. No.: -1.000E+00  Norm: 3.7173E+02  Conservation loss: 2.0834E+14</div>
<div class="line">Writing solution file op_00013.dat.</div>
<div class="line">Iteration:     280  Time: 5.040E+04  Max CFL: 8.184E-01  Max Diff. No.: -1.000E+00  Norm: 5.0904E+02  Conservation loss: 2.2445E+14</div>
<div class="line">Writing solution file op_00014.dat.</div>
<div class="line">Iteration:     300  Time: 5.400E+04  Max CFL: 8.127E-01  Max Diff. No.: -1.000E+00  Norm: 5.4971E+02  Conservation loss: 2.4052E+14</div>
<div class="line">Writing solution file op_00015.dat.</div>
<div class="line">Iteration:     320  Time: 5.760E+04  Max CFL: 8.025E-01  Max Diff. No.: -1.000E+00  Norm: 6.0587E+02  Conservation loss: 2.5651E+14</div>
<div class="line">Writing solution file op_00016.dat.</div>
<div class="line">Iteration:     340  Time: 6.120E+04  Max CFL: 8.302E-01  Max Diff. No.: -1.000E+00  Norm: 6.5132E+02  Conservation loss: 2.7238E+14</div>
<div class="line">Writing solution file op_00017.dat.</div>
<div class="line">Iteration:     360  Time: 6.480E+04  Max CFL: 8.288E-01  Max Diff. No.: -1.000E+00  Norm: 6.9250E+02  Conservation loss: 2.8810E+14</div>
<div class="line">Writing solution file op_00018.dat.</div>
<div class="line">Iteration:     380  Time: 6.840E+04  Max CFL: 8.277E-01  Max Diff. No.: -1.000E+00  Norm: 6.7591E+02  Conservation loss: 3.0377E+14</div>
<div class="line">Writing solution file op_00019.dat.</div>
<div class="line">Iteration:     400  Time: 7.200E+04  Max CFL: 8.465E-01  Max Diff. No.: -1.000E+00  Norm: 6.5968E+02  Conservation loss: 3.1944E+14</div>
<div class="line">Writing solution file op_00020.dat.</div>
<div class="line">Iteration:     420  Time: 7.560E+04  Max CFL: 8.571E-01  Max Diff. No.: -1.000E+00  Norm: 6.3826E+02  Conservation loss: 3.3523E+14</div>
<div class="line">Writing solution file op_00021.dat.</div>
<div class="line">Iteration:     440  Time: 7.920E+04  Max CFL: 8.574E-01  Max Diff. No.: -1.000E+00  Norm: 6.2022E+02  Conservation loss: 3.5126E+14</div>
<div class="line">Writing solution file op_00022.dat.</div>
<div class="line">Iteration:     460  Time: 8.280E+04  Max CFL: 8.574E-01  Max Diff. No.: -1.000E+00  Norm: 6.7470E+02  Conservation loss: 3.6753E+14</div>
<div class="line">Writing solution file op_00023.dat.</div>
<div class="line">Iteration:     480  Time: 8.640E+04  Max CFL: 8.560E-01  Max Diff. No.: -1.000E+00  Norm: 7.0703E+02  Conservation loss: 3.8395E+14</div>
<div class="line">Writing solution file op_00024.dat.</div>
<div class="line">Iteration:     500  Time: 9.000E+04  Max CFL: 8.465E-01  Max Diff. No.: -1.000E+00  Norm: 7.3248E+02  Conservation loss: 4.0034E+14</div>
<div class="line">Writing solution file op_00025.dat.</div>
<div class="line">Iteration:     520  Time: 9.360E+04  Max CFL: 8.318E-01  Max Diff. No.: -1.000E+00  Norm: 7.6668E+02  Conservation loss: 4.1655E+14</div>
<div class="line">Writing solution file op_00026.dat.</div>
<div class="line">Iteration:     540  Time: 9.720E+04  Max CFL: 8.480E-01  Max Diff. No.: -1.000E+00  Norm: 7.9167E+02  Conservation loss: 4.3260E+14</div>
<div class="line">Writing solution file op_00027.dat.</div>
<div class="line">Iteration:     560  Time: 1.008E+05  Max CFL: 8.412E-01  Max Diff. No.: -1.000E+00  Norm: 7.8038E+02  Conservation loss: 4.4859E+14</div>
<div class="line">Writing solution file op_00028.dat.</div>
<div class="line">Iteration:     580  Time: 1.044E+05  Max CFL: 8.438E-01  Max Diff. No.: -1.000E+00  Norm: 7.5727E+02  Conservation loss: 4.6459E+14</div>
<div class="line">Writing solution file op_00029.dat.</div>
<div class="line">Iteration:     600  Time: 1.080E+05  Max CFL: 8.545E-01  Max Diff. No.: -1.000E+00  Norm: 7.2991E+02  Conservation loss: 4.8061E+14</div>
<div class="line">Writing solution file op_00030.dat.</div>
<div class="line">Iteration:     620  Time: 1.116E+05  Max CFL: 8.559E-01  Max Diff. No.: -1.000E+00  Norm: 8.1845E+02  Conservation loss: 4.9669E+14</div>
<div class="line">Writing solution file op_00031.dat.</div>
<div class="line">Iteration:     640  Time: 1.152E+05  Max CFL: 8.547E-01  Max Diff. No.: -1.000E+00  Norm: 8.9818E+02  Conservation loss: 5.1283E+14</div>
<div class="line">Writing solution file op_00032.dat.</div>
<div class="line">Iteration:     660  Time: 1.188E+05  Max CFL: 8.472E-01  Max Diff. No.: -1.000E+00  Norm: 9.2536E+02  Conservation loss: 5.2900E+14</div>
<div class="line">Writing solution file op_00033.dat.</div>
<div class="line">Iteration:     680  Time: 1.224E+05  Max CFL: 8.337E-01  Max Diff. No.: -1.000E+00  Norm: 9.3209E+02  Conservation loss: 5.4510E+14</div>
<div class="line">Writing solution file op_00034.dat.</div>
<div class="line">Iteration:     700  Time: 1.260E+05  Max CFL: 8.180E-01  Max Diff. No.: -1.000E+00  Norm: 9.3946E+02  Conservation loss: 5.6103E+14</div>
<div class="line">Writing solution file op_00035.dat.</div>
<div class="line">Iteration:     720  Time: 1.296E+05  Max CFL: 8.961E-01  Max Diff. No.: -1.000E+00  Norm: 9.5910E+02  Conservation loss: 5.7679E+14</div>
<div class="line">Writing solution file op_00036.dat.</div>
<div class="line">Iteration:     740  Time: 1.332E+05  Max CFL: 9.198E-01  Max Diff. No.: -1.000E+00  Norm: 9.1544E+02  Conservation loss: 5.9244E+14</div>
<div class="line">Writing solution file op_00037.dat.</div>
<div class="line">Iteration:     760  Time: 1.368E+05  Max CFL: 9.233E-01  Max Diff. No.: -1.000E+00  Norm: 9.2664E+02  Conservation loss: 6.0814E+14</div>
<div class="line">Writing solution file op_00038.dat.</div>
<div class="line">Iteration:     780  Time: 1.404E+05  Max CFL: 9.109E-01  Max Diff. No.: -1.000E+00  Norm: 8.1109E+02  Conservation loss: 6.2407E+14</div>
<div class="line">Writing solution file op_00039.dat.</div>
<div class="line">Iteration:     800  Time: 1.440E+05  Max CFL: 9.114E-01  Max Diff. No.: -1.000E+00  Norm: 8.7863E+02  Conservation loss: 6.4024E+14</div>
<div class="line">Writing solution file op_00040.dat.</div>
<div class="line">Iteration:     820  Time: 1.476E+05  Max CFL: 9.080E-01  Max Diff. No.: -1.000E+00  Norm: 9.1852E+02  Conservation loss: 6.5657E+14</div>
<div class="line">Writing solution file op_00041.dat.</div>
<div class="line">Iteration:     840  Time: 1.512E+05  Max CFL: 8.830E-01  Max Diff. No.: -1.000E+00  Norm: 9.3299E+02  Conservation loss: 6.7294E+14</div>
<div class="line">Writing solution file op_00042.dat.</div>
<div class="line">Iteration:     860  Time: 1.548E+05  Max CFL: 8.670E-01  Max Diff. No.: -1.000E+00  Norm: 9.7294E+02  Conservation loss: 6.8921E+14</div>
<div class="line">Writing solution file op_00043.dat.</div>
<div class="line">Iteration:     880  Time: 1.584E+05  Max CFL: 8.543E-01  Max Diff. No.: -1.000E+00  Norm: 1.0055E+03  Conservation loss: 7.0535E+14</div>
<div class="line">Writing solution file op_00044.dat.</div>
<div class="line">Iteration:     900  Time: 1.620E+05  Max CFL: 9.014E-01  Max Diff. No.: -1.000E+00  Norm: 9.9412E+02  Conservation loss: 7.2134E+14</div>
<div class="line">Writing solution file op_00045.dat.</div>
<div class="line">Iteration:     920  Time: 1.656E+05  Max CFL: 9.026E-01  Max Diff. No.: -1.000E+00  Norm: 9.9431E+02  Conservation loss: 7.3723E+14</div>
<div class="line">Writing solution file op_00046.dat.</div>
<div class="line">Iteration:     940  Time: 1.692E+05  Max CFL: 8.907E-01  Max Diff. No.: -1.000E+00  Norm: 9.8222E+02  Conservation loss: 7.5317E+14</div>
<div class="line">Writing solution file op_00047.dat.</div>
<div class="line">Iteration:     960  Time: 1.728E+05  Max CFL: 8.859E-01  Max Diff. No.: -1.000E+00  Norm: 8.9608E+02  Conservation loss: 7.6921E+14</div>
<div class="line">Writing solution file op_00048.dat.</div>
<div class="line">Iteration:     980  Time: 1.764E+05  Max CFL: 8.831E-01  Max Diff. No.: -1.000E+00  Norm: 9.9049E+02  Conservation loss: 7.8532E+14</div>
<div class="line">Writing solution file op_00049.dat.</div>
<div class="line">Iteration:    1000  Time: 1.800E+05  Max CFL: 8.782E-01  Max Diff. No.: -1.000E+00  Norm: 1.0100E+03  Conservation loss: 8.0144E+14</div>
<div class="line">Writing solution file op_00050.dat.</div>
<div class="line">Iteration:    1020  Time: 1.836E+05  Max CFL: 8.531E-01  Max Diff. No.: -1.000E+00  Norm: 1.0175E+03  Conservation loss: 8.1747E+14</div>
<div class="line">Writing solution file op_00051.dat.</div>
<div class="line">Iteration:    1040  Time: 1.872E+05  Max CFL: 8.405E-01  Max Diff. No.: -1.000E+00  Norm: 1.0173E+03  Conservation loss: 8.3339E+14</div>
<div class="line">Writing solution file op_00052.dat.</div>
<div class="line">Iteration:    1060  Time: 1.908E+05  Max CFL: 8.370E-01  Max Diff. No.: -1.000E+00  Norm: 1.0216E+03  Conservation loss: 8.4918E+14</div>
<div class="line">Writing solution file op_00053.dat.</div>
<div class="line">Iteration:    1080  Time: 1.944E+05  Max CFL: 8.579E-01  Max Diff. No.: -1.000E+00  Norm: 9.9908E+02  Conservation loss: 8.6485E+14</div>
<div class="line">Writing solution file op_00054.dat.</div>
<div class="line">Iteration:    1100  Time: 1.980E+05  Max CFL: 8.750E-01  Max Diff. No.: -1.000E+00  Norm: 9.6644E+02  Conservation loss: 8.8047E+14</div>
<div class="line">Writing solution file op_00055.dat.</div>
<div class="line">Iteration:    1120  Time: 2.016E+05  Max CFL: 8.804E-01  Max Diff. No.: -1.000E+00  Norm: 9.6455E+02  Conservation loss: 8.9625E+14</div>
<div class="line">Writing solution file op_00056.dat.</div>
<div class="line">Iteration:    1140  Time: 2.052E+05  Max CFL: 8.750E-01  Max Diff. No.: -1.000E+00  Norm: 9.8838E+02  Conservation loss: 9.1226E+14</div>
<div class="line">Writing solution file op_00057.dat.</div>
<div class="line">Iteration:    1160  Time: 2.088E+05  Max CFL: 8.623E-01  Max Diff. No.: -1.000E+00  Norm: 9.4180E+02  Conservation loss: 9.2850E+14</div>
<div class="line">Writing solution file op_00058.dat.</div>
<div class="line">Iteration:    1180  Time: 2.124E+05  Max CFL: 8.385E-01  Max Diff. No.: -1.000E+00  Norm: 9.5401E+02  Conservation loss: 9.4480E+14</div>
<div class="line">Writing solution file op_00059.dat.</div>
<div class="line">Iteration:    1200  Time: 2.160E+05  Max CFL: 8.109E-01  Max Diff. No.: -1.000E+00  Norm: 9.2255E+02  Conservation loss: 9.6099E+14</div>
<div class="line">Writing solution file op_00060.dat.</div>
<div class="line">Iteration:    1220  Time: 2.196E+05  Max CFL: 8.013E-01  Max Diff. No.: -1.000E+00  Norm: 9.4781E+02  Conservation loss: 9.7707E+14</div>
<div class="line">Writing solution file op_00061.dat.</div>
<div class="line">Iteration:    1240  Time: 2.232E+05  Max CFL: 8.562E-01  Max Diff. No.: -1.000E+00  Norm: 9.7646E+02  Conservation loss: 9.9307E+14</div>
<div class="line">Writing solution file op_00062.dat.</div>
<div class="line">Iteration:    1260  Time: 2.268E+05  Max CFL: 8.798E-01  Max Diff. No.: -1.000E+00  Norm: 9.3879E+02  Conservation loss: 1.0090E+15</div>
<div class="line">Writing solution file op_00063.dat.</div>
<div class="line">Iteration:    1280  Time: 2.304E+05  Max CFL: 8.796E-01  Max Diff. No.: -1.000E+00  Norm: 9.0876E+02  Conservation loss: 1.0248E+15</div>
<div class="line">Writing solution file op_00064.dat.</div>
<div class="line">Iteration:    1300  Time: 2.340E+05  Max CFL: 8.863E-01  Max Diff. No.: -1.000E+00  Norm: 8.5053E+02  Conservation loss: 1.0407E+15</div>
<div class="line">Writing solution file op_00065.dat.</div>
<div class="line">Iteration:    1320  Time: 2.376E+05  Max CFL: 8.834E-01  Max Diff. No.: -1.000E+00  Norm: 9.3103E+02  Conservation loss: 1.0567E+15</div>
<div class="line">Writing solution file op_00066.dat.</div>
<div class="line">Iteration:    1340  Time: 2.412E+05  Max CFL: 8.660E-01  Max Diff. No.: -1.000E+00  Norm: 9.3307E+02  Conservation loss: 1.0728E+15</div>
<div class="line">Writing solution file op_00067.dat.</div>
<div class="line">Iteration:    1360  Time: 2.448E+05  Max CFL: 8.314E-01  Max Diff. No.: -1.000E+00  Norm: 9.6442E+02  Conservation loss: 1.0889E+15</div>
<div class="line">Writing solution file op_00068.dat.</div>
<div class="line">Iteration:    1380  Time: 2.484E+05  Max CFL: 8.170E-01  Max Diff. No.: -1.000E+00  Norm: 9.4764E+02  Conservation loss: 1.1048E+15</div>
<div class="line">Writing solution file op_00069.dat.</div>
<div class="line">Iteration:    1400  Time: 2.520E+05  Max CFL: 8.060E-01  Max Diff. No.: -1.000E+00  Norm: 9.6308E+02  Conservation loss: 1.1207E+15</div>
<div class="line">Writing solution file op_00070.dat.</div>
<div class="line">Iteration:    1420  Time: 2.556E+05  Max CFL: 8.301E-01  Max Diff. No.: -1.000E+00  Norm: 9.3390E+02  Conservation loss: 1.1364E+15</div>
<div class="line">Writing solution file op_00071.dat.</div>
<div class="line">Iteration:    1440  Time: 2.592E+05  Max CFL: 8.514E-01  Max Diff. No.: -1.000E+00  Norm: 9.1990E+02  Conservation loss: 1.1520E+15</div>
<div class="line">Writing solution file op_00072.dat.</div>
<div class="line">Iteration:    1460  Time: 2.628E+05  Max CFL: 8.420E-01  Max Diff. No.: -1.000E+00  Norm: 9.0714E+02  Conservation loss: 1.1677E+15</div>
<div class="line">Writing solution file op_00073.dat.</div>
<div class="line">Iteration:    1480  Time: 2.664E+05  Max CFL: 8.506E-01  Max Diff. No.: -1.000E+00  Norm: 8.1822E+02  Conservation loss: 1.1836E+15</div>
<div class="line">Writing solution file op_00074.dat.</div>
<div class="line">Iteration:    1500  Time: 2.700E+05  Max CFL: 8.397E-01  Max Diff. No.: -1.000E+00  Norm: 8.9556E+02  Conservation loss: 1.1997E+15</div>
<div class="line">Writing solution file op_00075.dat.</div>
<div class="line">Iteration:    1520  Time: 2.736E+05  Max CFL: 8.379E-01  Max Diff. No.: -1.000E+00  Norm: 8.9757E+02  Conservation loss: 1.2159E+15</div>
<div class="line">Writing solution file op_00076.dat.</div>
<div class="line">Iteration:    1540  Time: 2.772E+05  Max CFL: 8.407E-01  Max Diff. No.: -1.000E+00  Norm: 8.8750E+02  Conservation loss: 1.2321E+15</div>
<div class="line">Writing solution file op_00077.dat.</div>
<div class="line">Iteration:    1560  Time: 2.808E+05  Max CFL: 8.313E-01  Max Diff. No.: -1.000E+00  Norm: 8.8765E+02  Conservation loss: 1.2483E+15</div>
<div class="line">Writing solution file op_00078.dat.</div>
<div class="line">Iteration:    1580  Time: 2.844E+05  Max CFL: 8.238E-01  Max Diff. No.: -1.000E+00  Norm: 8.9689E+02  Conservation loss: 1.2642E+15</div>
<div class="line">Writing solution file op_00079.dat.</div>
<div class="line">Iteration:    1600  Time: 2.880E+05  Max CFL: 8.199E-01  Max Diff. No.: -1.000E+00  Norm: 9.0169E+02  Conservation loss: 1.2801E+15</div>
<div class="line">Writing solution file op_00080.dat.</div>
<div class="line">Iteration:    1620  Time: 2.916E+05  Max CFL: 8.320E-01  Max Diff. No.: -1.000E+00  Norm: 9.0500E+02  Conservation loss: 1.2960E+15</div>
<div class="line">Writing solution file op_00081.dat.</div>
<div class="line">Iteration:    1640  Time: 2.952E+05  Max CFL: 8.350E-01  Max Diff. No.: -1.000E+00  Norm: 9.0170E+02  Conservation loss: 1.3119E+15</div>
<div class="line">Writing solution file op_00082.dat.</div>
<div class="line">Iteration:    1660  Time: 2.988E+05  Max CFL: 8.239E-01  Max Diff. No.: -1.000E+00  Norm: 9.0937E+02  Conservation loss: 1.3279E+15</div>
<div class="line">Writing solution file op_00083.dat.</div>
<div class="line">Iteration:    1680  Time: 3.024E+05  Max CFL: 8.194E-01  Max Diff. No.: -1.000E+00  Norm: 8.8423E+02  Conservation loss: 1.3439E+15</div>
<div class="line">Writing solution file op_00084.dat.</div>
<div class="line">Iteration:    1700  Time: 3.060E+05  Max CFL: 8.006E-01  Max Diff. No.: -1.000E+00  Norm: 8.7109E+02  Conservation loss: 1.3599E+15</div>
<div class="line">Writing solution file op_00085.dat.</div>
<div class="line">Iteration:    1720  Time: 3.096E+05  Max CFL: 7.987E-01  Max Diff. No.: -1.000E+00  Norm: 8.6286E+02  Conservation loss: 1.3759E+15</div>
<div class="line">Writing solution file op_00086.dat.</div>
<div class="line">Iteration:    1740  Time: 3.132E+05  Max CFL: 7.940E-01  Max Diff. No.: -1.000E+00  Norm: 8.6409E+02  Conservation loss: 1.3918E+15</div>
<div class="line">Writing solution file op_00087.dat.</div>
<div class="line">Iteration:    1760  Time: 3.168E+05  Max CFL: 7.944E-01  Max Diff. No.: -1.000E+00  Norm: 8.6235E+02  Conservation loss: 1.4075E+15</div>
<div class="line">Writing solution file op_00088.dat.</div>
<div class="line">Iteration:    1780  Time: 3.204E+05  Max CFL: 8.094E-01  Max Diff. No.: -1.000E+00  Norm: 8.5935E+02  Conservation loss: 1.4232E+15</div>
<div class="line">Writing solution file op_00089.dat.</div>
<div class="line">Iteration:    1800  Time: 3.240E+05  Max CFL: 8.275E-01  Max Diff. No.: -1.000E+00  Norm: 8.5785E+02  Conservation loss: 1.4389E+15</div>
<div class="line">Writing solution file op_00090.dat.</div>
<div class="line">Iteration:    1820  Time: 3.276E+05  Max CFL: 8.406E-01  Max Diff. No.: -1.000E+00  Norm: 7.7429E+02  Conservation loss: 1.4547E+15</div>
<div class="line">Writing solution file op_00091.dat.</div>
<div class="line">Iteration:    1840  Time: 3.312E+05  Max CFL: 8.289E-01  Max Diff. No.: -1.000E+00  Norm: 8.6605E+02  Conservation loss: 1.4706E+15</div>
<div class="line">Writing solution file op_00092.dat.</div>
<div class="line">Iteration:    1860  Time: 3.348E+05  Max CFL: 8.122E-01  Max Diff. No.: -1.000E+00  Norm: 8.4107E+02  Conservation loss: 1.4868E+15</div>
<div class="line">Writing solution file op_00093.dat.</div>
<div class="line">Iteration:    1880  Time: 3.384E+05  Max CFL: 7.908E-01  Max Diff. No.: -1.000E+00  Norm: 8.2938E+02  Conservation loss: 1.5029E+15</div>
<div class="line">Writing solution file op_00094.dat.</div>
<div class="line">Iteration:    1900  Time: 3.420E+05  Max CFL: 7.941E-01  Max Diff. No.: -1.000E+00  Norm: 8.1713E+02  Conservation loss: 1.5190E+15</div>
<div class="line">Writing solution file op_00095.dat.</div>
<div class="line">Iteration:    1920  Time: 3.456E+05  Max CFL: 7.927E-01  Max Diff. No.: -1.000E+00  Norm: 8.0634E+02  Conservation loss: 1.5350E+15</div>
<div class="line">Writing solution file op_00096.dat.</div>
<div class="line">Iteration:    1940  Time: 3.492E+05  Max CFL: 7.919E-01  Max Diff. No.: -1.000E+00  Norm: 7.9486E+02  Conservation loss: 1.5510E+15</div>
<div class="line">Writing solution file op_00097.dat.</div>
<div class="line">Iteration:    1960  Time: 3.528E+05  Max CFL: 7.989E-01  Max Diff. No.: -1.000E+00  Norm: 7.9769E+02  Conservation loss: 1.5669E+15</div>
<div class="line">Writing solution file op_00098.dat.</div>
<div class="line">Iteration:    1980  Time: 3.564E+05  Max CFL: 8.166E-01  Max Diff. No.: -1.000E+00  Norm: 8.0189E+02  Conservation loss: 1.5827E+15</div>
<div class="line">Writing solution file op_00099.dat.</div>
<div class="line">Iteration:    2000  Time: 3.600E+05  Max CFL: 8.043E-01  Max Diff. No.: -1.000E+00  Norm: 7.2451E+02  Conservation loss: 1.5985E+15</div>
<div class="line">Writing solution file op_00100.dat.</div>
<div class="line">Completed time integration (Final time: 360000.000000).</div>
<div class="line">Computed errors:</div>
<div class="line">  L1         Error           : 0.0000000000000000E+00</div>
<div class="line">  L2         Error           : 0.0000000000000000E+00</div>
<div class="line">  Linfinity  Error           : 0.0000000000000000E+00</div>
<div class="line">Conservation Errors:</div>
<div class="line">    3.0050505050505077E-16</div>
<div class="line">    5.4521365427062857E-04</div>
<div class="line">    1.5985329391656518E+15</div>
<div class="line">Solver runtime (in seconds): 3.8254883100000001E+02</div>
<div class="line">Total  runtime (in seconds): 3.8260785800000002E+02</div>
<div class="line">Deallocating arrays.</div>
<div class="line">Finished.</div>
</div><!-- fragment --> </div></div><!-- contents -->
</div><!-- doc-content -->
<!-- Start of StatCounter Code for Default Guide -->
<script type="text/javascript">
var sc_project=10897352; 
var sc_invisible=1; 
var sc_security="83042f57"; 
var scJsHost = (("https:" == document.location.protocol) ?
"https://secure." : "http://www.");
document.write("<sc"+"ript type='text/javascript' src='" +
scJsHost+
"statcounter.com/counter/counter.js'></"+"script>");
</script>
<noscript><div class="statcounter"><a title="website
statistics" href="http://statcounter.com/"
target="_blank"><img class="statcounter"
src="//c.statcounter.com/10897352/0/83042f57/1/"
alt="website statistics"></a></div></noscript>
<!-- End of StatCounter Code for Default Guide -->
