<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.5"/>
<title>HyPar: 3D Navier-Stokes Equations - Rising Thermal Bubble</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script><script src="http://cdn.mathjax.org/mathjax/latest/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="doxygen_html_style.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">HyPar
   &#160;<span id="projectnumber">1.0</span>
   </div>
   <div id="projectbrief">Finite-Difference Hyperbolic-Parabolic PDE Solver on Cartesian Grids</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.5 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li class="current"><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Structures</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('a00062.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Data Structures</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Namespaces</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Macros</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Pages</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">3D Navier-Stokes Equations - Rising Thermal Bubble </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>Location: <b>hypar/Examples/3D/NavierStokes3D/RisingThermalBubble_Config1</b> (This directory contains all the input files needed to run this case. If there is a <em>Run.m</em>, run it in MATLAB to quickly set up, run, and visualize the example).</p>
<p>Governing equations: 3D Navier-Stokes Equations (<a class="el" href="a00202.html" title="3D Navier Stokes equations (compressible flows) ">navierstokes3d.h</a>)</p>
<p>Domain: \(0 \le x,y,z &lt; 1000\,{\rm m}\), <em>"slip-wall"</em> (<a class="el" href="a00221.html#af3a9f3ba15bc914ed0a88295aee147e8">_SLIP_WALL_</a>) boundaries everywhere, with zero wall velocity.</p>
<p>Reference:</p>
<ul>
<li>Kelly, J. F., Giraldo, F. X., "Continuous and discontinuous Galerkin methods for a scalable
  three-dimensional nonhydrostatic atmospheric model: Limited-area mode", J. Comput. Phys., 231, 2012, pp. 7988-8008 (see section 5.1.2).</li>
<li>Giraldo, F. X., Kelly, J. F., Constantinescu, E. M., "Implicit-Explicit Formulations of a
  Three-Dimensional Nonhydrostatic Unified Model of the Atmosphere (NUMA)", SIAM J. Sci. Comput., 35 (5), 2013, pp. B1162-B1194 (see section 4.1).</li>
</ul>
<p>Initial solution: A warm bubble in cool ambient atmosphere. Note that in this example, the gravitational forces and rising of the bubble is along the <em>y-axis</em>.</p>
<p>Other parameters (all dimensional quantities are in SI units):</p>
<ul>
<li>Specific heat ratio \(\gamma = 1.4\) (<a class="el" href="a00202.html#a72f9e01745b3a8203067ab84aefc9aea">NavierStokes3D::gamma</a>)</li>
<li>Universal gas constant \(R = 287.058\) (<a class="el" href="a00202.html#a228eb5e837a644887ac6e7bab3f42485">NavierStokes3D::R</a>)</li>
<li>Gravitational force per unit mass \(g = 9.8\) along <em>y-axis</em> (<a class="el" href="a00202.html#adf08e308b453bd2d4e117576e493ed03">NavierStokes3D::grav_y</a>)</li>
<li>Reference density (at zero altitude) \(\rho_{ref} = 1.1612055171196529\) (<a class="el" href="a00202.html#a1e6f66261d19a1c1c272e8808bd2657b">NavierStokes3D::rho0</a>)</li>
<li>Reference pressure (at zero altitude) \(P_{ref} = 100000\) (<a class="el" href="a00202.html#a8be9de5ac626cddcd15c5ec181619694">NavierStokes3D::p0</a>)</li>
<li>Hydrostatic balance type 2 (<a class="el" href="a00202.html#a2e01ef077b0fedaea9e286ccdf2fe259">NavierStokes3D::HB</a>)</li>
</ul>
<p>Numerical Method:</p>
<ul>
<li>Spatial discretization (hyperbolic): 5th order WENO (<a class="el" href="a00185.html#af2195885ad055989a1b2b11655843343" title="5th order WENO reconstruction (component-wise) on a uniform grid ">Interp1PrimFifthOrderWENO()</a>)</li>
<li>Time integration: SSP RK3 (<a class="el" href="a00252.html#aca6ebec6e6998f0c509bb38fa91f3321">TimeRK()</a>, <a class="el" href="a00191.html#a97e67bb275d6a2dad40b184579559f82">_RK_SSP3_</a>)</li>
</ul>
<h2>Input files required: </h2>
<p><b>solver.inp</b> </p>
<div class="fragment"><div class="line">begin</div>
<div class="line">  ndims               3</div>
<div class="line">  nvars               5</div>
<div class="line">  size                201 201 201</div>
<div class="line">  iproc               4 4 4</div>
<div class="line">  ghost               3</div>
<div class="line">  n_iter              20000</div>
<div class="line">  restart_iter        0</div>
<div class="line">  time_scheme         rk</div>
<div class="line">  time_scheme_type    ssprk3</div>
<div class="line">  hyp_space_scheme    weno5</div>
<div class="line">  hyp_flux_split      no</div>
<div class="line">  hyp_interp_type     components</div>
<div class="line">  dt                  0.01</div>
<div class="line">  conservation_check  no</div>
<div class="line">  screen_op_iter      200</div>
<div class="line">  file_op_iter        2000</div>
<div class="line">  input_mode          serial</div>
<div class="line">  ip_file_type        binary</div>
<div class="line">  output_mode         serial</div>
<div class="line">  op_file_format      binary</div>
<div class="line">  op_overwrite        no</div>
<div class="line">  model               navierstokes3d</div>
<div class="line">end</div>
</div><!-- fragment --><p><b>boundary.inp</b> </p>
<div class="fragment"><div class="line">6</div>
<div class="line">slip-wall   0     1     0        0      0   1000.0          0   1000.0</div>
<div class="line">0.0 0.0 0.0</div>
<div class="line">slip-wall   0    -1     0        0      0   1000.0          0   1000.0</div>
<div class="line">0.0 0.0 0.0</div>
<div class="line">slip-wall   1     1     0   1000.0      0        0          0   1000.0</div>
<div class="line">0.0 0.0 0.0</div>
<div class="line">slip-wall   1    -1     0   1000.0      0        0          0   1000.0</div>
<div class="line">0.0 0.0 0.0</div>
<div class="line">slip-wall   2     1     0   1000.0      0   1000.0          0        0</div>
<div class="line">0.0 0.0 0.0</div>
<div class="line">slip-wall   2    -1     0   1000.0      0   1000.0          0        0</div>
<div class="line">0.0 0.0 0.0</div>
</div><!-- fragment --><p><b>physics.inp</b> </p>
<div class="fragment"><div class="line">begin</div>
<div class="line">  gamma     1.4</div>
<div class="line">  upwinding rusanov</div>
<div class="line">  gravity   0.0 9.8 0.0</div>
<div class="line">  rho_ref   1.1612055171196529</div>
<div class="line">  p_ref     100000.0</div>
<div class="line">  R         287.058</div>
<div class="line">  HB        2</div>
<div class="line">end</div>
</div><!-- fragment --><p><b>weno.inp</b> (optional) </p>
<div class="fragment"><div class="line">begin</div>
<div class="line">  mapped        0</div>
<div class="line">  borges        0</div>
<div class="line">  yc            1</div>
<div class="line">  no_limiting   0</div>
<div class="line">  epsilon       0.000001</div>
<div class="line">  p             2.0</div>
<div class="line">  rc            0.3</div>
<div class="line">  xi            0.001</div>
<div class="line">end</div>
</div><!-- fragment --><p>To generate <b>initial.inp</b> (initial solution), compile and run the following code in the run directory. </p>
<div class="fragment"><div class="line"><span class="comment">/*</span></div>
<div class="line"><span class="comment">  This code generates the initial solution for the rising </span></div>
<div class="line"><span class="comment">  thermal bubble case for the 3D Navier-Stokes equations.</span></div>
<div class="line"><span class="comment"></span></div>
<div class="line"><span class="comment">  Note: this code allocates the global domain, so be careful</span></div>
<div class="line"><span class="comment">  when using it for a large number of grid points.</span></div>
<div class="line"><span class="comment">*/</span></div>
<div class="line"></div>
<div class="line"><span class="preprocessor">#include &lt;stdio.h&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;stdlib.h&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;math.h&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;string.h&gt;</span></div>
<div class="line"></div>
<div class="line"><span class="keywordtype">double</span> <a class="code" href="a00231.html#a840eef18a5986381093ff8c176a2153c">raiseto</a>(<span class="keywordtype">double</span> x, <span class="keywordtype">double</span> a)</div>
<div class="line">{</div>
<div class="line">  <span class="keywordflow">return</span>(exp(a*log(x)));</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"><span class="keywordtype">int</span> <a class="code" href="a00353.html#a3c04138a5bfe5d72780bb7e82a18e627">main</a>()</div>
<div class="line">{</div>
<div class="line">  <span class="keywordtype">double</span> gamma    = 1.4;</div>
<div class="line">  <span class="keywordtype">double</span> R        = 287.058;</div>
<div class="line">  <span class="keywordtype">double</span> rho_ref  = 1.1612055171196529;</div>
<div class="line">  <span class="keywordtype">double</span> p_ref    = 100000.0;</div>
<div class="line">  <span class="keywordtype">double</span> grav_x   = 0.0;</div>
<div class="line">  <span class="keywordtype">double</span> grav_y   = 9.8;</div>
<div class="line">  <span class="keywordtype">double</span> grav_z   = 0.0;</div>
<div class="line">  <span class="keywordtype">int</span>    HB       = 0;</div>
<div class="line">  </div>
<div class="line">    <span class="keywordtype">int</span>   NI,NJ,NK,ndims;</div>
<div class="line">  <span class="keywordtype">char</span>  ip_file_type[50]; strcpy(ip_file_type,<span class="stringliteral">&quot;ascii&quot;</span>);</div>
<div class="line">  FILE *in;</div>
<div class="line"></div>
<div class="line">  printf(<span class="stringliteral">&quot;Reading file \&quot;solver.inp\&quot;...\n&quot;</span>);</div>
<div class="line">  in = fopen(<span class="stringliteral">&quot;solver.inp&quot;</span>,<span class="stringliteral">&quot;r&quot;</span>);</div>
<div class="line">  <span class="keywordflow">if</span> (!in) {</div>
<div class="line">    printf(<span class="stringliteral">&quot;Error: Input file \&quot;solver.inp\&quot; not found.\n&quot;</span>);</div>
<div class="line">    <span class="keywordflow">return</span>(0);</div>
<div class="line">  } <span class="keywordflow">else</span> {</div>
<div class="line">    <span class="keywordtype">char</span> word[500];</div>
<div class="line">    fscanf(in,<span class="stringliteral">&quot;%s&quot;</span>,word);</div>
<div class="line">    <span class="keywordflow">if</span> (!strcmp(word, <span class="stringliteral">&quot;begin&quot;</span>)) {</div>
<div class="line">      <span class="keywordflow">while</span> (strcmp(word, <span class="stringliteral">&quot;end&quot;</span>)) {</div>
<div class="line">        fscanf(in,<span class="stringliteral">&quot;%s&quot;</span>,word);</div>
<div class="line">        <span class="keywordflow">if</span> (!strcmp(word, <span class="stringliteral">&quot;ndims&quot;</span>)) fscanf(in,<span class="stringliteral">&quot;%d&quot;</span>,&amp;ndims);</div>
<div class="line">        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcmp(word, <span class="stringliteral">&quot;size&quot;</span>)) {</div>
<div class="line">          fscanf(in,<span class="stringliteral">&quot;%d&quot;</span>,&amp;NI);</div>
<div class="line">          fscanf(in,<span class="stringliteral">&quot;%d&quot;</span>,&amp;NJ);</div>
<div class="line">          fscanf(in,<span class="stringliteral">&quot;%d&quot;</span>,&amp;NK);</div>
<div class="line">        } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcmp(word, <span class="stringliteral">&quot;ip_file_type&quot;</span>)) fscanf(in,<span class="stringliteral">&quot;%s&quot;</span>,ip_file_type);</div>
<div class="line">      }</div>
<div class="line">    } <span class="keywordflow">else</span> printf(<span class="stringliteral">&quot;Error: Illegal format in solver.inp. Crash and burn!\n&quot;</span>);</div>
<div class="line">  }</div>
<div class="line">  fclose(in);</div>
<div class="line"></div>
<div class="line">  printf(<span class="stringliteral">&quot;Reading file \&quot;physics.inp\&quot;...\n&quot;</span>);</div>
<div class="line">  in = fopen(<span class="stringliteral">&quot;physics.inp&quot;</span>,<span class="stringliteral">&quot;r&quot;</span>);</div>
<div class="line">  <span class="keywordflow">if</span> (!in) {</div>
<div class="line">    printf(<span class="stringliteral">&quot;Error: Input file \&quot;physics.inp\&quot; not found.\n&quot;</span>);</div>
<div class="line">    <span class="keywordflow">return</span>(0);</div>
<div class="line">  } <span class="keywordflow">else</span> {</div>
<div class="line">    <span class="keywordtype">char</span> word[500];</div>
<div class="line">    fscanf(in,<span class="stringliteral">&quot;%s&quot;</span>,word);</div>
<div class="line">    <span class="keywordflow">if</span> (!strcmp(word, <span class="stringliteral">&quot;begin&quot;</span>)) {</div>
<div class="line">      <span class="keywordflow">while</span> (strcmp(word, <span class="stringliteral">&quot;end&quot;</span>)) {</div>
<div class="line">        fscanf(in,<span class="stringliteral">&quot;%s&quot;</span>,word);</div>
<div class="line">        <span class="keywordflow">if</span>      (!strcmp(word, <span class="stringliteral">&quot;rho_ref&quot;</span>)) fscanf(in,<span class="stringliteral">&quot;%lf&quot;</span>,&amp;rho_ref);</div>
<div class="line">        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcmp(word, <span class="stringliteral">&quot;p_ref&quot;</span>  )) fscanf(in,<span class="stringliteral">&quot;%lf&quot;</span>,&amp;p_ref  );</div>
<div class="line">        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcmp(word, <span class="stringliteral">&quot;gamma&quot;</span>  )) fscanf(in,<span class="stringliteral">&quot;%lf&quot;</span>,&amp;gamma  );</div>
<div class="line">        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcmp(word, <span class="stringliteral">&quot;R&quot;</span>      )) fscanf(in,<span class="stringliteral">&quot;%lf&quot;</span>,&amp;R      );</div>
<div class="line">        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcmp(word, <span class="stringliteral">&quot;HB&quot;</span>     )) fscanf(in,<span class="stringliteral">&quot;%d&quot;</span> ,&amp;HB     );</div>
<div class="line">        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcmp(word, <span class="stringliteral">&quot;gravity&quot;</span>)) {</div>
<div class="line">          fscanf(in,<span class="stringliteral">&quot;%lf&quot;</span>,&amp;grav_x );</div>
<div class="line">          fscanf(in,<span class="stringliteral">&quot;%lf&quot;</span>,&amp;grav_y );</div>
<div class="line">          fscanf(in,<span class="stringliteral">&quot;%lf&quot;</span>,&amp;grav_z );</div>
<div class="line">        }</div>
<div class="line">      }</div>
<div class="line">    } <span class="keywordflow">else</span> printf(<span class="stringliteral">&quot;Error: Illegal format in physics.inp. Crash and burn!\n&quot;</span>);</div>
<div class="line">  }</div>
<div class="line">  fclose(in);</div>
<div class="line"></div>
<div class="line">  <span class="keywordflow">if</span> (ndims != 3) {</div>
<div class="line">    printf(<span class="stringliteral">&quot;ndims is not 3 in solver.inp. this code is to generate 3D initial conditions\n&quot;</span>);</div>
<div class="line">    <span class="keywordflow">return</span>(0);</div>
<div class="line">  }</div>
<div class="line">  <span class="keywordflow">if</span> (HB != 2) {</div>
<div class="line">    printf(<span class="stringliteral">&quot;Error: Specify \&quot;HB\&quot; as 2 in physics.inp.\n&quot;</span>);</div>
<div class="line">  }</div>
<div class="line">  <span class="keywordflow">if</span> ((grav_x != 0.0) || (grav_z != 0.0)) {</div>
<div class="line">    printf(<span class="stringliteral">&quot;Error: gravity must be zero along x and z for this example.\n&quot;</span>);</div>
<div class="line">    <span class="keywordflow">return</span>(0);</div>
<div class="line">  }</div>
<div class="line">    printf(<span class="stringliteral">&quot;Grid:\t\t\t%d X %d X %d\n&quot;</span>,NI,NJ,NK);</div>
<div class="line">  printf(<span class="stringliteral">&quot;Reference density and pressure: %lf, %lf.\n&quot;</span>,rho_ref,p_ref);</div>
<div class="line"></div>
<div class="line">    <span class="keywordtype">int</span> i,j,k;</div>
<div class="line">    <span class="keywordtype">double</span> dx = 1000.0  / ((double)(NI-1));</div>
<div class="line">    <span class="keywordtype">double</span> dy = 1000.0  / ((double)(NJ-1));</div>
<div class="line">    <span class="keywordtype">double</span> dz = 1000.0  / ((double)(NK-1));</div>
<div class="line"></div>
<div class="line">    <span class="keywordtype">double</span> *x, *y, *z, *U;</div>
<div class="line">    x   = (<span class="keywordtype">double</span>*) calloc (NI        , <span class="keyword">sizeof</span>(<span class="keywordtype">double</span>));</div>
<div class="line">    y   = (<span class="keywordtype">double</span>*) calloc (NJ        , <span class="keyword">sizeof</span>(<span class="keywordtype">double</span>));</div>
<div class="line">    z   = (<span class="keywordtype">double</span>*) calloc (NK        , <span class="keyword">sizeof</span>(<span class="keywordtype">double</span>));</div>
<div class="line">    U   = (<span class="keywordtype">double</span>*) calloc (5*NI*NJ*NK, <span class="keyword">sizeof</span>(<span class="keywordtype">double</span>));</div>
<div class="line"></div>
<div class="line">  <span class="comment">/* Initial perturbation center */</span></div>
<div class="line">  <span class="keywordtype">double</span> xc = 500;</div>
<div class="line">  <span class="keywordtype">double</span> yc = 260;</div>
<div class="line">  <span class="keywordtype">double</span> zc = 500;</div>
<div class="line">  <span class="keywordtype">double</span> Cp = gamma * R / (gamma-1.0);</div>
<div class="line"></div>
<div class="line">  <span class="comment">/* initial perturbation parameters */</span></div>
<div class="line">  <span class="keywordtype">double</span> pi = 4.0*atan(1.0);</div>
<div class="line">  <span class="keywordtype">double</span> rc = 250.0;</div>
<div class="line">  <span class="keywordtype">double</span> T_ref = p_ref / (R * rho_ref);</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">for</span> (i = 0; i &lt; NI; i++){</div>
<div class="line">    <span class="keywordflow">for</span> (j = 0; j &lt; NJ; j++){</div>
<div class="line">      <span class="keywordflow">for</span> (k = 0; k &lt; NK; k++){</div>
<div class="line">          x[i] = i*dx;</div>
<div class="line">          y[j] = j*dy;</div>
<div class="line">        z[k] = k*dz;</div>
<div class="line">        <span class="keywordtype">int</span> p = i + NI*j + NI*NJ*k;</div>
<div class="line"></div>
<div class="line">        <span class="comment">/* temperature peturbation */</span></div>
<div class="line">        <span class="keywordtype">double</span> r      = sqrt((x[i]-xc)*(x[i]-xc)+(y[j]-yc)*(y[j]-yc)+(z[k]-zc)*(z[k]-zc));</div>
<div class="line">        <span class="keywordtype">double</span> dtheta = (r&gt;rc ? 0.0 : (0.5*(1.0+cos(pi*r/rc))) );</div>
<div class="line">        <span class="keywordtype">double</span> theta  = T_ref + dtheta;</div>
<div class="line">        <span class="keywordtype">double</span> Pexner = 1.0 - (grav_y*y[j])/(Cp*T_ref);</div>
<div class="line"></div>
<div class="line">        <span class="keywordtype">double</span> rho    = (p_ref/(R*theta)) * <a class="code" href="a00231.html#a840eef18a5986381093ff8c176a2153c">raiseto</a>(Pexner, (1.0/(gamma-1.0)));</div>
<div class="line">        <span class="keywordtype">double</span> E      = rho * (R/(gamma-1.0)) * theta*Pexner;</div>
<div class="line"></div>
<div class="line">        U[5*p+0] = rho;</div>
<div class="line">        U[5*p+1] = 0.0;</div>
<div class="line">        U[5*p+2] = 0.0;</div>
<div class="line">        U[5*p+3] = 0.0;</div>
<div class="line">        U[5*p+4] = E;</div>
<div class="line">      }</div>
<div class="line">      }</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">  FILE *out;</div>
<div class="line">  <span class="keywordflow">if</span> (!strcmp(ip_file_type,<span class="stringliteral">&quot;ascii&quot;</span>)) {</div>
<div class="line"></div>
<div class="line">    printf(<span class="stringliteral">&quot;Error: sorry, ASCII format initial solution file not implemented. &quot;</span>);</div>
<div class="line">    printf(<span class="stringliteral">&quot;Please choose \&quot;ip_file_format\&quot; in solver.inp as \&quot;binary\&quot;.\n&quot;</span>);</div>
<div class="line">    <span class="keywordflow">return</span>(0);</div>
<div class="line"></div>
<div class="line">  } <span class="keywordflow">else</span> <span class="keywordflow">if</span> ((!strcmp(ip_file_type,<span class="stringliteral">&quot;binary&quot;</span>)) || (!strcmp(ip_file_type,<span class="stringliteral">&quot;bin&quot;</span>))) {</div>
<div class="line"></div>
<div class="line">    printf(<span class="stringliteral">&quot;Writing binary initial solution file initial.inp\n&quot;</span>);</div>
<div class="line">    out = fopen(<span class="stringliteral">&quot;initial.inp&quot;</span>,<span class="stringliteral">&quot;wb&quot;</span>);</div>
<div class="line">    fwrite(x,<span class="keyword">sizeof</span>(<span class="keywordtype">double</span>),NI,out);</div>
<div class="line">    fwrite(y,<span class="keyword">sizeof</span>(<span class="keywordtype">double</span>),NJ,out);</div>
<div class="line">    fwrite(z,<span class="keyword">sizeof</span>(<span class="keywordtype">double</span>),NK,out);</div>
<div class="line">    fwrite(U,<span class="keyword">sizeof</span>(<span class="keywordtype">double</span>),5*NI*NJ*NK,out);</div>
<div class="line">    fclose(out);</div>
<div class="line">  }</div>
<div class="line"></div>
<div class="line">    free(x);</div>
<div class="line">    free(y);</div>
<div class="line">    free(z);</div>
<div class="line">    free(U);</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">return</span>(0);</div>
<div class="line">}</div>
</div><!-- fragment --><h2>Output: </h2>
<p>Note that <b>iproc</b> is set to </p>
<pre class="fragment">  4 4 4
</pre><p>in <b>solver.inp</b> (i.e., 4 processors along <em>x</em>, 4 processors along <em>y</em>, and 4 processor along <em>z</em>). Thus, this example should be run with 64 MPI ranks (or change <b>iproc</b>).</p>
<p>After running the code, there should be 11 output files <b>op_00000.bin</b>, <b>op_00001.bin</b>, ... <b>op_00010.bin</b>; the first one is the solution at \(t=0\) and the final one is the solution at \(t=200\,{\rm s}\). Since <a class="el" href="a00196.html#a4e93cb107e180ef982b74cef7726b70f">HyPar::op_overwrite</a> is set to <em>no</em> in <b>solver.inp</b>, separate files are written for solutions at each output time. All the files are binary (<a class="el" href="a00196.html#a51a3b8c19b86e9e1df5be02b05a6613c">HyPar::op_file_format</a> is set to <em>binary</em> in <b>solver.inp</b>).</p>
<p>The following code (<b>Examples/3D/NavierStokes3D/RisingThermalBubble_Config1/aux/PostProcess.c</b>) can be used to convert the binary solution file (with conserved variables \(\rho,\rho u,\rho v,\rho w,e\)) to Tecplot or plain text files with the primitive and reference variables \(\rho,u,v,w,P,\theta,\rho_0,P_0,\pi,\theta_0\) where the subscript \(0\) indicates the hydrostatic mean value. </p>
<div class="fragment"><div class="line"><span class="comment">/*</span></div>
<div class="line"><span class="comment">  Rising Thermal Bubble:-</span></div>
<div class="line"><span class="comment">  The code takes a binary solution file (that contains the </span></div>
<div class="line"><span class="comment">  conserved variable (rho, rho*u, rho*v, rho*w, e) as its input </span></div>
<div class="line"><span class="comment">  and calculates the primitive atmospheric flow variables:</span></div>
<div class="line"><span class="comment">  rho, u, v, w, P, theta, pi, rho0, P0, theta0, pi0</span></div>
<div class="line"><span class="comment">  and writes them to a tecplot or text file.</span></div>
<div class="line"><span class="comment">*/</span></div>
<div class="line"></div>
<div class="line"><span class="preprocessor">#include &lt;stdio.h&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;stdlib.h&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;string.h&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;math.h&gt;</span></div>
<div class="line"></div>
<div class="line"><span class="keyword">typedef</span> <span class="keyword">struct </span>_parameters_{</div>
<div class="line">  <span class="keywordtype">double</span> grav_x, grav_y, grav_z, R, gamma, P_ref, rho_ref;</div>
<div class="line">  <span class="keywordtype">int</span> HB;</div>
<div class="line">} Parameters;</div>
<div class="line"></div>
<div class="line"><span class="preprocessor">#define _ArraySetValue_(x,size,value)                                                                               \</span></div>
<div class="line"><span class="preprocessor">  {                                                                                                                 \</span></div>
<div class="line"><span class="preprocessor">    int arraycounter;                                                                                               \</span></div>
<div class="line"><span class="preprocessor">    for (arraycounter = 0; arraycounter &lt; (size); arraycounter++)  x[arraycounter] = (value);                       \</span></div>
<div class="line"><span class="preprocessor">  }</span></div>
<div class="line"><span class="preprocessor"></span></div>
<div class="line"><span class="preprocessor">#define _ArrayIncrementIndex_(N,imax,i,done) \</span></div>
<div class="line"><span class="preprocessor">  { \</span></div>
<div class="line"><span class="preprocessor">    int arraycounter = 0; \</span></div>
<div class="line"><span class="preprocessor">    while (arraycounter &lt; (N)) { \</span></div>
<div class="line"><span class="preprocessor">      if (i[arraycounter] == imax[arraycounter]-1) { \</span></div>
<div class="line"><span class="preprocessor">        i[arraycounter] = 0; \</span></div>
<div class="line"><span class="preprocessor">        arraycounter++; \</span></div>
<div class="line"><span class="preprocessor">      } else { \</span></div>
<div class="line"><span class="preprocessor">        i[arraycounter]++; \</span></div>
<div class="line"><span class="preprocessor">        break; \</span></div>
<div class="line"><span class="preprocessor">      } \</span></div>
<div class="line"><span class="preprocessor">    } \</span></div>
<div class="line"><span class="preprocessor">    if (arraycounter == (N)) done = 1; \</span></div>
<div class="line"><span class="preprocessor">    else          done = 0; \</span></div>
<div class="line"><span class="preprocessor">  }</span></div>
<div class="line"><span class="preprocessor"></span></div>
<div class="line"><span class="preprocessor">#define _ArrayIndex1D_(N,imax,i,ghost,index)  \</span></div>
<div class="line"><span class="preprocessor">  { \</span></div>
<div class="line"><span class="preprocessor">    index = i[N-1]+(ghost); \</span></div>
<div class="line"><span class="preprocessor">    int arraycounter; \</span></div>
<div class="line"><span class="preprocessor">    for (arraycounter = (N)-2; arraycounter &gt; -1; arraycounter--) { \</span></div>
<div class="line"><span class="preprocessor">      index = ((index*(imax[arraycounter]+2*(ghost))) + (i[arraycounter]+(ghost))); \</span></div>
<div class="line"><span class="preprocessor">    } \</span></div>
<div class="line"><span class="preprocessor">  }</span></div>
<div class="line"><span class="preprocessor"></span></div>
<div class="line"><span class="keywordtype">void</span> IncrementFilename(<span class="keywordtype">char</span> *f)</div>
<div class="line">{</div>
<div class="line">  <span class="keywordflow">if</span> (f[7] == <span class="charliteral">&#39;9&#39;</span>) {</div>
<div class="line">    f[7] = <span class="charliteral">&#39;0&#39;</span>;</div>
<div class="line">    <span class="keywordflow">if</span> (f[6] == <span class="charliteral">&#39;9&#39;</span>) {</div>
<div class="line">      f[6] = <span class="charliteral">&#39;0&#39;</span>;</div>
<div class="line">      <span class="keywordflow">if</span> (f[5] == <span class="charliteral">&#39;9&#39;</span>) {</div>
<div class="line">        f[5] = <span class="charliteral">&#39;0&#39;</span>;</div>
<div class="line">        <span class="keywordflow">if</span> (f[4] == <span class="charliteral">&#39;9&#39;</span>) {</div>
<div class="line">          f[4] = <span class="charliteral">&#39;0&#39;</span>;</div>
<div class="line">          <span class="keywordflow">if</span> (f[3] == <span class="charliteral">&#39;9&#39;</span>) {</div>
<div class="line">            f[3] = <span class="charliteral">&#39;0&#39;</span>;</div>
<div class="line">            fprintf(stderr,<span class="stringliteral">&quot;Warning: file increment hit max limit. Resetting to zero.\n&quot;</span>);</div>
<div class="line">          } <span class="keywordflow">else</span> {</div>
<div class="line">            f[3]++;</div>
<div class="line">          }</div>
<div class="line">        } <span class="keywordflow">else</span> {</div>
<div class="line">          f[4]++;</div>
<div class="line">        }</div>
<div class="line">      } <span class="keywordflow">else</span> {</div>
<div class="line">        f[5]++;</div>
<div class="line">      }</div>
<div class="line">    } <span class="keywordflow">else</span> {</div>
<div class="line">      f[6]++;</div>
<div class="line">    }</div>
<div class="line">  } <span class="keywordflow">else</span> {</div>
<div class="line">    f[7]++;</div>
<div class="line">  }</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"><span class="keywordtype">double</span> <a class="code" href="a00231.html#a840eef18a5986381093ff8c176a2153c">raiseto</a>(<span class="keywordtype">double</span> x, <span class="keywordtype">double</span> a)</div>
<div class="line">{</div>
<div class="line">  <span class="keywordflow">return</span>(exp(a*log(x)));</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"><span class="keywordtype">int</span> <a class="code" href="a00227.html#a5bdb048ecc5ae7ab61622e4764f3133e">WriteTecplot3D</a>(<span class="keywordtype">int</span> ndims,<span class="keywordtype">int</span> nvars,<span class="keywordtype">int</span> *dim,<span class="keywordtype">double</span> *x,<span class="keywordtype">double</span> *u,<span class="keywordtype">char</span> *f,<span class="keywordtype">int</span> *index)</div>
<div class="line">{</div>
<div class="line">  <span class="keywordflow">if</span> (ndims !=3) {</div>
<div class="line">    fprintf(stderr,<span class="stringliteral">&quot;Error in WriteTecplot3D(): This functions is hardcoded for 3-dimensional &quot;</span>);</div>
<div class="line">    fprintf(stderr,<span class="stringliteral">&quot;problems only. Instead, ndims=%d.\n&quot;</span>,ndims);</div>
<div class="line">    <span class="keywordflow">return</span>(1);</div>
<div class="line">  }</div>
<div class="line">  <span class="keywordtype">int</span> i;</div>
<div class="line">  <span class="keywordtype">int</span> imax = dim[0];</div>
<div class="line">  <span class="keywordtype">int</span> jmax = dim[1];</div>
<div class="line">  <span class="keywordtype">int</span> kmax = dim[2];</div>
<div class="line"></div>
<div class="line">  printf(<span class="stringliteral">&quot;Writing tecplot solution file %s.\n&quot;</span>,f);</div>
<div class="line">  FILE *out;</div>
<div class="line">  out = fopen(f,<span class="stringliteral">&quot;w&quot;</span>);</div>
<div class="line">  <span class="keywordflow">if</span> (!out) {</div>
<div class="line">    fprintf(stderr,<span class="stringliteral">&quot;Error: could not open %s for writing.\n&quot;</span>,f);</div>
<div class="line">    <span class="keywordflow">return</span>(1);</div>
<div class="line">  }</div>
<div class="line"></div>
<div class="line">  <span class="comment">/* writing tecplot data file headers */</span></div>
<div class="line">  fprintf(out,<span class="stringliteral">&quot;VARIABLES=\&quot;I\&quot;,\&quot;J\&quot;,\&quot;K\&quot;,\&quot;X\&quot;,\&quot;Y\&quot;,\&quot;Z\&quot;,&quot;</span>);</div>
<div class="line">  <span class="keywordtype">char</span> varname[3] = <span class="stringliteral">&quot;00&quot;</span>;</div>
<div class="line">  <span class="keywordflow">for</span> (i = 0; i &lt; nvars; i++) {</div>
<div class="line">    fprintf(out,<span class="stringliteral">&quot;\&quot;%s\&quot;,&quot;</span>,varname);</div>
<div class="line">    <span class="keywordflow">if</span> (varname[1] == <span class="charliteral">&#39;9&#39;</span>) { varname[0]++; varname[1] = <span class="charliteral">&#39;0&#39;</span>; }</div>
<div class="line">    <span class="keywordflow">else</span>                     varname[1]++;</div>
<div class="line">  }</div>
<div class="line">  fprintf(out,<span class="stringliteral">&quot;\n&quot;</span>);</div>
<div class="line">  fprintf(out,<span class="stringliteral">&quot;ZONE I=%d,J=%d,K=%d,F=POINT\n&quot;</span>,imax,jmax,kmax);</div>
<div class="line"></div>
<div class="line">  <span class="comment">/* writing the data */</span></div>
<div class="line">  <span class="keywordtype">int</span> done = 0; <a class="code" href="a00219.html#a2b2826031c0cd92495ab351d3e599fc5">_ArraySetValue_</a>(index,ndims,0);</div>
<div class="line">  <span class="keywordflow">while</span> (!done) {</div>
<div class="line">    <span class="keywordtype">int</span> i, p;</div>
<div class="line">    <a class="code" href="a00219.html#afbb862a2fdf5b72b1f9ace42f64b556f">_ArrayIndex1D_</a>(ndims,dim,index,0,p);</div>
<div class="line">    <span class="keywordflow">for</span> (i=0; i&lt;ndims; i++) fprintf(out,<span class="stringliteral">&quot;%4d &quot;</span>,index[i]);</div>
<div class="line">    <span class="keywordflow">for</span> (i=0; i&lt;ndims; i++) {</div>
<div class="line">      <span class="keywordtype">int</span> j,offset = 0; <span class="keywordflow">for</span> (j=0; j&lt;i; j++) offset += dim[j];</div>
<div class="line">      fprintf(out,<span class="stringliteral">&quot;%+E &quot;</span>,x[offset+index[i]]);</div>
<div class="line">    }</div>
<div class="line">    <span class="keywordflow">for</span> (i=0; i&lt;nvars; i++) fprintf(out,<span class="stringliteral">&quot;%+E &quot;</span>,u[nvars*p+i]);</div>
<div class="line">    fprintf(out,<span class="stringliteral">&quot;\n&quot;</span>);</div>
<div class="line">    <a class="code" href="a00219.html#ac5ec1371623f11d03b0f42adaa24acbc">_ArrayIncrementIndex_</a>(ndims,dim,index,done);</div>
<div class="line">  }</div>
<div class="line">  fclose(out);</div>
<div class="line">  <span class="keywordflow">return</span>(0);</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"><span class="keywordtype">int</span> <a class="code" href="a00227.html#a3355a71faf3d87f6715ad627db08ac9e">WriteText</a>(<span class="keywordtype">int</span> ndims,<span class="keywordtype">int</span> nvars,<span class="keywordtype">int</span> *dim,<span class="keywordtype">double</span> *x,<span class="keywordtype">double</span> *u,<span class="keywordtype">char</span> *f,<span class="keywordtype">int</span> *index)</div>
<div class="line">{</div>
<div class="line">  FILE *out;</div>
<div class="line">  out = fopen(f,<span class="stringliteral">&quot;w&quot;</span>);</div>
<div class="line">  <span class="keywordflow">if</span> (!out) {</div>
<div class="line">    fprintf(stderr,<span class="stringliteral">&quot;Error: could not open %s for writing.\n&quot;</span>,f);</div>
<div class="line">    <span class="keywordflow">return</span>(1);</div>
<div class="line">  }</div>
<div class="line"></div>
<div class="line">  <span class="keywordtype">int</span> done = 0; <a class="code" href="a00219.html#a2b2826031c0cd92495ab351d3e599fc5">_ArraySetValue_</a>(index,ndims,0);</div>
<div class="line">  <span class="keywordflow">while</span> (!done) {</div>
<div class="line">    <span class="keywordtype">int</span> i, p;</div>
<div class="line">    <a class="code" href="a00219.html#afbb862a2fdf5b72b1f9ace42f64b556f">_ArrayIndex1D_</a>(ndims,dim,index,0,p);</div>
<div class="line">    <span class="keywordflow">for</span> (i=0; i&lt;ndims; i++) fprintf(out,<span class="stringliteral">&quot;%4d &quot;</span>,index[i]);</div>
<div class="line">    <span class="keywordflow">for</span> (i=0; i&lt;ndims; i++) {</div>
<div class="line">      <span class="keywordtype">int</span> j,offset = 0; <span class="keywordflow">for</span> (j=0; j&lt;i; j++) offset += dim[j];</div>
<div class="line">      fprintf(out,<span class="stringliteral">&quot;%+E &quot;</span>,x[offset+index[i]]);</div>
<div class="line">    }</div>
<div class="line">    <span class="keywordflow">for</span> (i=0; i&lt;nvars; i++) fprintf(out,<span class="stringliteral">&quot;%+E &quot;</span>,u[nvars*p+i]);</div>
<div class="line">    fprintf(out,<span class="stringliteral">&quot;\n&quot;</span>);</div>
<div class="line">    <a class="code" href="a00219.html#ac5ec1371623f11d03b0f42adaa24acbc">_ArrayIncrementIndex_</a>(ndims,dim,index,done);</div>
<div class="line">  }</div>
<div class="line">  fclose(out);</div>
<div class="line">  <span class="keywordflow">return</span>(0);</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"><span class="keywordtype">int</span> PostProcess(<span class="keywordtype">char</span> *fname, <span class="keywordtype">char</span> *oname, <span class="keywordtype">void</span> *p, <span class="keywordtype">int</span> flag)</div>
<div class="line">{</div>
<div class="line">  Parameters *params = (Parameters*) p;</div>
<div class="line">  FILE *in; in = fopen(fname,<span class="stringliteral">&quot;rb&quot;</span>);</div>
<div class="line"></div>
<div class="line">  <span class="keywordflow">if</span> (!in) <span class="keywordflow">return</span>(-1);</div>
<div class="line"></div>
<div class="line">  printf(<span class="stringliteral">&quot;Reading file %s.\n&quot;</span>,fname);</div>
<div class="line">  <span class="keywordtype">int</span> ndims, nvars;</div>
<div class="line">  <span class="keywordtype">double</span> *U,*x;</div>
<div class="line"></div>
<div class="line">  <span class="comment">/* read the file headers */</span></div>
<div class="line">  fread(&amp;ndims,<span class="keyword">sizeof</span>(<span class="keywordtype">int</span>),1,in);</div>
<div class="line">  fread(&amp;nvars,<span class="keyword">sizeof</span>(<span class="keywordtype">int</span>),1,in);</div>
<div class="line"></div>
<div class="line">  <span class="comment">/* some checks */</span></div>
<div class="line">  <span class="keywordflow">if</span> (ndims != 3) {</div>
<div class="line">    printf(<span class="stringliteral">&quot;Error: ndims in %s not equal to 3!\n&quot;</span>,fname);</div>
<div class="line">    <span class="keywordflow">return</span>(1);</div>
<div class="line">  }</div>
<div class="line">  <span class="keywordflow">if</span> (nvars != 5) {</div>
<div class="line">    printf(<span class="stringliteral">&quot;Error: nvars in %s not equal to 5!\n&quot;</span>,fname);</div>
<div class="line">    <span class="keywordflow">return</span>(1);</div>
<div class="line">  }</div>
<div class="line"></div>
<div class="line">  <span class="comment">/* read dimensions */</span></div>
<div class="line">  <span class="keywordtype">int</span> dims[ndims];</div>
<div class="line">  fread(dims,<span class="keyword">sizeof</span>(<span class="keywordtype">int</span>),ndims,in);</div>
<div class="line">  printf(<span class="stringliteral">&quot;Dimensions: %d x %d x %d\n&quot;</span>,dims[0],dims[1],dims[2]);</div>
<div class="line">  printf(<span class="stringliteral">&quot;Nvars     : %d\n&quot;</span>,nvars);</div>
<div class="line"></div>
<div class="line">  <span class="comment">/* allocate grid and solution arrays */</span></div>
<div class="line">  x = (<span class="keywordtype">double</span>*) calloc (dims[0]+dims[1]+dims[2]       ,<span class="keyword">sizeof</span>(<span class="keywordtype">double</span>));</div>
<div class="line">  U = (<span class="keywordtype">double</span>*) calloc (dims[0]*dims[1]*dims[2]*nvars ,<span class="keyword">sizeof</span>(<span class="keywordtype">double</span>));</div>
<div class="line"></div>
<div class="line">  <span class="comment">/* read grid and solution */</span></div>
<div class="line">  fread(x,<span class="keyword">sizeof</span>(<span class="keywordtype">double</span>),dims[0]+dims[1]+dims[2]      ,in);</div>
<div class="line">  fread(U,<span class="keyword">sizeof</span>(<span class="keywordtype">double</span>),dims[0]*dims[1]*dims[2]*nvars,in);</div>
<div class="line">  <span class="comment">/* done reading */</span></div>
<div class="line">  fclose(in);</div>
<div class="line"></div>
<div class="line">  <span class="keywordtype">int</span> imax = dims[0];</div>
<div class="line">  <span class="keywordtype">int</span> jmax = dims[1];</div>
<div class="line">  <span class="keywordtype">int</span> kmax = dims[2];</div>
<div class="line"></div>
<div class="line">  <span class="comment">/* allocate primitive variable array (rho, u, v, w, P, theta, rho0, P0, pi0, theta0) */</span></div>
<div class="line">  <span class="keywordtype">int</span> evars = 5;</div>
<div class="line">  <span class="keywordtype">double</span> *Q = (<span class="keywordtype">double</span>*) calloc ((nvars+evars)*imax*jmax*kmax,<span class="keyword">sizeof</span>(double));</div>
<div class="line">    </div>
<div class="line">  <span class="comment">/* calculate primitive variables */</span></div>
<div class="line">  <span class="keywordtype">int</span> i, j, k;</div>
<div class="line">  <span class="keywordtype">double</span> *X           = x;</div>
<div class="line">  <span class="keywordtype">double</span> *Y           = x+imax;</div>
<div class="line">  <span class="keywordtype">double</span> *Z           = x+imax+jmax;</div>
<div class="line">  <span class="keywordtype">double</span> grav_y       = params-&gt;grav_y;</div>
<div class="line">  <span class="keywordtype">double</span> R            = params-&gt;R;</div>
<div class="line">  <span class="keywordtype">double</span> gamma        = params-&gt;gamma;</div>
<div class="line">  <span class="keywordtype">double</span> P_ref        = params-&gt;P_ref;</div>
<div class="line">  <span class="keywordtype">double</span> rho_ref      = params-&gt;rho_ref;</div>
<div class="line">  <span class="keywordtype">double</span> T_ref        = P_ref / (R*rho_ref);</div>
<div class="line">  <span class="keywordtype">double</span> inv_gamma_m1 = 1.0 / (gamma-1.0);</div>
<div class="line">  <span class="keywordtype">double</span> Cp           = gamma * inv_gamma_m1 * R;</div>
<div class="line"></div>
<div class="line">  <span class="keywordflow">for</span> (i=0; i&lt;imax; i++) {</div>
<div class="line">    <span class="keywordflow">for</span> (j=0; j&lt;jmax; j++) {</div>
<div class="line">      <span class="keywordflow">for</span> (k=0; k&lt;kmax; k++) {</div>
<div class="line">        <span class="keywordtype">int</span> p = i + imax*j + imax*jmax*k;</div>
<div class="line"></div>
<div class="line">        <span class="keywordtype">double</span> rho0, theta0, Pexner, P0;</div>
<div class="line">        theta0  = T_ref;</div>
<div class="line">        Pexner  = 1.0 - (grav_y*Y[j])/(Cp*T_ref);</div>
<div class="line">        rho0    = (P_ref/(R*theta0)) * <a class="code" href="a00231.html#a840eef18a5986381093ff8c176a2153c">raiseto</a>(Pexner, inv_gamma_m1);</div>
<div class="line">        P0      = P_ref   * <a class="code" href="a00231.html#a840eef18a5986381093ff8c176a2153c">raiseto</a>(Pexner, gamma*inv_gamma_m1);</div>
<div class="line"></div>
<div class="line">        <span class="keywordtype">double</span> rho, uvel, vvel, wvel, E, P, theta;</div>
<div class="line">        rho   = U[nvars*p+0];</div>
<div class="line">        uvel  = U[nvars*p+1] / rho;</div>
<div class="line">        vvel  = U[nvars*p+2] / rho;</div>
<div class="line">        wvel  = U[nvars*p+3] / rho;</div>
<div class="line">        E     = U[nvars*p+4];</div>
<div class="line">        P     = (gamma-1.0) * (E - 0.5*rho*(uvel*uvel+vvel*vvel+wvel*wvel));</div>
<div class="line">        theta = (E-0.5*rho*(uvel*uvel+vvel*vvel+wvel*wvel))/(Pexner*rho) * ((gamma-1.0)/R);</div>
<div class="line"></div>
<div class="line">        Q[(nvars+evars)*p+0] = rho;</div>
<div class="line">        Q[(nvars+evars)*p+1] = uvel;</div>
<div class="line">        Q[(nvars+evars)*p+2] = vvel;</div>
<div class="line">        Q[(nvars+evars)*p+3] = wvel;</div>
<div class="line">        Q[(nvars+evars)*p+4] = P;</div>
<div class="line">        Q[(nvars+evars)*p+5] = theta;</div>
<div class="line">        Q[(nvars+evars)*p+6] = rho0;</div>
<div class="line">        Q[(nvars+evars)*p+7] = P0;</div>
<div class="line">        Q[(nvars+evars)*p+8] = Pexner;</div>
<div class="line">        Q[(nvars+evars)*p+9] = theta0;</div>
<div class="line">      }</div>
<div class="line">    }</div>
<div class="line">  }</div>
<div class="line"></div>
<div class="line">  <span class="keywordtype">int</span> dim[ndims], index[ndims];</div>
<div class="line">  dim[0] = imax;</div>
<div class="line">  dim[1] = jmax;</div>
<div class="line">  dim[2] = kmax;</div>
<div class="line"></div>
<div class="line">  <span class="comment">/* write Tecplot/Text file */</span></div>
<div class="line">  <span class="keywordflow">if</span> (flag) <a class="code" href="a00227.html#a5bdb048ecc5ae7ab61622e4764f3133e">WriteTecplot3D</a>(ndims,nvars+evars,&amp;dim[0],x,Q,oname,&amp;index[0]);</div>
<div class="line">  <span class="keywordflow">else</span>      <a class="code" href="a00227.html#a3355a71faf3d87f6715ad627db08ac9e">WriteText</a>     (ndims,nvars+evars,&amp;dim[0],x,Q,oname,&amp;index[0]);</div>
<div class="line"></div>
<div class="line">  <span class="comment">/* clean up */</span></div>
<div class="line">  free(U);</div>
<div class="line">  free(Q);</div>
<div class="line">  free(x);</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"><span class="keywordtype">int</span> <a class="code" href="a00353.html#a3c04138a5bfe5d72780bb7e82a18e627">main</a>()</div>
<div class="line">{</div>
<div class="line">  FILE *out1, *out2, *in, *inputs;</div>
<div class="line">  <span class="keywordtype">char</span> filename[50], op_file_format[50], tecfile[50], overwrite[50];</div>
<div class="line"></div>
<div class="line">  <span class="keywordtype">int</span> flag;</div>
<div class="line">  printf(<span class="stringliteral">&quot;Write tecplot file (1) or plain text file (0): &quot;</span>);</div>
<div class="line">  scanf(<span class="stringliteral">&quot;%d&quot;</span>,&amp;flag);</div>
<div class="line"></div>
<div class="line">  <span class="keywordflow">if</span> ((flag != 1) &amp;&amp; (flag != 0)) {</div>
<div class="line">    printf(<span class="stringliteral">&quot;Error: Invalid input. Should be 1 or 0.\n&quot;</span>);</div>
<div class="line">    <span class="keywordflow">return</span>(0);</div>
<div class="line">  }</div>
<div class="line"></div>
<div class="line">  printf(<span class="stringliteral">&quot;Reading solver.inp.\n&quot;</span>);</div>
<div class="line">  inputs = fopen(<span class="stringliteral">&quot;solver.inp&quot;</span>,<span class="stringliteral">&quot;r&quot;</span>);</div>
<div class="line">  <span class="keywordflow">if</span> (!inputs) {</div>
<div class="line">    fprintf(stderr,<span class="stringliteral">&quot;Error: File \&quot;solver.inp\&quot; not found.\n&quot;</span>);</div>
<div class="line">    <span class="keywordflow">return</span>(1);</div>
<div class="line">  } <span class="keywordflow">else</span> {</div>
<div class="line">      <span class="keywordtype">char</span> word[100];</div>
<div class="line">    fscanf(inputs,<span class="stringliteral">&quot;%s&quot;</span>,word);</div>
<div class="line">    <span class="keywordflow">if</span> (!strcmp(word, <span class="stringliteral">&quot;begin&quot;</span>)){</div>
<div class="line">        <span class="keywordflow">while</span> (strcmp(word, <span class="stringliteral">&quot;end&quot;</span>)){</div>
<div class="line">            fscanf(inputs,<span class="stringliteral">&quot;%s&quot;</span>,word);</div>
<div class="line">            <span class="keywordflow">if</span>      (!strcmp(word, <span class="stringliteral">&quot;op_file_format&quot;</span>   ))  fscanf(inputs,<span class="stringliteral">&quot;%s&quot;</span> ,op_file_format);</div>
<div class="line">            <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcmp(word, <span class="stringliteral">&quot;op_overwrite&quot;</span>     ))  fscanf(inputs,<span class="stringliteral">&quot;%s&quot;</span> ,overwrite      );</div>
<div class="line">      }</div>
<div class="line">    }</div>
<div class="line">    fclose(inputs);</div>
<div class="line">  }</div>
<div class="line">  <span class="keywordflow">if</span> (strcmp(op_file_format,<span class="stringliteral">&quot;binary&quot;</span>) &amp;&amp; strcmp(op_file_format,<span class="stringliteral">&quot;bin&quot;</span>)) {</div>
<div class="line">    printf(<span class="stringliteral">&quot;Error: solution output needs to be in binary files.\n&quot;</span>);</div>
<div class="line">    <span class="keywordflow">return</span>(0);</div>
<div class="line">  }</div>
<div class="line"></div>
<div class="line">  Parameters params;</div>
<div class="line">  <span class="comment">/* default values */</span></div>
<div class="line">  params.grav_x   = 0.0;</div>
<div class="line">  params.grav_y   = 9.8;</div>
<div class="line">  params.grav_z   = 0.0;</div>
<div class="line">  params.R        = 287.058;</div>
<div class="line">  params.gamma    = 1.4;</div>
<div class="line">  params.P_ref    = 100000.0;</div>
<div class="line">  params.rho_ref  = 100000.0 / (params.R * 300.0);</div>
<div class="line">  params.HB       = 0;</div>
<div class="line">  <span class="comment">/* read these parameters from file */</span></div>
<div class="line">  printf(<span class="stringliteral">&quot;Reading physics.inp.\n&quot;</span>);</div>
<div class="line">  inputs = fopen(<span class="stringliteral">&quot;physics.inp&quot;</span>,<span class="stringliteral">&quot;r&quot;</span>);</div>
<div class="line">  <span class="keywordflow">if</span> (!inputs) {</div>
<div class="line">    fprintf(stderr,<span class="stringliteral">&quot;Error: File \&quot;physics.inp\&quot; not found.\n&quot;</span>);</div>
<div class="line">    <span class="keywordflow">return</span>(1);</div>
<div class="line">  } <span class="keywordflow">else</span> {</div>
<div class="line">      <span class="keywordtype">char</span> word[100];</div>
<div class="line">    fscanf(inputs,<span class="stringliteral">&quot;%s&quot;</span>,word);</div>
<div class="line">    <span class="keywordflow">if</span> (!strcmp(word, <span class="stringliteral">&quot;begin&quot;</span>)){</div>
<div class="line">        <span class="keywordflow">while</span> (strcmp(word, <span class="stringliteral">&quot;end&quot;</span>)){</div>
<div class="line">            fscanf(inputs,<span class="stringliteral">&quot;%s&quot;</span>,word);</div>
<div class="line">            <span class="keywordflow">if</span>      (!strcmp(word, <span class="stringliteral">&quot;gamma&quot;</span>))    fscanf(inputs,<span class="stringliteral">&quot;%lf&quot;</span>,&amp;params.gamma);</div>
<div class="line">            <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcmp(word, <span class="stringliteral">&quot;gravity&quot;</span>)) {</div>
<div class="line">          fscanf(inputs,<span class="stringliteral">&quot;%lf&quot;</span>,&amp;params.grav_x);</div>
<div class="line">          fscanf(inputs,<span class="stringliteral">&quot;%lf&quot;</span>,&amp;params.grav_y);</div>
<div class="line">          fscanf(inputs,<span class="stringliteral">&quot;%lf&quot;</span>,&amp;params.grav_z);</div>
<div class="line">        } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcmp(word,<span class="stringliteral">&quot;p_ref&quot;</span>))   fscanf(inputs,<span class="stringliteral">&quot;%lf&quot;</span>,&amp;params.P_ref);</div>
<div class="line">        <span class="keywordflow">else</span> <span class="keywordflow">if</span>   (!strcmp(word,<span class="stringliteral">&quot;rho_ref&quot;</span>)) fscanf(inputs,<span class="stringliteral">&quot;%lf&quot;</span>,&amp;params.rho_ref);</div>
<div class="line">        <span class="keywordflow">else</span> <span class="keywordflow">if</span>   (!strcmp(word,<span class="stringliteral">&quot;HB&quot;</span>))      fscanf(inputs,<span class="stringliteral">&quot;%d&quot;</span>,&amp;params.HB);</div>
<div class="line">      }</div>
<div class="line">    }</div>
<div class="line">    fclose(inputs);</div>
<div class="line">  }</div>
<div class="line"></div>
<div class="line">  <span class="keywordflow">if</span> (!strcmp(overwrite,<span class="stringliteral">&quot;no&quot;</span>)) {</div>
<div class="line">    strcpy(filename,<span class="stringliteral">&quot;op_00000.bin&quot;</span>);</div>
<div class="line">    <span class="keywordflow">while</span>(1) {</div>
<div class="line">      <span class="comment">/* set filename */</span></div>
<div class="line">      strcpy(tecfile,filename);</div>
<div class="line">      tecfile[9]  = <span class="charliteral">&#39;d&#39;</span>;</div>
<div class="line">      tecfile[10] = <span class="charliteral">&#39;a&#39;</span>;</div>
<div class="line">      tecfile[11] = <span class="charliteral">&#39;t&#39;</span>;</div>
<div class="line">      <span class="keywordtype">int</span> err = PostProcess(filename, tecfile, &amp;params, flag);</div>
<div class="line">      <span class="keywordflow">if</span> (err == -1) {</div>
<div class="line">        printf(<span class="stringliteral">&quot;No more files found. Exiting.\n&quot;</span>);</div>
<div class="line">        <span class="keywordflow">break</span>;</div>
<div class="line">      }</div>
<div class="line">      IncrementFilename(filename);</div>
<div class="line">    }</div>
<div class="line">  } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcmp(overwrite,<span class="stringliteral">&quot;yes&quot;</span>)) {</div>
<div class="line">    strcpy(filename,<span class="stringliteral">&quot;op.bin&quot;</span>);</div>
<div class="line">    <span class="comment">/* set filename */</span></div>
<div class="line">    strcpy(tecfile,filename);</div>
<div class="line">    tecfile[3] = <span class="charliteral">&#39;d&#39;</span>;</div>
<div class="line">    tecfile[4] = <span class="charliteral">&#39;a&#39;</span>;</div>
<div class="line">    tecfile[5] = <span class="charliteral">&#39;t&#39;</span>;</div>
<div class="line">    <span class="keywordtype">int</span> err = PostProcess(filename, tecfile, &amp;params, flag);</div>
<div class="line">    <span class="keywordflow">if</span> (err == -1) {</div>
<div class="line">      printf(<span class="stringliteral">&quot;Error: op.bin not found.\n&quot;</span>);</div>
<div class="line">      <span class="keywordflow">return</span>(0);</div>
<div class="line">    }</div>
<div class="line">  }</div>
<div class="line"></div>
<div class="line">  <span class="keywordflow">return</span>(0);</div>
<div class="line">}</div>
</div><!-- fragment --><p>The following figure shows the potential temperature iso-surface for the initial and final solutions (plotted in VisIt): </p>
<div class="image">
<img src="Solution_3DNavStok_Bubble3D.png" alt="Solution_3DNavStok_Bubble3D.png"/>
</div>
<p>The file <b>Extras/ExtractSlice.c</b> can be used to extract a slice perpendicular to any dimension at a specified location along that dimension. The extract slice is written out in the same binary format as the original solutions files (with the same names op_xxxxx.bin) in a subdirectory called <b>slices</b> (<b>Note:</b> make the subdirectory called <em>slices</em> before running this code). The following code (<b>Examples/3D/NavierStokes3D/RisingThermalBubble_Config1/aux/PostProcessSlice.c</b>) can then be used (in the <b>slices</b> subdirectory) to convert the binary slice solution file (with conserved variables \(\rho,\rho u,\rho v,\rho w,e\)) to Tecplot or plain text files with the primitive and reference variables \(\rho,u,v,w,P,\theta,\rho_0,P_0,\pi,\theta_0\). <b>Note</b> that it needs the relevant <b>solver.inp</b> and <b>physics.inp</b> that can be created as follows:</p>
<ul>
<li>Copy the original solver.inp and physics.inp to the slices subdirectory.</li>
<li>In solver.inp, set <b>ndims</b> as <b>2</b>, and remove the component of <b>size</b> and <b>iproc</b> corresponding to the dimension being eliminated while extracting the slices (in this case, it is <em>z</em> or the 3rd component).</li>
<li>In physics.inp, remove the component of <b>gravity</b> corresponding to the dimension perpendicular to the slice.</li>
</ul>
<div class="fragment"><div class="line"><span class="comment">/*</span></div>
<div class="line"><span class="comment">  Rising Thermal Bubble:-</span></div>
<div class="line"><span class="comment">  The code takes a binary solution file (that contains the </span></div>
<div class="line"><span class="comment">  conserved variable (rho, rho*u, rho*v, e) as its input </span></div>
<div class="line"><span class="comment">  and calculates the primitive atmospheric flow variables:</span></div>
<div class="line"><span class="comment">  rho, u, v, P, theta, pi, rho0, P0, theta0, pi0</span></div>
<div class="line"><span class="comment">  and writes them to a tecplot file.</span></div>
<div class="line"><span class="comment">*/</span></div>
<div class="line"></div>
<div class="line"><span class="preprocessor">#include &lt;stdio.h&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;stdlib.h&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;string.h&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;math.h&gt;</span></div>
<div class="line"></div>
<div class="line"><span class="keyword">typedef</span> <span class="keyword">struct </span>_parameters_{</div>
<div class="line">  <span class="keywordtype">double</span> grav_x, grav_y, R, gamma, P_ref, rho_ref;</div>
<div class="line">  <span class="keywordtype">int</span> HB;</div>
<div class="line">} Parameters;</div>
<div class="line"></div>
<div class="line"><span class="keywordtype">void</span> IncrementFilename(<span class="keywordtype">char</span> *f)</div>
<div class="line">{</div>
<div class="line">  <span class="keywordflow">if</span> (f[7] == <span class="charliteral">&#39;9&#39;</span>) {</div>
<div class="line">    f[7] = <span class="charliteral">&#39;0&#39;</span>;</div>
<div class="line">    <span class="keywordflow">if</span> (f[6] == <span class="charliteral">&#39;9&#39;</span>) {</div>
<div class="line">      f[6] = <span class="charliteral">&#39;0&#39;</span>;</div>
<div class="line">      <span class="keywordflow">if</span> (f[5] == <span class="charliteral">&#39;9&#39;</span>) {</div>
<div class="line">        f[5] = <span class="charliteral">&#39;0&#39;</span>;</div>
<div class="line">        <span class="keywordflow">if</span> (f[4] == <span class="charliteral">&#39;9&#39;</span>) {</div>
<div class="line">          f[4] = <span class="charliteral">&#39;0&#39;</span>;</div>
<div class="line">          <span class="keywordflow">if</span> (f[3] == <span class="charliteral">&#39;9&#39;</span>) {</div>
<div class="line">            f[3] = <span class="charliteral">&#39;0&#39;</span>;</div>
<div class="line">            fprintf(stderr,<span class="stringliteral">&quot;Warning: file increment hit max limit. Resetting to zero.\n&quot;</span>);</div>
<div class="line">          } <span class="keywordflow">else</span> {</div>
<div class="line">            f[3]++;</div>
<div class="line">          }</div>
<div class="line">        } <span class="keywordflow">else</span> {</div>
<div class="line">          f[4]++;</div>
<div class="line">        }</div>
<div class="line">      } <span class="keywordflow">else</span> {</div>
<div class="line">        f[5]++;</div>
<div class="line">      }</div>
<div class="line">    } <span class="keywordflow">else</span> {</div>
<div class="line">      f[6]++;</div>
<div class="line">    }</div>
<div class="line">  } <span class="keywordflow">else</span> {</div>
<div class="line">    f[7]++;</div>
<div class="line">  }</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"><span class="keywordtype">double</span> <a class="code" href="a00231.html#a840eef18a5986381093ff8c176a2153c">raiseto</a>(<span class="keywordtype">double</span> x, <span class="keywordtype">double</span> a)</div>
<div class="line">{</div>
<div class="line">  <span class="keywordflow">return</span>(exp(a*log(x)));</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"><span class="keywordtype">void</span> <a class="code" href="a00227.html#a265b0583afb79edd2f2f5d5087e5c3bf">WriteTecplot2D</a>(<span class="keywordtype">int</span> nvars,<span class="keywordtype">int</span> imax, <span class="keywordtype">int</span> jmax,<span class="keywordtype">double</span> *x,<span class="keywordtype">double</span> *u,<span class="keywordtype">char</span> *f)</div>
<div class="line">{</div>
<div class="line">  printf(<span class="stringliteral">&quot;\tWriting tecplot solution file %s.\n&quot;</span>,f);</div>
<div class="line">  FILE *out;</div>
<div class="line">  out = fopen(f,<span class="stringliteral">&quot;w&quot;</span>);</div>
<div class="line">  <span class="keywordflow">if</span> (!out) {</div>
<div class="line">    fprintf(stderr,<span class="stringliteral">&quot;Error: could not open %s for writing.\n&quot;</span>,f);</div>
<div class="line">    <span class="keywordflow">return</span>;</div>
<div class="line">  }</div>
<div class="line"></div>
<div class="line">  <span class="keywordtype">double</span> *X = x;</div>
<div class="line">  <span class="keywordtype">double</span> *Y = x+imax;</div>
<div class="line"></div>
<div class="line">  <span class="comment">/* writing tecplot data file headers */</span></div>
<div class="line">  fprintf(out,<span class="stringliteral">&quot;VARIABLES=\&quot;I\&quot;,\&quot;J\&quot;,\&quot;X\&quot;,\&quot;Y\&quot;,&quot;</span>);</div>
<div class="line">  fprintf(out,<span class="stringliteral">&quot;\&quot;RHO\&quot;,\&quot;U\&quot;,\&quot;V\&quot;,\&quot;W\&quot;,\&quot;P\&quot;,&quot;</span>);</div>
<div class="line">  fprintf(out,<span class="stringliteral">&quot;\&quot;THETA\&quot;,\&quot;RHO0\&quot;,\&quot;P0\&quot;,&quot;</span>);</div>
<div class="line">  fprintf(out,<span class="stringliteral">&quot;\&quot;PI0\&quot;,\&quot;THETA0\&quot;,\n&quot;</span>);</div>
<div class="line">  fprintf(out,<span class="stringliteral">&quot;ZONE I=%d,J=%d,F=POINT\n&quot;</span>,imax,jmax);</div>
<div class="line"></div>
<div class="line">  <span class="comment">/* writing the data */</span></div>
<div class="line">  <span class="keywordtype">int</span> i,j;</div>
<div class="line">  <span class="keywordflow">for</span> (j=0; j&lt;jmax; j++) {</div>
<div class="line">    <span class="keywordflow">for</span> (i=0; i&lt;imax; i++) {</div>
<div class="line">      <span class="keywordtype">int</span> v, p = i + imax*j;</div>
<div class="line">      fprintf(out,<span class="stringliteral">&quot;%4d %4d &quot;</span>,i,j);</div>
<div class="line">      fprintf(out,<span class="stringliteral">&quot;%1.16E %1.16E &quot;</span>,X[i],Y[j]);</div>
<div class="line">      <span class="keywordflow">for</span> (v=0; v&lt;nvars; v++) fprintf(out,<span class="stringliteral">&quot;%1.16E &quot;</span>,u[nvars*p+v]);</div>
<div class="line">      fprintf(out,<span class="stringliteral">&quot;\n&quot;</span>);</div>
<div class="line">    }</div>
<div class="line">  }</div>
<div class="line">  fclose(out);</div>
<div class="line">  <span class="keywordflow">return</span>;</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"><span class="keywordtype">void</span> WriteText2D(<span class="keywordtype">int</span> nvars,<span class="keywordtype">int</span> imax, <span class="keywordtype">int</span> jmax,<span class="keywordtype">double</span> *x,<span class="keywordtype">double</span> *u,<span class="keywordtype">char</span> *f)</div>
<div class="line">{</div>
<div class="line">  printf(<span class="stringliteral">&quot;\tWriting text solution file %s.\n&quot;</span>,f);</div>
<div class="line">  FILE *out;</div>
<div class="line">  out = fopen(f,<span class="stringliteral">&quot;w&quot;</span>);</div>
<div class="line">  <span class="keywordflow">if</span> (!out) {</div>
<div class="line">    fprintf(stderr,<span class="stringliteral">&quot;Error: could not open %s for writing.\n&quot;</span>,f);</div>
<div class="line">    <span class="keywordflow">return</span>;</div>
<div class="line">  }</div>
<div class="line"></div>
<div class="line">  <span class="keywordtype">double</span> *X = x;</div>
<div class="line">  <span class="keywordtype">double</span> *Y = x+imax;</div>
<div class="line"></div>
<div class="line">  <span class="comment">/* writing the data */</span></div>
<div class="line">  <span class="keywordtype">int</span> i,j;</div>
<div class="line">  <span class="keywordflow">for</span> (j=0; j&lt;jmax; j++) {</div>
<div class="line">    <span class="keywordflow">for</span> (i=0; i&lt;imax; i++) {</div>
<div class="line">      <span class="keywordtype">int</span> v, p = i + imax*j;</div>
<div class="line">      fprintf(out,<span class="stringliteral">&quot;%4d %4d &quot;</span>,i,j);</div>
<div class="line">      fprintf(out,<span class="stringliteral">&quot;%1.16E %1.16E &quot;</span>,X[i],Y[j]);</div>
<div class="line">      <span class="keywordflow">for</span> (v=0; v&lt;nvars; v++) fprintf(out,<span class="stringliteral">&quot;%1.16E &quot;</span>,u[nvars*p+v]);</div>
<div class="line">      fprintf(out,<span class="stringliteral">&quot;\n&quot;</span>);</div>
<div class="line">    }</div>
<div class="line">  }</div>
<div class="line">  fclose(out);</div>
<div class="line">  <span class="keywordflow">return</span>;</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"><span class="keywordtype">int</span> PostProcess(<span class="keywordtype">char</span> *fname, <span class="keywordtype">char</span> *oname, <span class="keywordtype">void</span> *p, <span class="keywordtype">int</span> flag)</div>
<div class="line">{</div>
<div class="line">  Parameters *params = (Parameters*) p;</div>
<div class="line">  FILE *in; in = fopen(fname,<span class="stringliteral">&quot;rb&quot;</span>);</div>
<div class="line"></div>
<div class="line">  <span class="keywordflow">if</span> (!in) <span class="keywordflow">return</span>(-1);</div>
<div class="line"></div>
<div class="line">  printf(<span class="stringliteral">&quot;Reading file %s.\n&quot;</span>,fname);</div>
<div class="line">  <span class="keywordtype">int</span> ndims, nvars;</div>
<div class="line">  <span class="keywordtype">double</span> *U,*x;</div>
<div class="line"></div>
<div class="line">  <span class="comment">/* read the file headers */</span></div>
<div class="line">  fread(&amp;ndims,<span class="keyword">sizeof</span>(<span class="keywordtype">int</span>),1,in);</div>
<div class="line">  fread(&amp;nvars,<span class="keyword">sizeof</span>(<span class="keywordtype">int</span>),1,in);</div>
<div class="line"></div>
<div class="line">  <span class="comment">/* some checks */</span></div>
<div class="line">  <span class="keywordflow">if</span> (ndims != 2) {</div>
<div class="line">    printf(<span class="stringliteral">&quot;Error: ndims in %s not equal to 2!\n&quot;</span>,fname);</div>
<div class="line">    <span class="keywordflow">return</span>(1);</div>
<div class="line">  }</div>
<div class="line">  <span class="keywordflow">if</span> (nvars != 5) {</div>
<div class="line">    printf(<span class="stringliteral">&quot;Error: nvars in %s not equal to 5!\n&quot;</span>,fname);</div>
<div class="line">    <span class="keywordflow">return</span>(1);</div>
<div class="line">  }</div>
<div class="line"></div>
<div class="line">  <span class="comment">/* read dimensions */</span></div>
<div class="line">  <span class="keywordtype">int</span> dims[ndims];</div>
<div class="line">  fread(dims,<span class="keyword">sizeof</span>(<span class="keywordtype">int</span>),ndims,in);</div>
<div class="line">  printf(<span class="stringliteral">&quot;Dimensions: %d x %d\n&quot;</span>,dims[0],dims[1]);</div>
<div class="line">  printf(<span class="stringliteral">&quot;Nvars     : %d\n&quot;</span>,nvars);</div>
<div class="line"></div>
<div class="line">  <span class="comment">/* allocate grid and solution arrays */</span></div>
<div class="line">  x = (<span class="keywordtype">double</span>*) calloc (dims[0]+dims[1]       ,<span class="keyword">sizeof</span>(<span class="keywordtype">double</span>));</div>
<div class="line">  U = (<span class="keywordtype">double</span>*) calloc (dims[0]*dims[1]*nvars ,<span class="keyword">sizeof</span>(<span class="keywordtype">double</span>));</div>
<div class="line"></div>
<div class="line">  <span class="comment">/* read grid and solution */</span></div>
<div class="line">  fread(x,<span class="keyword">sizeof</span>(<span class="keywordtype">double</span>),dims[0]+dims[1]      ,in);</div>
<div class="line">  fread(U,<span class="keyword">sizeof</span>(<span class="keywordtype">double</span>),dims[0]*dims[1]*nvars,in);</div>
<div class="line">  <span class="comment">/* done reading */</span></div>
<div class="line">  fclose(in);</div>
<div class="line"></div>
<div class="line">  <span class="keywordtype">int</span> imax = dims[0];</div>
<div class="line">  <span class="keywordtype">int</span> jmax = dims[1];</div>
<div class="line"></div>
<div class="line">  <span class="comment">/* allocate primitive variable array (rho, u, v, w, P, theta, rho0, P0, pi0, theta0) */</span></div>
<div class="line">  <span class="keywordtype">int</span> evars = 5;</div>
<div class="line">  <span class="keywordtype">double</span> *Q = (<span class="keywordtype">double</span>*) calloc ((nvars+evars)*imax*jmax,<span class="keyword">sizeof</span>(double));</div>
<div class="line">    </div>
<div class="line">  <span class="comment">/* calculate primitive variables */</span></div>
<div class="line">  <span class="keywordtype">int</span> i, j;</div>
<div class="line">  <span class="keywordtype">double</span> *X           = x;</div>
<div class="line">  <span class="keywordtype">double</span> *Y           = x+imax;</div>
<div class="line">  <span class="keywordtype">double</span> grav_x       = params-&gt;grav_x;</div>
<div class="line">  <span class="keywordtype">double</span> grav_y       = params-&gt;grav_y;</div>
<div class="line">  <span class="keywordtype">double</span> R            = params-&gt;R;</div>
<div class="line">  <span class="keywordtype">double</span> gamma        = params-&gt;gamma;</div>
<div class="line">  <span class="keywordtype">double</span> P_ref        = params-&gt;P_ref;</div>
<div class="line">  <span class="keywordtype">double</span> rho_ref      = params-&gt;rho_ref;</div>
<div class="line">  <span class="keywordtype">double</span> T_ref        = P_ref / (R*rho_ref);</div>
<div class="line">  <span class="keywordtype">double</span> inv_gamma_m1 = 1.0 / (gamma-1.0);</div>
<div class="line">  <span class="keywordtype">double</span> Cp           = gamma * inv_gamma_m1 * R;</div>
<div class="line"></div>
<div class="line">  <span class="keywordflow">for</span> (i=0; i&lt;imax; i++) {</div>
<div class="line">    <span class="keywordflow">for</span> (j=0; j&lt;jmax; j++) {</div>
<div class="line">      <span class="keywordtype">int</span> p = i + imax*j;</div>
<div class="line"></div>
<div class="line">      <span class="keywordtype">double</span> rho0, theta0, Pexner, P0;</div>
<div class="line">      theta0  = T_ref;</div>
<div class="line">      Pexner  = 1.0 - (grav_x*X[i]+grav_y*Y[j])/(Cp*T_ref);</div>
<div class="line">      rho0    = (P_ref/(R*theta0)) * <a class="code" href="a00231.html#a840eef18a5986381093ff8c176a2153c">raiseto</a>(Pexner, inv_gamma_m1);</div>
<div class="line">      P0      = P_ref   * <a class="code" href="a00231.html#a840eef18a5986381093ff8c176a2153c">raiseto</a>(Pexner, gamma*inv_gamma_m1);</div>
<div class="line"></div>
<div class="line">      <span class="keywordtype">double</span> rho, uvel, vvel, wvel, E, P, theta;</div>
<div class="line">      rho   = U[nvars*p+0];</div>
<div class="line">      uvel  = U[nvars*p+1] / rho;</div>
<div class="line">      vvel  = U[nvars*p+2] / rho;</div>
<div class="line">      wvel  = U[nvars*p+3] / rho;</div>
<div class="line">      E     = U[nvars*p+4];</div>
<div class="line">      P     = (gamma-1.0) * (E - 0.5*rho*(uvel*uvel+vvel*vvel+wvel*wvel));</div>
<div class="line">      theta = (E-0.5*rho*(uvel*uvel+vvel*vvel+wvel*wvel))/(Pexner*rho) * ((gamma-1.0)/R);</div>
<div class="line"></div>
<div class="line">      Q[(nvars+evars)*p+0] = rho;</div>
<div class="line">      Q[(nvars+evars)*p+1] = uvel;</div>
<div class="line">      Q[(nvars+evars)*p+2] = vvel;</div>
<div class="line">      Q[(nvars+evars)*p+3] = wvel;</div>
<div class="line">      Q[(nvars+evars)*p+4] = P;</div>
<div class="line">      Q[(nvars+evars)*p+5] = theta;</div>
<div class="line">      Q[(nvars+evars)*p+6] = rho0;</div>
<div class="line">      Q[(nvars+evars)*p+7] = P0;</div>
<div class="line">      Q[(nvars+evars)*p+8] = Pexner;</div>
<div class="line">      Q[(nvars+evars)*p+9] = theta0;</div>
<div class="line">    }</div>
<div class="line">  }</div>
<div class="line"></div>
<div class="line">  <span class="comment">/* write Tecplot/Text file */</span></div>
<div class="line">  <span class="keywordflow">if</span> (flag) <a class="code" href="a00227.html#a265b0583afb79edd2f2f5d5087e5c3bf">WriteTecplot2D</a>(nvars+evars,imax,jmax,x,Q,oname);</div>
<div class="line">  <span class="keywordflow">else</span>      WriteText2D   (nvars+evars,imax,jmax,x,Q,oname);</div>
<div class="line"></div>
<div class="line">  <span class="comment">/* clean up */</span></div>
<div class="line">  free(U);</div>
<div class="line">  free(Q);</div>
<div class="line">  free(x);</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"><span class="keywordtype">int</span> <a class="code" href="a00353.html#a3c04138a5bfe5d72780bb7e82a18e627">main</a>()</div>
<div class="line">{</div>
<div class="line">  FILE *out1, *out2, *in, *inputs;</div>
<div class="line">  <span class="keywordtype">char</span> filename[50], op_file_format[50], tecfile[50], overwrite[50];</div>
<div class="line"></div>
<div class="line">  <span class="keywordtype">int</span> flag;</div>
<div class="line">  printf(<span class="stringliteral">&quot;Write tecplot file (1) or plain text file (0): &quot;</span>);</div>
<div class="line">  scanf(<span class="stringliteral">&quot;%d&quot;</span>,&amp;flag);</div>
<div class="line"></div>
<div class="line">  <span class="keywordflow">if</span> ((flag != 1) &amp;&amp; (flag != 0)) {</div>
<div class="line">    printf(<span class="stringliteral">&quot;Error: Invalid input. Should be 1 or 0.\n&quot;</span>);</div>
<div class="line">    <span class="keywordflow">return</span>(0);</div>
<div class="line">  }</div>
<div class="line"></div>
<div class="line">  printf(<span class="stringliteral">&quot;Reading solver.inp.\n&quot;</span>);</div>
<div class="line">  inputs = fopen(<span class="stringliteral">&quot;solver.inp&quot;</span>,<span class="stringliteral">&quot;r&quot;</span>);</div>
<div class="line">  <span class="keywordflow">if</span> (!inputs) {</div>
<div class="line">    fprintf(stderr,<span class="stringliteral">&quot;Error: File \&quot;solver.inp\&quot; not found.\n&quot;</span>);</div>
<div class="line">    <span class="keywordflow">return</span>(1);</div>
<div class="line">  } <span class="keywordflow">else</span> {</div>
<div class="line">      <span class="keywordtype">char</span> word[100];</div>
<div class="line">    fscanf(inputs,<span class="stringliteral">&quot;%s&quot;</span>,word);</div>
<div class="line">    <span class="keywordflow">if</span> (!strcmp(word, <span class="stringliteral">&quot;begin&quot;</span>)){</div>
<div class="line">        <span class="keywordflow">while</span> (strcmp(word, <span class="stringliteral">&quot;end&quot;</span>)){</div>
<div class="line">            fscanf(inputs,<span class="stringliteral">&quot;%s&quot;</span>,word);</div>
<div class="line">            <span class="keywordflow">if</span>      (!strcmp(word, <span class="stringliteral">&quot;op_file_format&quot;</span>   ))  fscanf(inputs,<span class="stringliteral">&quot;%s&quot;</span> ,op_file_format);</div>
<div class="line">            <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcmp(word, <span class="stringliteral">&quot;op_overwrite&quot;</span>     ))  fscanf(inputs,<span class="stringliteral">&quot;%s&quot;</span> ,overwrite      );</div>
<div class="line">      }</div>
<div class="line">    }</div>
<div class="line">    fclose(inputs);</div>
<div class="line">  }</div>
<div class="line">  <span class="keywordflow">if</span> (strcmp(op_file_format,<span class="stringliteral">&quot;binary&quot;</span>) &amp;&amp; strcmp(op_file_format,<span class="stringliteral">&quot;bin&quot;</span>)) {</div>
<div class="line">    printf(<span class="stringliteral">&quot;Error: solution output needs to be in binary files.\n&quot;</span>);</div>
<div class="line">    <span class="keywordflow">return</span>(0);</div>
<div class="line">  }</div>
<div class="line"></div>
<div class="line">  Parameters params;</div>
<div class="line">  <span class="comment">/* default values */</span></div>
<div class="line">  params.grav_x   = 0.0;</div>
<div class="line">  params.grav_y   = 9.8;</div>
<div class="line">  params.R        = 287.058;</div>
<div class="line">  params.gamma    = 1.4;</div>
<div class="line">  params.P_ref    = 100000.0;</div>
<div class="line">  params.rho_ref  = 100000.0 / (params.R * 300.0);</div>
<div class="line">  params.HB       = 0;</div>
<div class="line">  <span class="comment">/* read these parameters from file */</span></div>
<div class="line">  printf(<span class="stringliteral">&quot;Reading physics.inp.\n&quot;</span>);</div>
<div class="line">  inputs = fopen(<span class="stringliteral">&quot;physics.inp&quot;</span>,<span class="stringliteral">&quot;r&quot;</span>);</div>
<div class="line">  <span class="keywordflow">if</span> (!inputs) {</div>
<div class="line">    fprintf(stderr,<span class="stringliteral">&quot;Error: File \&quot;physics.inp\&quot; not found.\n&quot;</span>);</div>
<div class="line">    <span class="keywordflow">return</span>(1);</div>
<div class="line">  } <span class="keywordflow">else</span> {</div>
<div class="line">      <span class="keywordtype">char</span> word[100];</div>
<div class="line">    fscanf(inputs,<span class="stringliteral">&quot;%s&quot;</span>,word);</div>
<div class="line">    <span class="keywordflow">if</span> (!strcmp(word, <span class="stringliteral">&quot;begin&quot;</span>)){</div>
<div class="line">        <span class="keywordflow">while</span> (strcmp(word, <span class="stringliteral">&quot;end&quot;</span>)){</div>
<div class="line">            fscanf(inputs,<span class="stringliteral">&quot;%s&quot;</span>,word);</div>
<div class="line">            <span class="keywordflow">if</span>      (!strcmp(word, <span class="stringliteral">&quot;gamma&quot;</span>))    fscanf(inputs,<span class="stringliteral">&quot;%lf&quot;</span>,&amp;params.gamma);</div>
<div class="line">            <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcmp(word, <span class="stringliteral">&quot;gravity&quot;</span>)) {</div>
<div class="line">          fscanf(inputs,<span class="stringliteral">&quot;%lf&quot;</span>,&amp;params.grav_x);</div>
<div class="line">          fscanf(inputs,<span class="stringliteral">&quot;%lf&quot;</span>,&amp;params.grav_y);</div>
<div class="line">        } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcmp(word,<span class="stringliteral">&quot;p_ref&quot;</span>))   fscanf(inputs,<span class="stringliteral">&quot;%lf&quot;</span>,&amp;params.P_ref);</div>
<div class="line">        <span class="keywordflow">else</span> <span class="keywordflow">if</span>   (!strcmp(word,<span class="stringliteral">&quot;rho_ref&quot;</span>)) fscanf(inputs,<span class="stringliteral">&quot;%lf&quot;</span>,&amp;params.rho_ref);</div>
<div class="line">        <span class="keywordflow">else</span> <span class="keywordflow">if</span>   (!strcmp(word,<span class="stringliteral">&quot;HB&quot;</span>))      fscanf(inputs,<span class="stringliteral">&quot;%d&quot;</span>,&amp;params.HB);</div>
<div class="line">      }</div>
<div class="line">    }</div>
<div class="line">    fclose(inputs);</div>
<div class="line">  }</div>
<div class="line">  <span class="keywordflow">if</span> (params.HB != 2) {</div>
<div class="line">    printf(<span class="stringliteral">&quot;Error: \&quot;HB\&quot; must be specified as 2 in physics.inp.\n&quot;</span>);</div>
<div class="line">    <span class="keywordflow">return</span>(0);</div>
<div class="line">  }</div>
<div class="line"></div>
<div class="line">  <span class="keywordflow">if</span> (!strcmp(overwrite,<span class="stringliteral">&quot;no&quot;</span>)) {</div>
<div class="line">    strcpy(filename,<span class="stringliteral">&quot;op_00000.bin&quot;</span>);</div>
<div class="line">    <span class="keywordflow">while</span>(1) {</div>
<div class="line">      <span class="comment">/* set filename */</span></div>
<div class="line">      strcpy(tecfile,filename);</div>
<div class="line">      tecfile[9]  = <span class="charliteral">&#39;d&#39;</span>;</div>
<div class="line">      tecfile[10] = <span class="charliteral">&#39;a&#39;</span>;</div>
<div class="line">      tecfile[11] = <span class="charliteral">&#39;t&#39;</span>;</div>
<div class="line">      <span class="keywordtype">int</span> err = PostProcess(filename, tecfile, &amp;params, flag);</div>
<div class="line">      <span class="keywordflow">if</span> (err == -1) {</div>
<div class="line">        printf(<span class="stringliteral">&quot;No more files found. Exiting.\n&quot;</span>);</div>
<div class="line">        <span class="keywordflow">break</span>;</div>
<div class="line">      }</div>
<div class="line">      IncrementFilename(filename);</div>
<div class="line">    }</div>
<div class="line">  } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcmp(overwrite,<span class="stringliteral">&quot;yes&quot;</span>)) {</div>
<div class="line">    strcpy(filename,<span class="stringliteral">&quot;op.bin&quot;</span>);</div>
<div class="line">    <span class="comment">/* set filename */</span></div>
<div class="line">    strcpy(tecfile,filename);</div>
<div class="line">    tecfile[3] = <span class="charliteral">&#39;d&#39;</span>;</div>
<div class="line">    tecfile[4] = <span class="charliteral">&#39;a&#39;</span>;</div>
<div class="line">    tecfile[5] = <span class="charliteral">&#39;t&#39;</span>;</div>
<div class="line">    <span class="keywordtype">int</span> err = PostProcess(filename, tecfile, &amp;params, flag);</div>
<div class="line">    <span class="keywordflow">if</span> (err == -1) {</div>
<div class="line">      printf(<span class="stringliteral">&quot;Error: op.bin not found.\n&quot;</span>);</div>
<div class="line">      <span class="keywordflow">return</span>(0);</div>
<div class="line">    }</div>
<div class="line">  }</div>
<div class="line"></div>
<div class="line">  <span class="keywordflow">return</span>(0);</div>
<div class="line">}</div>
</div><!-- fragment --><p>The following figure shows the potential temperature \(\theta\) along a slice at \(z=500\,{\rm m}\) (plotted in VisIt): </p>
<div class="image">
<img src="Solution_3DNavStok_Bubble.gif" alt="Solution_3DNavStok_Bubble.gif"/>
</div>
<p>Expected screen output: </p>
<div class="fragment"><div class="line"><a class="code" href="a00196.html">HyPar</a> - Parallel (MPI) version with 64 processes</div>
<div class="line">Reading solver inputs from file &quot;solver.inp&quot;.</div>
<div class="line">    No. of dimensions                          : 3</div>
<div class="line">    No. of variables                           : 5</div>
<div class="line">    Domain size                                : 201 201 201 </div>
<div class="line">    Processes along each dimension             : 4 4 4 </div>
<div class="line">    No. of ghosts pts                          : 3</div>
<div class="line">    No. of iter.                               : 20000</div>
<div class="line">    Restart iteration                          : 0</div>
<div class="line">    Time integration scheme                    : rk (ssprk3)</div>
<div class="line">    Spatial discretization scheme (hyperbolic) : weno5</div>
<div class="line">    Split hyperbolic flux term?                : no</div>
<div class="line">    Interpolation type for hyperbolic term     : components</div>
<div class="line">    Spatial discretization type   (parabolic ) : nonconservative-1stage</div>
<div class="line">    Spatial discretization scheme (parabolic ) : 2</div>
<div class="line">    Time Step                                  : 1.000000E-02</div>
<div class="line">    Check for conservation                     : no</div>
<div class="line">    Screen output iterations                   : 200</div>
<div class="line">    File output iterations                     : 2000</div>
<div class="line">    Initial solution file type                 : binary</div>
<div class="line">    Initial solution read mode                 : serial</div>
<div class="line">    Solution file write mode                   : serial</div>
<div class="line">    Solution file format                       : binary</div>
<div class="line">    Overwrite solution file                    : no</div>
<div class="line">    Physical model                             : navierstokes3d</div>
<div class="line">Partitioning domain.</div>
<div class="line">Allocating data arrays.</div>
<div class="line">Reading array from binary file initial.inp (Serial mode).</div>
<div class="line">Volume integral of the initial solution:</div>
<div class="line"> 0:  1.1315344432084937E+09</div>
<div class="line"> 1:  0.0000000000000000E+00</div>
<div class="line"> 2:  0.0000000000000000E+00</div>
<div class="line"> 3:  0.0000000000000000E+00</div>
<div class="line"> 4:  2.3971700067997931E+14</div>
<div class="line">Reading boundary conditions from &quot;boundary.inp&quot;.</div>
<div class="line">  Boundary                      slip-wall:  Along dimension  0 and face +1</div>
<div class="line">  Boundary                      slip-wall:  Along dimension  0 and face -1</div>
<div class="line">  Boundary                      slip-wall:  Along dimension  1 and face +1</div>
<div class="line">  Boundary                      slip-wall:  Along dimension  1 and face -1</div>
<div class="line">  Boundary                      slip-wall:  Along dimension  2 and face +1</div>
<div class="line">  Boundary                      slip-wall:  Along dimension  2 and face -1</div>
<div class="line">6 boundary condition(s) read.</div>
<div class="line">Initializing solvers.</div>
<div class="line">Reading WENO parameters from weno.inp.</div>
<div class="line">Initializing physics. Model = &quot;navierstokes3d&quot;</div>
<div class="line">Reading physical model inputs from file &quot;physics.inp&quot;.</div>
<div class="line">Setting up time integration.</div>
<div class="line">Solving in time (from 0 to 20000 iterations)</div>
<div class="line">Writing solution file op_00000.bin.</div>
<div class="line">Iteration:     200  Time: 2.000E+00  Max CFL: 6.945E-01  Max Diff. No.: -1.000E+00  Norm: 1.0902E-02  </div>
<div class="line">Iteration:     400  Time: 4.000E+00  Max CFL: 6.945E-01  Max Diff. No.: -1.000E+00  Norm: 9.2576E-03  </div>
<div class="line">Iteration:     600  Time: 6.000E+00  Max CFL: 6.945E-01  Max Diff. No.: -1.000E+00  Norm: 8.7706E-03  </div>
<div class="line">Iteration:     800  Time: 8.000E+00  Max CFL: 6.945E-01  Max Diff. No.: -1.000E+00  Norm: 1.1474E-02  </div>
<div class="line">Iteration:    1000  Time: 1.000E+01  Max CFL: 6.945E-01  Max Diff. No.: -1.000E+00  Norm: 1.0926E-02  </div>
<div class="line">Iteration:    1200  Time: 1.200E+01  Max CFL: 6.945E-01  Max Diff. No.: -1.000E+00  Norm: 1.0338E-02  </div>
<div class="line">Iteration:    1400  Time: 1.400E+01  Max CFL: 6.945E-01  Max Diff. No.: -1.000E+00  Norm: 1.2228E-02  </div>
<div class="line">Iteration:    1600  Time: 1.600E+01  Max CFL: 6.945E-01  Max Diff. No.: -1.000E+00  Norm: 1.1628E-02  </div>
<div class="line">Iteration:    1800  Time: 1.800E+01  Max CFL: 6.946E-01  Max Diff. No.: -1.000E+00  Norm: 1.1837E-02  </div>
<div class="line">Iteration:    2000  Time: 2.000E+01  Max CFL: 6.946E-01  Max Diff. No.: -1.000E+00  Norm: 1.1553E-02  </div>
<div class="line">Writing solution file op_00001.bin.</div>
<div class="line">Iteration:    2200  Time: 2.200E+01  Max CFL: 6.946E-01  Max Diff. No.: -1.000E+00  Norm: 1.0333E-02  </div>
<div class="line">Iteration:    2400  Time: 2.400E+01  Max CFL: 6.946E-01  Max Diff. No.: -1.000E+00  Norm: 1.1710E-02  </div>
<div class="line">Iteration:    2600  Time: 2.600E+01  Max CFL: 6.946E-01  Max Diff. No.: -1.000E+00  Norm: 8.4824E-03  </div>
<div class="line">Iteration:    2800  Time: 2.800E+01  Max CFL: 6.946E-01  Max Diff. No.: -1.000E+00  Norm: 1.0401E-02  </div>
<div class="line">Iteration:    3000  Time: 3.000E+01  Max CFL: 6.946E-01  Max Diff. No.: -1.000E+00  Norm: 9.8131E-03  </div>
<div class="line">Iteration:    3200  Time: 3.200E+01  Max CFL: 6.946E-01  Max Diff. No.: -1.000E+00  Norm: 7.4465E-03  </div>
<div class="line">Iteration:    3400  Time: 3.400E+01  Max CFL: 6.946E-01  Max Diff. No.: -1.000E+00  Norm: 8.5672E-03  </div>
<div class="line">Iteration:    3600  Time: 3.600E+01  Max CFL: 6.947E-01  Max Diff. No.: -1.000E+00  Norm: 1.0509E-02  </div>
<div class="line">Iteration:    3800  Time: 3.800E+01  Max CFL: 6.947E-01  Max Diff. No.: -1.000E+00  Norm: 7.2593E-03  </div>
<div class="line">Iteration:    4000  Time: 4.000E+01  Max CFL: 6.947E-01  Max Diff. No.: -1.000E+00  Norm: 1.1689E-02  </div>
<div class="line">Writing solution file op_00002.bin.</div>
<div class="line">Iteration:    4200  Time: 4.200E+01  Max CFL: 6.947E-01  Max Diff. No.: -1.000E+00  Norm: 1.0779E-02  </div>
<div class="line">Iteration:    4400  Time: 4.400E+01  Max CFL: 6.947E-01  Max Diff. No.: -1.000E+00  Norm: 1.0578E-02  </div>
<div class="line">Iteration:    4600  Time: 4.600E+01  Max CFL: 6.948E-01  Max Diff. No.: -1.000E+00  Norm: 1.1789E-02  </div>
<div class="line">Iteration:    4800  Time: 4.800E+01  Max CFL: 6.948E-01  Max Diff. No.: -1.000E+00  Norm: 1.1421E-02  </div>
<div class="line">Iteration:    5000  Time: 5.000E+01  Max CFL: 6.949E-01  Max Diff. No.: -1.000E+00  Norm: 1.1930E-02  </div>
<div class="line">Iteration:    5200  Time: 5.200E+01  Max CFL: 6.949E-01  Max Diff. No.: -1.000E+00  Norm: 1.1638E-02  </div>
<div class="line">Iteration:    5400  Time: 5.400E+01  Max CFL: 6.950E-01  Max Diff. No.: -1.000E+00  Norm: 1.1239E-02  </div>
<div class="line">Iteration:    5600  Time: 5.600E+01  Max CFL: 6.950E-01  Max Diff. No.: -1.000E+00  Norm: 1.0715E-02  </div>
<div class="line">Iteration:    5800  Time: 5.800E+01  Max CFL: 6.951E-01  Max Diff. No.: -1.000E+00  Norm: 9.7812E-03  </div>
<div class="line">Iteration:    6000  Time: 6.000E+01  Max CFL: 6.952E-01  Max Diff. No.: -1.000E+00  Norm: 8.9185E-03  </div>
<div class="line">Writing solution file op_00003.bin.</div>
<div class="line">Iteration:    6200  Time: 6.200E+01  Max CFL: 6.952E-01  Max Diff. No.: -1.000E+00  Norm: 1.1160E-02  </div>
<div class="line">Iteration:    6400  Time: 6.400E+01  Max CFL: 6.953E-01  Max Diff. No.: -1.000E+00  Norm: 7.4901E-03  </div>
<div class="line">Iteration:    6600  Time: 6.600E+01  Max CFL: 6.953E-01  Max Diff. No.: -1.000E+00  Norm: 9.5477E-03  </div>
<div class="line">Iteration:    6800  Time: 6.800E+01  Max CFL: 6.954E-01  Max Diff. No.: -1.000E+00  Norm: 9.6800E-03  </div>
<div class="line">Iteration:    7000  Time: 7.000E+01  Max CFL: 6.954E-01  Max Diff. No.: -1.000E+00  Norm: 8.0774E-03  </div>
<div class="line">Iteration:    7200  Time: 7.200E+01  Max CFL: 6.955E-01  Max Diff. No.: -1.000E+00  Norm: 1.0148E-02  </div>
<div class="line">Iteration:    7400  Time: 7.400E+01  Max CFL: 6.955E-01  Max Diff. No.: -1.000E+00  Norm: 1.1495E-02  </div>
<div class="line">Iteration:    7600  Time: 7.600E+01  Max CFL: 6.956E-01  Max Diff. No.: -1.000E+00  Norm: 1.0026E-02  </div>
<div class="line">Iteration:    7800  Time: 7.800E+01  Max CFL: 6.956E-01  Max Diff. No.: -1.000E+00  Norm: 1.1869E-02  </div>
<div class="line">Iteration:    8000  Time: 8.000E+01  Max CFL: 6.957E-01  Max Diff. No.: -1.000E+00  Norm: 1.1001E-02  </div>
<div class="line">Writing solution file op_00004.bin.</div>
<div class="line">Iteration:    8200  Time: 8.200E+01  Max CFL: 6.957E-01  Max Diff. No.: -1.000E+00  Norm: 1.1812E-02  </div>
<div class="line">Iteration:    8400  Time: 8.400E+01  Max CFL: 6.958E-01  Max Diff. No.: -1.000E+00  Norm: 1.1184E-02  </div>
<div class="line">Iteration:    8600  Time: 8.600E+01  Max CFL: 6.958E-01  Max Diff. No.: -1.000E+00  Norm: 1.1299E-02  </div>
<div class="line">Iteration:    8800  Time: 8.800E+01  Max CFL: 6.959E-01  Max Diff. No.: -1.000E+00  Norm: 1.1730E-02  </div>
<div class="line">Iteration:    9000  Time: 9.000E+01  Max CFL: 6.959E-01  Max Diff. No.: -1.000E+00  Norm: 8.9314E-03  </div>
<div class="line">Iteration:    9200  Time: 9.200E+01  Max CFL: 6.960E-01  Max Diff. No.: -1.000E+00  Norm: 1.0053E-02  </div>
<div class="line">Iteration:    9400  Time: 9.400E+01  Max CFL: 6.960E-01  Max Diff. No.: -1.000E+00  Norm: 9.9710E-03  </div>
<div class="line">Iteration:    9600  Time: 9.600E+01  Max CFL: 6.960E-01  Max Diff. No.: -1.000E+00  Norm: 8.7663E-03  </div>
<div class="line">Iteration:    9800  Time: 9.800E+01  Max CFL: 6.961E-01  Max Diff. No.: -1.000E+00  Norm: 9.2397E-03  </div>
<div class="line">Iteration:   10000  Time: 1.000E+02  Max CFL: 6.961E-01  Max Diff. No.: -1.000E+00  Norm: 1.1179E-02  </div>
<div class="line">Writing solution file op_00005.bin.</div>
<div class="line">Iteration:   10200  Time: 1.020E+02  Max CFL: 6.962E-01  Max Diff. No.: -1.000E+00  Norm: 6.9634E-03  </div>
<div class="line">Iteration:   10400  Time: 1.040E+02  Max CFL: 6.962E-01  Max Diff. No.: -1.000E+00  Norm: 1.0934E-02  </div>
<div class="line">Iteration:   10600  Time: 1.060E+02  Max CFL: 6.962E-01  Max Diff. No.: -1.000E+00  Norm: 1.0509E-02  </div>
<div class="line">Iteration:   10800  Time: 1.080E+02  Max CFL: 6.963E-01  Max Diff. No.: -1.000E+00  Norm: 9.9973E-03  </div>
<div class="line">Iteration:   11000  Time: 1.100E+02  Max CFL: 6.963E-01  Max Diff. No.: -1.000E+00  Norm: 1.1854E-02  </div>
<div class="line">Iteration:   11200  Time: 1.120E+02  Max CFL: 6.963E-01  Max Diff. No.: -1.000E+00  Norm: 1.1314E-02  </div>
<div class="line">Iteration:   11400  Time: 1.140E+02  Max CFL: 6.964E-01  Max Diff. No.: -1.000E+00  Norm: 1.0630E-02  </div>
<div class="line">Iteration:   11600  Time: 1.160E+02  Max CFL: 6.964E-01  Max Diff. No.: -1.000E+00  Norm: 1.1933E-02  </div>
<div class="line">Iteration:   11800  Time: 1.180E+02  Max CFL: 6.964E-01  Max Diff. No.: -1.000E+00  Norm: 1.0585E-02  </div>
<div class="line">Iteration:   12000  Time: 1.200E+02  Max CFL: 6.965E-01  Max Diff. No.: -1.000E+00  Norm: 1.1356E-02  </div>
<div class="line">Writing solution file op_00006.bin.</div>
<div class="line">Iteration:   12200  Time: 1.220E+02  Max CFL: 6.965E-01  Max Diff. No.: -1.000E+00  Norm: 1.0765E-02  </div>
<div class="line">Iteration:   12400  Time: 1.240E+02  Max CFL: 6.965E-01  Max Diff. No.: -1.000E+00  Norm: 8.7541E-03  </div>
<div class="line">Iteration:   12600  Time: 1.260E+02  Max CFL: 6.965E-01  Max Diff. No.: -1.000E+00  Norm: 1.0741E-02  </div>
<div class="line">Iteration:   12800  Time: 1.280E+02  Max CFL: 6.966E-01  Max Diff. No.: -1.000E+00  Norm: 7.8668E-03  </div>
<div class="line">Iteration:   13000  Time: 1.300E+02  Max CFL: 6.966E-01  Max Diff. No.: -1.000E+00  Norm: 9.9230E-03  </div>
<div class="line">Iteration:   13200  Time: 1.320E+02  Max CFL: 6.966E-01  Max Diff. No.: -1.000E+00  Norm: 1.0421E-02  </div>
<div class="line">Iteration:   13400  Time: 1.340E+02  Max CFL: 6.966E-01  Max Diff. No.: -1.000E+00  Norm: 9.6055E-03  </div>
<div class="line">Iteration:   13600  Time: 1.360E+02  Max CFL: 6.966E-01  Max Diff. No.: -1.000E+00  Norm: 9.7125E-03  </div>
<div class="line">Iteration:   13800  Time: 1.380E+02  Max CFL: 6.967E-01  Max Diff. No.: -1.000E+00  Norm: 1.1042E-02  </div>
<div class="line">Iteration:   14000  Time: 1.400E+02  Max CFL: 6.967E-01  Max Diff. No.: -1.000E+00  Norm: 8.9203E-03  </div>
<div class="line">Writing solution file op_00007.bin.</div>
<div class="line">Iteration:   14200  Time: 1.420E+02  Max CFL: 6.967E-01  Max Diff. No.: -1.000E+00  Norm: 1.2056E-02  </div>
<div class="line">Iteration:   14400  Time: 1.440E+02  Max CFL: 6.967E-01  Max Diff. No.: -1.000E+00  Norm: 1.0913E-02  </div>
<div class="line">Iteration:   14600  Time: 1.460E+02  Max CFL: 6.967E-01  Max Diff. No.: -1.000E+00  Norm: 1.0782E-02  </div>
<div class="line">Iteration:   14800  Time: 1.480E+02  Max CFL: 6.967E-01  Max Diff. No.: -1.000E+00  Norm: 1.1767E-02  </div>
<div class="line">Iteration:   15000  Time: 1.500E+02  Max CFL: 6.967E-01  Max Diff. No.: -1.000E+00  Norm: 9.7494E-03  </div>
<div class="line">Iteration:   15200  Time: 1.520E+02  Max CFL: 6.967E-01  Max Diff. No.: -1.000E+00  Norm: 1.1396E-02  </div>
<div class="line">Iteration:   15400  Time: 1.540E+02  Max CFL: 6.968E-01  Max Diff. No.: -1.000E+00  Norm: 1.0354E-02  </div>
<div class="line">Iteration:   15600  Time: 1.560E+02  Max CFL: 6.968E-01  Max Diff. No.: -1.000E+00  Norm: 9.7353E-03  </div>
<div class="line">Iteration:   15800  Time: 1.580E+02  Max CFL: 6.968E-01  Max Diff. No.: -1.000E+00  Norm: 1.0257E-02  </div>
<div class="line">Iteration:   16000  Time: 1.600E+02  Max CFL: 6.968E-01  Max Diff. No.: -1.000E+00  Norm: 9.3197E-03  </div>
<div class="line">Writing solution file op_00008.bin.</div>
<div class="line">Iteration:   16200  Time: 1.620E+02  Max CFL: 6.968E-01  Max Diff. No.: -1.000E+00  Norm: 8.5178E-03  </div>
<div class="line">Iteration:   16400  Time: 1.640E+02  Max CFL: 6.968E-01  Max Diff. No.: -1.000E+00  Norm: 1.0796E-02  </div>
<div class="line">Iteration:   16600  Time: 1.660E+02  Max CFL: 6.968E-01  Max Diff. No.: -1.000E+00  Norm: 9.3926E-03  </div>
<div class="line">Iteration:   16800  Time: 1.680E+02  Max CFL: 6.968E-01  Max Diff. No.: -1.000E+00  Norm: 1.0289E-02  </div>
<div class="line">Iteration:   17000  Time: 1.700E+02  Max CFL: 6.968E-01  Max Diff. No.: -1.000E+00  Norm: 1.0896E-02  </div>
<div class="line">Iteration:   17200  Time: 1.720E+02  Max CFL: 6.968E-01  Max Diff. No.: -1.000E+00  Norm: 1.0072E-02  </div>
<div class="line">Iteration:   17400  Time: 1.740E+02  Max CFL: 6.968E-01  Max Diff. No.: -1.000E+00  Norm: 1.0509E-02  </div>
<div class="line">Iteration:   17600  Time: 1.760E+02  Max CFL: 6.968E-01  Max Diff. No.: -1.000E+00  Norm: 1.1708E-02  </div>
<div class="line">Iteration:   17800  Time: 1.780E+02  Max CFL: 6.968E-01  Max Diff. No.: -1.000E+00  Norm: 1.0457E-02  </div>
<div class="line">Iteration:   18000  Time: 1.800E+02  Max CFL: 6.968E-01  Max Diff. No.: -1.000E+00  Norm: 1.1534E-02  </div>
<div class="line">Writing solution file op_00009.bin.</div>
<div class="line">Iteration:   18200  Time: 1.820E+02  Max CFL: 6.968E-01  Max Diff. No.: -1.000E+00  Norm: 1.0566E-02  </div>
<div class="line">Iteration:   18400  Time: 1.840E+02  Max CFL: 6.968E-01  Max Diff. No.: -1.000E+00  Norm: 9.7589E-03  </div>
<div class="line">Iteration:   18600  Time: 1.860E+02  Max CFL: 6.968E-01  Max Diff. No.: -1.000E+00  Norm: 1.0785E-02  </div>
<div class="line">Iteration:   18800  Time: 1.880E+02  Max CFL: 6.967E-01  Max Diff. No.: -1.000E+00  Norm: 9.8248E-03  </div>
<div class="line">Iteration:   19000  Time: 1.900E+02  Max CFL: 6.967E-01  Max Diff. No.: -1.000E+00  Norm: 1.0260E-02  </div>
<div class="line">Iteration:   19200  Time: 1.920E+02  Max CFL: 6.967E-01  Max Diff. No.: -1.000E+00  Norm: 9.7764E-03  </div>
<div class="line">Iteration:   19400  Time: 1.940E+02  Max CFL: 6.967E-01  Max Diff. No.: -1.000E+00  Norm: 9.4451E-03  </div>
<div class="line">Iteration:   19600  Time: 1.960E+02  Max CFL: 6.967E-01  Max Diff. No.: -1.000E+00  Norm: 9.2906E-03  </div>
<div class="line">Iteration:   19800  Time: 1.980E+02  Max CFL: 6.967E-01  Max Diff. No.: -1.000E+00  Norm: 9.9346E-03  </div>
<div class="line">Iteration:   20000  Time: 2.000E+02  Max CFL: 6.967E-01  Max Diff. No.: -1.000E+00  Norm: 1.0322E-02  </div>
<div class="line">Writing solution file op_00010.bin.</div>
<div class="line">Completed time integration (Final time: 200.000000).</div>
<div class="line">Computed errors:</div>
<div class="line">  L1         Error           : 0.0000000000000000E+00</div>
<div class="line">  L2         Error           : 0.0000000000000000E+00</div>
<div class="line">  Linfinity  Error           : 0.0000000000000000E+00</div>
<div class="line">Conservation Errors:</div>
<div class="line">    0.0000000000000000E+00</div>
<div class="line">    0.0000000000000000E+00</div>
<div class="line">    0.0000000000000000E+00</div>
<div class="line">    0.0000000000000000E+00</div>
<div class="line">    0.0000000000000000E+00</div>
<div class="line">Solver runtime (in seconds): 3.6566252696000003E+04</div>
<div class="line">Total  runtime (in seconds): 3.6567538389000001E+04</div>
<div class="line">Deallocating arrays.</div>
<div class="line">Finished.</div>
</div><!-- fragment --> </div></div><!-- contents -->
</div><!-- doc-content -->
<!-- Start of StatCounter Code for Default Guide -->
<script type="text/javascript">
var sc_project=10897352; 
var sc_invisible=1; 
var sc_security="83042f57"; 
var scJsHost = (("https:" == document.location.protocol) ?
"https://secure." : "http://www.");
document.write("<sc"+"ript type='text/javascript' src='" +
scJsHost+
"statcounter.com/counter/counter.js'></"+"script>");
</script>
<noscript><div class="statcounter"><a title="website
statistics" href="http://statcounter.com/"
target="_blank"><img class="statcounter"
src="//c.statcounter.com/10897352/0/83042f57/1/"
alt="website statistics"></a></div></noscript>
<!-- End of StatCounter Code for Default Guide -->
