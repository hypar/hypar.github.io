<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.5"/>
<title>HyPar: src/MathFunctions/InterpolateGlobalnDVar.c File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script><script src="http://cdn.mathjax.org/mathjax/latest/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="doxygen_html_style.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">HyPar
   &#160;<span id="projectnumber">1.0</span>
   </div>
   <div id="projectbrief">Finite-Difference Hyperbolic-Parabolic PDE Solver on Cartesian Grids</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.5 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Structures</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>Globals</span></a></li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('a00356.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Data Structures</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Namespaces</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Macros</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Pages</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">InterpolateGlobalnDVar.c File Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>Functions to interpolate from one grid to another.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &lt;stdio.h&gt;</code><br/>
<code>#include &lt;stdlib.h&gt;</code><br/>
<code>#include &lt;math.h&gt;</code><br/>
<code>#include &lt;<a class="el" href="a00219_source.html">arrayfunctions.h</a>&gt;</code><br/>
<code>#include &lt;<a class="el" href="a00232_source.html">mathfunctions.h</a>&gt;</code><br/>
</div>
<p><a href="a00356_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:aafd7ccd78e660e79257b36fc5a9453f2"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00356.html#aafd7ccd78e660e79257b36fc5a9453f2">isPowerOfTwo</a> (int x)</td></tr>
<tr class="separator:aafd7ccd78e660e79257b36fc5a9453f2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9d680d590ea7b1a942b880564d70dfd1"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00356.html#a9d680d590ea7b1a942b880564d70dfd1">coarsen1D</a> (const int *const a_dim_src, const int *const a_dim_dst, const double *const a_u_src, double *const a_u_dst, const int a_dir, const int a_nvars, const int a_ngpt, const int a_ndims)</td></tr>
<tr class="separator:a9d680d590ea7b1a942b880564d70dfd1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8fbe3466587deeb3032a24ccfcc3956a"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00356.html#a8fbe3466587deeb3032a24ccfcc3956a">refine1D</a> (const int *const a_dim_src, const int *const a_dim_dst, const double *const a_u_src, double *const a_u_dst, const int a_dir, const int a_nvars, const int a_ngpt, const int a_ndims)</td></tr>
<tr class="separator:a8fbe3466587deeb3032a24ccfcc3956a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a12f68d1438531171b4cc818ac9c53008"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00356.html#a12f68d1438531171b4cc818ac9c53008">InterpolateGlobalnDVar</a> (const int *const a_dim_dst, double **const a_u_dst, const int *const a_dim_src, double *const a_u_src, const int a_nvars, const int a_ghosts, const int a_ndims, const int *const a_periodic)</td></tr>
<tr class="separator:a12f68d1438531171b4cc818ac9c53008"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Functions to interpolate from one grid to another. </p>
<dl class="section author"><dt>Author</dt><dd>Debojyoti Ghosh </dd></dl>

<p>Definition in file <a class="el" href="a00356_source.html">InterpolateGlobalnDVar.c</a>.</p>
</div><h2 class="groupheader">Function Documentation</h2>
<a class="anchor" id="aafd7ccd78e660e79257b36fc5a9453f2"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int isPowerOfTwo </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>x</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Is the input number an integer power of 2? </p>

<p>Definition at line <a class="el" href="a00356_source.html#l00013">13</a> of file <a class="el" href="a00356_source.html">InterpolateGlobalnDVar.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;{</div>
<div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;  <span class="keywordflow">if</span> (x == 0)  <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;</div>
<div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;  <span class="keywordflow">while</span> (x &gt; 1) {</div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;    <span class="keywordflow">if</span> (x%2 != 0) <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;    x /= 2;</div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;  }</div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;  <span class="keywordflow">return</span> 1;</div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a9d680d590ea7b1a942b880564d70dfd1"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int coarsen1D </td>
          <td>(</td>
          <td class="paramtype">const int *const&#160;</td>
          <td class="paramname"><em>a_dim_src</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int *const&#160;</td>
          <td class="paramname"><em>a_dim_dst</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double *const&#160;</td>
          <td class="paramname"><em>a_u_src</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *const&#160;</td>
          <td class="paramname"><em>a_u_dst</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>a_dir</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>a_nvars</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>a_ngpt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>a_ndims</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Coarsen along a given dimension - the source and destination must have the same sizes along all other dimensions.</p>
<p>Note that the arrays must <em>not</em> have any ghost points!</p>
<p>Currently this function can only handle coarsening factors that are integer powers of 2. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">a_dim_src</td><td>Grid size of source data </td></tr>
    <tr><td class="paramname">a_dim_dst</td><td>Grid size of destination data </td></tr>
    <tr><td class="paramname">a_u_src</td><td>Source solution </td></tr>
    <tr><td class="paramname">a_u_dst</td><td>Destination solution </td></tr>
    <tr><td class="paramname">a_dir</td><td>Dimension along which to coarsen </td></tr>
    <tr><td class="paramname">a_nvars</td><td>Number of vector components of the solution </td></tr>
    <tr><td class="paramname">a_ngpt</td><td>Number of ghost points </td></tr>
    <tr><td class="paramname">a_ndims</td><td>Number of spatial dimensions </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="a00356_source.html#l00032">32</a> of file <a class="el" href="a00356_source.html">InterpolateGlobalnDVar.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;{</div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> d = 0; d &lt; a_ndims; d++) {</div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;    <span class="keywordflow">if</span> ((d != a_dir) &amp;&amp; (a_dim_src[d] != a_dim_dst[d])) {</div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;      fprintf(stderr, <span class="stringliteral">&quot;Error in coarsen1D() -\n&quot;</span>);</div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;      fprintf(stderr, <span class="stringliteral">&quot; a_dim_src[%d] != a_dim_dst[%d]\n&quot;</span>, d, d);</div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;      <span class="keywordflow">return</span> 1;</div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;    }</div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;  }</div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;</div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;  <span class="keywordtype">int</span> n_src = a_dim_src[a_dir];</div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;  <span class="keywordtype">int</span> n_dst = a_dim_dst[a_dir];</div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;  <span class="keywordflow">if</span> (n_dst &gt; n_src) {</div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;    fprintf(stderr, <span class="stringliteral">&quot;Error in coarsen1D() -\n&quot;</span>);</div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;    fprintf(stderr, <span class="stringliteral">&quot; destination grid is finer than source grid along a_dir!\n&quot;</span>);</div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;    <span class="keywordflow">return</span> 1;</div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;  }</div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;</div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;  <span class="keywordtype">double</span> fac = ((double) n_src) / ((double) n_dst);</div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;  <span class="keywordtype">int</span> stride = (int) fac;</div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="a00231.html#adf1be5ccbb7a2522b4f3a64043c72880">absolute</a>(((<span class="keywordtype">double</span>)stride)-fac) &gt; <a class="code" href="a00220.html#abfd977805f9104d0141377f9b4ac954e">_MACHINE_ZERO_</a>) {</div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;    fprintf(stderr, <span class="stringliteral">&quot;Error in coarsen1D() -\n&quot;</span>);</div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;    fprintf(stderr, <span class="stringliteral">&quot;  non-integer coarsening factor!\n&quot;</span>);</div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;    <span class="keywordflow">return</span> 1;</div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;  }</div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;</div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;  <span class="comment">/* set interpolation coefficients depending on desired order */</span></div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;  <span class="keywordtype">double</span> c0, c1, c2, c3, c4, c5;</div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;<span class="comment">//  if (a_interp_order == 2) {</span></div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;<span class="comment">//    c0 = c5 = 0.0;</span></div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;<span class="comment">//    c1 = c4 = 0.0;</span></div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;<span class="comment">//    c2 = c3 = 0.5;</span></div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;<span class="comment">//  } else if (a_interp_order == 4) {</span></div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;<span class="comment">//    c0 = c5 = 0.0;</span></div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;<span class="comment">//    c1 = c4 = -1.0/16.0;</span></div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;<span class="comment">//    c2 = c3 = 9.0/16.0;</span></div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;<span class="comment">//  } else if (a_interp_order == 6) {</span></div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;    c0 = c5 = 3.0/256.0;</div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;    c1 = c4 = -25.0/256.0;</div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;    c2 = c3 = 150.0/256.0;</div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;<span class="comment">//  } else {</span></div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;<span class="comment">//    fprintf(stderr,&quot;Invalid value of interpolation order!\n&quot;);</span></div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;<span class="comment">//    return 1;</span></div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;<span class="comment">//  }</span></div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;</div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;  <span class="comment">/* create bounds for the transverse loop, i.e., to loop over </span></div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;<span class="comment">   * all 1D lines along dimension &quot;a_dir&quot; */</span></div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;  <span class="keywordtype">int</span> bounds_transverse[a_ndims];</div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;  <a class="code" href="a00219.html#a89e8330d9e06dd0666c50833628a125c">_ArrayCopy1D_</a>(a_dim_src, bounds_transverse, a_ndims); </div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;  bounds_transverse[a_dir] =  1;</div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;</div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;  <span class="keywordtype">int</span> index_transverse[a_ndims], done = 0;</div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;  <a class="code" href="a00219.html#a2b2826031c0cd92495ab351d3e599fc5">_ArraySetValue_</a>(index_transverse, a_ndims, 0);</div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;  <span class="keywordflow">while</span> (!done) {</div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;</div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;    <span class="keywordtype">int</span> index_dst[a_ndims], index_src[a_ndims];</div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;    <a class="code" href="a00219.html#a89e8330d9e06dd0666c50833628a125c">_ArrayCopy1D_</a>(index_transverse, index_dst, a_ndims);</div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;    <a class="code" href="a00219.html#a89e8330d9e06dd0666c50833628a125c">_ArrayCopy1D_</a>(index_transverse, index_src, a_ndims);</div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;</div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i_dst = 0; i_dst &lt; n_dst; i_dst++) {</div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;</div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;      <span class="keywordtype">int</span> i_m1 = i_dst*stride + (stride/2-1);</div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;      <span class="keywordtype">int</span> i_m3 = i_m1 - 2;</div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;      <span class="keywordtype">int</span> i_m2 = i_m1 - 1;</div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;      <span class="keywordtype">int</span> i_p1 = i_m1 + 1;</div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;      <span class="keywordtype">int</span> i_p2 = i_m1 + 2;</div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;      <span class="keywordtype">int</span> i_p3 = i_m1 + 3;</div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;</div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;      <span class="keywordtype">int</span> p;</div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;      index_dst[a_dir] = i_dst;</div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;      <a class="code" href="a00219.html#afbb862a2fdf5b72b1f9ace42f64b556f">_ArrayIndex1D_</a>(a_ndims, a_dim_dst, index_dst, a_ngpt, p);</div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;</div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;      <span class="keywordtype">int</span> p_m3;</div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;      index_src[a_dir] = i_m3;</div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;      <a class="code" href="a00219.html#afbb862a2fdf5b72b1f9ace42f64b556f">_ArrayIndex1D_</a>(a_ndims, a_dim_src, index_src, a_ngpt, p_m3);</div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;</div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;      <span class="keywordtype">int</span> p_m2;</div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;      index_src[a_dir] = i_m2;</div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;      <a class="code" href="a00219.html#afbb862a2fdf5b72b1f9ace42f64b556f">_ArrayIndex1D_</a>(a_ndims, a_dim_src, index_src, a_ngpt, p_m2);</div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;</div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;      <span class="keywordtype">int</span> p_m1;</div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;      index_src[a_dir] = i_m1;</div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;      <a class="code" href="a00219.html#afbb862a2fdf5b72b1f9ace42f64b556f">_ArrayIndex1D_</a>(a_ndims, a_dim_src, index_src, a_ngpt, p_m1);</div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;</div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;      <span class="keywordtype">int</span> p_p1;</div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;      index_src[a_dir] = i_p1;</div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;      <a class="code" href="a00219.html#afbb862a2fdf5b72b1f9ace42f64b556f">_ArrayIndex1D_</a>(a_ndims, a_dim_src, index_src, a_ngpt, p_p1);</div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;</div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;      <span class="keywordtype">int</span> p_p2;</div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;      index_src[a_dir] = i_p2;</div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;      <a class="code" href="a00219.html#afbb862a2fdf5b72b1f9ace42f64b556f">_ArrayIndex1D_</a>(a_ndims, a_dim_src, index_src, a_ngpt, p_p2);</div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;</div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;      <span class="keywordtype">int</span> p_p3;</div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;      index_src[a_dir] = i_p3;</div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;      <a class="code" href="a00219.html#afbb862a2fdf5b72b1f9ace42f64b556f">_ArrayIndex1D_</a>(a_ndims, a_dim_src, index_src, a_ngpt, p_p3);</div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;</div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> v = 0; v &lt; a_nvars; v++) {</div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;        <span class="keywordtype">double</span> val =    c0 * a_u_src[p_m3*a_nvars+v]</div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;                      + c1 * a_u_src[p_m2*a_nvars+v] </div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;                      + c2 * a_u_src[p_m1*a_nvars+v] </div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;                      + c3 * a_u_src[p_p1*a_nvars+v] </div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;                      + c4 * a_u_src[p_p2*a_nvars+v] </div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;                      + c5 * a_u_src[p_p3*a_nvars+v];</div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;        a_u_dst[p*a_nvars+v] = val;</div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;      }</div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;</div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;    }</div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;</div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;    <a class="code" href="a00219.html#ac5ec1371623f11d03b0f42adaa24acbc">_ArrayIncrementIndex_</a>(a_ndims, bounds_transverse, index_transverse, done);</div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;  </div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;  }</div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;</div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;  <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;}</div>
<div class="ttc" id="a00219_html_ac5ec1371623f11d03b0f42adaa24acbc"><div class="ttname"><a href="a00219.html#ac5ec1371623f11d03b0f42adaa24acbc">_ArrayIncrementIndex_</a></div><div class="ttdeci">#define _ArrayIncrementIndex_(N, imax, i, done)</div><div class="ttdef"><b>Definition:</b> <a href="a00219_source.html#l00125">arrayfunctions.h:125</a></div></div>
<div class="ttc" id="a00231_html_adf1be5ccbb7a2522b4f3a64043c72880"><div class="ttname"><a href="a00231.html#adf1be5ccbb7a2522b4f3a64043c72880">absolute</a></div><div class="ttdeci">#define absolute(a)</div><div class="ttdef"><b>Definition:</b> <a href="a00231_source.html#l00032">math_ops.h:32</a></div></div>
<div class="ttc" id="a00219_html_a2b2826031c0cd92495ab351d3e599fc5"><div class="ttname"><a href="a00219.html#a2b2826031c0cd92495ab351d3e599fc5">_ArraySetValue_</a></div><div class="ttdeci">#define _ArraySetValue_(x, size, value)</div><div class="ttdef"><b>Definition:</b> <a href="a00219_source.html#l00168">arrayfunctions.h:168</a></div></div>
<div class="ttc" id="a00220_html_abfd977805f9104d0141377f9b4ac954e"><div class="ttname"><a href="a00220.html#abfd977805f9104d0141377f9b4ac954e">_MACHINE_ZERO_</a></div><div class="ttdeci">#define _MACHINE_ZERO_</div><div class="ttdef"><b>Definition:</b> <a href="a00220_source.html#l00022">basic.h:22</a></div></div>
<div class="ttc" id="a00219_html_afbb862a2fdf5b72b1f9ace42f64b556f"><div class="ttname"><a href="a00219.html#afbb862a2fdf5b72b1f9ace42f64b556f">_ArrayIndex1D_</a></div><div class="ttdeci">#define _ArrayIndex1D_(N, imax, i, ghost, index)</div><div class="ttdef"><b>Definition:</b> <a href="a00219_source.html#l00039">arrayfunctions.h:39</a></div></div>
<div class="ttc" id="a00219_html_a89e8330d9e06dd0666c50833628a125c"><div class="ttname"><a href="a00219.html#a89e8330d9e06dd0666c50833628a125c">_ArrayCopy1D_</a></div><div class="ttdeci">#define _ArrayCopy1D_(x, y, size)</div><div class="ttdef"><b>Definition:</b> <a href="a00219_source.html#l00318">arrayfunctions.h:318</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a8fbe3466587deeb3032a24ccfcc3956a"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int refine1D </td>
          <td>(</td>
          <td class="paramtype">const int *const&#160;</td>
          <td class="paramname"><em>a_dim_src</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int *const&#160;</td>
          <td class="paramname"><em>a_dim_dst</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double *const&#160;</td>
          <td class="paramname"><em>a_u_src</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *const&#160;</td>
          <td class="paramname"><em>a_u_dst</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>a_dir</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>a_nvars</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>a_ngpt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>a_ndims</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Refine along a given dimension - the source and destination must have the same sizes along all other dimensions.</p>
<p>Note that the arrays must <em>not</em> have any ghost points!</p>
<p>Currently this function can only handle refinement factors that are integer powers of 2. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">a_dim_src</td><td>Grid size of source data </td></tr>
    <tr><td class="paramname">a_dim_dst</td><td>Grid size of destination data </td></tr>
    <tr><td class="paramname">a_u_src</td><td>Source solution </td></tr>
    <tr><td class="paramname">a_u_dst</td><td>Destination solution </td></tr>
    <tr><td class="paramname">a_dir</td><td>Dimension along which to coarsen </td></tr>
    <tr><td class="paramname">a_nvars</td><td>Number of vector components of the solution </td></tr>
    <tr><td class="paramname">a_ngpt</td><td>Number of ghost points </td></tr>
    <tr><td class="paramname">a_ndims</td><td>Number of spatial dimensions </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="a00356_source.html#l00163">163</a> of file <a class="el" href="a00356_source.html">InterpolateGlobalnDVar.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;{</div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> d = 0; d &lt; a_ndims; d++) {</div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;    <span class="keywordflow">if</span> ((d != a_dir) &amp;&amp; (a_dim_src[d] != a_dim_dst[d])) {</div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;      fprintf(stderr, <span class="stringliteral">&quot;Error in refine1D() -\n&quot;</span>);</div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;      fprintf(stderr, <span class="stringliteral">&quot; a_dim_src[%d] != a_dim_dst[%d]\n&quot;</span>, d, d);</div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;      <span class="keywordflow">return</span> 1;</div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;    }</div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;  }</div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;</div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;  <span class="keywordtype">int</span> n_src = a_dim_src[a_dir];</div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;  <span class="keywordtype">int</span> n_dst = a_dim_dst[a_dir];</div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;  <span class="keywordflow">if</span> (n_dst &lt; n_src) {</div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;    fprintf(stderr, <span class="stringliteral">&quot;Error in refine1D() -\n&quot;</span>);</div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;    fprintf(stderr, <span class="stringliteral">&quot;  destination grid is coarser than source grid along a_dir!\n&quot;</span>);</div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;    <span class="keywordflow">return</span> 1;</div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;  }</div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;</div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;  <span class="keywordtype">double</span> fac = ((double) n_dst) / ((double) n_src);</div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;  <span class="keywordtype">int</span> stride = (int) fac;</div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="a00231.html#adf1be5ccbb7a2522b4f3a64043c72880">absolute</a>(((<span class="keywordtype">double</span>)stride)-fac) &gt; <a class="code" href="a00220.html#abfd977805f9104d0141377f9b4ac954e">_MACHINE_ZERO_</a>) {</div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;    fprintf(stderr, <span class="stringliteral">&quot;Error in refine1D() -\n&quot;</span>);</div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;    fprintf(stderr, <span class="stringliteral">&quot;  non-integer refinement factor!\n&quot;</span>);</div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;    <span class="keywordflow">return</span> 1;</div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;  }</div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;</div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;  <span class="comment">/* create bounds for the transverse loop, i.e., to loop over </span></div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;<span class="comment">   * all 1D lines along dimension &quot;a_dir&quot; */</span></div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;  <span class="keywordtype">int</span> bounds_transverse[a_ndims];</div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;  <a class="code" href="a00219.html#a89e8330d9e06dd0666c50833628a125c">_ArrayCopy1D_</a>(a_dim_src, bounds_transverse, a_ndims); </div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;  bounds_transverse[a_dir] =  1;</div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;</div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;  <span class="keywordtype">int</span> index_transverse[a_ndims], done = 0;</div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;  <a class="code" href="a00219.html#a2b2826031c0cd92495ab351d3e599fc5">_ArraySetValue_</a>(index_transverse, a_ndims, 0);</div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;  <span class="keywordflow">while</span> (!done) {</div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;</div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;    <span class="keywordtype">int</span> index_dst [a_ndims], </div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;        index_src0[a_ndims], </div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;        index_src1[a_ndims], </div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;        index_src2[a_ndims],</div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;        index_src3[a_ndims],</div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;        index_src4[a_ndims],</div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;        index_src5[a_ndims];</div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;    <a class="code" href="a00219.html#a89e8330d9e06dd0666c50833628a125c">_ArrayCopy1D_</a>(index_transverse, index_dst , a_ndims);</div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;    <a class="code" href="a00219.html#a89e8330d9e06dd0666c50833628a125c">_ArrayCopy1D_</a>(index_transverse, index_src0, a_ndims);</div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;    <a class="code" href="a00219.html#a89e8330d9e06dd0666c50833628a125c">_ArrayCopy1D_</a>(index_transverse, index_src1, a_ndims);</div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;    <a class="code" href="a00219.html#a89e8330d9e06dd0666c50833628a125c">_ArrayCopy1D_</a>(index_transverse, index_src2, a_ndims);</div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;    <a class="code" href="a00219.html#a89e8330d9e06dd0666c50833628a125c">_ArrayCopy1D_</a>(index_transverse, index_src3, a_ndims);</div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;    <a class="code" href="a00219.html#a89e8330d9e06dd0666c50833628a125c">_ArrayCopy1D_</a>(index_transverse, index_src4, a_ndims);</div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;    <a class="code" href="a00219.html#a89e8330d9e06dd0666c50833628a125c">_ArrayCopy1D_</a>(index_transverse, index_src5, a_ndims);</div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;</div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i_dst = 0; i_dst &lt; n_dst; i_dst++) {</div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;</div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;      <span class="keywordtype">double</span> xi_dst = ((double) i_dst + 0.5) / ((double) stride) - 0.5;</div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;</div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;      <span class="keywordtype">int</span> i_src_2  = floor(xi_dst);</div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;      <span class="keywordtype">int</span> i_src_3  = ceil(xi_dst);</div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;      <span class="keywordtype">int</span> i_src_0 = i_src_2 - 2;</div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;      <span class="keywordtype">int</span> i_src_1 = i_src_2 - 1;</div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;      <span class="keywordtype">int</span> i_src_4 = i_src_3 + 1;</div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;      <span class="keywordtype">int</span> i_src_5 = i_src_3 + 2;</div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;</div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;      <span class="keywordtype">double</span> alpha = (xi_dst - (double)i_src_2) / ((double)i_src_3 - (<span class="keywordtype">double</span>)i_src_2);</div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;</div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;      index_dst[a_dir] = i_dst;</div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;      <span class="keywordtype">int</span> p; <a class="code" href="a00219.html#afbb862a2fdf5b72b1f9ace42f64b556f">_ArrayIndex1D_</a>(a_ndims, a_dim_dst, index_dst, a_ngpt, p);</div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;</div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;      index_src0[a_dir] = i_src_0;</div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;      <span class="keywordtype">int</span> q0; <a class="code" href="a00219.html#afbb862a2fdf5b72b1f9ace42f64b556f">_ArrayIndex1D_</a>(a_ndims, a_dim_src, index_src0, a_ngpt, q0);</div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;</div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;      index_src1[a_dir] = i_src_1;</div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;      <span class="keywordtype">int</span> q1; <a class="code" href="a00219.html#afbb862a2fdf5b72b1f9ace42f64b556f">_ArrayIndex1D_</a>(a_ndims, a_dim_src, index_src1, a_ngpt, q1);</div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;</div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;      index_src2[a_dir] = i_src_2;</div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;      <span class="keywordtype">int</span> q2; <a class="code" href="a00219.html#afbb862a2fdf5b72b1f9ace42f64b556f">_ArrayIndex1D_</a>(a_ndims, a_dim_src, index_src2, a_ngpt, q2);</div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;</div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;      index_src3[a_dir] = i_src_3;</div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;      <span class="keywordtype">int</span> q3; <a class="code" href="a00219.html#afbb862a2fdf5b72b1f9ace42f64b556f">_ArrayIndex1D_</a>(a_ndims, a_dim_src, index_src3, a_ngpt, q3);</div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;</div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;      index_src4[a_dir] = i_src_4;</div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;      <span class="keywordtype">int</span> q4; <a class="code" href="a00219.html#afbb862a2fdf5b72b1f9ace42f64b556f">_ArrayIndex1D_</a>(a_ndims, a_dim_src, index_src4, a_ngpt, q4);</div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;</div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;      index_src5[a_dir] = i_src_5;</div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;      <span class="keywordtype">int</span> q5; <a class="code" href="a00219.html#afbb862a2fdf5b72b1f9ace42f64b556f">_ArrayIndex1D_</a>(a_ndims, a_dim_src, index_src5, a_ngpt, q5);</div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;</div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;      <span class="comment">/* set interpolation coefficients depending on desired order */</span></div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;      <span class="keywordtype">double</span> c0, c1, c2, c3, c4, c5;</div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;<span class="comment">//      if (a_interp_order == 2) {</span></div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;<span class="comment">//        c0 = 0.0;</span></div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;<span class="comment">//        c1 = 0.0;</span></div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;<span class="comment">//        c2 = (1.0-alpha);</span></div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;<span class="comment">//        c3 = alpha;</span></div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;<span class="comment">//        c4 = 0.0;</span></div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;<span class="comment">//        c5 = 0.0;</span></div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;<span class="comment">//      } else if (a_interp_order == 4) {</span></div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;<span class="comment">//        c0 = 0.0;</span></div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;<span class="comment">//        c1 = -((-2.0 + alpha)*(-1.0 + alpha)*alpha)/6.0;</span></div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;<span class="comment">//        c2 = ((-2.0 + alpha)*(-1.0 + alpha)*(1.0 + alpha))/2.0;</span></div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;<span class="comment">//        c3 = (alpha*(2.0 + alpha - alpha*alpha))/2.0;</span></div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;<span class="comment">//        c4 = (alpha*(-1.0 + alpha*alpha))/6.0;</span></div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;<span class="comment">//        c5 = 0.0;</span></div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;<span class="comment">//      } else if (a_interp_order == 6) {</span></div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;        c0 = -((-3.0 + alpha)*(-2.0 + alpha)*(-1.0 + alpha)*alpha*(1.0 + alpha))/120.0;</div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;        c1 = ((-3.0 + alpha)*(-2.0 + alpha)*(-1.0 + alpha)*alpha*(2.0 + alpha))/24.0;</div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;        c2 = -((-3.0 + alpha)*(-2.0 + alpha)*(-1.0 + alpha)*(1.0 + alpha)*(2.0 + alpha))/12.0;</div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;        c3 = ((-3.0 + alpha)*(-2.0 + alpha)*alpha*(1.0 + alpha)*(2.0 + alpha))/12.0;</div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;        c4 = -((-3.0 + alpha)*(-1.0 + alpha)*alpha*(1.0 + alpha)*(2.0 + alpha))/24.0;</div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;        c5 = (alpha*(4.0 - 5.0*alpha*alpha + alpha*alpha*alpha*alpha))/120.0;</div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;<span class="comment">//      } else {</span></div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;<span class="comment">//        fprintf(stderr,&quot;Invalid value of interpolation order!\n&quot;);</span></div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;<span class="comment">//        return 1;</span></div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;<span class="comment">//      }</span></div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;</div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> v = 0; v &lt; a_nvars; v++) {</div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;</div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;        a_u_dst[p*a_nvars+v] =    c0 * a_u_src[q0*a_nvars+v]</div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;                                + c1 * a_u_src[q1*a_nvars+v]</div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;                                + c2 * a_u_src[q2*a_nvars+v]</div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;                                + c3 * a_u_src[q3*a_nvars+v]</div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;                                + c4 * a_u_src[q4*a_nvars+v]</div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;                                + c5 * a_u_src[q5*a_nvars+v];</div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;</div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;      }</div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;</div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;    }</div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;</div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;    <a class="code" href="a00219.html#ac5ec1371623f11d03b0f42adaa24acbc">_ArrayIncrementIndex_</a>(a_ndims, bounds_transverse, index_transverse, done);</div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;  </div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;  }</div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;</div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;  <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;}</div>
<div class="ttc" id="a00219_html_ac5ec1371623f11d03b0f42adaa24acbc"><div class="ttname"><a href="a00219.html#ac5ec1371623f11d03b0f42adaa24acbc">_ArrayIncrementIndex_</a></div><div class="ttdeci">#define _ArrayIncrementIndex_(N, imax, i, done)</div><div class="ttdef"><b>Definition:</b> <a href="a00219_source.html#l00125">arrayfunctions.h:125</a></div></div>
<div class="ttc" id="a00231_html_adf1be5ccbb7a2522b4f3a64043c72880"><div class="ttname"><a href="a00231.html#adf1be5ccbb7a2522b4f3a64043c72880">absolute</a></div><div class="ttdeci">#define absolute(a)</div><div class="ttdef"><b>Definition:</b> <a href="a00231_source.html#l00032">math_ops.h:32</a></div></div>
<div class="ttc" id="a00219_html_a2b2826031c0cd92495ab351d3e599fc5"><div class="ttname"><a href="a00219.html#a2b2826031c0cd92495ab351d3e599fc5">_ArraySetValue_</a></div><div class="ttdeci">#define _ArraySetValue_(x, size, value)</div><div class="ttdef"><b>Definition:</b> <a href="a00219_source.html#l00168">arrayfunctions.h:168</a></div></div>
<div class="ttc" id="a00220_html_abfd977805f9104d0141377f9b4ac954e"><div class="ttname"><a href="a00220.html#abfd977805f9104d0141377f9b4ac954e">_MACHINE_ZERO_</a></div><div class="ttdeci">#define _MACHINE_ZERO_</div><div class="ttdef"><b>Definition:</b> <a href="a00220_source.html#l00022">basic.h:22</a></div></div>
<div class="ttc" id="a00219_html_afbb862a2fdf5b72b1f9ace42f64b556f"><div class="ttname"><a href="a00219.html#afbb862a2fdf5b72b1f9ace42f64b556f">_ArrayIndex1D_</a></div><div class="ttdeci">#define _ArrayIndex1D_(N, imax, i, ghost, index)</div><div class="ttdef"><b>Definition:</b> <a href="a00219_source.html#l00039">arrayfunctions.h:39</a></div></div>
<div class="ttc" id="a00219_html_a89e8330d9e06dd0666c50833628a125c"><div class="ttname"><a href="a00219.html#a89e8330d9e06dd0666c50833628a125c">_ArrayCopy1D_</a></div><div class="ttdeci">#define _ArrayCopy1D_(x, y, size)</div><div class="ttdef"><b>Definition:</b> <a href="a00219_source.html#l00318">arrayfunctions.h:318</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a12f68d1438531171b4cc818ac9c53008"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int InterpolateGlobalnDVar </td>
          <td>(</td>
          <td class="paramtype">const int *const&#160;</td>
          <td class="paramname"><em>a_dim_dst</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double **const&#160;</td>
          <td class="paramname"><em>a_u_dst</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int *const&#160;</td>
          <td class="paramname"><em>a_dim_src</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *const&#160;</td>
          <td class="paramname"><em>a_u_src</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>a_nvars</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>a_ghosts</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>a_ndims</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int *const&#160;</td>
          <td class="paramname"><em>a_periodic</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Interpolate n-dimensional data from one grid to another of a desired resolution. Note that along each dimension, the ratio of the number of grid points in the source grid and that in the destination grid must be an integer power of 2 (negative or positive).</p>
<p>The source data <em>must</em> be global. It will get deallocated at the end of this function. It <em>must</em> have the appropriate number of ghost points.</p>
<p>The incoming pointer for destination data must be NULL. After this function is executed, it will point to a chunk of memory with the interpolated solution. This is the <em>global</em> solution. It will have the specified number of ghost points appropriately filled. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">a_dim_dst</td><td>grid dimensions to interpolate to </td></tr>
    <tr><td class="paramname">a_u_dst</td><td>pointer to array containing interpolated data </td></tr>
    <tr><td class="paramname">a_dim_src</td><td>grid dimensions to interpolate from </td></tr>
    <tr><td class="paramname">a_u_src</td><td>pointer to array containing data to interpolate from </td></tr>
    <tr><td class="paramname">a_nvars</td><td>Number of vector components of the solution </td></tr>
    <tr><td class="paramname">a_ghosts</td><td>Number of ghost points </td></tr>
    <tr><td class="paramname">a_ndims</td><td>Number of spatial dimensions </td></tr>
    <tr><td class="paramname">a_periodic</td><td>Is the domain periodic or not along each dimension </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="a00356_source.html#l00317">317</a> of file <a class="el" href="a00356_source.html">InterpolateGlobalnDVar.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;{</div>
<div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;  <span class="keywordflow">if</span> ((*a_u_dst) != NULL) {</div>
<div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;    fprintf(stderr, <span class="stringliteral">&quot;Error in InterpolateGlobalnDVar() - \n&quot;</span>);</div>
<div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;    fprintf(stderr, <span class="stringliteral">&quot;  a_u_dst is not NULL!\n&quot;</span>);</div>
<div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;    <span class="keywordflow">return</span> 1;</div>
<div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;  }</div>
<div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;</div>
<div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;  <span class="keywordflow">if</span> (a_u_src == NULL) {</div>
<div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;    fprintf(stderr, <span class="stringliteral">&quot;Error in InterpolateGlobalnDVar() - \n&quot;</span>);</div>
<div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;    fprintf(stderr, <span class="stringliteral">&quot;  a_u_src is NULL!\n&quot;</span>);</div>
<div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;    <span class="keywordflow">return</span> 1;</div>
<div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;  }</div>
<div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;</div>
<div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;  <span class="keywordtype">int</span> dim_to[a_ndims], dim_from[a_ndims];</div>
<div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;</div>
<div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;  <span class="keywordtype">double</span> *u_from;</div>
<div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;  <span class="keywordtype">double</span> *u_to;</div>
<div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;</div>
<div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;  <a class="code" href="a00219.html#a89e8330d9e06dd0666c50833628a125c">_ArrayCopy1D_</a>(a_dim_src, dim_to, a_ndims);</div>
<div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;  u_to = a_u_src;</div>
<div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;  u_from = NULL;</div>
<div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;</div>
<div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> dir = 0; dir &lt; a_ndims; dir++) {</div>
<div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;</div>
<div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;    <a class="code" href="a00219.html#a89e8330d9e06dd0666c50833628a125c">_ArrayCopy1D_</a>(dim_to, dim_from, a_ndims);</div>
<div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;    dim_to[dir] = a_dim_dst[dir];</div>
<div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;</div>
<div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;    <span class="keywordflow">if</span> (dim_from[dir] == dim_to[dir]) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;</div>
<div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;    <span class="keywordtype">double</span> fac = (dim_to[dir] &gt; dim_from[dir] ? </div>
<div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;                      (double)dim_to[dir]/(<span class="keywordtype">double</span>)dim_from[dir] </div>
<div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;                    : (<span class="keywordtype">double</span>)dim_from[dir]/(<span class="keywordtype">double</span>)dim_to[dir] );</div>
<div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;</div>
<div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;    if (!<a class="code" href="a00356.html#aafd7ccd78e660e79257b36fc5a9453f2">isPowerOfTwo</a>((<span class="keywordtype">int</span>)fac)) {</div>
<div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;      fprintf(stderr,<span class="stringliteral">&quot;Error in interpolate() - \n&quot;</span>);</div>
<div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;      fprintf(stderr,<span class="stringliteral">&quot;  refinement/coarsening factor not a power of 2!\n&quot;</span>);</div>
<div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;      <span class="keywordflow">return</span> 1;</div>
<div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;    }</div>
<div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;</div>
<div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;    <span class="keywordflow">if</span> (u_from != NULL) free(u_from);</div>
<div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;</div>
<div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;    u_from = u_to;</div>
<div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;</div>
<div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;    {</div>
<div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;      <span class="keywordtype">long</span> size = (long) a_nvars;</div>
<div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> d = 0; d &lt; a_ndims; d++) {</div>
<div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;        size *= (long) (dim_to[d] + 2*a_ghosts);</div>
<div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;      }</div>
<div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;      u_to = (<span class="keywordtype">double</span>*) calloc (size, <span class="keyword">sizeof</span>(<span class="keywordtype">double</span>));</div>
<div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;    }</div>
<div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;</div>
<div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;    <a class="code" href="a00232.html#a64242767d303af0cca9c33d324d4f79c">fillGhostCells</a>( dim_from, </div>
<div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;                    a_ghosts, </div>
<div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;                    u_from, </div>
<div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;                    a_nvars, </div>
<div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;                    a_ndims, </div>
<div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;                    a_periodic );</div>
<div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;</div>
<div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;    <span class="keywordflow">if</span> (dim_to[dir] &lt; dim_from[dir]) {</div>
<div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;      <span class="keywordtype">int</span> retval = <a class="code" href="a00356.html#a9d680d590ea7b1a942b880564d70dfd1">coarsen1D</a>( dim_from, </div>
<div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;                              dim_to, </div>
<div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;                              u_from, </div>
<div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;                              u_to, </div>
<div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;                              dir, </div>
<div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;                              a_nvars, </div>
<div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;                              a_ghosts, </div>
<div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;                              a_ndims );</div>
<div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;      <span class="keywordflow">if</span> (retval) <span class="keywordflow">return</span> retval;</div>
<div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;      <span class="keywordtype">int</span> retval = <a class="code" href="a00356.html#a8fbe3466587deeb3032a24ccfcc3956a">refine1D</a>(  dim_from, </div>
<div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;                              dim_to, </div>
<div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;                              u_from, </div>
<div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;                              u_to, </div>
<div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;                              dir, </div>
<div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;                              a_nvars, </div>
<div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;                              a_ghosts, </div>
<div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;                              a_ndims );</div>
<div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;      <span class="keywordflow">if</span> (retval) <span class="keywordflow">return</span> retval;</div>
<div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;    }</div>
<div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;</div>
<div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;  }</div>
<div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;</div>
<div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;  <span class="comment">/* dim_to should be equal to a_dim_dst now */</span></div>
<div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> d = 0; d &lt; a_ndims; d++) {</div>
<div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;    <span class="keywordflow">if</span> (dim_to[d] != a_dim_dst[d]) {</div>
<div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;      fprintf(stderr,<span class="stringliteral">&quot;Error in InterpolateGlobalnDVar() - \n&quot;</span>);</div>
<div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;      fprintf(stderr,<span class="stringliteral">&quot;  dim_to[%d] (%d) != a_dim_dst[%d] (%d)!\n&quot;</span>, </div>
<div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;              d, dim_to[d], d, a_dim_dst[d]);</div>
<div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;      <span class="keywordflow">return</span> 1;</div>
<div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;    }</div>
<div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;  }</div>
<div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;</div>
<div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;  <span class="keywordflow">if</span> (u_from != NULL) free(u_from);</div>
<div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;  (*a_u_dst) = u_to;</div>
<div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;</div>
<div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;  <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;}</div>
<div class="ttc" id="a00356_html_aafd7ccd78e660e79257b36fc5a9453f2"><div class="ttname"><a href="a00356.html#aafd7ccd78e660e79257b36fc5a9453f2">isPowerOfTwo</a></div><div class="ttdeci">static int isPowerOfTwo(int x)</div><div class="ttdef"><b>Definition:</b> <a href="a00356_source.html#l00013">InterpolateGlobalnDVar.c:13</a></div></div>
<div class="ttc" id="a00356_html_a8fbe3466587deeb3032a24ccfcc3956a"><div class="ttname"><a href="a00356.html#a8fbe3466587deeb3032a24ccfcc3956a">refine1D</a></div><div class="ttdeci">static int refine1D(const int *const a_dim_src, const int *const a_dim_dst, const double *const a_u_src, double *const a_u_dst, const int a_dir, const int a_nvars, const int a_ngpt, const int a_ndims)</div><div class="ttdef"><b>Definition:</b> <a href="a00356_source.html#l00163">InterpolateGlobalnDVar.c:163</a></div></div>
<div class="ttc" id="a00356_html_a9d680d590ea7b1a942b880564d70dfd1"><div class="ttname"><a href="a00356.html#a9d680d590ea7b1a942b880564d70dfd1">coarsen1D</a></div><div class="ttdeci">static int coarsen1D(const int *const a_dim_src, const int *const a_dim_dst, const double *const a_u_src, double *const a_u_dst, const int a_dir, const int a_nvars, const int a_ngpt, const int a_ndims)</div><div class="ttdef"><b>Definition:</b> <a href="a00356_source.html#l00032">InterpolateGlobalnDVar.c:32</a></div></div>
<div class="ttc" id="a00232_html_a64242767d303af0cca9c33d324d4f79c"><div class="ttname"><a href="a00232.html#a64242767d303af0cca9c33d324d4f79c">fillGhostCells</a></div><div class="ttdeci">void fillGhostCells(const int *const, const int, double *const, const int, const int, const int *const)</div><div class="ttdef"><b>Definition:</b> <a href="a00354_source.html#l00017">FillGhostCells.c:17</a></div></div>
<div class="ttc" id="a00219_html_a89e8330d9e06dd0666c50833628a125c"><div class="ttname"><a href="a00219.html#a89e8330d9e06dd0666c50833628a125c">_ArrayCopy1D_</a></div><div class="ttdeci">#define _ArrayCopy1D_(x, y, size)</div><div class="ttdef"><b>Definition:</b> <a href="a00219_source.html#l00318">arrayfunctions.h:318</a></div></div>
</div><!-- fragment -->
</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- Start of StatCounter Code for Default Guide -->
<script type="text/javascript">
var sc_project=10897352; 
var sc_invisible=1; 
var sc_security="83042f57"; 
var scJsHost = (("https:" == document.location.protocol) ?
"https://secure." : "http://www.");
document.write("<sc"+"ript type='text/javascript' src='" +
scJsHost+
"statcounter.com/counter/counter.js'></"+"script>");
</script>
<noscript><div class="statcounter"><a title="website
statistics" href="http://statcounter.com/"
target="_blank"><img class="statcounter"
src="//c.statcounter.com/10897352/0/83042f57/1/"
alt="website statistics"></a></div></noscript>
<!-- End of StatCounter Code for Default Guide -->
