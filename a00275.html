<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.9.1"/>
<title>HyPar: src/PhysicalModels/Euler1D/Euler1DInitialize.c File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script><script src="http://cdn.mathjax.org/mathjax/latest/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="doxygen_html_style.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">HyPar
   &#160;<span id="projectnumber">1.0</span>
   </div>
   <div id="projectbrief">Finite-Difference Hyperbolic-Parabolic PDE Solver on Cartesian Grids</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.9.1 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Structures</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>Globals</span></a></li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('a00275.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">Euler1DInitialize.c File Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>Initialize the 1D Euler equations module.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &lt;stdio.h&gt;</code><br />
<code>#include &lt;stdlib.h&gt;</code><br />
<code>#include &lt;string.h&gt;</code><br />
<code>#include &lt;<a class="el" href="a00122_source.html">basic.h</a>&gt;</code><br />
<code>#include &lt;<a class="el" href="a00121_source.html">arrayfunctions.h</a>&gt;</code><br />
<code>#include &lt;<a class="el" href="a00129_source.html">physicalmodels/euler1d.h</a>&gt;</code><br />
<code>#include &lt;<a class="el" href="a00108_source.html">mpivars.h</a>&gt;</code><br />
<code>#include &lt;<a class="el" href="a00125_source.html">hypar.h</a>&gt;</code><br />
</div>
<p><a href="a00275_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a96dfe05f0bab236d14c49a97f6f3a9c9"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00275.html#a96dfe05f0bab236d14c49a97f6f3a9c9">Euler1DComputeCFL</a> (void *, void *, double, double)</td></tr>
<tr class="separator:a96dfe05f0bab236d14c49a97f6f3a9c9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a765baa9888bf5d1e7ed3580e6df04e17"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00275.html#a765baa9888bf5d1e7ed3580e6df04e17">Euler1DFlux</a> (double *, double *, int, void *, double)</td></tr>
<tr class="separator:a765baa9888bf5d1e7ed3580e6df04e17"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a31b02a37de0ea8443f0dd89d5861e114"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00275.html#a31b02a37de0ea8443f0dd89d5861e114">Euler1DStiffFlux</a> (double *, double *, int, void *, double)</td></tr>
<tr class="separator:a31b02a37de0ea8443f0dd89d5861e114"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a52dc5f992bf9d226505d94da0d45176e"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00275.html#a52dc5f992bf9d226505d94da0d45176e">Euler1DSource</a> (double *, double *, void *, void *, double)</td></tr>
<tr class="separator:a52dc5f992bf9d226505d94da0d45176e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a84fa9fe2c9c779fa314d02fd62df589f"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00275.html#a84fa9fe2c9c779fa314d02fd62df589f">Euler1DUpwindRoe</a> (double *, double *, double *, double *, double *, double *, int, void *, double)</td></tr>
<tr class="separator:a84fa9fe2c9c779fa314d02fd62df589f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0632e000475600a07f89aaad0fcea2a2"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00275.html#a0632e000475600a07f89aaad0fcea2a2">Euler1DUpwinddFRoe</a> (double *, double *, double *, double *, double *, double *, int, void *, double)</td></tr>
<tr class="separator:a0632e000475600a07f89aaad0fcea2a2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aecab791493af24dbb79224ccdd1c22cd"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00275.html#aecab791493af24dbb79224ccdd1c22cd">Euler1DUpwindRF</a> (double *, double *, double *, double *, double *, double *, int, void *, double)</td></tr>
<tr class="separator:aecab791493af24dbb79224ccdd1c22cd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2e6e98b8cf8dda3540b17764262ef7dc"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00275.html#a2e6e98b8cf8dda3540b17764262ef7dc">Euler1DUpwinddFRF</a> (double *, double *, double *, double *, double *, double *, int, void *, double)</td></tr>
<tr class="separator:a2e6e98b8cf8dda3540b17764262ef7dc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9f4272feb90b98823419004ad0923446"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00275.html#a9f4272feb90b98823419004ad0923446">Euler1DUpwindLLF</a> (double *, double *, double *, double *, double *, double *, int, void *, double)</td></tr>
<tr class="separator:a9f4272feb90b98823419004ad0923446"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2050afda2d76244d8b1be2534d8eee88"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00275.html#a2050afda2d76244d8b1be2534d8eee88">Euler1DUpwinddFLLF</a> (double *, double *, double *, double *, double *, double *, int, void *, double)</td></tr>
<tr class="separator:a2050afda2d76244d8b1be2534d8eee88"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0c16592ca1938504fff89a566be82a87"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00275.html#a0c16592ca1938504fff89a566be82a87">Euler1DUpwindSWFS</a> (double *, double *, double *, double *, double *, double *, int, void *, double)</td></tr>
<tr class="separator:a0c16592ca1938504fff89a566be82a87"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7ab3a531ada5d839c915add13cea5ae0"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00275.html#a7ab3a531ada5d839c915add13cea5ae0">Euler1DJacobian</a> (double *, double *, void *, int, int)</td></tr>
<tr class="separator:a7ab3a531ada5d839c915add13cea5ae0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a79e3229219a9992f484df9573de95ec3"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00275.html#a79e3229219a9992f484df9573de95ec3">Euler1DStiffJacobian</a> (double *, double *, void *, int, int)</td></tr>
<tr class="separator:a79e3229219a9992f484df9573de95ec3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6dfa80796cd1ce0ba0712c301dd68d2f"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00275.html#a6dfa80796cd1ce0ba0712c301dd68d2f">Euler1DRoeAverage</a> (double *, double *, double *, void *)</td></tr>
<tr class="separator:a6dfa80796cd1ce0ba0712c301dd68d2f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a979f0aa5a88e8c1d32794ccba50bc806"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00275.html#a979f0aa5a88e8c1d32794ccba50bc806">Euler1DLeftEigenvectors</a> (double *, double *, void *, int)</td></tr>
<tr class="separator:a979f0aa5a88e8c1d32794ccba50bc806"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6139f9478a0791ac0a0c0d43faffb378"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00275.html#a6139f9478a0791ac0a0c0d43faffb378">Euler1DRightEigenvectors</a> (double *, double *, void *, int)</td></tr>
<tr class="separator:a6139f9478a0791ac0a0c0d43faffb378"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac2a5ef9ed2d6611286c0ff4e213c735b"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00275.html#ac2a5ef9ed2d6611286c0ff4e213c735b">Euler1DGravityField</a> (void *, void *)</td></tr>
<tr class="separator:ac2a5ef9ed2d6611286c0ff4e213c735b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9626db6c422f313b9762b0223f1a52da"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00275.html#a9626db6c422f313b9762b0223f1a52da">Euler1DSourceUpwindLLF</a> (double *, double *, double *, double *, int, void *, double)</td></tr>
<tr class="separator:a9626db6c422f313b9762b0223f1a52da"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a564a6dcdf1979d59610503201e6f2619"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00275.html#a564a6dcdf1979d59610503201e6f2619">Euler1DSourceUpwindRoe</a> (double *, double *, double *, double *, int, void *, double)</td></tr>
<tr class="separator:a564a6dcdf1979d59610503201e6f2619"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae1858c7bcd504b88e0140b21e41c35bf"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00275.html#ae1858c7bcd504b88e0140b21e41c35bf">Euler1DModifiedSolution</a> (double *, double *, int, void *, void *, double)</td></tr>
<tr class="separator:ae1858c7bcd504b88e0140b21e41c35bf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3c64bcea38b974bd6a174b9f6324cf64"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00275.html#a3c64bcea38b974bd6a174b9f6324cf64">Euler1DPreStep</a> (double *, void *, void *, double)</td></tr>
<tr class="separator:a3c64bcea38b974bd6a174b9f6324cf64"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5ca9a44e7eaa2b535b4d4431b60c9ff6"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00275.html#a5ca9a44e7eaa2b535b4d4431b60c9ff6">Euler1DInitialize</a> (void *s, void *m)</td></tr>
<tr class="separator:a5ca9a44e7eaa2b535b4d4431b60c9ff6"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Initialize the 1D Euler equations module. </p>
<dl class="section author"><dt>Author</dt><dd>Debojyoti Ghosh </dd></dl>

<p>Definition in file <a class="el" href="a00275_source.html">Euler1DInitialize.c</a>.</p>
</div><h2 class="groupheader">Function Documentation</h2>
<a class="anchor" id="a96dfe05f0bab236d14c49a97f6f3a9c9"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double Euler1DComputeCFL </td>
          <td>(</td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>s</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>m</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>dt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>t</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Computes the maximum CFL number over the domain. Note that the CFL is computed over the local domain on this processor only. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">s</td><td>Solver object of type <a class="el" href="a00106.html" title="Structure containing all solver-specific variables and functions. ">HyPar</a> </td></tr>
    <tr><td class="paramname">m</td><td>MPI object of type <a class="el" href="a00108.html#a00444" title="Structure of MPI-related variables. ">MPIVariables</a> </td></tr>
    <tr><td class="paramname">dt</td><td>Time step size for which to compute the CFL </td></tr>
    <tr><td class="paramname">t</td><td>Time </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="a00270_source.html#l00017">17</a> of file <a class="el" href="a00270_source.html">Euler1DComputeCFL.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;{</div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;  <a class="code" href="a00106.html">HyPar</a>     *solver = (<a class="code" href="a00106.html">HyPar</a>*)   s;</div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;  <a class="code" href="a00099.html">Euler1D</a>   *param  = (<a class="code" href="a00099.html">Euler1D</a>*) solver-&gt;<a class="code" href="a00106.html#a48e81a1806b5774943fd9a26e9a190f2">physics</a>;</div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;</div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;  <span class="keywordtype">int</span> *dim    = solver-&gt;<a class="code" href="a00106.html#a38e0371f331cecbe63a77fa03e202afe">dim_local</a>;</div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;  <span class="keywordtype">int</span> ghosts  = solver-&gt;<a class="code" href="a00106.html#aafc992b5fa79d5a4036024615d03bce6">ghosts</a>;</div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;  <span class="keywordtype">int</span> ndims   = solver-&gt;<a class="code" href="a00106.html#a484873c74138512e41bc50d17b7d955a">ndims</a>;</div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;  <span class="keywordtype">int</span> index[ndims];</div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;  <span class="keywordtype">double</span> *u   = solver-&gt;<a class="code" href="a00106.html#a3b6b999a764f1e2ea94bb5f28c7a558c">u</a>;</div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;</div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;  <span class="keywordtype">double</span> max_cfl = 0;</div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;  <span class="keywordtype">int</span> done = 0; <a class="code" href="a00121.html#a2b2826031c0cd92495ab351d3e599fc5">_ArraySetValue_</a>(index,ndims,0);</div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;  <span class="keywordflow">while</span> (!done) {</div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;    <span class="keywordtype">int</span> p; <a class="code" href="a00121.html#afbb862a2fdf5b72b1f9ace42f64b556f">_ArrayIndex1D_</a>(ndims,dim,index,ghosts,p);</div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;    <span class="keywordtype">double</span> rho, v, e, P, c, dxinv, local_cfl;</div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;    <a class="code" href="a00129.html#af35510fb1477577f57c57cc2a862b1e7">_Euler1DGetFlowVar_</a>((u+<a class="code" href="a00129.html#ad3395a55a5fde64d6603c7a82d7bf2c7">_MODEL_NVARS_</a>*p),rho,v,e,P,param);</div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;    <a class="code" href="a00122.html#a9aa9bad8531d6733731a850ccc471a42">_GetCoordinate_</a>(0,index[0],dim,ghosts,solver-&gt;<a class="code" href="a00106.html#aa24a4f5e29bd70cbe5a2413be1ea9682">dxinv</a>,dxinv); <span class="comment">/* 1/dx */</span></div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;    c         = sqrt(param-&gt;<a class="code" href="a00099.html#a72f9e01745b3a8203067ab84aefc9aea">gamma</a>*P/rho); <span class="comment">/* speed of sound */</span></div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;    local_cfl = (<a class="code" href="a00127.html#adf1be5ccbb7a2522b4f3a64043c72880">absolute</a>(v)+c)*dt*dxinv; <span class="comment">/* local cfl for this grid point */</span></div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;    <span class="keywordflow">if</span> (local_cfl &gt; max_cfl) max_cfl = local_cfl;</div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;    <a class="code" href="a00121.html#ac5ec1371623f11d03b0f42adaa24acbc">_ArrayIncrementIndex_</a>(ndims,dim,index,done);</div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;  }</div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;</div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;  <span class="keywordflow">return</span>(max_cfl);</div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;}</div>
<div class="ttc" id="a00106_html_a484873c74138512e41bc50d17b7d955a"><div class="ttname"><a href="a00106.html#a484873c74138512e41bc50d17b7d955a">HyPar::ndims</a></div><div class="ttdeci">int ndims</div><div class="ttdef"><b>Definition:</b> <a href="a00125_source.html#l00023">hypar.h:23</a></div></div>
<div class="ttc" id="a00129_html_af35510fb1477577f57c57cc2a862b1e7"><div class="ttname"><a href="a00129.html#af35510fb1477577f57c57cc2a862b1e7">_Euler1DGetFlowVar_</a></div><div class="ttdeci">#define _Euler1DGetFlowVar_(u, rho, v, e, P, p)</div><div class="ttdef"><b>Definition:</b> <a href="a00129_source.html#l00079">euler1d.h:79</a></div></div>
<div class="ttc" id="a00121_html_ac5ec1371623f11d03b0f42adaa24acbc"><div class="ttname"><a href="a00121.html#ac5ec1371623f11d03b0f42adaa24acbc">_ArrayIncrementIndex_</a></div><div class="ttdeci">#define _ArrayIncrementIndex_(N, imax, i, done)</div><div class="ttdef"><b>Definition:</b> <a href="a00121_source.html#l00122">arrayfunctions.h:122</a></div></div>
<div class="ttc" id="a00099_html_a72f9e01745b3a8203067ab84aefc9aea"><div class="ttname"><a href="a00099.html#a72f9e01745b3a8203067ab84aefc9aea">Euler1D::gamma</a></div><div class="ttdeci">double gamma</div><div class="ttdef"><b>Definition:</b> <a href="a00129_source.html#l00272">euler1d.h:272</a></div></div>
<div class="ttc" id="a00121_html_afbb862a2fdf5b72b1f9ace42f64b556f"><div class="ttname"><a href="a00121.html#afbb862a2fdf5b72b1f9ace42f64b556f">_ArrayIndex1D_</a></div><div class="ttdeci">#define _ArrayIndex1D_(N, imax, i, ghost, index)</div><div class="ttdef"><b>Definition:</b> <a href="a00121_source.html#l00036">arrayfunctions.h:36</a></div></div>
<div class="ttc" id="a00099_html"><div class="ttname"><a href="a00099.html">Euler1D</a></div><div class="ttdoc">Structure containing variables and parameters specific to the 1D Euler equations. This structure cont...</div><div class="ttdef"><b>Definition:</b> <a href="a00129_source.html#l00271">euler1d.h:271</a></div></div>
<div class="ttc" id="a00106_html"><div class="ttname"><a href="a00106.html">HyPar</a></div><div class="ttdoc">Structure containing all solver-specific variables and functions. </div><div class="ttdef"><b>Definition:</b> <a href="a00125_source.html#l00020">hypar.h:20</a></div></div>
<div class="ttc" id="a00106_html_a48e81a1806b5774943fd9a26e9a190f2"><div class="ttname"><a href="a00106.html#a48e81a1806b5774943fd9a26e9a190f2">HyPar::physics</a></div><div class="ttdeci">void * physics</div><div class="ttdef"><b>Definition:</b> <a href="a00125_source.html#l00231">hypar.h:231</a></div></div>
<div class="ttc" id="a00106_html_a3b6b999a764f1e2ea94bb5f28c7a558c"><div class="ttname"><a href="a00106.html#a3b6b999a764f1e2ea94bb5f28c7a558c">HyPar::u</a></div><div class="ttdeci">double * u</div><div class="ttdef"><b>Definition:</b> <a href="a00125_source.html#l00091">hypar.h:91</a></div></div>
<div class="ttc" id="a00121_html_a2b2826031c0cd92495ab351d3e599fc5"><div class="ttname"><a href="a00121.html#a2b2826031c0cd92495ab351d3e599fc5">_ArraySetValue_</a></div><div class="ttdeci">#define _ArraySetValue_(x, size, value)</div><div class="ttdef"><b>Definition:</b> <a href="a00121_source.html#l00142">arrayfunctions.h:142</a></div></div>
<div class="ttc" id="a00106_html_aafc992b5fa79d5a4036024615d03bce6"><div class="ttname"><a href="a00106.html#aafc992b5fa79d5a4036024615d03bce6">HyPar::ghosts</a></div><div class="ttdeci">int ghosts</div><div class="ttdef"><b>Definition:</b> <a href="a00125_source.html#l00041">hypar.h:41</a></div></div>
<div class="ttc" id="a00122_html_a9aa9bad8531d6733731a850ccc471a42"><div class="ttname"><a href="a00122.html#a9aa9bad8531d6733731a850ccc471a42">_GetCoordinate_</a></div><div class="ttdeci">#define _GetCoordinate_(dir, i, dim, ghosts, x, coord)</div><div class="ttdef"><b>Definition:</b> <a href="a00122_source.html#l00024">basic.h:24</a></div></div>
<div class="ttc" id="a00129_html_ad3395a55a5fde64d6603c7a82d7bf2c7"><div class="ttname"><a href="a00129.html#ad3395a55a5fde64d6603c7a82d7bf2c7">_MODEL_NVARS_</a></div><div class="ttdeci">#define _MODEL_NVARS_</div><div class="ttdef"><b>Definition:</b> <a href="a00129_source.html#l00058">euler1d.h:58</a></div></div>
<div class="ttc" id="a00106_html_aa24a4f5e29bd70cbe5a2413be1ea9682"><div class="ttname"><a href="a00106.html#aa24a4f5e29bd70cbe5a2413be1ea9682">HyPar::dxinv</a></div><div class="ttdeci">double * dxinv</div><div class="ttdef"><b>Definition:</b> <a href="a00125_source.html#l00085">hypar.h:85</a></div></div>
<div class="ttc" id="a00127_html_adf1be5ccbb7a2522b4f3a64043c72880"><div class="ttname"><a href="a00127.html#adf1be5ccbb7a2522b4f3a64043c72880">absolute</a></div><div class="ttdeci">#define absolute(a)</div><div class="ttdef"><b>Definition:</b> <a href="a00127_source.html#l00033">mathfunctions.h:33</a></div></div>
<div class="ttc" id="a00106_html_a38e0371f331cecbe63a77fa03e202afe"><div class="ttname"><a href="a00106.html#a38e0371f331cecbe63a77fa03e202afe">HyPar::dim_local</a></div><div class="ttdeci">int * dim_local</div><div class="ttdef"><b>Definition:</b> <a href="a00125_source.html#l00032">hypar.h:32</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a765baa9888bf5d1e7ed3580e6df04e17"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int Euler1DFlux </td>
          <td>(</td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>f</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>u</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>dir</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>s</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>t</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Compute the hyperbolic flux over the local domain.<br />
 </p><p class="formulaDsp">
\begin{equation} {\bf F}\left({\bf u}\right) = \left[\begin{array}{c} \rho u \\ \rho u^2 + p \\ (e+p) u \end{array}\right] \end{equation}
</p>
 <dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">f</td><td>Array to hold the computed flux (same size and layout as u) </td></tr>
    <tr><td class="paramname">u</td><td>Array containing the conserved solution </td></tr>
    <tr><td class="paramname">dir</td><td>Spatial dimension (unused since this is a 1D system) </td></tr>
    <tr><td class="paramname">s</td><td>Solver object of type <a class="el" href="a00106.html" title="Structure containing all solver-specific variables and functions. ">HyPar</a> </td></tr>
    <tr><td class="paramname">t</td><td>Current time </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="a00272_source.html#l00016">16</a> of file <a class="el" href="a00272_source.html">Euler1DFlux.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;{</div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;  <a class="code" href="a00106.html">HyPar</a>             *solver = (<a class="code" href="a00106.html">HyPar</a>*)   s;</div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;  <a class="code" href="a00099.html">Euler1D</a>           *param  = (<a class="code" href="a00099.html">Euler1D</a>*) solver-&gt;<a class="code" href="a00106.html#a48e81a1806b5774943fd9a26e9a190f2">physics</a>;</div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;  <span class="keywordtype">int</span>               *dim    = solver-&gt;<a class="code" href="a00106.html#a38e0371f331cecbe63a77fa03e202afe">dim_local</a>;</div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;  <span class="keywordtype">int</span>               ghosts  = solver-&gt;<a class="code" href="a00106.html#aafc992b5fa79d5a4036024615d03bce6">ghosts</a>;</div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;  <span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">int</span>  ndims   = <a class="code" href="a00129.html#a57771c952ec174601addf43e1c0202b2">_MODEL_NDIMS_</a>;</div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;  <span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">int</span>  nvars   = <a class="code" href="a00129.html#ad3395a55a5fde64d6603c7a82d7bf2c7">_MODEL_NVARS_</a>;</div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;  <span class="keyword">static</span> <span class="keywordtype">int</span>        index[<a class="code" href="a00129.html#a57771c952ec174601addf43e1c0202b2">_MODEL_NDIMS_</a>], bounds[_MODEL_NDIMS_], offset[_MODEL_NDIMS_];</div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;</div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;  <span class="comment">/* set bounds for array index to include ghost points */</span></div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;  <a class="code" href="a00121.html#a197e4f9ce0b056b3f3addbbd9887f703">_ArrayAddCopy1D_</a>(dim,(2*ghosts),bounds,ndims);</div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;  <span class="comment">/* set offset such that index is compatible with ghost point arrangement */</span></div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;  <a class="code" href="a00121.html#a2b2826031c0cd92495ab351d3e599fc5">_ArraySetValue_</a>(offset,ndims,-ghosts);</div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;</div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;  <span class="keywordtype">int</span> done = 0; <a class="code" href="a00121.html#a2b2826031c0cd92495ab351d3e599fc5">_ArraySetValue_</a>(index,ndims,0);</div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;  <span class="keywordflow">while</span> (!done) {</div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;    <span class="keywordtype">int</span> p; <a class="code" href="a00121.html#a0739cb538f4d301fad3b45059ddd0738">_ArrayIndex1DWO_</a>(ndims,dim,index,offset,ghosts,p);</div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;    <span class="keywordtype">double</span> rho, v, e, P;</div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;    <a class="code" href="a00129.html#af35510fb1477577f57c57cc2a862b1e7">_Euler1DGetFlowVar_</a>((u+nvars*p),rho,v,e,P,param);</div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;    <a class="code" href="a00129.html#a159a1509b6fbdc57754ca8871d39d97e">_Euler1DSetFlux_</a>((f+nvars*p),rho,v,e,P);</div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;    <a class="code" href="a00121.html#ac5ec1371623f11d03b0f42adaa24acbc">_ArrayIncrementIndex_</a>(ndims,bounds,index,done);</div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;  }</div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;</div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;  <span class="keywordflow">return</span>(0);</div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;}</div>
<div class="ttc" id="a00129_html_af35510fb1477577f57c57cc2a862b1e7"><div class="ttname"><a href="a00129.html#af35510fb1477577f57c57cc2a862b1e7">_Euler1DGetFlowVar_</a></div><div class="ttdeci">#define _Euler1DGetFlowVar_(u, rho, v, e, P, p)</div><div class="ttdef"><b>Definition:</b> <a href="a00129_source.html#l00079">euler1d.h:79</a></div></div>
<div class="ttc" id="a00121_html_ac5ec1371623f11d03b0f42adaa24acbc"><div class="ttname"><a href="a00121.html#ac5ec1371623f11d03b0f42adaa24acbc">_ArrayIncrementIndex_</a></div><div class="ttdeci">#define _ArrayIncrementIndex_(N, imax, i, done)</div><div class="ttdef"><b>Definition:</b> <a href="a00121_source.html#l00122">arrayfunctions.h:122</a></div></div>
<div class="ttc" id="a00099_html"><div class="ttname"><a href="a00099.html">Euler1D</a></div><div class="ttdoc">Structure containing variables and parameters specific to the 1D Euler equations. This structure cont...</div><div class="ttdef"><b>Definition:</b> <a href="a00129_source.html#l00271">euler1d.h:271</a></div></div>
<div class="ttc" id="a00106_html"><div class="ttname"><a href="a00106.html">HyPar</a></div><div class="ttdoc">Structure containing all solver-specific variables and functions. </div><div class="ttdef"><b>Definition:</b> <a href="a00125_source.html#l00020">hypar.h:20</a></div></div>
<div class="ttc" id="a00121_html_a0739cb538f4d301fad3b45059ddd0738"><div class="ttname"><a href="a00121.html#a0739cb538f4d301fad3b45059ddd0738">_ArrayIndex1DWO_</a></div><div class="ttdeci">#define _ArrayIndex1DWO_(N, imax, i, offset, ghost, index)</div><div class="ttdef"><b>Definition:</b> <a href="a00121_source.html#l00079">arrayfunctions.h:79</a></div></div>
<div class="ttc" id="a00106_html_a48e81a1806b5774943fd9a26e9a190f2"><div class="ttname"><a href="a00106.html#a48e81a1806b5774943fd9a26e9a190f2">HyPar::physics</a></div><div class="ttdeci">void * physics</div><div class="ttdef"><b>Definition:</b> <a href="a00125_source.html#l00231">hypar.h:231</a></div></div>
<div class="ttc" id="a00129_html_a57771c952ec174601addf43e1c0202b2"><div class="ttname"><a href="a00129.html#a57771c952ec174601addf43e1c0202b2">_MODEL_NDIMS_</a></div><div class="ttdeci">#define _MODEL_NDIMS_</div><div class="ttdef"><b>Definition:</b> <a href="a00129_source.html#l00056">euler1d.h:56</a></div></div>
<div class="ttc" id="a00121_html_a197e4f9ce0b056b3f3addbbd9887f703"><div class="ttname"><a href="a00121.html#a197e4f9ce0b056b3f3addbbd9887f703">_ArrayAddCopy1D_</a></div><div class="ttdeci">#define _ArrayAddCopy1D_(x, a, y, size)</div><div class="ttdef"><b>Definition:</b> <a href="a00121_source.html#l00330">arrayfunctions.h:330</a></div></div>
<div class="ttc" id="a00121_html_a2b2826031c0cd92495ab351d3e599fc5"><div class="ttname"><a href="a00121.html#a2b2826031c0cd92495ab351d3e599fc5">_ArraySetValue_</a></div><div class="ttdeci">#define _ArraySetValue_(x, size, value)</div><div class="ttdef"><b>Definition:</b> <a href="a00121_source.html#l00142">arrayfunctions.h:142</a></div></div>
<div class="ttc" id="a00106_html_aafc992b5fa79d5a4036024615d03bce6"><div class="ttname"><a href="a00106.html#aafc992b5fa79d5a4036024615d03bce6">HyPar::ghosts</a></div><div class="ttdeci">int ghosts</div><div class="ttdef"><b>Definition:</b> <a href="a00125_source.html#l00041">hypar.h:41</a></div></div>
<div class="ttc" id="a00129_html_a159a1509b6fbdc57754ca8871d39d97e"><div class="ttname"><a href="a00129.html#a159a1509b6fbdc57754ca8871d39d97e">_Euler1DSetFlux_</a></div><div class="ttdeci">#define _Euler1DSetFlux_(f, rho, v, e, P)</div><div class="ttdef"><b>Definition:</b> <a href="a00129_source.html#l00092">euler1d.h:92</a></div></div>
<div class="ttc" id="a00129_html_ad3395a55a5fde64d6603c7a82d7bf2c7"><div class="ttname"><a href="a00129.html#ad3395a55a5fde64d6603c7a82d7bf2c7">_MODEL_NVARS_</a></div><div class="ttdeci">#define _MODEL_NVARS_</div><div class="ttdef"><b>Definition:</b> <a href="a00129_source.html#l00058">euler1d.h:58</a></div></div>
<div class="ttc" id="a00106_html_a38e0371f331cecbe63a77fa03e202afe"><div class="ttname"><a href="a00106.html#a38e0371f331cecbe63a77fa03e202afe">HyPar::dim_local</a></div><div class="ttdeci">int * dim_local</div><div class="ttdef"><b>Definition:</b> <a href="a00125_source.html#l00032">hypar.h:32</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a31b02a37de0ea8443f0dd89d5861e114"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int Euler1DStiffFlux </td>
          <td>(</td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>f</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>u</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>dir</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>s</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>t</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Compute the stiff component of the hyperbolic flux over the local domain.<br />
 </p><p class="formulaDsp">
\begin{equation} {\bf F}_F\left({\bf u}\right) = A_f\left({\bf u}\right){\bf u} \end{equation}
</p>
<p> where \(A_f\left({\bf u}\right) \) is the fast Jacobian representing the acoustic waves only. A linearized formulation is used where the fast Jacobian \(A_f\) is computed for the solution at the beginning of each time step in <a class="el" href="a00278.html#a04a19dc2b23de545e18ffddb298960d1">Euler1DPreStep</a>. </p><dl class="section see"><dt>See also</dt><dd><a class="el" href="a00129.html#a5329991de3157d264ef86a1df4ff6bef">_Euler1DSetStiffFlux_</a>, <a class="el" href="a00129.html#a2f680b65f650c3360682d6f65e4f7321">_Euler1DSetLinearizedStiffFlux_</a>, <a class="el" href="a00129.html#a5a41ecdbbb78de026d8541491fb5587f">_Euler1DSetStiffJac_</a></dd></dl>
<p>Reference:</p><ul>
<li>Ghosh, D., Constantinescu, E. M., Semi-Implicit Time Integration of Atmospheric Flows with Characteristic-Based Flux Partitioning, SIAM Journal on Scientific Computing, 38 (3), 2016, A1848-A1875, <a href="http://dx.doi.org/10.1137/15M1044369">http://dx.doi.org/10.1137/15M1044369</a> </li>
</ul>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">f</td><td>Array to hold the computed flux (same size and layout as u) </td></tr>
    <tr><td class="paramname">u</td><td>Array containing the conserved solution </td></tr>
    <tr><td class="paramname">dir</td><td>Spatial dimension (unused since this is a 1D system) </td></tr>
    <tr><td class="paramname">s</td><td>Solver object of type <a class="el" href="a00106.html" title="Structure containing all solver-specific variables and functions. ">HyPar</a> </td></tr>
    <tr><td class="paramname">t</td><td>Current time </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="a00272_source.html#l00064">64</a> of file <a class="el" href="a00272_source.html">Euler1DFlux.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;{</div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;  <a class="code" href="a00106.html">HyPar</a>             *solver = (<a class="code" href="a00106.html">HyPar</a>*)   s;</div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;  <a class="code" href="a00099.html">Euler1D</a>           *param  = (<a class="code" href="a00099.html">Euler1D</a>*) solver-&gt;<a class="code" href="a00106.html#a48e81a1806b5774943fd9a26e9a190f2">physics</a>;</div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;  <span class="keywordtype">int</span>               *dim    = solver-&gt;<a class="code" href="a00106.html#a38e0371f331cecbe63a77fa03e202afe">dim_local</a>;</div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;  <span class="keywordtype">int</span>               ghosts  = solver-&gt;<a class="code" href="a00106.html#aafc992b5fa79d5a4036024615d03bce6">ghosts</a>;</div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;  <span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">int</span>  ndims   = <a class="code" href="a00129.html#a57771c952ec174601addf43e1c0202b2">_MODEL_NDIMS_</a>;</div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;  <span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">int</span>  nvars   = <a class="code" href="a00129.html#ad3395a55a5fde64d6603c7a82d7bf2c7">_MODEL_NVARS_</a>;</div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;  <span class="keyword">static</span> <span class="keywordtype">int</span>        index[<a class="code" href="a00129.html#a57771c952ec174601addf43e1c0202b2">_MODEL_NDIMS_</a>], bounds[_MODEL_NDIMS_], offset[_MODEL_NDIMS_];</div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;</div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;  <span class="comment">/* set bounds for array index to include ghost points */</span></div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;  <a class="code" href="a00121.html#a197e4f9ce0b056b3f3addbbd9887f703">_ArrayAddCopy1D_</a>(dim,(2*ghosts),bounds,ndims);</div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;  <span class="comment">/* set offset such that index is compatible with ghost point arrangement */</span></div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;  <a class="code" href="a00121.html#a2b2826031c0cd92495ab351d3e599fc5">_ArraySetValue_</a>(offset,ndims,-ghosts);</div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;</div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;  <span class="keywordtype">int</span> done = 0; <a class="code" href="a00121.html#a2b2826031c0cd92495ab351d3e599fc5">_ArraySetValue_</a>(index,ndims,0);</div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;  <span class="keywordflow">while</span> (!done) {</div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;    <span class="keywordtype">int</span> p; <a class="code" href="a00121.html#a0739cb538f4d301fad3b45059ddd0738">_ArrayIndex1DWO_</a>(ndims,dim,index,offset,ghosts,p);</div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;    <a class="code" href="a00129.html#a2f680b65f650c3360682d6f65e4f7321">_Euler1DSetLinearizedStiffFlux_</a>((f+nvars*p),(u+nvars*p),(param-&gt;<a class="code" href="a00099.html#a14af7516371abe115b3a1aa9269aebb5">fast_jac</a>+nvars*nvars*p));</div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;    <a class="code" href="a00121.html#ac5ec1371623f11d03b0f42adaa24acbc">_ArrayIncrementIndex_</a>(ndims,bounds,index,done);</div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;  }</div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;</div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;  <span class="keywordflow">return</span>(0);</div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;}</div>
<div class="ttc" id="a00121_html_ac5ec1371623f11d03b0f42adaa24acbc"><div class="ttname"><a href="a00121.html#ac5ec1371623f11d03b0f42adaa24acbc">_ArrayIncrementIndex_</a></div><div class="ttdeci">#define _ArrayIncrementIndex_(N, imax, i, done)</div><div class="ttdef"><b>Definition:</b> <a href="a00121_source.html#l00122">arrayfunctions.h:122</a></div></div>
<div class="ttc" id="a00099_html_a14af7516371abe115b3a1aa9269aebb5"><div class="ttname"><a href="a00099.html#a14af7516371abe115b3a1aa9269aebb5">Euler1D::fast_jac</a></div><div class="ttdeci">double * fast_jac</div><div class="ttdef"><b>Definition:</b> <a href="a00129_source.html#l00287">euler1d.h:287</a></div></div>
<div class="ttc" id="a00099_html"><div class="ttname"><a href="a00099.html">Euler1D</a></div><div class="ttdoc">Structure containing variables and parameters specific to the 1D Euler equations. This structure cont...</div><div class="ttdef"><b>Definition:</b> <a href="a00129_source.html#l00271">euler1d.h:271</a></div></div>
<div class="ttc" id="a00106_html"><div class="ttname"><a href="a00106.html">HyPar</a></div><div class="ttdoc">Structure containing all solver-specific variables and functions. </div><div class="ttdef"><b>Definition:</b> <a href="a00125_source.html#l00020">hypar.h:20</a></div></div>
<div class="ttc" id="a00121_html_a0739cb538f4d301fad3b45059ddd0738"><div class="ttname"><a href="a00121.html#a0739cb538f4d301fad3b45059ddd0738">_ArrayIndex1DWO_</a></div><div class="ttdeci">#define _ArrayIndex1DWO_(N, imax, i, offset, ghost, index)</div><div class="ttdef"><b>Definition:</b> <a href="a00121_source.html#l00079">arrayfunctions.h:79</a></div></div>
<div class="ttc" id="a00106_html_a48e81a1806b5774943fd9a26e9a190f2"><div class="ttname"><a href="a00106.html#a48e81a1806b5774943fd9a26e9a190f2">HyPar::physics</a></div><div class="ttdeci">void * physics</div><div class="ttdef"><b>Definition:</b> <a href="a00125_source.html#l00231">hypar.h:231</a></div></div>
<div class="ttc" id="a00129_html_a57771c952ec174601addf43e1c0202b2"><div class="ttname"><a href="a00129.html#a57771c952ec174601addf43e1c0202b2">_MODEL_NDIMS_</a></div><div class="ttdeci">#define _MODEL_NDIMS_</div><div class="ttdef"><b>Definition:</b> <a href="a00129_source.html#l00056">euler1d.h:56</a></div></div>
<div class="ttc" id="a00121_html_a197e4f9ce0b056b3f3addbbd9887f703"><div class="ttname"><a href="a00121.html#a197e4f9ce0b056b3f3addbbd9887f703">_ArrayAddCopy1D_</a></div><div class="ttdeci">#define _ArrayAddCopy1D_(x, a, y, size)</div><div class="ttdef"><b>Definition:</b> <a href="a00121_source.html#l00330">arrayfunctions.h:330</a></div></div>
<div class="ttc" id="a00121_html_a2b2826031c0cd92495ab351d3e599fc5"><div class="ttname"><a href="a00121.html#a2b2826031c0cd92495ab351d3e599fc5">_ArraySetValue_</a></div><div class="ttdeci">#define _ArraySetValue_(x, size, value)</div><div class="ttdef"><b>Definition:</b> <a href="a00121_source.html#l00142">arrayfunctions.h:142</a></div></div>
<div class="ttc" id="a00106_html_aafc992b5fa79d5a4036024615d03bce6"><div class="ttname"><a href="a00106.html#aafc992b5fa79d5a4036024615d03bce6">HyPar::ghosts</a></div><div class="ttdeci">int ghosts</div><div class="ttdef"><b>Definition:</b> <a href="a00125_source.html#l00041">hypar.h:41</a></div></div>
<div class="ttc" id="a00129_html_ad3395a55a5fde64d6603c7a82d7bf2c7"><div class="ttname"><a href="a00129.html#ad3395a55a5fde64d6603c7a82d7bf2c7">_MODEL_NVARS_</a></div><div class="ttdeci">#define _MODEL_NVARS_</div><div class="ttdef"><b>Definition:</b> <a href="a00129_source.html#l00058">euler1d.h:58</a></div></div>
<div class="ttc" id="a00129_html_a2f680b65f650c3360682d6f65e4f7321"><div class="ttname"><a href="a00129.html#a2f680b65f650c3360682d6f65e4f7321">_Euler1DSetLinearizedStiffFlux_</a></div><div class="ttdeci">#define _Euler1DSetLinearizedStiffFlux_(f, u, J)</div><div class="ttdef"><b>Definition:</b> <a href="a00129_source.html#l00132">euler1d.h:132</a></div></div>
<div class="ttc" id="a00106_html_a38e0371f331cecbe63a77fa03e202afe"><div class="ttname"><a href="a00106.html#a38e0371f331cecbe63a77fa03e202afe">HyPar::dim_local</a></div><div class="ttdeci">int * dim_local</div><div class="ttdef"><b>Definition:</b> <a href="a00125_source.html#l00032">hypar.h:32</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a52dc5f992bf9d226505d94da0d45176e"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int Euler1DSource </td>
          <td>(</td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>source</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>u</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>s</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>m</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>t</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Compute the gravitational source terms for the 1D Euler equations. The source term is computed according to the balanced formulation introduced in the reference below. The source term is reformulated and "discretized" in a similar fashion as the hyperbolic flux to ensure that the hydrostatic balance is maintained to machine precision.</p><ul>
<li>Xing, Shu, "High Order Well-Balanced WENO Scheme for the Gas Dynamics Equations 
              Under Gravitational Fields", J. Sci. Comput., 54, 2013, pp. 645&ndash;662, <a href="http://dx.doi.org/10.1007/s10915-012-9585-8">http://dx.doi.org/10.1007/s10915-012-9585-8</a>. </li>
</ul>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">source</td><td>Computed source terms (array size &amp; layout same as u) </td></tr>
    <tr><td class="paramname">u</td><td>Solution (conserved variables) </td></tr>
    <tr><td class="paramname">s</td><td>Solver object of type <a class="el" href="a00106.html" title="Structure containing all solver-specific variables and functions. ">HyPar</a> </td></tr>
    <tr><td class="paramname">m</td><td>MPI object of type <a class="el" href="a00108.html#a00444" title="Structure of MPI-related variables. ">MPIVariables</a> </td></tr>
    <tr><td class="paramname">t</td><td>Current solution time </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="a00279_source.html#l00023">23</a> of file <a class="el" href="a00279_source.html">Euler1DSource.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;{</div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;  <a class="code" href="a00106.html">HyPar</a>         *solver = (<a class="code" href="a00106.html">HyPar</a>* ) s;</div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;  <a class="code" href="a00108.html#a00444">MPIVariables</a>  *mpi = (<a class="code" href="a00108.html#a00444">MPIVariables</a>*) m;</div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;  <a class="code" href="a00099.html">Euler1D</a>       *param  = (<a class="code" href="a00099.html">Euler1D</a>*) solver-&gt;<a class="code" href="a00106.html#a48e81a1806b5774943fd9a26e9a190f2">physics</a>;</div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;</div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;  if (param-&gt;<a class="code" href="a00099.html#a87f6134534484ec863864096005ac076">grav</a> == 0.0)  <span class="keywordflow">return</span>(0); <span class="comment">/* no gravitational forces */</span></div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;</div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;  <span class="keywordtype">int</span>     v, done, p, p1, p2;</div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;  <span class="keywordtype">double</span>  *SourceI = solver-&gt;<a class="code" href="a00106.html#a983929b7b1511ff3e7800597adef6a91">fluxI</a>; <span class="comment">/* interace source term       */</span></div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;  <span class="keywordtype">double</span>  *SourceC = solver-&gt;<a class="code" href="a00106.html#aee7ff3b51db01ee6ed4038ff5311ed24">fluxC</a>; <span class="comment">/* cell-centered source term  */</span></div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;  <span class="keywordtype">double</span>  *SourceL = solver-&gt;<a class="code" href="a00106.html#a99f72a44e29089b75fd11155bfcc1ff8">fL</a>;</div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;  <span class="keywordtype">double</span>  *SourceR = solver-&gt;<a class="code" href="a00106.html#abb50b7a404febaf647f7bd89f873b96e">fR</a>;</div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;</div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;  <span class="keywordtype">int</span>     ndims   = solver-&gt;<a class="code" href="a00106.html#a484873c74138512e41bc50d17b7d955a">ndims</a>;</div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;  <span class="keywordtype">int</span>     ghosts  = solver-&gt;<a class="code" href="a00106.html#aafc992b5fa79d5a4036024615d03bce6">ghosts</a>;</div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;  <span class="keywordtype">int</span>     *dim    = solver-&gt;<a class="code" href="a00106.html#a38e0371f331cecbe63a77fa03e202afe">dim_local</a>;</div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;  <span class="keywordtype">double</span>  *x      = solver-&gt;<a class="code" href="a00106.html#a711aad4cbe735871dd9e91ab575c878b">x</a>;</div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;  <span class="keywordtype">double</span>  *dxinv  = solver-&gt;<a class="code" href="a00106.html#aa24a4f5e29bd70cbe5a2413be1ea9682">dxinv</a>;</div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;  <span class="keywordtype">int</span>     index[ndims],index1[ndims],index2[ndims],dim_interface[ndims];</div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;</div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;  <span class="comment">/* set interface dimensions */</span></div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;  <a class="code" href="a00121.html#a89e8330d9e06dd0666c50833628a125c">_ArrayCopy1D_</a>(dim,dim_interface,ndims); dim_interface[<a class="code" href="a00129.html#a6a44057228e5f4b86e1c4d04b2a28977">_XDIR_</a>]++;</div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;  <span class="comment">/* calculate the split source function exp(-phi/RT) */</span></div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;  <a class="code" href="a00122.html#ad6ab74942c9de13cf0b4c12eb0d91780">IERR</a> <a class="code" href="a00279.html#a23bb10e5b44548d3c27b43d0bb954214">Euler1DSourceFunction</a>(SourceC,u,x,solver,mpi,t); <a class="code" href="a00122.html#add9cf96ae374934d245a1dc1ab697a42">CHECKERR</a>(ierr);</div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;  <span class="comment">/* calculate the left and right interface source terms */</span></div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;  <a class="code" href="a00122.html#ad6ab74942c9de13cf0b4c12eb0d91780">IERR</a> solver-&gt;<a class="code" href="a00106.html#a9a8456b08cde5ecf5d15e67e0729525c">InterpolateInterfacesHyp</a>(SourceL,SourceC,u,x, 1,<a class="code" href="a00129.html#a6a44057228e5f4b86e1c4d04b2a28977">_XDIR_</a>,solver,mpi,0); <a class="code" href="a00122.html#add9cf96ae374934d245a1dc1ab697a42">CHECKERR</a>(ierr);</div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;  <a class="code" href="a00122.html#ad6ab74942c9de13cf0b4c12eb0d91780">IERR</a> solver-&gt;<a class="code" href="a00106.html#a9a8456b08cde5ecf5d15e67e0729525c">InterpolateInterfacesHyp</a>(SourceR,SourceC,u,x,-1,<a class="code" href="a00129.html#a6a44057228e5f4b86e1c4d04b2a28977">_XDIR_</a>,solver,mpi,0); <a class="code" href="a00122.html#add9cf96ae374934d245a1dc1ab697a42">CHECKERR</a>(ierr);</div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;  <span class="comment">/* calculate the final interface source term */</span></div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;  <a class="code" href="a00122.html#ad6ab74942c9de13cf0b4c12eb0d91780">IERR</a> param-&gt;<a class="code" href="a00099.html#acf2a05e3d7005c865c3e4f609cf728f8">SourceUpwind</a>(SourceI,SourceL,SourceR,u,<a class="code" href="a00129.html#a6a44057228e5f4b86e1c4d04b2a28977">_XDIR_</a>,solver,t);</div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;  <span class="comment">/* calculate the final cell-centered source term */</span></div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;  done = 0; <a class="code" href="a00121.html#a2b2826031c0cd92495ab351d3e599fc5">_ArraySetValue_</a>(index,ndims,0);</div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;  <span class="keywordflow">while</span> (!done) {</div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;    <a class="code" href="a00121.html#a89e8330d9e06dd0666c50833628a125c">_ArrayCopy1D_</a>(index,index1,ndims);</div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;    <a class="code" href="a00121.html#a89e8330d9e06dd0666c50833628a125c">_ArrayCopy1D_</a>(index,index2,ndims); index2[<a class="code" href="a00129.html#a6a44057228e5f4b86e1c4d04b2a28977">_XDIR_</a>]++;</div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;    <a class="code" href="a00121.html#afbb862a2fdf5b72b1f9ace42f64b556f">_ArrayIndex1D_</a>(ndims,dim          ,index ,ghosts,p );</div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;    <a class="code" href="a00121.html#afbb862a2fdf5b72b1f9ace42f64b556f">_ArrayIndex1D_</a>(ndims,dim_interface,index1,0     ,p1);</div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;    <a class="code" href="a00121.html#afbb862a2fdf5b72b1f9ace42f64b556f">_ArrayIndex1D_</a>(ndims,dim_interface,index2,0     ,p2);</div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;    <span class="keywordtype">double</span> dx_inverse;   <a class="code" href="a00122.html#a9aa9bad8531d6733731a850ccc471a42">_GetCoordinate_</a>(<a class="code" href="a00129.html#a6a44057228e5f4b86e1c4d04b2a28977">_XDIR_</a>,index[<a class="code" href="a00129.html#a6a44057228e5f4b86e1c4d04b2a28977">_XDIR_</a>],dim,ghosts,dxinv,dx_inverse);</div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;    <span class="keywordtype">double</span> rho, vel, e, P; <a class="code" href="a00129.html#af35510fb1477577f57c57cc2a862b1e7">_Euler1DGetFlowVar_</a>((u+<a class="code" href="a00129.html#ad3395a55a5fde64d6603c7a82d7bf2c7">_MODEL_NVARS_</a>*p),rho,vel,e,P,param);</div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;    <span class="keywordtype">double</span> term[<a class="code" href="a00129.html#ad3395a55a5fde64d6603c7a82d7bf2c7">_MODEL_NVARS_</a>] = {0.0, rho, rho*vel};</div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;    <span class="keywordflow">for</span> (v=0; v&lt;<a class="code" href="a00129.html#ad3395a55a5fde64d6603c7a82d7bf2c7">_MODEL_NVARS_</a>; v++) {</div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;      source[_MODEL_NVARS_*p+v] += (  (term[v]*(1.0/param-&gt;<a class="code" href="a00099.html#afb1265dc9bb8f8c05bd22f88c23d879c">grav_field</a>[p])) </div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;                                    * (SourceI[_MODEL_NVARS_*p2+v]-SourceI[_MODEL_NVARS_*p1+v])*dx_inverse );</div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;    }</div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;    vel = P; <span class="comment">/* useless statement to avoid compiler warning */</span></div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;    <a class="code" href="a00121.html#ac5ec1371623f11d03b0f42adaa24acbc">_ArrayIncrementIndex_</a>(ndims,dim,index,done);</div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;  }</div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;</div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;  <span class="keywordflow">return</span>(0);</div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;}</div>
<div class="ttc" id="a00106_html_a484873c74138512e41bc50d17b7d955a"><div class="ttname"><a href="a00106.html#a484873c74138512e41bc50d17b7d955a">HyPar::ndims</a></div><div class="ttdeci">int ndims</div><div class="ttdef"><b>Definition:</b> <a href="a00125_source.html#l00023">hypar.h:23</a></div></div>
<div class="ttc" id="a00099_html_a87f6134534484ec863864096005ac076"><div class="ttname"><a href="a00099.html#a87f6134534484ec863864096005ac076">Euler1D::grav</a></div><div class="ttdeci">double grav</div><div class="ttdef"><b>Definition:</b> <a href="a00129_source.html#l00273">euler1d.h:273</a></div></div>
<div class="ttc" id="a00106_html_a99f72a44e29089b75fd11155bfcc1ff8"><div class="ttname"><a href="a00106.html#a99f72a44e29089b75fd11155bfcc1ff8">HyPar::fL</a></div><div class="ttdeci">double * fL</div><div class="ttdef"><b>Definition:</b> <a href="a00125_source.html#l00114">hypar.h:114</a></div></div>
<div class="ttc" id="a00106_html_aee7ff3b51db01ee6ed4038ff5311ed24"><div class="ttname"><a href="a00106.html#aee7ff3b51db01ee6ed4038ff5311ed24">HyPar::fluxC</a></div><div class="ttdeci">double * fluxC</div><div class="ttdef"><b>Definition:</b> <a href="a00125_source.html#l00103">hypar.h:103</a></div></div>
<div class="ttc" id="a00122_html_add9cf96ae374934d245a1dc1ab697a42"><div class="ttname"><a href="a00122.html#add9cf96ae374934d245a1dc1ab697a42">CHECKERR</a></div><div class="ttdeci">#define CHECKERR(ierr)</div><div class="ttdef"><b>Definition:</b> <a href="a00122_source.html#l00011">basic.h:11</a></div></div>
<div class="ttc" id="a00108_html_a00444"><div class="ttname"><a href="a00108.html#a00444">MPIVariables</a></div><div class="ttdoc">Structure of MPI-related variables. </div><div class="ttdef"><b>Definition:</b> <a href="a00108_source.html#l00021">mpivars.h:21</a></div></div>
<div class="ttc" id="a00129_html_af35510fb1477577f57c57cc2a862b1e7"><div class="ttname"><a href="a00129.html#af35510fb1477577f57c57cc2a862b1e7">_Euler1DGetFlowVar_</a></div><div class="ttdeci">#define _Euler1DGetFlowVar_(u, rho, v, e, P, p)</div><div class="ttdef"><b>Definition:</b> <a href="a00129_source.html#l00079">euler1d.h:79</a></div></div>
<div class="ttc" id="a00129_html_a6a44057228e5f4b86e1c4d04b2a28977"><div class="ttname"><a href="a00129.html#a6a44057228e5f4b86e1c4d04b2a28977">_XDIR_</a></div><div class="ttdeci">#define _XDIR_</div><div class="ttdef"><b>Definition:</b> <a href="a00129_source.html#l00073">euler1d.h:73</a></div></div>
<div class="ttc" id="a00121_html_ac5ec1371623f11d03b0f42adaa24acbc"><div class="ttname"><a href="a00121.html#ac5ec1371623f11d03b0f42adaa24acbc">_ArrayIncrementIndex_</a></div><div class="ttdeci">#define _ArrayIncrementIndex_(N, imax, i, done)</div><div class="ttdef"><b>Definition:</b> <a href="a00121_source.html#l00122">arrayfunctions.h:122</a></div></div>
<div class="ttc" id="a00121_html_a89e8330d9e06dd0666c50833628a125c"><div class="ttname"><a href="a00121.html#a89e8330d9e06dd0666c50833628a125c">_ArrayCopy1D_</a></div><div class="ttdeci">#define _ArrayCopy1D_(x, y, size)</div><div class="ttdef"><b>Definition:</b> <a href="a00121_source.html#l00281">arrayfunctions.h:281</a></div></div>
<div class="ttc" id="a00279_html_a23bb10e5b44548d3c27b43d0bb954214"><div class="ttname"><a href="a00279.html#a23bb10e5b44548d3c27b43d0bb954214">Euler1DSourceFunction</a></div><div class="ttdeci">static int Euler1DSourceFunction(double *, double *, double *, void *, void *, double)</div><div class="ttdef"><b>Definition:</b> <a href="a00279_source.html#l00089">Euler1DSource.c:89</a></div></div>
<div class="ttc" id="a00106_html_a711aad4cbe735871dd9e91ab575c878b"><div class="ttname"><a href="a00106.html#a711aad4cbe735871dd9e91ab575c878b">HyPar::x</a></div><div class="ttdeci">double * x</div><div class="ttdef"><b>Definition:</b> <a href="a00125_source.html#l00082">hypar.h:82</a></div></div>
<div class="ttc" id="a00121_html_afbb862a2fdf5b72b1f9ace42f64b556f"><div class="ttname"><a href="a00121.html#afbb862a2fdf5b72b1f9ace42f64b556f">_ArrayIndex1D_</a></div><div class="ttdeci">#define _ArrayIndex1D_(N, imax, i, ghost, index)</div><div class="ttdef"><b>Definition:</b> <a href="a00121_source.html#l00036">arrayfunctions.h:36</a></div></div>
<div class="ttc" id="a00099_html"><div class="ttname"><a href="a00099.html">Euler1D</a></div><div class="ttdoc">Structure containing variables and parameters specific to the 1D Euler equations. This structure cont...</div><div class="ttdef"><b>Definition:</b> <a href="a00129_source.html#l00271">euler1d.h:271</a></div></div>
<div class="ttc" id="a00106_html"><div class="ttname"><a href="a00106.html">HyPar</a></div><div class="ttdoc">Structure containing all solver-specific variables and functions. </div><div class="ttdef"><b>Definition:</b> <a href="a00125_source.html#l00020">hypar.h:20</a></div></div>
<div class="ttc" id="a00106_html_a48e81a1806b5774943fd9a26e9a190f2"><div class="ttname"><a href="a00106.html#a48e81a1806b5774943fd9a26e9a190f2">HyPar::physics</a></div><div class="ttdeci">void * physics</div><div class="ttdef"><b>Definition:</b> <a href="a00125_source.html#l00231">hypar.h:231</a></div></div>
<div class="ttc" id="a00106_html_abb50b7a404febaf647f7bd89f873b96e"><div class="ttname"><a href="a00106.html#abb50b7a404febaf647f7bd89f873b96e">HyPar::fR</a></div><div class="ttdeci">double * fR</div><div class="ttdef"><b>Definition:</b> <a href="a00125_source.html#l00114">hypar.h:114</a></div></div>
<div class="ttc" id="a00106_html_a983929b7b1511ff3e7800597adef6a91"><div class="ttname"><a href="a00106.html#a983929b7b1511ff3e7800597adef6a91">HyPar::fluxI</a></div><div class="ttdeci">double * fluxI</div><div class="ttdef"><b>Definition:</b> <a href="a00125_source.html#l00111">hypar.h:111</a></div></div>
<div class="ttc" id="a00121_html_a2b2826031c0cd92495ab351d3e599fc5"><div class="ttname"><a href="a00121.html#a2b2826031c0cd92495ab351d3e599fc5">_ArraySetValue_</a></div><div class="ttdeci">#define _ArraySetValue_(x, size, value)</div><div class="ttdef"><b>Definition:</b> <a href="a00121_source.html#l00142">arrayfunctions.h:142</a></div></div>
<div class="ttc" id="a00106_html_a9a8456b08cde5ecf5d15e67e0729525c"><div class="ttname"><a href="a00106.html#a9a8456b08cde5ecf5d15e67e0729525c">HyPar::InterpolateInterfacesHyp</a></div><div class="ttdeci">int(* InterpolateInterfacesHyp)(double *, double *, double *, double *, int, int, void *, void *, int)</div><div class="ttdef"><b>Definition:</b> <a href="a00125_source.html#l00189">hypar.h:189</a></div></div>
<div class="ttc" id="a00106_html_aafc992b5fa79d5a4036024615d03bce6"><div class="ttname"><a href="a00106.html#aafc992b5fa79d5a4036024615d03bce6">HyPar::ghosts</a></div><div class="ttdeci">int ghosts</div><div class="ttdef"><b>Definition:</b> <a href="a00125_source.html#l00041">hypar.h:41</a></div></div>
<div class="ttc" id="a00099_html_afb1265dc9bb8f8c05bd22f88c23d879c"><div class="ttname"><a href="a00099.html#afb1265dc9bb8f8c05bd22f88c23d879c">Euler1D::grav_field</a></div><div class="ttdeci">double * grav_field</div><div class="ttdef"><b>Definition:</b> <a href="a00129_source.html#l00286">euler1d.h:286</a></div></div>
<div class="ttc" id="a00122_html_a9aa9bad8531d6733731a850ccc471a42"><div class="ttname"><a href="a00122.html#a9aa9bad8531d6733731a850ccc471a42">_GetCoordinate_</a></div><div class="ttdeci">#define _GetCoordinate_(dir, i, dim, ghosts, x, coord)</div><div class="ttdef"><b>Definition:</b> <a href="a00122_source.html#l00024">basic.h:24</a></div></div>
<div class="ttc" id="a00122_html_ad6ab74942c9de13cf0b4c12eb0d91780"><div class="ttname"><a href="a00122.html#ad6ab74942c9de13cf0b4c12eb0d91780">IERR</a></div><div class="ttdeci">#define IERR</div><div class="ttdef"><b>Definition:</b> <a href="a00122_source.html#l00009">basic.h:9</a></div></div>
<div class="ttc" id="a00129_html_ad3395a55a5fde64d6603c7a82d7bf2c7"><div class="ttname"><a href="a00129.html#ad3395a55a5fde64d6603c7a82d7bf2c7">_MODEL_NVARS_</a></div><div class="ttdeci">#define _MODEL_NVARS_</div><div class="ttdef"><b>Definition:</b> <a href="a00129_source.html#l00058">euler1d.h:58</a></div></div>
<div class="ttc" id="a00106_html_aa24a4f5e29bd70cbe5a2413be1ea9682"><div class="ttname"><a href="a00106.html#aa24a4f5e29bd70cbe5a2413be1ea9682">HyPar::dxinv</a></div><div class="ttdeci">double * dxinv</div><div class="ttdef"><b>Definition:</b> <a href="a00125_source.html#l00085">hypar.h:85</a></div></div>
<div class="ttc" id="a00099_html_acf2a05e3d7005c865c3e4f609cf728f8"><div class="ttname"><a href="a00099.html#acf2a05e3d7005c865c3e4f609cf728f8">Euler1D::SourceUpwind</a></div><div class="ttdeci">int(* SourceUpwind)(double *, double *, double *, double *, int, void *, double)</div><div class="ttdef"><b>Definition:</b> <a href="a00129_source.html#l00298">euler1d.h:298</a></div></div>
<div class="ttc" id="a00106_html_a38e0371f331cecbe63a77fa03e202afe"><div class="ttname"><a href="a00106.html#a38e0371f331cecbe63a77fa03e202afe">HyPar::dim_local</a></div><div class="ttdeci">int * dim_local</div><div class="ttdef"><b>Definition:</b> <a href="a00125_source.html#l00032">hypar.h:32</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a84fa9fe2c9c779fa314d02fd62df589f"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int Euler1DUpwindRoe </td>
          <td>(</td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>fI</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>fL</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>fR</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>uL</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>uR</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>u</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>dir</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>s</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>t</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Roe's upwinding scheme. </p><p class="formulaDsp">
\begin{equation} {\bf f}_{j+1/2} = \frac{1}{2}\left[ {\bf f}_{j+1/2}^L + {\bf f}_{j+1/2}^R - \left| A\left({\bf u}_{j+1/2}^L,{\bf u}_{j+1/2}^R\right) \right| \left( {\bf u}_{j+1/2}^R - {\bf u}_{j+1/2}^L \right)\right] \end{equation}
</p>
<ul>
<li>Roe, P. L., Approximate Riemann solvers, parameter vectors, and difference schemes, Journal of Computational Physics, Vol. 43, No. 2, 1981, pp. 357372, <a href="http://dx.doi.org/10.1016/0021-9991(81)90128-5">http://dx.doi.org/10.1016/0021-9991(81)90128-5</a>.</li>
</ul>
<p>This upwinding scheme is modified for the balanced discretization of the 1D Euler equations when there is a non-zero gravitational force. See the reference below. For flows without any gravitational forces, it reduces to its original form.</p><ul>
<li>Xing, Shu, "High Order Well-Balanced WENO Scheme for the Gas Dynamics Equations 
              Under Gravitational Fields", J. Sci. Comput., 54, 2013, pp. 645&ndash;662, <a href="http://dx.doi.org/10.1007/s10915-012-9585-8">http://dx.doi.org/10.1007/s10915-012-9585-8</a>. </li>
</ul>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">fI</td><td>Computed upwind interface flux </td></tr>
    <tr><td class="paramname">fL</td><td>Left-biased reconstructed interface flux </td></tr>
    <tr><td class="paramname">fR</td><td>Right-biased reconstructed interface flux </td></tr>
    <tr><td class="paramname">uL</td><td>Left-biased reconstructed interface solution </td></tr>
    <tr><td class="paramname">uR</td><td>Right-biased reconstructed interface solution </td></tr>
    <tr><td class="paramname">u</td><td>Cell-centered solution </td></tr>
    <tr><td class="paramname">dir</td><td>Spatial dimension (unused since this is a 1D system) </td></tr>
    <tr><td class="paramname">s</td><td>Solver object of type <a class="el" href="a00106.html" title="Structure containing all solver-specific variables and functions. ">HyPar</a> </td></tr>
    <tr><td class="paramname">t</td><td>Current solution time </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="a00281_source.html#l00029">29</a> of file <a class="el" href="a00281_source.html">Euler1DUpwind.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;{</div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;  <a class="code" href="a00106.html">HyPar</a>     *solver = (<a class="code" href="a00106.html">HyPar</a>*)    s;</div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;  <a class="code" href="a00099.html">Euler1D</a>   *param  = (<a class="code" href="a00099.html">Euler1D</a>*)  solver-&gt;<a class="code" href="a00106.html#a48e81a1806b5774943fd9a26e9a190f2">physics</a>;</div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;  <span class="keywordtype">int</span>       done,k;</div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;  <a class="code" href="a00122.html#a68f50121fb9a7daeaf60e50cdef82ef3">_DECLARE_IERR_</a>;</div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;</div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;  <span class="keywordtype">int</span> ndims = solver-&gt;<a class="code" href="a00106.html#a484873c74138512e41bc50d17b7d955a">ndims</a>;</div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;  <span class="keywordtype">int</span> ghosts= solver-&gt;<a class="code" href="a00106.html#aafc992b5fa79d5a4036024615d03bce6">ghosts</a>;</div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;  <span class="keywordtype">int</span> *dim  = solver-&gt;<a class="code" href="a00106.html#a38e0371f331cecbe63a77fa03e202afe">dim_local</a>;</div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;</div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;  <span class="keywordtype">int</span> index_outer[ndims], index_inter[ndims], bounds_outer[ndims], bounds_inter[ndims];</div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;  <a class="code" href="a00121.html#a89e8330d9e06dd0666c50833628a125c">_ArrayCopy1D_</a>(dim,bounds_outer,ndims); bounds_outer[dir] =  1;</div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;  <a class="code" href="a00121.html#a89e8330d9e06dd0666c50833628a125c">_ArrayCopy1D_</a>(dim,bounds_inter,ndims); bounds_inter[dir] += 1;</div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;  <span class="keyword">static</span> <span class="keywordtype">double</span> R[<a class="code" href="a00129.html#ad3395a55a5fde64d6603c7a82d7bf2c7">_MODEL_NVARS_</a>*<a class="code" href="a00129.html#ad3395a55a5fde64d6603c7a82d7bf2c7">_MODEL_NVARS_</a>], D[<a class="code" href="a00129.html#ad3395a55a5fde64d6603c7a82d7bf2c7">_MODEL_NVARS_</a>*<a class="code" href="a00129.html#ad3395a55a5fde64d6603c7a82d7bf2c7">_MODEL_NVARS_</a>], L[<a class="code" href="a00129.html#ad3395a55a5fde64d6603c7a82d7bf2c7">_MODEL_NVARS_</a>*<a class="code" href="a00129.html#ad3395a55a5fde64d6603c7a82d7bf2c7">_MODEL_NVARS_</a>], </div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;                DL[<a class="code" href="a00129.html#ad3395a55a5fde64d6603c7a82d7bf2c7">_MODEL_NVARS_</a>*<a class="code" href="a00129.html#ad3395a55a5fde64d6603c7a82d7bf2c7">_MODEL_NVARS_</a>], modA[<a class="code" href="a00129.html#ad3395a55a5fde64d6603c7a82d7bf2c7">_MODEL_NVARS_</a>*<a class="code" href="a00129.html#ad3395a55a5fde64d6603c7a82d7bf2c7">_MODEL_NVARS_</a>];</div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;</div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;  done = 0; <a class="code" href="a00121.html#a2b2826031c0cd92495ab351d3e599fc5">_ArraySetValue_</a>(index_outer,ndims,0);</div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;  <span class="keywordflow">while</span> (!done) {</div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;    <a class="code" href="a00121.html#a89e8330d9e06dd0666c50833628a125c">_ArrayCopy1D_</a>(index_outer,index_inter,ndims);</div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;    <span class="keywordflow">for</span> (index_inter[dir] = 0; index_inter[dir] &lt; bounds_inter[dir]; index_inter[dir]++) {</div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;      <span class="keywordtype">int</span> p; <a class="code" href="a00121.html#afbb862a2fdf5b72b1f9ace42f64b556f">_ArrayIndex1D_</a>(ndims,bounds_inter,index_inter,0,p);</div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;      <span class="keywordtype">int</span> indexL[ndims]; <a class="code" href="a00121.html#a89e8330d9e06dd0666c50833628a125c">_ArrayCopy1D_</a>(index_inter,indexL,ndims); indexL[dir]--;</div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;      <span class="keywordtype">int</span> indexR[ndims]; <a class="code" href="a00121.html#a89e8330d9e06dd0666c50833628a125c">_ArrayCopy1D_</a>(index_inter,indexR,ndims);</div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;      <span class="keywordtype">int</span> pL; <a class="code" href="a00121.html#afbb862a2fdf5b72b1f9ace42f64b556f">_ArrayIndex1D_</a>(ndims,dim,indexL,ghosts,pL);</div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;      <span class="keywordtype">int</span> pR; <a class="code" href="a00121.html#afbb862a2fdf5b72b1f9ace42f64b556f">_ArrayIndex1D_</a>(ndims,dim,indexR,ghosts,pR);</div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;      <span class="keywordtype">double</span> udiff[<a class="code" href="a00129.html#ad3395a55a5fde64d6603c7a82d7bf2c7">_MODEL_NVARS_</a>], uavg[<a class="code" href="a00129.html#ad3395a55a5fde64d6603c7a82d7bf2c7">_MODEL_NVARS_</a>],udiss[<a class="code" href="a00129.html#ad3395a55a5fde64d6603c7a82d7bf2c7">_MODEL_NVARS_</a>];</div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;</div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;      <span class="comment">/* Roe&#39;s upwinding scheme */</span></div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;</div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;      udiff[0] = 0.5 * (uR[<a class="code" href="a00129.html#ad3395a55a5fde64d6603c7a82d7bf2c7">_MODEL_NVARS_</a>*p+0] - uL[<a class="code" href="a00129.html#ad3395a55a5fde64d6603c7a82d7bf2c7">_MODEL_NVARS_</a>*p+0]);</div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;      udiff[1] = 0.5 * (uR[<a class="code" href="a00129.html#ad3395a55a5fde64d6603c7a82d7bf2c7">_MODEL_NVARS_</a>*p+1] - uL[<a class="code" href="a00129.html#ad3395a55a5fde64d6603c7a82d7bf2c7">_MODEL_NVARS_</a>*p+1]);</div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;      udiff[2] = 0.5 * (uR[<a class="code" href="a00129.html#ad3395a55a5fde64d6603c7a82d7bf2c7">_MODEL_NVARS_</a>*p+2] - uL[<a class="code" href="a00129.html#ad3395a55a5fde64d6603c7a82d7bf2c7">_MODEL_NVARS_</a>*p+2]);</div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;</div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;      <a class="code" href="a00129.html#a9a3e89dcf75e61433735d59b6556c346">_Euler1DRoeAverage_</a>         (uavg,(u+<a class="code" href="a00129.html#ad3395a55a5fde64d6603c7a82d7bf2c7">_MODEL_NVARS_</a>*pL),(u+<a class="code" href="a00129.html#ad3395a55a5fde64d6603c7a82d7bf2c7">_MODEL_NVARS_</a>*pR),param); </div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;      <a class="code" href="a00129.html#a115efdce970884e30c6564701f929092">_Euler1DEigenvalues_</a>        (uavg,D,param,0);</div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;      <a class="code" href="a00129.html#a413fd3cab5a06c9d7a38334768d81b0f">_Euler1DLeftEigenvectors_</a>   (uavg,L,param,0);</div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;      <a class="code" href="a00129.html#a4449638968eca76bb5631bc75b7dced7">_Euler1DRightEigenvectors_</a>  (uavg,R,param,0);</div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;</div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;      <span class="keywordtype">double</span> kappa = <a class="code" href="a00127.html#affe776513b24d84b39af8ab0930fef7f">max</a>(param-&gt;<a class="code" href="a00099.html#afb1265dc9bb8f8c05bd22f88c23d879c">grav_field</a>[pL],param-&gt;<a class="code" href="a00099.html#afb1265dc9bb8f8c05bd22f88c23d879c">grav_field</a>[pR]);</div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;      k = 0; D[k] = kappa*<a class="code" href="a00127.html#adf1be5ccbb7a2522b4f3a64043c72880">absolute</a>(D[k]);</div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;      k = 4; D[k] = kappa*<a class="code" href="a00127.html#adf1be5ccbb7a2522b4f3a64043c72880">absolute</a>(D[k]);</div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;      k = 8; D[k] = kappa*<a class="code" href="a00127.html#adf1be5ccbb7a2522b4f3a64043c72880">absolute</a>(D[k]);</div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;</div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;      <a class="code" href="a00127.html#ad08720847b0aef444876b608b7af9a5c">MatMult3</a>(3,DL,D,L);</div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;      <a class="code" href="a00127.html#ad08720847b0aef444876b608b7af9a5c">MatMult3</a>(3,modA,R,DL);</div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;</div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;      udiss[0] = modA[0*<a class="code" href="a00129.html#ad3395a55a5fde64d6603c7a82d7bf2c7">_MODEL_NVARS_</a>+0]*udiff[0] + modA[0*<a class="code" href="a00129.html#ad3395a55a5fde64d6603c7a82d7bf2c7">_MODEL_NVARS_</a>+1]*udiff[1] + modA[0*<a class="code" href="a00129.html#ad3395a55a5fde64d6603c7a82d7bf2c7">_MODEL_NVARS_</a>+2]*udiff[2];</div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;      udiss[1] = modA[1*<a class="code" href="a00129.html#ad3395a55a5fde64d6603c7a82d7bf2c7">_MODEL_NVARS_</a>+0]*udiff[0] + modA[1*<a class="code" href="a00129.html#ad3395a55a5fde64d6603c7a82d7bf2c7">_MODEL_NVARS_</a>+1]*udiff[1] + modA[1*<a class="code" href="a00129.html#ad3395a55a5fde64d6603c7a82d7bf2c7">_MODEL_NVARS_</a>+2]*udiff[2];</div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;      udiss[2] = modA[2*<a class="code" href="a00129.html#ad3395a55a5fde64d6603c7a82d7bf2c7">_MODEL_NVARS_</a>+0]*udiff[0] + modA[2*<a class="code" href="a00129.html#ad3395a55a5fde64d6603c7a82d7bf2c7">_MODEL_NVARS_</a>+1]*udiff[1] + modA[2*<a class="code" href="a00129.html#ad3395a55a5fde64d6603c7a82d7bf2c7">_MODEL_NVARS_</a>+2]*udiff[2];</div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;</div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;      fI[<a class="code" href="a00129.html#ad3395a55a5fde64d6603c7a82d7bf2c7">_MODEL_NVARS_</a>*p+0] = 0.5 * (fL[<a class="code" href="a00129.html#ad3395a55a5fde64d6603c7a82d7bf2c7">_MODEL_NVARS_</a>*p+0]+fR[<a class="code" href="a00129.html#ad3395a55a5fde64d6603c7a82d7bf2c7">_MODEL_NVARS_</a>*p+0]) - udiss[0];</div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;      fI[<a class="code" href="a00129.html#ad3395a55a5fde64d6603c7a82d7bf2c7">_MODEL_NVARS_</a>*p+1] = 0.5 * (fL[<a class="code" href="a00129.html#ad3395a55a5fde64d6603c7a82d7bf2c7">_MODEL_NVARS_</a>*p+1]+fR[<a class="code" href="a00129.html#ad3395a55a5fde64d6603c7a82d7bf2c7">_MODEL_NVARS_</a>*p+1]) - udiss[1];</div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;      fI[<a class="code" href="a00129.html#ad3395a55a5fde64d6603c7a82d7bf2c7">_MODEL_NVARS_</a>*p+2] = 0.5 * (fL[<a class="code" href="a00129.html#ad3395a55a5fde64d6603c7a82d7bf2c7">_MODEL_NVARS_</a>*p+2]+fR[<a class="code" href="a00129.html#ad3395a55a5fde64d6603c7a82d7bf2c7">_MODEL_NVARS_</a>*p+2]) - udiss[2];</div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;    }</div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;    <a class="code" href="a00121.html#ac5ec1371623f11d03b0f42adaa24acbc">_ArrayIncrementIndex_</a>(ndims,bounds_outer,index_outer,done);</div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;  }</div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;</div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;  <span class="keywordflow">return</span>(0);</div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;}</div>
<div class="ttc" id="a00122_html_a68f50121fb9a7daeaf60e50cdef82ef3"><div class="ttname"><a href="a00122.html#a68f50121fb9a7daeaf60e50cdef82ef3">_DECLARE_IERR_</a></div><div class="ttdeci">#define _DECLARE_IERR_</div><div class="ttdef"><b>Definition:</b> <a href="a00122_source.html#l00010">basic.h:10</a></div></div>
<div class="ttc" id="a00106_html_a484873c74138512e41bc50d17b7d955a"><div class="ttname"><a href="a00106.html#a484873c74138512e41bc50d17b7d955a">HyPar::ndims</a></div><div class="ttdeci">int ndims</div><div class="ttdef"><b>Definition:</b> <a href="a00125_source.html#l00023">hypar.h:23</a></div></div>
<div class="ttc" id="a00121_html_ac5ec1371623f11d03b0f42adaa24acbc"><div class="ttname"><a href="a00121.html#ac5ec1371623f11d03b0f42adaa24acbc">_ArrayIncrementIndex_</a></div><div class="ttdeci">#define _ArrayIncrementIndex_(N, imax, i, done)</div><div class="ttdef"><b>Definition:</b> <a href="a00121_source.html#l00122">arrayfunctions.h:122</a></div></div>
<div class="ttc" id="a00129_html_a4449638968eca76bb5631bc75b7dced7"><div class="ttname"><a href="a00129.html#a4449638968eca76bb5631bc75b7dced7">_Euler1DRightEigenvectors_</a></div><div class="ttdeci">#define _Euler1DRightEigenvectors_(u, R, p, dir)</div><div class="ttdef"><b>Definition:</b> <a href="a00129_source.html#l00247">euler1d.h:247</a></div></div>
<div class="ttc" id="a00129_html_a9a3e89dcf75e61433735d59b6556c346"><div class="ttname"><a href="a00129.html#a9a3e89dcf75e61433735d59b6556c346">_Euler1DRoeAverage_</a></div><div class="ttdeci">#define _Euler1DRoeAverage_(uavg, uL, uR, p)</div><div class="ttdef"><b>Definition:</b> <a href="a00129_source.html#l00167">euler1d.h:167</a></div></div>
<div class="ttc" id="a00121_html_a89e8330d9e06dd0666c50833628a125c"><div class="ttname"><a href="a00121.html#a89e8330d9e06dd0666c50833628a125c">_ArrayCopy1D_</a></div><div class="ttdeci">#define _ArrayCopy1D_(x, y, size)</div><div class="ttdef"><b>Definition:</b> <a href="a00121_source.html#l00281">arrayfunctions.h:281</a></div></div>
<div class="ttc" id="a00121_html_afbb862a2fdf5b72b1f9ace42f64b556f"><div class="ttname"><a href="a00121.html#afbb862a2fdf5b72b1f9ace42f64b556f">_ArrayIndex1D_</a></div><div class="ttdeci">#define _ArrayIndex1D_(N, imax, i, ghost, index)</div><div class="ttdef"><b>Definition:</b> <a href="a00121_source.html#l00036">arrayfunctions.h:36</a></div></div>
<div class="ttc" id="a00099_html"><div class="ttname"><a href="a00099.html">Euler1D</a></div><div class="ttdoc">Structure containing variables and parameters specific to the 1D Euler equations. This structure cont...</div><div class="ttdef"><b>Definition:</b> <a href="a00129_source.html#l00271">euler1d.h:271</a></div></div>
<div class="ttc" id="a00106_html"><div class="ttname"><a href="a00106.html">HyPar</a></div><div class="ttdoc">Structure containing all solver-specific variables and functions. </div><div class="ttdef"><b>Definition:</b> <a href="a00125_source.html#l00020">hypar.h:20</a></div></div>
<div class="ttc" id="a00106_html_a48e81a1806b5774943fd9a26e9a190f2"><div class="ttname"><a href="a00106.html#a48e81a1806b5774943fd9a26e9a190f2">HyPar::physics</a></div><div class="ttdeci">void * physics</div><div class="ttdef"><b>Definition:</b> <a href="a00125_source.html#l00231">hypar.h:231</a></div></div>
<div class="ttc" id="a00121_html_a2b2826031c0cd92495ab351d3e599fc5"><div class="ttname"><a href="a00121.html#a2b2826031c0cd92495ab351d3e599fc5">_ArraySetValue_</a></div><div class="ttdeci">#define _ArraySetValue_(x, size, value)</div><div class="ttdef"><b>Definition:</b> <a href="a00121_source.html#l00142">arrayfunctions.h:142</a></div></div>
<div class="ttc" id="a00106_html_aafc992b5fa79d5a4036024615d03bce6"><div class="ttname"><a href="a00106.html#aafc992b5fa79d5a4036024615d03bce6">HyPar::ghosts</a></div><div class="ttdeci">int ghosts</div><div class="ttdef"><b>Definition:</b> <a href="a00125_source.html#l00041">hypar.h:41</a></div></div>
<div class="ttc" id="a00127_html_ad08720847b0aef444876b608b7af9a5c"><div class="ttname"><a href="a00127.html#ad08720847b0aef444876b608b7af9a5c">MatMult3</a></div><div class="ttdeci">#define MatMult3(N, A, X, Y)</div><div class="ttdef"><b>Definition:</b> <a href="a00127_source.html#l00074">mathfunctions.h:74</a></div></div>
<div class="ttc" id="a00099_html_afb1265dc9bb8f8c05bd22f88c23d879c"><div class="ttname"><a href="a00099.html#afb1265dc9bb8f8c05bd22f88c23d879c">Euler1D::grav_field</a></div><div class="ttdeci">double * grav_field</div><div class="ttdef"><b>Definition:</b> <a href="a00129_source.html#l00286">euler1d.h:286</a></div></div>
<div class="ttc" id="a00129_html_a413fd3cab5a06c9d7a38334768d81b0f"><div class="ttname"><a href="a00129.html#a413fd3cab5a06c9d7a38334768d81b0f">_Euler1DLeftEigenvectors_</a></div><div class="ttdeci">#define _Euler1DLeftEigenvectors_(u, L, p, dir)</div><div class="ttdef"><b>Definition:</b> <a href="a00129_source.html#l00223">euler1d.h:223</a></div></div>
<div class="ttc" id="a00127_html_affe776513b24d84b39af8ab0930fef7f"><div class="ttname"><a href="a00127.html#affe776513b24d84b39af8ab0930fef7f">max</a></div><div class="ttdeci">#define max(a, b)</div><div class="ttdef"><b>Definition:</b> <a href="a00127_source.html#l00019">mathfunctions.h:19</a></div></div>
<div class="ttc" id="a00129_html_ad3395a55a5fde64d6603c7a82d7bf2c7"><div class="ttname"><a href="a00129.html#ad3395a55a5fde64d6603c7a82d7bf2c7">_MODEL_NVARS_</a></div><div class="ttdeci">#define _MODEL_NVARS_</div><div class="ttdef"><b>Definition:</b> <a href="a00129_source.html#l00058">euler1d.h:58</a></div></div>
<div class="ttc" id="a00127_html_adf1be5ccbb7a2522b4f3a64043c72880"><div class="ttname"><a href="a00127.html#adf1be5ccbb7a2522b4f3a64043c72880">absolute</a></div><div class="ttdeci">#define absolute(a)</div><div class="ttdef"><b>Definition:</b> <a href="a00127_source.html#l00033">mathfunctions.h:33</a></div></div>
<div class="ttc" id="a00106_html_a38e0371f331cecbe63a77fa03e202afe"><div class="ttname"><a href="a00106.html#a38e0371f331cecbe63a77fa03e202afe">HyPar::dim_local</a></div><div class="ttdeci">int * dim_local</div><div class="ttdef"><b>Definition:</b> <a href="a00125_source.html#l00032">hypar.h:32</a></div></div>
<div class="ttc" id="a00129_html_a115efdce970884e30c6564701f929092"><div class="ttname"><a href="a00129.html#a115efdce970884e30c6564701f929092">_Euler1DEigenvalues_</a></div><div class="ttdeci">#define _Euler1DEigenvalues_(u, D, p, dir)</div><div class="ttdef"><b>Definition:</b> <a href="a00129_source.html#l00205">euler1d.h:205</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a0632e000475600a07f89aaad0fcea2a2"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int Euler1DUpwinddFRoe </td>
          <td>(</td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>fI</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>fL</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>fR</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>uL</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>uR</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>u</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>dir</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>s</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>t</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>The Roe upwinding scheme (<a class="el" href="a00281.html#a6dc9d104ca58ca3ea0da7039fe5323c4">Euler1DUpwindRoe</a>) for the partitioned hyperbolic flux that comprises of the acoustic waves only (see <a class="el" href="a00275.html#a31b02a37de0ea8443f0dd89d5861e114">Euler1DStiffFlux</a>, <a class="el" href="a00129.html#a5329991de3157d264ef86a1df4ff6bef">_Euler1DSetStiffFlux_</a>). Thus, only the characteristic fields / eigen-modes corresponding to \( u\pm a\) are used. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">fI</td><td>Computed upwind interface flux </td></tr>
    <tr><td class="paramname">fL</td><td>Left-biased reconstructed interface flux </td></tr>
    <tr><td class="paramname">fR</td><td>Right-biased reconstructed interface flux </td></tr>
    <tr><td class="paramname">uL</td><td>Left-biased reconstructed interface solution </td></tr>
    <tr><td class="paramname">uR</td><td>Right-biased reconstructed interface solution </td></tr>
    <tr><td class="paramname">u</td><td>Cell-centered solution </td></tr>
    <tr><td class="paramname">dir</td><td>Spatial dimension (unused since this is a 1D system) </td></tr>
    <tr><td class="paramname">s</td><td>Solver object of type <a class="el" href="a00106.html" title="Structure containing all solver-specific variables and functions. ">HyPar</a> </td></tr>
    <tr><td class="paramname">t</td><td>Current solution time </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="a00281_source.html#l00370">370</a> of file <a class="el" href="a00281_source.html">Euler1DUpwind.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;{</div>
<div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;  <a class="code" href="a00106.html">HyPar</a>     *solver = (<a class="code" href="a00106.html">HyPar</a>*)    s;</div>
<div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;  <a class="code" href="a00099.html">Euler1D</a>   *param  = (<a class="code" href="a00099.html">Euler1D</a>*)  solver-&gt;<a class="code" href="a00106.html#a48e81a1806b5774943fd9a26e9a190f2">physics</a>;</div>
<div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;  <span class="keywordtype">int</span>       done,k;</div>
<div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;  <a class="code" href="a00122.html#a68f50121fb9a7daeaf60e50cdef82ef3">_DECLARE_IERR_</a>;</div>
<div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;</div>
<div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;  <span class="keywordtype">int</span>     ndims = solver-&gt;<a class="code" href="a00106.html#a484873c74138512e41bc50d17b7d955a">ndims</a>;</div>
<div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;  <span class="keywordtype">int</span>     ghosts= solver-&gt;<a class="code" href="a00106.html#aafc992b5fa79d5a4036024615d03bce6">ghosts</a>;</div>
<div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;  <span class="keywordtype">int</span>     *dim  = solver-&gt;<a class="code" href="a00106.html#a38e0371f331cecbe63a77fa03e202afe">dim_local</a>;</div>
<div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;  <span class="keywordtype">double</span>  *uref = param-&gt;<a class="code" href="a00099.html#a7568fac4d4e8488510e1d37f468967b1">solution</a>;</div>
<div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;</div>
<div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;  <span class="keywordtype">int</span> index_outer[ndims], index_inter[ndims], bounds_outer[ndims], bounds_inter[ndims];</div>
<div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;  <a class="code" href="a00121.html#a89e8330d9e06dd0666c50833628a125c">_ArrayCopy1D_</a>(dim,bounds_outer,ndims); bounds_outer[dir] =  1;</div>
<div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;  <a class="code" href="a00121.html#a89e8330d9e06dd0666c50833628a125c">_ArrayCopy1D_</a>(dim,bounds_inter,ndims); bounds_inter[dir] += 1;</div>
<div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;  <span class="keyword">static</span> <span class="keywordtype">double</span> R[<a class="code" href="a00129.html#ad3395a55a5fde64d6603c7a82d7bf2c7">_MODEL_NVARS_</a>*<a class="code" href="a00129.html#ad3395a55a5fde64d6603c7a82d7bf2c7">_MODEL_NVARS_</a>], D[<a class="code" href="a00129.html#ad3395a55a5fde64d6603c7a82d7bf2c7">_MODEL_NVARS_</a>*<a class="code" href="a00129.html#ad3395a55a5fde64d6603c7a82d7bf2c7">_MODEL_NVARS_</a>], L[<a class="code" href="a00129.html#ad3395a55a5fde64d6603c7a82d7bf2c7">_MODEL_NVARS_</a>*<a class="code" href="a00129.html#ad3395a55a5fde64d6603c7a82d7bf2c7">_MODEL_NVARS_</a>], </div>
<div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;                DL[<a class="code" href="a00129.html#ad3395a55a5fde64d6603c7a82d7bf2c7">_MODEL_NVARS_</a>*<a class="code" href="a00129.html#ad3395a55a5fde64d6603c7a82d7bf2c7">_MODEL_NVARS_</a>], modA[<a class="code" href="a00129.html#ad3395a55a5fde64d6603c7a82d7bf2c7">_MODEL_NVARS_</a>*<a class="code" href="a00129.html#ad3395a55a5fde64d6603c7a82d7bf2c7">_MODEL_NVARS_</a>];</div>
<div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;</div>
<div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;  done = 0; <a class="code" href="a00121.html#a2b2826031c0cd92495ab351d3e599fc5">_ArraySetValue_</a>(index_outer,ndims,0);</div>
<div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;  <span class="keywordflow">while</span> (!done) {</div>
<div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;    <a class="code" href="a00121.html#a89e8330d9e06dd0666c50833628a125c">_ArrayCopy1D_</a>(index_outer,index_inter,ndims);</div>
<div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;    <span class="keywordflow">for</span> (index_inter[dir] = 0; index_inter[dir] &lt; bounds_inter[dir]; index_inter[dir]++) {</div>
<div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;      <span class="keywordtype">int</span> p; <a class="code" href="a00121.html#afbb862a2fdf5b72b1f9ace42f64b556f">_ArrayIndex1D_</a>(ndims,bounds_inter,index_inter,0,p);</div>
<div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;      <span class="keywordtype">int</span> indexL[ndims]; <a class="code" href="a00121.html#a89e8330d9e06dd0666c50833628a125c">_ArrayCopy1D_</a>(index_inter,indexL,ndims); indexL[dir]--;</div>
<div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;      <span class="keywordtype">int</span> indexR[ndims]; <a class="code" href="a00121.html#a89e8330d9e06dd0666c50833628a125c">_ArrayCopy1D_</a>(index_inter,indexR,ndims);</div>
<div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;      <span class="keywordtype">int</span> pL; <a class="code" href="a00121.html#afbb862a2fdf5b72b1f9ace42f64b556f">_ArrayIndex1D_</a>(ndims,dim,indexL,ghosts,pL);</div>
<div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;      <span class="keywordtype">int</span> pR; <a class="code" href="a00121.html#afbb862a2fdf5b72b1f9ace42f64b556f">_ArrayIndex1D_</a>(ndims,dim,indexR,ghosts,pR);</div>
<div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;      <span class="keywordtype">double</span> udiff[<a class="code" href="a00129.html#ad3395a55a5fde64d6603c7a82d7bf2c7">_MODEL_NVARS_</a>], uavg[<a class="code" href="a00129.html#ad3395a55a5fde64d6603c7a82d7bf2c7">_MODEL_NVARS_</a>],udiss[<a class="code" href="a00129.html#ad3395a55a5fde64d6603c7a82d7bf2c7">_MODEL_NVARS_</a>];</div>
<div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;</div>
<div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;      <span class="comment">/* Roe&#39;s upwinding scheme */</span></div>
<div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;</div>
<div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;      udiff[0] = 0.5 * (uR[<a class="code" href="a00129.html#ad3395a55a5fde64d6603c7a82d7bf2c7">_MODEL_NVARS_</a>*p+0] - uL[<a class="code" href="a00129.html#ad3395a55a5fde64d6603c7a82d7bf2c7">_MODEL_NVARS_</a>*p+0]);</div>
<div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;      udiff[1] = 0.5 * (uR[<a class="code" href="a00129.html#ad3395a55a5fde64d6603c7a82d7bf2c7">_MODEL_NVARS_</a>*p+1] - uL[<a class="code" href="a00129.html#ad3395a55a5fde64d6603c7a82d7bf2c7">_MODEL_NVARS_</a>*p+1]);</div>
<div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;      udiff[2] = 0.5 * (uR[<a class="code" href="a00129.html#ad3395a55a5fde64d6603c7a82d7bf2c7">_MODEL_NVARS_</a>*p+2] - uL[<a class="code" href="a00129.html#ad3395a55a5fde64d6603c7a82d7bf2c7">_MODEL_NVARS_</a>*p+2]);</div>
<div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;</div>
<div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;      <a class="code" href="a00129.html#a9a3e89dcf75e61433735d59b6556c346">_Euler1DRoeAverage_</a>         (uavg,(uref+<a class="code" href="a00129.html#ad3395a55a5fde64d6603c7a82d7bf2c7">_MODEL_NVARS_</a>*pL),(uref+<a class="code" href="a00129.html#ad3395a55a5fde64d6603c7a82d7bf2c7">_MODEL_NVARS_</a>*pR),param); </div>
<div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;      <a class="code" href="a00129.html#a115efdce970884e30c6564701f929092">_Euler1DEigenvalues_</a>        (uavg,D,param,0);</div>
<div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;      <a class="code" href="a00129.html#a413fd3cab5a06c9d7a38334768d81b0f">_Euler1DLeftEigenvectors_</a>   (uavg,L,param,0);</div>
<div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;      <a class="code" href="a00129.html#a4449638968eca76bb5631bc75b7dced7">_Euler1DRightEigenvectors_</a>  (uavg,R,param,0);</div>
<div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;</div>
<div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;      <span class="keywordtype">double</span> kappa = <a class="code" href="a00127.html#affe776513b24d84b39af8ab0930fef7f">max</a>(param-&gt;<a class="code" href="a00099.html#afb1265dc9bb8f8c05bd22f88c23d879c">grav_field</a>[pL],param-&gt;<a class="code" href="a00099.html#afb1265dc9bb8f8c05bd22f88c23d879c">grav_field</a>[pR]);</div>
<div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;      k = 0; D[k] = 0.0; </div>
<div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;      k = 4; D[k] = kappa*<a class="code" href="a00127.html#adf1be5ccbb7a2522b4f3a64043c72880">absolute</a>(D[k]);</div>
<div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;      k = 8; D[k] = kappa*<a class="code" href="a00127.html#adf1be5ccbb7a2522b4f3a64043c72880">absolute</a>(D[k]);</div>
<div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;</div>
<div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;      <a class="code" href="a00127.html#ad08720847b0aef444876b608b7af9a5c">MatMult3</a>(3,DL,D,L);</div>
<div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;      <a class="code" href="a00127.html#ad08720847b0aef444876b608b7af9a5c">MatMult3</a>(3,modA,R,DL);</div>
<div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;</div>
<div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;      udiss[0] = modA[0*<a class="code" href="a00129.html#ad3395a55a5fde64d6603c7a82d7bf2c7">_MODEL_NVARS_</a>+0]*udiff[0] + modA[0*<a class="code" href="a00129.html#ad3395a55a5fde64d6603c7a82d7bf2c7">_MODEL_NVARS_</a>+1]*udiff[1] + modA[0*<a class="code" href="a00129.html#ad3395a55a5fde64d6603c7a82d7bf2c7">_MODEL_NVARS_</a>+2]*udiff[2];</div>
<div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;      udiss[1] = modA[1*<a class="code" href="a00129.html#ad3395a55a5fde64d6603c7a82d7bf2c7">_MODEL_NVARS_</a>+0]*udiff[0] + modA[1*<a class="code" href="a00129.html#ad3395a55a5fde64d6603c7a82d7bf2c7">_MODEL_NVARS_</a>+1]*udiff[1] + modA[1*<a class="code" href="a00129.html#ad3395a55a5fde64d6603c7a82d7bf2c7">_MODEL_NVARS_</a>+2]*udiff[2];</div>
<div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;      udiss[2] = modA[2*<a class="code" href="a00129.html#ad3395a55a5fde64d6603c7a82d7bf2c7">_MODEL_NVARS_</a>+0]*udiff[0] + modA[2*<a class="code" href="a00129.html#ad3395a55a5fde64d6603c7a82d7bf2c7">_MODEL_NVARS_</a>+1]*udiff[1] + modA[2*<a class="code" href="a00129.html#ad3395a55a5fde64d6603c7a82d7bf2c7">_MODEL_NVARS_</a>+2]*udiff[2];</div>
<div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;</div>
<div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;      fI[<a class="code" href="a00129.html#ad3395a55a5fde64d6603c7a82d7bf2c7">_MODEL_NVARS_</a>*p+0] = 0.5 * (fL[<a class="code" href="a00129.html#ad3395a55a5fde64d6603c7a82d7bf2c7">_MODEL_NVARS_</a>*p+0]+fR[<a class="code" href="a00129.html#ad3395a55a5fde64d6603c7a82d7bf2c7">_MODEL_NVARS_</a>*p+0]) - udiss[0];</div>
<div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;      fI[<a class="code" href="a00129.html#ad3395a55a5fde64d6603c7a82d7bf2c7">_MODEL_NVARS_</a>*p+1] = 0.5 * (fL[<a class="code" href="a00129.html#ad3395a55a5fde64d6603c7a82d7bf2c7">_MODEL_NVARS_</a>*p+1]+fR[<a class="code" href="a00129.html#ad3395a55a5fde64d6603c7a82d7bf2c7">_MODEL_NVARS_</a>*p+1]) - udiss[1];</div>
<div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;      fI[<a class="code" href="a00129.html#ad3395a55a5fde64d6603c7a82d7bf2c7">_MODEL_NVARS_</a>*p+2] = 0.5 * (fL[<a class="code" href="a00129.html#ad3395a55a5fde64d6603c7a82d7bf2c7">_MODEL_NVARS_</a>*p+2]+fR[<a class="code" href="a00129.html#ad3395a55a5fde64d6603c7a82d7bf2c7">_MODEL_NVARS_</a>*p+2]) - udiss[2];</div>
<div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;    }</div>
<div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;    <a class="code" href="a00121.html#ac5ec1371623f11d03b0f42adaa24acbc">_ArrayIncrementIndex_</a>(ndims,bounds_outer,index_outer,done);</div>
<div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;  }</div>
<div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;</div>
<div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;  <span class="keywordflow">return</span>(0);</div>
<div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;}</div>
<div class="ttc" id="a00122_html_a68f50121fb9a7daeaf60e50cdef82ef3"><div class="ttname"><a href="a00122.html#a68f50121fb9a7daeaf60e50cdef82ef3">_DECLARE_IERR_</a></div><div class="ttdeci">#define _DECLARE_IERR_</div><div class="ttdef"><b>Definition:</b> <a href="a00122_source.html#l00010">basic.h:10</a></div></div>
<div class="ttc" id="a00106_html_a484873c74138512e41bc50d17b7d955a"><div class="ttname"><a href="a00106.html#a484873c74138512e41bc50d17b7d955a">HyPar::ndims</a></div><div class="ttdeci">int ndims</div><div class="ttdef"><b>Definition:</b> <a href="a00125_source.html#l00023">hypar.h:23</a></div></div>
<div class="ttc" id="a00121_html_ac5ec1371623f11d03b0f42adaa24acbc"><div class="ttname"><a href="a00121.html#ac5ec1371623f11d03b0f42adaa24acbc">_ArrayIncrementIndex_</a></div><div class="ttdeci">#define _ArrayIncrementIndex_(N, imax, i, done)</div><div class="ttdef"><b>Definition:</b> <a href="a00121_source.html#l00122">arrayfunctions.h:122</a></div></div>
<div class="ttc" id="a00129_html_a4449638968eca76bb5631bc75b7dced7"><div class="ttname"><a href="a00129.html#a4449638968eca76bb5631bc75b7dced7">_Euler1DRightEigenvectors_</a></div><div class="ttdeci">#define _Euler1DRightEigenvectors_(u, R, p, dir)</div><div class="ttdef"><b>Definition:</b> <a href="a00129_source.html#l00247">euler1d.h:247</a></div></div>
<div class="ttc" id="a00129_html_a9a3e89dcf75e61433735d59b6556c346"><div class="ttname"><a href="a00129.html#a9a3e89dcf75e61433735d59b6556c346">_Euler1DRoeAverage_</a></div><div class="ttdeci">#define _Euler1DRoeAverage_(uavg, uL, uR, p)</div><div class="ttdef"><b>Definition:</b> <a href="a00129_source.html#l00167">euler1d.h:167</a></div></div>
<div class="ttc" id="a00121_html_a89e8330d9e06dd0666c50833628a125c"><div class="ttname"><a href="a00121.html#a89e8330d9e06dd0666c50833628a125c">_ArrayCopy1D_</a></div><div class="ttdeci">#define _ArrayCopy1D_(x, y, size)</div><div class="ttdef"><b>Definition:</b> <a href="a00121_source.html#l00281">arrayfunctions.h:281</a></div></div>
<div class="ttc" id="a00121_html_afbb862a2fdf5b72b1f9ace42f64b556f"><div class="ttname"><a href="a00121.html#afbb862a2fdf5b72b1f9ace42f64b556f">_ArrayIndex1D_</a></div><div class="ttdeci">#define _ArrayIndex1D_(N, imax, i, ghost, index)</div><div class="ttdef"><b>Definition:</b> <a href="a00121_source.html#l00036">arrayfunctions.h:36</a></div></div>
<div class="ttc" id="a00099_html"><div class="ttname"><a href="a00099.html">Euler1D</a></div><div class="ttdoc">Structure containing variables and parameters specific to the 1D Euler equations. This structure cont...</div><div class="ttdef"><b>Definition:</b> <a href="a00129_source.html#l00271">euler1d.h:271</a></div></div>
<div class="ttc" id="a00106_html"><div class="ttname"><a href="a00106.html">HyPar</a></div><div class="ttdoc">Structure containing all solver-specific variables and functions. </div><div class="ttdef"><b>Definition:</b> <a href="a00125_source.html#l00020">hypar.h:20</a></div></div>
<div class="ttc" id="a00099_html_a7568fac4d4e8488510e1d37f468967b1"><div class="ttname"><a href="a00099.html#a7568fac4d4e8488510e1d37f468967b1">Euler1D::solution</a></div><div class="ttdeci">double * solution</div><div class="ttdef"><b>Definition:</b> <a href="a00129_source.html#l00288">euler1d.h:288</a></div></div>
<div class="ttc" id="a00106_html_a48e81a1806b5774943fd9a26e9a190f2"><div class="ttname"><a href="a00106.html#a48e81a1806b5774943fd9a26e9a190f2">HyPar::physics</a></div><div class="ttdeci">void * physics</div><div class="ttdef"><b>Definition:</b> <a href="a00125_source.html#l00231">hypar.h:231</a></div></div>
<div class="ttc" id="a00121_html_a2b2826031c0cd92495ab351d3e599fc5"><div class="ttname"><a href="a00121.html#a2b2826031c0cd92495ab351d3e599fc5">_ArraySetValue_</a></div><div class="ttdeci">#define _ArraySetValue_(x, size, value)</div><div class="ttdef"><b>Definition:</b> <a href="a00121_source.html#l00142">arrayfunctions.h:142</a></div></div>
<div class="ttc" id="a00106_html_aafc992b5fa79d5a4036024615d03bce6"><div class="ttname"><a href="a00106.html#aafc992b5fa79d5a4036024615d03bce6">HyPar::ghosts</a></div><div class="ttdeci">int ghosts</div><div class="ttdef"><b>Definition:</b> <a href="a00125_source.html#l00041">hypar.h:41</a></div></div>
<div class="ttc" id="a00127_html_ad08720847b0aef444876b608b7af9a5c"><div class="ttname"><a href="a00127.html#ad08720847b0aef444876b608b7af9a5c">MatMult3</a></div><div class="ttdeci">#define MatMult3(N, A, X, Y)</div><div class="ttdef"><b>Definition:</b> <a href="a00127_source.html#l00074">mathfunctions.h:74</a></div></div>
<div class="ttc" id="a00099_html_afb1265dc9bb8f8c05bd22f88c23d879c"><div class="ttname"><a href="a00099.html#afb1265dc9bb8f8c05bd22f88c23d879c">Euler1D::grav_field</a></div><div class="ttdeci">double * grav_field</div><div class="ttdef"><b>Definition:</b> <a href="a00129_source.html#l00286">euler1d.h:286</a></div></div>
<div class="ttc" id="a00129_html_a413fd3cab5a06c9d7a38334768d81b0f"><div class="ttname"><a href="a00129.html#a413fd3cab5a06c9d7a38334768d81b0f">_Euler1DLeftEigenvectors_</a></div><div class="ttdeci">#define _Euler1DLeftEigenvectors_(u, L, p, dir)</div><div class="ttdef"><b>Definition:</b> <a href="a00129_source.html#l00223">euler1d.h:223</a></div></div>
<div class="ttc" id="a00127_html_affe776513b24d84b39af8ab0930fef7f"><div class="ttname"><a href="a00127.html#affe776513b24d84b39af8ab0930fef7f">max</a></div><div class="ttdeci">#define max(a, b)</div><div class="ttdef"><b>Definition:</b> <a href="a00127_source.html#l00019">mathfunctions.h:19</a></div></div>
<div class="ttc" id="a00129_html_ad3395a55a5fde64d6603c7a82d7bf2c7"><div class="ttname"><a href="a00129.html#ad3395a55a5fde64d6603c7a82d7bf2c7">_MODEL_NVARS_</a></div><div class="ttdeci">#define _MODEL_NVARS_</div><div class="ttdef"><b>Definition:</b> <a href="a00129_source.html#l00058">euler1d.h:58</a></div></div>
<div class="ttc" id="a00127_html_adf1be5ccbb7a2522b4f3a64043c72880"><div class="ttname"><a href="a00127.html#adf1be5ccbb7a2522b4f3a64043c72880">absolute</a></div><div class="ttdeci">#define absolute(a)</div><div class="ttdef"><b>Definition:</b> <a href="a00127_source.html#l00033">mathfunctions.h:33</a></div></div>
<div class="ttc" id="a00106_html_a38e0371f331cecbe63a77fa03e202afe"><div class="ttname"><a href="a00106.html#a38e0371f331cecbe63a77fa03e202afe">HyPar::dim_local</a></div><div class="ttdeci">int * dim_local</div><div class="ttdef"><b>Definition:</b> <a href="a00125_source.html#l00032">hypar.h:32</a></div></div>
<div class="ttc" id="a00129_html_a115efdce970884e30c6564701f929092"><div class="ttname"><a href="a00129.html#a115efdce970884e30c6564701f929092">_Euler1DEigenvalues_</a></div><div class="ttdeci">#define _Euler1DEigenvalues_(u, D, p, dir)</div><div class="ttdef"><b>Definition:</b> <a href="a00129_source.html#l00205">euler1d.h:205</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="aecab791493af24dbb79224ccdd1c22cd"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int Euler1DUpwindRF </td>
          <td>(</td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>fI</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>fL</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>fR</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>uL</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>uR</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>u</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>dir</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>s</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>t</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Characteristic-based Roe-fixed upwinding scheme. </p><p class="formulaDsp">
\begin{align} \alpha_{j+1/2}^{k,L} &amp;= \sum_{k=1}^3 {\bf l}_{j+1/2}^k \cdot {\bf f}_{j+1/2}^{k,L}, \\ \alpha_{j+1/2}^{k,R} &amp;= \sum_{k=1}^3 {\bf l}_{j+1/2}^k \cdot {\bf f}_{j+1/2}^{k,R}, \\ v_{j+1/2}^{k,L} &amp;= \sum_{k=1}^3 {\bf l}_{j+1/2}^k \cdot {\bf u}_{j+1/2}^{k,L}, \\ v_{j+1/2}^{k,R} &amp;= \sum_{k=1}^3 {\bf l}_{j+1/2}^k \cdot {\bf u}_{j+1/2}^{k,R}, \\ \alpha_{j+1/2}^k &amp;= \left\{ \begin{array}{cc} \alpha_{j+1/2}^{k,L} &amp; {\rm if}\ \lambda_{j,j+1/2,j+1} &gt; 0 \\ \alpha_{j+1/2}^{k,R} &amp; {\rm if}\ \lambda_{j,j+1/2,j+1} &lt; 0 \\ \frac{1}{2}\left[ \alpha_{j+1/2}^{k,L} + \alpha_{j+1/2}^{k,R} - \left(\max_{\left[j,j+1\right]} \lambda\right) \left( v_{j+1/2}^{k,R} - v_{j+1/2}^{k,L} \right) \right] &amp; {\rm otherwise} \end{array}\right., \\ {\bf f}_{j+1/2} &amp;= \sum_{k=1}^3 \alpha_{j+1/2}^k {\bf r}_{j+1/2}^k \end{align}
</p>
<p> where \({\bf l}\), \({\bf r}\), and \(\lambda\) are the left-eigenvectors, right-eigenvectors and eigenvalues. The subscripts denote the grid locations.</p><ul>
<li>C.-W. Shu, and S. Osher, "Efficient implementation of essentially non-oscillatory schemes, II", J. Comput. Phys., 83 (1989), pp. 3278, <a href="http://dx.doi.org/10.1016/0021-9991(89)90222-2">http://dx.doi.org/10.1016/0021-9991(89)90222-2</a>.</li>
</ul>
<p>Note that this upwinding scheme cannot be used for solving flows with non-zero gravitational forces. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">fI</td><td>Computed upwind interface flux </td></tr>
    <tr><td class="paramname">fL</td><td>Left-biased reconstructed interface flux </td></tr>
    <tr><td class="paramname">fR</td><td>Right-biased reconstructed interface flux </td></tr>
    <tr><td class="paramname">uL</td><td>Left-biased reconstructed interface solution </td></tr>
    <tr><td class="paramname">uR</td><td>Right-biased reconstructed interface solution </td></tr>
    <tr><td class="paramname">u</td><td>Cell-centered solution </td></tr>
    <tr><td class="paramname">dir</td><td>Spatial dimension (unused since this is a 1D system) </td></tr>
    <tr><td class="paramname">s</td><td>Solver object of type <a class="el" href="a00106.html" title="Structure containing all solver-specific variables and functions. ">HyPar</a> </td></tr>
    <tr><td class="paramname">t</td><td>Current solution time </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="a00281_source.html#l00114">114</a> of file <a class="el" href="a00281_source.html">Euler1DUpwind.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;{</div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;  <a class="code" href="a00106.html">HyPar</a>     *solver = (<a class="code" href="a00106.html">HyPar</a>*)    s;</div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;  <a class="code" href="a00099.html">Euler1D</a>   *param  = (<a class="code" href="a00099.html">Euler1D</a>*)  solver-&gt;<a class="code" href="a00106.html#a48e81a1806b5774943fd9a26e9a190f2">physics</a>;</div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;  <span class="keywordtype">int</span>       done,k;</div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;  <a class="code" href="a00122.html#a68f50121fb9a7daeaf60e50cdef82ef3">_DECLARE_IERR_</a>;</div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;</div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;  <span class="keywordtype">int</span> ndims   = solver-&gt;<a class="code" href="a00106.html#a484873c74138512e41bc50d17b7d955a">ndims</a>;</div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;  <span class="keywordtype">int</span> *dim    = solver-&gt;<a class="code" href="a00106.html#a38e0371f331cecbe63a77fa03e202afe">dim_local</a>;</div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;  <span class="keywordtype">int</span> ghosts  = solver-&gt;<a class="code" href="a00106.html#aafc992b5fa79d5a4036024615d03bce6">ghosts</a>;</div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;</div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;  <span class="keywordtype">int</span> index_outer[ndims], index_inter[ndims], bounds_outer[ndims], bounds_inter[ndims];</div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;  <a class="code" href="a00121.html#a89e8330d9e06dd0666c50833628a125c">_ArrayCopy1D_</a>(dim,bounds_outer,ndims); bounds_outer[dir] =  1;</div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;  <a class="code" href="a00121.html#a89e8330d9e06dd0666c50833628a125c">_ArrayCopy1D_</a>(dim,bounds_inter,ndims); bounds_inter[dir] += 1;</div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;  <span class="keyword">static</span> <span class="keywordtype">double</span> R[<a class="code" href="a00129.html#ad3395a55a5fde64d6603c7a82d7bf2c7">_MODEL_NVARS_</a>*<a class="code" href="a00129.html#ad3395a55a5fde64d6603c7a82d7bf2c7">_MODEL_NVARS_</a>], D[<a class="code" href="a00129.html#ad3395a55a5fde64d6603c7a82d7bf2c7">_MODEL_NVARS_</a>*<a class="code" href="a00129.html#ad3395a55a5fde64d6603c7a82d7bf2c7">_MODEL_NVARS_</a>], L[<a class="code" href="a00129.html#ad3395a55a5fde64d6603c7a82d7bf2c7">_MODEL_NVARS_</a>*<a class="code" href="a00129.html#ad3395a55a5fde64d6603c7a82d7bf2c7">_MODEL_NVARS_</a>];</div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;</div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;  done = 0; <a class="code" href="a00121.html#a2b2826031c0cd92495ab351d3e599fc5">_ArraySetValue_</a>(index_outer,ndims,0);</div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;  <span class="keywordflow">while</span> (!done) {</div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;    <a class="code" href="a00121.html#a89e8330d9e06dd0666c50833628a125c">_ArrayCopy1D_</a>(index_outer,index_inter,ndims);</div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;    <span class="keywordflow">for</span> (index_inter[dir] = 0; index_inter[dir] &lt; bounds_inter[dir]; index_inter[dir]++) {</div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;      <span class="keywordtype">int</span> p; <a class="code" href="a00121.html#afbb862a2fdf5b72b1f9ace42f64b556f">_ArrayIndex1D_</a>(ndims,bounds_inter,index_inter,0,p);</div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;      <span class="keywordtype">int</span> indexL[ndims]; <a class="code" href="a00121.html#a89e8330d9e06dd0666c50833628a125c">_ArrayCopy1D_</a>(index_inter,indexL,ndims); indexL[dir]--;</div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;      <span class="keywordtype">int</span> indexR[ndims]; <a class="code" href="a00121.html#a89e8330d9e06dd0666c50833628a125c">_ArrayCopy1D_</a>(index_inter,indexR,ndims);</div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;      <span class="keywordtype">int</span> pL; <a class="code" href="a00121.html#afbb862a2fdf5b72b1f9ace42f64b556f">_ArrayIndex1D_</a>(ndims,dim,indexL,ghosts,pL);</div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;      <span class="keywordtype">int</span> pR; <a class="code" href="a00121.html#afbb862a2fdf5b72b1f9ace42f64b556f">_ArrayIndex1D_</a>(ndims,dim,indexR,ghosts,pR);</div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;      <span class="keywordtype">double</span> uavg[<a class="code" href="a00129.html#ad3395a55a5fde64d6603c7a82d7bf2c7">_MODEL_NVARS_</a>], fcL[<a class="code" href="a00129.html#ad3395a55a5fde64d6603c7a82d7bf2c7">_MODEL_NVARS_</a>], fcR[<a class="code" href="a00129.html#ad3395a55a5fde64d6603c7a82d7bf2c7">_MODEL_NVARS_</a>], </div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;             ucL[<a class="code" href="a00129.html#ad3395a55a5fde64d6603c7a82d7bf2c7">_MODEL_NVARS_</a>], ucR[<a class="code" href="a00129.html#ad3395a55a5fde64d6603c7a82d7bf2c7">_MODEL_NVARS_</a>], fc[<a class="code" href="a00129.html#ad3395a55a5fde64d6603c7a82d7bf2c7">_MODEL_NVARS_</a>];</div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;      <span class="keywordtype">double</span> kappa = <a class="code" href="a00127.html#affe776513b24d84b39af8ab0930fef7f">max</a>(param-&gt;<a class="code" href="a00099.html#afb1265dc9bb8f8c05bd22f88c23d879c">grav_field</a>[pL],param-&gt;<a class="code" href="a00099.html#afb1265dc9bb8f8c05bd22f88c23d879c">grav_field</a>[pR]);</div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;</div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;      <span class="comment">/* Roe-Fixed upwinding scheme */</span></div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;</div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;      <a class="code" href="a00129.html#a9a3e89dcf75e61433735d59b6556c346">_Euler1DRoeAverage_</a>       (uavg,(u+<a class="code" href="a00129.html#ad3395a55a5fde64d6603c7a82d7bf2c7">_MODEL_NVARS_</a>*pL),(u+<a class="code" href="a00129.html#ad3395a55a5fde64d6603c7a82d7bf2c7">_MODEL_NVARS_</a>*pR),param);</div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;      <a class="code" href="a00129.html#a115efdce970884e30c6564701f929092">_Euler1DEigenvalues_</a>      (uavg,D,param,0);</div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;      <a class="code" href="a00129.html#a413fd3cab5a06c9d7a38334768d81b0f">_Euler1DLeftEigenvectors_</a> (uavg,L,param,0);</div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;      <a class="code" href="a00129.html#a4449638968eca76bb5631bc75b7dced7">_Euler1DRightEigenvectors_</a>(uavg,R,param,0);</div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;</div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;      <span class="comment">/* calculate characteristic fluxes and variables */</span></div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;      <a class="code" href="a00127.html#abf4f45dbf1a3ea84452ba1da7b526d71">MatVecMult3</a>(<a class="code" href="a00129.html#ad3395a55a5fde64d6603c7a82d7bf2c7">_MODEL_NVARS_</a>,ucL,L,(uL+<a class="code" href="a00129.html#ad3395a55a5fde64d6603c7a82d7bf2c7">_MODEL_NVARS_</a>*p));</div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;      <a class="code" href="a00127.html#abf4f45dbf1a3ea84452ba1da7b526d71">MatVecMult3</a>(<a class="code" href="a00129.html#ad3395a55a5fde64d6603c7a82d7bf2c7">_MODEL_NVARS_</a>,ucR,L,(uR+<a class="code" href="a00129.html#ad3395a55a5fde64d6603c7a82d7bf2c7">_MODEL_NVARS_</a>*p));</div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;      <a class="code" href="a00127.html#abf4f45dbf1a3ea84452ba1da7b526d71">MatVecMult3</a>(<a class="code" href="a00129.html#ad3395a55a5fde64d6603c7a82d7bf2c7">_MODEL_NVARS_</a>,fcL,L,(fL+<a class="code" href="a00129.html#ad3395a55a5fde64d6603c7a82d7bf2c7">_MODEL_NVARS_</a>*p));</div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;      <a class="code" href="a00127.html#abf4f45dbf1a3ea84452ba1da7b526d71">MatVecMult3</a>(<a class="code" href="a00129.html#ad3395a55a5fde64d6603c7a82d7bf2c7">_MODEL_NVARS_</a>,fcR,L,(fR+<a class="code" href="a00129.html#ad3395a55a5fde64d6603c7a82d7bf2c7">_MODEL_NVARS_</a>*p));</div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;</div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;      <span class="keywordflow">for</span> (k = 0; k &lt; <a class="code" href="a00129.html#ad3395a55a5fde64d6603c7a82d7bf2c7">_MODEL_NVARS_</a>; k++) {</div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;        <span class="keywordtype">double</span> eigL,eigC,eigR;</div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;        <a class="code" href="a00129.html#a115efdce970884e30c6564701f929092">_Euler1DEigenvalues_</a>((u+_MODEL_NVARS_*pL),D,param,0);</div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;        eigL = D[k*_MODEL_NVARS_+k];</div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;        <a class="code" href="a00129.html#a115efdce970884e30c6564701f929092">_Euler1DEigenvalues_</a>((u+_MODEL_NVARS_*pR),D,param,0);</div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;        eigR = D[k*_MODEL_NVARS_+k];</div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;        <a class="code" href="a00129.html#a115efdce970884e30c6564701f929092">_Euler1DEigenvalues_</a>(uavg,D,param,0);</div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;        eigC = D[k*_MODEL_NVARS_+k];</div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;</div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;        <span class="keywordflow">if</span> ((eigL &gt; 0) &amp;&amp; (eigC &gt; 0) &amp;&amp; (eigR &gt; 0))       fc[k] = fcL[k];</div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span> ((eigL &lt; 0) &amp;&amp; (eigC &lt; 0) &amp;&amp; (eigR &lt; 0))  fc[k] = fcR[k];</div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;        <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;          <span class="keywordtype">double</span> alpha = kappa * <a class="code" href="a00127.html#aa0d45e1e67c5cacf5c9251fcd90a971b">max3</a>(<a class="code" href="a00127.html#adf1be5ccbb7a2522b4f3a64043c72880">absolute</a>(eigL),<a class="code" href="a00127.html#adf1be5ccbb7a2522b4f3a64043c72880">absolute</a>(eigC),<a class="code" href="a00127.html#adf1be5ccbb7a2522b4f3a64043c72880">absolute</a>(eigR));</div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;          fc[k] = 0.5 * (fcL[k] + fcR[k] + alpha * (ucL[k]-ucR[k]));</div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;        }</div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;</div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;      }</div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;</div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;      <span class="comment">/* calculate the interface flux from the characteristic flux */</span></div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;      <a class="code" href="a00127.html#abf4f45dbf1a3ea84452ba1da7b526d71">MatVecMult3</a>(_MODEL_NVARS_,(fI+_MODEL_NVARS_*p),R,fc);</div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;    }</div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;    <a class="code" href="a00121.html#ac5ec1371623f11d03b0f42adaa24acbc">_ArrayIncrementIndex_</a>(ndims,bounds_outer,index_outer,done);</div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;  }</div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;</div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;  <span class="keywordflow">return</span>(0);</div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;}</div>
<div class="ttc" id="a00122_html_a68f50121fb9a7daeaf60e50cdef82ef3"><div class="ttname"><a href="a00122.html#a68f50121fb9a7daeaf60e50cdef82ef3">_DECLARE_IERR_</a></div><div class="ttdeci">#define _DECLARE_IERR_</div><div class="ttdef"><b>Definition:</b> <a href="a00122_source.html#l00010">basic.h:10</a></div></div>
<div class="ttc" id="a00106_html_a484873c74138512e41bc50d17b7d955a"><div class="ttname"><a href="a00106.html#a484873c74138512e41bc50d17b7d955a">HyPar::ndims</a></div><div class="ttdeci">int ndims</div><div class="ttdef"><b>Definition:</b> <a href="a00125_source.html#l00023">hypar.h:23</a></div></div>
<div class="ttc" id="a00121_html_ac5ec1371623f11d03b0f42adaa24acbc"><div class="ttname"><a href="a00121.html#ac5ec1371623f11d03b0f42adaa24acbc">_ArrayIncrementIndex_</a></div><div class="ttdeci">#define _ArrayIncrementIndex_(N, imax, i, done)</div><div class="ttdef"><b>Definition:</b> <a href="a00121_source.html#l00122">arrayfunctions.h:122</a></div></div>
<div class="ttc" id="a00129_html_a4449638968eca76bb5631bc75b7dced7"><div class="ttname"><a href="a00129.html#a4449638968eca76bb5631bc75b7dced7">_Euler1DRightEigenvectors_</a></div><div class="ttdeci">#define _Euler1DRightEigenvectors_(u, R, p, dir)</div><div class="ttdef"><b>Definition:</b> <a href="a00129_source.html#l00247">euler1d.h:247</a></div></div>
<div class="ttc" id="a00129_html_a9a3e89dcf75e61433735d59b6556c346"><div class="ttname"><a href="a00129.html#a9a3e89dcf75e61433735d59b6556c346">_Euler1DRoeAverage_</a></div><div class="ttdeci">#define _Euler1DRoeAverage_(uavg, uL, uR, p)</div><div class="ttdef"><b>Definition:</b> <a href="a00129_source.html#l00167">euler1d.h:167</a></div></div>
<div class="ttc" id="a00121_html_a89e8330d9e06dd0666c50833628a125c"><div class="ttname"><a href="a00121.html#a89e8330d9e06dd0666c50833628a125c">_ArrayCopy1D_</a></div><div class="ttdeci">#define _ArrayCopy1D_(x, y, size)</div><div class="ttdef"><b>Definition:</b> <a href="a00121_source.html#l00281">arrayfunctions.h:281</a></div></div>
<div class="ttc" id="a00127_html_aa0d45e1e67c5cacf5c9251fcd90a971b"><div class="ttname"><a href="a00127.html#aa0d45e1e67c5cacf5c9251fcd90a971b">max3</a></div><div class="ttdeci">#define max3(a, b, c)</div><div class="ttdef"><b>Definition:</b> <a href="a00127_source.html#l00028">mathfunctions.h:28</a></div></div>
<div class="ttc" id="a00121_html_afbb862a2fdf5b72b1f9ace42f64b556f"><div class="ttname"><a href="a00121.html#afbb862a2fdf5b72b1f9ace42f64b556f">_ArrayIndex1D_</a></div><div class="ttdeci">#define _ArrayIndex1D_(N, imax, i, ghost, index)</div><div class="ttdef"><b>Definition:</b> <a href="a00121_source.html#l00036">arrayfunctions.h:36</a></div></div>
<div class="ttc" id="a00099_html"><div class="ttname"><a href="a00099.html">Euler1D</a></div><div class="ttdoc">Structure containing variables and parameters specific to the 1D Euler equations. This structure cont...</div><div class="ttdef"><b>Definition:</b> <a href="a00129_source.html#l00271">euler1d.h:271</a></div></div>
<div class="ttc" id="a00106_html"><div class="ttname"><a href="a00106.html">HyPar</a></div><div class="ttdoc">Structure containing all solver-specific variables and functions. </div><div class="ttdef"><b>Definition:</b> <a href="a00125_source.html#l00020">hypar.h:20</a></div></div>
<div class="ttc" id="a00106_html_a48e81a1806b5774943fd9a26e9a190f2"><div class="ttname"><a href="a00106.html#a48e81a1806b5774943fd9a26e9a190f2">HyPar::physics</a></div><div class="ttdeci">void * physics</div><div class="ttdef"><b>Definition:</b> <a href="a00125_source.html#l00231">hypar.h:231</a></div></div>
<div class="ttc" id="a00127_html_abf4f45dbf1a3ea84452ba1da7b526d71"><div class="ttname"><a href="a00127.html#abf4f45dbf1a3ea84452ba1da7b526d71">MatVecMult3</a></div><div class="ttdeci">#define MatVecMult3(N, y, A, x)</div><div class="ttdef"><b>Definition:</b> <a href="a00127_source.html#l00168">mathfunctions.h:168</a></div></div>
<div class="ttc" id="a00121_html_a2b2826031c0cd92495ab351d3e599fc5"><div class="ttname"><a href="a00121.html#a2b2826031c0cd92495ab351d3e599fc5">_ArraySetValue_</a></div><div class="ttdeci">#define _ArraySetValue_(x, size, value)</div><div class="ttdef"><b>Definition:</b> <a href="a00121_source.html#l00142">arrayfunctions.h:142</a></div></div>
<div class="ttc" id="a00106_html_aafc992b5fa79d5a4036024615d03bce6"><div class="ttname"><a href="a00106.html#aafc992b5fa79d5a4036024615d03bce6">HyPar::ghosts</a></div><div class="ttdeci">int ghosts</div><div class="ttdef"><b>Definition:</b> <a href="a00125_source.html#l00041">hypar.h:41</a></div></div>
<div class="ttc" id="a00099_html_afb1265dc9bb8f8c05bd22f88c23d879c"><div class="ttname"><a href="a00099.html#afb1265dc9bb8f8c05bd22f88c23d879c">Euler1D::grav_field</a></div><div class="ttdeci">double * grav_field</div><div class="ttdef"><b>Definition:</b> <a href="a00129_source.html#l00286">euler1d.h:286</a></div></div>
<div class="ttc" id="a00129_html_a413fd3cab5a06c9d7a38334768d81b0f"><div class="ttname"><a href="a00129.html#a413fd3cab5a06c9d7a38334768d81b0f">_Euler1DLeftEigenvectors_</a></div><div class="ttdeci">#define _Euler1DLeftEigenvectors_(u, L, p, dir)</div><div class="ttdef"><b>Definition:</b> <a href="a00129_source.html#l00223">euler1d.h:223</a></div></div>
<div class="ttc" id="a00127_html_affe776513b24d84b39af8ab0930fef7f"><div class="ttname"><a href="a00127.html#affe776513b24d84b39af8ab0930fef7f">max</a></div><div class="ttdeci">#define max(a, b)</div><div class="ttdef"><b>Definition:</b> <a href="a00127_source.html#l00019">mathfunctions.h:19</a></div></div>
<div class="ttc" id="a00129_html_ad3395a55a5fde64d6603c7a82d7bf2c7"><div class="ttname"><a href="a00129.html#ad3395a55a5fde64d6603c7a82d7bf2c7">_MODEL_NVARS_</a></div><div class="ttdeci">#define _MODEL_NVARS_</div><div class="ttdef"><b>Definition:</b> <a href="a00129_source.html#l00058">euler1d.h:58</a></div></div>
<div class="ttc" id="a00127_html_adf1be5ccbb7a2522b4f3a64043c72880"><div class="ttname"><a href="a00127.html#adf1be5ccbb7a2522b4f3a64043c72880">absolute</a></div><div class="ttdeci">#define absolute(a)</div><div class="ttdef"><b>Definition:</b> <a href="a00127_source.html#l00033">mathfunctions.h:33</a></div></div>
<div class="ttc" id="a00106_html_a38e0371f331cecbe63a77fa03e202afe"><div class="ttname"><a href="a00106.html#a38e0371f331cecbe63a77fa03e202afe">HyPar::dim_local</a></div><div class="ttdeci">int * dim_local</div><div class="ttdef"><b>Definition:</b> <a href="a00125_source.html#l00032">hypar.h:32</a></div></div>
<div class="ttc" id="a00129_html_a115efdce970884e30c6564701f929092"><div class="ttname"><a href="a00129.html#a115efdce970884e30c6564701f929092">_Euler1DEigenvalues_</a></div><div class="ttdeci">#define _Euler1DEigenvalues_(u, D, p, dir)</div><div class="ttdef"><b>Definition:</b> <a href="a00129_source.html#l00205">euler1d.h:205</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a2e6e98b8cf8dda3540b17764262ef7dc"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int Euler1DUpwinddFRF </td>
          <td>(</td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>fI</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>fL</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>fR</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>uL</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>uR</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>u</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>dir</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>s</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>t</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>The characteristic-based Roe-fixed upwinding scheme (<a class="el" href="a00281.html#a803a31978814cfaef298c686b99d6ed0">Euler1DUpwindRF</a>) for the partitioned hyperbolic flux that comprises of the acoustic waves only (see <a class="el" href="a00275.html#a31b02a37de0ea8443f0dd89d5861e114">Euler1DStiffFlux</a>, <a class="el" href="a00129.html#a5329991de3157d264ef86a1df4ff6bef">_Euler1DSetStiffFlux_</a>). Thus, only the characteristic fields / eigen-modes corresponding to \( u\pm a\) are used.</p>
<p>Reference:</p><ul>
<li>Ghosh, D., Constantinescu, E. M., Semi-Implicit Time Integration of Atmospheric Flows with Characteristic-Based Flux Partitioning, SIAM Journal on Scientific Computing, 38 (3), 2016, A1848-A1875, <a href="http://dx.doi.org/10.1137/15M1044369">http://dx.doi.org/10.1137/15M1044369</a> </li>
</ul>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">fI</td><td>Computed upwind interface flux </td></tr>
    <tr><td class="paramname">fL</td><td>Left-biased reconstructed interface flux </td></tr>
    <tr><td class="paramname">fR</td><td>Right-biased reconstructed interface flux </td></tr>
    <tr><td class="paramname">uL</td><td>Left-biased reconstructed interface solution </td></tr>
    <tr><td class="paramname">uR</td><td>Right-biased reconstructed interface solution </td></tr>
    <tr><td class="paramname">u</td><td>Cell-centered solution </td></tr>
    <tr><td class="paramname">dir</td><td>Spatial dimension (unused since this is a 1D system) </td></tr>
    <tr><td class="paramname">s</td><td>Solver object of type <a class="el" href="a00106.html" title="Structure containing all solver-specific variables and functions. ">HyPar</a> </td></tr>
    <tr><td class="paramname">t</td><td>Current solution time </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="a00281_source.html#l00451">451</a> of file <a class="el" href="a00281_source.html">Euler1DUpwind.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;{</div>
<div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;  <a class="code" href="a00106.html">HyPar</a>     *solver = (<a class="code" href="a00106.html">HyPar</a>*)    s;</div>
<div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;  <a class="code" href="a00099.html">Euler1D</a>   *param  = (<a class="code" href="a00099.html">Euler1D</a>*)  solver-&gt;<a class="code" href="a00106.html#a48e81a1806b5774943fd9a26e9a190f2">physics</a>;</div>
<div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;  <span class="keywordtype">int</span>       done,k;</div>
<div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;  <a class="code" href="a00122.html#a68f50121fb9a7daeaf60e50cdef82ef3">_DECLARE_IERR_</a>;</div>
<div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;</div>
<div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;  <span class="keywordtype">int</span>     ndims   = solver-&gt;<a class="code" href="a00106.html#a484873c74138512e41bc50d17b7d955a">ndims</a>;</div>
<div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;  <span class="keywordtype">int</span>     *dim    = solver-&gt;<a class="code" href="a00106.html#a38e0371f331cecbe63a77fa03e202afe">dim_local</a>;</div>
<div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;  <span class="keywordtype">int</span>     ghosts  = solver-&gt;<a class="code" href="a00106.html#aafc992b5fa79d5a4036024615d03bce6">ghosts</a>;</div>
<div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;  <span class="keywordtype">double</span>  *uref   = param-&gt;<a class="code" href="a00099.html#a7568fac4d4e8488510e1d37f468967b1">solution</a>;</div>
<div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;</div>
<div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;  <span class="keywordtype">int</span> index_outer[ndims], index_inter[ndims], bounds_outer[ndims], bounds_inter[ndims];</div>
<div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;  <a class="code" href="a00121.html#a89e8330d9e06dd0666c50833628a125c">_ArrayCopy1D_</a>(dim,bounds_outer,ndims); bounds_outer[dir] =  1;</div>
<div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;  <a class="code" href="a00121.html#a89e8330d9e06dd0666c50833628a125c">_ArrayCopy1D_</a>(dim,bounds_inter,ndims); bounds_inter[dir] += 1;</div>
<div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;  <span class="keyword">static</span> <span class="keywordtype">double</span> R[<a class="code" href="a00129.html#ad3395a55a5fde64d6603c7a82d7bf2c7">_MODEL_NVARS_</a>*<a class="code" href="a00129.html#ad3395a55a5fde64d6603c7a82d7bf2c7">_MODEL_NVARS_</a>], D[<a class="code" href="a00129.html#ad3395a55a5fde64d6603c7a82d7bf2c7">_MODEL_NVARS_</a>*<a class="code" href="a00129.html#ad3395a55a5fde64d6603c7a82d7bf2c7">_MODEL_NVARS_</a>], L[<a class="code" href="a00129.html#ad3395a55a5fde64d6603c7a82d7bf2c7">_MODEL_NVARS_</a>*<a class="code" href="a00129.html#ad3395a55a5fde64d6603c7a82d7bf2c7">_MODEL_NVARS_</a>];</div>
<div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;</div>
<div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;  done = 0; <a class="code" href="a00121.html#a2b2826031c0cd92495ab351d3e599fc5">_ArraySetValue_</a>(index_outer,ndims,0);</div>
<div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;  <span class="keywordflow">while</span> (!done) {</div>
<div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;    <a class="code" href="a00121.html#a89e8330d9e06dd0666c50833628a125c">_ArrayCopy1D_</a>(index_outer,index_inter,ndims);</div>
<div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;    <span class="keywordflow">for</span> (index_inter[dir] = 0; index_inter[dir] &lt; bounds_inter[dir]; index_inter[dir]++) {</div>
<div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;      <span class="keywordtype">int</span> p; <a class="code" href="a00121.html#afbb862a2fdf5b72b1f9ace42f64b556f">_ArrayIndex1D_</a>(ndims,bounds_inter,index_inter,0,p);</div>
<div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;      <span class="keywordtype">int</span> indexL[ndims]; <a class="code" href="a00121.html#a89e8330d9e06dd0666c50833628a125c">_ArrayCopy1D_</a>(index_inter,indexL,ndims); indexL[dir]--;</div>
<div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;      <span class="keywordtype">int</span> indexR[ndims]; <a class="code" href="a00121.html#a89e8330d9e06dd0666c50833628a125c">_ArrayCopy1D_</a>(index_inter,indexR,ndims);</div>
<div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;      <span class="keywordtype">int</span> pL; <a class="code" href="a00121.html#afbb862a2fdf5b72b1f9ace42f64b556f">_ArrayIndex1D_</a>(ndims,dim,indexL,ghosts,pL);</div>
<div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;      <span class="keywordtype">int</span> pR; <a class="code" href="a00121.html#afbb862a2fdf5b72b1f9ace42f64b556f">_ArrayIndex1D_</a>(ndims,dim,indexR,ghosts,pR);</div>
<div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;      <span class="keywordtype">double</span> uavg[<a class="code" href="a00129.html#ad3395a55a5fde64d6603c7a82d7bf2c7">_MODEL_NVARS_</a>], fcL[<a class="code" href="a00129.html#ad3395a55a5fde64d6603c7a82d7bf2c7">_MODEL_NVARS_</a>], fcR[<a class="code" href="a00129.html#ad3395a55a5fde64d6603c7a82d7bf2c7">_MODEL_NVARS_</a>], </div>
<div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;             ucL[<a class="code" href="a00129.html#ad3395a55a5fde64d6603c7a82d7bf2c7">_MODEL_NVARS_</a>], ucR[<a class="code" href="a00129.html#ad3395a55a5fde64d6603c7a82d7bf2c7">_MODEL_NVARS_</a>], fc[<a class="code" href="a00129.html#ad3395a55a5fde64d6603c7a82d7bf2c7">_MODEL_NVARS_</a>];</div>
<div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;      <span class="keywordtype">double</span> kappa = <a class="code" href="a00127.html#affe776513b24d84b39af8ab0930fef7f">max</a>(param-&gt;<a class="code" href="a00099.html#afb1265dc9bb8f8c05bd22f88c23d879c">grav_field</a>[pL],param-&gt;<a class="code" href="a00099.html#afb1265dc9bb8f8c05bd22f88c23d879c">grav_field</a>[pR]);</div>
<div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;</div>
<div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;      <span class="comment">/* Roe-Fixed upwinding scheme */</span></div>
<div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;</div>
<div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;      <a class="code" href="a00129.html#a9a3e89dcf75e61433735d59b6556c346">_Euler1DRoeAverage_</a>       (uavg,(uref+<a class="code" href="a00129.html#ad3395a55a5fde64d6603c7a82d7bf2c7">_MODEL_NVARS_</a>*pL),(uref+<a class="code" href="a00129.html#ad3395a55a5fde64d6603c7a82d7bf2c7">_MODEL_NVARS_</a>*pR),param);</div>
<div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;      <a class="code" href="a00129.html#a115efdce970884e30c6564701f929092">_Euler1DEigenvalues_</a>      (uavg,D,param,0);</div>
<div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;      <a class="code" href="a00129.html#a413fd3cab5a06c9d7a38334768d81b0f">_Euler1DLeftEigenvectors_</a> (uavg,L,param,0);</div>
<div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;      <a class="code" href="a00129.html#a4449638968eca76bb5631bc75b7dced7">_Euler1DRightEigenvectors_</a>(uavg,R,param,0);</div>
<div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;</div>
<div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;      <span class="comment">/* calculate characteristic fluxes and variables */</span></div>
<div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;      <a class="code" href="a00127.html#abf4f45dbf1a3ea84452ba1da7b526d71">MatVecMult3</a>(<a class="code" href="a00129.html#ad3395a55a5fde64d6603c7a82d7bf2c7">_MODEL_NVARS_</a>,ucL,L,(uL+<a class="code" href="a00129.html#ad3395a55a5fde64d6603c7a82d7bf2c7">_MODEL_NVARS_</a>*p));</div>
<div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;      <a class="code" href="a00127.html#abf4f45dbf1a3ea84452ba1da7b526d71">MatVecMult3</a>(<a class="code" href="a00129.html#ad3395a55a5fde64d6603c7a82d7bf2c7">_MODEL_NVARS_</a>,ucR,L,(uR+<a class="code" href="a00129.html#ad3395a55a5fde64d6603c7a82d7bf2c7">_MODEL_NVARS_</a>*p));</div>
<div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;      <a class="code" href="a00127.html#abf4f45dbf1a3ea84452ba1da7b526d71">MatVecMult3</a>(<a class="code" href="a00129.html#ad3395a55a5fde64d6603c7a82d7bf2c7">_MODEL_NVARS_</a>,fcL,L,(fL+<a class="code" href="a00129.html#ad3395a55a5fde64d6603c7a82d7bf2c7">_MODEL_NVARS_</a>*p));</div>
<div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;      <a class="code" href="a00127.html#abf4f45dbf1a3ea84452ba1da7b526d71">MatVecMult3</a>(<a class="code" href="a00129.html#ad3395a55a5fde64d6603c7a82d7bf2c7">_MODEL_NVARS_</a>,fcR,L,(fR+<a class="code" href="a00129.html#ad3395a55a5fde64d6603c7a82d7bf2c7">_MODEL_NVARS_</a>*p));</div>
<div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;</div>
<div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;      <span class="keywordflow">for</span> (k = 0; k &lt; <a class="code" href="a00129.html#ad3395a55a5fde64d6603c7a82d7bf2c7">_MODEL_NVARS_</a>; k++) {</div>
<div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;        <span class="keywordtype">double</span> eigL,eigC,eigR;</div>
<div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;        <a class="code" href="a00129.html#a115efdce970884e30c6564701f929092">_Euler1DEigenvalues_</a>((u+_MODEL_NVARS_*pL),D,param,0);</div>
<div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;        eigL = (k == 0? 0.0 : D[k*_MODEL_NVARS_+k]);</div>
<div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;        <a class="code" href="a00129.html#a115efdce970884e30c6564701f929092">_Euler1DEigenvalues_</a>((u+_MODEL_NVARS_*pR),D,param,0);</div>
<div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;        eigR = (k == 0? 0.0 : D[k*_MODEL_NVARS_+k]);</div>
<div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;        <a class="code" href="a00129.html#a115efdce970884e30c6564701f929092">_Euler1DEigenvalues_</a>(uavg,D,param,0);</div>
<div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;        eigC = (k == 0? 0.0 : D[k*_MODEL_NVARS_+k]);</div>
<div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;</div>
<div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;        <span class="keywordflow">if</span> ((eigL &gt; 0) &amp;&amp; (eigC &gt; 0) &amp;&amp; (eigR &gt; 0))       fc[k] = fcL[k];</div>
<div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span> ((eigL &lt; 0) &amp;&amp; (eigC &lt; 0) &amp;&amp; (eigR &lt; 0))  fc[k] = fcR[k];</div>
<div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;        <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;          <span class="keywordtype">double</span> alpha = kappa * <a class="code" href="a00127.html#aa0d45e1e67c5cacf5c9251fcd90a971b">max3</a>(<a class="code" href="a00127.html#adf1be5ccbb7a2522b4f3a64043c72880">absolute</a>(eigL),<a class="code" href="a00127.html#adf1be5ccbb7a2522b4f3a64043c72880">absolute</a>(eigC),<a class="code" href="a00127.html#adf1be5ccbb7a2522b4f3a64043c72880">absolute</a>(eigR));</div>
<div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;          fc[k] = 0.5 * (fcL[k] + fcR[k] + alpha * (ucL[k]-ucR[k]));</div>
<div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;        }</div>
<div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;</div>
<div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;      }</div>
<div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;</div>
<div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;      <span class="comment">/* calculate the interface flux from the characteristic flux */</span></div>
<div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;      <a class="code" href="a00127.html#abf4f45dbf1a3ea84452ba1da7b526d71">MatVecMult3</a>(_MODEL_NVARS_,(fI+_MODEL_NVARS_*p),R,fc);</div>
<div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;    }</div>
<div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;    <a class="code" href="a00121.html#ac5ec1371623f11d03b0f42adaa24acbc">_ArrayIncrementIndex_</a>(ndims,bounds_outer,index_outer,done);</div>
<div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;  }</div>
<div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;</div>
<div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;  <span class="keywordflow">return</span>(0);</div>
<div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;}</div>
<div class="ttc" id="a00122_html_a68f50121fb9a7daeaf60e50cdef82ef3"><div class="ttname"><a href="a00122.html#a68f50121fb9a7daeaf60e50cdef82ef3">_DECLARE_IERR_</a></div><div class="ttdeci">#define _DECLARE_IERR_</div><div class="ttdef"><b>Definition:</b> <a href="a00122_source.html#l00010">basic.h:10</a></div></div>
<div class="ttc" id="a00106_html_a484873c74138512e41bc50d17b7d955a"><div class="ttname"><a href="a00106.html#a484873c74138512e41bc50d17b7d955a">HyPar::ndims</a></div><div class="ttdeci">int ndims</div><div class="ttdef"><b>Definition:</b> <a href="a00125_source.html#l00023">hypar.h:23</a></div></div>
<div class="ttc" id="a00121_html_ac5ec1371623f11d03b0f42adaa24acbc"><div class="ttname"><a href="a00121.html#ac5ec1371623f11d03b0f42adaa24acbc">_ArrayIncrementIndex_</a></div><div class="ttdeci">#define _ArrayIncrementIndex_(N, imax, i, done)</div><div class="ttdef"><b>Definition:</b> <a href="a00121_source.html#l00122">arrayfunctions.h:122</a></div></div>
<div class="ttc" id="a00129_html_a4449638968eca76bb5631bc75b7dced7"><div class="ttname"><a href="a00129.html#a4449638968eca76bb5631bc75b7dced7">_Euler1DRightEigenvectors_</a></div><div class="ttdeci">#define _Euler1DRightEigenvectors_(u, R, p, dir)</div><div class="ttdef"><b>Definition:</b> <a href="a00129_source.html#l00247">euler1d.h:247</a></div></div>
<div class="ttc" id="a00129_html_a9a3e89dcf75e61433735d59b6556c346"><div class="ttname"><a href="a00129.html#a9a3e89dcf75e61433735d59b6556c346">_Euler1DRoeAverage_</a></div><div class="ttdeci">#define _Euler1DRoeAverage_(uavg, uL, uR, p)</div><div class="ttdef"><b>Definition:</b> <a href="a00129_source.html#l00167">euler1d.h:167</a></div></div>
<div class="ttc" id="a00121_html_a89e8330d9e06dd0666c50833628a125c"><div class="ttname"><a href="a00121.html#a89e8330d9e06dd0666c50833628a125c">_ArrayCopy1D_</a></div><div class="ttdeci">#define _ArrayCopy1D_(x, y, size)</div><div class="ttdef"><b>Definition:</b> <a href="a00121_source.html#l00281">arrayfunctions.h:281</a></div></div>
<div class="ttc" id="a00127_html_aa0d45e1e67c5cacf5c9251fcd90a971b"><div class="ttname"><a href="a00127.html#aa0d45e1e67c5cacf5c9251fcd90a971b">max3</a></div><div class="ttdeci">#define max3(a, b, c)</div><div class="ttdef"><b>Definition:</b> <a href="a00127_source.html#l00028">mathfunctions.h:28</a></div></div>
<div class="ttc" id="a00121_html_afbb862a2fdf5b72b1f9ace42f64b556f"><div class="ttname"><a href="a00121.html#afbb862a2fdf5b72b1f9ace42f64b556f">_ArrayIndex1D_</a></div><div class="ttdeci">#define _ArrayIndex1D_(N, imax, i, ghost, index)</div><div class="ttdef"><b>Definition:</b> <a href="a00121_source.html#l00036">arrayfunctions.h:36</a></div></div>
<div class="ttc" id="a00099_html"><div class="ttname"><a href="a00099.html">Euler1D</a></div><div class="ttdoc">Structure containing variables and parameters specific to the 1D Euler equations. This structure cont...</div><div class="ttdef"><b>Definition:</b> <a href="a00129_source.html#l00271">euler1d.h:271</a></div></div>
<div class="ttc" id="a00106_html"><div class="ttname"><a href="a00106.html">HyPar</a></div><div class="ttdoc">Structure containing all solver-specific variables and functions. </div><div class="ttdef"><b>Definition:</b> <a href="a00125_source.html#l00020">hypar.h:20</a></div></div>
<div class="ttc" id="a00099_html_a7568fac4d4e8488510e1d37f468967b1"><div class="ttname"><a href="a00099.html#a7568fac4d4e8488510e1d37f468967b1">Euler1D::solution</a></div><div class="ttdeci">double * solution</div><div class="ttdef"><b>Definition:</b> <a href="a00129_source.html#l00288">euler1d.h:288</a></div></div>
<div class="ttc" id="a00106_html_a48e81a1806b5774943fd9a26e9a190f2"><div class="ttname"><a href="a00106.html#a48e81a1806b5774943fd9a26e9a190f2">HyPar::physics</a></div><div class="ttdeci">void * physics</div><div class="ttdef"><b>Definition:</b> <a href="a00125_source.html#l00231">hypar.h:231</a></div></div>
<div class="ttc" id="a00127_html_abf4f45dbf1a3ea84452ba1da7b526d71"><div class="ttname"><a href="a00127.html#abf4f45dbf1a3ea84452ba1da7b526d71">MatVecMult3</a></div><div class="ttdeci">#define MatVecMult3(N, y, A, x)</div><div class="ttdef"><b>Definition:</b> <a href="a00127_source.html#l00168">mathfunctions.h:168</a></div></div>
<div class="ttc" id="a00121_html_a2b2826031c0cd92495ab351d3e599fc5"><div class="ttname"><a href="a00121.html#a2b2826031c0cd92495ab351d3e599fc5">_ArraySetValue_</a></div><div class="ttdeci">#define _ArraySetValue_(x, size, value)</div><div class="ttdef"><b>Definition:</b> <a href="a00121_source.html#l00142">arrayfunctions.h:142</a></div></div>
<div class="ttc" id="a00106_html_aafc992b5fa79d5a4036024615d03bce6"><div class="ttname"><a href="a00106.html#aafc992b5fa79d5a4036024615d03bce6">HyPar::ghosts</a></div><div class="ttdeci">int ghosts</div><div class="ttdef"><b>Definition:</b> <a href="a00125_source.html#l00041">hypar.h:41</a></div></div>
<div class="ttc" id="a00099_html_afb1265dc9bb8f8c05bd22f88c23d879c"><div class="ttname"><a href="a00099.html#afb1265dc9bb8f8c05bd22f88c23d879c">Euler1D::grav_field</a></div><div class="ttdeci">double * grav_field</div><div class="ttdef"><b>Definition:</b> <a href="a00129_source.html#l00286">euler1d.h:286</a></div></div>
<div class="ttc" id="a00129_html_a413fd3cab5a06c9d7a38334768d81b0f"><div class="ttname"><a href="a00129.html#a413fd3cab5a06c9d7a38334768d81b0f">_Euler1DLeftEigenvectors_</a></div><div class="ttdeci">#define _Euler1DLeftEigenvectors_(u, L, p, dir)</div><div class="ttdef"><b>Definition:</b> <a href="a00129_source.html#l00223">euler1d.h:223</a></div></div>
<div class="ttc" id="a00127_html_affe776513b24d84b39af8ab0930fef7f"><div class="ttname"><a href="a00127.html#affe776513b24d84b39af8ab0930fef7f">max</a></div><div class="ttdeci">#define max(a, b)</div><div class="ttdef"><b>Definition:</b> <a href="a00127_source.html#l00019">mathfunctions.h:19</a></div></div>
<div class="ttc" id="a00129_html_ad3395a55a5fde64d6603c7a82d7bf2c7"><div class="ttname"><a href="a00129.html#ad3395a55a5fde64d6603c7a82d7bf2c7">_MODEL_NVARS_</a></div><div class="ttdeci">#define _MODEL_NVARS_</div><div class="ttdef"><b>Definition:</b> <a href="a00129_source.html#l00058">euler1d.h:58</a></div></div>
<div class="ttc" id="a00127_html_adf1be5ccbb7a2522b4f3a64043c72880"><div class="ttname"><a href="a00127.html#adf1be5ccbb7a2522b4f3a64043c72880">absolute</a></div><div class="ttdeci">#define absolute(a)</div><div class="ttdef"><b>Definition:</b> <a href="a00127_source.html#l00033">mathfunctions.h:33</a></div></div>
<div class="ttc" id="a00106_html_a38e0371f331cecbe63a77fa03e202afe"><div class="ttname"><a href="a00106.html#a38e0371f331cecbe63a77fa03e202afe">HyPar::dim_local</a></div><div class="ttdeci">int * dim_local</div><div class="ttdef"><b>Definition:</b> <a href="a00125_source.html#l00032">hypar.h:32</a></div></div>
<div class="ttc" id="a00129_html_a115efdce970884e30c6564701f929092"><div class="ttname"><a href="a00129.html#a115efdce970884e30c6564701f929092">_Euler1DEigenvalues_</a></div><div class="ttdeci">#define _Euler1DEigenvalues_(u, D, p, dir)</div><div class="ttdef"><b>Definition:</b> <a href="a00129_source.html#l00205">euler1d.h:205</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a9f4272feb90b98823419004ad0923446"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int Euler1DUpwindLLF </td>
          <td>(</td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>fI</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>fL</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>fR</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>uL</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>uR</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>u</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>dir</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>s</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>t</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Characteristic-based local Lax-Friedrich upwinding scheme. </p><p class="formulaDsp">
\begin{align} \alpha_{j+1/2}^{k,L} &amp;= \sum_{k=1}^3 {\bf l}_{j+1/2}^k \cdot {\bf f}_{j+1/2}^{k,L}, \\ \alpha_{j+1/2}^{k,R} &amp;= \sum_{k=1}^3 {\bf l}_{j+1/2}^k \cdot {\bf f}_{j+1/2}^{k,R}, \\ v_{j+1/2}^{k,L} &amp;= \sum_{k=1}^3 {\bf l}_{j+1/2}^k \cdot {\bf u}_{j+1/2}^{k,L}, \\ v_{j+1/2}^{k,R} &amp;= \sum_{k=1}^3 {\bf l}_{j+1/2}^k \cdot {\bf u}_{j+1/2}^{k,R}, \\ \alpha_{j+1/2}^k &amp;= \frac{1}{2}\left[ \alpha_{j+1/2}^{k,L} + \alpha_{j+1/2}^{k,R} - \left(\max_{\left[j,j+1\right]} \lambda\right) \left( v_{j+1/2}^{k,R} - v_{j+1/2}^{k,L} \right) \right], \\ {\bf f}_{j+1/2} &amp;= \sum_{k=1}^3 \alpha_{j+1/2}^k {\bf r}_{j+1/2}^k \end{align}
</p>
<p> where \({\bf l}\), \({\bf r}\), and \(\lambda\) are the left-eigenvectors, right-eigenvectors and eigenvalues. The subscripts denote the grid locations.</p><ul>
<li>C.-W. Shu, and S. Osher, "Efficient implementation of essentially non-oscillatory schemes, II", J. Comput. Phys., 83 (1989), pp. 3278, <a href="http://dx.doi.org/10.1016/0021-9991(89)90222-2">http://dx.doi.org/10.1016/0021-9991(89)90222-2</a>.</li>
</ul>
<p>This upwinding scheme is modified for the balanced discretization of the 1D Euler equations when there is a non-zero gravitational force. See the reference below. For flows without any gravitational forces, it reduces to its original form.</p><ul>
<li>Xing, Shu, "High Order Well-Balanced WENO Scheme for the Gas Dynamics Equations 
              Under Gravitational Fields", J. Sci. Comput., 54, 2013, pp. 645&ndash;662, <a href="http://dx.doi.org/10.1007/s10915-012-9585-8">http://dx.doi.org/10.1007/s10915-012-9585-8</a>. </li>
</ul>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">fI</td><td>Computed upwind interface flux </td></tr>
    <tr><td class="paramname">fL</td><td>Left-biased reconstructed interface flux </td></tr>
    <tr><td class="paramname">fR</td><td>Right-biased reconstructed interface flux </td></tr>
    <tr><td class="paramname">uL</td><td>Left-biased reconstructed interface solution </td></tr>
    <tr><td class="paramname">uR</td><td>Right-biased reconstructed interface solution </td></tr>
    <tr><td class="paramname">u</td><td>Cell-centered solution </td></tr>
    <tr><td class="paramname">dir</td><td>Spatial dimension (unused since this is a 1D system) </td></tr>
    <tr><td class="paramname">s</td><td>Solver object of type <a class="el" href="a00106.html" title="Structure containing all solver-specific variables and functions. ">HyPar</a> </td></tr>
    <tr><td class="paramname">t</td><td>Current solution time </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="a00281_source.html#l00211">211</a> of file <a class="el" href="a00281_source.html">Euler1DUpwind.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;{</div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;  <a class="code" href="a00106.html">HyPar</a>     *solver = (<a class="code" href="a00106.html">HyPar</a>*)    s;</div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;  <a class="code" href="a00099.html">Euler1D</a>   *param  = (<a class="code" href="a00099.html">Euler1D</a>*)  solver-&gt;<a class="code" href="a00106.html#a48e81a1806b5774943fd9a26e9a190f2">physics</a>;</div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;  <span class="keywordtype">int</span>       done,k;</div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;  <a class="code" href="a00122.html#a68f50121fb9a7daeaf60e50cdef82ef3">_DECLARE_IERR_</a>;</div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;</div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;  <span class="keywordtype">int</span> ndims   = solver-&gt;<a class="code" href="a00106.html#a484873c74138512e41bc50d17b7d955a">ndims</a>;</div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;  <span class="keywordtype">int</span> *dim    = solver-&gt;<a class="code" href="a00106.html#a38e0371f331cecbe63a77fa03e202afe">dim_local</a>;</div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;  <span class="keywordtype">int</span> ghosts  = solver-&gt;<a class="code" href="a00106.html#aafc992b5fa79d5a4036024615d03bce6">ghosts</a>;</div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;</div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;  <span class="keywordtype">int</span> index_outer[ndims], index_inter[ndims], bounds_outer[ndims], bounds_inter[ndims];</div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;  <a class="code" href="a00121.html#a89e8330d9e06dd0666c50833628a125c">_ArrayCopy1D_</a>(dim,bounds_outer,ndims); bounds_outer[dir] =  1;</div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;  <a class="code" href="a00121.html#a89e8330d9e06dd0666c50833628a125c">_ArrayCopy1D_</a>(dim,bounds_inter,ndims); bounds_inter[dir] += 1;</div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;  <span class="keyword">static</span> <span class="keywordtype">double</span> R[<a class="code" href="a00129.html#ad3395a55a5fde64d6603c7a82d7bf2c7">_MODEL_NVARS_</a>*<a class="code" href="a00129.html#ad3395a55a5fde64d6603c7a82d7bf2c7">_MODEL_NVARS_</a>], D[<a class="code" href="a00129.html#ad3395a55a5fde64d6603c7a82d7bf2c7">_MODEL_NVARS_</a>*<a class="code" href="a00129.html#ad3395a55a5fde64d6603c7a82d7bf2c7">_MODEL_NVARS_</a>], L[<a class="code" href="a00129.html#ad3395a55a5fde64d6603c7a82d7bf2c7">_MODEL_NVARS_</a>*<a class="code" href="a00129.html#ad3395a55a5fde64d6603c7a82d7bf2c7">_MODEL_NVARS_</a>];</div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;</div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;  done = 0; <a class="code" href="a00121.html#a2b2826031c0cd92495ab351d3e599fc5">_ArraySetValue_</a>(index_outer,ndims,0);</div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;  <span class="keywordflow">while</span> (!done) {</div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;    <a class="code" href="a00121.html#a89e8330d9e06dd0666c50833628a125c">_ArrayCopy1D_</a>(index_outer,index_inter,ndims);</div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;    <span class="keywordflow">for</span> (index_inter[dir] = 0; index_inter[dir] &lt; bounds_inter[dir]; index_inter[dir]++) {</div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;      <span class="keywordtype">int</span> p; <a class="code" href="a00121.html#afbb862a2fdf5b72b1f9ace42f64b556f">_ArrayIndex1D_</a>(ndims,bounds_inter,index_inter,0,p);</div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;      <span class="keywordtype">int</span> indexL[ndims]; <a class="code" href="a00121.html#a89e8330d9e06dd0666c50833628a125c">_ArrayCopy1D_</a>(index_inter,indexL,ndims); indexL[dir]--;</div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;      <span class="keywordtype">int</span> indexR[ndims]; <a class="code" href="a00121.html#a89e8330d9e06dd0666c50833628a125c">_ArrayCopy1D_</a>(index_inter,indexR,ndims);</div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;      <span class="keywordtype">int</span> pL; <a class="code" href="a00121.html#afbb862a2fdf5b72b1f9ace42f64b556f">_ArrayIndex1D_</a>(ndims,dim,indexL,ghosts,pL);</div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;      <span class="keywordtype">int</span> pR; <a class="code" href="a00121.html#afbb862a2fdf5b72b1f9ace42f64b556f">_ArrayIndex1D_</a>(ndims,dim,indexR,ghosts,pR);</div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;      <span class="keywordtype">double</span> uavg[<a class="code" href="a00129.html#ad3395a55a5fde64d6603c7a82d7bf2c7">_MODEL_NVARS_</a>], fcL[<a class="code" href="a00129.html#ad3395a55a5fde64d6603c7a82d7bf2c7">_MODEL_NVARS_</a>], fcR[<a class="code" href="a00129.html#ad3395a55a5fde64d6603c7a82d7bf2c7">_MODEL_NVARS_</a>], </div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;             ucL[<a class="code" href="a00129.html#ad3395a55a5fde64d6603c7a82d7bf2c7">_MODEL_NVARS_</a>], ucR[<a class="code" href="a00129.html#ad3395a55a5fde64d6603c7a82d7bf2c7">_MODEL_NVARS_</a>], fc[<a class="code" href="a00129.html#ad3395a55a5fde64d6603c7a82d7bf2c7">_MODEL_NVARS_</a>];</div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;      <span class="keywordtype">double</span> kappa = <a class="code" href="a00127.html#affe776513b24d84b39af8ab0930fef7f">max</a>(param-&gt;<a class="code" href="a00099.html#afb1265dc9bb8f8c05bd22f88c23d879c">grav_field</a>[pL],param-&gt;<a class="code" href="a00099.html#afb1265dc9bb8f8c05bd22f88c23d879c">grav_field</a>[pR]);</div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;</div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;      <span class="comment">/* Local Lax-Friedrich upwinding scheme */</span></div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;</div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;      <a class="code" href="a00129.html#a9a3e89dcf75e61433735d59b6556c346">_Euler1DRoeAverage_</a>       (uavg,(u+<a class="code" href="a00129.html#ad3395a55a5fde64d6603c7a82d7bf2c7">_MODEL_NVARS_</a>*pL),(u+<a class="code" href="a00129.html#ad3395a55a5fde64d6603c7a82d7bf2c7">_MODEL_NVARS_</a>*pR),param);</div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;      <a class="code" href="a00129.html#a115efdce970884e30c6564701f929092">_Euler1DEigenvalues_</a>      (uavg,D,param,0);</div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;      <a class="code" href="a00129.html#a413fd3cab5a06c9d7a38334768d81b0f">_Euler1DLeftEigenvectors_</a> (uavg,L,param,0);</div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;      <a class="code" href="a00129.html#a4449638968eca76bb5631bc75b7dced7">_Euler1DRightEigenvectors_</a>(uavg,R,param,0);</div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;</div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;      <span class="comment">/* calculate characteristic fluxes and variables */</span></div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;      <a class="code" href="a00127.html#abf4f45dbf1a3ea84452ba1da7b526d71">MatVecMult3</a>(<a class="code" href="a00129.html#ad3395a55a5fde64d6603c7a82d7bf2c7">_MODEL_NVARS_</a>,ucL,L,(uL+<a class="code" href="a00129.html#ad3395a55a5fde64d6603c7a82d7bf2c7">_MODEL_NVARS_</a>*p));</div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;      <a class="code" href="a00127.html#abf4f45dbf1a3ea84452ba1da7b526d71">MatVecMult3</a>(<a class="code" href="a00129.html#ad3395a55a5fde64d6603c7a82d7bf2c7">_MODEL_NVARS_</a>,ucR,L,(uR+<a class="code" href="a00129.html#ad3395a55a5fde64d6603c7a82d7bf2c7">_MODEL_NVARS_</a>*p));</div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;      <a class="code" href="a00127.html#abf4f45dbf1a3ea84452ba1da7b526d71">MatVecMult3</a>(<a class="code" href="a00129.html#ad3395a55a5fde64d6603c7a82d7bf2c7">_MODEL_NVARS_</a>,fcL,L,(fL+<a class="code" href="a00129.html#ad3395a55a5fde64d6603c7a82d7bf2c7">_MODEL_NVARS_</a>*p));</div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;      <a class="code" href="a00127.html#abf4f45dbf1a3ea84452ba1da7b526d71">MatVecMult3</a>(<a class="code" href="a00129.html#ad3395a55a5fde64d6603c7a82d7bf2c7">_MODEL_NVARS_</a>,fcR,L,(fR+<a class="code" href="a00129.html#ad3395a55a5fde64d6603c7a82d7bf2c7">_MODEL_NVARS_</a>*p));</div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;</div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;      <span class="keywordflow">for</span> (k = 0; k &lt; <a class="code" href="a00129.html#ad3395a55a5fde64d6603c7a82d7bf2c7">_MODEL_NVARS_</a>; k++) {</div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;        <span class="keywordtype">double</span> eigL,eigC,eigR;</div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;        <a class="code" href="a00129.html#a115efdce970884e30c6564701f929092">_Euler1DEigenvalues_</a>((u+_MODEL_NVARS_*pL),D,param,0);</div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;        eigL = D[k*_MODEL_NVARS_+k];</div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;        <a class="code" href="a00129.html#a115efdce970884e30c6564701f929092">_Euler1DEigenvalues_</a>((u+_MODEL_NVARS_*pR),D,param,0);</div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;        eigR = D[k*_MODEL_NVARS_+k];</div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;        <a class="code" href="a00129.html#a115efdce970884e30c6564701f929092">_Euler1DEigenvalues_</a>(uavg,D,param,0);</div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;        eigC = D[k*_MODEL_NVARS_+k];</div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;</div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;        <span class="keywordtype">double</span> alpha = kappa * <a class="code" href="a00127.html#aa0d45e1e67c5cacf5c9251fcd90a971b">max3</a>(<a class="code" href="a00127.html#adf1be5ccbb7a2522b4f3a64043c72880">absolute</a>(eigL),<a class="code" href="a00127.html#adf1be5ccbb7a2522b4f3a64043c72880">absolute</a>(eigC),<a class="code" href="a00127.html#adf1be5ccbb7a2522b4f3a64043c72880">absolute</a>(eigR));</div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;        fc[k] = 0.5 * (fcL[k] + fcR[k] + alpha * (ucL[k]-ucR[k]));</div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;      }</div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;</div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;      <span class="comment">/* calculate the interface flux from the characteristic flux */</span></div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;      <a class="code" href="a00127.html#abf4f45dbf1a3ea84452ba1da7b526d71">MatVecMult3</a>(_MODEL_NVARS_,(fI+_MODEL_NVARS_*p),R,fc);</div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;    }</div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;    <a class="code" href="a00121.html#ac5ec1371623f11d03b0f42adaa24acbc">_ArrayIncrementIndex_</a>(ndims,bounds_outer,index_outer,done);</div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;  }</div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;</div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;  <span class="keywordflow">return</span>(0);</div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;}</div>
<div class="ttc" id="a00122_html_a68f50121fb9a7daeaf60e50cdef82ef3"><div class="ttname"><a href="a00122.html#a68f50121fb9a7daeaf60e50cdef82ef3">_DECLARE_IERR_</a></div><div class="ttdeci">#define _DECLARE_IERR_</div><div class="ttdef"><b>Definition:</b> <a href="a00122_source.html#l00010">basic.h:10</a></div></div>
<div class="ttc" id="a00106_html_a484873c74138512e41bc50d17b7d955a"><div class="ttname"><a href="a00106.html#a484873c74138512e41bc50d17b7d955a">HyPar::ndims</a></div><div class="ttdeci">int ndims</div><div class="ttdef"><b>Definition:</b> <a href="a00125_source.html#l00023">hypar.h:23</a></div></div>
<div class="ttc" id="a00121_html_ac5ec1371623f11d03b0f42adaa24acbc"><div class="ttname"><a href="a00121.html#ac5ec1371623f11d03b0f42adaa24acbc">_ArrayIncrementIndex_</a></div><div class="ttdeci">#define _ArrayIncrementIndex_(N, imax, i, done)</div><div class="ttdef"><b>Definition:</b> <a href="a00121_source.html#l00122">arrayfunctions.h:122</a></div></div>
<div class="ttc" id="a00129_html_a4449638968eca76bb5631bc75b7dced7"><div class="ttname"><a href="a00129.html#a4449638968eca76bb5631bc75b7dced7">_Euler1DRightEigenvectors_</a></div><div class="ttdeci">#define _Euler1DRightEigenvectors_(u, R, p, dir)</div><div class="ttdef"><b>Definition:</b> <a href="a00129_source.html#l00247">euler1d.h:247</a></div></div>
<div class="ttc" id="a00129_html_a9a3e89dcf75e61433735d59b6556c346"><div class="ttname"><a href="a00129.html#a9a3e89dcf75e61433735d59b6556c346">_Euler1DRoeAverage_</a></div><div class="ttdeci">#define _Euler1DRoeAverage_(uavg, uL, uR, p)</div><div class="ttdef"><b>Definition:</b> <a href="a00129_source.html#l00167">euler1d.h:167</a></div></div>
<div class="ttc" id="a00121_html_a89e8330d9e06dd0666c50833628a125c"><div class="ttname"><a href="a00121.html#a89e8330d9e06dd0666c50833628a125c">_ArrayCopy1D_</a></div><div class="ttdeci">#define _ArrayCopy1D_(x, y, size)</div><div class="ttdef"><b>Definition:</b> <a href="a00121_source.html#l00281">arrayfunctions.h:281</a></div></div>
<div class="ttc" id="a00127_html_aa0d45e1e67c5cacf5c9251fcd90a971b"><div class="ttname"><a href="a00127.html#aa0d45e1e67c5cacf5c9251fcd90a971b">max3</a></div><div class="ttdeci">#define max3(a, b, c)</div><div class="ttdef"><b>Definition:</b> <a href="a00127_source.html#l00028">mathfunctions.h:28</a></div></div>
<div class="ttc" id="a00121_html_afbb862a2fdf5b72b1f9ace42f64b556f"><div class="ttname"><a href="a00121.html#afbb862a2fdf5b72b1f9ace42f64b556f">_ArrayIndex1D_</a></div><div class="ttdeci">#define _ArrayIndex1D_(N, imax, i, ghost, index)</div><div class="ttdef"><b>Definition:</b> <a href="a00121_source.html#l00036">arrayfunctions.h:36</a></div></div>
<div class="ttc" id="a00099_html"><div class="ttname"><a href="a00099.html">Euler1D</a></div><div class="ttdoc">Structure containing variables and parameters specific to the 1D Euler equations. This structure cont...</div><div class="ttdef"><b>Definition:</b> <a href="a00129_source.html#l00271">euler1d.h:271</a></div></div>
<div class="ttc" id="a00106_html"><div class="ttname"><a href="a00106.html">HyPar</a></div><div class="ttdoc">Structure containing all solver-specific variables and functions. </div><div class="ttdef"><b>Definition:</b> <a href="a00125_source.html#l00020">hypar.h:20</a></div></div>
<div class="ttc" id="a00106_html_a48e81a1806b5774943fd9a26e9a190f2"><div class="ttname"><a href="a00106.html#a48e81a1806b5774943fd9a26e9a190f2">HyPar::physics</a></div><div class="ttdeci">void * physics</div><div class="ttdef"><b>Definition:</b> <a href="a00125_source.html#l00231">hypar.h:231</a></div></div>
<div class="ttc" id="a00127_html_abf4f45dbf1a3ea84452ba1da7b526d71"><div class="ttname"><a href="a00127.html#abf4f45dbf1a3ea84452ba1da7b526d71">MatVecMult3</a></div><div class="ttdeci">#define MatVecMult3(N, y, A, x)</div><div class="ttdef"><b>Definition:</b> <a href="a00127_source.html#l00168">mathfunctions.h:168</a></div></div>
<div class="ttc" id="a00121_html_a2b2826031c0cd92495ab351d3e599fc5"><div class="ttname"><a href="a00121.html#a2b2826031c0cd92495ab351d3e599fc5">_ArraySetValue_</a></div><div class="ttdeci">#define _ArraySetValue_(x, size, value)</div><div class="ttdef"><b>Definition:</b> <a href="a00121_source.html#l00142">arrayfunctions.h:142</a></div></div>
<div class="ttc" id="a00106_html_aafc992b5fa79d5a4036024615d03bce6"><div class="ttname"><a href="a00106.html#aafc992b5fa79d5a4036024615d03bce6">HyPar::ghosts</a></div><div class="ttdeci">int ghosts</div><div class="ttdef"><b>Definition:</b> <a href="a00125_source.html#l00041">hypar.h:41</a></div></div>
<div class="ttc" id="a00099_html_afb1265dc9bb8f8c05bd22f88c23d879c"><div class="ttname"><a href="a00099.html#afb1265dc9bb8f8c05bd22f88c23d879c">Euler1D::grav_field</a></div><div class="ttdeci">double * grav_field</div><div class="ttdef"><b>Definition:</b> <a href="a00129_source.html#l00286">euler1d.h:286</a></div></div>
<div class="ttc" id="a00129_html_a413fd3cab5a06c9d7a38334768d81b0f"><div class="ttname"><a href="a00129.html#a413fd3cab5a06c9d7a38334768d81b0f">_Euler1DLeftEigenvectors_</a></div><div class="ttdeci">#define _Euler1DLeftEigenvectors_(u, L, p, dir)</div><div class="ttdef"><b>Definition:</b> <a href="a00129_source.html#l00223">euler1d.h:223</a></div></div>
<div class="ttc" id="a00127_html_affe776513b24d84b39af8ab0930fef7f"><div class="ttname"><a href="a00127.html#affe776513b24d84b39af8ab0930fef7f">max</a></div><div class="ttdeci">#define max(a, b)</div><div class="ttdef"><b>Definition:</b> <a href="a00127_source.html#l00019">mathfunctions.h:19</a></div></div>
<div class="ttc" id="a00129_html_ad3395a55a5fde64d6603c7a82d7bf2c7"><div class="ttname"><a href="a00129.html#ad3395a55a5fde64d6603c7a82d7bf2c7">_MODEL_NVARS_</a></div><div class="ttdeci">#define _MODEL_NVARS_</div><div class="ttdef"><b>Definition:</b> <a href="a00129_source.html#l00058">euler1d.h:58</a></div></div>
<div class="ttc" id="a00127_html_adf1be5ccbb7a2522b4f3a64043c72880"><div class="ttname"><a href="a00127.html#adf1be5ccbb7a2522b4f3a64043c72880">absolute</a></div><div class="ttdeci">#define absolute(a)</div><div class="ttdef"><b>Definition:</b> <a href="a00127_source.html#l00033">mathfunctions.h:33</a></div></div>
<div class="ttc" id="a00106_html_a38e0371f331cecbe63a77fa03e202afe"><div class="ttname"><a href="a00106.html#a38e0371f331cecbe63a77fa03e202afe">HyPar::dim_local</a></div><div class="ttdeci">int * dim_local</div><div class="ttdef"><b>Definition:</b> <a href="a00125_source.html#l00032">hypar.h:32</a></div></div>
<div class="ttc" id="a00129_html_a115efdce970884e30c6564701f929092"><div class="ttname"><a href="a00129.html#a115efdce970884e30c6564701f929092">_Euler1DEigenvalues_</a></div><div class="ttdeci">#define _Euler1DEigenvalues_(u, D, p, dir)</div><div class="ttdef"><b>Definition:</b> <a href="a00129_source.html#l00205">euler1d.h:205</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a2050afda2d76244d8b1be2534d8eee88"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int Euler1DUpwinddFLLF </td>
          <td>(</td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>fI</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>fL</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>fR</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>uL</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>uR</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>u</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>dir</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>s</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>t</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>The characteristic-based local Lax-Friedrich upwinding scheme (<a class="el" href="a00281.html#aaafb95c6a0e137263bc9d072444a1fb7">Euler1DUpwindLLF</a>) for the partitioned hyperbolic flux that comprises of the acoustic waves only (see <a class="el" href="a00275.html#a31b02a37de0ea8443f0dd89d5861e114">Euler1DStiffFlux</a>, <a class="el" href="a00129.html#a5329991de3157d264ef86a1df4ff6bef">_Euler1DSetStiffFlux_</a>). Thus, only the characteristic fields / eigen-modes corresponding to \( u\pm a\) are used.</p>
<p>Reference:</p><ul>
<li>Ghosh, D., Constantinescu, E. M., Semi-Implicit Time Integration of Atmospheric Flows with Characteristic-Based Flux Partitioning, SIAM Journal on Scientific Computing, 38 (3), 2016, A1848-A1875, <a href="http://dx.doi.org/10.1137/15M1044369">http://dx.doi.org/10.1137/15M1044369</a> </li>
</ul>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">fI</td><td>Computed upwind interface flux </td></tr>
    <tr><td class="paramname">fL</td><td>Left-biased reconstructed interface flux </td></tr>
    <tr><td class="paramname">fR</td><td>Right-biased reconstructed interface flux </td></tr>
    <tr><td class="paramname">uL</td><td>Left-biased reconstructed interface solution </td></tr>
    <tr><td class="paramname">uR</td><td>Right-biased reconstructed interface solution </td></tr>
    <tr><td class="paramname">u</td><td>Cell-centered solution </td></tr>
    <tr><td class="paramname">dir</td><td>Spatial dimension (unused since this is a 1D system) </td></tr>
    <tr><td class="paramname">s</td><td>Solver object of type <a class="el" href="a00106.html" title="Structure containing all solver-specific variables and functions. ">HyPar</a> </td></tr>
    <tr><td class="paramname">t</td><td>Current solution time </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="a00281_source.html#l00540">540</a> of file <a class="el" href="a00281_source.html">Euler1DUpwind.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;{</div>
<div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;  <a class="code" href="a00106.html">HyPar</a>     *solver = (<a class="code" href="a00106.html">HyPar</a>*)    s;</div>
<div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;  <a class="code" href="a00099.html">Euler1D</a>   *param  = (<a class="code" href="a00099.html">Euler1D</a>*)  solver-&gt;<a class="code" href="a00106.html#a48e81a1806b5774943fd9a26e9a190f2">physics</a>;</div>
<div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;  <span class="keywordtype">int</span>       done,k;</div>
<div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;  <a class="code" href="a00122.html#a68f50121fb9a7daeaf60e50cdef82ef3">_DECLARE_IERR_</a>;</div>
<div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;</div>
<div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;  <span class="keywordtype">int</span>     ndims   = solver-&gt;<a class="code" href="a00106.html#a484873c74138512e41bc50d17b7d955a">ndims</a>;</div>
<div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;  <span class="keywordtype">int</span>     *dim    = solver-&gt;<a class="code" href="a00106.html#a38e0371f331cecbe63a77fa03e202afe">dim_local</a>;</div>
<div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;  <span class="keywordtype">int</span>     ghosts  = solver-&gt;<a class="code" href="a00106.html#aafc992b5fa79d5a4036024615d03bce6">ghosts</a>;</div>
<div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;  <span class="keywordtype">double</span>  *uref   = param-&gt;<a class="code" href="a00099.html#a7568fac4d4e8488510e1d37f468967b1">solution</a>;</div>
<div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;</div>
<div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;  <span class="keywordtype">int</span> index_outer[ndims], index_inter[ndims], bounds_outer[ndims], bounds_inter[ndims];</div>
<div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;  <a class="code" href="a00121.html#a89e8330d9e06dd0666c50833628a125c">_ArrayCopy1D_</a>(dim,bounds_outer,ndims); bounds_outer[dir] =  1;</div>
<div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;  <a class="code" href="a00121.html#a89e8330d9e06dd0666c50833628a125c">_ArrayCopy1D_</a>(dim,bounds_inter,ndims); bounds_inter[dir] += 1;</div>
<div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;  <span class="keyword">static</span> <span class="keywordtype">double</span> R[<a class="code" href="a00129.html#ad3395a55a5fde64d6603c7a82d7bf2c7">_MODEL_NVARS_</a>*<a class="code" href="a00129.html#ad3395a55a5fde64d6603c7a82d7bf2c7">_MODEL_NVARS_</a>], D[<a class="code" href="a00129.html#ad3395a55a5fde64d6603c7a82d7bf2c7">_MODEL_NVARS_</a>*<a class="code" href="a00129.html#ad3395a55a5fde64d6603c7a82d7bf2c7">_MODEL_NVARS_</a>], L[<a class="code" href="a00129.html#ad3395a55a5fde64d6603c7a82d7bf2c7">_MODEL_NVARS_</a>*<a class="code" href="a00129.html#ad3395a55a5fde64d6603c7a82d7bf2c7">_MODEL_NVARS_</a>];</div>
<div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;</div>
<div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;  done = 0; <a class="code" href="a00121.html#a2b2826031c0cd92495ab351d3e599fc5">_ArraySetValue_</a>(index_outer,ndims,0);</div>
<div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;  <span class="keywordflow">while</span> (!done) {</div>
<div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;    <a class="code" href="a00121.html#a89e8330d9e06dd0666c50833628a125c">_ArrayCopy1D_</a>(index_outer,index_inter,ndims);</div>
<div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;    <span class="keywordflow">for</span> (index_inter[dir] = 0; index_inter[dir] &lt; bounds_inter[dir]; index_inter[dir]++) {</div>
<div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;      <span class="keywordtype">int</span> p; <a class="code" href="a00121.html#afbb862a2fdf5b72b1f9ace42f64b556f">_ArrayIndex1D_</a>(ndims,bounds_inter,index_inter,0,p);</div>
<div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;      <span class="keywordtype">int</span> indexL[ndims]; <a class="code" href="a00121.html#a89e8330d9e06dd0666c50833628a125c">_ArrayCopy1D_</a>(index_inter,indexL,ndims); indexL[dir]--;</div>
<div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;      <span class="keywordtype">int</span> indexR[ndims]; <a class="code" href="a00121.html#a89e8330d9e06dd0666c50833628a125c">_ArrayCopy1D_</a>(index_inter,indexR,ndims);</div>
<div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;      <span class="keywordtype">int</span> pL; <a class="code" href="a00121.html#afbb862a2fdf5b72b1f9ace42f64b556f">_ArrayIndex1D_</a>(ndims,dim,indexL,ghosts,pL);</div>
<div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;      <span class="keywordtype">int</span> pR; <a class="code" href="a00121.html#afbb862a2fdf5b72b1f9ace42f64b556f">_ArrayIndex1D_</a>(ndims,dim,indexR,ghosts,pR);</div>
<div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;      <span class="keywordtype">double</span> uavg[<a class="code" href="a00129.html#ad3395a55a5fde64d6603c7a82d7bf2c7">_MODEL_NVARS_</a>], fcL[<a class="code" href="a00129.html#ad3395a55a5fde64d6603c7a82d7bf2c7">_MODEL_NVARS_</a>], fcR[<a class="code" href="a00129.html#ad3395a55a5fde64d6603c7a82d7bf2c7">_MODEL_NVARS_</a>], </div>
<div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;             ucL[<a class="code" href="a00129.html#ad3395a55a5fde64d6603c7a82d7bf2c7">_MODEL_NVARS_</a>], ucR[<a class="code" href="a00129.html#ad3395a55a5fde64d6603c7a82d7bf2c7">_MODEL_NVARS_</a>], fc[<a class="code" href="a00129.html#ad3395a55a5fde64d6603c7a82d7bf2c7">_MODEL_NVARS_</a>];</div>
<div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;      <span class="keywordtype">double</span> kappa = <a class="code" href="a00127.html#affe776513b24d84b39af8ab0930fef7f">max</a>(param-&gt;<a class="code" href="a00099.html#afb1265dc9bb8f8c05bd22f88c23d879c">grav_field</a>[pL],param-&gt;<a class="code" href="a00099.html#afb1265dc9bb8f8c05bd22f88c23d879c">grav_field</a>[pR]);</div>
<div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;</div>
<div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;      <span class="comment">/* Local Lax-Friedrich upwinding scheme */</span></div>
<div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;</div>
<div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;      <a class="code" href="a00129.html#a9a3e89dcf75e61433735d59b6556c346">_Euler1DRoeAverage_</a>       (uavg,(uref+<a class="code" href="a00129.html#ad3395a55a5fde64d6603c7a82d7bf2c7">_MODEL_NVARS_</a>*pL),(uref+<a class="code" href="a00129.html#ad3395a55a5fde64d6603c7a82d7bf2c7">_MODEL_NVARS_</a>*pR),param);</div>
<div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;      <a class="code" href="a00129.html#a115efdce970884e30c6564701f929092">_Euler1DEigenvalues_</a>      (uavg,D,param,0);</div>
<div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;      <a class="code" href="a00129.html#a413fd3cab5a06c9d7a38334768d81b0f">_Euler1DLeftEigenvectors_</a> (uavg,L,param,0);</div>
<div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;      <a class="code" href="a00129.html#a4449638968eca76bb5631bc75b7dced7">_Euler1DRightEigenvectors_</a>(uavg,R,param,0);</div>
<div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;</div>
<div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160;      <span class="comment">/* calculate characteristic fluxes and variables */</span></div>
<div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160;      <a class="code" href="a00127.html#abf4f45dbf1a3ea84452ba1da7b526d71">MatVecMult3</a>(<a class="code" href="a00129.html#ad3395a55a5fde64d6603c7a82d7bf2c7">_MODEL_NVARS_</a>,ucL,L,(uL+<a class="code" href="a00129.html#ad3395a55a5fde64d6603c7a82d7bf2c7">_MODEL_NVARS_</a>*p));</div>
<div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;      <a class="code" href="a00127.html#abf4f45dbf1a3ea84452ba1da7b526d71">MatVecMult3</a>(<a class="code" href="a00129.html#ad3395a55a5fde64d6603c7a82d7bf2c7">_MODEL_NVARS_</a>,ucR,L,(uR+<a class="code" href="a00129.html#ad3395a55a5fde64d6603c7a82d7bf2c7">_MODEL_NVARS_</a>*p));</div>
<div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160;      <a class="code" href="a00127.html#abf4f45dbf1a3ea84452ba1da7b526d71">MatVecMult3</a>(<a class="code" href="a00129.html#ad3395a55a5fde64d6603c7a82d7bf2c7">_MODEL_NVARS_</a>,fcL,L,(fL+<a class="code" href="a00129.html#ad3395a55a5fde64d6603c7a82d7bf2c7">_MODEL_NVARS_</a>*p));</div>
<div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160;      <a class="code" href="a00127.html#abf4f45dbf1a3ea84452ba1da7b526d71">MatVecMult3</a>(<a class="code" href="a00129.html#ad3395a55a5fde64d6603c7a82d7bf2c7">_MODEL_NVARS_</a>,fcR,L,(fR+<a class="code" href="a00129.html#ad3395a55a5fde64d6603c7a82d7bf2c7">_MODEL_NVARS_</a>*p));</div>
<div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160;</div>
<div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160;      <span class="keywordflow">for</span> (k = 0; k &lt; <a class="code" href="a00129.html#ad3395a55a5fde64d6603c7a82d7bf2c7">_MODEL_NVARS_</a>; k++) {</div>
<div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160;        <span class="keywordtype">double</span> eigL,eigC,eigR;</div>
<div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160;        <a class="code" href="a00129.html#a115efdce970884e30c6564701f929092">_Euler1DEigenvalues_</a>((u+_MODEL_NVARS_*pL),D,param,0);</div>
<div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;        eigL = (k == 0? 0.0 : D[k*_MODEL_NVARS_+k]);</div>
<div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160;        <a class="code" href="a00129.html#a115efdce970884e30c6564701f929092">_Euler1DEigenvalues_</a>((u+_MODEL_NVARS_*pR),D,param,0);</div>
<div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160;        eigR = (k == 0? 0.0 : D[k*_MODEL_NVARS_+k]);</div>
<div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;        <a class="code" href="a00129.html#a115efdce970884e30c6564701f929092">_Euler1DEigenvalues_</a>(uavg,D,param,0);</div>
<div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160;        eigC = (k == 0? 0.0 : D[k*_MODEL_NVARS_+k]);</div>
<div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160;</div>
<div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160;        <span class="keywordtype">double</span> alpha = kappa * <a class="code" href="a00127.html#aa0d45e1e67c5cacf5c9251fcd90a971b">max3</a>(<a class="code" href="a00127.html#adf1be5ccbb7a2522b4f3a64043c72880">absolute</a>(eigL),<a class="code" href="a00127.html#adf1be5ccbb7a2522b4f3a64043c72880">absolute</a>(eigC),<a class="code" href="a00127.html#adf1be5ccbb7a2522b4f3a64043c72880">absolute</a>(eigR));</div>
<div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160;        fc[k] = 0.5 * (fcL[k] + fcR[k] + alpha * (ucL[k]-ucR[k]));</div>
<div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160;      }</div>
<div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160;</div>
<div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160;      <span class="comment">/* calculate the interface flux from the characteristic flux */</span></div>
<div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160;      <a class="code" href="a00127.html#abf4f45dbf1a3ea84452ba1da7b526d71">MatVecMult3</a>(_MODEL_NVARS_,(fI+_MODEL_NVARS_*p),R,fc);</div>
<div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160;    }</div>
<div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160;    <a class="code" href="a00121.html#ac5ec1371623f11d03b0f42adaa24acbc">_ArrayIncrementIndex_</a>(ndims,bounds_outer,index_outer,done);</div>
<div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160;  }</div>
<div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;</div>
<div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160;  <span class="keywordflow">return</span>(0);</div>
<div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160;}</div>
<div class="ttc" id="a00122_html_a68f50121fb9a7daeaf60e50cdef82ef3"><div class="ttname"><a href="a00122.html#a68f50121fb9a7daeaf60e50cdef82ef3">_DECLARE_IERR_</a></div><div class="ttdeci">#define _DECLARE_IERR_</div><div class="ttdef"><b>Definition:</b> <a href="a00122_source.html#l00010">basic.h:10</a></div></div>
<div class="ttc" id="a00106_html_a484873c74138512e41bc50d17b7d955a"><div class="ttname"><a href="a00106.html#a484873c74138512e41bc50d17b7d955a">HyPar::ndims</a></div><div class="ttdeci">int ndims</div><div class="ttdef"><b>Definition:</b> <a href="a00125_source.html#l00023">hypar.h:23</a></div></div>
<div class="ttc" id="a00121_html_ac5ec1371623f11d03b0f42adaa24acbc"><div class="ttname"><a href="a00121.html#ac5ec1371623f11d03b0f42adaa24acbc">_ArrayIncrementIndex_</a></div><div class="ttdeci">#define _ArrayIncrementIndex_(N, imax, i, done)</div><div class="ttdef"><b>Definition:</b> <a href="a00121_source.html#l00122">arrayfunctions.h:122</a></div></div>
<div class="ttc" id="a00129_html_a4449638968eca76bb5631bc75b7dced7"><div class="ttname"><a href="a00129.html#a4449638968eca76bb5631bc75b7dced7">_Euler1DRightEigenvectors_</a></div><div class="ttdeci">#define _Euler1DRightEigenvectors_(u, R, p, dir)</div><div class="ttdef"><b>Definition:</b> <a href="a00129_source.html#l00247">euler1d.h:247</a></div></div>
<div class="ttc" id="a00129_html_a9a3e89dcf75e61433735d59b6556c346"><div class="ttname"><a href="a00129.html#a9a3e89dcf75e61433735d59b6556c346">_Euler1DRoeAverage_</a></div><div class="ttdeci">#define _Euler1DRoeAverage_(uavg, uL, uR, p)</div><div class="ttdef"><b>Definition:</b> <a href="a00129_source.html#l00167">euler1d.h:167</a></div></div>
<div class="ttc" id="a00121_html_a89e8330d9e06dd0666c50833628a125c"><div class="ttname"><a href="a00121.html#a89e8330d9e06dd0666c50833628a125c">_ArrayCopy1D_</a></div><div class="ttdeci">#define _ArrayCopy1D_(x, y, size)</div><div class="ttdef"><b>Definition:</b> <a href="a00121_source.html#l00281">arrayfunctions.h:281</a></div></div>
<div class="ttc" id="a00127_html_aa0d45e1e67c5cacf5c9251fcd90a971b"><div class="ttname"><a href="a00127.html#aa0d45e1e67c5cacf5c9251fcd90a971b">max3</a></div><div class="ttdeci">#define max3(a, b, c)</div><div class="ttdef"><b>Definition:</b> <a href="a00127_source.html#l00028">mathfunctions.h:28</a></div></div>
<div class="ttc" id="a00121_html_afbb862a2fdf5b72b1f9ace42f64b556f"><div class="ttname"><a href="a00121.html#afbb862a2fdf5b72b1f9ace42f64b556f">_ArrayIndex1D_</a></div><div class="ttdeci">#define _ArrayIndex1D_(N, imax, i, ghost, index)</div><div class="ttdef"><b>Definition:</b> <a href="a00121_source.html#l00036">arrayfunctions.h:36</a></div></div>
<div class="ttc" id="a00099_html"><div class="ttname"><a href="a00099.html">Euler1D</a></div><div class="ttdoc">Structure containing variables and parameters specific to the 1D Euler equations. This structure cont...</div><div class="ttdef"><b>Definition:</b> <a href="a00129_source.html#l00271">euler1d.h:271</a></div></div>
<div class="ttc" id="a00106_html"><div class="ttname"><a href="a00106.html">HyPar</a></div><div class="ttdoc">Structure containing all solver-specific variables and functions. </div><div class="ttdef"><b>Definition:</b> <a href="a00125_source.html#l00020">hypar.h:20</a></div></div>
<div class="ttc" id="a00099_html_a7568fac4d4e8488510e1d37f468967b1"><div class="ttname"><a href="a00099.html#a7568fac4d4e8488510e1d37f468967b1">Euler1D::solution</a></div><div class="ttdeci">double * solution</div><div class="ttdef"><b>Definition:</b> <a href="a00129_source.html#l00288">euler1d.h:288</a></div></div>
<div class="ttc" id="a00106_html_a48e81a1806b5774943fd9a26e9a190f2"><div class="ttname"><a href="a00106.html#a48e81a1806b5774943fd9a26e9a190f2">HyPar::physics</a></div><div class="ttdeci">void * physics</div><div class="ttdef"><b>Definition:</b> <a href="a00125_source.html#l00231">hypar.h:231</a></div></div>
<div class="ttc" id="a00127_html_abf4f45dbf1a3ea84452ba1da7b526d71"><div class="ttname"><a href="a00127.html#abf4f45dbf1a3ea84452ba1da7b526d71">MatVecMult3</a></div><div class="ttdeci">#define MatVecMult3(N, y, A, x)</div><div class="ttdef"><b>Definition:</b> <a href="a00127_source.html#l00168">mathfunctions.h:168</a></div></div>
<div class="ttc" id="a00121_html_a2b2826031c0cd92495ab351d3e599fc5"><div class="ttname"><a href="a00121.html#a2b2826031c0cd92495ab351d3e599fc5">_ArraySetValue_</a></div><div class="ttdeci">#define _ArraySetValue_(x, size, value)</div><div class="ttdef"><b>Definition:</b> <a href="a00121_source.html#l00142">arrayfunctions.h:142</a></div></div>
<div class="ttc" id="a00106_html_aafc992b5fa79d5a4036024615d03bce6"><div class="ttname"><a href="a00106.html#aafc992b5fa79d5a4036024615d03bce6">HyPar::ghosts</a></div><div class="ttdeci">int ghosts</div><div class="ttdef"><b>Definition:</b> <a href="a00125_source.html#l00041">hypar.h:41</a></div></div>
<div class="ttc" id="a00099_html_afb1265dc9bb8f8c05bd22f88c23d879c"><div class="ttname"><a href="a00099.html#afb1265dc9bb8f8c05bd22f88c23d879c">Euler1D::grav_field</a></div><div class="ttdeci">double * grav_field</div><div class="ttdef"><b>Definition:</b> <a href="a00129_source.html#l00286">euler1d.h:286</a></div></div>
<div class="ttc" id="a00129_html_a413fd3cab5a06c9d7a38334768d81b0f"><div class="ttname"><a href="a00129.html#a413fd3cab5a06c9d7a38334768d81b0f">_Euler1DLeftEigenvectors_</a></div><div class="ttdeci">#define _Euler1DLeftEigenvectors_(u, L, p, dir)</div><div class="ttdef"><b>Definition:</b> <a href="a00129_source.html#l00223">euler1d.h:223</a></div></div>
<div class="ttc" id="a00127_html_affe776513b24d84b39af8ab0930fef7f"><div class="ttname"><a href="a00127.html#affe776513b24d84b39af8ab0930fef7f">max</a></div><div class="ttdeci">#define max(a, b)</div><div class="ttdef"><b>Definition:</b> <a href="a00127_source.html#l00019">mathfunctions.h:19</a></div></div>
<div class="ttc" id="a00129_html_ad3395a55a5fde64d6603c7a82d7bf2c7"><div class="ttname"><a href="a00129.html#ad3395a55a5fde64d6603c7a82d7bf2c7">_MODEL_NVARS_</a></div><div class="ttdeci">#define _MODEL_NVARS_</div><div class="ttdef"><b>Definition:</b> <a href="a00129_source.html#l00058">euler1d.h:58</a></div></div>
<div class="ttc" id="a00127_html_adf1be5ccbb7a2522b4f3a64043c72880"><div class="ttname"><a href="a00127.html#adf1be5ccbb7a2522b4f3a64043c72880">absolute</a></div><div class="ttdeci">#define absolute(a)</div><div class="ttdef"><b>Definition:</b> <a href="a00127_source.html#l00033">mathfunctions.h:33</a></div></div>
<div class="ttc" id="a00106_html_a38e0371f331cecbe63a77fa03e202afe"><div class="ttname"><a href="a00106.html#a38e0371f331cecbe63a77fa03e202afe">HyPar::dim_local</a></div><div class="ttdeci">int * dim_local</div><div class="ttdef"><b>Definition:</b> <a href="a00125_source.html#l00032">hypar.h:32</a></div></div>
<div class="ttc" id="a00129_html_a115efdce970884e30c6564701f929092"><div class="ttname"><a href="a00129.html#a115efdce970884e30c6564701f929092">_Euler1DEigenvalues_</a></div><div class="ttdeci">#define _Euler1DEigenvalues_(u, D, p, dir)</div><div class="ttdef"><b>Definition:</b> <a href="a00129_source.html#l00205">euler1d.h:205</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a0c16592ca1938504fff89a566be82a87"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int Euler1DUpwindSWFS </td>
          <td>(</td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>fI</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>fL</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>fR</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>uL</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>uR</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>u</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>dir</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>s</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>t</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Steger-Warming Flux-Splitting scheme</p><ul>
<li>Steger, J.L., Warming, R.F., "Flux vector splitting of the inviscid gasdynamic equations with 
  application to finite-difference methods", J. Comput. Phys., 40(2), 1981, pp. 263-293, <a href="http://dx.doi.org/10.1016/0021-9991(81)90210-2">http://dx.doi.org/10.1016/0021-9991(81)90210-2</a>.</li>
</ul>
<p>Note that this method cannot be used for flows with non-zero gravitational forces. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">fI</td><td>Computed upwind interface flux </td></tr>
    <tr><td class="paramname">fL</td><td>Left-biased reconstructed interface flux </td></tr>
    <tr><td class="paramname">fR</td><td>Right-biased reconstructed interface flux </td></tr>
    <tr><td class="paramname">uL</td><td>Left-biased reconstructed interface solution </td></tr>
    <tr><td class="paramname">uR</td><td>Right-biased reconstructed interface solution </td></tr>
    <tr><td class="paramname">u</td><td>Cell-centered solution </td></tr>
    <tr><td class="paramname">dir</td><td>Spatial dimension (unused since this is a 1D system) </td></tr>
    <tr><td class="paramname">s</td><td>Solver object of type <a class="el" href="a00106.html" title="Structure containing all solver-specific variables and functions. ">HyPar</a> </td></tr>
    <tr><td class="paramname">t</td><td>Current solution time </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="a00281_source.html#l00292">292</a> of file <a class="el" href="a00281_source.html">Euler1DUpwind.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;{</div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;  <a class="code" href="a00106.html">HyPar</a>     *solver = (<a class="code" href="a00106.html">HyPar</a>*)    s;</div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;  <a class="code" href="a00099.html">Euler1D</a>   *param  = (<a class="code" href="a00099.html">Euler1D</a>*)  solver-&gt;<a class="code" href="a00106.html#a48e81a1806b5774943fd9a26e9a190f2">physics</a>;</div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;  <span class="keywordtype">int</span>       done;</div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;  <a class="code" href="a00122.html#a68f50121fb9a7daeaf60e50cdef82ef3">_DECLARE_IERR_</a>;</div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;</div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;  <span class="keywordtype">int</span> ndims = solver-&gt;<a class="code" href="a00106.html#a484873c74138512e41bc50d17b7d955a">ndims</a>;</div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;  <span class="keywordtype">int</span> *dim  = solver-&gt;<a class="code" href="a00106.html#a38e0371f331cecbe63a77fa03e202afe">dim_local</a>;</div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;</div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;  <span class="keywordtype">int</span> index_outer[ndims], index_inter[ndims], bounds_outer[ndims], bounds_inter[ndims];</div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;  <a class="code" href="a00121.html#a89e8330d9e06dd0666c50833628a125c">_ArrayCopy1D_</a>(dim,bounds_outer,ndims); bounds_outer[dir] =  1;</div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;  <a class="code" href="a00121.html#a89e8330d9e06dd0666c50833628a125c">_ArrayCopy1D_</a>(dim,bounds_inter,ndims); bounds_inter[dir] += 1;</div>
<div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;  <span class="keyword">static</span> <span class="keywordtype">double</span> fp[<a class="code" href="a00129.html#ad3395a55a5fde64d6603c7a82d7bf2c7">_MODEL_NVARS_</a>], fm[<a class="code" href="a00129.html#ad3395a55a5fde64d6603c7a82d7bf2c7">_MODEL_NVARS_</a>],uavg[<a class="code" href="a00129.html#ad3395a55a5fde64d6603c7a82d7bf2c7">_MODEL_NVARS_</a>];</div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;</div>
<div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;  done = 0; <a class="code" href="a00121.html#a2b2826031c0cd92495ab351d3e599fc5">_ArraySetValue_</a>(index_outer,ndims,0);</div>
<div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;  <span class="keywordflow">while</span> (!done) {</div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;    <a class="code" href="a00121.html#a89e8330d9e06dd0666c50833628a125c">_ArrayCopy1D_</a>(index_outer,index_inter,ndims);</div>
<div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;    <span class="keywordflow">for</span> (index_inter[dir] = 0; index_inter[dir] &lt; bounds_inter[dir]; index_inter[dir]++) {</div>
<div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;      <span class="keywordtype">int</span> p; <a class="code" href="a00121.html#afbb862a2fdf5b72b1f9ace42f64b556f">_ArrayIndex1D_</a>(ndims,bounds_inter,index_inter,0,p);</div>
<div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;      <span class="keywordtype">double</span> rho,v,e,P,c,gamma=param-&gt;<a class="code" href="a00099.html#a72f9e01745b3a8203067ab84aefc9aea">gamma</a>,term,Mach;</div>
<div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;</div>
<div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;      <span class="comment">/* Steger Warming flux splitting */</span></div>
<div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;      <a class="code" href="a00129.html#a9a3e89dcf75e61433735d59b6556c346">_Euler1DRoeAverage_</a>(uavg,(uL+<a class="code" href="a00129.html#ad3395a55a5fde64d6603c7a82d7bf2c7">_MODEL_NVARS_</a>*p),(uR+<a class="code" href="a00129.html#ad3395a55a5fde64d6603c7a82d7bf2c7">_MODEL_NVARS_</a>*p),param); </div>
<div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;      <a class="code" href="a00129.html#af35510fb1477577f57c57cc2a862b1e7">_Euler1DGetFlowVar_</a>(uavg,rho,v,e,P,param);</div>
<div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;      Mach = v/sqrt(gamma*P/rho);</div>
<div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;</div>
<div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;      <span class="keywordflow">if</span> (Mach &lt; -1.0) {</div>
<div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;</div>
<div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;        <a class="code" href="a00121.html#a6c0f97c663dddd14f3f683e5c223d88c">_ArrayCopy1D3_</a>((fR+<a class="code" href="a00129.html#ad3395a55a5fde64d6603c7a82d7bf2c7">_MODEL_NVARS_</a>*p),(fI+<a class="code" href="a00129.html#ad3395a55a5fde64d6603c7a82d7bf2c7">_MODEL_NVARS_</a>*p),<a class="code" href="a00129.html#ad3395a55a5fde64d6603c7a82d7bf2c7">_MODEL_NVARS_</a>);</div>
<div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;</div>
<div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;      } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (Mach &lt; 1.0) {</div>
<div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;</div>
<div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;        <a class="code" href="a00129.html#af35510fb1477577f57c57cc2a862b1e7">_Euler1DGetFlowVar_</a>((uL+<a class="code" href="a00129.html#ad3395a55a5fde64d6603c7a82d7bf2c7">_MODEL_NVARS_</a>*p),rho,v,e,P,param);</div>
<div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;        c = sqrt(gamma*P/rho);</div>
<div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;        term = rho/(2.0*gamma);</div>
<div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;</div>
<div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;        fp[0] = term * (2*gamma*v + c - v);</div>
<div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;        fp[1] = term * (2*(gamma-1.0)*v*v + (v+c)*(v+c));</div>
<div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;        fp[2] = term * ((gamma-1.0)*v*v*v + 0.5*(v+c)*(v+c)*(v+c) + ((3.0-gamma)*(v+c)*c*c)/(2.0*(gamma-1.0)));</div>
<div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;</div>
<div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;        <a class="code" href="a00129.html#af35510fb1477577f57c57cc2a862b1e7">_Euler1DGetFlowVar_</a>((uR+<a class="code" href="a00129.html#ad3395a55a5fde64d6603c7a82d7bf2c7">_MODEL_NVARS_</a>*p),rho,v,e,P,param);</div>
<div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;        c = sqrt(gamma*P/rho);</div>
<div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;        term = rho/(2.0*gamma);</div>
<div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;</div>
<div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;        fm[0] = term * (v - c);</div>
<div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;        fm[1] = term * (v-c) * (v-c);</div>
<div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;        fm[2] = term * (0.5*(v-c)*(v-c)*(v-c) + ((3.0-gamma)*(v-c)*c*c)/(2.0*(gamma-1.0)));</div>
<div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;</div>
<div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;        <a class="code" href="a00121.html#a98a3bb5fda2fcafb70a6288d100a0924">_ArrayAdd1D_</a>((fI+<a class="code" href="a00129.html#ad3395a55a5fde64d6603c7a82d7bf2c7">_MODEL_NVARS_</a>*p),fp,fm,<a class="code" href="a00129.html#ad3395a55a5fde64d6603c7a82d7bf2c7">_MODEL_NVARS_</a>);</div>
<div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;</div>
<div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;      } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;</div>
<div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;        <a class="code" href="a00121.html#a6c0f97c663dddd14f3f683e5c223d88c">_ArrayCopy1D3_</a>((fL+<a class="code" href="a00129.html#ad3395a55a5fde64d6603c7a82d7bf2c7">_MODEL_NVARS_</a>*p),(fI+<a class="code" href="a00129.html#ad3395a55a5fde64d6603c7a82d7bf2c7">_MODEL_NVARS_</a>*p),<a class="code" href="a00129.html#ad3395a55a5fde64d6603c7a82d7bf2c7">_MODEL_NVARS_</a>);</div>
<div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;</div>
<div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;      }</div>
<div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;</div>
<div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;    }</div>
<div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;    <a class="code" href="a00121.html#ac5ec1371623f11d03b0f42adaa24acbc">_ArrayIncrementIndex_</a>(ndims,bounds_outer,index_outer,done);</div>
<div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;  }</div>
<div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;</div>
<div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;  <span class="keywordflow">return</span>(0);</div>
<div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;}</div>
<div class="ttc" id="a00122_html_a68f50121fb9a7daeaf60e50cdef82ef3"><div class="ttname"><a href="a00122.html#a68f50121fb9a7daeaf60e50cdef82ef3">_DECLARE_IERR_</a></div><div class="ttdeci">#define _DECLARE_IERR_</div><div class="ttdef"><b>Definition:</b> <a href="a00122_source.html#l00010">basic.h:10</a></div></div>
<div class="ttc" id="a00121_html_a6c0f97c663dddd14f3f683e5c223d88c"><div class="ttname"><a href="a00121.html#a6c0f97c663dddd14f3f683e5c223d88c">_ArrayCopy1D3_</a></div><div class="ttdeci">#define _ArrayCopy1D3_(x, y, size)</div><div class="ttdef"><b>Definition:</b> <a href="a00121_source.html#l00305">arrayfunctions.h:305</a></div></div>
<div class="ttc" id="a00106_html_a484873c74138512e41bc50d17b7d955a"><div class="ttname"><a href="a00106.html#a484873c74138512e41bc50d17b7d955a">HyPar::ndims</a></div><div class="ttdeci">int ndims</div><div class="ttdef"><b>Definition:</b> <a href="a00125_source.html#l00023">hypar.h:23</a></div></div>
<div class="ttc" id="a00121_html_a98a3bb5fda2fcafb70a6288d100a0924"><div class="ttname"><a href="a00121.html#a98a3bb5fda2fcafb70a6288d100a0924">_ArrayAdd1D_</a></div><div class="ttdeci">#define _ArrayAdd1D_(x, a, b, size)</div><div class="ttdef"><b>Definition:</b> <a href="a00121_source.html#l00174">arrayfunctions.h:174</a></div></div>
<div class="ttc" id="a00129_html_af35510fb1477577f57c57cc2a862b1e7"><div class="ttname"><a href="a00129.html#af35510fb1477577f57c57cc2a862b1e7">_Euler1DGetFlowVar_</a></div><div class="ttdeci">#define _Euler1DGetFlowVar_(u, rho, v, e, P, p)</div><div class="ttdef"><b>Definition:</b> <a href="a00129_source.html#l00079">euler1d.h:79</a></div></div>
<div class="ttc" id="a00121_html_ac5ec1371623f11d03b0f42adaa24acbc"><div class="ttname"><a href="a00121.html#ac5ec1371623f11d03b0f42adaa24acbc">_ArrayIncrementIndex_</a></div><div class="ttdeci">#define _ArrayIncrementIndex_(N, imax, i, done)</div><div class="ttdef"><b>Definition:</b> <a href="a00121_source.html#l00122">arrayfunctions.h:122</a></div></div>
<div class="ttc" id="a00129_html_a9a3e89dcf75e61433735d59b6556c346"><div class="ttname"><a href="a00129.html#a9a3e89dcf75e61433735d59b6556c346">_Euler1DRoeAverage_</a></div><div class="ttdeci">#define _Euler1DRoeAverage_(uavg, uL, uR, p)</div><div class="ttdef"><b>Definition:</b> <a href="a00129_source.html#l00167">euler1d.h:167</a></div></div>
<div class="ttc" id="a00099_html_a72f9e01745b3a8203067ab84aefc9aea"><div class="ttname"><a href="a00099.html#a72f9e01745b3a8203067ab84aefc9aea">Euler1D::gamma</a></div><div class="ttdeci">double gamma</div><div class="ttdef"><b>Definition:</b> <a href="a00129_source.html#l00272">euler1d.h:272</a></div></div>
<div class="ttc" id="a00121_html_a89e8330d9e06dd0666c50833628a125c"><div class="ttname"><a href="a00121.html#a89e8330d9e06dd0666c50833628a125c">_ArrayCopy1D_</a></div><div class="ttdeci">#define _ArrayCopy1D_(x, y, size)</div><div class="ttdef"><b>Definition:</b> <a href="a00121_source.html#l00281">arrayfunctions.h:281</a></div></div>
<div class="ttc" id="a00121_html_afbb862a2fdf5b72b1f9ace42f64b556f"><div class="ttname"><a href="a00121.html#afbb862a2fdf5b72b1f9ace42f64b556f">_ArrayIndex1D_</a></div><div class="ttdeci">#define _ArrayIndex1D_(N, imax, i, ghost, index)</div><div class="ttdef"><b>Definition:</b> <a href="a00121_source.html#l00036">arrayfunctions.h:36</a></div></div>
<div class="ttc" id="a00099_html"><div class="ttname"><a href="a00099.html">Euler1D</a></div><div class="ttdoc">Structure containing variables and parameters specific to the 1D Euler equations. This structure cont...</div><div class="ttdef"><b>Definition:</b> <a href="a00129_source.html#l00271">euler1d.h:271</a></div></div>
<div class="ttc" id="a00106_html"><div class="ttname"><a href="a00106.html">HyPar</a></div><div class="ttdoc">Structure containing all solver-specific variables and functions. </div><div class="ttdef"><b>Definition:</b> <a href="a00125_source.html#l00020">hypar.h:20</a></div></div>
<div class="ttc" id="a00106_html_a48e81a1806b5774943fd9a26e9a190f2"><div class="ttname"><a href="a00106.html#a48e81a1806b5774943fd9a26e9a190f2">HyPar::physics</a></div><div class="ttdeci">void * physics</div><div class="ttdef"><b>Definition:</b> <a href="a00125_source.html#l00231">hypar.h:231</a></div></div>
<div class="ttc" id="a00121_html_a2b2826031c0cd92495ab351d3e599fc5"><div class="ttname"><a href="a00121.html#a2b2826031c0cd92495ab351d3e599fc5">_ArraySetValue_</a></div><div class="ttdeci">#define _ArraySetValue_(x, size, value)</div><div class="ttdef"><b>Definition:</b> <a href="a00121_source.html#l00142">arrayfunctions.h:142</a></div></div>
<div class="ttc" id="a00129_html_ad3395a55a5fde64d6603c7a82d7bf2c7"><div class="ttname"><a href="a00129.html#ad3395a55a5fde64d6603c7a82d7bf2c7">_MODEL_NVARS_</a></div><div class="ttdeci">#define _MODEL_NVARS_</div><div class="ttdef"><b>Definition:</b> <a href="a00129_source.html#l00058">euler1d.h:58</a></div></div>
<div class="ttc" id="a00106_html_a38e0371f331cecbe63a77fa03e202afe"><div class="ttname"><a href="a00106.html#a38e0371f331cecbe63a77fa03e202afe">HyPar::dim_local</a></div><div class="ttdeci">int * dim_local</div><div class="ttdef"><b>Definition:</b> <a href="a00125_source.html#l00032">hypar.h:32</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a7ab3a531ada5d839c915add13cea5ae0"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int Euler1DJacobian </td>
          <td>(</td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>Jac</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>u</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>p</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>dir</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>upw</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Function to compute the flux Jacobian of the 1D Euler equations, given the solution at a grid point. The Jacobian is square matrix of size nvar=3, and is returned as a 1D array (double) of 9 elements in row-major format. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">Jac</td><td>Jacobian matrix: 1D array of size nvar^2 = 9 </td></tr>
    <tr><td class="paramname">u</td><td>solution at a grid point (array of size nvar = 3) </td></tr>
    <tr><td class="paramname">p</td><td>object containing the physics-related parameters </td></tr>
    <tr><td class="paramname">dir</td><td>dimension (x/y/z) (not used, since this is 1D system) </td></tr>
    <tr><td class="paramname">upw</td><td>0 -&gt; send back complete Jacobian, 1 -&gt; send back Jacobian of right(+)-moving flux, -1 -&gt; send back Jacobian of left(-)-moving flux </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="a00276_source.html#l00013">13</a> of file <a class="el" href="a00276_source.html">Euler1DJacobian.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;{</div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;  <a class="code" href="a00099.html">Euler1D</a>       *param = (<a class="code" href="a00099.html">Euler1D</a>*) p;</div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;  <span class="keyword">static</span> <span class="keywordtype">double</span> R[<a class="code" href="a00129.html#ad3395a55a5fde64d6603c7a82d7bf2c7">_MODEL_NVARS_</a>*<a class="code" href="a00129.html#ad3395a55a5fde64d6603c7a82d7bf2c7">_MODEL_NVARS_</a>], D[<a class="code" href="a00129.html#ad3395a55a5fde64d6603c7a82d7bf2c7">_MODEL_NVARS_</a>*<a class="code" href="a00129.html#ad3395a55a5fde64d6603c7a82d7bf2c7">_MODEL_NVARS_</a>], </div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;                L[<a class="code" href="a00129.html#ad3395a55a5fde64d6603c7a82d7bf2c7">_MODEL_NVARS_</a>*<a class="code" href="a00129.html#ad3395a55a5fde64d6603c7a82d7bf2c7">_MODEL_NVARS_</a>], DL[<a class="code" href="a00129.html#ad3395a55a5fde64d6603c7a82d7bf2c7">_MODEL_NVARS_</a>*<a class="code" href="a00129.html#ad3395a55a5fde64d6603c7a82d7bf2c7">_MODEL_NVARS_</a>];</div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;</div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;  <span class="comment">/* get the eigenvalues and left,right eigenvectors */</span></div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;  <a class="code" href="a00129.html#a115efdce970884e30c6564701f929092">_Euler1DEigenvalues_</a>      (u,D,param,0);</div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;  <a class="code" href="a00129.html#a413fd3cab5a06c9d7a38334768d81b0f">_Euler1DLeftEigenvectors_</a> (u,L,param,0);</div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;  <a class="code" href="a00129.html#a4449638968eca76bb5631bc75b7dced7">_Euler1DRightEigenvectors_</a>(u,R,param,0);</div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;</div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;  <span class="keywordtype">int</span> aupw = <a class="code" href="a00127.html#adf1be5ccbb7a2522b4f3a64043c72880">absolute</a>(upw), k;</div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;  k = 0; D[k] = <a class="code" href="a00127.html#adf1be5ccbb7a2522b4f3a64043c72880">absolute</a>( (1-aupw)*D[k] + 0.5*aupw*(1+upw)*<a class="code" href="a00127.html#affe776513b24d84b39af8ab0930fef7f">max</a>(0,D[k]) + 0.5*aupw*(1-upw)*<a class="code" href="a00127.html#ac6afabdc09a49a433ee19d8a9486056d">min</a>(0,D[k]) );</div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;  k = 4; D[k] = <a class="code" href="a00127.html#adf1be5ccbb7a2522b4f3a64043c72880">absolute</a>( (1-aupw)*D[k] + 0.5*aupw*(1+upw)*<a class="code" href="a00127.html#affe776513b24d84b39af8ab0930fef7f">max</a>(0,D[k]) + 0.5*aupw*(1-upw)*<a class="code" href="a00127.html#ac6afabdc09a49a433ee19d8a9486056d">min</a>(0,D[k]) );</div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;  k = 8; D[k] = <a class="code" href="a00127.html#adf1be5ccbb7a2522b4f3a64043c72880">absolute</a>( (1-aupw)*D[k] + 0.5*aupw*(1+upw)*<a class="code" href="a00127.html#affe776513b24d84b39af8ab0930fef7f">max</a>(0,D[k]) + 0.5*aupw*(1-upw)*<a class="code" href="a00127.html#ac6afabdc09a49a433ee19d8a9486056d">min</a>(0,D[k]) );</div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;</div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;  <a class="code" href="a00127.html#ad08720847b0aef444876b608b7af9a5c">MatMult3</a>(3,DL,D,L);</div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;  <a class="code" href="a00127.html#ad08720847b0aef444876b608b7af9a5c">MatMult3</a>(3,Jac,R,DL);</div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;</div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;  <span class="keywordflow">return</span>(0);</div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;}</div>
<div class="ttc" id="a00129_html_a4449638968eca76bb5631bc75b7dced7"><div class="ttname"><a href="a00129.html#a4449638968eca76bb5631bc75b7dced7">_Euler1DRightEigenvectors_</a></div><div class="ttdeci">#define _Euler1DRightEigenvectors_(u, R, p, dir)</div><div class="ttdef"><b>Definition:</b> <a href="a00129_source.html#l00247">euler1d.h:247</a></div></div>
<div class="ttc" id="a00127_html_ac6afabdc09a49a433ee19d8a9486056d"><div class="ttname"><a href="a00127.html#ac6afabdc09a49a433ee19d8a9486056d">min</a></div><div class="ttdeci">#define min(a, b)</div><div class="ttdef"><b>Definition:</b> <a href="a00127_source.html#l00015">mathfunctions.h:15</a></div></div>
<div class="ttc" id="a00099_html"><div class="ttname"><a href="a00099.html">Euler1D</a></div><div class="ttdoc">Structure containing variables and parameters specific to the 1D Euler equations. This structure cont...</div><div class="ttdef"><b>Definition:</b> <a href="a00129_source.html#l00271">euler1d.h:271</a></div></div>
<div class="ttc" id="a00127_html_ad08720847b0aef444876b608b7af9a5c"><div class="ttname"><a href="a00127.html#ad08720847b0aef444876b608b7af9a5c">MatMult3</a></div><div class="ttdeci">#define MatMult3(N, A, X, Y)</div><div class="ttdef"><b>Definition:</b> <a href="a00127_source.html#l00074">mathfunctions.h:74</a></div></div>
<div class="ttc" id="a00129_html_a413fd3cab5a06c9d7a38334768d81b0f"><div class="ttname"><a href="a00129.html#a413fd3cab5a06c9d7a38334768d81b0f">_Euler1DLeftEigenvectors_</a></div><div class="ttdeci">#define _Euler1DLeftEigenvectors_(u, L, p, dir)</div><div class="ttdef"><b>Definition:</b> <a href="a00129_source.html#l00223">euler1d.h:223</a></div></div>
<div class="ttc" id="a00127_html_affe776513b24d84b39af8ab0930fef7f"><div class="ttname"><a href="a00127.html#affe776513b24d84b39af8ab0930fef7f">max</a></div><div class="ttdeci">#define max(a, b)</div><div class="ttdef"><b>Definition:</b> <a href="a00127_source.html#l00019">mathfunctions.h:19</a></div></div>
<div class="ttc" id="a00129_html_ad3395a55a5fde64d6603c7a82d7bf2c7"><div class="ttname"><a href="a00129.html#ad3395a55a5fde64d6603c7a82d7bf2c7">_MODEL_NVARS_</a></div><div class="ttdeci">#define _MODEL_NVARS_</div><div class="ttdef"><b>Definition:</b> <a href="a00129_source.html#l00058">euler1d.h:58</a></div></div>
<div class="ttc" id="a00127_html_adf1be5ccbb7a2522b4f3a64043c72880"><div class="ttname"><a href="a00127.html#adf1be5ccbb7a2522b4f3a64043c72880">absolute</a></div><div class="ttdeci">#define absolute(a)</div><div class="ttdef"><b>Definition:</b> <a href="a00127_source.html#l00033">mathfunctions.h:33</a></div></div>
<div class="ttc" id="a00129_html_a115efdce970884e30c6564701f929092"><div class="ttname"><a href="a00129.html#a115efdce970884e30c6564701f929092">_Euler1DEigenvalues_</a></div><div class="ttdeci">#define _Euler1DEigenvalues_(u, D, p, dir)</div><div class="ttdef"><b>Definition:</b> <a href="a00129_source.html#l00205">euler1d.h:205</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a79e3229219a9992f484df9573de95ec3"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int Euler1DStiffJacobian </td>
          <td>(</td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>Jac</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>u</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>p</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>dir</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>upw</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Function to compute the Jacobian of the fast flux (representing the acoustic waves) of the 1D Euler equations, given the solution at a grid point (see <a class="el" href="a00129.html#a5329991de3157d264ef86a1df4ff6bef">_Euler1DSetStiffFlux_</a>, <a class="el" href="a00129.html#a5a41ecdbbb78de026d8541491fb5587f">_Euler1DSetStiffJac_</a>). The Jacobian is square matrix of size nvar=3, and is returned as a 1D array (double) of 9 elements in row-major format. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">Jac</td><td>Jacobian matrix: 1D array of size nvar^2 = 9 </td></tr>
    <tr><td class="paramname">u</td><td>solution at a grid point (array of size nvar = 3) </td></tr>
    <tr><td class="paramname">p</td><td>object containing the physics-related parameters </td></tr>
    <tr><td class="paramname">dir</td><td>dimension (x/y/z) (not used, since this is 1D system) </td></tr>
    <tr><td class="paramname">upw</td><td>0 -&gt; send back complete Jacobian, 1 -&gt; send back Jacobian of right(+)-moving flux, -1 -&gt; send back Jacobian of left(-)-moving flux </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="a00276_source.html#l00048">48</a> of file <a class="el" href="a00276_source.html">Euler1DJacobian.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;{</div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;  <a class="code" href="a00099.html">Euler1D</a>       *param = (<a class="code" href="a00099.html">Euler1D</a>*) p;</div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;  <span class="keyword">static</span> <span class="keywordtype">double</span> R[<a class="code" href="a00129.html#ad3395a55a5fde64d6603c7a82d7bf2c7">_MODEL_NVARS_</a>*<a class="code" href="a00129.html#ad3395a55a5fde64d6603c7a82d7bf2c7">_MODEL_NVARS_</a>], D[<a class="code" href="a00129.html#ad3395a55a5fde64d6603c7a82d7bf2c7">_MODEL_NVARS_</a>*<a class="code" href="a00129.html#ad3395a55a5fde64d6603c7a82d7bf2c7">_MODEL_NVARS_</a>], </div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;                L[<a class="code" href="a00129.html#ad3395a55a5fde64d6603c7a82d7bf2c7">_MODEL_NVARS_</a>*<a class="code" href="a00129.html#ad3395a55a5fde64d6603c7a82d7bf2c7">_MODEL_NVARS_</a>], DL[<a class="code" href="a00129.html#ad3395a55a5fde64d6603c7a82d7bf2c7">_MODEL_NVARS_</a>*<a class="code" href="a00129.html#ad3395a55a5fde64d6603c7a82d7bf2c7">_MODEL_NVARS_</a>];</div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;</div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;  <span class="comment">/* get the eigenvalues and left,right eigenvectors */</span></div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;  <a class="code" href="a00129.html#a115efdce970884e30c6564701f929092">_Euler1DEigenvalues_</a>      (u,D,param,0);</div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;  <a class="code" href="a00129.html#a413fd3cab5a06c9d7a38334768d81b0f">_Euler1DLeftEigenvectors_</a> (u,L,param,0);</div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;  <a class="code" href="a00129.html#a4449638968eca76bb5631bc75b7dced7">_Euler1DRightEigenvectors_</a>(u,R,param,0);</div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;</div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;  <span class="keywordtype">int</span> aupw = <a class="code" href="a00127.html#adf1be5ccbb7a2522b4f3a64043c72880">absolute</a>(upw), k;</div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;  k = 0; D[k] = 0.0; <span class="comment">/* remove the entropy eigenmode */</span></div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;  k = 4; D[k] = <a class="code" href="a00127.html#adf1be5ccbb7a2522b4f3a64043c72880">absolute</a>( (1-aupw)*D[k] + 0.5*aupw*(1+upw)*<a class="code" href="a00127.html#affe776513b24d84b39af8ab0930fef7f">max</a>(0,D[k]) + 0.5*aupw*(1-upw)*<a class="code" href="a00127.html#ac6afabdc09a49a433ee19d8a9486056d">min</a>(0,D[k]) );</div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;  k = 8; D[k] = <a class="code" href="a00127.html#adf1be5ccbb7a2522b4f3a64043c72880">absolute</a>( (1-aupw)*D[k] + 0.5*aupw*(1+upw)*<a class="code" href="a00127.html#affe776513b24d84b39af8ab0930fef7f">max</a>(0,D[k]) + 0.5*aupw*(1-upw)*<a class="code" href="a00127.html#ac6afabdc09a49a433ee19d8a9486056d">min</a>(0,D[k]) );</div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;</div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;  <a class="code" href="a00127.html#ad08720847b0aef444876b608b7af9a5c">MatMult3</a>(3,DL,D,L);</div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;  <a class="code" href="a00127.html#ad08720847b0aef444876b608b7af9a5c">MatMult3</a>(3,Jac,R,DL);</div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;</div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;  <span class="keywordflow">return</span>(0);</div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;}</div>
<div class="ttc" id="a00129_html_a4449638968eca76bb5631bc75b7dced7"><div class="ttname"><a href="a00129.html#a4449638968eca76bb5631bc75b7dced7">_Euler1DRightEigenvectors_</a></div><div class="ttdeci">#define _Euler1DRightEigenvectors_(u, R, p, dir)</div><div class="ttdef"><b>Definition:</b> <a href="a00129_source.html#l00247">euler1d.h:247</a></div></div>
<div class="ttc" id="a00127_html_ac6afabdc09a49a433ee19d8a9486056d"><div class="ttname"><a href="a00127.html#ac6afabdc09a49a433ee19d8a9486056d">min</a></div><div class="ttdeci">#define min(a, b)</div><div class="ttdef"><b>Definition:</b> <a href="a00127_source.html#l00015">mathfunctions.h:15</a></div></div>
<div class="ttc" id="a00099_html"><div class="ttname"><a href="a00099.html">Euler1D</a></div><div class="ttdoc">Structure containing variables and parameters specific to the 1D Euler equations. This structure cont...</div><div class="ttdef"><b>Definition:</b> <a href="a00129_source.html#l00271">euler1d.h:271</a></div></div>
<div class="ttc" id="a00127_html_ad08720847b0aef444876b608b7af9a5c"><div class="ttname"><a href="a00127.html#ad08720847b0aef444876b608b7af9a5c">MatMult3</a></div><div class="ttdeci">#define MatMult3(N, A, X, Y)</div><div class="ttdef"><b>Definition:</b> <a href="a00127_source.html#l00074">mathfunctions.h:74</a></div></div>
<div class="ttc" id="a00129_html_a413fd3cab5a06c9d7a38334768d81b0f"><div class="ttname"><a href="a00129.html#a413fd3cab5a06c9d7a38334768d81b0f">_Euler1DLeftEigenvectors_</a></div><div class="ttdeci">#define _Euler1DLeftEigenvectors_(u, L, p, dir)</div><div class="ttdef"><b>Definition:</b> <a href="a00129_source.html#l00223">euler1d.h:223</a></div></div>
<div class="ttc" id="a00127_html_affe776513b24d84b39af8ab0930fef7f"><div class="ttname"><a href="a00127.html#affe776513b24d84b39af8ab0930fef7f">max</a></div><div class="ttdeci">#define max(a, b)</div><div class="ttdef"><b>Definition:</b> <a href="a00127_source.html#l00019">mathfunctions.h:19</a></div></div>
<div class="ttc" id="a00129_html_ad3395a55a5fde64d6603c7a82d7bf2c7"><div class="ttname"><a href="a00129.html#ad3395a55a5fde64d6603c7a82d7bf2c7">_MODEL_NVARS_</a></div><div class="ttdeci">#define _MODEL_NVARS_</div><div class="ttdef"><b>Definition:</b> <a href="a00129_source.html#l00058">euler1d.h:58</a></div></div>
<div class="ttc" id="a00127_html_adf1be5ccbb7a2522b4f3a64043c72880"><div class="ttname"><a href="a00127.html#adf1be5ccbb7a2522b4f3a64043c72880">absolute</a></div><div class="ttdeci">#define absolute(a)</div><div class="ttdef"><b>Definition:</b> <a href="a00127_source.html#l00033">mathfunctions.h:33</a></div></div>
<div class="ttc" id="a00129_html_a115efdce970884e30c6564701f929092"><div class="ttname"><a href="a00129.html#a115efdce970884e30c6564701f929092">_Euler1DEigenvalues_</a></div><div class="ttdeci">#define _Euler1DEigenvalues_(u, D, p, dir)</div><div class="ttdef"><b>Definition:</b> <a href="a00129_source.html#l00205">euler1d.h:205</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a6dfa80796cd1ce0ba0712c301dd68d2f"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int Euler1DRoeAverage </td>
          <td>(</td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>uavg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>uL</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>uR</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>p</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Compute the Roe-averaged state for the 1D Euler equations. This function just calls the macro <a class="el" href="a00129.html#a9a3e89dcf75e61433735d59b6556c346">_Euler1DRoeAverage_</a> and is not used by any functions within the 1D Euler module. However, it's necessary to define it and provide it to the the solver object (<a class="el" href="a00106.html" title="Structure containing all solver-specific variables and functions. ">HyPar</a>) so that it can then send it to interpolation functions for a characteristic-based reconstruction. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">uavg</td><td>The computed Roe-averaged state </td></tr>
    <tr><td class="paramname">uL</td><td>Left state (conserved variables) </td></tr>
    <tr><td class="paramname">uR</td><td>Right state (conserved variables) </td></tr>
    <tr><td class="paramname">p</td><td>Object of type <a class="el" href="a00099.html" title="Structure containing variables and parameters specific to the 1D Euler equations. This structure cont...">Euler1D</a> with physics-related variables </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="a00273_source.html#l00016">16</a> of file <a class="el" href="a00273_source.html">Euler1DFunctions.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;{</div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;  <a class="code" href="a00099.html">Euler1D</a> *param  = (<a class="code" href="a00099.html">Euler1D</a>*) p;</div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;  <a class="code" href="a00129.html#a9a3e89dcf75e61433735d59b6556c346">_Euler1DRoeAverage_</a>(uavg,uL,uR,param);</div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;  <span class="keywordflow">return</span>(0);</div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;}</div>
<div class="ttc" id="a00129_html_a9a3e89dcf75e61433735d59b6556c346"><div class="ttname"><a href="a00129.html#a9a3e89dcf75e61433735d59b6556c346">_Euler1DRoeAverage_</a></div><div class="ttdeci">#define _Euler1DRoeAverage_(uavg, uL, uR, p)</div><div class="ttdef"><b>Definition:</b> <a href="a00129_source.html#l00167">euler1d.h:167</a></div></div>
<div class="ttc" id="a00099_html"><div class="ttname"><a href="a00099.html">Euler1D</a></div><div class="ttdoc">Structure containing variables and parameters specific to the 1D Euler equations. This structure cont...</div><div class="ttdef"><b>Definition:</b> <a href="a00129_source.html#l00271">euler1d.h:271</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a979f0aa5a88e8c1d32794ccba50bc806"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int Euler1DLeftEigenvectors </td>
          <td>(</td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>u</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>L</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>p</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>dir</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Compute the left eigenvections for the 1D Euler equations. This function just calls the macro <a class="el" href="a00129.html#a413fd3cab5a06c9d7a38334768d81b0f">_Euler1DLeftEigenvectors_</a> and is not used by any functions within the 1D Euler module. However, it's necessary to define it and provide it to the the solver object (<a class="el" href="a00106.html" title="Structure containing all solver-specific variables and functions. ">HyPar</a>) so that it can then send it to interpolation functions for a characteristic-based reconstruction. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">u</td><td>Conserved solution at a grid point </td></tr>
    <tr><td class="paramname">L</td><td>Array of size nvar^2 = 3^2 to save the matrix of left eigenvectors in (row-major format). </td></tr>
    <tr><td class="paramname">p</td><td>Object of type <a class="el" href="a00099.html" title="Structure containing variables and parameters specific to the 1D Euler equations. This structure cont...">Euler1D</a> with physics-related variables </td></tr>
    <tr><td class="paramname">dir</td><td>Spatial dimension (not used, since this is a 1D system) </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="a00271_source.html#l00019">19</a> of file <a class="el" href="a00271_source.html">Euler1DEigen.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;{</div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;  <a class="code" href="a00099.html">Euler1D</a> *param  = (<a class="code" href="a00099.html">Euler1D</a>*)  p;</div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;  <a class="code" href="a00129.html#a413fd3cab5a06c9d7a38334768d81b0f">_Euler1DLeftEigenvectors_</a>(u,L,param,dir);</div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;  <span class="keywordflow">return</span>(0);</div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;}</div>
<div class="ttc" id="a00099_html"><div class="ttname"><a href="a00099.html">Euler1D</a></div><div class="ttdoc">Structure containing variables and parameters specific to the 1D Euler equations. This structure cont...</div><div class="ttdef"><b>Definition:</b> <a href="a00129_source.html#l00271">euler1d.h:271</a></div></div>
<div class="ttc" id="a00129_html_a413fd3cab5a06c9d7a38334768d81b0f"><div class="ttname"><a href="a00129.html#a413fd3cab5a06c9d7a38334768d81b0f">_Euler1DLeftEigenvectors_</a></div><div class="ttdeci">#define _Euler1DLeftEigenvectors_(u, L, p, dir)</div><div class="ttdef"><b>Definition:</b> <a href="a00129_source.html#l00223">euler1d.h:223</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a6139f9478a0791ac0a0c0d43faffb378"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int Euler1DRightEigenvectors </td>
          <td>(</td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>u</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>R</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>p</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>dir</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Compute the right eigenvections for the 1D Euler equations. This function just calls the macro <a class="el" href="a00129.html#a4449638968eca76bb5631bc75b7dced7">_Euler1DRightEigenvectors_</a> and is not used by any functions within the 1D Euler module. However, it's necessary to define it and provide it to the the solver object (<a class="el" href="a00106.html" title="Structure containing all solver-specific variables and functions. ">HyPar</a>) so that it can then send it to interpolation functions for a characteristic-based reconstruction. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">u</td><td>Conserved solution at a grid point </td></tr>
    <tr><td class="paramname">R</td><td>Array of size nvar^2 = 3^2 to save the matrix of right eigenvectors in (row-major format). </td></tr>
    <tr><td class="paramname">p</td><td>Object of type <a class="el" href="a00099.html" title="Structure containing variables and parameters specific to the 1D Euler equations. This structure cont...">Euler1D</a> with physics-related variables </td></tr>
    <tr><td class="paramname">dir</td><td>Spatial dimension (not used, since this is a 1D system) </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="a00271_source.html#l00038">38</a> of file <a class="el" href="a00271_source.html">Euler1DEigen.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;{</div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;  <a class="code" href="a00099.html">Euler1D</a> *param  = (<a class="code" href="a00099.html">Euler1D</a>*)  p;</div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;  <a class="code" href="a00129.html#a4449638968eca76bb5631bc75b7dced7">_Euler1DRightEigenvectors_</a>(u,R,param,dir);</div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;  <span class="keywordflow">return</span>(0);</div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;}</div>
<div class="ttc" id="a00129_html_a4449638968eca76bb5631bc75b7dced7"><div class="ttname"><a href="a00129.html#a4449638968eca76bb5631bc75b7dced7">_Euler1DRightEigenvectors_</a></div><div class="ttdeci">#define _Euler1DRightEigenvectors_(u, R, p, dir)</div><div class="ttdef"><b>Definition:</b> <a href="a00129_source.html#l00247">euler1d.h:247</a></div></div>
<div class="ttc" id="a00099_html"><div class="ttname"><a href="a00099.html">Euler1D</a></div><div class="ttdoc">Structure containing variables and parameters specific to the 1D Euler equations. This structure cont...</div><div class="ttdef"><b>Definition:</b> <a href="a00129_source.html#l00271">euler1d.h:271</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ac2a5ef9ed2d6611286c0ff4e213c735b"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int Euler1DGravityField </td>
          <td>(</td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>s</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>m</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Compute the gravitational field over the domain. See</p><ul>
<li>Xing, Y., Shu, C.-W., "High Order Well-Balanced WENO Scheme
  for the Gas Dynamics Equations Under Gravitational Fields", Journal of Scientific Computing, 54, 2013, pp. 645-662. <a href="http://dx.doi.org/10.1007/s10915-012-9585-8">http://dx.doi.org/10.1007/s10915-012-9585-8</a><br />
for details on the treatment of the gravitational source term. This function computes the graviational potential function. If there is no gravity, the gravitational field is 1.0 all over the domain. </li>
</ul>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">s</td><td>Solver object of type <a class="el" href="a00106.html" title="Structure containing all solver-specific variables and functions. ">HyPar</a> </td></tr>
    <tr><td class="paramname">m</td><td>MPI object of type <a class="el" href="a00108.html#a00444" title="Structure of MPI-related variables. ">MPIVariables</a> </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="a00274_source.html#l00023">23</a> of file <a class="el" href="a00274_source.html">Euler1DGravityField.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;{</div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;  <a class="code" href="a00106.html">HyPar</a>         *solver = (<a class="code" href="a00106.html">HyPar</a>*)        s;</div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;  <a class="code" href="a00108.html#a00444">MPIVariables</a>  *mpi    = (<a class="code" href="a00108.html#a00444">MPIVariables</a>*) m;</div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;  <a class="code" href="a00099.html">Euler1D</a>       *param  = (<a class="code" href="a00099.html">Euler1D</a>*)      solver-&gt;<a class="code" href="a00106.html#a48e81a1806b5774943fd9a26e9a190f2">physics</a>;</div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;</div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;  <span class="keywordtype">double</span>  *S      = param-&gt;<a class="code" href="a00099.html#afb1265dc9bb8f8c05bd22f88c23d879c">grav_field</a>;</div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;  <span class="keywordtype">int</span>     *dim    = solver-&gt;<a class="code" href="a00106.html#a38e0371f331cecbe63a77fa03e202afe">dim_local</a>;</div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;  <span class="keywordtype">int</span>     ghosts  = solver-&gt;<a class="code" href="a00106.html#aafc992b5fa79d5a4036024615d03bce6">ghosts</a>;</div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;  <span class="keywordtype">int</span>     index[<a class="code" href="a00129.html#a57771c952ec174601addf43e1c0202b2">_MODEL_NDIMS_</a>], bounds[_MODEL_NDIMS_],</div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;          offset[_MODEL_NDIMS_], d, done;</div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;</div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;  <span class="comment">/* set bounds for array index to include ghost points */</span></div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;  <a class="code" href="a00121.html#a89e8330d9e06dd0666c50833628a125c">_ArrayCopy1D_</a>(dim,bounds,_MODEL_NDIMS_);</div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;  <span class="keywordflow">for</span> (d=0; d&lt;<a class="code" href="a00129.html#a57771c952ec174601addf43e1c0202b2">_MODEL_NDIMS_</a>; d++) bounds[d] += 2*ghosts;</div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;  <span class="comment">/* set offset such that index is compatible with ghost point arrangement */</span></div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;  <a class="code" href="a00121.html#a2b2826031c0cd92495ab351d3e599fc5">_ArraySetValue_</a>(offset,_MODEL_NDIMS_,-ghosts);</div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;</div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;  <span class="comment">/* set the value of the gravity field */</span></div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;  done = 0; <a class="code" href="a00121.html#a2b2826031c0cd92495ab351d3e599fc5">_ArraySetValue_</a>(index,_MODEL_NDIMS_,0);</div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;  <span class="keywordflow">while</span> (!done) {</div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;    <span class="keywordtype">int</span> p;                <a class="code" href="a00121.html#a0739cb538f4d301fad3b45059ddd0738">_ArrayIndex1DWO_</a>(_MODEL_NDIMS_,dim,index,offset,ghosts,p);</div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;    <span class="keywordtype">double</span> xcoord;        <a class="code" href="a00122.html#a9aa9bad8531d6733731a850ccc471a42">_GetCoordinate_</a>(<a class="code" href="a00129.html#a6a44057228e5f4b86e1c4d04b2a28977">_XDIR_</a>,index[<a class="code" href="a00129.html#a6a44057228e5f4b86e1c4d04b2a28977">_XDIR_</a>]-ghosts,dim,ghosts,solver-&gt;<a class="code" href="a00106.html#a711aad4cbe735871dd9e91ab575c878b">x</a>,xcoord);</div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;    <span class="keywordflow">if</span> (param-&gt;<a class="code" href="a00099.html#a41908af46d7b1181c9177332aa44ead5">grav_type</a> == 0) {</div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;      S[p] = exp(-param-&gt;<a class="code" href="a00099.html#a87f6134534484ec863864096005ac076">grav</a>*xcoord);</div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (param-&gt;<a class="code" href="a00099.html#a41908af46d7b1181c9177332aa44ead5">grav_type</a> == 1) {</div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;      <span class="keywordtype">double</span> pi = 4.0 * atan(1.0);</div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;      <span class="keywordtype">double</span> phi = -sin(2*pi*xcoord)/(2*pi);</div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;      S[p] = exp(-phi);</div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;    }</div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;    <a class="code" href="a00121.html#ac5ec1371623f11d03b0f42adaa24acbc">_ArrayIncrementIndex_</a>(_MODEL_NDIMS_,bounds,index,done);</div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;  }</div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;</div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;  <span class="keywordflow">if</span> (param-&gt;<a class="code" href="a00099.html#a41908af46d7b1181c9177332aa44ead5">grav_type</a> != 1) {</div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;    <span class="comment">/* a sensible simulation will not specify peridic boundary conditions </span></div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;<span class="comment">    * along a direction in which gravity acts (unless the gravitational field</span></div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;<span class="comment">    * itself is sinusoidal), so extrapolate the gravity field at the boundaries */</span></div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;    <span class="keywordtype">int</span> indexb[<a class="code" href="a00129.html#a57771c952ec174601addf43e1c0202b2">_MODEL_NDIMS_</a>], indexi[<a class="code" href="a00129.html#a57771c952ec174601addf43e1c0202b2">_MODEL_NDIMS_</a>];</div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;    <span class="keywordflow">for</span> (d = 0; d &lt; <a class="code" href="a00129.html#a57771c952ec174601addf43e1c0202b2">_MODEL_NDIMS_</a>; d++) {</div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;      <span class="comment">/* left boundary */</span></div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;      <span class="keywordflow">if</span> (!mpi-&gt;<a class="code" href="a00108.html#aa3c28612a64b8a97bde66b720e15c700">ip</a>[d]) {</div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;        <a class="code" href="a00121.html#a89e8330d9e06dd0666c50833628a125c">_ArrayCopy1D_</a>(dim,bounds,_MODEL_NDIMS_); bounds[d] = ghosts;</div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;        <a class="code" href="a00121.html#a2b2826031c0cd92495ab351d3e599fc5">_ArraySetValue_</a>(offset,_MODEL_NDIMS_,0); offset[d] = -ghosts;</div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;        done = 0; <a class="code" href="a00121.html#a2b2826031c0cd92495ab351d3e599fc5">_ArraySetValue_</a>(indexb,_MODEL_NDIMS_,0);</div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;        <span class="keywordflow">while</span> (!done) {</div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;          <a class="code" href="a00121.html#a89e8330d9e06dd0666c50833628a125c">_ArrayCopy1D_</a>(indexb,indexi,_MODEL_NDIMS_); indexi[d] = ghosts-1-indexb[d];</div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;          <span class="keywordtype">int</span> p1; <a class="code" href="a00121.html#a0739cb538f4d301fad3b45059ddd0738">_ArrayIndex1DWO_</a>(_MODEL_NDIMS_,dim,indexb,offset,ghosts,p1);</div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;          <span class="keywordtype">int</span> p2; <a class="code" href="a00121.html#afbb862a2fdf5b72b1f9ace42f64b556f">_ArrayIndex1D_</a>  (_MODEL_NDIMS_,dim,indexi,ghosts,p2);</div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;          S[p1] = S[p2];</div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;          <a class="code" href="a00121.html#ac5ec1371623f11d03b0f42adaa24acbc">_ArrayIncrementIndex_</a>(_MODEL_NDIMS_,bounds,indexb,done);</div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;        }</div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;      }</div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;      <span class="comment">/* right boundary */</span></div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;      <span class="keywordflow">if</span> (mpi-&gt;<a class="code" href="a00108.html#aa3c28612a64b8a97bde66b720e15c700">ip</a>[d] == mpi-&gt;<a class="code" href="a00108.html#a0be0f30a83bc3f3d9f6ee3a36bbf2716">iproc</a>[d]-1) {</div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;        <a class="code" href="a00121.html#a89e8330d9e06dd0666c50833628a125c">_ArrayCopy1D_</a>(dim,bounds,_MODEL_NDIMS_); bounds[d] = ghosts;</div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;        <a class="code" href="a00121.html#a2b2826031c0cd92495ab351d3e599fc5">_ArraySetValue_</a>(offset,_MODEL_NDIMS_,0); offset[d] = dim[d];</div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;        done = 0; <a class="code" href="a00121.html#a2b2826031c0cd92495ab351d3e599fc5">_ArraySetValue_</a>(indexb,_MODEL_NDIMS_,0);</div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;        <span class="keywordflow">while</span> (!done) {</div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;          <a class="code" href="a00121.html#a89e8330d9e06dd0666c50833628a125c">_ArrayCopy1D_</a>(indexb,indexi,_MODEL_NDIMS_); indexi[d] = dim[d]-1-indexb[d];</div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;          <span class="keywordtype">int</span> p1; <a class="code" href="a00121.html#a0739cb538f4d301fad3b45059ddd0738">_ArrayIndex1DWO_</a>(_MODEL_NDIMS_,dim,indexb,offset,ghosts,p1);</div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;          <span class="keywordtype">int</span> p2; <a class="code" href="a00121.html#afbb862a2fdf5b72b1f9ace42f64b556f">_ArrayIndex1D_</a>  (_MODEL_NDIMS_,dim,indexi,ghosts,p2);</div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;          S[p1] = S[p2];</div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;          <a class="code" href="a00121.html#ac5ec1371623f11d03b0f42adaa24acbc">_ArrayIncrementIndex_</a>(_MODEL_NDIMS_,bounds,indexb,done);</div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;        }</div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;      }</div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;    }</div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;  }</div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;</div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;  <span class="keywordflow">return</span>(0);</div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;}</div>
<div class="ttc" id="a00099_html_a87f6134534484ec863864096005ac076"><div class="ttname"><a href="a00099.html#a87f6134534484ec863864096005ac076">Euler1D::grav</a></div><div class="ttdeci">double grav</div><div class="ttdef"><b>Definition:</b> <a href="a00129_source.html#l00273">euler1d.h:273</a></div></div>
<div class="ttc" id="a00108_html_a00444"><div class="ttname"><a href="a00108.html#a00444">MPIVariables</a></div><div class="ttdoc">Structure of MPI-related variables. </div><div class="ttdef"><b>Definition:</b> <a href="a00108_source.html#l00021">mpivars.h:21</a></div></div>
<div class="ttc" id="a00129_html_a6a44057228e5f4b86e1c4d04b2a28977"><div class="ttname"><a href="a00129.html#a6a44057228e5f4b86e1c4d04b2a28977">_XDIR_</a></div><div class="ttdeci">#define _XDIR_</div><div class="ttdef"><b>Definition:</b> <a href="a00129_source.html#l00073">euler1d.h:73</a></div></div>
<div class="ttc" id="a00121_html_ac5ec1371623f11d03b0f42adaa24acbc"><div class="ttname"><a href="a00121.html#ac5ec1371623f11d03b0f42adaa24acbc">_ArrayIncrementIndex_</a></div><div class="ttdeci">#define _ArrayIncrementIndex_(N, imax, i, done)</div><div class="ttdef"><b>Definition:</b> <a href="a00121_source.html#l00122">arrayfunctions.h:122</a></div></div>
<div class="ttc" id="a00121_html_a89e8330d9e06dd0666c50833628a125c"><div class="ttname"><a href="a00121.html#a89e8330d9e06dd0666c50833628a125c">_ArrayCopy1D_</a></div><div class="ttdeci">#define _ArrayCopy1D_(x, y, size)</div><div class="ttdef"><b>Definition:</b> <a href="a00121_source.html#l00281">arrayfunctions.h:281</a></div></div>
<div class="ttc" id="a00106_html_a711aad4cbe735871dd9e91ab575c878b"><div class="ttname"><a href="a00106.html#a711aad4cbe735871dd9e91ab575c878b">HyPar::x</a></div><div class="ttdeci">double * x</div><div class="ttdef"><b>Definition:</b> <a href="a00125_source.html#l00082">hypar.h:82</a></div></div>
<div class="ttc" id="a00121_html_afbb862a2fdf5b72b1f9ace42f64b556f"><div class="ttname"><a href="a00121.html#afbb862a2fdf5b72b1f9ace42f64b556f">_ArrayIndex1D_</a></div><div class="ttdeci">#define _ArrayIndex1D_(N, imax, i, ghost, index)</div><div class="ttdef"><b>Definition:</b> <a href="a00121_source.html#l00036">arrayfunctions.h:36</a></div></div>
<div class="ttc" id="a00099_html"><div class="ttname"><a href="a00099.html">Euler1D</a></div><div class="ttdoc">Structure containing variables and parameters specific to the 1D Euler equations. This structure cont...</div><div class="ttdef"><b>Definition:</b> <a href="a00129_source.html#l00271">euler1d.h:271</a></div></div>
<div class="ttc" id="a00106_html"><div class="ttname"><a href="a00106.html">HyPar</a></div><div class="ttdoc">Structure containing all solver-specific variables and functions. </div><div class="ttdef"><b>Definition:</b> <a href="a00125_source.html#l00020">hypar.h:20</a></div></div>
<div class="ttc" id="a00121_html_a0739cb538f4d301fad3b45059ddd0738"><div class="ttname"><a href="a00121.html#a0739cb538f4d301fad3b45059ddd0738">_ArrayIndex1DWO_</a></div><div class="ttdeci">#define _ArrayIndex1DWO_(N, imax, i, offset, ghost, index)</div><div class="ttdef"><b>Definition:</b> <a href="a00121_source.html#l00079">arrayfunctions.h:79</a></div></div>
<div class="ttc" id="a00106_html_a48e81a1806b5774943fd9a26e9a190f2"><div class="ttname"><a href="a00106.html#a48e81a1806b5774943fd9a26e9a190f2">HyPar::physics</a></div><div class="ttdeci">void * physics</div><div class="ttdef"><b>Definition:</b> <a href="a00125_source.html#l00231">hypar.h:231</a></div></div>
<div class="ttc" id="a00099_html_a41908af46d7b1181c9177332aa44ead5"><div class="ttname"><a href="a00099.html#a41908af46d7b1181c9177332aa44ead5">Euler1D::grav_type</a></div><div class="ttdeci">int grav_type</div><div class="ttdef"><b>Definition:</b> <a href="a00129_source.html#l00284">euler1d.h:284</a></div></div>
<div class="ttc" id="a00129_html_a57771c952ec174601addf43e1c0202b2"><div class="ttname"><a href="a00129.html#a57771c952ec174601addf43e1c0202b2">_MODEL_NDIMS_</a></div><div class="ttdeci">#define _MODEL_NDIMS_</div><div class="ttdef"><b>Definition:</b> <a href="a00129_source.html#l00056">euler1d.h:56</a></div></div>
<div class="ttc" id="a00108_html_aa3c28612a64b8a97bde66b720e15c700"><div class="ttname"><a href="a00108.html#aa3c28612a64b8a97bde66b720e15c700">MPIVariables::ip</a></div><div class="ttdeci">int * ip</div><div class="ttdef"><b>Definition:</b> <a href="a00108_source.html#l00025">mpivars.h:25</a></div></div>
<div class="ttc" id="a00121_html_a2b2826031c0cd92495ab351d3e599fc5"><div class="ttname"><a href="a00121.html#a2b2826031c0cd92495ab351d3e599fc5">_ArraySetValue_</a></div><div class="ttdeci">#define _ArraySetValue_(x, size, value)</div><div class="ttdef"><b>Definition:</b> <a href="a00121_source.html#l00142">arrayfunctions.h:142</a></div></div>
<div class="ttc" id="a00106_html_aafc992b5fa79d5a4036024615d03bce6"><div class="ttname"><a href="a00106.html#aafc992b5fa79d5a4036024615d03bce6">HyPar::ghosts</a></div><div class="ttdeci">int ghosts</div><div class="ttdef"><b>Definition:</b> <a href="a00125_source.html#l00041">hypar.h:41</a></div></div>
<div class="ttc" id="a00099_html_afb1265dc9bb8f8c05bd22f88c23d879c"><div class="ttname"><a href="a00099.html#afb1265dc9bb8f8c05bd22f88c23d879c">Euler1D::grav_field</a></div><div class="ttdeci">double * grav_field</div><div class="ttdef"><b>Definition:</b> <a href="a00129_source.html#l00286">euler1d.h:286</a></div></div>
<div class="ttc" id="a00122_html_a9aa9bad8531d6733731a850ccc471a42"><div class="ttname"><a href="a00122.html#a9aa9bad8531d6733731a850ccc471a42">_GetCoordinate_</a></div><div class="ttdeci">#define _GetCoordinate_(dir, i, dim, ghosts, x, coord)</div><div class="ttdef"><b>Definition:</b> <a href="a00122_source.html#l00024">basic.h:24</a></div></div>
<div class="ttc" id="a00108_html_a0be0f30a83bc3f3d9f6ee3a36bbf2716"><div class="ttname"><a href="a00108.html#a0be0f30a83bc3f3d9f6ee3a36bbf2716">MPIVariables::iproc</a></div><div class="ttdeci">int * iproc</div><div class="ttdef"><b>Definition:</b> <a href="a00108_source.html#l00024">mpivars.h:24</a></div></div>
<div class="ttc" id="a00106_html_a38e0371f331cecbe63a77fa03e202afe"><div class="ttname"><a href="a00106.html#a38e0371f331cecbe63a77fa03e202afe">HyPar::dim_local</a></div><div class="ttdeci">int * dim_local</div><div class="ttdef"><b>Definition:</b> <a href="a00125_source.html#l00032">hypar.h:32</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a9626db6c422f313b9762b0223f1a52da"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int Euler1DSourceUpwindLLF </td>
          <td>(</td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>fI</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>fL</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>fR</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>u</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>dir</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>s</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>t</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Compute the "upwind" source term in the balanced formulation introduced in the reference below. The "upwind" state is just the arithmetic average of the left and right states.</p><ul>
<li>Xing, Shu, "High Order Well-Balanced WENO Scheme for the Gas Dynamics Equations 
              Under Gravitational Fields", J. Sci. Comput., 54, 2013, pp. 645&ndash;662, <a href="http://dx.doi.org/10.1007/s10915-012-9585-8">http://dx.doi.org/10.1007/s10915-012-9585-8</a>. </li>
</ul>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">fI</td><td>Computed interface source term ("upwinded") </td></tr>
    <tr><td class="paramname">fL</td><td>Left-biased interface source term </td></tr>
    <tr><td class="paramname">fR</td><td>Right-biased interface source term </td></tr>
    <tr><td class="paramname">u</td><td>Solution (conserved variables) </td></tr>
    <tr><td class="paramname">dir</td><td>Spatial dimension (unused since this is a 1D case) </td></tr>
    <tr><td class="paramname">s</td><td>Solver object of type <a class="el" href="a00106.html" title="Structure containing all solver-specific variables and functions. ">HyPar</a> </td></tr>
    <tr><td class="paramname">t</td><td>Current solution time </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="a00280_source.html#l00021">21</a> of file <a class="el" href="a00280_source.html">Euler1DSourceUpwind.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;{</div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;  <a class="code" href="a00106.html">HyPar</a>     *solver = (<a class="code" href="a00106.html">HyPar</a>*)    s;</div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;  <span class="keywordtype">int</span>       done,k;</div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;  <a class="code" href="a00122.html#a68f50121fb9a7daeaf60e50cdef82ef3">_DECLARE_IERR_</a>;</div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;</div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;  <span class="keywordtype">int</span> ndims = solver-&gt;<a class="code" href="a00106.html#a484873c74138512e41bc50d17b7d955a">ndims</a>;</div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;  <span class="keywordtype">int</span> *dim  = solver-&gt;<a class="code" href="a00106.html#a38e0371f331cecbe63a77fa03e202afe">dim_local</a>;</div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;</div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;  <span class="keywordtype">int</span> index_outer[ndims], index_inter[ndims], bounds_outer[ndims], bounds_inter[ndims];</div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;  <a class="code" href="a00121.html#a89e8330d9e06dd0666c50833628a125c">_ArrayCopy1D_</a>(dim,bounds_outer,ndims); bounds_outer[dir] =  1;</div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;  <a class="code" href="a00121.html#a89e8330d9e06dd0666c50833628a125c">_ArrayCopy1D_</a>(dim,bounds_inter,ndims); bounds_inter[dir] += 1;</div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;</div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;  done = 0; <a class="code" href="a00121.html#a2b2826031c0cd92495ab351d3e599fc5">_ArraySetValue_</a>(index_outer,ndims,0);</div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;  <span class="keywordflow">while</span> (!done) {</div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;    <a class="code" href="a00121.html#a89e8330d9e06dd0666c50833628a125c">_ArrayCopy1D_</a>(index_outer,index_inter,ndims);</div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;    <span class="keywordflow">for</span> (index_inter[dir] = 0; index_inter[dir] &lt; bounds_inter[dir]; index_inter[dir]++) {</div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;      <span class="keywordtype">int</span> p;  <a class="code" href="a00121.html#afbb862a2fdf5b72b1f9ace42f64b556f">_ArrayIndex1D_</a>(ndims,bounds_inter,index_inter,0,p);</div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;      <span class="comment">/* Local Lax-Friedrich upwinding scheme */</span></div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;      <span class="keywordflow">for</span> (k = 0; k &lt; <a class="code" href="a00129.html#ad3395a55a5fde64d6603c7a82d7bf2c7">_MODEL_NVARS_</a>; k++) </div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;        (fI+_MODEL_NVARS_*p)[k] = 0.5 * ((fL+_MODEL_NVARS_*p)[k] + (fR+_MODEL_NVARS_*p)[k]);</div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;    }</div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;    <a class="code" href="a00121.html#ac5ec1371623f11d03b0f42adaa24acbc">_ArrayIncrementIndex_</a>(ndims,bounds_outer,index_outer,done);</div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;  }</div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;</div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;  <span class="keywordflow">return</span>(0);</div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;}</div>
<div class="ttc" id="a00122_html_a68f50121fb9a7daeaf60e50cdef82ef3"><div class="ttname"><a href="a00122.html#a68f50121fb9a7daeaf60e50cdef82ef3">_DECLARE_IERR_</a></div><div class="ttdeci">#define _DECLARE_IERR_</div><div class="ttdef"><b>Definition:</b> <a href="a00122_source.html#l00010">basic.h:10</a></div></div>
<div class="ttc" id="a00106_html_a484873c74138512e41bc50d17b7d955a"><div class="ttname"><a href="a00106.html#a484873c74138512e41bc50d17b7d955a">HyPar::ndims</a></div><div class="ttdeci">int ndims</div><div class="ttdef"><b>Definition:</b> <a href="a00125_source.html#l00023">hypar.h:23</a></div></div>
<div class="ttc" id="a00121_html_ac5ec1371623f11d03b0f42adaa24acbc"><div class="ttname"><a href="a00121.html#ac5ec1371623f11d03b0f42adaa24acbc">_ArrayIncrementIndex_</a></div><div class="ttdeci">#define _ArrayIncrementIndex_(N, imax, i, done)</div><div class="ttdef"><b>Definition:</b> <a href="a00121_source.html#l00122">arrayfunctions.h:122</a></div></div>
<div class="ttc" id="a00121_html_a89e8330d9e06dd0666c50833628a125c"><div class="ttname"><a href="a00121.html#a89e8330d9e06dd0666c50833628a125c">_ArrayCopy1D_</a></div><div class="ttdeci">#define _ArrayCopy1D_(x, y, size)</div><div class="ttdef"><b>Definition:</b> <a href="a00121_source.html#l00281">arrayfunctions.h:281</a></div></div>
<div class="ttc" id="a00121_html_afbb862a2fdf5b72b1f9ace42f64b556f"><div class="ttname"><a href="a00121.html#afbb862a2fdf5b72b1f9ace42f64b556f">_ArrayIndex1D_</a></div><div class="ttdeci">#define _ArrayIndex1D_(N, imax, i, ghost, index)</div><div class="ttdef"><b>Definition:</b> <a href="a00121_source.html#l00036">arrayfunctions.h:36</a></div></div>
<div class="ttc" id="a00106_html"><div class="ttname"><a href="a00106.html">HyPar</a></div><div class="ttdoc">Structure containing all solver-specific variables and functions. </div><div class="ttdef"><b>Definition:</b> <a href="a00125_source.html#l00020">hypar.h:20</a></div></div>
<div class="ttc" id="a00121_html_a2b2826031c0cd92495ab351d3e599fc5"><div class="ttname"><a href="a00121.html#a2b2826031c0cd92495ab351d3e599fc5">_ArraySetValue_</a></div><div class="ttdeci">#define _ArraySetValue_(x, size, value)</div><div class="ttdef"><b>Definition:</b> <a href="a00121_source.html#l00142">arrayfunctions.h:142</a></div></div>
<div class="ttc" id="a00129_html_ad3395a55a5fde64d6603c7a82d7bf2c7"><div class="ttname"><a href="a00129.html#ad3395a55a5fde64d6603c7a82d7bf2c7">_MODEL_NVARS_</a></div><div class="ttdeci">#define _MODEL_NVARS_</div><div class="ttdef"><b>Definition:</b> <a href="a00129_source.html#l00058">euler1d.h:58</a></div></div>
<div class="ttc" id="a00106_html_a38e0371f331cecbe63a77fa03e202afe"><div class="ttname"><a href="a00106.html#a38e0371f331cecbe63a77fa03e202afe">HyPar::dim_local</a></div><div class="ttdeci">int * dim_local</div><div class="ttdef"><b>Definition:</b> <a href="a00125_source.html#l00032">hypar.h:32</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a564a6dcdf1979d59610503201e6f2619"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int Euler1DSourceUpwindRoe </td>
          <td>(</td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>fI</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>fL</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>fR</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>u</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>dir</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>s</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>t</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Compute the "upwind" source term in the balanced formulation introduced in the reference below. The "upwind" state is just the arithmetic average of the left and right states.</p><ul>
<li>Xing, Shu, "High Order Well-Balanced WENO Scheme for the Gas Dynamics Equations 
              Under Gravitational Fields", J. Sci. Comput., 54, 2013, pp. 645&ndash;662, <a href="http://dx.doi.org/10.1007/s10915-012-9585-8">http://dx.doi.org/10.1007/s10915-012-9585-8</a>. </li>
</ul>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">fI</td><td>Computed interface source term ("upwinded") </td></tr>
    <tr><td class="paramname">fL</td><td>Left-biased interface source term </td></tr>
    <tr><td class="paramname">fR</td><td>Right-biased interface source term </td></tr>
    <tr><td class="paramname">u</td><td>Solution (conserved variables) </td></tr>
    <tr><td class="paramname">dir</td><td>Spatial dimension (unused since this is a 1D case) </td></tr>
    <tr><td class="paramname">s</td><td>Solver object of type <a class="el" href="a00106.html" title="Structure containing all solver-specific variables and functions. ">HyPar</a> </td></tr>
    <tr><td class="paramname">t</td><td>Current solution time </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="a00280_source.html#l00064">64</a> of file <a class="el" href="a00280_source.html">Euler1DSourceUpwind.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;{</div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;  <a class="code" href="a00106.html">HyPar</a>     *solver = (<a class="code" href="a00106.html">HyPar</a>*)    s;</div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;  <span class="keywordtype">int</span>       done,k;</div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;  <a class="code" href="a00122.html#a68f50121fb9a7daeaf60e50cdef82ef3">_DECLARE_IERR_</a>;</div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;</div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;  <span class="keywordtype">int</span> ndims = solver-&gt;<a class="code" href="a00106.html#a484873c74138512e41bc50d17b7d955a">ndims</a>;</div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;  <span class="keywordtype">int</span> *dim  = solver-&gt;<a class="code" href="a00106.html#a38e0371f331cecbe63a77fa03e202afe">dim_local</a>;</div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;</div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;  <span class="keywordtype">int</span> index_outer[ndims], index_inter[ndims], bounds_outer[ndims], bounds_inter[ndims];</div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;  <a class="code" href="a00121.html#a89e8330d9e06dd0666c50833628a125c">_ArrayCopy1D_</a>(dim,bounds_outer,ndims); bounds_outer[dir] =  1;</div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;  <a class="code" href="a00121.html#a89e8330d9e06dd0666c50833628a125c">_ArrayCopy1D_</a>(dim,bounds_inter,ndims); bounds_inter[dir] += 1;</div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;</div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;  done = 0; <a class="code" href="a00121.html#a2b2826031c0cd92495ab351d3e599fc5">_ArraySetValue_</a>(index_outer,ndims,0);</div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;  <span class="keywordflow">while</span> (!done) {</div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;    <a class="code" href="a00121.html#a89e8330d9e06dd0666c50833628a125c">_ArrayCopy1D_</a>(index_outer,index_inter,ndims);</div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;    <span class="keywordflow">for</span> (index_inter[dir] = 0; index_inter[dir] &lt; bounds_inter[dir]; index_inter[dir]++) {</div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;      <span class="keywordtype">int</span> p;  <a class="code" href="a00121.html#afbb862a2fdf5b72b1f9ace42f64b556f">_ArrayIndex1D_</a>(ndims,bounds_inter,index_inter,0,p);</div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;      <span class="comment">/* Local Lax-Friedrich upwinding scheme */</span></div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;      <span class="keywordflow">for</span> (k = 0; k &lt; <a class="code" href="a00129.html#ad3395a55a5fde64d6603c7a82d7bf2c7">_MODEL_NVARS_</a>; k++) </div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;        (fI+_MODEL_NVARS_*p)[k] = 0.5 * ((fL+_MODEL_NVARS_*p)[k] + (fR+_MODEL_NVARS_*p)[k]);</div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;    }</div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;    <a class="code" href="a00121.html#ac5ec1371623f11d03b0f42adaa24acbc">_ArrayIncrementIndex_</a>(ndims,bounds_outer,index_outer,done);</div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;  }</div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;</div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;  <span class="keywordflow">return</span>(0);</div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;}</div>
<div class="ttc" id="a00122_html_a68f50121fb9a7daeaf60e50cdef82ef3"><div class="ttname"><a href="a00122.html#a68f50121fb9a7daeaf60e50cdef82ef3">_DECLARE_IERR_</a></div><div class="ttdeci">#define _DECLARE_IERR_</div><div class="ttdef"><b>Definition:</b> <a href="a00122_source.html#l00010">basic.h:10</a></div></div>
<div class="ttc" id="a00106_html_a484873c74138512e41bc50d17b7d955a"><div class="ttname"><a href="a00106.html#a484873c74138512e41bc50d17b7d955a">HyPar::ndims</a></div><div class="ttdeci">int ndims</div><div class="ttdef"><b>Definition:</b> <a href="a00125_source.html#l00023">hypar.h:23</a></div></div>
<div class="ttc" id="a00121_html_ac5ec1371623f11d03b0f42adaa24acbc"><div class="ttname"><a href="a00121.html#ac5ec1371623f11d03b0f42adaa24acbc">_ArrayIncrementIndex_</a></div><div class="ttdeci">#define _ArrayIncrementIndex_(N, imax, i, done)</div><div class="ttdef"><b>Definition:</b> <a href="a00121_source.html#l00122">arrayfunctions.h:122</a></div></div>
<div class="ttc" id="a00121_html_a89e8330d9e06dd0666c50833628a125c"><div class="ttname"><a href="a00121.html#a89e8330d9e06dd0666c50833628a125c">_ArrayCopy1D_</a></div><div class="ttdeci">#define _ArrayCopy1D_(x, y, size)</div><div class="ttdef"><b>Definition:</b> <a href="a00121_source.html#l00281">arrayfunctions.h:281</a></div></div>
<div class="ttc" id="a00121_html_afbb862a2fdf5b72b1f9ace42f64b556f"><div class="ttname"><a href="a00121.html#afbb862a2fdf5b72b1f9ace42f64b556f">_ArrayIndex1D_</a></div><div class="ttdeci">#define _ArrayIndex1D_(N, imax, i, ghost, index)</div><div class="ttdef"><b>Definition:</b> <a href="a00121_source.html#l00036">arrayfunctions.h:36</a></div></div>
<div class="ttc" id="a00106_html"><div class="ttname"><a href="a00106.html">HyPar</a></div><div class="ttdoc">Structure containing all solver-specific variables and functions. </div><div class="ttdef"><b>Definition:</b> <a href="a00125_source.html#l00020">hypar.h:20</a></div></div>
<div class="ttc" id="a00121_html_a2b2826031c0cd92495ab351d3e599fc5"><div class="ttname"><a href="a00121.html#a2b2826031c0cd92495ab351d3e599fc5">_ArraySetValue_</a></div><div class="ttdeci">#define _ArraySetValue_(x, size, value)</div><div class="ttdef"><b>Definition:</b> <a href="a00121_source.html#l00142">arrayfunctions.h:142</a></div></div>
<div class="ttc" id="a00129_html_ad3395a55a5fde64d6603c7a82d7bf2c7"><div class="ttname"><a href="a00129.html#ad3395a55a5fde64d6603c7a82d7bf2c7">_MODEL_NVARS_</a></div><div class="ttdeci">#define _MODEL_NVARS_</div><div class="ttdef"><b>Definition:</b> <a href="a00129_source.html#l00058">euler1d.h:58</a></div></div>
<div class="ttc" id="a00106_html_a38e0371f331cecbe63a77fa03e202afe"><div class="ttname"><a href="a00106.html#a38e0371f331cecbe63a77fa03e202afe">HyPar::dim_local</a></div><div class="ttdeci">int * dim_local</div><div class="ttdef"><b>Definition:</b> <a href="a00125_source.html#l00032">hypar.h:32</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ae1858c7bcd504b88e0140b21e41c35bf"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int Euler1DModifiedSolution </td>
          <td>(</td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>uC</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>u</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>d</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>s</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>m</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>waqt</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Compute the modified solution for the upwinding step in a balanced conservative finite-difference algorithm for the 1D Euler equations with gravitational sources. If no gravitational forces exist, the modified solution is identical to the solution. <br />
<br />
Refer to</p><ul>
<li>Xing, Y., Shu, C.-W., "High Order Well-Balanced WENO Scheme 
  for the Gas Dynamics Equations Under Gravitational Fields", Journal of Scientific Computing, 54, 2013, pp. 645-662, <a href="http://dx.doi.org/10.1007/s10915-012-9585-8">http://dx.doi.org/10.1007/s10915-012-9585-8</a>. See Eq. (3.8) on Page 651 on why this modification is needed. </li>
</ul>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">uC</td><td>The modified solution (same array size and layout as u) </td></tr>
    <tr><td class="paramname">u</td><td>The solution (conserved variables) </td></tr>
    <tr><td class="paramname">d</td><td>Spatial dimension (unused since this is a 1D system) </td></tr>
    <tr><td class="paramname">s</td><td>Solver object of type <a class="el" href="a00106.html" title="Structure containing all solver-specific variables and functions. ">HyPar</a> </td></tr>
    <tr><td class="paramname">m</td><td>MPI object of type <a class="el" href="a00108.html#a00444" title="Structure of MPI-related variables. ">MPIVariables</a> </td></tr>
    <tr><td class="paramname">waqt</td><td>Current solution time </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="a00277_source.html#l00023">23</a> of file <a class="el" href="a00277_source.html">Euler1DModifiedSolution.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;{</div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;  <a class="code" href="a00106.html">HyPar</a>         *solver = (<a class="code" href="a00106.html">HyPar</a>*)         s;</div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;  <a class="code" href="a00099.html">Euler1D</a>       *param  = (<a class="code" href="a00099.html">Euler1D</a>*)       solver-&gt;<a class="code" href="a00106.html#a48e81a1806b5774943fd9a26e9a190f2">physics</a>;</div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;</div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;  <span class="keywordtype">int</span>     ghosts  = solver-&gt;<a class="code" href="a00106.html#aafc992b5fa79d5a4036024615d03bce6">ghosts</a>;</div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;  <span class="keywordtype">int</span>     *dim    = solver-&gt;<a class="code" href="a00106.html#a38e0371f331cecbe63a77fa03e202afe">dim_local</a>;</div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;  <span class="keywordtype">int</span>     ndims   = solver-&gt;<a class="code" href="a00106.html#a484873c74138512e41bc50d17b7d955a">ndims</a>;</div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;  <span class="keywordtype">int</span>     index[ndims], bounds[ndims], offset[ndims];</div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;</div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;  <span class="comment">/* set bounds for array index to include ghost points */</span></div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;  <a class="code" href="a00121.html#a89e8330d9e06dd0666c50833628a125c">_ArrayCopy1D_</a>(dim,bounds,ndims);</div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;  <span class="keywordtype">int</span> i; <span class="keywordflow">for</span> (i=0; i&lt;ndims; i++) bounds[i] += 2*ghosts;</div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;</div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;  <span class="comment">/* set offset such that index is compatible with ghost point arrangement */</span></div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;  <a class="code" href="a00121.html#a2b2826031c0cd92495ab351d3e599fc5">_ArraySetValue_</a>(offset,ndims,-ghosts);</div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;</div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;  <span class="keywordtype">int</span> done = 0; <a class="code" href="a00121.html#a2b2826031c0cd92495ab351d3e599fc5">_ArraySetValue_</a>(index,ndims,0);</div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;  <span class="keywordflow">while</span> (!done) {</div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;    <span class="keywordtype">int</span> p; <a class="code" href="a00121.html#a0739cb538f4d301fad3b45059ddd0738">_ArrayIndex1DWO_</a>(ndims,dim,index,offset,ghosts,p); p *= <a class="code" href="a00129.html#ad3395a55a5fde64d6603c7a82d7bf2c7">_MODEL_NVARS_</a>;</div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;    <a class="code" href="a00121.html#a7d97d4914726fa7cca339356dae28473">_ArrayScaleCopy1D_</a>((u+p),(1.0/param-&gt;<a class="code" href="a00099.html#afb1265dc9bb8f8c05bd22f88c23d879c">grav_field</a>[p/<a class="code" href="a00129.html#ad3395a55a5fde64d6603c7a82d7bf2c7">_MODEL_NVARS_</a>]),(uC+p),<a class="code" href="a00129.html#ad3395a55a5fde64d6603c7a82d7bf2c7">_MODEL_NVARS_</a>);</div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;    <a class="code" href="a00121.html#ac5ec1371623f11d03b0f42adaa24acbc">_ArrayIncrementIndex_</a>(ndims,bounds,index,done);</div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;  }</div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;  <span class="keywordflow">return</span>(0);</div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;}</div>
<div class="ttc" id="a00106_html_a484873c74138512e41bc50d17b7d955a"><div class="ttname"><a href="a00106.html#a484873c74138512e41bc50d17b7d955a">HyPar::ndims</a></div><div class="ttdeci">int ndims</div><div class="ttdef"><b>Definition:</b> <a href="a00125_source.html#l00023">hypar.h:23</a></div></div>
<div class="ttc" id="a00121_html_ac5ec1371623f11d03b0f42adaa24acbc"><div class="ttname"><a href="a00121.html#ac5ec1371623f11d03b0f42adaa24acbc">_ArrayIncrementIndex_</a></div><div class="ttdeci">#define _ArrayIncrementIndex_(N, imax, i, done)</div><div class="ttdef"><b>Definition:</b> <a href="a00121_source.html#l00122">arrayfunctions.h:122</a></div></div>
<div class="ttc" id="a00121_html_a89e8330d9e06dd0666c50833628a125c"><div class="ttname"><a href="a00121.html#a89e8330d9e06dd0666c50833628a125c">_ArrayCopy1D_</a></div><div class="ttdeci">#define _ArrayCopy1D_(x, y, size)</div><div class="ttdef"><b>Definition:</b> <a href="a00121_source.html#l00281">arrayfunctions.h:281</a></div></div>
<div class="ttc" id="a00099_html"><div class="ttname"><a href="a00099.html">Euler1D</a></div><div class="ttdoc">Structure containing variables and parameters specific to the 1D Euler equations. This structure cont...</div><div class="ttdef"><b>Definition:</b> <a href="a00129_source.html#l00271">euler1d.h:271</a></div></div>
<div class="ttc" id="a00106_html"><div class="ttname"><a href="a00106.html">HyPar</a></div><div class="ttdoc">Structure containing all solver-specific variables and functions. </div><div class="ttdef"><b>Definition:</b> <a href="a00125_source.html#l00020">hypar.h:20</a></div></div>
<div class="ttc" id="a00121_html_a0739cb538f4d301fad3b45059ddd0738"><div class="ttname"><a href="a00121.html#a0739cb538f4d301fad3b45059ddd0738">_ArrayIndex1DWO_</a></div><div class="ttdeci">#define _ArrayIndex1DWO_(N, imax, i, offset, ghost, index)</div><div class="ttdef"><b>Definition:</b> <a href="a00121_source.html#l00079">arrayfunctions.h:79</a></div></div>
<div class="ttc" id="a00106_html_a48e81a1806b5774943fd9a26e9a190f2"><div class="ttname"><a href="a00106.html#a48e81a1806b5774943fd9a26e9a190f2">HyPar::physics</a></div><div class="ttdeci">void * physics</div><div class="ttdef"><b>Definition:</b> <a href="a00125_source.html#l00231">hypar.h:231</a></div></div>
<div class="ttc" id="a00121_html_a2b2826031c0cd92495ab351d3e599fc5"><div class="ttname"><a href="a00121.html#a2b2826031c0cd92495ab351d3e599fc5">_ArraySetValue_</a></div><div class="ttdeci">#define _ArraySetValue_(x, size, value)</div><div class="ttdef"><b>Definition:</b> <a href="a00121_source.html#l00142">arrayfunctions.h:142</a></div></div>
<div class="ttc" id="a00106_html_aafc992b5fa79d5a4036024615d03bce6"><div class="ttname"><a href="a00106.html#aafc992b5fa79d5a4036024615d03bce6">HyPar::ghosts</a></div><div class="ttdeci">int ghosts</div><div class="ttdef"><b>Definition:</b> <a href="a00125_source.html#l00041">hypar.h:41</a></div></div>
<div class="ttc" id="a00099_html_afb1265dc9bb8f8c05bd22f88c23d879c"><div class="ttname"><a href="a00099.html#afb1265dc9bb8f8c05bd22f88c23d879c">Euler1D::grav_field</a></div><div class="ttdeci">double * grav_field</div><div class="ttdef"><b>Definition:</b> <a href="a00129_source.html#l00286">euler1d.h:286</a></div></div>
<div class="ttc" id="a00121_html_a7d97d4914726fa7cca339356dae28473"><div class="ttname"><a href="a00121.html#a7d97d4914726fa7cca339356dae28473">_ArrayScaleCopy1D_</a></div><div class="ttdeci">#define _ArrayScaleCopy1D_(x, a, y, size)</div><div class="ttdef"><b>Definition:</b> <a href="a00121_source.html#l00318">arrayfunctions.h:318</a></div></div>
<div class="ttc" id="a00129_html_ad3395a55a5fde64d6603c7a82d7bf2c7"><div class="ttname"><a href="a00129.html#ad3395a55a5fde64d6603c7a82d7bf2c7">_MODEL_NVARS_</a></div><div class="ttdeci">#define _MODEL_NVARS_</div><div class="ttdef"><b>Definition:</b> <a href="a00129_source.html#l00058">euler1d.h:58</a></div></div>
<div class="ttc" id="a00106_html_a38e0371f331cecbe63a77fa03e202afe"><div class="ttname"><a href="a00106.html#a38e0371f331cecbe63a77fa03e202afe">HyPar::dim_local</a></div><div class="ttdeci">int * dim_local</div><div class="ttdef"><b>Definition:</b> <a href="a00125_source.html#l00032">hypar.h:32</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a3c64bcea38b974bd6a174b9f6324cf64"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int Euler1DPreStep </td>
          <td>(</td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>u</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>s</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>m</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>waqt</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>1D Euler-specific function called at the beginning of each time-step: For a simulation that splits the hyperbolic flux into its acoustic and entropy components for implicit- explicit time-integration, this function computes the fast Jacobian at the beginning of a time step for the linearized formulation. </p><dl class="section see"><dt>See also</dt><dd><a class="el" href="a00129.html#a2f680b65f650c3360682d6f65e4f7321">_Euler1DSetLinearizedStiffFlux_</a>, <a class="el" href="a00129.html#a5a41ecdbbb78de026d8541491fb5587f">_Euler1DSetStiffJac_</a>, <a class="el" href="a00275.html#a31b02a37de0ea8443f0dd89d5861e114">Euler1DStiffFlux</a> </dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">u</td><td>Solution (conserved variables) </td></tr>
    <tr><td class="paramname">s</td><td>Solver object of type <a class="el" href="a00106.html" title="Structure containing all solver-specific variables and functions. ">HyPar</a> </td></tr>
    <tr><td class="paramname">m</td><td>MPI object of type <a class="el" href="a00108.html#a00444" title="Structure of MPI-related variables. ">MPIVariables</a> </td></tr>
    <tr><td class="paramname">waqt</td><td>Current solution time </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="a00278_source.html#l00016">16</a> of file <a class="el" href="a00278_source.html">Euler1DPreStep.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;{</div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;  <a class="code" href="a00106.html">HyPar</a>             *solver = (<a class="code" href="a00106.html">HyPar</a>*)   s;</div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;  <a class="code" href="a00099.html">Euler1D</a>           *param  = (<a class="code" href="a00099.html">Euler1D</a>*) solver-&gt;<a class="code" href="a00106.html#a48e81a1806b5774943fd9a26e9a190f2">physics</a>;</div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;  <span class="keywordtype">int</span>               *dim    = solver-&gt;<a class="code" href="a00106.html#a38e0371f331cecbe63a77fa03e202afe">dim_local</a>;</div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;  <span class="keywordtype">int</span>               ghosts  = solver-&gt;<a class="code" href="a00106.html#aafc992b5fa79d5a4036024615d03bce6">ghosts</a>;</div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;  <span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">int</span>  ndims   = <a class="code" href="a00129.html#a57771c952ec174601addf43e1c0202b2">_MODEL_NDIMS_</a>;</div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;  <span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">int</span>  JacSize = <a class="code" href="a00129.html#ad3395a55a5fde64d6603c7a82d7bf2c7">_MODEL_NVARS_</a>*<a class="code" href="a00129.html#ad3395a55a5fde64d6603c7a82d7bf2c7">_MODEL_NVARS_</a>;</div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;  <span class="keyword">static</span> <span class="keywordtype">int</span>        index[<a class="code" href="a00129.html#a57771c952ec174601addf43e1c0202b2">_MODEL_NDIMS_</a>], bounds[_MODEL_NDIMS_], offset[_MODEL_NDIMS_];</div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;</div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;  <span class="comment">/* set bounds for array index to include ghost points */</span></div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;  <a class="code" href="a00121.html#a197e4f9ce0b056b3f3addbbd9887f703">_ArrayAddCopy1D_</a>(dim,(2*ghosts),bounds,ndims);</div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;  <span class="comment">/* set offset such that index is compatible with ghost point arrangement */</span></div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;  <a class="code" href="a00121.html#a2b2826031c0cd92495ab351d3e599fc5">_ArraySetValue_</a>(offset,ndims,-ghosts);</div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;  <span class="comment">/* copy the solution to act as a reference for linearization */</span></div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;  <a class="code" href="a00121.html#a89e8330d9e06dd0666c50833628a125c">_ArrayCopy1D_</a>(u,param-&gt;<a class="code" href="a00099.html#a7568fac4d4e8488510e1d37f468967b1">solution</a>,(solver-&gt;<a class="code" href="a00106.html#a20ee1fd00a220b98513127884a5558cf">npoints_local_wghosts</a>*<a class="code" href="a00129.html#ad3395a55a5fde64d6603c7a82d7bf2c7">_MODEL_NVARS_</a>));</div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;</div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;  <span class="keywordtype">int</span> done = 0; <a class="code" href="a00121.html#a2b2826031c0cd92495ab351d3e599fc5">_ArraySetValue_</a>(index,ndims,0);</div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;  <span class="keywordflow">while</span> (!done) {</div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;    <span class="keywordtype">int</span> p; <a class="code" href="a00121.html#a0739cb538f4d301fad3b45059ddd0738">_ArrayIndex1DWO_</a>(ndims,dim,index,offset,ghosts,p);</div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;    <span class="keywordtype">double</span> rho, v, e, P;</div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;    <a class="code" href="a00129.html#af35510fb1477577f57c57cc2a862b1e7">_Euler1DGetFlowVar_</a>((u+<a class="code" href="a00129.html#ad3395a55a5fde64d6603c7a82d7bf2c7">_MODEL_NVARS_</a>*p),rho,v,e,P,param);</div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;    <a class="code" href="a00129.html#a5a41ecdbbb78de026d8541491fb5587f">_Euler1DSetStiffJac_</a>((param-&gt;<a class="code" href="a00099.html#a14af7516371abe115b3a1aa9269aebb5">fast_jac</a>+JacSize*p),rho,v,e,P,param-&gt;<a class="code" href="a00099.html#a72f9e01745b3a8203067ab84aefc9aea">gamma</a>);</div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;    <a class="code" href="a00121.html#ac5ec1371623f11d03b0f42adaa24acbc">_ArrayIncrementIndex_</a>(ndims,bounds,index,done);</div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;  }</div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;</div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;  <span class="keywordflow">return</span>(0);</div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;}</div>
<div class="ttc" id="a00106_html_a20ee1fd00a220b98513127884a5558cf"><div class="ttname"><a href="a00106.html#a20ee1fd00a220b98513127884a5558cf">HyPar::npoints_local_wghosts</a></div><div class="ttdeci">int npoints_local_wghosts</div><div class="ttdef"><b>Definition:</b> <a href="a00125_source.html#l00037">hypar.h:37</a></div></div>
<div class="ttc" id="a00129_html_af35510fb1477577f57c57cc2a862b1e7"><div class="ttname"><a href="a00129.html#af35510fb1477577f57c57cc2a862b1e7">_Euler1DGetFlowVar_</a></div><div class="ttdeci">#define _Euler1DGetFlowVar_(u, rho, v, e, P, p)</div><div class="ttdef"><b>Definition:</b> <a href="a00129_source.html#l00079">euler1d.h:79</a></div></div>
<div class="ttc" id="a00121_html_ac5ec1371623f11d03b0f42adaa24acbc"><div class="ttname"><a href="a00121.html#ac5ec1371623f11d03b0f42adaa24acbc">_ArrayIncrementIndex_</a></div><div class="ttdeci">#define _ArrayIncrementIndex_(N, imax, i, done)</div><div class="ttdef"><b>Definition:</b> <a href="a00121_source.html#l00122">arrayfunctions.h:122</a></div></div>
<div class="ttc" id="a00099_html_a72f9e01745b3a8203067ab84aefc9aea"><div class="ttname"><a href="a00099.html#a72f9e01745b3a8203067ab84aefc9aea">Euler1D::gamma</a></div><div class="ttdeci">double gamma</div><div class="ttdef"><b>Definition:</b> <a href="a00129_source.html#l00272">euler1d.h:272</a></div></div>
<div class="ttc" id="a00099_html_a14af7516371abe115b3a1aa9269aebb5"><div class="ttname"><a href="a00099.html#a14af7516371abe115b3a1aa9269aebb5">Euler1D::fast_jac</a></div><div class="ttdeci">double * fast_jac</div><div class="ttdef"><b>Definition:</b> <a href="a00129_source.html#l00287">euler1d.h:287</a></div></div>
<div class="ttc" id="a00121_html_a89e8330d9e06dd0666c50833628a125c"><div class="ttname"><a href="a00121.html#a89e8330d9e06dd0666c50833628a125c">_ArrayCopy1D_</a></div><div class="ttdeci">#define _ArrayCopy1D_(x, y, size)</div><div class="ttdef"><b>Definition:</b> <a href="a00121_source.html#l00281">arrayfunctions.h:281</a></div></div>
<div class="ttc" id="a00099_html"><div class="ttname"><a href="a00099.html">Euler1D</a></div><div class="ttdoc">Structure containing variables and parameters specific to the 1D Euler equations. This structure cont...</div><div class="ttdef"><b>Definition:</b> <a href="a00129_source.html#l00271">euler1d.h:271</a></div></div>
<div class="ttc" id="a00106_html"><div class="ttname"><a href="a00106.html">HyPar</a></div><div class="ttdoc">Structure containing all solver-specific variables and functions. </div><div class="ttdef"><b>Definition:</b> <a href="a00125_source.html#l00020">hypar.h:20</a></div></div>
<div class="ttc" id="a00099_html_a7568fac4d4e8488510e1d37f468967b1"><div class="ttname"><a href="a00099.html#a7568fac4d4e8488510e1d37f468967b1">Euler1D::solution</a></div><div class="ttdeci">double * solution</div><div class="ttdef"><b>Definition:</b> <a href="a00129_source.html#l00288">euler1d.h:288</a></div></div>
<div class="ttc" id="a00121_html_a0739cb538f4d301fad3b45059ddd0738"><div class="ttname"><a href="a00121.html#a0739cb538f4d301fad3b45059ddd0738">_ArrayIndex1DWO_</a></div><div class="ttdeci">#define _ArrayIndex1DWO_(N, imax, i, offset, ghost, index)</div><div class="ttdef"><b>Definition:</b> <a href="a00121_source.html#l00079">arrayfunctions.h:79</a></div></div>
<div class="ttc" id="a00106_html_a48e81a1806b5774943fd9a26e9a190f2"><div class="ttname"><a href="a00106.html#a48e81a1806b5774943fd9a26e9a190f2">HyPar::physics</a></div><div class="ttdeci">void * physics</div><div class="ttdef"><b>Definition:</b> <a href="a00125_source.html#l00231">hypar.h:231</a></div></div>
<div class="ttc" id="a00129_html_a57771c952ec174601addf43e1c0202b2"><div class="ttname"><a href="a00129.html#a57771c952ec174601addf43e1c0202b2">_MODEL_NDIMS_</a></div><div class="ttdeci">#define _MODEL_NDIMS_</div><div class="ttdef"><b>Definition:</b> <a href="a00129_source.html#l00056">euler1d.h:56</a></div></div>
<div class="ttc" id="a00121_html_a197e4f9ce0b056b3f3addbbd9887f703"><div class="ttname"><a href="a00121.html#a197e4f9ce0b056b3f3addbbd9887f703">_ArrayAddCopy1D_</a></div><div class="ttdeci">#define _ArrayAddCopy1D_(x, a, y, size)</div><div class="ttdef"><b>Definition:</b> <a href="a00121_source.html#l00330">arrayfunctions.h:330</a></div></div>
<div class="ttc" id="a00121_html_a2b2826031c0cd92495ab351d3e599fc5"><div class="ttname"><a href="a00121.html#a2b2826031c0cd92495ab351d3e599fc5">_ArraySetValue_</a></div><div class="ttdeci">#define _ArraySetValue_(x, size, value)</div><div class="ttdef"><b>Definition:</b> <a href="a00121_source.html#l00142">arrayfunctions.h:142</a></div></div>
<div class="ttc" id="a00106_html_aafc992b5fa79d5a4036024615d03bce6"><div class="ttname"><a href="a00106.html#aafc992b5fa79d5a4036024615d03bce6">HyPar::ghosts</a></div><div class="ttdeci">int ghosts</div><div class="ttdef"><b>Definition:</b> <a href="a00125_source.html#l00041">hypar.h:41</a></div></div>
<div class="ttc" id="a00129_html_a5a41ecdbbb78de026d8541491fb5587f"><div class="ttname"><a href="a00129.html#a5a41ecdbbb78de026d8541491fb5587f">_Euler1DSetStiffJac_</a></div><div class="ttdeci">#define _Euler1DSetStiffJac_(J, rho, v, e, P, gamma)</div><div class="ttdef"><b>Definition:</b> <a href="a00129_source.html#l00147">euler1d.h:147</a></div></div>
<div class="ttc" id="a00129_html_ad3395a55a5fde64d6603c7a82d7bf2c7"><div class="ttname"><a href="a00129.html#ad3395a55a5fde64d6603c7a82d7bf2c7">_MODEL_NVARS_</a></div><div class="ttdeci">#define _MODEL_NVARS_</div><div class="ttdef"><b>Definition:</b> <a href="a00129_source.html#l00058">euler1d.h:58</a></div></div>
<div class="ttc" id="a00106_html_a38e0371f331cecbe63a77fa03e202afe"><div class="ttname"><a href="a00106.html#a38e0371f331cecbe63a77fa03e202afe">HyPar::dim_local</a></div><div class="ttdeci">int * dim_local</div><div class="ttdef"><b>Definition:</b> <a href="a00125_source.html#l00032">hypar.h:32</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a5ca9a44e7eaa2b535b4d4431b60c9ff6"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int Euler1DInitialize </td>
          <td>(</td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>s</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>m</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Function to initialize the 1D inviscid Euler equations (<a class="el" href="a00099.html" title="Structure containing variables and parameters specific to the 1D Euler equations. This structure cont...">Euler1D</a>) module: Sets the default parameters, read in and set physics-related parameters, and set the physics-related function pointers in <a class="el" href="a00106.html" title="Structure containing all solver-specific variables and functions. ">HyPar</a>.</p>
<p>This file reads the file "physics.inp" that must have the following format: </p><pre class="fragment">begin
    &lt;keyword&gt;   &lt;value&gt;
    &lt;keyword&gt;   &lt;value&gt;
    &lt;keyword&gt;   &lt;value&gt;
    ...
    &lt;keyword&gt;   &lt;value&gt;
end
</pre><p>where the list of keywords are:</p>
<table class="doxtable">
<tr>
<th>Keyword name </th><th>Type </th><th>Variable </th><th>Default value  </th></tr>
<tr>
<td>gamma </td><td>double </td><td><a class="el" href="a00099.html#a72f9e01745b3a8203067ab84aefc9aea">Euler1D::gamma</a> </td><td>1.4 </td></tr>
<tr>
<td>gravity </td><td>double </td><td><a class="el" href="a00099.html#a87f6134534484ec863864096005ac076">Euler1D::grav</a> </td><td>0.0 </td></tr>
<tr>
<td>grav_type </td><td>int </td><td><a class="el" href="a00099.html#a41908af46d7b1181c9177332aa44ead5">Euler1D::grav_type</a> </td><td>0 </td></tr>
<tr>
<td>upwinding </td><td>char[] </td><td><a class="el" href="a00099.html#a57894a0f53d5b228bf64053367736bf9">Euler1D::upw_choice</a> </td><td>"roe" (<a class="el" href="a00133.html#abffeadaaee7a3a2baeeb28e395411d73">_ROE_</a>) </td></tr>
</table>
<p><b>Note:</b> "physics.inp" is <b>optional</b>; if absent, default values will be used. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">s</td><td>Solver object of type <a class="el" href="a00106.html" title="Structure containing all solver-specific variables and functions. ">HyPar</a> </td></tr>
    <tr><td class="paramname">m</td><td>Object of type <a class="el" href="a00108.html#a00444" title="Structure of MPI-related variables. ">MPIVariables</a> containing MPI-related info </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="a00275_source.html#l00066">66</a> of file <a class="el" href="a00275_source.html">Euler1DInitialize.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;{</div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;  <a class="code" href="a00106.html">HyPar</a>         *solver  = (<a class="code" href="a00106.html">HyPar</a>*)         s;</div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;  <a class="code" href="a00108.html#a00444">MPIVariables</a>  *mpi     = (<a class="code" href="a00108.html#a00444">MPIVariables</a>*)  m; </div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;  <a class="code" href="a00099.html">Euler1D</a>       *physics = (<a class="code" href="a00099.html">Euler1D</a>*)       solver-&gt;<a class="code" href="a00106.html#a48e81a1806b5774943fd9a26e9a190f2">physics</a>;</div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;  <span class="keywordtype">int</span>           ferr, d;</div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;</div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;  if (solver-&gt;<a class="code" href="a00106.html#ae8f6d2fd6490d3153cb4133bf183a404">nvars</a> != <a class="code" href="a00129.html#ad3395a55a5fde64d6603c7a82d7bf2c7">_MODEL_NVARS_</a>) {</div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;    fprintf(stderr,<span class="stringliteral">&quot;Error in Euler1DInitialize(): nvars has to be %d.\n&quot;</span>,<a class="code" href="a00129.html#ad3395a55a5fde64d6603c7a82d7bf2c7">_MODEL_NVARS_</a>);</div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;    <span class="keywordflow">return</span>(1);</div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;  }</div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;  <span class="keywordflow">if</span> (solver-&gt;<a class="code" href="a00106.html#a484873c74138512e41bc50d17b7d955a">ndims</a> != <a class="code" href="a00129.html#a57771c952ec174601addf43e1c0202b2">_MODEL_NDIMS_</a>) {</div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;    fprintf(stderr,<span class="stringliteral">&quot;Error in Euler1DInitialize(): ndims has to be %d.\n&quot;</span>,<a class="code" href="a00129.html#a57771c952ec174601addf43e1c0202b2">_MODEL_NDIMS_</a>);</div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;    <span class="keywordflow">return</span>(1);</div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;  }</div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;</div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;  <span class="comment">/* default values */</span></div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;  physics-&gt;<a class="code" href="a00099.html#a72f9e01745b3a8203067ab84aefc9aea">gamma</a>      = 1.4; </div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;  physics-&gt;<a class="code" href="a00099.html#a87f6134534484ec863864096005ac076">grav</a>       = 0.0;</div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;  physics-&gt;<a class="code" href="a00099.html#a41908af46d7b1181c9177332aa44ead5">grav_type</a>  = 0;</div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;  strcpy(physics-&gt;<a class="code" href="a00099.html#a57894a0f53d5b228bf64053367736bf9">upw_choice</a>,<span class="stringliteral">&quot;roe&quot;</span>);</div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;</div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;  <span class="comment">/* reading physical model specific inputs */</span></div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;  <span class="keywordflow">if</span> (!mpi-&gt;<a class="code" href="a00108.html#a6cfd95afd0afebd625b889fb6e58371c">rank</a>) {</div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;    FILE *in;</div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;    printf(<span class="stringliteral">&quot;Reading physical model inputs from file \&quot;physics.inp\&quot;.\n&quot;</span>);</div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;    in = fopen(<span class="stringliteral">&quot;physics.inp&quot;</span>,<span class="stringliteral">&quot;r&quot;</span>);</div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;    <span class="keywordflow">if</span> (!in) printf(<span class="stringliteral">&quot;Warning: File \&quot;physics.inp\&quot; not found. Using default values.\n&quot;</span>);</div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;    <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;      <span class="keywordtype">char</span> word[<a class="code" href="a00122.html#a51efea86a4d76d1259893f606b776573">_MAX_STRING_SIZE_</a>];</div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;      ferr = fscanf(in,<span class="stringliteral">&quot;%s&quot;</span>,word); <span class="keywordflow">if</span> (ferr != 1) <span class="keywordflow">return</span>(1);</div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;      <span class="keywordflow">if</span> (!strcmp(word, <span class="stringliteral">&quot;begin&quot;</span>)){</div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;          <span class="keywordflow">while</span> (strcmp(word, <span class="stringliteral">&quot;end&quot;</span>)){</div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;              ferr = fscanf(in,<span class="stringliteral">&quot;%s&quot;</span>,word); <span class="keywordflow">if</span> (ferr != 1) <span class="keywordflow">return</span>(1);</div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;          <span class="keywordflow">if</span> (!strcmp(word, <span class="stringliteral">&quot;gamma&quot;</span>)) { </div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;            ferr = fscanf(in,<span class="stringliteral">&quot;%lf&quot;</span>,&amp;physics-&gt;<a class="code" href="a00099.html#a72f9e01745b3a8203067ab84aefc9aea">gamma</a>); </div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;            <span class="keywordflow">if</span> (ferr != 1) <span class="keywordflow">return</span>(1);</div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;          } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcmp(word, <span class="stringliteral">&quot;gravity&quot;</span>)) { </div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;            ferr = fscanf(in,<span class="stringliteral">&quot;%lf&quot;</span>,&amp;physics-&gt;<a class="code" href="a00099.html#a87f6134534484ec863864096005ac076">grav</a>); </div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;            <span class="keywordflow">if</span> (ferr != 1) <span class="keywordflow">return</span>(1);</div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;          } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcmp(word, <span class="stringliteral">&quot;gravity_type&quot;</span>)) { </div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;            ferr = fscanf(in,<span class="stringliteral">&quot;%d&quot;</span>,&amp;physics-&gt;<a class="code" href="a00099.html#a41908af46d7b1181c9177332aa44ead5">grav_type</a>); </div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;            <span class="keywordflow">if</span> (ferr != 1) <span class="keywordflow">return</span>(1);</div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;          } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcmp(word,<span class="stringliteral">&quot;upwinding&quot;</span>)) {</div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;            ferr = fscanf(in,<span class="stringliteral">&quot;%s&quot;</span>,physics-&gt;<a class="code" href="a00099.html#a57894a0f53d5b228bf64053367736bf9">upw_choice</a>); </div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;            <span class="keywordflow">if</span> (ferr != 1) <span class="keywordflow">return</span>(1);</div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;          } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (strcmp(word,<span class="stringliteral">&quot;end&quot;</span>)) {</div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;            <span class="keywordtype">char</span> useless[<a class="code" href="a00122.html#a51efea86a4d76d1259893f606b776573">_MAX_STRING_SIZE_</a>];</div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;            ferr = fscanf(in,<span class="stringliteral">&quot;%s&quot;</span>,useless); <span class="keywordflow">if</span> (ferr != 1) <span class="keywordflow">return</span>(ferr);</div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;            printf(<span class="stringliteral">&quot;Warning: keyword %s in file \&quot;physics.inp\&quot; with value %s not &quot;</span>,word,useless);</div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;            printf(<span class="stringliteral">&quot;recognized or extraneous. Ignoring.\n&quot;</span>);</div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;          }</div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;        }</div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;          fprintf(stderr,<span class="stringliteral">&quot;Error: Illegal format in file \&quot;physics.inp\&quot;.\n&quot;</span>);</div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;        <span class="keywordflow">return</span>(1);</div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;        }</div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;    }</div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;    fclose(in);</div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;  }</div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;</div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;<span class="preprocessor">#ifndef serial</span></div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;  <a class="code" href="a00122.html#ad6ab74942c9de13cf0b4c12eb0d91780">IERR</a> <a class="code" href="a00108.html#a45dcb265863a65d862bb16222e7e623c">MPIBroadcast_double</a>    (&amp;physics-&gt;<a class="code" href="a00099.html#a72f9e01745b3a8203067ab84aefc9aea">gamma</a>    ,1,0,&amp;mpi-&gt;<a class="code" href="a00108.html#adad7a6f85831f3ac84d854b6c80aef43">world</a>);                  <a class="code" href="a00122.html#add9cf96ae374934d245a1dc1ab697a42">CHECKERR</a>(ierr);</div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;  <a class="code" href="a00122.html#ad6ab74942c9de13cf0b4c12eb0d91780">IERR</a> <a class="code" href="a00108.html#a45dcb265863a65d862bb16222e7e623c">MPIBroadcast_double</a>    (&amp;physics-&gt;<a class="code" href="a00099.html#a87f6134534484ec863864096005ac076">grav</a>     ,1,0,&amp;mpi-&gt;<a class="code" href="a00108.html#adad7a6f85831f3ac84d854b6c80aef43">world</a>);                  <a class="code" href="a00122.html#add9cf96ae374934d245a1dc1ab697a42">CHECKERR</a>(ierr);</div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;  <a class="code" href="a00122.html#ad6ab74942c9de13cf0b4c12eb0d91780">IERR</a> <a class="code" href="a00108.html#acd7957559b9206224c7da3cab4f22b27">MPIBroadcast_integer</a>   (&amp;physics-&gt;<a class="code" href="a00099.html#a41908af46d7b1181c9177332aa44ead5">grav_type</a>,1,0,&amp;mpi-&gt;<a class="code" href="a00108.html#adad7a6f85831f3ac84d854b6c80aef43">world</a>);                  <a class="code" href="a00122.html#add9cf96ae374934d245a1dc1ab697a42">CHECKERR</a>(ierr);</div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;  <a class="code" href="a00122.html#ad6ab74942c9de13cf0b4c12eb0d91780">IERR</a> <a class="code" href="a00108.html#ad408e5a44e863cca50112d1e2f728597">MPIBroadcast_character</a> (physics-&gt;<a class="code" href="a00099.html#a57894a0f53d5b228bf64053367736bf9">upw_choice</a>,<a class="code" href="a00122.html#a51efea86a4d76d1259893f606b776573">_MAX_STRING_SIZE_</a>,0,&amp;mpi-&gt;<a class="code" href="a00108.html#adad7a6f85831f3ac84d854b6c80aef43">world</a>);  <a class="code" href="a00122.html#add9cf96ae374934d245a1dc1ab697a42">CHECKERR</a>(ierr);</div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;</div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;  <span class="keywordflow">if</span> ((physics-&gt;<a class="code" href="a00099.html#a87f6134534484ec863864096005ac076">grav</a> != 0.0) &amp;&amp; (strcmp(physics-&gt;<a class="code" href="a00099.html#a57894a0f53d5b228bf64053367736bf9">upw_choice</a>,<a class="code" href="a00129.html#a98a6bcc1b69abface4bef84cf0d51955">_LLF_</a>)) &amp;&amp; (strcmp(physics-&gt;<a class="code" href="a00099.html#a57894a0f53d5b228bf64053367736bf9">upw_choice</a>,<a class="code" href="a00129.html#abffeadaaee7a3a2baeeb28e395411d73">_ROE_</a>))) {</div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;    <span class="keywordflow">if</span> (!mpi-&gt;<a class="code" href="a00108.html#a6cfd95afd0afebd625b889fb6e58371c">rank</a>) {</div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;      fprintf(stderr,<span class="stringliteral">&quot;Error in Euler1DInitialize: %s or %s upwinding is needed for flows &quot;</span>,<a class="code" href="a00129.html#a98a6bcc1b69abface4bef84cf0d51955">_LLF_</a>,<a class="code" href="a00129.html#abffeadaaee7a3a2baeeb28e395411d73">_ROE_</a>);</div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;      fprintf(stderr,<span class="stringliteral">&quot;with gravitational forces.\n&quot;</span>);</div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;    }</div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;    <span class="keywordflow">return</span>(1);</div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;  }</div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;</div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;  <span class="comment">/* initializing physical model-specific functions */</span></div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;  solver-&gt;<a class="code" href="a00106.html#a6f5f6b79d3991a3124226d4cc576e475">PreStep</a>            = <a class="code" href="a00275.html#a3c64bcea38b974bd6a174b9f6324cf64">Euler1DPreStep</a>;</div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;  solver-&gt;<a class="code" href="a00106.html#a3324b3053dab0b7d1d361c05ee006a65">ComputeCFL</a>         = <a class="code" href="a00275.html#a96dfe05f0bab236d14c49a97f6f3a9c9">Euler1DComputeCFL</a>;</div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;  solver-&gt;<a class="code" href="a00106.html#abd6886cf9b7ead81e0aaa9ead9aced81">FFunction</a>          = <a class="code" href="a00275.html#a765baa9888bf5d1e7ed3580e6df04e17">Euler1DFlux</a>;</div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;  solver-&gt;<a class="code" href="a00106.html#ac195e64afcda3d4ec94d8fdf2b9dcdc8">SFunction</a>          = <a class="code" href="a00275.html#a52dc5f992bf9d226505d94da0d45176e">Euler1DSource</a>;</div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;  solver-&gt;<a class="code" href="a00106.html#aa400371d02f323e03768e5db0d3e599c">UFunction</a>          = <a class="code" href="a00275.html#ae1858c7bcd504b88e0140b21e41c35bf">Euler1DModifiedSolution</a>;</div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;  <span class="keywordflow">if</span>      (!strcmp(physics-&gt;<a class="code" href="a00099.html#a57894a0f53d5b228bf64053367736bf9">upw_choice</a>,<a class="code" href="a00129.html#abffeadaaee7a3a2baeeb28e395411d73">_ROE_</a> )) solver-&gt;<a class="code" href="a00106.html#a3687b87fa31b07580aa2ef43089fb010">Upwind</a> = <a class="code" href="a00275.html#a84fa9fe2c9c779fa314d02fd62df589f">Euler1DUpwindRoe</a>;</div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcmp(physics-&gt;<a class="code" href="a00099.html#a57894a0f53d5b228bf64053367736bf9">upw_choice</a>,<a class="code" href="a00129.html#a51e0f9431973e4cf55e6aeee7dab6d83">_RF_</a>  )) solver-&gt;<a class="code" href="a00106.html#a3687b87fa31b07580aa2ef43089fb010">Upwind</a> = <a class="code" href="a00275.html#aecab791493af24dbb79224ccdd1c22cd">Euler1DUpwindRF</a>;</div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcmp(physics-&gt;<a class="code" href="a00099.html#a57894a0f53d5b228bf64053367736bf9">upw_choice</a>,<a class="code" href="a00129.html#a98a6bcc1b69abface4bef84cf0d51955">_LLF_</a> )) solver-&gt;<a class="code" href="a00106.html#a3687b87fa31b07580aa2ef43089fb010">Upwind</a> = <a class="code" href="a00275.html#a9f4272feb90b98823419004ad0923446">Euler1DUpwindLLF</a>;</div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcmp(physics-&gt;<a class="code" href="a00099.html#a57894a0f53d5b228bf64053367736bf9">upw_choice</a>,<a class="code" href="a00129.html#a930e301363fd9f0a570d97c8c3dd3ea3">_SWFS_</a>)) solver-&gt;<a class="code" href="a00106.html#a3687b87fa31b07580aa2ef43089fb010">Upwind</a> = <a class="code" href="a00275.html#a0c16592ca1938504fff89a566be82a87">Euler1DUpwindSWFS</a>;</div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;  <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;    <span class="keywordflow">if</span> (!mpi-&gt;<a class="code" href="a00108.html#a6cfd95afd0afebd625b889fb6e58371c">rank</a>) fprintf(stderr,<span class="stringliteral">&quot;Error in Euler1DInitialize(): %s is not a valid upwinding scheme.\n&quot;</span>,</div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;                            physics-&gt;<a class="code" href="a00099.html#a57894a0f53d5b228bf64053367736bf9">upw_choice</a>);</div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;    <span class="keywordflow">return</span>(1);</div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;  }</div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;  <span class="keywordflow">if</span> (!strcmp(solver-&gt;<a class="code" href="a00106.html#a5bed0cb9665daad89f4377c4f7609df4">SplitHyperbolicFlux</a>,<span class="stringliteral">&quot;yes&quot;</span>)) {</div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;    solver-&gt;<a class="code" href="a00106.html#a947962a92106cbbec85b5b8a396cb167">dFFunction</a> = <a class="code" href="a00275.html#a31b02a37de0ea8443f0dd89d5861e114">Euler1DStiffFlux</a>;</div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;    solver-&gt;<a class="code" href="a00106.html#a25c87c7c874c7e08981688fe6c51167b">JFunction</a>  = <a class="code" href="a00275.html#a79e3229219a9992f484df9573de95ec3">Euler1DStiffJacobian</a>;</div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;    <span class="keywordflow">if</span>      (!strcmp(physics-&gt;<a class="code" href="a00099.html#a57894a0f53d5b228bf64053367736bf9">upw_choice</a>,<a class="code" href="a00129.html#abffeadaaee7a3a2baeeb28e395411d73">_ROE_</a> )) solver-&gt;<a class="code" href="a00106.html#a8b92eb4fb429c9c91d3fec3ad1ce6a88">UpwinddF</a> = <a class="code" href="a00275.html#a0632e000475600a07f89aaad0fcea2a2">Euler1DUpwinddFRoe</a>;</div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcmp(physics-&gt;<a class="code" href="a00099.html#a57894a0f53d5b228bf64053367736bf9">upw_choice</a>,<a class="code" href="a00129.html#a51e0f9431973e4cf55e6aeee7dab6d83">_RF_</a>  )) solver-&gt;<a class="code" href="a00106.html#a8b92eb4fb429c9c91d3fec3ad1ce6a88">UpwinddF</a> = <a class="code" href="a00275.html#a2e6e98b8cf8dda3540b17764262ef7dc">Euler1DUpwinddFRF</a>;</div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcmp(physics-&gt;<a class="code" href="a00099.html#a57894a0f53d5b228bf64053367736bf9">upw_choice</a>,<a class="code" href="a00129.html#a98a6bcc1b69abface4bef84cf0d51955">_LLF_</a> )) solver-&gt;<a class="code" href="a00106.html#a8b92eb4fb429c9c91d3fec3ad1ce6a88">UpwinddF</a> = <a class="code" href="a00275.html#a2050afda2d76244d8b1be2534d8eee88">Euler1DUpwinddFLLF</a>;</div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;    <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;      <span class="keywordflow">if</span> (!mpi-&gt;<a class="code" href="a00108.html#a6cfd95afd0afebd625b889fb6e58371c">rank</a>) {</div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;        fprintf(stderr,<span class="stringliteral">&quot;Error in Euler1DInitialize(): %s is not a valid upwinding scheme &quot;</span>,</div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;                physics-&gt;<a class="code" href="a00099.html#a57894a0f53d5b228bf64053367736bf9">upw_choice</a>);</div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;        fprintf(stderr,<span class="stringliteral">&quot;when split form of the hyperbolic flux is used. Use %s, %s or %s.\n&quot;</span>,</div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;                <a class="code" href="a00129.html#abffeadaaee7a3a2baeeb28e395411d73">_ROE_</a>,<a class="code" href="a00129.html#a51e0f9431973e4cf55e6aeee7dab6d83">_RF_</a>,<a class="code" href="a00129.html#a98a6bcc1b69abface4bef84cf0d51955">_LLF_</a>);</div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;      }</div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;      <span class="keywordflow">return</span>(1);</div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;    }</div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;  } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;    solver-&gt;<a class="code" href="a00106.html#a947962a92106cbbec85b5b8a396cb167">dFFunction</a> = NULL;</div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;    solver-&gt;<a class="code" href="a00106.html#a8b92eb4fb429c9c91d3fec3ad1ce6a88">UpwinddF</a>   = NULL;</div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;    solver-&gt;<a class="code" href="a00106.html#a25c87c7c874c7e08981688fe6c51167b">JFunction</a>  = <a class="code" href="a00275.html#a7ab3a531ada5d839c915add13cea5ae0">Euler1DJacobian</a>;</div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;  }</div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;  solver-&gt;<a class="code" href="a00106.html#aaf207bb69a6178ea0b741b6edf8dbb4a">AveragingFunction</a>     = <a class="code" href="a00275.html#a6dfa80796cd1ce0ba0712c301dd68d2f">Euler1DRoeAverage</a>;</div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;  solver-&gt;<a class="code" href="a00106.html#a94f9fe27c5af29d137182f895d2da453">GetLeftEigenvectors</a>   = <a class="code" href="a00275.html#a979f0aa5a88e8c1d32794ccba50bc806">Euler1DLeftEigenvectors</a>;</div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;  solver-&gt;<a class="code" href="a00106.html#a8c0bbbde58df479b0d991186443dcf1a">GetRightEigenvectors</a>  = <a class="code" href="a00275.html#a6139f9478a0791ac0a0c0d43faffb378">Euler1DRightEigenvectors</a>;</div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;   </div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;  <span class="keywordflow">if</span>      (!strcmp(physics-&gt;<a class="code" href="a00099.html#a57894a0f53d5b228bf64053367736bf9">upw_choice</a>,<a class="code" href="a00129.html#a98a6bcc1b69abface4bef84cf0d51955">_LLF_</a> )) physics-&gt;<a class="code" href="a00099.html#acf2a05e3d7005c865c3e4f609cf728f8">SourceUpwind</a> = <a class="code" href="a00275.html#a9626db6c422f313b9762b0223f1a52da">Euler1DSourceUpwindLLF</a>;</div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcmp(physics-&gt;<a class="code" href="a00099.html#a57894a0f53d5b228bf64053367736bf9">upw_choice</a>,<a class="code" href="a00129.html#abffeadaaee7a3a2baeeb28e395411d73">_ROE_</a> )) physics-&gt;<a class="code" href="a00099.html#acf2a05e3d7005c865c3e4f609cf728f8">SourceUpwind</a> = <a class="code" href="a00275.html#a564a6dcdf1979d59610503201e6f2619">Euler1DSourceUpwindRoe</a>;</div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;</div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;  <span class="comment">/* allocate array to hold the gravity field */</span></div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;  <span class="keywordtype">int</span> *dim    = solver-&gt;<a class="code" href="a00106.html#a38e0371f331cecbe63a77fa03e202afe">dim_local</a>;</div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;  <span class="keywordtype">int</span> ghosts  = solver-&gt;<a class="code" href="a00106.html#aafc992b5fa79d5a4036024615d03bce6">ghosts</a>;</div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;  <span class="keywordtype">int</span> size = 1; <span class="keywordflow">for</span> (d=0; d&lt;<a class="code" href="a00129.html#a57771c952ec174601addf43e1c0202b2">_MODEL_NDIMS_</a>; d++) size *= (dim[d] + 2*ghosts);</div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;  physics-&gt;<a class="code" href="a00099.html#afb1265dc9bb8f8c05bd22f88c23d879c">grav_field</a> = (<span class="keywordtype">double</span>*) calloc (size, <span class="keyword">sizeof</span>(<span class="keywordtype">double</span>));</div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;  physics-&gt;<a class="code" href="a00099.html#a14af7516371abe115b3a1aa9269aebb5">fast_jac</a>   = (<span class="keywordtype">double</span>*) calloc (size*<a class="code" href="a00129.html#ad3395a55a5fde64d6603c7a82d7bf2c7">_MODEL_NVARS_</a>*<a class="code" href="a00129.html#ad3395a55a5fde64d6603c7a82d7bf2c7">_MODEL_NVARS_</a>, <span class="keyword">sizeof</span>(<span class="keywordtype">double</span>));</div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;  physics-&gt;<a class="code" href="a00099.html#a7568fac4d4e8488510e1d37f468967b1">solution</a>   = (<span class="keywordtype">double</span>*) calloc (size*_MODEL_NVARS_, <span class="keyword">sizeof</span>(<span class="keywordtype">double</span>));</div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;  <a class="code" href="a00122.html#ad6ab74942c9de13cf0b4c12eb0d91780">IERR</a> <a class="code" href="a00275.html#ac2a5ef9ed2d6611286c0ff4e213c735b">Euler1DGravityField</a>(solver,mpi); <a class="code" href="a00122.html#add9cf96ae374934d245a1dc1ab697a42">CHECKERR</a>(ierr);</div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;</div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;  <span class="keywordflow">return</span>(0);</div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;}</div>
<div class="ttc" id="a00129_html_a98a6bcc1b69abface4bef84cf0d51955"><div class="ttname"><a href="a00129.html#a98a6bcc1b69abface4bef84cf0d51955">_LLF_</a></div><div class="ttdeci">#define _LLF_</div><div class="ttdef"><b>Definition:</b> <a href="a00129_source.html#l00066">euler1d.h:66</a></div></div>
<div class="ttc" id="a00275_html_aecab791493af24dbb79224ccdd1c22cd"><div class="ttname"><a href="a00275.html#aecab791493af24dbb79224ccdd1c22cd">Euler1DUpwindRF</a></div><div class="ttdeci">int Euler1DUpwindRF(double *, double *, double *, double *, double *, double *, int, void *, double)</div><div class="ttdef"><b>Definition:</b> <a href="a00281_source.html#l00114">Euler1DUpwind.c:114</a></div></div>
<div class="ttc" id="a00106_html_a947962a92106cbbec85b5b8a396cb167"><div class="ttname"><a href="a00106.html#a947962a92106cbbec85b5b8a396cb167">HyPar::dFFunction</a></div><div class="ttdeci">int(* dFFunction)(double *, double *, int, void *, double)</div><div class="ttdef"><b>Definition:</b> <a href="a00125_source.html#l00244">hypar.h:244</a></div></div>
<div class="ttc" id="a00106_html_a484873c74138512e41bc50d17b7d955a"><div class="ttname"><a href="a00106.html#a484873c74138512e41bc50d17b7d955a">HyPar::ndims</a></div><div class="ttdeci">int ndims</div><div class="ttdef"><b>Definition:</b> <a href="a00125_source.html#l00023">hypar.h:23</a></div></div>
<div class="ttc" id="a00099_html_a87f6134534484ec863864096005ac076"><div class="ttname"><a href="a00099.html#a87f6134534484ec863864096005ac076">Euler1D::grav</a></div><div class="ttdeci">double grav</div><div class="ttdef"><b>Definition:</b> <a href="a00129_source.html#l00273">euler1d.h:273</a></div></div>
<div class="ttc" id="a00108_html_ad408e5a44e863cca50112d1e2f728597"><div class="ttname"><a href="a00108.html#ad408e5a44e863cca50112d1e2f728597">MPIBroadcast_character</a></div><div class="ttdeci">int MPIBroadcast_character(char *, int, int, void *)</div><div class="ttdef"><b>Definition:</b> <a href="a00231_source.html#l00037">MPIBroadcast.c:37</a></div></div>
<div class="ttc" id="a00106_html_aaf207bb69a6178ea0b741b6edf8dbb4a"><div class="ttname"><a href="a00106.html#aaf207bb69a6178ea0b741b6edf8dbb4a">HyPar::AveragingFunction</a></div><div class="ttdeci">int(* AveragingFunction)(double *, double *, double *, void *)</div><div class="ttdef"><b>Definition:</b> <a href="a00125_source.html#l00304">hypar.h:304</a></div></div>
<div class="ttc" id="a00275_html_a2050afda2d76244d8b1be2534d8eee88"><div class="ttname"><a href="a00275.html#a2050afda2d76244d8b1be2534d8eee88">Euler1DUpwinddFLLF</a></div><div class="ttdeci">int Euler1DUpwinddFLLF(double *, double *, double *, double *, double *, double *, int, void *, double)</div><div class="ttdef"><b>Definition:</b> <a href="a00281_source.html#l00540">Euler1DUpwind.c:540</a></div></div>
<div class="ttc" id="a00275_html_a31b02a37de0ea8443f0dd89d5861e114"><div class="ttname"><a href="a00275.html#a31b02a37de0ea8443f0dd89d5861e114">Euler1DStiffFlux</a></div><div class="ttdeci">int Euler1DStiffFlux(double *, double *, int, void *, double)</div><div class="ttdef"><b>Definition:</b> <a href="a00272_source.html#l00064">Euler1DFlux.c:64</a></div></div>
<div class="ttc" id="a00122_html_add9cf96ae374934d245a1dc1ab697a42"><div class="ttname"><a href="a00122.html#add9cf96ae374934d245a1dc1ab697a42">CHECKERR</a></div><div class="ttdeci">#define CHECKERR(ierr)</div><div class="ttdef"><b>Definition:</b> <a href="a00122_source.html#l00011">basic.h:11</a></div></div>
<div class="ttc" id="a00275_html_ac2a5ef9ed2d6611286c0ff4e213c735b"><div class="ttname"><a href="a00275.html#ac2a5ef9ed2d6611286c0ff4e213c735b">Euler1DGravityField</a></div><div class="ttdeci">int Euler1DGravityField(void *, void *)</div><div class="ttdef"><b>Definition:</b> <a href="a00274_source.html#l00023">Euler1DGravityField.c:23</a></div></div>
<div class="ttc" id="a00099_html_a57894a0f53d5b228bf64053367736bf9"><div class="ttname"><a href="a00099.html#a57894a0f53d5b228bf64053367736bf9">Euler1D::upw_choice</a></div><div class="ttdeci">char upw_choice[_MAX_STRING_SIZE_]</div><div class="ttdef"><b>Definition:</b> <a href="a00129_source.html#l00289">euler1d.h:289</a></div></div>
<div class="ttc" id="a00275_html_a7ab3a531ada5d839c915add13cea5ae0"><div class="ttname"><a href="a00275.html#a7ab3a531ada5d839c915add13cea5ae0">Euler1DJacobian</a></div><div class="ttdeci">int Euler1DJacobian(double *, double *, void *, int, int)</div><div class="ttdef"><b>Definition:</b> <a href="a00276_source.html#l00013">Euler1DJacobian.c:13</a></div></div>
<div class="ttc" id="a00108_html_a00444"><div class="ttname"><a href="a00108.html#a00444">MPIVariables</a></div><div class="ttdoc">Structure of MPI-related variables. </div><div class="ttdef"><b>Definition:</b> <a href="a00108_source.html#l00021">mpivars.h:21</a></div></div>
<div class="ttc" id="a00275_html_a6dfa80796cd1ce0ba0712c301dd68d2f"><div class="ttname"><a href="a00275.html#a6dfa80796cd1ce0ba0712c301dd68d2f">Euler1DRoeAverage</a></div><div class="ttdeci">int Euler1DRoeAverage(double *, double *, double *, void *)</div><div class="ttdef"><b>Definition:</b> <a href="a00273_source.html#l00016">Euler1DFunctions.c:16</a></div></div>
<div class="ttc" id="a00275_html_a79e3229219a9992f484df9573de95ec3"><div class="ttname"><a href="a00275.html#a79e3229219a9992f484df9573de95ec3">Euler1DStiffJacobian</a></div><div class="ttdeci">int Euler1DStiffJacobian(double *, double *, void *, int, int)</div><div class="ttdef"><b>Definition:</b> <a href="a00276_source.html#l00048">Euler1DJacobian.c:48</a></div></div>
<div class="ttc" id="a00106_html_a25c87c7c874c7e08981688fe6c51167b"><div class="ttname"><a href="a00106.html#a25c87c7c874c7e08981688fe6c51167b">HyPar::JFunction</a></div><div class="ttdeci">int(* JFunction)(double *, double *, void *, int, int)</div><div class="ttdef"><b>Definition:</b> <a href="a00125_source.html#l00286">hypar.h:286</a></div></div>
<div class="ttc" id="a00099_html_a72f9e01745b3a8203067ab84aefc9aea"><div class="ttname"><a href="a00099.html#a72f9e01745b3a8203067ab84aefc9aea">Euler1D::gamma</a></div><div class="ttdeci">double gamma</div><div class="ttdef"><b>Definition:</b> <a href="a00129_source.html#l00272">euler1d.h:272</a></div></div>
<div class="ttc" id="a00099_html_a14af7516371abe115b3a1aa9269aebb5"><div class="ttname"><a href="a00099.html#a14af7516371abe115b3a1aa9269aebb5">Euler1D::fast_jac</a></div><div class="ttdeci">double * fast_jac</div><div class="ttdef"><b>Definition:</b> <a href="a00129_source.html#l00287">euler1d.h:287</a></div></div>
<div class="ttc" id="a00275_html_a84fa9fe2c9c779fa314d02fd62df589f"><div class="ttname"><a href="a00275.html#a84fa9fe2c9c779fa314d02fd62df589f">Euler1DUpwindRoe</a></div><div class="ttdeci">int Euler1DUpwindRoe(double *, double *, double *, double *, double *, double *, int, void *, double)</div><div class="ttdef"><b>Definition:</b> <a href="a00281_source.html#l00029">Euler1DUpwind.c:29</a></div></div>
<div class="ttc" id="a00129_html_abffeadaaee7a3a2baeeb28e395411d73"><div class="ttname"><a href="a00129.html#abffeadaaee7a3a2baeeb28e395411d73">_ROE_</a></div><div class="ttdeci">#define _ROE_</div><div class="ttdef"><b>Definition:</b> <a href="a00129_source.html#l00062">euler1d.h:62</a></div></div>
<div class="ttc" id="a00275_html_a2e6e98b8cf8dda3540b17764262ef7dc"><div class="ttname"><a href="a00275.html#a2e6e98b8cf8dda3540b17764262ef7dc">Euler1DUpwinddFRF</a></div><div class="ttdeci">int Euler1DUpwinddFRF(double *, double *, double *, double *, double *, double *, int, void *, double)</div><div class="ttdef"><b>Definition:</b> <a href="a00281_source.html#l00451">Euler1DUpwind.c:451</a></div></div>
<div class="ttc" id="a00099_html"><div class="ttname"><a href="a00099.html">Euler1D</a></div><div class="ttdoc">Structure containing variables and parameters specific to the 1D Euler equations. This structure cont...</div><div class="ttdef"><b>Definition:</b> <a href="a00129_source.html#l00271">euler1d.h:271</a></div></div>
<div class="ttc" id="a00106_html"><div class="ttname"><a href="a00106.html">HyPar</a></div><div class="ttdoc">Structure containing all solver-specific variables and functions. </div><div class="ttdef"><b>Definition:</b> <a href="a00125_source.html#l00020">hypar.h:20</a></div></div>
<div class="ttc" id="a00099_html_a7568fac4d4e8488510e1d37f468967b1"><div class="ttname"><a href="a00099.html#a7568fac4d4e8488510e1d37f468967b1">Euler1D::solution</a></div><div class="ttdeci">double * solution</div><div class="ttdef"><b>Definition:</b> <a href="a00129_source.html#l00288">euler1d.h:288</a></div></div>
<div class="ttc" id="a00108_html_a6cfd95afd0afebd625b889fb6e58371c"><div class="ttname"><a href="a00108.html#a6cfd95afd0afebd625b889fb6e58371c">MPIVariables::rank</a></div><div class="ttdeci">int rank</div><div class="ttdef"><b>Definition:</b> <a href="a00108_source.html#l00022">mpivars.h:22</a></div></div>
<div class="ttc" id="a00275_html_a0632e000475600a07f89aaad0fcea2a2"><div class="ttname"><a href="a00275.html#a0632e000475600a07f89aaad0fcea2a2">Euler1DUpwinddFRoe</a></div><div class="ttdeci">int Euler1DUpwinddFRoe(double *, double *, double *, double *, double *, double *, int, void *, double)</div><div class="ttdef"><b>Definition:</b> <a href="a00281_source.html#l00370">Euler1DUpwind.c:370</a></div></div>
<div class="ttc" id="a00106_html_a48e81a1806b5774943fd9a26e9a190f2"><div class="ttname"><a href="a00106.html#a48e81a1806b5774943fd9a26e9a190f2">HyPar::physics</a></div><div class="ttdeci">void * physics</div><div class="ttdef"><b>Definition:</b> <a href="a00125_source.html#l00231">hypar.h:231</a></div></div>
<div class="ttc" id="a00099_html_a41908af46d7b1181c9177332aa44ead5"><div class="ttname"><a href="a00099.html#a41908af46d7b1181c9177332aa44ead5">Euler1D::grav_type</a></div><div class="ttdeci">int grav_type</div><div class="ttdef"><b>Definition:</b> <a href="a00129_source.html#l00284">euler1d.h:284</a></div></div>
<div class="ttc" id="a00275_html_ae1858c7bcd504b88e0140b21e41c35bf"><div class="ttname"><a href="a00275.html#ae1858c7bcd504b88e0140b21e41c35bf">Euler1DModifiedSolution</a></div><div class="ttdeci">int Euler1DModifiedSolution(double *, double *, int, void *, void *, double)</div><div class="ttdef"><b>Definition:</b> <a href="a00277_source.html#l00023">Euler1DModifiedSolution.c:23</a></div></div>
<div class="ttc" id="a00129_html_a57771c952ec174601addf43e1c0202b2"><div class="ttname"><a href="a00129.html#a57771c952ec174601addf43e1c0202b2">_MODEL_NDIMS_</a></div><div class="ttdeci">#define _MODEL_NDIMS_</div><div class="ttdef"><b>Definition:</b> <a href="a00129_source.html#l00056">euler1d.h:56</a></div></div>
<div class="ttc" id="a00275_html_a765baa9888bf5d1e7ed3580e6df04e17"><div class="ttname"><a href="a00275.html#a765baa9888bf5d1e7ed3580e6df04e17">Euler1DFlux</a></div><div class="ttdeci">int Euler1DFlux(double *, double *, int, void *, double)</div><div class="ttdef"><b>Definition:</b> <a href="a00272_source.html#l00016">Euler1DFlux.c:16</a></div></div>
<div class="ttc" id="a00106_html_a94f9fe27c5af29d137182f895d2da453"><div class="ttname"><a href="a00106.html#a94f9fe27c5af29d137182f895d2da453">HyPar::GetLeftEigenvectors</a></div><div class="ttdeci">int(* GetLeftEigenvectors)(double *, double *, void *, int)</div><div class="ttdef"><b>Definition:</b> <a href="a00125_source.html#l00307">hypar.h:307</a></div></div>
<div class="ttc" id="a00106_html_a5bed0cb9665daad89f4377c4f7609df4"><div class="ttname"><a href="a00106.html#a5bed0cb9665daad89f4377c4f7609df4">HyPar::SplitHyperbolicFlux</a></div><div class="ttdeci">char SplitHyperbolicFlux[_MAX_STRING_SIZE_]</div><div class="ttdef"><b>Definition:</b> <a href="a00125_source.html#l00067">hypar.h:67</a></div></div>
<div class="ttc" id="a00122_html_a51efea86a4d76d1259893f606b776573"><div class="ttname"><a href="a00122.html#a51efea86a4d76d1259893f606b776573">_MAX_STRING_SIZE_</a></div><div class="ttdeci">#define _MAX_STRING_SIZE_</div><div class="ttdef"><b>Definition:</b> <a href="a00122_source.html#l00007">basic.h:7</a></div></div>
<div class="ttc" id="a00106_html_a3324b3053dab0b7d1d361c05ee006a65"><div class="ttname"><a href="a00106.html#a3324b3053dab0b7d1d361c05ee006a65">HyPar::ComputeCFL</a></div><div class="ttdeci">double(* ComputeCFL)(void *, void *, double, double)</div><div class="ttdef"><b>Definition:</b> <a href="a00125_source.html#l00234">hypar.h:234</a></div></div>
<div class="ttc" id="a00129_html_a51e0f9431973e4cf55e6aeee7dab6d83"><div class="ttname"><a href="a00129.html#a51e0f9431973e4cf55e6aeee7dab6d83">_RF_</a></div><div class="ttdeci">#define _RF_</div><div class="ttdef"><b>Definition:</b> <a href="a00129_source.html#l00064">euler1d.h:64</a></div></div>
<div class="ttc" id="a00106_html_abd6886cf9b7ead81e0aaa9ead9aced81"><div class="ttname"><a href="a00106.html#abd6886cf9b7ead81e0aaa9ead9aced81">HyPar::FFunction</a></div><div class="ttdeci">int(* FFunction)(double *, double *, int, void *, double)</div><div class="ttdef"><b>Definition:</b> <a href="a00125_source.html#l00240">hypar.h:240</a></div></div>
<div class="ttc" id="a00106_html_ac195e64afcda3d4ec94d8fdf2b9dcdc8"><div class="ttname"><a href="a00106.html#ac195e64afcda3d4ec94d8fdf2b9dcdc8">HyPar::SFunction</a></div><div class="ttdeci">int(* SFunction)(double *, double *, void *, void *, double)</div><div class="ttdef"><b>Definition:</b> <a href="a00125_source.html#l00278">hypar.h:278</a></div></div>
<div class="ttc" id="a00106_html_a6f5f6b79d3991a3124226d4cc576e475"><div class="ttname"><a href="a00106.html#a6f5f6b79d3991a3124226d4cc576e475">HyPar::PreStep</a></div><div class="ttdeci">int(* PreStep)(double *, void *, void *, double)</div><div class="ttdef"><b>Definition:</b> <a href="a00125_source.html#l00293">hypar.h:293</a></div></div>
<div class="ttc" id="a00275_html_a0c16592ca1938504fff89a566be82a87"><div class="ttname"><a href="a00275.html#a0c16592ca1938504fff89a566be82a87">Euler1DUpwindSWFS</a></div><div class="ttdeci">int Euler1DUpwindSWFS(double *, double *, double *, double *, double *, double *, int, void *, double)</div><div class="ttdef"><b>Definition:</b> <a href="a00281_source.html#l00292">Euler1DUpwind.c:292</a></div></div>
<div class="ttc" id="a00106_html_aafc992b5fa79d5a4036024615d03bce6"><div class="ttname"><a href="a00106.html#aafc992b5fa79d5a4036024615d03bce6">HyPar::ghosts</a></div><div class="ttdeci">int ghosts</div><div class="ttdef"><b>Definition:</b> <a href="a00125_source.html#l00041">hypar.h:41</a></div></div>
<div class="ttc" id="a00106_html_a8b92eb4fb429c9c91d3fec3ad1ce6a88"><div class="ttname"><a href="a00106.html#a8b92eb4fb429c9c91d3fec3ad1ce6a88">HyPar::UpwinddF</a></div><div class="ttdeci">int(* UpwinddF)(double *, double *, double *, double *, double *, double *, int, void *, double)</div><div class="ttdef"><b>Definition:</b> <a href="a00125_source.html#l00262">hypar.h:262</a></div></div>
<div class="ttc" id="a00099_html_afb1265dc9bb8f8c05bd22f88c23d879c"><div class="ttname"><a href="a00099.html#afb1265dc9bb8f8c05bd22f88c23d879c">Euler1D::grav_field</a></div><div class="ttdeci">double * grav_field</div><div class="ttdef"><b>Definition:</b> <a href="a00129_source.html#l00286">euler1d.h:286</a></div></div>
<div class="ttc" id="a00108_html_adad7a6f85831f3ac84d854b6c80aef43"><div class="ttname"><a href="a00108.html#adad7a6f85831f3ac84d854b6c80aef43">MPIVariables::world</a></div><div class="ttdeci">MPI_Comm world</div><div class="ttdef"><b>Definition:</b> <a href="a00108_source.html#l00034">mpivars.h:34</a></div></div>
<div class="ttc" id="a00275_html_a3c64bcea38b974bd6a174b9f6324cf64"><div class="ttname"><a href="a00275.html#a3c64bcea38b974bd6a174b9f6324cf64">Euler1DPreStep</a></div><div class="ttdeci">int Euler1DPreStep(double *, void *, void *, double)</div><div class="ttdef"><b>Definition:</b> <a href="a00278_source.html#l00016">Euler1DPreStep.c:16</a></div></div>
<div class="ttc" id="a00275_html_a9626db6c422f313b9762b0223f1a52da"><div class="ttname"><a href="a00275.html#a9626db6c422f313b9762b0223f1a52da">Euler1DSourceUpwindLLF</a></div><div class="ttdeci">int Euler1DSourceUpwindLLF(double *, double *, double *, double *, int, void *, double)</div><div class="ttdef"><b>Definition:</b> <a href="a00280_source.html#l00021">Euler1DSourceUpwind.c:21</a></div></div>
<div class="ttc" id="a00122_html_ad6ab74942c9de13cf0b4c12eb0d91780"><div class="ttname"><a href="a00122.html#ad6ab74942c9de13cf0b4c12eb0d91780">IERR</a></div><div class="ttdeci">#define IERR</div><div class="ttdef"><b>Definition:</b> <a href="a00122_source.html#l00009">basic.h:9</a></div></div>
<div class="ttc" id="a00106_html_a3687b87fa31b07580aa2ef43089fb010"><div class="ttname"><a href="a00106.html#a3687b87fa31b07580aa2ef43089fb010">HyPar::Upwind</a></div><div class="ttdeci">int(* Upwind)(double *, double *, double *, double *, double *, double *, int, void *, double)</div><div class="ttdef"><b>Definition:</b> <a href="a00125_source.html#l00257">hypar.h:257</a></div></div>
<div class="ttc" id="a00275_html_a96dfe05f0bab236d14c49a97f6f3a9c9"><div class="ttname"><a href="a00275.html#a96dfe05f0bab236d14c49a97f6f3a9c9">Euler1DComputeCFL</a></div><div class="ttdeci">double Euler1DComputeCFL(void *, void *, double, double)</div><div class="ttdef"><b>Definition:</b> <a href="a00270_source.html#l00017">Euler1DComputeCFL.c:17</a></div></div>
<div class="ttc" id="a00275_html_a9f4272feb90b98823419004ad0923446"><div class="ttname"><a href="a00275.html#a9f4272feb90b98823419004ad0923446">Euler1DUpwindLLF</a></div><div class="ttdeci">int Euler1DUpwindLLF(double *, double *, double *, double *, double *, double *, int, void *, double)</div><div class="ttdef"><b>Definition:</b> <a href="a00281_source.html#l00211">Euler1DUpwind.c:211</a></div></div>
<div class="ttc" id="a00275_html_a979f0aa5a88e8c1d32794ccba50bc806"><div class="ttname"><a href="a00275.html#a979f0aa5a88e8c1d32794ccba50bc806">Euler1DLeftEigenvectors</a></div><div class="ttdeci">int Euler1DLeftEigenvectors(double *, double *, void *, int)</div><div class="ttdef"><b>Definition:</b> <a href="a00271_source.html#l00019">Euler1DEigen.c:19</a></div></div>
<div class="ttc" id="a00129_html_ad3395a55a5fde64d6603c7a82d7bf2c7"><div class="ttname"><a href="a00129.html#ad3395a55a5fde64d6603c7a82d7bf2c7">_MODEL_NVARS_</a></div><div class="ttdeci">#define _MODEL_NVARS_</div><div class="ttdef"><b>Definition:</b> <a href="a00129_source.html#l00058">euler1d.h:58</a></div></div>
<div class="ttc" id="a00275_html_a6139f9478a0791ac0a0c0d43faffb378"><div class="ttname"><a href="a00275.html#a6139f9478a0791ac0a0c0d43faffb378">Euler1DRightEigenvectors</a></div><div class="ttdeci">int Euler1DRightEigenvectors(double *, double *, void *, int)</div><div class="ttdef"><b>Definition:</b> <a href="a00271_source.html#l00038">Euler1DEigen.c:38</a></div></div>
<div class="ttc" id="a00106_html_ae8f6d2fd6490d3153cb4133bf183a404"><div class="ttname"><a href="a00106.html#ae8f6d2fd6490d3153cb4133bf183a404">HyPar::nvars</a></div><div class="ttdeci">int nvars</div><div class="ttdef"><b>Definition:</b> <a href="a00125_source.html#l00026">hypar.h:26</a></div></div>
<div class="ttc" id="a00275_html_a52dc5f992bf9d226505d94da0d45176e"><div class="ttname"><a href="a00275.html#a52dc5f992bf9d226505d94da0d45176e">Euler1DSource</a></div><div class="ttdeci">int Euler1DSource(double *, double *, void *, void *, double)</div><div class="ttdef"><b>Definition:</b> <a href="a00279_source.html#l00023">Euler1DSource.c:23</a></div></div>
<div class="ttc" id="a00129_html_a930e301363fd9f0a570d97c8c3dd3ea3"><div class="ttname"><a href="a00129.html#a930e301363fd9f0a570d97c8c3dd3ea3">_SWFS_</a></div><div class="ttdeci">#define _SWFS_</div><div class="ttdef"><b>Definition:</b> <a href="a00129_source.html#l00068">euler1d.h:68</a></div></div>
<div class="ttc" id="a00106_html_aa400371d02f323e03768e5db0d3e599c"><div class="ttname"><a href="a00106.html#aa400371d02f323e03768e5db0d3e599c">HyPar::UFunction</a></div><div class="ttdeci">int(* UFunction)(double *, double *, int, void *, void *, double)</div><div class="ttdef"><b>Definition:</b> <a href="a00125_source.html#l00281">hypar.h:281</a></div></div>
<div class="ttc" id="a00108_html_acd7957559b9206224c7da3cab4f22b27"><div class="ttname"><a href="a00108.html#acd7957559b9206224c7da3cab4f22b27">MPIBroadcast_integer</a></div><div class="ttdeci">int MPIBroadcast_integer(int *, int, int, void *)</div><div class="ttdef"><b>Definition:</b> <a href="a00231_source.html#l00023">MPIBroadcast.c:23</a></div></div>
<div class="ttc" id="a00275_html_a564a6dcdf1979d59610503201e6f2619"><div class="ttname"><a href="a00275.html#a564a6dcdf1979d59610503201e6f2619">Euler1DSourceUpwindRoe</a></div><div class="ttdeci">int Euler1DSourceUpwindRoe(double *, double *, double *, double *, int, void *, double)</div><div class="ttdef"><b>Definition:</b> <a href="a00280_source.html#l00064">Euler1DSourceUpwind.c:64</a></div></div>
<div class="ttc" id="a00108_html_a45dcb265863a65d862bb16222e7e623c"><div class="ttname"><a href="a00108.html#a45dcb265863a65d862bb16222e7e623c">MPIBroadcast_double</a></div><div class="ttdeci">int MPIBroadcast_double(double *, int, int, void *)</div><div class="ttdef"><b>Definition:</b> <a href="a00231_source.html#l00009">MPIBroadcast.c:9</a></div></div>
<div class="ttc" id="a00099_html_acf2a05e3d7005c865c3e4f609cf728f8"><div class="ttname"><a href="a00099.html#acf2a05e3d7005c865c3e4f609cf728f8">Euler1D::SourceUpwind</a></div><div class="ttdeci">int(* SourceUpwind)(double *, double *, double *, double *, int, void *, double)</div><div class="ttdef"><b>Definition:</b> <a href="a00129_source.html#l00298">euler1d.h:298</a></div></div>
<div class="ttc" id="a00106_html_a8c0bbbde58df479b0d991186443dcf1a"><div class="ttname"><a href="a00106.html#a8c0bbbde58df479b0d991186443dcf1a">HyPar::GetRightEigenvectors</a></div><div class="ttdeci">int(* GetRightEigenvectors)(double *, double *, void *, int)</div><div class="ttdef"><b>Definition:</b> <a href="a00125_source.html#l00309">hypar.h:309</a></div></div>
<div class="ttc" id="a00106_html_a38e0371f331cecbe63a77fa03e202afe"><div class="ttname"><a href="a00106.html#a38e0371f331cecbe63a77fa03e202afe">HyPar::dim_local</a></div><div class="ttdeci">int * dim_local</div><div class="ttdef"><b>Definition:</b> <a href="a00125_source.html#l00032">hypar.h:32</a></div></div>
</div><!-- fragment -->
</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_68267d1309a1af8e8297ef4c3efbcdba.html">src</a></li><li class="navelem"><a class="el" href="dir_4f99e73020cfe6ed8a86f0042d0d702a.html">PhysicalModels</a></li><li class="navelem"><a class="el" href="dir_a580acf5b82349c5068c63a2b2fdce4e.html">Euler1D</a></li><li class="navelem"><a class="el" href="a00275.html">Euler1DInitialize.c</a></li>
    <li class="footer">Generated on Fri Nov 3 2017 13:56:24 for HyPar by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.9.1 </li>
  </ul>
</div>
</body>
</html>
