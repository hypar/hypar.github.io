<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>HyPar: include/interpolation.h Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<!-- Generated by Doxygen 1.6.1 -->
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li><a href="main.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="annotated.html"><span>Data&nbsp;Structures</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div class="tabs">
    <ul>
      <li><a href="files.html"><span>File&nbsp;List</span></a></li>
      <li><a href="globals.html"><span>Globals</span></a></li>
    </ul>
  </div>
<h1>include/interpolation.h</h1><a href="a00041.html">Go to the documentation of this file.</a><div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 
<a name="l00007"></a><a class="code" href="a00041.html#a19cc54d502757bfed14b373b443f144c">00007</a> <span class="preprocessor">#define _FIRST_ORDER_UPWIND_    &quot;1&quot;</span>
<a name="l00008"></a>00008 <span class="preprocessor"></span>
<a name="l00009"></a><a class="code" href="a00041.html#a89694dcc7c48314c98b9636759bb8bee">00009</a> <span class="preprocessor">#define _SECOND_ORDER_CENTRAL_  &quot;2&quot;</span>
<a name="l00010"></a>00010 <span class="preprocessor"></span>
<a name="l00011"></a><a class="code" href="a00041.html#a21f7f383e497570fcb71c43f243539d3">00011</a> <span class="preprocessor">#define _THIRD_ORDER_MUSCL_     &quot;muscl3&quot;</span>
<a name="l00012"></a>00012 <span class="preprocessor"></span>
<a name="l00013"></a><a class="code" href="a00041.html#a7bc4a755992e5f68efe365591b7a2c02">00013</a> <span class="preprocessor">#define _FIFTH_ORDER_UPWIND_      &quot;upw5&quot;</span>
<a name="l00014"></a>00014 <span class="preprocessor"></span>
<a name="l00015"></a><a class="code" href="a00041.html#ae832e2314ee85139cec9df4ea82aafa2">00015</a> <span class="preprocessor">#define _FIFTH_ORDER_COMPACT_UPWIND_ &quot;cupw5&quot;</span>
<a name="l00016"></a>00016 <span class="preprocessor"></span>
<a name="l00017"></a><a class="code" href="a00041.html#acfeff1b158131390b7129f4a857b15ff">00017</a> <span class="preprocessor">#define _FIFTH_ORDER_WENO_      &quot;weno5&quot;</span>
<a name="l00018"></a>00018 <span class="preprocessor"></span>
<a name="l00019"></a><a class="code" href="a00041.html#a175a82b8ae2b24c0ba51e1b1dd68c0e5">00019</a> <span class="preprocessor">#define _FIFTH_ORDER_CRWENO_    &quot;crweno5&quot;</span>
<a name="l00020"></a>00020 <span class="preprocessor"></span>
<a name="l00021"></a><a class="code" href="a00041.html#a6d34f5e8aae80a0d2a27ea20368dfef1">00021</a> <span class="preprocessor">#define _FIFTH_ORDER_HCWENO_    &quot;hcweno5&quot;</span>
<a name="l00022"></a>00022 <span class="preprocessor"></span>
<a name="l00023"></a>00023 <span class="comment">/* interpolation type definitions */</span>
<a name="l00024"></a><a class="code" href="a00041.html#aa7752b40155314f9f2c063d4d9d8339d">00024</a> <span class="preprocessor">#define _CHARACTERISTIC_        &quot;characteristic&quot; </span>
<a name="l00025"></a><a class="code" href="a00041.html#ac1f614645aa891fde12c0ce4354de45d">00025</a> <span class="preprocessor">#define _COMPONENTS_            &quot;components&quot;     </span>
<a name="l00027"></a>00027 <span class="preprocessor"></span><span class="comment">/*</span>
<a name="l00028"></a>00028 <span class="comment">  One-dimensional Interpolation Functions:-</span>
<a name="l00029"></a>00029 <span class="comment">    Functions to interpolate the primitive of a function at interfaces from its </span>
<a name="l00030"></a>00030 <span class="comment">    cell-centered values.</span>
<a name="l00031"></a>00031 <span class="comment"></span>
<a name="l00032"></a>00032 <span class="comment">  Arguments:-</span>
<a name="l00033"></a>00033 <span class="comment"></span>
<a name="l00034"></a>00034 <span class="comment">    fI        double*   array of size (N+1) in the interpolation direction; will contain </span>
<a name="l00035"></a>00035 <span class="comment">                        the interpolated interface function primitive </span>
<a name="l00036"></a>00036 <span class="comment">                        (**needs to be allocated by the calling function)</span>
<a name="l00037"></a>00037 <span class="comment">                        (**does not have ghost points))</span>
<a name="l00038"></a>00038 <span class="comment"></span>
<a name="l00039"></a>00039 <span class="comment">    fC        double*   array of size (N+2*ghosts) in the interpolation direction of the </span>
<a name="l00040"></a>00040 <span class="comment">                        cell centered function values</span>
<a name="l00041"></a>00041 <span class="comment">                        (**does have ghost points))</span>
<a name="l00042"></a>00042 <span class="comment"></span>
<a name="l00043"></a>00043 <span class="comment">    u         double*   used only by the characteristic-based interpolation schemes</span>
<a name="l00044"></a>00044 <span class="comment">                        array of size (N+2*ghosts) in the interpolation direction of the</span>
<a name="l00045"></a>00045 <span class="comment">                        cell centered conserved variable (needed to calculate the eigen-</span>
<a name="l00046"></a>00046 <span class="comment">                        decomposition at the interfaces)</span>
<a name="l00047"></a>00047 <span class="comment"></span>
<a name="l00048"></a>00048 <span class="comment">    x         double*   grid point locations along the 1D line on which the interpolation</span>
<a name="l00049"></a>00049 <span class="comment">                        is being carried out</span>
<a name="l00050"></a>00050 <span class="comment">                        array of size (N+2*ghosts) </span>
<a name="l00051"></a>00051 <span class="comment">                        Used only by non-uniform-grid interpolation schemes</span>
<a name="l00052"></a>00052 <span class="comment"></span>
<a name="l00053"></a>00053 <span class="comment">    upw       int       upwind direction for non-central schemes</span>
<a name="l00054"></a>00054 <span class="comment">                        (1 -&gt; left biased, -1 -&gt; right biased)</span>
<a name="l00055"></a>00055 <span class="comment"></span>
<a name="l00056"></a>00056 <span class="comment">    dir       int       direction/dimension along which to carry out interpolation for</span>
<a name="l00057"></a>00057 <span class="comment">                        multi-dimensional domains</span>
<a name="l00058"></a>00058 <span class="comment">                        (eg: 0 for 1D; 0 or 1 for 2D; 0,1 or 2 for 3D)</span>
<a name="l00059"></a>00059 <span class="comment"></span>
<a name="l00060"></a>00060 <span class="comment">    s         void*     object of type depending on the main solver, should have at least</span>
<a name="l00061"></a>00061 <span class="comment">                        the following data:</span>
<a name="l00062"></a>00062 <span class="comment">                        + ghosts    : number of ghosts points in the domain</span>
<a name="l00063"></a>00063 <span class="comment">                        + ndims     : number of dimensions</span>
<a name="l00064"></a>00064 <span class="comment">                        + nvars     : number of variables per grid point</span>
<a name="l00065"></a>00065 <span class="comment">                                      (i.e. size of vector variable being interpolated)</span>
<a name="l00066"></a>00066 <span class="comment">                        + dim_local : local (of this process) dimensions of the domain</span>
<a name="l00067"></a>00067 <span class="comment">                                      (integer array of size ndims, with the number of </span>
<a name="l00068"></a>00068 <span class="comment">                                      points in each dimension as elements)</span>
<a name="l00069"></a>00069 <span class="comment">    m         void*     object containing MPI domain decomposition related variables</span>
<a name="l00070"></a>00070 <span class="comment">                        (this information is used only by compact interpolation schemes)</span>
<a name="l00071"></a>00071 <span class="comment"></span>
<a name="l00072"></a>00072 <span class="comment">    uflag     int       flag to indicate where the flux function or the solution function</span>
<a name="l00073"></a>00073 <span class="comment">                        is being interpolated</span>
<a name="l00074"></a>00074 <span class="comment">                        (1 -&gt; u; 0 -&gt; f(u) )</span>
<a name="l00075"></a>00075 <span class="comment"></span>
<a name="l00076"></a>00076 <span class="comment">    Notes:</span>
<a name="l00077"></a>00077 <span class="comment">      + arrangement of points along the direction of interpolation is</span>
<a name="l00078"></a>00078 <span class="comment"></span>
<a name="l00079"></a>00079 <span class="comment">              |&lt;--ghosts--&gt;|0 1 2 ..(interior).. N-1|&lt;--ghosts--&gt;|</span>
<a name="l00080"></a>00080 <span class="comment"></span>
<a name="l00081"></a>00081 <span class="comment">      + number of interfaces are one more than number of interior points</span>
<a name="l00082"></a>00082 <span class="comment">      + interface i lies between grid points i-1+ghosts and i+ghosts</span>
<a name="l00083"></a>00083 <span class="comment"></span>
<a name="l00084"></a>00084 <span class="comment">            0   1   2   .....        ....          N-3 N-2 N-1</span>
<a name="l00085"></a>00085 <span class="comment">          | x | x | x | x | x | x | x | x | x | x | x | x | x |</span>
<a name="l00086"></a>00086 <span class="comment">          0   1   2   ...             ...    ...     N-2 N-1  N </span>
<a name="l00087"></a>00087 <span class="comment"></span>
<a name="l00088"></a>00088 <span class="comment">    Returns 0 on normal execution, non-zero on error.</span>
<a name="l00089"></a>00089 <span class="comment">*/</span>
<a name="l00090"></a>00090 
<a name="l00091"></a>00091 <span class="comment">/* functions to interpolate the first primitive in a component-wise way</span>
<a name="l00092"></a>00092 <span class="comment">   (for conservative discretization of the 1st derivative) on a uniform grid */</span>
<a name="l00094"></a>00094 <span class="keywordtype">int</span> <a class="code" href="a00041.html#a0a067c9c4745556845b9bcb7f049b59b" title="1st order upwind reconstruction (component-wise) on a uniform grid">Interp1PrimFirstOrderUpwind</a>           (<span class="keywordtype">double</span>*,<span class="keywordtype">double</span>*,<span class="keywordtype">double</span>*,<span class="keywordtype">double</span>*,<span class="keywordtype">int</span>,<span class="keywordtype">int</span>,<span class="keywordtype">void</span>*,<span class="keywordtype">void</span>*,<span class="keywordtype">int</span>);
<a name="l00096"></a>00096 <span class="keywordtype">int</span> <a class="code" href="a00041.html#a697d5c94aa331054c5286492e7fa39c7" title="2nd order central reconstruction (component-wise) on a uniform grid">Interp1PrimSecondOrderCentral</a>         (<span class="keywordtype">double</span>*,<span class="keywordtype">double</span>*,<span class="keywordtype">double</span>*,<span class="keywordtype">double</span>*,<span class="keywordtype">int</span>,<span class="keywordtype">int</span>,<span class="keywordtype">void</span>*,<span class="keywordtype">void</span>*,<span class="keywordtype">int</span>);
<a name="l00098"></a>00098 <span class="keywordtype">int</span> <a class="code" href="a00041.html#ae7eb6a81a164ca0fa2ace3cab2697847" title="3rd order MUSCL scheme with Koren&amp;#39;s limiter (component-wise) on a uniform grid...">Interp1PrimThirdOrderMUSCL</a>            (<span class="keywordtype">double</span>*,<span class="keywordtype">double</span>*,<span class="keywordtype">double</span>*,<span class="keywordtype">double</span>*,<span class="keywordtype">int</span>,<span class="keywordtype">int</span>,<span class="keywordtype">void</span>*,<span class="keywordtype">void</span>*,<span class="keywordtype">int</span>);
<a name="l00100"></a>00100 <span class="keywordtype">int</span> <a class="code" href="a00041.html#aea7c973ffe0c37bca0703c1bf6175aaa" title="5th order upwind reconstruction (component-wise) on a uniform grid">Interp1PrimFifthOrderUpwind</a>           (<span class="keywordtype">double</span>*,<span class="keywordtype">double</span>*,<span class="keywordtype">double</span>*,<span class="keywordtype">double</span>*,<span class="keywordtype">int</span>,<span class="keywordtype">int</span>,<span class="keywordtype">void</span>*,<span class="keywordtype">void</span>*,<span class="keywordtype">int</span>);
<a name="l00102"></a>00102 <span class="keywordtype">int</span> <a class="code" href="a00041.html#a3ac2a77b9fa5a50499c285e49cf91344" title="5th order compact upwind reconstruction (component-wise) on a uniform grid">Interp1PrimFifthOrderCompactUpwind</a>    (<span class="keywordtype">double</span>*,<span class="keywordtype">double</span>*,<span class="keywordtype">double</span>*,<span class="keywordtype">double</span>*,<span class="keywordtype">int</span>,<span class="keywordtype">int</span>,<span class="keywordtype">void</span>*,<span class="keywordtype">void</span>*,<span class="keywordtype">int</span>);
<a name="l00104"></a>00104 <span class="keywordtype">int</span> <a class="code" href="a00041.html#af2195885ad055989a1b2b11655843343" title="5th order WENO reconstruction (component-wise) on a uniform grid">Interp1PrimFifthOrderWENO</a>             (<span class="keywordtype">double</span>*,<span class="keywordtype">double</span>*,<span class="keywordtype">double</span>*,<span class="keywordtype">double</span>*,<span class="keywordtype">int</span>,<span class="keywordtype">int</span>,<span class="keywordtype">void</span>*,<span class="keywordtype">void</span>*,<span class="keywordtype">int</span>);
<a name="l00106"></a>00106 <span class="keywordtype">int</span> <a class="code" href="a00041.html#a33b1e24c12129941b0027a83c543a654" title="5th order CRWENO reconstruction (component-wise) on a uniform grid">Interp1PrimFifthOrderCRWENO</a>           (<span class="keywordtype">double</span>*,<span class="keywordtype">double</span>*,<span class="keywordtype">double</span>*,<span class="keywordtype">double</span>*,<span class="keywordtype">int</span>,<span class="keywordtype">int</span>,<span class="keywordtype">void</span>*,<span class="keywordtype">void</span>*,<span class="keywordtype">int</span>);
<a name="l00108"></a>00108 <span class="keywordtype">int</span> <a class="code" href="a00041.html#ad9c611137cfce1c622c2e9838fb523c8" title="5th order hybrid compact-WENO reconstruction (component-wise) on a uniform grid">Interp1PrimFifthOrderHCWENO</a>           (<span class="keywordtype">double</span>*,<span class="keywordtype">double</span>*,<span class="keywordtype">double</span>*,<span class="keywordtype">double</span>*,<span class="keywordtype">int</span>,<span class="keywordtype">int</span>,<span class="keywordtype">void</span>*,<span class="keywordtype">void</span>*,<span class="keywordtype">int</span>);
<a name="l00109"></a>00109 
<a name="l00110"></a>00110 <span class="comment">/* functions to interpolate the first primitive in a characteristic-based way</span>
<a name="l00111"></a>00111 <span class="comment">   (for conservative discretization of the 1st derivative) on a uniform grid */</span>
<a name="l00113"></a>00113 <span class="keywordtype">int</span> <a class="code" href="a00041.html#a759e07ba8a484c2c6971fc7c6a81a95a" title="1st order upwind reconstruction (characteristic-based) on a uniform grid">Interp1PrimFirstOrderUpwindChar</a>       (<span class="keywordtype">double</span>*,<span class="keywordtype">double</span>*,<span class="keywordtype">double</span>*,<span class="keywordtype">double</span>*,<span class="keywordtype">int</span>,<span class="keywordtype">int</span>,<span class="keywordtype">void</span>*,<span class="keywordtype">void</span>*,<span class="keywordtype">int</span>);
<a name="l00115"></a>00115 <span class="keywordtype">int</span> <a class="code" href="a00041.html#a963c82116a2a1d6084af3d519b61b896" title="2nd order central reconstruction (characteristic-based) on a uniform grid">Interp1PrimSecondOrderCentralChar</a>     (<span class="keywordtype">double</span>*,<span class="keywordtype">double</span>*,<span class="keywordtype">double</span>*,<span class="keywordtype">double</span>*,<span class="keywordtype">int</span>,<span class="keywordtype">int</span>,<span class="keywordtype">void</span>*,<span class="keywordtype">void</span>*,<span class="keywordtype">int</span>);
<a name="l00117"></a>00117 <span class="keywordtype">int</span> <a class="code" href="a00041.html#a985d08c4fb9bcb71875c697f9e00d6eb" title="3rd order MUSCL scheme with Koren&amp;#39;s limiter (characteristic-based) on a uniform...">Interp1PrimThirdOrderMUSCLChar</a>        (<span class="keywordtype">double</span>*,<span class="keywordtype">double</span>*,<span class="keywordtype">double</span>*,<span class="keywordtype">double</span>*,<span class="keywordtype">int</span>,<span class="keywordtype">int</span>,<span class="keywordtype">void</span>*,<span class="keywordtype">void</span>*,<span class="keywordtype">int</span>);
<a name="l00119"></a>00119 <span class="keywordtype">int</span> <a class="code" href="a00041.html#ade9ece6e934d70cdf29090494440f505" title="5th order upwind reconstruction (characteristic-based) on a uniform grid">Interp1PrimFifthOrderUpwindChar</a>       (<span class="keywordtype">double</span>*,<span class="keywordtype">double</span>*,<span class="keywordtype">double</span>*,<span class="keywordtype">double</span>*,<span class="keywordtype">int</span>,<span class="keywordtype">int</span>,<span class="keywordtype">void</span>*,<span class="keywordtype">void</span>*,<span class="keywordtype">int</span>);
<a name="l00121"></a>00121 <span class="keywordtype">int</span> <a class="code" href="a00041.html#a28b8d3ce17676cec19de4f91f989042d" title="5th order compact upwind reconstruction (characteristic-based) on a uniform grid">Interp1PrimFifthOrderCompactUpwindChar</a>(<span class="keywordtype">double</span>*,<span class="keywordtype">double</span>*,<span class="keywordtype">double</span>*,<span class="keywordtype">double</span>*,<span class="keywordtype">int</span>,<span class="keywordtype">int</span>,<span class="keywordtype">void</span>*,<span class="keywordtype">void</span>*,<span class="keywordtype">int</span>);
<a name="l00123"></a>00123 <span class="keywordtype">int</span> <a class="code" href="a00041.html#abf3b032fdc8c0e84b86909db9e0b93c3" title="5th order WENO reconstruction (characteristic-based) on a uniform grid">Interp1PrimFifthOrderWENOChar</a>         (<span class="keywordtype">double</span>*,<span class="keywordtype">double</span>*,<span class="keywordtype">double</span>*,<span class="keywordtype">double</span>*,<span class="keywordtype">int</span>,<span class="keywordtype">int</span>,<span class="keywordtype">void</span>*,<span class="keywordtype">void</span>*,<span class="keywordtype">int</span>);
<a name="l00125"></a>00125 <span class="keywordtype">int</span> <a class="code" href="a00041.html#ae2b27971cc952cf3b4959128bef6174b" title="5th order CRWENO reconstruction (characteristic-based) on a uniform grid">Interp1PrimFifthOrderCRWENOChar</a>       (<span class="keywordtype">double</span>*,<span class="keywordtype">double</span>*,<span class="keywordtype">double</span>*,<span class="keywordtype">double</span>*,<span class="keywordtype">int</span>,<span class="keywordtype">int</span>,<span class="keywordtype">void</span>*,<span class="keywordtype">void</span>*,<span class="keywordtype">int</span>);
<a name="l00127"></a>00127 <span class="keywordtype">int</span> <a class="code" href="a00041.html#a91fbe118c8c01fe1d5efa3cea4930589" title="5th order hybrid compact-WENO reconstruction (characteristic-based) on a uniform...">Interp1PrimFifthOrderHCWENOChar</a>       (<span class="keywordtype">double</span>*,<span class="keywordtype">double</span>*,<span class="keywordtype">double</span>*,<span class="keywordtype">double</span>*,<span class="keywordtype">int</span>,<span class="keywordtype">int</span>,<span class="keywordtype">void</span>*,<span class="keywordtype">void</span>*,<span class="keywordtype">int</span>);
<a name="l00128"></a>00128 
<a name="l00129"></a>00129 <span class="comment">/* functions to interpolate the second primitive </span>
<a name="l00130"></a>00130 <span class="comment">   (for conservative discretization of the 2nd derivative) */</span>
<a name="l00132"></a>00132 <span class="keywordtype">int</span> <a class="code" href="a00041.html#ae8bfe856abd743f5af925dc03e708ee3" title="2nd order component-wise interpolation of the 2nd primitive on a uniform grid">Interp2PrimSecondOrder</a>  (<span class="keywordtype">double</span>*,<span class="keywordtype">double</span>*,<span class="keywordtype">int</span>,<span class="keywordtype">void</span>*,<span class="keywordtype">void</span>*);
<a name="l00133"></a>00133 
<a name="l00135"></a>00135 <span class="keywordtype">int</span> <a class="code" href="a00041.html#a249ae68fb7394160a7a709220b684acb">InterpSetLimiterVar</a>(<span class="keywordtype">double</span>*,<span class="keywordtype">double</span>*,<span class="keywordtype">double</span>*,<span class="keywordtype">int</span>,<span class="keywordtype">void</span>*,<span class="keywordtype">void</span>*);
<a name="l00136"></a>00136 
<a name="l00145"></a><a class="code" href="a00020.html">00145</a> <span class="keyword">typedef</span> <span class="keyword">struct </span>paramters_muscl {
<a name="l00146"></a><a class="code" href="a00020.html#a974b448c3d0a13d483d36ef15de369b5">00146</a>   <span class="keywordtype">double</span> eps; 
<a name="l00147"></a>00147 } <a class="code" href="a00020.html" title="Structure of variables/parameters needed by the MUSCL scheme.">MUSCLParameters</a>;
<a name="l00148"></a>00148 <span class="keywordtype">int</span> <a class="code" href="a00041.html#a22e0ae19117192cae9978a7a741d15a5">MUSCLInitialize</a>(<span class="keywordtype">void</span>*,<span class="keywordtype">void</span>*);
<a name="l00149"></a>00149 
<a name="l00158"></a><a class="code" href="a00030.html">00158</a> <span class="keyword">typedef</span> <span class="keyword">struct </span>parameters_weno {
<a name="l00159"></a><a class="code" href="a00030.html#af370a2df117483b6f752da8889a89bb0">00159</a>   <span class="keywordtype">int</span>     mapped;           
<a name="l00160"></a><a class="code" href="a00030.html#af3c02b1dce05b28870fa1994c40cd1f2">00160</a>   <span class="keywordtype">int</span>     borges;           
<a name="l00161"></a><a class="code" href="a00030.html#a8470a9f95ece04985a5031e745042b7e">00161</a>   <span class="keywordtype">int</span>     yc;               
<a name="l00162"></a><a class="code" href="a00030.html#a20e793c98bd33aef1cbbafcf3df48a55">00162</a>   <span class="keywordtype">int</span>     no_limiting;  
<a name="l00163"></a><a class="code" href="a00030.html#a974b448c3d0a13d483d36ef15de369b5">00163</a>   <span class="keywordtype">double</span>  eps;            
<a name="l00164"></a><a class="code" href="a00030.html#aace2d484b0e3651abd108f04803d316c">00164</a>   <span class="keywordtype">double</span>    p;                
<a name="l00165"></a><a class="code" href="a00030.html#a2687e4b3cb5da7dbd00e565343f66c6c">00165</a>   <span class="keywordtype">double</span>  tol;          
<a name="l00167"></a>00167   <span class="comment">/* hybrid compact-WENO scheme related parameters </span>
<a name="l00168"></a>00168 <span class="comment">   * **References**: </span>
<a name="l00169"></a>00169 <span class="comment">   * + http://dx.doi.org/10.1006/jcph.2002.7021</span>
<a name="l00170"></a>00170 <span class="comment">   * + http://dx.doi.org/10.1016/j.jcp.2003.07.006</span>
<a name="l00171"></a>00171 <span class="comment">  */</span>
<a name="l00172"></a><a class="code" href="a00030.html#adf147b14a64e08756e9e30868e943da8">00172</a>   <span class="keywordtype">double</span>  rc, 
<a name="l00173"></a>00173           xi; 
<a name="l00175"></a>00175   <span class="comment">/* Arrays to save the WENO weights */</span>
<a name="l00176"></a><a class="code" href="a00030.html#aabd83eb3f8a7e3bb9f79a4a943bbd508">00176</a>   <span class="keywordtype">double</span> *w1, 
<a name="l00177"></a>00177          *w2, 
<a name="l00178"></a>00178          *w3;
<a name="l00179"></a>00179   <span class="comment">/* size and offset for the WENO weights arrays */</span>
<a name="l00180"></a><a class="code" href="a00030.html#a439227feff9d7f55384e8780cfc2eb82">00180</a>   <span class="keywordtype">int</span> *offset , 
<a name="l00181"></a>00181       size ;
<a name="l00182"></a>00182 
<a name="l00183"></a>00183 } <a class="code" href="a00030.html" title="Structure of variables/parameters needed by the WENO-type scheme.">WENOParameters</a>;
<a name="l00185"></a>00185 <span class="keywordtype">int</span> <a class="code" href="a00041.html#aecbe557b2ccc254cdbbd312fc91717be">WENOInitialize</a>(<span class="keywordtype">void</span>*,<span class="keywordtype">void</span>*,<span class="keywordtype">char</span>*,<span class="keywordtype">char</span>*); 
<a name="l00187"></a>00187 <span class="keywordtype">int</span> <a class="code" href="a00041.html#a37dd034f5e9eb221bd3fd51cc8d1b0f4">WENOCleanup</a>(<span class="keywordtype">void</span>*);
<a name="l00188"></a>00188 
<a name="l00189"></a>00189 <span class="comment">/* define optimal weights */</span>
<a name="l00191"></a><a class="code" href="a00041.html#a248926a53714d93eb513eb0faea501ce">00191</a> <span class="preprocessor">#define   _WENO_OPTIMAL_WEIGHT_1_   0.1</span>
<a name="l00192"></a>00192 <span class="preprocessor"></span>
<a name="l00193"></a><a class="code" href="a00041.html#a6670756d96f1f523cee16eed544d053d">00193</a> <span class="preprocessor">#define   _WENO_OPTIMAL_WEIGHT_2_   0.6</span>
<a name="l00194"></a>00194 <span class="preprocessor"></span>
<a name="l00195"></a><a class="code" href="a00041.html#a1040ac7b0b8a805ee3888c9534dc0933">00195</a> <span class="preprocessor">#define   _WENO_OPTIMAL_WEIGHT_3_   0.3</span>
<a name="l00196"></a>00196 <span class="preprocessor"></span>
<a name="l00197"></a><a class="code" href="a00041.html#a231fd73854e7a1db484a2d3ef05d3325">00197</a> <span class="preprocessor">#define   _CRWENO_OPTIMAL_WEIGHT_1_ 0.2</span>
<a name="l00198"></a>00198 <span class="preprocessor"></span>
<a name="l00199"></a><a class="code" href="a00041.html#ac6c34db3ed9438f08e64dec775065b0a">00199</a> <span class="preprocessor">#define   _CRWENO_OPTIMAL_WEIGHT_2_ 0.5</span>
<a name="l00200"></a>00200 <span class="preprocessor"></span>
<a name="l00201"></a><a class="code" href="a00041.html#a997c514e872a0a80e59ad19ef3d2746a">00201</a> <span class="preprocessor">#define   _CRWENO_OPTIMAL_WEIGHT_3_ 0.3</span>
<a name="l00202"></a>00202 <span class="preprocessor"></span>
<a name="l00228"></a><a class="code" href="a00041.html#a9584e7fc4d65e4dea714697c890cba92">00228</a> <span class="preprocessor">#define _WENOWeights_v_JS_(w1,w2,w3,c1,c2,c3,m3,m2,m1,p1,p2,weno,N) \</span>
<a name="l00229"></a>00229 <span class="preprocessor">  { \</span>
<a name="l00230"></a>00230 <span class="preprocessor">    int idx; \</span>
<a name="l00231"></a>00231 <span class="preprocessor">    </span><span class="comment">/* calculate smoothness indicators and the WENO weights */</span>\
<a name="l00232"></a>00232     double b1, b2, b3, a1, a2, a3, a_sum_inv; \
<a name="l00233"></a>00233     for (idx=0; idx&lt;N; idx++) { \
<a name="l00234"></a>00234       b1 = thirteen_by_twelve*(m3[idx]-2*m2[idx]+m1[idx])*(m3[idx]-2*m2[idx]+m1[idx]) \
<a name="l00235"></a>00235            + one_fourth*(m3[idx]-4*m2[idx]+3*m1[idx])*(m3[idx]-4*m2[idx]+3*m1[idx]);  \
<a name="l00236"></a>00236       a1 = c1 / ( (b1+weno-&gt;eps) * (b1+weno-&gt;eps) );  \
<a name="l00237"></a>00237       b2 = thirteen_by_twelve*(m2[idx]-2*m1[idx]+p1[idx])*(m2[idx]-2*m1[idx]+p1[idx]) \
<a name="l00238"></a>00238            + one_fourth*(m2[idx]-p1[idx])*(m2[idx]-p1[idx]);                \
<a name="l00239"></a>00239       a2 = c2 / ( (b2+weno-&gt;eps) * (b2+weno-&gt;eps) );  \
<a name="l00240"></a>00240       b3 = thirteen_by_twelve*(m1[idx]-2*p1[idx]+p2[idx])*(m1[idx]-2*p1[idx]+p2[idx]) \
<a name="l00241"></a>00241            + one_fourth*(3*m1[idx]-4*p1[idx]+p2[idx])*(3*m1[idx]-4*p1[idx]+p2[idx]);  \
<a name="l00242"></a>00242       a3 = c3 / ( (b3+weno-&gt;eps) * (b3+weno-&gt;eps) );  \
<a name="l00243"></a>00243       a_sum_inv = 1.0 / (a1 + a2 + a3); \
<a name="l00244"></a>00244       w1[idx] = a1 * a_sum_inv; \
<a name="l00245"></a>00245       w2[idx] = a2 * a_sum_inv; \
<a name="l00246"></a>00246       w3[idx] = a3 * a_sum_inv; \
<a name="l00247"></a>00247     } \
<a name="l00248"></a>00248   }
<a name="l00249"></a>00249 
<a name="l00277"></a><a class="code" href="a00041.html#a094028d92064eae70f8f31dd4332e547">00277</a> <span class="preprocessor">#define _WENOWeights_v_M_(w1,w2,w3,c1,c2,c3,m3,m2,m1,p1,p2,weno,N) \</span>
<a name="l00278"></a>00278 <span class="preprocessor">  { \</span>
<a name="l00279"></a>00279 <span class="preprocessor">    int idx; \</span>
<a name="l00280"></a>00280 <span class="preprocessor">    </span><span class="comment">/* calculate smoothness indicators and the WENO weights */</span>\
<a name="l00281"></a>00281     double b1, b2, b3, a1, a2, a3, a_sum_inv; \
<a name="l00282"></a>00282     for (idx=0; idx&lt;N; idx++) { \
<a name="l00283"></a>00283       b1 = thirteen_by_twelve*(m3[idx]-2*m2[idx]+m1[idx])*(m3[idx]-2*m2[idx]+m1[idx]) \
<a name="l00284"></a>00284            + one_fourth*(m3[idx]-4*m2[idx]+3*m1[idx])*(m3[idx]-4*m2[idx]+3*m1[idx]);  \
<a name="l00285"></a>00285       a1 = c1 / ( (b1+weno-&gt;eps) * (b1+weno-&gt;eps) );  \
<a name="l00286"></a>00286       b2 = thirteen_by_twelve*(m2[idx]-2*m1[idx]+p1[idx])*(m2[idx]-2*m1[idx]+p1[idx]) \
<a name="l00287"></a>00287            + one_fourth*(m2[idx]-p1[idx])*(m2[idx]-p1[idx]);                \
<a name="l00288"></a>00288       a2 = c2 / ( (b2+weno-&gt;eps) * (b2+weno-&gt;eps) );  \
<a name="l00289"></a>00289       b3 = thirteen_by_twelve*(m1[idx]-2*p1[idx]+p2[idx])*(m1[idx]-2*p1[idx]+p2[idx]) \
<a name="l00290"></a>00290            + one_fourth*(3*m1[idx]-4*p1[idx]+p2[idx])*(3*m1[idx]-4*p1[idx]+p2[idx]);  \
<a name="l00291"></a>00291       a3 = c3 / ( (b3+weno-&gt;eps) * (b3+weno-&gt;eps) );  \
<a name="l00292"></a>00292       a_sum_inv = 1.0 / (a1 + a2 + a3); \
<a name="l00293"></a>00293       w1[idx] = a1 * a_sum_inv; \
<a name="l00294"></a>00294       w2[idx] = a2 * a_sum_inv; \
<a name="l00295"></a>00295       w3[idx] = a3 * a_sum_inv; \
<a name="l00296"></a>00296       a1 = w1[idx] * (c1 + c1*c1 - 3*c1*w1[idx] + w1[idx]*w1[idx]) / (c1*c1 + w1[idx]*(1.0-2.0*c1)); \
<a name="l00297"></a>00297       a2 = w2[idx] * (c2 + c2*c2 - 3*c2*w2[idx] + w2[idx]*w2[idx]) / (c2*c2 + w2[idx]*(1.0-2.0*c2)); \
<a name="l00298"></a>00298       a3 = w3[idx] * (c3 + c3*c3 - 3*c3*w3[idx] + w3[idx]*w3[idx]) / (c3*c3 + w3[idx]*(1.0-2.0*c3)); \
<a name="l00299"></a>00299       a_sum_inv = 1.0 / (a1 + a2 + a3); \
<a name="l00300"></a>00300       w1[idx] = a1 * a_sum_inv; \
<a name="l00301"></a>00301       w2[idx] = a2 * a_sum_inv; \
<a name="l00302"></a>00302       w3[idx] = a3 * a_sum_inv; \
<a name="l00303"></a>00303     } \
<a name="l00304"></a>00304   }
<a name="l00305"></a>00305 
<a name="l00336"></a><a class="code" href="a00041.html#a1203c5f21fa26563cf62429e09db8646">00336</a> <span class="preprocessor">#define _WENOWeights_v_Z_(w1,w2,w3,c1,c2,c3,m3,m2,m1,p1,p2,weno,N) \</span>
<a name="l00337"></a>00337 <span class="preprocessor">  { \</span>
<a name="l00338"></a>00338 <span class="preprocessor">    int idx; \</span>
<a name="l00339"></a>00339 <span class="preprocessor">    </span><span class="comment">/* calculate smoothness indicators and the WENO weights */</span>\
<a name="l00340"></a>00340     double b1, b2, b3, a1, a2, a3, a_sum_inv, tau; \
<a name="l00341"></a>00341     for (idx=0; idx&lt;N; idx++) { \
<a name="l00342"></a>00342       b1 = thirteen_by_twelve*(m3[idx]-2*m2[idx]+m1[idx])*(m3[idx]-2*m2[idx]+m1[idx]) \
<a name="l00343"></a>00343            + one_fourth*(m3[idx]-4*m2[idx]+3*m1[idx])*(m3[idx]-4*m2[idx]+3*m1[idx]);  \
<a name="l00344"></a>00344       b2 = thirteen_by_twelve*(m2[idx]-2*m1[idx]+p1[idx])*(m2[idx]-2*m1[idx]+p1[idx]) \
<a name="l00345"></a>00345            + one_fourth*(m2[idx]-p1[idx])*(m2[idx]-p1[idx]);                \
<a name="l00346"></a>00346       b3 = thirteen_by_twelve*(m1[idx]-2*p1[idx]+p2[idx])*(m1[idx]-2*p1[idx]+p2[idx]) \
<a name="l00347"></a>00347            + one_fourth*(3*m1[idx]-4*p1[idx]+p2[idx])*(3*m1[idx]-4*p1[idx]+p2[idx]);  \
<a name="l00348"></a>00348       tau = absolute(b3 - b1);  \
<a name="l00349"></a>00349       a1 = c1 * (1.0 + (tau/(b1+weno-&gt;eps)) * (tau/(b1+weno-&gt;eps)) );  \
<a name="l00350"></a>00350       a2 = c2 * (1.0 + (tau/(b2+weno-&gt;eps)) * (tau/(b2+weno-&gt;eps)) );  \
<a name="l00351"></a>00351       a3 = c3 * (1.0 + (tau/(b3+weno-&gt;eps)) * (tau/(b3+weno-&gt;eps)) );  \
<a name="l00352"></a>00352       a_sum_inv = 1.0 / (a1 + a2 + a3); \
<a name="l00353"></a>00353       w1[idx] = a1 * a_sum_inv; \
<a name="l00354"></a>00354       w2[idx] = a2 * a_sum_inv; \
<a name="l00355"></a>00355       w3[idx] = a3 * a_sum_inv; \
<a name="l00356"></a>00356     } \
<a name="l00357"></a>00357   }
<a name="l00358"></a>00358 
<a name="l00389"></a><a class="code" href="a00041.html#ad98f4bd3af977c9a0bc686ba4e6bb15e">00389</a> <span class="preprocessor">#define _WENOWeights_v_YC_(w1,w2,w3,c1,c2,c3,m3,m2,m1,p1,p2,weno,N) \</span>
<a name="l00390"></a>00390 <span class="preprocessor">  { \</span>
<a name="l00391"></a>00391 <span class="preprocessor">    int idx; \</span>
<a name="l00392"></a>00392 <span class="preprocessor">    </span><span class="comment">/* calculate smoothness indicators and the WENO weights */</span>\
<a name="l00393"></a>00393     double b1, b2, b3, a1, a2, a3, a_sum_inv, tau; \
<a name="l00394"></a>00394     for (idx=0; idx&lt;N; idx++) { \
<a name="l00395"></a>00395       b1 = thirteen_by_twelve*(m3[idx]-2*m2[idx]+m1[idx])*(m3[idx]-2*m2[idx]+m1[idx]) \
<a name="l00396"></a>00396            + one_fourth*(m3[idx]-4*m2[idx]+3*m1[idx])*(m3[idx]-4*m2[idx]+3*m1[idx]);  \
<a name="l00397"></a>00397       b2 = thirteen_by_twelve*(m2[idx]-2*m1[idx]+p1[idx])*(m2[idx]-2*m1[idx]+p1[idx]) \
<a name="l00398"></a>00398            + one_fourth*(m2[idx]-p1[idx])*(m2[idx]-p1[idx]);                \
<a name="l00399"></a>00399       b3 = thirteen_by_twelve*(m1[idx]-2*p1[idx]+p2[idx])*(m1[idx]-2*p1[idx]+p2[idx]) \
<a name="l00400"></a>00400            + one_fourth*(3*m1[idx]-4*p1[idx]+p2[idx])*(3*m1[idx]-4*p1[idx]+p2[idx]);  \
<a name="l00401"></a>00401       tau = (m3[idx]-4*m2[idx]+6*m1[idx]-4*p1[idx]+p2[idx])*(m3[idx]-4*m2[idx]+6*m1[idx]-4*p1[idx]+p2[idx]);  \
<a name="l00402"></a>00402       a1 = c1 * (1.0 + (tau/(b1+weno-&gt;eps)) * (tau/(b1+weno-&gt;eps)) );  \
<a name="l00403"></a>00403       a2 = c2 * (1.0 + (tau/(b2+weno-&gt;eps)) * (tau/(b2+weno-&gt;eps)) );  \
<a name="l00404"></a>00404       a3 = c3 * (1.0 + (tau/(b3+weno-&gt;eps)) * (tau/(b3+weno-&gt;eps)) );  \
<a name="l00405"></a>00405       a_sum_inv = 1.0 / (a1 + a2 + a3); \
<a name="l00406"></a>00406       w1[idx] = a1 * a_sum_inv; \
<a name="l00407"></a>00407       w2[idx] = a2 * a_sum_inv; \
<a name="l00408"></a>00408       w3[idx] = a3 * a_sum_inv; \
<a name="l00409"></a>00409     } \
<a name="l00410"></a>00410   }
<a name="l00411"></a>00411 
<a name="l00420"></a><a class="code" href="a00003.html">00420</a> <span class="keyword">typedef</span> <span class="keyword">struct </span>compact_scheme {
<a name="l00421"></a>00421 
<a name="l00422"></a><a class="code" href="a00003.html#ac06de847603f5cfaec085f6fe500f3c8">00422</a>   <span class="keywordtype">double</span> *A, 
<a name="l00423"></a>00423          *B, 
<a name="l00424"></a>00424          *C, 
<a name="l00425"></a>00425          *R;
<a name="l00426"></a>00426   <span class="comment">/* CRWENO scheme: buffer arrays for sending and receiving data */</span>
<a name="l00427"></a><a class="code" href="a00003.html#aba3b15034da676474db917f9f5533085">00427</a>   <span class="keywordtype">double</span> *sendbuf, 
<a name="l00428"></a>00428          *recvbuf; 
<a name="l00430"></a>00430 } <a class="code" href="a00003.html" title="Structure of variables/parameters needed by the compact schemes.">CompactScheme</a>;
<a name="l00432"></a>00432 <span class="keywordtype">int</span> <a class="code" href="a00041.html#af255a582e14c5820cf12f9f95b4e28fd">CompactSchemeInitialize</a>(<span class="keywordtype">void</span>*,<span class="keywordtype">void</span>*,<span class="keywordtype">char</span>*); 
<a name="l00434"></a>00434 <span class="keywordtype">int</span> <a class="code" href="a00041.html#acfaa225472f09e2ade88945e909d5893">CompactSchemeCleanup</a>(<span class="keywordtype">void</span>*);
</pre></div></div>
<!-- Start of StatCounter Code for Default Guide -->
<script type="text/javascript">
var sc_project=10897352; 
var sc_invisible=1; 
var sc_security="83042f57"; 
var scJsHost = (("https:" == document.location.protocol) ?
"https://secure." : "http://www.");
document.write("<sc"+"ript type='text/javascript' src='" +
scJsHost+
"statcounter.com/counter/counter.js'></"+"script>");
</script>
<noscript><div class="statcounter"><a title="website
statistics" href="http://statcounter.com/"
target="_blank"><img class="statcounter"
src="//c.statcounter.com/10897352/0/83042f57/1/"
alt="website statistics"></a></div></noscript>
<!-- End of StatCounter Code for Default Guide -->
