<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>HyPar: include/physicalmodels/euler1d.h File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<!-- Generated by Doxygen 1.6.1 -->
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li><a href="main.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="annotated.html"><span>Data&nbsp;Structures</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div class="tabs">
    <ul>
      <li><a href="files.html"><span>File&nbsp;List</span></a></li>
      <li><a href="globals.html"><span>Globals</span></a></li>
    </ul>
  </div>
</div>
<div class="contents">
<h1>include/physicalmodels/euler1d.h File Reference</h1>
<p>1D Euler Equations (inviscid, compressible flows)  
<a href="#_details">More...</a></p>
<code>#include &lt;<a class="el" href="a00036_source.html">basic.h</a>&gt;</code><br/>
<code>#include &lt;math.h&gt;</code><br/>
<code>#include &lt;<a class="el" href="a00044_source.html">matops.h</a>&gt;</code><br/>

<p><a href="a00047_source.html">Go to the source code of this file.</a></p>
<table border="0" cellpadding="0" cellspacing="0">
<tr><td colspan="2"><h2>Data Structures</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">struct &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00005.html">Euler1D</a></td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Structure containing variables and parameters specific to the 1D Euler equations. This structure contains the physical parameters, variables, and function pointers specific to the 1D Euler equations.  <a href="a00005.html#_details">More...</a><br/></td></tr>
<tr><td colspan="2"><h2>Defines</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00047.html#a076991b7fbc2b9c6330f792bbba182c2">_EULER_1D_</a>&nbsp;&nbsp;&nbsp;&quot;euler1d&quot;</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00047.html#a57771c952ec174601addf43e1c0202b2">_MODEL_NDIMS_</a>&nbsp;&nbsp;&nbsp;1</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00047.html#ad3395a55a5fde64d6603c7a82d7bf2c7">_MODEL_NVARS_</a>&nbsp;&nbsp;&nbsp;3</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00047.html#abffeadaaee7a3a2baeeb28e395411d73">_ROE_</a>&nbsp;&nbsp;&nbsp;&quot;roe&quot;</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00047.html#a51e0f9431973e4cf55e6aeee7dab6d83">_RF_</a>&nbsp;&nbsp;&nbsp;&quot;rf-char&quot;</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00047.html#a98a6bcc1b69abface4bef84cf0d51955">_LLF_</a>&nbsp;&nbsp;&nbsp;&quot;llf-char&quot;</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00047.html#a930e301363fd9f0a570d97c8c3dd3ea3">_SWFS_</a>&nbsp;&nbsp;&nbsp;&quot;steger-warming&quot;</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00047.html#a68e6f3e8f20e4c3a5874221661141935">_RUSANOV_</a>&nbsp;&nbsp;&nbsp;&quot;rusanov&quot;</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00047.html#a6a44057228e5f4b86e1c4d04b2a28977">_XDIR_</a>&nbsp;&nbsp;&nbsp;0</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00047.html#af35510fb1477577f57c57cc2a862b1e7">_Euler1DGetFlowVar_</a>(u, rho, v, <a class="el" href="a00032.html#a35b3e91c83139b35bbacfaa59a58afd1">e</a>, P, p)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00047.html#a159a1509b6fbdc57754ca8871d39d97e">_Euler1DSetFlux_</a>(f, rho, v, <a class="el" href="a00032.html#a35b3e91c83139b35bbacfaa59a58afd1">e</a>, P)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00047.html#a5329991de3157d264ef86a1df4ff6bef">_Euler1DSetStiffFlux_</a>(f, rho, v, <a class="el" href="a00032.html#a35b3e91c83139b35bbacfaa59a58afd1">e</a>, P, gamma)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00047.html#a2f680b65f650c3360682d6f65e4f7321">_Euler1DSetLinearizedStiffFlux_</a>(f, u, J)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00047.html#a5a41ecdbbb78de026d8541491fb5587f">_Euler1DSetStiffJac_</a>(J, rho, v, <a class="el" href="a00032.html#a35b3e91c83139b35bbacfaa59a58afd1">e</a>, P, gamma)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00047.html#a9a3e89dcf75e61433735d59b6556c346">_Euler1DRoeAverage_</a>(uavg, uL, uR, p)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00047.html#a115efdce970884e30c6564701f929092">_Euler1DEigenvalues_</a>(u, <a class="el" href="a00031.html#add034d002483743ecf892648b0a4b6cc">D</a>, p, dir)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00047.html#a413fd3cab5a06c9d7a38334768d81b0f">_Euler1DLeftEigenvectors_</a>(u, L, p, dir)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00047.html#a4449638968eca76bb5631bc75b7dced7">_Euler1DRightEigenvectors_</a>(u, R, p, dir)</td></tr>
<tr><td colspan="2"><h2>Functions</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00047.html#a2143f7f3c03f53cf752a344a613fe429">Euler1DInitialize</a> (void *, void *)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00047.html#a8e310ddd9664225aef72a59b99baaaef">Euler1DCleanup</a> (void *)</td></tr>
</table>
<hr/><a name="_details"></a><h2>Detailed Description</h2>
<p>1D Euler Equations (inviscid, compressible flows) </p>
<dl class="author"><dt><b>Author:</b></dt><dd>Debojyoti Ghosh</dd></dl>
<p>1D Euler Equations for Inviscid, Compressible Flows (includes gravitational force terms)<br/>
</p>
<p class="formulaDsp">
<img class="formulaDsp" alt="\begin{equation} \frac {\partial} {\partial t} \left[\begin{array}{c} \rho \\ \rho u \\ e \end{array}\right] + \frac {\partial} {\partial x} \left[\begin{array}{c} \rho u \\ \rho u^2 + p \\ (e+p) u\end{array}\right] = \left[\begin{array}{c} 0 \\ -\rho g \\ -\rho u g \end{array}\right] \end{equation}" src="form_17.png"/>
</p>
<p> where </p>
<p class="formulaDsp">
<img class="formulaDsp" alt="\begin{equation} e = \frac {p} {\gamma-1} + \frac{1}{2} \rho u^2 \end{equation}" src="form_18.png"/>
</p>
<p>Reference for the governing equations: + Laney, C. B., Computational Gasdynamics, Cambridge University Press, 1998</p>
<p>For the partitioning of the flux into its stiff (acoustic) and non-stiff (convective) components, refer to: + Ghosh, D., Constantinescu, E. M., Semi-Implicit Time Integration of Atmospheric Flows with Characteristic-Based Flux Partitioning, SIAM Journal on Scientific Computing, 38 (3), 2016, A1848-A1875, <a href="http://dx.doi.org/10.1137/15M1044369">http://dx.doi.org/10.1137/15M1044369</a></p>
<p>For the treatment of gravitational source terms, refer to: + Xing, Y., Shu, C.-W., "High Order Well-Balanced WENO Scheme for the Gas Dynamics 
    Equations Under Gravitational Fields", Journal of Scientific Computing, 54, 2013, pp. 645-662. <a href="http://dx.doi.org/10.1007/s10915-012-9585-8">http://dx.doi.org/10.1007/s10915-012-9585-8</a> </p>

<p>Definition in file <a class="el" href="a00047_source.html">euler1d.h</a>.</p>
<hr/><h2>Define Documentation</h2>
<a class="anchor" id="a076991b7fbc2b9c6330f792bbba182c2"></a><!-- doxytag: member="euler1d.h::_EULER_1D_" ref="a076991b7fbc2b9c6330f792bbba182c2" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define _EULER_1D_&nbsp;&nbsp;&nbsp;&quot;euler1d&quot;</td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>1D Euler equations </p>

<p>Definition at line <a class="el" href="a00047_source.html#l00050">50</a> of file <a class="el" href="a00047_source.html">euler1d.h</a>.</p>

</div>
</div>
<a class="anchor" id="a57771c952ec174601addf43e1c0202b2"></a><!-- doxytag: member="euler1d.h::_MODEL_NDIMS_" ref="a57771c952ec174601addf43e1c0202b2" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define _MODEL_NDIMS_&nbsp;&nbsp;&nbsp;1</td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Number of spatial dimensions </p>

<p>Definition at line <a class="el" href="a00047_source.html#l00056">56</a> of file <a class="el" href="a00047_source.html">euler1d.h</a>.</p>

</div>
</div>
<a class="anchor" id="ad3395a55a5fde64d6603c7a82d7bf2c7"></a><!-- doxytag: member="euler1d.h::_MODEL_NVARS_" ref="ad3395a55a5fde64d6603c7a82d7bf2c7" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define _MODEL_NVARS_&nbsp;&nbsp;&nbsp;3</td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Number of variables per grid point </p>

<p>Definition at line <a class="el" href="a00047_source.html#l00058">58</a> of file <a class="el" href="a00047_source.html">euler1d.h</a>.</p>

</div>
</div>
<a class="anchor" id="abffeadaaee7a3a2baeeb28e395411d73"></a><!-- doxytag: member="euler1d.h::_ROE_" ref="abffeadaaee7a3a2baeeb28e395411d73" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define _ROE_&nbsp;&nbsp;&nbsp;&quot;roe&quot;</td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Roe upwinding scheme </p>

<p>Definition at line <a class="el" href="a00047_source.html#l00062">62</a> of file <a class="el" href="a00047_source.html">euler1d.h</a>.</p>

</div>
</div>
<a class="anchor" id="a51e0f9431973e4cf55e6aeee7dab6d83"></a><!-- doxytag: member="euler1d.h::_RF_" ref="a51e0f9431973e4cf55e6aeee7dab6d83" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define _RF_&nbsp;&nbsp;&nbsp;&quot;rf-char&quot;</td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Roe-Fixed upwinding scheme (characteristic-based Roe scheme with local Lax-Friedrich entropy fix) </p>

<p>Definition at line <a class="el" href="a00047_source.html#l00064">64</a> of file <a class="el" href="a00047_source.html">euler1d.h</a>.</p>

</div>
</div>
<a class="anchor" id="a98a6bcc1b69abface4bef84cf0d51955"></a><!-- doxytag: member="euler1d.h::_LLF_" ref="a98a6bcc1b69abface4bef84cf0d51955" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define _LLF_&nbsp;&nbsp;&nbsp;&quot;llf-char&quot;</td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Local Lax-Friedrich upwinding scheme </p>

<p>Definition at line <a class="el" href="a00047_source.html#l00066">66</a> of file <a class="el" href="a00047_source.html">euler1d.h</a>.</p>

</div>
</div>
<a class="anchor" id="a930e301363fd9f0a570d97c8c3dd3ea3"></a><!-- doxytag: member="euler1d.h::_SWFS_" ref="a930e301363fd9f0a570d97c8c3dd3ea3" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define _SWFS_&nbsp;&nbsp;&nbsp;&quot;steger-warming&quot;</td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Steger-Warming flux splitting </p>

<p>Definition at line <a class="el" href="a00047_source.html#l00068">68</a> of file <a class="el" href="a00047_source.html">euler1d.h</a>.</p>

</div>
</div>
<a class="anchor" id="a68e6f3e8f20e4c3a5874221661141935"></a><!-- doxytag: member="euler1d.h::_RUSANOV_" ref="a68e6f3e8f20e4c3a5874221661141935" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define _RUSANOV_&nbsp;&nbsp;&nbsp;&quot;rusanov&quot;</td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Rusanov flux splitting </p>

<p>Definition at line <a class="el" href="a00047_source.html#l00070">70</a> of file <a class="el" href="a00047_source.html">euler1d.h</a>.</p>

</div>
</div>
<a class="anchor" id="a6a44057228e5f4b86e1c4d04b2a28977"></a><!-- doxytag: member="euler1d.h::_XDIR_" ref="a6a44057228e5f4b86e1c4d04b2a28977" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define _XDIR_&nbsp;&nbsp;&nbsp;0</td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>dimension corresponding to the <em>x</em> spatial dimension </p>

<p>Definition at line <a class="el" href="a00047_source.html#l00075">75</a> of file <a class="el" href="a00047_source.html">euler1d.h</a>.</p>

</div>
</div>
<a class="anchor" id="af35510fb1477577f57c57cc2a862b1e7"></a><!-- doxytag: member="euler1d.h::_Euler1DGetFlowVar_" ref="af35510fb1477577f57c57cc2a862b1e7" args="(u, rho, v, e, P, p)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define _Euler1DGetFlowVar_</td>
          <td>(</td>
          <td class="paramtype">u, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">rho, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">v, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="a00032.html#a35b3e91c83139b35bbacfaa59a58afd1">e</a>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">P, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">p&nbsp;</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<b>Value:</b><div class="fragment"><pre class="fragment">{ \
    <span class="keywordtype">double</span> gamma = p-&gt;gamma; \
    rho = u[0]; \
    v   = u[1] / rho; \
    <a class="code" href="a00032.html#a35b3e91c83139b35bbacfaa59a58afd1">e</a>   = u[2]; \
    P   = (<a class="code" href="a00032.html#a35b3e91c83139b35bbacfaa59a58afd1">e</a> - 0.5*rho*v*v) * (gamma-1.0); \
  }
</pre></div><p>Compute the flow variables (density, pressure, velocity) from the conserved solution vector. </p>

<p>Definition at line <a class="el" href="a00047_source.html#l00081">81</a> of file <a class="el" href="a00047_source.html">euler1d.h</a>.</p>

</div>
</div>
<a class="anchor" id="a159a1509b6fbdc57754ca8871d39d97e"></a><!-- doxytag: member="euler1d.h::_Euler1DSetFlux_" ref="a159a1509b6fbdc57754ca8871d39d97e" args="(f, rho, v, e, P)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define _Euler1DSetFlux_</td>
          <td>(</td>
          <td class="paramtype">f, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">rho, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">v, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="a00032.html#a35b3e91c83139b35bbacfaa59a58afd1">e</a>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">P&nbsp;</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<b>Value:</b><div class="fragment"><pre class="fragment">{ \
    f[0] = (rho) * (v); \
    f[1] = (rho) * (v) * (v) + (P); \
    f[2] = ((<a class="code" href="a00032.html#a35b3e91c83139b35bbacfaa59a58afd1">e</a>) + (P)) * (v); \
  }
</pre></div><p>Set the flux vector given the flow variables (density, velocity, pressure). </p>

<p>Definition at line <a class="el" href="a00047_source.html#l00094">94</a> of file <a class="el" href="a00047_source.html">euler1d.h</a>.</p>

</div>
</div>
<a class="anchor" id="a5329991de3157d264ef86a1df4ff6bef"></a><!-- doxytag: member="euler1d.h::_Euler1DSetStiffFlux_" ref="a5329991de3157d264ef86a1df4ff6bef" args="(f, rho, v, e, P, gamma)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define _Euler1DSetStiffFlux_</td>
          <td>(</td>
          <td class="paramtype">f, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">rho, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">v, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="a00032.html#a35b3e91c83139b35bbacfaa59a58afd1">e</a>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">P, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">gamma&nbsp;</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<b>Value:</b><div class="fragment"><pre class="fragment">{ \
    <span class="keywordtype">double</span> gamma_inv = 1.0 / (gamma); \
    f[0] = gamma_inv * (rho)*(v); \
    f[1] = gamma_inv * (rho)*(v)*(v) + (P); \
    f[2] = ((<a class="code" href="a00032.html#a35b3e91c83139b35bbacfaa59a58afd1">e</a>)+(P)) * (v) - 0.5*gamma_inv*((gamma)-1)*(rho)*(v)*(v)*(v); \
  }
</pre></div><p>Set the stiff flux vector given the flow variables (density, velocity, pressure). The stiff flux vector is defines as the part of the total flux that represents the two acoustic waves. This is used in a characteristic-based split-flux method for implicit-explicit time-integration. The stiff flux is integrated in time implicitly. </p>
<dl class="see"><dt><b>See also:</b></dt><dd><a class="el" href="a00047.html#a5a41ecdbbb78de026d8541491fb5587f">_Euler1DSetStiffJac_</a>, <a class="el" href="a00047.html#a2f680b65f650c3360682d6f65e4f7321">_Euler1DSetLinearizedStiffFlux_</a></dd></dl>
<p>Reference: + Ghosh, D., Constantinescu, E. M., Semi-Implicit Time Integration of Atmospheric Flows with Characteristic-Based Flux Partitioning, SIAM Journal on Scientific Computing, 38 (3), 2016, A1848-A1875, <a href="http://dx.doi.org/10.1137/15M1044369">http://dx.doi.org/10.1137/15M1044369</a> </p>

<p>Definition at line <a class="el" href="a00047_source.html#l00115">115</a> of file <a class="el" href="a00047_source.html">euler1d.h</a>.</p>

</div>
</div>
<a class="anchor" id="a2f680b65f650c3360682d6f65e4f7321"></a><!-- doxytag: member="euler1d.h::_Euler1DSetLinearizedStiffFlux_" ref="a2f680b65f650c3360682d6f65e4f7321" args="(f, u, J)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define _Euler1DSetLinearizedStiffFlux_</td>
          <td>(</td>
          <td class="paramtype">f, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">u, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">J&nbsp;</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<b>Value:</b><div class="fragment"><pre class="fragment">{ \
    <a class="code" href="a00044.html#a1318a4facf7b30129d0509f524a1eb3b">_MatVecMultiply_</a>((J),(u),(f),(<a class="code" href="a00047.html#ad3395a55a5fde64d6603c7a82d7bf2c7">_MODEL_NVARS_</a>)); \
  }
</pre></div><p>Linearized version of <a class="el" href="a00047.html#a5329991de3157d264ef86a1df4ff6bef">_Euler1DSetStiffFlux_</a>, where the Jacobian of the stiff flux is evaluated at the beginning of each time step. </p>
<dl class="see"><dt><b>See also:</b></dt><dd><a class="el" href="a00047.html#a5a41ecdbbb78de026d8541491fb5587f">_Euler1DSetStiffJac_</a></dd></dl>
<p>Reference: + Ghosh, D., Constantinescu, E. M., Semi-Implicit Time Integration of Atmospheric Flows with Characteristic-Based Flux Partitioning, SIAM Journal on Scientific Computing, 38 (3), 2016, A1848-A1875, <a href="http://dx.doi.org/10.1137/15M1044369">http://dx.doi.org/10.1137/15M1044369</a> </p>

<p>Definition at line <a class="el" href="a00047_source.html#l00134">134</a> of file <a class="el" href="a00047_source.html">euler1d.h</a>.</p>

</div>
</div>
<a class="anchor" id="a5a41ecdbbb78de026d8541491fb5587f"></a><!-- doxytag: member="euler1d.h::_Euler1DSetStiffJac_" ref="a5a41ecdbbb78de026d8541491fb5587f" args="(J, rho, v, e, P, gamma)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define _Euler1DSetStiffJac_</td>
          <td>(</td>
          <td class="paramtype">J, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">rho, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">v, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="a00032.html#a35b3e91c83139b35bbacfaa59a58afd1">e</a>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">P, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">gamma&nbsp;</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<b>Value:</b><div class="fragment"><pre class="fragment">{ \
    <span class="keywordtype">double</span> gm1 = (gamma)-1; \
    <span class="keywordtype">double</span> inv_gm = 1.0/(gamma); \
    <span class="keywordtype">double</span> gm1_inv_gm = gm1 * inv_gm; \
    J[0] = 0.5*gm1_inv_gm*(rho)*(v)*(v)*(v)/(P) - (v); \
    J[1] = 1.0 - gm1_inv_gm*(rho)*(v)*(v)/(P); \
    J[2] = gm1_inv_gm*(rho)*(v)/(P); \
    J[3] = 0.5*gm1_inv_gm*(rho)*(v)*(v)*(v)*(v)/(P) + 0.5*((gamma)-5.0)*(v)*(v); \
    J[4] = (3.0-(gamma))*(v) - gm1_inv_gm*(rho)*(v)*(v)*(v)/(P); \
    J[5] = gm1_inv_gm*(rho)*(v)*(v)/(P) + gm1; \
    J[6] = 0.25*gm1_inv_gm*(rho)*(v)*(v)*(v)*(v)*(v)/(P) - (gamma)*(v)*(<a class="code" href="a00032.html#a35b3e91c83139b35bbacfaa59a58afd1">e</a>)/(rho) + 0.5*(2.0*(gamma)-3.0)*(v)*(v)*(v); \
    J[7] = (gamma)*(<a class="code" href="a00032.html#a35b3e91c83139b35bbacfaa59a58afd1">e</a>)/(rho) - 1.5*gm1*(v)*(v) - 0.5*gm1_inv_gm*(rho)*(v)*(v)*(v)*(v)/(P); \
    J[8] = 0.5*gm1_inv_gm*(rho)*(v)*(v)*(v)/(P) + (gamma)*(v); \
  }
</pre></div><p>Compute the Jacobian of the stiff flux defined in <a class="el" href="a00047.html#a5329991de3157d264ef86a1df4ff6bef">_Euler1DSetStiffFlux_</a>. The Jacobian is stored in the row-major format.</p>
<p>Reference: + Ghosh, D., Constantinescu, E. M., Semi-Implicit Time Integration of Atmospheric Flows with Characteristic-Based Flux Partitioning, SIAM Journal on Scientific Computing, 38 (3), 2016, A1848-A1875, <a href="http://dx.doi.org/10.1137/15M1044369">http://dx.doi.org/10.1137/15M1044369</a> </p>

<p>Definition at line <a class="el" href="a00047_source.html#l00149">149</a> of file <a class="el" href="a00047_source.html">euler1d.h</a>.</p>

</div>
</div>
<a class="anchor" id="a9a3e89dcf75e61433735d59b6556c346"></a><!-- doxytag: member="euler1d.h::_Euler1DRoeAverage_" ref="a9a3e89dcf75e61433735d59b6556c346" args="(uavg, uL, uR, p)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define _Euler1DRoeAverage_</td>
          <td>(</td>
          <td class="paramtype">uavg, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uL, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uR, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">p&nbsp;</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<b>Value:</b><div class="fragment"><pre class="fragment">{ \
    <span class="keywordtype">double</span> rho ,v ,<a class="code" href="a00032.html#a35b3e91c83139b35bbacfaa59a58afd1">e</a> ,P ,H ,csq; \
    <span class="keywordtype">double</span> rhoL,vL,eL,PL,HL,cLsq; \
    <span class="keywordtype">double</span> rhoR,vR,eR,PR,HR,cRsq; \
    <span class="keywordtype">double</span> gamma = p-&gt;gamma; \
    rhoL = uL[0]; \
    vL   = uL[1] / rhoL; \
    eL   = uL[2]; \
    PL   = (eL - 0.5*rhoL*vL*vL) * (gamma-1.0); \
    cLsq = gamma * PL/rhoL; \
    HL = 0.5*vL*vL + cLsq / (gamma-1.0); \
    rhoR = uR[0]; \
    vR   = uR[1] / rhoR; \
    eR   = uR[2]; \
    PR   = (eR - 0.5*rhoR*vR*vR) * (gamma-1.0); \
    cRsq = gamma * PR/rhoR; \
    HR = 0.5*vR*vR + cRsq / (gamma-1.0); \
    <span class="keywordtype">double</span> tL = sqrt(rhoL); \
    <span class="keywordtype">double</span> tR = sqrt(rhoR); \
    rho = tL * tR; \
    v   = (tL*vL + tR*vR) / (tL + tR); \
    H   = (tL*HL + tR*HR) / (tL + tR); \
    csq = (gamma-1.0) * (H-0.5*v*v); \
    P   = csq * rho / gamma; \
    e   = P/(gamma-1.0) + 0.5*rho*v*v; \
    \
    uavg[0] = rho; \
    uavg[1] = rho*v; \
    uavg[2] = e; \
  }
</pre></div><p>Compute the Roe average of two conserved solution vectors. </p>

<p>Definition at line <a class="el" href="a00047_source.html#l00169">169</a> of file <a class="el" href="a00047_source.html">euler1d.h</a>.</p>

</div>
</div>
<a class="anchor" id="a115efdce970884e30c6564701f929092"></a><!-- doxytag: member="euler1d.h::_Euler1DEigenvalues_" ref="a115efdce970884e30c6564701f929092" args="(u, D, p, dir)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define _Euler1DEigenvalues_</td>
          <td>(</td>
          <td class="paramtype">u, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="a00031.html#add034d002483743ecf892648b0a4b6cc">D</a>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">p, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">dir&nbsp;</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<b>Value:</b><div class="fragment"><pre class="fragment">{ \
    <span class="keywordtype">double</span> gamma   = p-&gt;gamma; \
    <span class="keywordtype">double</span> rho,v,<a class="code" href="a00032.html#a35b3e91c83139b35bbacfaa59a58afd1">e</a>,P,c; \
    rho = u[0]; \
    v   = u[1] / rho; \
    e   = u[2]; \
    P   = (e - 0.5*rho*v*v) * (gamma-1.0); \
    c = sqrt(gamma*P/rho); \
    <a class="code" href="a00031.html#add034d002483743ecf892648b0a4b6cc">D</a>[0*<a class="code" href="a00047.html#ad3395a55a5fde64d6603c7a82d7bf2c7">_MODEL_NVARS_</a>+0] = v;      <a class="code" href="a00031.html#add034d002483743ecf892648b0a4b6cc">D</a>[0*<a class="code" href="a00047.html#ad3395a55a5fde64d6603c7a82d7bf2c7">_MODEL_NVARS_</a>+1] = 0;      <a class="code" href="a00031.html#add034d002483743ecf892648b0a4b6cc">D</a>[0*<a class="code" href="a00047.html#ad3395a55a5fde64d6603c7a82d7bf2c7">_MODEL_NVARS_</a>+2] = 0; \
    <a class="code" href="a00031.html#add034d002483743ecf892648b0a4b6cc">D</a>[1*<a class="code" href="a00047.html#ad3395a55a5fde64d6603c7a82d7bf2c7">_MODEL_NVARS_</a>+0] = 0;      <a class="code" href="a00031.html#add034d002483743ecf892648b0a4b6cc">D</a>[1*<a class="code" href="a00047.html#ad3395a55a5fde64d6603c7a82d7bf2c7">_MODEL_NVARS_</a>+1] = (v-c);  <a class="code" href="a00031.html#add034d002483743ecf892648b0a4b6cc">D</a>[1*<a class="code" href="a00047.html#ad3395a55a5fde64d6603c7a82d7bf2c7">_MODEL_NVARS_</a>+2] = 0; \
    <a class="code" href="a00031.html#add034d002483743ecf892648b0a4b6cc">D</a>[2*<a class="code" href="a00047.html#ad3395a55a5fde64d6603c7a82d7bf2c7">_MODEL_NVARS_</a>+0] = 0;      <a class="code" href="a00031.html#add034d002483743ecf892648b0a4b6cc">D</a>[2*<a class="code" href="a00047.html#ad3395a55a5fde64d6603c7a82d7bf2c7">_MODEL_NVARS_</a>+1] = 0;      <a class="code" href="a00031.html#add034d002483743ecf892648b0a4b6cc">D</a>[2*<a class="code" href="a00047.html#ad3395a55a5fde64d6603c7a82d7bf2c7">_MODEL_NVARS_</a>+2] = (v+c); \
  }
</pre></div><p>Compute the eigenvalues, given the conserved solution vector. The eigenvalues are returned as a 3x3 matrix stored in row-major format. It is a diagonal matrix with the eigenvalues as diagonal elements. Admittedly, it is a wasteful way of storing the eigenvalues. </p>

<p>Definition at line <a class="el" href="a00047_source.html#l00207">207</a> of file <a class="el" href="a00047_source.html">euler1d.h</a>.</p>

</div>
</div>
<a class="anchor" id="a413fd3cab5a06c9d7a38334768d81b0f"></a><!-- doxytag: member="euler1d.h::_Euler1DLeftEigenvectors_" ref="a413fd3cab5a06c9d7a38334768d81b0f" args="(u, L, p, dir)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define _Euler1DLeftEigenvectors_</td>
          <td>(</td>
          <td class="paramtype">u, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">L, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">p, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">dir&nbsp;</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<b>Value:</b><div class="fragment"><pre class="fragment">{ \
    <span class="keywordtype">double</span> gamma = p-&gt;gamma; \
    <span class="keywordtype">double</span> rho,v,<a class="code" href="a00032.html#a35b3e91c83139b35bbacfaa59a58afd1">e</a>,P,c; \
    rho = u[0]; \
    v   = u[1] / rho; \
    e   = u[2]; \
    P   = (e - 0.5*rho*v*v) * (gamma-1.0); \
    c    = sqrt(gamma*P/rho); \
    L[1*<a class="code" href="a00047.html#ad3395a55a5fde64d6603c7a82d7bf2c7">_MODEL_NVARS_</a>+0] = ((gamma - 1)/(rho*c)) * (-(v*v)/2 - c*v/(gamma-1)); \
    L[1*<a class="code" href="a00047.html#ad3395a55a5fde64d6603c7a82d7bf2c7">_MODEL_NVARS_</a>+1] = ((gamma - 1)/(rho*c)) * (v + c/(gamma-1)); \
    L[1*<a class="code" href="a00047.html#ad3395a55a5fde64d6603c7a82d7bf2c7">_MODEL_NVARS_</a>+2] = ((gamma - 1)/(rho*c)) * (-1); \
    L[0*<a class="code" href="a00047.html#ad3395a55a5fde64d6603c7a82d7bf2c7">_MODEL_NVARS_</a>+0] = ((gamma - 1)/(rho*c)) * (rho*(-(v*v)/2+c*c/(gamma-1))/c); \
    L[0*<a class="code" href="a00047.html#ad3395a55a5fde64d6603c7a82d7bf2c7">_MODEL_NVARS_</a>+1] = ((gamma - 1)/(rho*c)) * (rho*v/c); \
    L[0*<a class="code" href="a00047.html#ad3395a55a5fde64d6603c7a82d7bf2c7">_MODEL_NVARS_</a>+2] = ((gamma - 1)/(rho*c)) * (-rho/c); \
    L[2*<a class="code" href="a00047.html#ad3395a55a5fde64d6603c7a82d7bf2c7">_MODEL_NVARS_</a>+0] = ((gamma - 1)/(rho*c)) * ((v*v)/2 - c*v/(gamma-1)); \
    L[2*<a class="code" href="a00047.html#ad3395a55a5fde64d6603c7a82d7bf2c7">_MODEL_NVARS_</a>+1] = ((gamma - 1)/(rho*c)) * (-v + c/(gamma-1)); \
    L[2*<a class="code" href="a00047.html#ad3395a55a5fde64d6603c7a82d7bf2c7">_MODEL_NVARS_</a>+2] = ((gamma - 1)/(rho*c)) * (1); \
  }
</pre></div><p>Compute the matrix that has the left-eigenvectors as its rows. Stored in row-major format. </p>

<p>Definition at line <a class="el" href="a00047_source.html#l00225">225</a> of file <a class="el" href="a00047_source.html">euler1d.h</a>.</p>

</div>
</div>
<a class="anchor" id="a4449638968eca76bb5631bc75b7dced7"></a><!-- doxytag: member="euler1d.h::_Euler1DRightEigenvectors_" ref="a4449638968eca76bb5631bc75b7dced7" args="(u, R, p, dir)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define _Euler1DRightEigenvectors_</td>
          <td>(</td>
          <td class="paramtype">u, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">R, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">p, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">dir&nbsp;</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<b>Value:</b><div class="fragment"><pre class="fragment">{ \
    <span class="keywordtype">double</span> gamma   = p-&gt;gamma; \
    <span class="keywordtype">double</span> rho,v,<a class="code" href="a00032.html#a35b3e91c83139b35bbacfaa59a58afd1">e</a>,P,c; \
    rho = u[0]; \
    v   = u[1] / rho; \
    e   = u[2]; \
    P   = (e - 0.5*rho*v*v) * (gamma-1.0); \
    c    = sqrt(gamma*P/rho); \
    R[0*<a class="code" href="a00047.html#ad3395a55a5fde64d6603c7a82d7bf2c7">_MODEL_NVARS_</a>+1] = - rho/(2*c);  R[1*<a class="code" href="a00047.html#ad3395a55a5fde64d6603c7a82d7bf2c7">_MODEL_NVARS_</a>+1] = -rho*(v-c)/(2*c); R[2*<a class="code" href="a00047.html#ad3395a55a5fde64d6603c7a82d7bf2c7">_MODEL_NVARS_</a>+1] = -rho*((v*v)/2+(c*c)/(gamma-1)-c*v)/(2*c);  \
    R[0*<a class="code" href="a00047.html#ad3395a55a5fde64d6603c7a82d7bf2c7">_MODEL_NVARS_</a>+0] = 1;            R[1*<a class="code" href="a00047.html#ad3395a55a5fde64d6603c7a82d7bf2c7">_MODEL_NVARS_</a>+0] = v;                R[2*<a class="code" href="a00047.html#ad3395a55a5fde64d6603c7a82d7bf2c7">_MODEL_NVARS_</a>+0] = v*v / 2;                                   \
    R[0*<a class="code" href="a00047.html#ad3395a55a5fde64d6603c7a82d7bf2c7">_MODEL_NVARS_</a>+2] = rho/(2*c);    R[1*<a class="code" href="a00047.html#ad3395a55a5fde64d6603c7a82d7bf2c7">_MODEL_NVARS_</a>+2] = rho*(v+c)/(2*c);  R[2*<a class="code" href="a00047.html#ad3395a55a5fde64d6603c7a82d7bf2c7">_MODEL_NVARS_</a>+2] = rho*((v*v)/2+(c*c)/(gamma-1)+c*v)/(2*c);   \
  }
</pre></div><p>Compute the matrix that has the right-eigenvectors as its columns. Stored in row-major format. </p>

<p>Definition at line <a class="el" href="a00047_source.html#l00249">249</a> of file <a class="el" href="a00047_source.html">euler1d.h</a>.</p>

</div>
</div>
<hr/><h2>Function Documentation</h2>
<a class="anchor" id="a2143f7f3c03f53cf752a344a613fe429"></a><!-- doxytag: member="euler1d.h::Euler1DInitialize" ref="a2143f7f3c03f53cf752a344a613fe429" args="(void *, void *)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int Euler1DInitialize </td>
          <td>(</td>
          <td class="paramtype">void *&nbsp;</td>
          <td class="paramname"> <em>s</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&nbsp;</td>
          <td class="paramname"> <em>m</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Function to initialize the 1D Euler module</p>
<p>Function to initialize the 1D inviscid Euler equations (<a class="el" href="a00005.html" title="Structure containing variables and parameters specific to the 1D Euler equations...">Euler1D</a>) module: Sets the default parameters, read in and set physics-related parameters, and set the physics-related function pointers in <a class="el" href="a00015.html" title="Structure containing all solver-specific variables and functions.">HyPar</a>.</p>
<p>This file reads the file "physics.inp" that must have the following format:</p>
<p>begin &lt;keyword&gt; </p>
<p>&lt;keyword&gt; </p>
<p>&lt;keyword&gt; </p>
<p>... &lt;keyword&gt; </p>
<p>end</p>
<p>where the list of keywords are:</p>
<p>Keyword name | Type | Variable | Default value ------------------ | ------------ | ----------------------------- | ------------------------ gamma | double | <a class="el" href="a00005.html#a72f9e01745b3a8203067ab84aefc9aea">Euler1D::gamma</a> | 1.4 gravity | double | <a class="el" href="a00005.html#a87f6134534484ec863864096005ac076">Euler1D::grav</a> | 0.0 grav_type | int | <a class="el" href="a00005.html#a41908af46d7b1181c9177332aa44ead5">Euler1D::grav_type</a> | 0 upwinding | char[] | <a class="el" href="a00005.html#a57894a0f53d5b228bf64053367736bf9">Euler1D::upw_choice</a> | "roe" (<a class="el" href="a00059.html#abffeadaaee7a3a2baeeb28e395411d73">_ROE_</a>)</p>
<p><b>Note:</b> "physics.inp" is <b>optional</b>; if absent, default values will be used. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>s</em>&nbsp;</td><td>Solver object of type <a class="el" href="a00015.html" title="Structure containing all solver-specific variables and functions.">HyPar</a> </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>m</em>&nbsp;</td><td>Object of type <a class="el" href="a00019.html" title="Structure of MPI-related variables.">MPIVariables</a> containing MPI-related info </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="a00204_source.html#l00071">71</a> of file <a class="el" href="a00204_source.html">Euler1DInitialize.c</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00075"></a>00075 {
<a name="l00076"></a>00076   <a class="code" href="a00015.html" title="Structure containing all solver-specific variables and functions.">HyPar</a>         *solver  = (<a class="code" href="a00015.html" title="Structure containing all solver-specific variables and functions.">HyPar</a>*)         s;
<a name="l00077"></a>00077   <a class="code" href="a00019.html" title="Structure of MPI-related variables.">MPIVariables</a>  *mpi     = (<a class="code" href="a00019.html" title="Structure of MPI-related variables.">MPIVariables</a>*)  m; 
<a name="l00078"></a>00078   <a class="code" href="a00005.html" title="Structure containing variables and parameters specific to the 1D Euler equations...">Euler1D</a>       *physics = (<a class="code" href="a00005.html" title="Structure containing variables and parameters specific to the 1D Euler equations...">Euler1D</a>*)       solver-&gt;<a class="code" href="a00015.html#a48e81a1806b5774943fd9a26e9a190f2">physics</a>;
<a name="l00079"></a>00079   <span class="keywordtype">int</span>           ferr, d;
<a name="l00080"></a>00080 
<a name="l00081"></a>00081   if (solver-&gt;<a class="code" href="a00015.html#ae8f6d2fd6490d3153cb4133bf183a404">nvars</a> != <a class="code" href="a00047.html#ad3395a55a5fde64d6603c7a82d7bf2c7">_MODEL_NVARS_</a>) {
<a name="l00082"></a>00082     fprintf(stderr,<span class="stringliteral">&quot;Error in Euler1DInitialize(): nvars has to be %d.\n&quot;</span>,<a class="code" href="a00047.html#ad3395a55a5fde64d6603c7a82d7bf2c7">_MODEL_NVARS_</a>);
<a name="l00083"></a>00083     <span class="keywordflow">return</span>(1);
<a name="l00084"></a>00084   }
<a name="l00085"></a>00085   <span class="keywordflow">if</span> (solver-&gt;<a class="code" href="a00015.html#a484873c74138512e41bc50d17b7d955a">ndims</a> != <a class="code" href="a00047.html#a57771c952ec174601addf43e1c0202b2">_MODEL_NDIMS_</a>) {
<a name="l00086"></a>00086     fprintf(stderr,<span class="stringliteral">&quot;Error in Euler1DInitialize(): ndims has to be %d.\n&quot;</span>,<a class="code" href="a00047.html#a57771c952ec174601addf43e1c0202b2">_MODEL_NDIMS_</a>);
<a name="l00087"></a>00087     <span class="keywordflow">return</span>(1);
<a name="l00088"></a>00088   }
<a name="l00089"></a>00089 
<a name="l00090"></a>00090   <span class="comment">/* default values */</span>
<a name="l00091"></a>00091   physics-&gt;<a class="code" href="a00005.html#a72f9e01745b3a8203067ab84aefc9aea">gamma</a>      = 1.4; 
<a name="l00092"></a>00092   physics-&gt;<a class="code" href="a00005.html#a87f6134534484ec863864096005ac076">grav</a>       = 0.0;
<a name="l00093"></a>00093   physics-&gt;<a class="code" href="a00005.html#a41908af46d7b1181c9177332aa44ead5">grav_type</a>  = 0;
<a name="l00094"></a>00094   strcpy(physics-&gt;<a class="code" href="a00005.html#a57894a0f53d5b228bf64053367736bf9">upw_choice</a>,<span class="stringliteral">&quot;roe&quot;</span>);
<a name="l00095"></a>00095 
<a name="l00096"></a>00096   <span class="comment">/* reading physical model specific inputs */</span>
<a name="l00097"></a>00097   <span class="keywordflow">if</span> (!mpi-&gt;<a class="code" href="a00019.html#a6cfd95afd0afebd625b889fb6e58371c">rank</a>) {
<a name="l00098"></a>00098     FILE *in;
<a name="l00099"></a>00099     printf(<span class="stringliteral">&quot;Reading physical model inputs from file \&quot;physics.inp\&quot;.\n&quot;</span>);
<a name="l00100"></a>00100     in = fopen(<span class="stringliteral">&quot;physics.inp&quot;</span>,<span class="stringliteral">&quot;r&quot;</span>);
<a name="l00101"></a>00101     <span class="keywordflow">if</span> (!in) printf(<span class="stringliteral">&quot;Warning: File \&quot;physics.inp\&quot; not found. Using default values.\n&quot;</span>);
<a name="l00102"></a>00102     <span class="keywordflow">else</span> {
<a name="l00103"></a>00103       <span class="keywordtype">char</span> word[<a class="code" href="a00036.html#a51efea86a4d76d1259893f606b776573">_MAX_STRING_SIZE_</a>];
<a name="l00104"></a>00104       ferr = fscanf(in,<span class="stringliteral">&quot;%s&quot;</span>,word); <span class="keywordflow">if</span> (ferr != 1) <span class="keywordflow">return</span>(1);
<a name="l00105"></a>00105       <span class="keywordflow">if</span> (!strcmp(word, <span class="stringliteral">&quot;begin&quot;</span>)){
<a name="l00106"></a>00106           <span class="keywordflow">while</span> (strcmp(word, <span class="stringliteral">&quot;end&quot;</span>)){
<a name="l00107"></a>00107               ferr = fscanf(in,<span class="stringliteral">&quot;%s&quot;</span>,word); <span class="keywordflow">if</span> (ferr != 1) <span class="keywordflow">return</span>(1);
<a name="l00108"></a>00108           <span class="keywordflow">if</span> (!strcmp(word, <span class="stringliteral">&quot;gamma&quot;</span>)) { 
<a name="l00109"></a>00109             ferr = fscanf(in,<span class="stringliteral">&quot;%lf&quot;</span>,&amp;physics-&gt;<a class="code" href="a00005.html#a72f9e01745b3a8203067ab84aefc9aea">gamma</a>); 
<a name="l00110"></a>00110             <span class="keywordflow">if</span> (ferr != 1) <span class="keywordflow">return</span>(1);
<a name="l00111"></a>00111           } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcmp(word, <span class="stringliteral">&quot;gravity&quot;</span>)) { 
<a name="l00112"></a>00112             ferr = fscanf(in,<span class="stringliteral">&quot;%lf&quot;</span>,&amp;physics-&gt;<a class="code" href="a00005.html#a87f6134534484ec863864096005ac076">grav</a>); 
<a name="l00113"></a>00113             <span class="keywordflow">if</span> (ferr != 1) <span class="keywordflow">return</span>(1);
<a name="l00114"></a>00114           } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcmp(word, <span class="stringliteral">&quot;gravity_type&quot;</span>)) { 
<a name="l00115"></a>00115             ferr = fscanf(in,<span class="stringliteral">&quot;%d&quot;</span>,&amp;physics-&gt;<a class="code" href="a00005.html#a41908af46d7b1181c9177332aa44ead5">grav_type</a>); 
<a name="l00116"></a>00116             <span class="keywordflow">if</span> (ferr != 1) <span class="keywordflow">return</span>(1);
<a name="l00117"></a>00117           } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcmp(word,<span class="stringliteral">&quot;upwinding&quot;</span>)) {
<a name="l00118"></a>00118             ferr = fscanf(in,<span class="stringliteral">&quot;%s&quot;</span>,physics-&gt;<a class="code" href="a00005.html#a57894a0f53d5b228bf64053367736bf9">upw_choice</a>); 
<a name="l00119"></a>00119             <span class="keywordflow">if</span> (ferr != 1) <span class="keywordflow">return</span>(1);
<a name="l00120"></a>00120           } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (strcmp(word,<span class="stringliteral">&quot;end&quot;</span>)) {
<a name="l00121"></a>00121             <span class="keywordtype">char</span> useless[<a class="code" href="a00036.html#a51efea86a4d76d1259893f606b776573">_MAX_STRING_SIZE_</a>];
<a name="l00122"></a>00122             ferr = fscanf(in,<span class="stringliteral">&quot;%s&quot;</span>,useless); <span class="keywordflow">if</span> (ferr != 1) <span class="keywordflow">return</span>(ferr);
<a name="l00123"></a>00123             printf(<span class="stringliteral">&quot;Warning: keyword %s in file \&quot;physics.inp\&quot; with value %s not &quot;</span>,word,useless);
<a name="l00124"></a>00124             printf(<span class="stringliteral">&quot;recognized or extraneous. Ignoring.\n&quot;</span>);
<a name="l00125"></a>00125           }
<a name="l00126"></a>00126         }
<a name="l00127"></a>00127         } <span class="keywordflow">else</span> {
<a name="l00128"></a>00128           fprintf(stderr,<span class="stringliteral">&quot;Error: Illegal format in file \&quot;physics.inp\&quot;.\n&quot;</span>);
<a name="l00129"></a>00129         <span class="keywordflow">return</span>(1);
<a name="l00130"></a>00130         }
<a name="l00131"></a>00131     }
<a name="l00132"></a>00132     fclose(in);
<a name="l00133"></a>00133   }
<a name="l00134"></a>00134 
<a name="l00135"></a>00135 <span class="preprocessor">#ifndef serial</span>
<a name="l00136"></a>00136 <span class="preprocessor"></span>  <a class="code" href="a00036.html#ad6ab74942c9de13cf0b4c12eb0d91780">IERR</a> <a class="code" href="a00045.html#a45dcb265863a65d862bb16222e7e623c">MPIBroadcast_double</a>    (&amp;physics-&gt;<a class="code" href="a00005.html#a72f9e01745b3a8203067ab84aefc9aea">gamma</a>    ,1,0,&amp;mpi-&gt;<a class="code" href="a00019.html#adad7a6f85831f3ac84d854b6c80aef43">world</a>);                  <a class="code" href="a00036.html#add9cf96ae374934d245a1dc1ab697a42">CHECKERR</a>(ierr);
<a name="l00137"></a>00137   <a class="code" href="a00036.html#ad6ab74942c9de13cf0b4c12eb0d91780">IERR</a> <a class="code" href="a00045.html#a45dcb265863a65d862bb16222e7e623c">MPIBroadcast_double</a>    (&amp;physics-&gt;<a class="code" href="a00005.html#a87f6134534484ec863864096005ac076">grav</a>     ,1,0,&amp;mpi-&gt;<a class="code" href="a00019.html#adad7a6f85831f3ac84d854b6c80aef43">world</a>);                  <a class="code" href="a00036.html#add9cf96ae374934d245a1dc1ab697a42">CHECKERR</a>(ierr);
<a name="l00138"></a>00138   <a class="code" href="a00036.html#ad6ab74942c9de13cf0b4c12eb0d91780">IERR</a> <a class="code" href="a00045.html#acd7957559b9206224c7da3cab4f22b27">MPIBroadcast_integer</a>   (&amp;physics-&gt;<a class="code" href="a00005.html#a41908af46d7b1181c9177332aa44ead5">grav_type</a>,1,0,&amp;mpi-&gt;<a class="code" href="a00019.html#adad7a6f85831f3ac84d854b6c80aef43">world</a>);                  <a class="code" href="a00036.html#add9cf96ae374934d245a1dc1ab697a42">CHECKERR</a>(ierr);
<a name="l00139"></a>00139   <a class="code" href="a00036.html#ad6ab74942c9de13cf0b4c12eb0d91780">IERR</a> <a class="code" href="a00045.html#ad408e5a44e863cca50112d1e2f728597">MPIBroadcast_character</a> (physics-&gt;<a class="code" href="a00005.html#a57894a0f53d5b228bf64053367736bf9">upw_choice</a>,<a class="code" href="a00036.html#a51efea86a4d76d1259893f606b776573">_MAX_STRING_SIZE_</a>,0,&amp;mpi-&gt;<a class="code" href="a00019.html#adad7a6f85831f3ac84d854b6c80aef43">world</a>);  <a class="code" href="a00036.html#add9cf96ae374934d245a1dc1ab697a42">CHECKERR</a>(ierr);
<a name="l00140"></a>00140 <span class="preprocessor">#endif</span>
<a name="l00141"></a>00141 <span class="preprocessor"></span>
<a name="l00142"></a>00142   <span class="keywordflow">if</span> ((physics-&gt;<a class="code" href="a00005.html#a87f6134534484ec863864096005ac076">grav</a> != 0.0) &amp;&amp; (strcmp(physics-&gt;<a class="code" href="a00005.html#a57894a0f53d5b228bf64053367736bf9">upw_choice</a>,<a class="code" href="a00047.html#a98a6bcc1b69abface4bef84cf0d51955">_LLF_</a>)) &amp;&amp; (strcmp(physics-&gt;<a class="code" href="a00005.html#a57894a0f53d5b228bf64053367736bf9">upw_choice</a>,<a class="code" href="a00047.html#abffeadaaee7a3a2baeeb28e395411d73">_ROE_</a>))) {
<a name="l00143"></a>00143     <span class="keywordflow">if</span> (!mpi-&gt;<a class="code" href="a00019.html#a6cfd95afd0afebd625b889fb6e58371c">rank</a>) {
<a name="l00144"></a>00144       fprintf(stderr,<span class="stringliteral">&quot;Error in Euler1DInitialize: %s or %s upwinding is needed for flows &quot;</span>,<a class="code" href="a00047.html#a98a6bcc1b69abface4bef84cf0d51955">_LLF_</a>,<a class="code" href="a00047.html#abffeadaaee7a3a2baeeb28e395411d73">_ROE_</a>);
<a name="l00145"></a>00145       fprintf(stderr,<span class="stringliteral">&quot;with gravitational forces.\n&quot;</span>);
<a name="l00146"></a>00146     }
<a name="l00147"></a>00147     <span class="keywordflow">return</span>(1);
<a name="l00148"></a>00148   }
<a name="l00149"></a>00149 
<a name="l00150"></a>00150   <span class="comment">/* initializing physical model-specific functions */</span>
<a name="l00151"></a>00151   solver-&gt;<a class="code" href="a00015.html#a6a34ae8a3044f521e57180a7260f3b42">PreStep</a>            = <a class="code" href="a00204.html#a3c64bcea38b974bd6a174b9f6324cf64">Euler1DPreStep</a>;
<a name="l00152"></a>00152   solver-&gt;<a class="code" href="a00015.html#a73ad2e9dae43bf438ab8bfc4cd2e1bdd">ComputeCFL</a>         = <a class="code" href="a00199.html#a820145e91372888fca738bcf320495d9">Euler1DComputeCFL</a>;
<a name="l00153"></a>00153   solver-&gt;<a class="code" href="a00015.html#a0d895f9bb0c8a3e79a64dd2379e1f2dd">FFunction</a>          = <a class="code" href="a00201.html#a17a485e5749c6ff502d89a28a43c87ca">Euler1DFlux</a>;
<a name="l00154"></a>00154   solver-&gt;<a class="code" href="a00015.html#a1685cd0c6b8c413bdbbe86d8f4475c58">SFunction</a>          = <a class="code" href="a00204.html#a52dc5f992bf9d226505d94da0d45176e">Euler1DSource</a>;
<a name="l00155"></a>00155   solver-&gt;<a class="code" href="a00015.html#af1dc5a4ba2bdc46dfd226e35772b4130">UFunction</a>          = <a class="code" href="a00204.html#ae1858c7bcd504b88e0140b21e41c35bf">Euler1DModifiedSolution</a>;
<a name="l00156"></a>00156   <span class="keywordflow">if</span>      (!strcmp(physics-&gt;<a class="code" href="a00005.html#a57894a0f53d5b228bf64053367736bf9">upw_choice</a>,<a class="code" href="a00047.html#abffeadaaee7a3a2baeeb28e395411d73">_ROE_</a>    )) solver-&gt;<a class="code" href="a00015.html#a7eb68b9643feb74bd49f3a171b66eef1">Upwind</a> = <a class="code" href="a00204.html#a84fa9fe2c9c779fa314d02fd62df589f">Euler1DUpwindRoe</a>;
<a name="l00157"></a>00157   <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcmp(physics-&gt;<a class="code" href="a00005.html#a57894a0f53d5b228bf64053367736bf9">upw_choice</a>,<a class="code" href="a00047.html#a51e0f9431973e4cf55e6aeee7dab6d83">_RF_</a>     )) solver-&gt;<a class="code" href="a00015.html#a7eb68b9643feb74bd49f3a171b66eef1">Upwind</a> = <a class="code" href="a00204.html#aecab791493af24dbb79224ccdd1c22cd">Euler1DUpwindRF</a>;
<a name="l00158"></a>00158   <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcmp(physics-&gt;<a class="code" href="a00005.html#a57894a0f53d5b228bf64053367736bf9">upw_choice</a>,<a class="code" href="a00047.html#a98a6bcc1b69abface4bef84cf0d51955">_LLF_</a>    )) solver-&gt;<a class="code" href="a00015.html#a7eb68b9643feb74bd49f3a171b66eef1">Upwind</a> = <a class="code" href="a00204.html#a9f4272feb90b98823419004ad0923446">Euler1DUpwindLLF</a>;
<a name="l00159"></a>00159   <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcmp(physics-&gt;<a class="code" href="a00005.html#a57894a0f53d5b228bf64053367736bf9">upw_choice</a>,<a class="code" href="a00047.html#a930e301363fd9f0a570d97c8c3dd3ea3">_SWFS_</a>   )) solver-&gt;<a class="code" href="a00015.html#a7eb68b9643feb74bd49f3a171b66eef1">Upwind</a> = <a class="code" href="a00204.html#a0c16592ca1938504fff89a566be82a87">Euler1DUpwindSWFS</a>;
<a name="l00160"></a>00160   <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcmp(physics-&gt;<a class="code" href="a00005.html#a57894a0f53d5b228bf64053367736bf9">upw_choice</a>,<a class="code" href="a00047.html#a68e6f3e8f20e4c3a5874221661141935">_RUSANOV_</a>)) solver-&gt;<a class="code" href="a00015.html#a7eb68b9643feb74bd49f3a171b66eef1">Upwind</a> = <a class="code" href="a00204.html#a7f25dd550134d0251abac4911cff52e5">Euler1DUpwindRusanov</a>;
<a name="l00161"></a>00161   <span class="keywordflow">else</span> {
<a name="l00162"></a>00162     <span class="keywordflow">if</span> (!mpi-&gt;<a class="code" href="a00019.html#a6cfd95afd0afebd625b889fb6e58371c">rank</a>) fprintf(stderr,<span class="stringliteral">&quot;Error in Euler1DInitialize(): %s is not a valid upwinding scheme.\n&quot;</span>,
<a name="l00163"></a>00163                             physics-&gt;<a class="code" href="a00005.html#a57894a0f53d5b228bf64053367736bf9">upw_choice</a>);
<a name="l00164"></a>00164     <span class="keywordflow">return</span>(1);
<a name="l00165"></a>00165   }
<a name="l00166"></a>00166   <span class="keywordflow">if</span> (!strcmp(solver-&gt;<a class="code" href="a00015.html#a5bed0cb9665daad89f4377c4f7609df4">SplitHyperbolicFlux</a>,<span class="stringliteral">&quot;yes&quot;</span>)) {
<a name="l00167"></a>00167     solver-&gt;<a class="code" href="a00015.html#aa1dd38befc4bb4adda9d456146436b14">dFFunction</a> = <a class="code" href="a00201.html#a3017a4ade688681fa865c1556fb73f97">Euler1DStiffFlux</a>;
<a name="l00168"></a>00168     solver-&gt;<a class="code" href="a00015.html#a15eea1647344c503deb1d9f89cead631">JFunction</a>  = <a class="code" href="a00204.html#a79e3229219a9992f484df9573de95ec3">Euler1DStiffJacobian</a>;
<a name="l00169"></a>00169     <span class="keywordflow">if</span>      (!strcmp(physics-&gt;<a class="code" href="a00005.html#a57894a0f53d5b228bf64053367736bf9">upw_choice</a>,<a class="code" href="a00047.html#abffeadaaee7a3a2baeeb28e395411d73">_ROE_</a> )) solver-&gt;<a class="code" href="a00015.html#a73a85f83072e02bf979234486265b6d3">UpwinddF</a> = <a class="code" href="a00204.html#a0632e000475600a07f89aaad0fcea2a2">Euler1DUpwinddFRoe</a>;
<a name="l00170"></a>00170     <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcmp(physics-&gt;<a class="code" href="a00005.html#a57894a0f53d5b228bf64053367736bf9">upw_choice</a>,<a class="code" href="a00047.html#a51e0f9431973e4cf55e6aeee7dab6d83">_RF_</a>  )) solver-&gt;<a class="code" href="a00015.html#a73a85f83072e02bf979234486265b6d3">UpwinddF</a> = <a class="code" href="a00204.html#a2e6e98b8cf8dda3540b17764262ef7dc">Euler1DUpwinddFRF</a>;
<a name="l00171"></a>00171     <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcmp(physics-&gt;<a class="code" href="a00005.html#a57894a0f53d5b228bf64053367736bf9">upw_choice</a>,<a class="code" href="a00047.html#a98a6bcc1b69abface4bef84cf0d51955">_LLF_</a> )) solver-&gt;<a class="code" href="a00015.html#a73a85f83072e02bf979234486265b6d3">UpwinddF</a> = <a class="code" href="a00204.html#a2050afda2d76244d8b1be2534d8eee88">Euler1DUpwinddFLLF</a>;
<a name="l00172"></a>00172     <span class="keywordflow">else</span> {
<a name="l00173"></a>00173       <span class="keywordflow">if</span> (!mpi-&gt;<a class="code" href="a00019.html#a6cfd95afd0afebd625b889fb6e58371c">rank</a>) {
<a name="l00174"></a>00174         fprintf(stderr,<span class="stringliteral">&quot;Error in Euler1DInitialize(): %s is not a valid upwinding scheme &quot;</span>,
<a name="l00175"></a>00175                 physics-&gt;<a class="code" href="a00005.html#a57894a0f53d5b228bf64053367736bf9">upw_choice</a>);
<a name="l00176"></a>00176         fprintf(stderr,<span class="stringliteral">&quot;when split form of the hyperbolic flux is used. Use %s, %s or %s.\n&quot;</span>,
<a name="l00177"></a>00177                 <a class="code" href="a00047.html#abffeadaaee7a3a2baeeb28e395411d73">_ROE_</a>,<a class="code" href="a00047.html#a51e0f9431973e4cf55e6aeee7dab6d83">_RF_</a>,<a class="code" href="a00047.html#a98a6bcc1b69abface4bef84cf0d51955">_LLF_</a>);
<a name="l00178"></a>00178       }
<a name="l00179"></a>00179       <span class="keywordflow">return</span>(1);
<a name="l00180"></a>00180     }
<a name="l00181"></a>00181   } <span class="keywordflow">else</span> {
<a name="l00182"></a>00182     solver-&gt;<a class="code" href="a00015.html#aa1dd38befc4bb4adda9d456146436b14">dFFunction</a> = NULL;
<a name="l00183"></a>00183     solver-&gt;<a class="code" href="a00015.html#a73a85f83072e02bf979234486265b6d3">UpwinddF</a>   = NULL;
<a name="l00184"></a>00184     solver-&gt;<a class="code" href="a00015.html#a15eea1647344c503deb1d9f89cead631">JFunction</a>  = <a class="code" href="a00204.html#a7ab3a531ada5d839c915add13cea5ae0">Euler1DJacobian</a>;
<a name="l00185"></a>00185   }
<a name="l00186"></a>00186   solver-&gt;<a class="code" href="a00015.html#a7331366d789b2995436accbc35e1cc80">AveragingFunction</a>     = <a class="code" href="a00202.html#a25f26ae1ec34783770e761553ae617ae">Euler1DRoeAverage</a>;
<a name="l00187"></a>00187   solver-&gt;<a class="code" href="a00015.html#a8c603c73be1f08e408a1de94a088da7b">GetLeftEigenvectors</a>   = <a class="code" href="a00200.html#a1815fa0e825f5544526165566c75a619">Euler1DLeftEigenvectors</a>;
<a name="l00188"></a>00188   solver-&gt;<a class="code" href="a00015.html#a22eef349f191a1aa267e14b08140c823">GetRightEigenvectors</a>  = <a class="code" href="a00200.html#af93bb74bc4643347f59e3bdb722e864b">Euler1DRightEigenvectors</a>;
<a name="l00189"></a>00189    
<a name="l00190"></a>00190   <span class="keywordflow">if</span>      (!strcmp(physics-&gt;<a class="code" href="a00005.html#a57894a0f53d5b228bf64053367736bf9">upw_choice</a>,<a class="code" href="a00047.html#a98a6bcc1b69abface4bef84cf0d51955">_LLF_</a> )) physics-&gt;<a class="code" href="a00005.html#a3cb843ad67e4b14387b7fa21f6d4090b">SourceUpwind</a> = <a class="code" href="a00204.html#a9626db6c422f313b9762b0223f1a52da">Euler1DSourceUpwindLLF</a>;
<a name="l00191"></a>00191   <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcmp(physics-&gt;<a class="code" href="a00005.html#a57894a0f53d5b228bf64053367736bf9">upw_choice</a>,<a class="code" href="a00047.html#abffeadaaee7a3a2baeeb28e395411d73">_ROE_</a> )) physics-&gt;<a class="code" href="a00005.html#a3cb843ad67e4b14387b7fa21f6d4090b">SourceUpwind</a> = <a class="code" href="a00204.html#a564a6dcdf1979d59610503201e6f2619">Euler1DSourceUpwindRoe</a>;
<a name="l00192"></a>00192 
<a name="l00193"></a>00193   <span class="comment">/* allocate array to hold the gravity field */</span>
<a name="l00194"></a>00194   <span class="keywordtype">int</span> *dim    = solver-&gt;<a class="code" href="a00015.html#a38e0371f331cecbe63a77fa03e202afe">dim_local</a>;
<a name="l00195"></a>00195   <span class="keywordtype">int</span> ghosts  = solver-&gt;<a class="code" href="a00015.html#aafc992b5fa79d5a4036024615d03bce6">ghosts</a>;
<a name="l00196"></a>00196   <span class="keywordtype">int</span> size = 1; <span class="keywordflow">for</span> (d=0; d&lt;<a class="code" href="a00047.html#a57771c952ec174601addf43e1c0202b2">_MODEL_NDIMS_</a>; d++) size *= (dim[d] + 2*ghosts);
<a name="l00197"></a>00197   physics-&gt;<a class="code" href="a00005.html#afb1265dc9bb8f8c05bd22f88c23d879c">grav_field</a> = (<span class="keywordtype">double</span>*) calloc (size, <span class="keyword">sizeof</span>(<span class="keywordtype">double</span>));
<a name="l00198"></a>00198   physics-&gt;<a class="code" href="a00005.html#a14af7516371abe115b3a1aa9269aebb5">fast_jac</a>   = (<span class="keywordtype">double</span>*) calloc (size*<a class="code" href="a00047.html#ad3395a55a5fde64d6603c7a82d7bf2c7">_MODEL_NVARS_</a>*<a class="code" href="a00047.html#ad3395a55a5fde64d6603c7a82d7bf2c7">_MODEL_NVARS_</a>, <span class="keyword">sizeof</span>(<span class="keywordtype">double</span>));
<a name="l00199"></a>00199   physics-&gt;<a class="code" href="a00005.html#a7568fac4d4e8488510e1d37f468967b1">solution</a>   = (<span class="keywordtype">double</span>*) calloc (size*_MODEL_NVARS_, <span class="keyword">sizeof</span>(<span class="keywordtype">double</span>));
<a name="l00200"></a>00200   <a class="code" href="a00036.html#ad6ab74942c9de13cf0b4c12eb0d91780">IERR</a> <a class="code" href="a00203.html#abbbaafa694caadbccd6080cc35b89511">Euler1DGravityField</a>(solver,mpi); <a class="code" href="a00036.html#add9cf96ae374934d245a1dc1ab697a42">CHECKERR</a>(ierr);
<a name="l00201"></a>00201 
<a name="l00202"></a>00202   <span class="keywordflow">return</span>(0);
<a name="l00203"></a>00203 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a8e310ddd9664225aef72a59b99baaaef"></a><!-- doxytag: member="euler1d.h::Euler1DCleanup" ref="a8e310ddd9664225aef72a59b99baaaef" args="(void *)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int Euler1DCleanup </td>
          <td>(</td>
          <td class="paramtype">void *&nbsp;</td>
          <td class="paramname"> <em>s</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Function to clean up the 1D Euler module</p>
<p>Function to clean up all physics-related allocations for the 1D Euler equations </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>s</em>&nbsp;</td><td>Solver object of type <a class="el" href="a00015.html" title="Structure containing all solver-specific variables and functions.">HyPar</a> </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="a00198_source.html#l00010">10</a> of file <a class="el" href="a00198_source.html">Euler1DCleanup.c</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00013"></a>00013 {
<a name="l00014"></a>00014   <a class="code" href="a00005.html" title="Structure containing variables and parameters specific to the 1D Euler equations...">Euler1D</a> *param  = (<a class="code" href="a00005.html" title="Structure containing variables and parameters specific to the 1D Euler equations...">Euler1D</a>*) s;
<a name="l00015"></a>00015   free(param-&gt;<a class="code" href="a00005.html#afb1265dc9bb8f8c05bd22f88c23d879c">grav_field</a>);
<a name="l00016"></a>00016   free(param-&gt;<a class="code" href="a00005.html#a14af7516371abe115b3a1aa9269aebb5">fast_jac</a>);
<a name="l00017"></a>00017   free(param-&gt;<a class="code" href="a00005.html#a7568fac4d4e8488510e1d37f468967b1">solution</a>);
<a name="l00018"></a>00018   <span class="keywordflow">return</span>(0);
<a name="l00019"></a>00019 }
</pre></div></p>

</div>
</div>
</div>
<!-- Start of StatCounter Code for Default Guide -->
<script type="text/javascript">
var sc_project=10897352; 
var sc_invisible=1; 
var sc_security="83042f57"; 
var scJsHost = (("https:" == document.location.protocol) ?
"https://secure." : "http://www.");
document.write("<sc"+"ript type='text/javascript' src='" +
scJsHost+
"statcounter.com/counter/counter.js'></"+"script>");
</script>
<noscript><div class="statcounter"><a title="website
statistics" href="http://statcounter.com/"
target="_blank"><img class="statcounter"
src="//c.statcounter.com/10897352/0/83042f57/1/"
alt="website statistics"></a></div></noscript>
<!-- End of StatCounter Code for Default Guide -->
