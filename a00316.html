<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.5"/>
<title>HyPar: src/HyParFunctions/HyperbolicFunction_GPU.cu File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script><script src="http://cdn.mathjax.org/mathjax/latest/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="doxygen_html_style.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">HyPar
   &#160;<span id="projectnumber">1.0</span>
   </div>
   <div id="projectbrief">Finite-Difference Hyperbolic-Parabolic PDE Solver on Cartesian Grids</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.5 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Structures</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>Globals</span></a></li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('a00316.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Data Structures</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Namespaces</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(9)"><span class="SelectionMark">&#160;</span>Macros</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(10)"><span class="SelectionMark">&#160;</span>Pages</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">HyperbolicFunction_GPU.cu File Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>Compute the hyperbolic term of the governing equations.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &lt;<a class="el" href="a00232_source.html">arrayfunctions_gpu.h</a>&gt;</code><br/>
<code>#include &lt;<a class="el" href="a00234_source.html">basic_gpu.h</a>&gt;</code><br/>
<code>#include &lt;<a class="el" href="a00250_source.html">mpivars.h</a>&gt;</code><br/>
<code>#include &lt;<a class="el" href="a00240_source.html">hypar.h</a>&gt;</code><br/>
</div>
<p><a href="a00316_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:ae6e53860597b32435f6ad086401e11a1"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00316.html#ae6e53860597b32435f6ad086401e11a1">ReconstructHyperbolic</a> (double *, double *, double *, double *, int, void *, void *, double, int, int(*)(double *, double *, double *, double *, double *, double *, int, void *, double))</td></tr>
<tr class="separator:ae6e53860597b32435f6ad086401e11a1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab0afa96eb227a6b066ba4844b4dc11a7"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00316.html#ab0afa96eb227a6b066ba4844b4dc11a7">DefaultUpwinding</a> (double *, double *, double *, double *, double *, double *, int, void *, double)</td></tr>
<tr class="separator:ab0afa96eb227a6b066ba4844b4dc11a7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab03015246d25ae9553854e80d75e46db"><td class="memTemplParams" colspan="2">template&lt;int block_size&gt; </td></tr>
<tr class="memitem:ab03015246d25ae9553854e80d75e46db"><td class="memTemplItemLeft" align="right" valign="top">__global__ void&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="a00316.html#ab03015246d25ae9553854e80d75e46db">StageBoundaryIntegral_kernel</a> (int n, int nvars, int <a class="el" href="a00245.html#a1e471b644e7fd684cd5dbb144e00ee81">sign</a>, const double *__restrict__ FluxI, double *__restrict__ StageBoundaryIntegral)</td></tr>
<tr class="separator:ab03015246d25ae9553854e80d75e46db"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac2ee4715bb0f60cc541ea469bb82d51f"><td class="memItemLeft" align="right" valign="top">__global__ void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00316.html#ac2ee4715bb0f60cc541ea469bb82d51f">HyperbolicFunction_dim3_kernel</a> (int npoints_grid, int npoints_local_wghosts, int npoints_dim_interface, int d, int nvars, int ghosts, int offset, const int *__restrict__ dim, const double *__restrict__ FluxI, const double *__restrict__ dxinv, double *__restrict__ hyp, double *__restrict__ FluxI_p1, double *__restrict__ FluxI_p2)</td></tr>
<tr class="separator:ac2ee4715bb0f60cc541ea469bb82d51f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1e78fb9da89089d6cc5837ab14916e7f"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00316.html#a1e78fb9da89089d6cc5837ab14916e7f">gpuHyperbolicFunction</a> (double *hyp, double *u, void *s, void *m, double t, int LimFlag, int(*FluxFunction)(double *, double *, int, void *, double), int(*UpwindFunction)(double *, double *, double *, double *, double *, double *, int, void *, double))</td></tr>
<tr class="separator:a1e78fb9da89089d6cc5837ab14916e7f"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Compute the hyperbolic term of the governing equations. </p>
<dl class="section author"><dt>Author</dt><dd>Youngdae Kim </dd></dl>

<p>Definition in file <a class="el" href="a00316_source.html">HyperbolicFunction_GPU.cu</a>.</p>
</div><h2 class="groupheader">Function Documentation</h2>
<a class="anchor" id="ae6e53860597b32435f6ad086401e11a1"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int ReconstructHyperbolic </td>
          <td>(</td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>fluxI</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>fluxC</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>u</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>dir</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>s</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>m</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>t</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>LimFlag</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int(*)(double *, double *, double *, double *, double *, double *, int, void *, double)&#160;</td>
          <td class="paramname"><em>UpwindFunction</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>This function computes the numerical flux \(\hat{\bf f}_{j+1/2}\) at the interface from the cell-centered flux function \({\bf f}_j\). This happens in two steps:-</p>
<p><b>Interpolation:</b> High-order accurate approximations to the flux at the interface \(j+1/2\) are computed from the cell-centered flux with left- and right-biased interpolation methods. This is done by the <a class="el" href="a00204.html#a17e1cfc7de4fe33c6ee88f2cc42883e7">HyPar::InterpolateInterfacesHyp</a> function. This can be expressed as follows: </p>
<p class="formulaDsp">
\begin{align} \hat{\bf f}^L_{j+1/2} &amp;= \mathcal{I}\left({\bf f}_j,+1\right), \\ \hat{\bf f}^R_{j+1/2} &amp;= \mathcal{I}\left({\bf f}_j,-1\right), \end{align}
</p>
<p> where the \(\pm 1\) indicates the interpolation bias, and \(\mathcal{I}\) is the interpolation operator pointed to by <a class="el" href="a00204.html#a17e1cfc7de4fe33c6ee88f2cc42883e7">HyPar::InterpolateInterfacesHyp</a> (see <b>src/InterpolationFunctions</b> for all the available operators). The interface values of the solution are similarly computed: </p>
<p class="formulaDsp">
\begin{align} \hat{\bf u}^L_{j+1/2} &amp;= \mathcal{I}\left({\bf u}_j,+1\right), \\ \hat{\bf u}^R_{j+1/2} &amp;= \mathcal{I}\left({\bf u}_j,-1\right), \end{align}
</p>
<p> The specific choice of \(\mathcal{I}\) is set based on <a class="el" href="a00204.html#ad29846eeb9c83b329a8d7c1fe69d46b2">HyPar::spatial_scheme_hyp</a>.</p>
<p><b>Upwinding:</b> The final flux at the interface is computed as </p>
<p class="formulaDsp">
\begin{equation} \hat{\bf f}_{j+1/2} = \mathcal{U}\left( \hat{\bf f}^L_{j+1/2}, \hat{\bf f}^R_{j+1/2}, \hat{\bf u}^L_{j+1/2}, \hat{\bf u}^R_{j+1/2} \right), \end{equation}
</p>
<p> where \(\mathcal{U}\) denotes the upwinding function UpwindFunction() passed as an argument (if NULL, <a class="el" href="a00316.html#ab0afa96eb227a6b066ba4844b4dc11a7">DefaultUpwinding()</a> is used). The upwinding function is specified by the physical model.</p>
<p><b>Note:</b> Solution-dependent, nonlinear interpolation methods (such as WENO, CRWENO) are implemented in a way that separates the calculation of the nonlinear interpolation weights (based on, say, the smoothness of the flux function), and the actual evaluation of the interpolant, into different functions. This allows the flexibility to choose if and when the nonlinear coefficients are evaluated (or previously computed values are reused). Some possible scenarios are:</p>
<ul>
<li>For explicit time integration, they are computed every time the hyperbolic flux term is being computed.</li>
<li>For implicit time integration, consistency or linearization may require that they be computed and "frozen" at the beginning of a time step or stage.</li>
</ul>
<p>The argument <b>LimFlag</b> controls this behavior:</p>
<ul>
<li>LimFlag = 1 means recompute the nonlinear coefficients.</li>
<li>LimFlag = 0 means reuse the the previously computed coefficients. </li>
</ul>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">fluxI</td><td>Array to hold the computed interface fluxes. This array does not have ghost points. The dimensions are the same as those of u without ghost points in all dimensions, except along dir, where it is one more </td></tr>
    <tr><td class="paramname">fluxC</td><td>Array of the flux function computed at the cell centers (same layout as u) </td></tr>
    <tr><td class="paramname">u</td><td>Solution array </td></tr>
    <tr><td class="paramname">x</td><td>Array of spatial coordinates </td></tr>
    <tr><td class="paramname">dir</td><td>Spatial dimension along which to reconstruct the interface fluxes </td></tr>
    <tr><td class="paramname">s</td><td>Solver object of type <a class="el" href="a00204.html" title="Structure containing all solver-specific variables and functions. ">HyPar</a> </td></tr>
    <tr><td class="paramname">m</td><td>MPI object of type <a class="el" href="a00207.html#a00674" title="Structure of MPI-related variables. ">MPIVariables</a> </td></tr>
    <tr><td class="paramname">t</td><td>Current solution time </td></tr>
    <tr><td class="paramname">LimFlag</td><td>Flag to indicate if the nonlinear coefficients for solution-dependent interpolation method should be recomputed </td></tr>
    <tr><td class="paramname">UpwindFunction</td><td>Function pointer to the upwinding function for the interface flux computation. If NULL, <a class="el" href="a00316.html#ab0afa96eb227a6b066ba4844b4dc11a7">DefaultUpwinding()</a> will be used. </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="a00316_source.html#l00629">629</a> of file <a class="el" href="a00316_source.html">HyperbolicFunction_GPU.cu</a>.</p>
<div class="fragment"><div class="line"><a name="l00648"></a><span class="lineno">  648</span>&#160;{</div>
<div class="line"><a name="l00649"></a><span class="lineno">  649</span>&#160;  <a class="code" href="a00204.html">HyPar</a>         *solver = (<a class="code" href="a00204.html">HyPar</a>*)        s;</div>
<div class="line"><a name="l00650"></a><span class="lineno">  650</span>&#160;  <a class="code" href="a00207.html#a00674">MPIVariables</a>  *mpi    = (<a class="code" href="a00207.html#a00674">MPIVariables</a>*) m;</div>
<div class="line"><a name="l00651"></a><span class="lineno">  651</span>&#160;</div>
<div class="line"><a name="l00652"></a><span class="lineno">  652</span>&#160;  <span class="keywordtype">double</span> *uC     = NULL;</div>
<div class="line"><a name="l00653"></a><span class="lineno">  653</span>&#160;  <span class="keywordtype">double</span> *uL     = solver-&gt;<a class="code" href="a00204.html#a8452297a324a34268a6565583901347d">uL</a>;</div>
<div class="line"><a name="l00654"></a><span class="lineno">  654</span>&#160;  <span class="keywordtype">double</span> *uR     = solver-&gt;<a class="code" href="a00204.html#a3c811b25c11d2c98bfff02ddeadeb3d9">uR</a>;</div>
<div class="line"><a name="l00655"></a><span class="lineno">  655</span>&#160;  <span class="keywordtype">double</span> *fluxL  = solver-&gt;<a class="code" href="a00204.html#a99f72a44e29089b75fd11155bfcc1ff8">fL</a>;</div>
<div class="line"><a name="l00656"></a><span class="lineno">  656</span>&#160;  <span class="keywordtype">double</span> *fluxR  = solver-&gt;<a class="code" href="a00204.html#abb50b7a404febaf647f7bd89f873b96e">fR</a>;</div>
<div class="line"><a name="l00657"></a><span class="lineno">  657</span>&#160;</div>
<div class="line"><a name="l00658"></a><span class="lineno">  658</span>&#160;  <span class="comment">/*</span></div>
<div class="line"><a name="l00659"></a><span class="lineno">  659</span>&#160;<span class="comment">    precalculate the non-linear interpolation coefficients if required</span></div>
<div class="line"><a name="l00660"></a><span class="lineno">  660</span>&#160;<span class="comment">    else reuse the weights previously calculated</span></div>
<div class="line"><a name="l00661"></a><span class="lineno">  661</span>&#160;<span class="comment">  */</span></div>
<div class="line"><a name="l00662"></a><span class="lineno">  662</span>&#160;</div>
<div class="line"><a name="l00663"></a><span class="lineno">  663</span>&#160;  <span class="keywordflow">if</span> (LimFlag) solver-&gt;<a class="code" href="a00204.html#afeeb150a9699ade5eccc7589fcae3fe0">SetInterpLimiterVar</a>(fluxC,u,x,dir,solver,mpi);</div>
<div class="line"><a name="l00664"></a><span class="lineno">  664</span>&#160;</div>
<div class="line"><a name="l00665"></a><span class="lineno">  665</span>&#160;  <span class="comment">/* if defined, calculate the modified u-function to be used for upwinding</span></div>
<div class="line"><a name="l00666"></a><span class="lineno">  666</span>&#160;<span class="comment">     e.g.: used in well-balanced schemes for Euler/Navier-Stokes with gravity</span></div>
<div class="line"><a name="l00667"></a><span class="lineno">  667</span>&#160;<span class="comment">     otherwise, just copy u to uC */</span></div>
<div class="line"><a name="l00668"></a><span class="lineno">  668</span>&#160;  <span class="keywordflow">if</span> (solver-&gt;<a class="code" href="a00204.html#af1dc5a4ba2bdc46dfd226e35772b4130">UFunction</a>) {</div>
<div class="line"><a name="l00669"></a><span class="lineno">  669</span>&#160;    uC = solver-&gt;<a class="code" href="a00204.html#a86221feda74097db9eb6c900ca1e6cbc">uC</a>;</div>
<div class="line"><a name="l00670"></a><span class="lineno">  670</span>&#160;    solver-&gt;<a class="code" href="a00204.html#af1dc5a4ba2bdc46dfd226e35772b4130">UFunction</a>(uC,u,dir,solver,mpi,t);</div>
<div class="line"><a name="l00671"></a><span class="lineno">  671</span>&#160;  } <span class="keywordflow">else</span> uC = u;</div>
<div class="line"><a name="l00672"></a><span class="lineno">  672</span>&#160;</div>
<div class="line"><a name="l00673"></a><span class="lineno">  673</span>&#160;</div>
<div class="line"><a name="l00674"></a><span class="lineno">  674</span>&#160;  <span class="comment">/* Interpolation -&gt; to calculate left and right-biased interface flux and state variable*/</span></div>
<div class="line"><a name="l00675"></a><span class="lineno">  675</span>&#160;  solver-&gt;<a class="code" href="a00204.html#a17e1cfc7de4fe33c6ee88f2cc42883e7">InterpolateInterfacesHyp</a>(uL   ,uC   ,u,x, 1,dir,solver,mpi,1);</div>
<div class="line"><a name="l00676"></a><span class="lineno">  676</span>&#160;  solver-&gt;<a class="code" href="a00204.html#a17e1cfc7de4fe33c6ee88f2cc42883e7">InterpolateInterfacesHyp</a>(uR   ,uC   ,u,x,-1,dir,solver,mpi,1);</div>
<div class="line"><a name="l00677"></a><span class="lineno">  677</span>&#160;  solver-&gt;<a class="code" href="a00204.html#a17e1cfc7de4fe33c6ee88f2cc42883e7">InterpolateInterfacesHyp</a>(fluxL,fluxC,u,x, 1,dir,solver,mpi,0);</div>
<div class="line"><a name="l00678"></a><span class="lineno">  678</span>&#160;  solver-&gt;<a class="code" href="a00204.html#a17e1cfc7de4fe33c6ee88f2cc42883e7">InterpolateInterfacesHyp</a>(fluxR,fluxC,u,x,-1,dir,solver,mpi,0);</div>
<div class="line"><a name="l00679"></a><span class="lineno">  679</span>&#160;</div>
<div class="line"><a name="l00680"></a><span class="lineno">  680</span>&#160;  <span class="comment">/* Upwind -&gt; to calculate the final interface flux */</span></div>
<div class="line"><a name="l00681"></a><span class="lineno">  681</span>&#160;  <span class="keywordflow">if</span> (UpwindFunction) { UpwindFunction   (fluxI,fluxL,fluxR,uL,uR,u,dir,solver,t); }</div>
<div class="line"><a name="l00682"></a><span class="lineno">  682</span>&#160;  <span class="keywordflow">else</span>                { <a class="code" href="a00316.html#ab0afa96eb227a6b066ba4844b4dc11a7">DefaultUpwinding</a> (fluxI,fluxL,fluxR,NULL,NULL,NULL,dir,solver,t); }</div>
<div class="line"><a name="l00683"></a><span class="lineno">  683</span>&#160;</div>
<div class="line"><a name="l00684"></a><span class="lineno">  684</span>&#160;  <span class="keywordflow">return</span>(0);</div>
<div class="line"><a name="l00685"></a><span class="lineno">  685</span>&#160;}</div>
<div class="ttc" id="a00204_html_a3c811b25c11d2c98bfff02ddeadeb3d9"><div class="ttname"><a href="a00204.html#a3c811b25c11d2c98bfff02ddeadeb3d9">HyPar::uR</a></div><div class="ttdeci">double * uR</div><div class="ttdef"><b>Definition:</b> <a href="a00240_source.html#l00139">hypar.h:139</a></div></div>
<div class="ttc" id="a00204_html_a8452297a324a34268a6565583901347d"><div class="ttname"><a href="a00204.html#a8452297a324a34268a6565583901347d">HyPar::uL</a></div><div class="ttdeci">double * uL</div><div class="ttdef"><b>Definition:</b> <a href="a00240_source.html#l00139">hypar.h:139</a></div></div>
<div class="ttc" id="a00204_html_a99f72a44e29089b75fd11155bfcc1ff8"><div class="ttname"><a href="a00204.html#a99f72a44e29089b75fd11155bfcc1ff8">HyPar::fL</a></div><div class="ttdeci">double * fL</div><div class="ttdef"><b>Definition:</b> <a href="a00240_source.html#l00139">hypar.h:139</a></div></div>
<div class="ttc" id="a00204_html_afeeb150a9699ade5eccc7589fcae3fe0"><div class="ttname"><a href="a00204.html#afeeb150a9699ade5eccc7589fcae3fe0">HyPar::SetInterpLimiterVar</a></div><div class="ttdeci">int(* SetInterpLimiterVar)(double *, double *, double *, int, void *, void *)</div><div class="ttdef"><b>Definition:</b> <a href="a00240_source.html#l00234">hypar.h:234</a></div></div>
<div class="ttc" id="a00204_html_a86221feda74097db9eb6c900ca1e6cbc"><div class="ttname"><a href="a00204.html#a86221feda74097db9eb6c900ca1e6cbc">HyPar::uC</a></div><div class="ttdeci">double * uC</div><div class="ttdef"><b>Definition:</b> <a href="a00240_source.html#l00131">hypar.h:131</a></div></div>
<div class="ttc" id="a00204_html_a17e1cfc7de4fe33c6ee88f2cc42883e7"><div class="ttname"><a href="a00204.html#a17e1cfc7de4fe33c6ee88f2cc42883e7">HyPar::InterpolateInterfacesHyp</a></div><div class="ttdeci">int(* InterpolateInterfacesHyp)(double *, double *, double *, double *, int, int, void *, void *, int)</div><div class="ttdef"><b>Definition:</b> <a href="a00240_source.html#l00224">hypar.h:224</a></div></div>
<div class="ttc" id="a00204_html_af1dc5a4ba2bdc46dfd226e35772b4130"><div class="ttname"><a href="a00204.html#af1dc5a4ba2bdc46dfd226e35772b4130">HyPar::UFunction</a></div><div class="ttdeci">int(* UFunction)(double *, double *, int, void *, void *, double)</div><div class="ttdef"><b>Definition:</b> <a href="a00240_source.html#l00321">hypar.h:321</a></div></div>
<div class="ttc" id="a00316_html_ab0afa96eb227a6b066ba4844b4dc11a7"><div class="ttname"><a href="a00316.html#ab0afa96eb227a6b066ba4844b4dc11a7">DefaultUpwinding</a></div><div class="ttdeci">static int DefaultUpwinding(double *, double *, double *, double *, double *, double *, int, void *, double)</div><div class="ttdef"><b>Definition:</b> <a href="a00316_source.html#l00691">HyperbolicFunction_GPU.cu:691</a></div></div>
<div class="ttc" id="a00207_html_a00674"><div class="ttname"><a href="a00207.html#a00674">MPIVariables</a></div><div class="ttdoc">Structure of MPI-related variables. </div><div class="ttdef"><b>Definition:</b> <a href="a00207_source.html#l00024">mpivars_struct.h:24</a></div></div>
<div class="ttc" id="a00204_html"><div class="ttname"><a href="a00204.html">HyPar</a></div><div class="ttdoc">Structure containing all solver-specific variables and functions. </div><div class="ttdef"><b>Definition:</b> <a href="a00240_source.html#l00023">hypar.h:23</a></div></div>
<div class="ttc" id="a00204_html_abb50b7a404febaf647f7bd89f873b96e"><div class="ttname"><a href="a00204.html#abb50b7a404febaf647f7bd89f873b96e">HyPar::fR</a></div><div class="ttdeci">double * fR</div><div class="ttdef"><b>Definition:</b> <a href="a00240_source.html#l00139">hypar.h:139</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ab0afa96eb227a6b066ba4844b4dc11a7"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int DefaultUpwinding </td>
          <td>(</td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>fI</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>fL</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>fR</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>uL</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>uR</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>u</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>dir</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>s</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>t</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>If no upwinding scheme is specified, this function defines the "upwind" flux as the arithmetic mean of the left- and right-biased fluxes. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">fI</td><td>Computed upwind interface flux </td></tr>
    <tr><td class="paramname">fL</td><td>Left-biased reconstructed interface flux </td></tr>
    <tr><td class="paramname">fR</td><td>Right-biased reconstructed interface flux </td></tr>
    <tr><td class="paramname">uL</td><td>Left-biased reconstructed interface solution </td></tr>
    <tr><td class="paramname">uR</td><td>Right-biased reconstructed interface solution </td></tr>
    <tr><td class="paramname">u</td><td>Cell-centered solution </td></tr>
    <tr><td class="paramname">dir</td><td>Spatial dimension </td></tr>
    <tr><td class="paramname">s</td><td>Solver object of type <a class="el" href="a00204.html" title="Structure containing all solver-specific variables and functions. ">HyPar</a> </td></tr>
    <tr><td class="paramname">t</td><td>Current solution time </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="a00316_source.html#l00691">691</a> of file <a class="el" href="a00316_source.html">HyperbolicFunction_GPU.cu</a>.</p>
<div class="fragment"><div class="line"><a name="l00702"></a><span class="lineno">  702</span>&#160;{</div>
<div class="line"><a name="l00703"></a><span class="lineno">  703</span>&#160;  <a class="code" href="a00204.html">HyPar</a> *solver = (<a class="code" href="a00204.html">HyPar</a>*)    s;</div>
<div class="line"><a name="l00704"></a><span class="lineno">  704</span>&#160;  <span class="keywordtype">int</span>   done;</div>
<div class="line"><a name="l00705"></a><span class="lineno">  705</span>&#160;</div>
<div class="line"><a name="l00706"></a><span class="lineno">  706</span>&#160;  <span class="keywordtype">int</span> *dim  = solver-&gt;<a class="code" href="a00204.html#a38e0371f331cecbe63a77fa03e202afe">dim_local</a>;</div>
<div class="line"><a name="l00707"></a><span class="lineno">  707</span>&#160;  <span class="keywordtype">int</span> ndims = solver-&gt;<a class="code" href="a00204.html#a484873c74138512e41bc50d17b7d955a">ndims</a>;</div>
<div class="line"><a name="l00708"></a><span class="lineno">  708</span>&#160;  <span class="keywordtype">int</span> nvars = solver-&gt;<a class="code" href="a00204.html#ae8f6d2fd6490d3153cb4133bf183a404">nvars</a>;</div>
<div class="line"><a name="l00709"></a><span class="lineno">  709</span>&#160;</div>
<div class="line"><a name="l00710"></a><span class="lineno">  710</span>&#160;  <span class="keywordtype">int</span> bounds_outer[ndims], bounds_inter[ndims];</div>
<div class="line"><a name="l00711"></a><span class="lineno">  711</span>&#160;  <a class="code" href="a00231.html#a89e8330d9e06dd0666c50833628a125c">_ArrayCopy1D_</a>(dim,bounds_outer,ndims); bounds_outer[dir] =  1;</div>
<div class="line"><a name="l00712"></a><span class="lineno">  712</span>&#160;  <a class="code" href="a00231.html#a89e8330d9e06dd0666c50833628a125c">_ArrayCopy1D_</a>(dim,bounds_inter,ndims); bounds_inter[dir] += 1;</div>
<div class="line"><a name="l00713"></a><span class="lineno">  713</span>&#160;</div>
<div class="line"><a name="l00714"></a><span class="lineno">  714</span>&#160;  done = 0; <span class="keywordtype">int</span> index_outer[ndims], index_inter[ndims];</div>
<div class="line"><a name="l00715"></a><span class="lineno">  715</span>&#160;  <a class="code" href="a00231.html#a2b2826031c0cd92495ab351d3e599fc5">_ArraySetValue_</a>(index_outer,ndims,0);</div>
<div class="line"><a name="l00716"></a><span class="lineno">  716</span>&#160;  <span class="keywordflow">while</span> (!done) {</div>
<div class="line"><a name="l00717"></a><span class="lineno">  717</span>&#160;    <a class="code" href="a00231.html#a89e8330d9e06dd0666c50833628a125c">_ArrayCopy1D_</a>(index_outer,index_inter,ndims);</div>
<div class="line"><a name="l00718"></a><span class="lineno">  718</span>&#160;    <span class="keywordflow">for</span> (index_inter[dir] = 0; index_inter[dir] &lt; bounds_inter[dir]; index_inter[dir]++) {</div>
<div class="line"><a name="l00719"></a><span class="lineno">  719</span>&#160;      <span class="keywordtype">int</span> p; <a class="code" href="a00231.html#afbb862a2fdf5b72b1f9ace42f64b556f">_ArrayIndex1D_</a>(ndims,bounds_inter,index_inter,0,p);</div>
<div class="line"><a name="l00720"></a><span class="lineno">  720</span>&#160;      <span class="keywordtype">int</span> v; <span class="keywordflow">for</span> (v=0; v&lt;nvars; v++) fI[nvars*p+v] = 0.5 * (fL[nvars*p+v]+fR[nvars*p+v]);</div>
<div class="line"><a name="l00721"></a><span class="lineno">  721</span>&#160;    }</div>
<div class="line"><a name="l00722"></a><span class="lineno">  722</span>&#160;    <a class="code" href="a00231.html#ac5ec1371623f11d03b0f42adaa24acbc">_ArrayIncrementIndex_</a>(ndims,bounds_outer,index_outer,done);</div>
<div class="line"><a name="l00723"></a><span class="lineno">  723</span>&#160;  }</div>
<div class="line"><a name="l00724"></a><span class="lineno">  724</span>&#160;</div>
<div class="line"><a name="l00725"></a><span class="lineno">  725</span>&#160;  <span class="keywordflow">return</span>(0);</div>
<div class="line"><a name="l00726"></a><span class="lineno">  726</span>&#160;}</div>
<div class="ttc" id="a00231_html_a2b2826031c0cd92495ab351d3e599fc5"><div class="ttname"><a href="a00231.html#a2b2826031c0cd92495ab351d3e599fc5">_ArraySetValue_</a></div><div class="ttdeci">#define _ArraySetValue_(x, size, value)</div><div class="ttdef"><b>Definition:</b> <a href="a00231_source.html#l00169">arrayfunctions.h:169</a></div></div>
<div class="ttc" id="a00231_html_ac5ec1371623f11d03b0f42adaa24acbc"><div class="ttname"><a href="a00231.html#ac5ec1371623f11d03b0f42adaa24acbc">_ArrayIncrementIndex_</a></div><div class="ttdeci">#define _ArrayIncrementIndex_(N, imax, i, done)</div><div class="ttdef"><b>Definition:</b> <a href="a00231_source.html#l00126">arrayfunctions.h:126</a></div></div>
<div class="ttc" id="a00204_html_a38e0371f331cecbe63a77fa03e202afe"><div class="ttname"><a href="a00204.html#a38e0371f331cecbe63a77fa03e202afe">HyPar::dim_local</a></div><div class="ttdeci">int * dim_local</div><div class="ttdef"><b>Definition:</b> <a href="a00240_source.html#l00037">hypar.h:37</a></div></div>
<div class="ttc" id="a00231_html_afbb862a2fdf5b72b1f9ace42f64b556f"><div class="ttname"><a href="a00231.html#afbb862a2fdf5b72b1f9ace42f64b556f">_ArrayIndex1D_</a></div><div class="ttdeci">#define _ArrayIndex1D_(N, imax, i, ghost, index)</div><div class="ttdef"><b>Definition:</b> <a href="a00231_source.html#l00040">arrayfunctions.h:40</a></div></div>
<div class="ttc" id="a00231_html_a89e8330d9e06dd0666c50833628a125c"><div class="ttname"><a href="a00231.html#a89e8330d9e06dd0666c50833628a125c">_ArrayCopy1D_</a></div><div class="ttdeci">#define _ArrayCopy1D_(x, y, size)</div><div class="ttdef"><b>Definition:</b> <a href="a00231_source.html#l00319">arrayfunctions.h:319</a></div></div>
<div class="ttc" id="a00204_html_ae8f6d2fd6490d3153cb4133bf183a404"><div class="ttname"><a href="a00204.html#ae8f6d2fd6490d3153cb4133bf183a404">HyPar::nvars</a></div><div class="ttdeci">int nvars</div><div class="ttdef"><b>Definition:</b> <a href="a00240_source.html#l00029">hypar.h:29</a></div></div>
<div class="ttc" id="a00204_html_a484873c74138512e41bc50d17b7d955a"><div class="ttname"><a href="a00204.html#a484873c74138512e41bc50d17b7d955a">HyPar::ndims</a></div><div class="ttdeci">int ndims</div><div class="ttdef"><b>Definition:</b> <a href="a00240_source.html#l00026">hypar.h:26</a></div></div>
<div class="ttc" id="a00204_html"><div class="ttname"><a href="a00204.html">HyPar</a></div><div class="ttdoc">Structure containing all solver-specific variables and functions. </div><div class="ttdef"><b>Definition:</b> <a href="a00240_source.html#l00023">hypar.h:23</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ab03015246d25ae9553854e80d75e46db"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">__global__ void StageBoundaryIntegral_kernel </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>n</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>nvars</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>sign</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double *__restrict__&#160;</td>
          <td class="paramname"><em>FluxI</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *__restrict__&#160;</td>
          <td class="paramname"><em>StageBoundaryIntegral</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Kernel for stage boundary integral calculation </p>

<p>Definition at line <a class="el" href="a00316_source.html#l00020">20</a> of file <a class="el" href="a00316_source.html">HyperbolicFunction_GPU.cu</a>.</p>
<div class="fragment"><div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;{</div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;  <span class="keyword">extern</span> __shared__ <span class="keywordtype">double</span> smem[];</div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;</div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;  <span class="keywordtype">int</span> tid        = threadIdx.x;</div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;  <span class="keywordtype">int</span> grid_size  = block_size * gridDim.x;</div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;  <span class="keywordtype">int</span> i          = blockIdx.x * block_size + threadIdx.x;</div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;  <span class="keywordtype">int</span> j;</div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;  <span class="keywordtype">double</span> tid_sum[<a class="code" href="a00234.html#ad46540bfba001ca555ff597fd3f3a565">GPU_MAX_NVARS</a>] = { 0 };</div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;</div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;  <span class="keywordflow">while</span> (i &lt; n) {</div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;    <span class="keywordflow">for</span> (j=0; j&lt;nvars; j++) tid_sum[j] += FluxI[i*nvars+j];</div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;    i += grid_size;</div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;  }</div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;  <span class="keywordflow">for</span> (j=0; j&lt;nvars; j++) smem[tid*nvars+j] = tid_sum[j];</div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;  __syncthreads();</div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;</div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;</div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;  <span class="keywordflow">if</span> (block_size &gt;= 512 &amp;&amp; tid &lt; 256) {</div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;    <span class="keywordflow">for</span> (j=0; j&lt;nvars; j++) smem[tid*nvars+j] = tid_sum[j] = tid_sum[j] + smem[(tid+256)*nvars+j];</div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;  }</div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;  __syncthreads();</div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;  <span class="keywordflow">if</span> (block_size &gt;= 256 &amp;&amp; tid &lt; 128) {</div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;    <span class="keywordflow">for</span> (j=0; j&lt;nvars; j++) smem[tid*nvars+j] = tid_sum[j] = tid_sum[j] + smem[(tid+128)*nvars+j];</div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;  }</div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;  __syncthreads();</div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;  <span class="keywordflow">if</span> (block_size &gt;= 128 &amp;&amp; tid &lt; 64) {</div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;    <span class="keywordflow">for</span> (j=0; j&lt;nvars; j++) smem[tid*nvars+j] = tid_sum[j] = tid_sum[j] + smem[(tid+64)*nvars+j];</div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;  }</div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;  __syncthreads();</div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;</div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;  <span class="keywordflow">if</span> (tid &lt; 32) {</div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;    <span class="keywordflow">if</span> (block_size &gt;= 64) {</div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;      <span class="keywordflow">for</span> (j=0; j&lt;nvars; j++) tid_sum[j] += smem[(tid+32)*nvars+j];</div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;    }</div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> offset=16; offset&gt;0; offset/=2) {</div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;      <span class="keywordflow">for</span> (j=0; j&lt;nvars; j++) {</div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;        tid_sum[j] += __shfl_down_sync(0xffffffff, tid_sum[j], offset);</div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;      }</div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;    }</div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;  }</div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;  __syncthreads();</div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;</div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;  <span class="keywordflow">if</span> (tid == 0) {</div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;    <span class="keywordflow">for</span> (j=0; j&lt;nvars; j++) StageBoundaryIntegral[j] = (<a class="code" href="a00245.html#a1e471b644e7fd684cd5dbb144e00ee81">sign</a> == 1) ? tid_sum[j] : -tid_sum[j];</div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;  }</div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;  <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;}</div>
<div class="ttc" id="a00234_html_ad46540bfba001ca555ff597fd3f3a565"><div class="ttname"><a href="a00234.html#ad46540bfba001ca555ff597fd3f3a565">GPU_MAX_NVARS</a></div><div class="ttdeci">#define GPU_MAX_NVARS</div><div class="ttdef"><b>Definition:</b> <a href="a00234_source.html#l00009">basic_gpu.h:9</a></div></div>
<div class="ttc" id="a00245_html_a1e471b644e7fd684cd5dbb144e00ee81"><div class="ttname"><a href="a00245.html#a1e471b644e7fd684cd5dbb144e00ee81">sign</a></div><div class="ttdeci">#define sign(a)</div><div class="ttdef"><b>Definition:</b> <a href="a00245_source.html#l00054">math_ops.h:54</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ac2ee4715bb0f60cc541ea469bb82d51f"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">__global__ void HyperbolicFunction_dim3_kernel </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>npoints_grid</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>npoints_local_wghosts</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>npoints_dim_interface</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>d</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>nvars</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>ghosts</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>offset</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int *__restrict__&#160;</td>
          <td class="paramname"><em>dim</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double *__restrict__&#160;</td>
          <td class="paramname"><em>FluxI</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double *__restrict__&#160;</td>
          <td class="paramname"><em>dxinv</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *__restrict__&#160;</td>
          <td class="paramname"><em>hyp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *__restrict__&#160;</td>
          <td class="paramname"><em>FluxI_p1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *__restrict__&#160;</td>
          <td class="paramname"><em>FluxI_p2</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>3D Kernel for <a class="el" href="a00316.html#a1e78fb9da89089d6cc5837ab14916e7f">gpuHyperbolicFunction()</a> </p>

<p>Definition at line <a class="el" href="a00316_source.html#l00406">406</a> of file <a class="el" href="a00316_source.html">HyperbolicFunction_GPU.cu</a>.</p>
<div class="fragment"><div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;{</div>
<div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;    <span class="keywordtype">int</span> tx = threadIdx.x + (blockDim.x * blockIdx.x);</div>
<div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;    <span class="keywordflow">if</span> (tx &lt; npoints_grid) {</div>
<div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;        <span class="keywordtype">int</span> v, p, p1, p2, b;</div>
<div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;        <span class="keywordtype">int</span> dim_interface[3];</div>
<div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;        <span class="keywordtype">int</span> index[3], index1[3], index2[3];</div>
<div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;</div>
<div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;        <a class="code" href="a00231.html#a03f49e4d44ae8aca85cb04cfe91e4ce4">_ArrayIndexnD_</a>(3,tx,dim,index,0);</div>
<div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;        <a class="code" href="a00231.html#a89e8330d9e06dd0666c50833628a125c">_ArrayCopy1D_</a>(dim,dim_interface,3);</div>
<div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;        dim_interface[d] += 1;</div>
<div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;</div>
<div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;        <a class="code" href="a00231.html#a89e8330d9e06dd0666c50833628a125c">_ArrayCopy1D_</a>(index,index1,3);</div>
<div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;        <a class="code" href="a00231.html#a89e8330d9e06dd0666c50833628a125c">_ArrayCopy1D_</a>(index,index2,3); index2[d]++;</div>
<div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;        <a class="code" href="a00231.html#afbb862a2fdf5b72b1f9ace42f64b556f">_ArrayIndex1D_</a>(3,dim          ,index ,ghosts,p);</div>
<div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;        <a class="code" href="a00231.html#afbb862a2fdf5b72b1f9ace42f64b556f">_ArrayIndex1D_</a>(3,dim_interface,index1,0     ,p1);</div>
<div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;        <a class="code" href="a00231.html#afbb862a2fdf5b72b1f9ace42f64b556f">_ArrayIndex1D_</a>(3,dim_interface,index2,0     ,p2);</div>
<div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;        <span class="keywordflow">for</span> (v=0; v&lt;nvars; v++) {</div>
<div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;          hyp[p+v*npoints_local_wghosts] += dxinv[offset+ghosts+index[d]]</div>
<div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;                                      * (FluxI[p2+v*npoints_dim_interface]-FluxI[p1+v*npoints_dim_interface]);</div>
<div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;        }</div>
<div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;        <span class="keywordflow">if</span> (index[d] == 0 || index[d] == dim[d]-1) {</div>
<div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;          <span class="keywordflow">if</span> (d == 0) {</div>
<div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;            b = index[1] + index[2]*dim[1];</div>
<div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;          } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (d == 1) {</div>
<div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;            b = index[0] + index[2]*dim[0];</div>
<div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;          } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;            b = index[0] + index[1]*dim[0];</div>
<div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;          }</div>
<div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;          <span class="keywordflow">if</span> (index[d] == 0) {</div>
<div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;            <span class="keywordflow">for</span> (v=0; v&lt;nvars; v++) FluxI_p1[b*nvars+v] = FluxI[p1+v*npoints_dim_interface];</div>
<div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;          } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;            <span class="keywordflow">for</span> (v=0; v&lt;nvars; v++) FluxI_p2[b*nvars+v] = FluxI[p2+v*npoints_dim_interface];</div>
<div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;          }</div>
<div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;        }</div>
<div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;    }</div>
<div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;    <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;}</div>
<div class="ttc" id="a00231_html_a03f49e4d44ae8aca85cb04cfe91e4ce4"><div class="ttname"><a href="a00231.html#a03f49e4d44ae8aca85cb04cfe91e4ce4">_ArrayIndexnD_</a></div><div class="ttdeci">#define _ArrayIndexnD_(N, index, imax, i, ghost)</div><div class="ttdef"><b>Definition:</b> <a href="a00231_source.html#l00021">arrayfunctions.h:21</a></div></div>
<div class="ttc" id="a00231_html_afbb862a2fdf5b72b1f9ace42f64b556f"><div class="ttname"><a href="a00231.html#afbb862a2fdf5b72b1f9ace42f64b556f">_ArrayIndex1D_</a></div><div class="ttdeci">#define _ArrayIndex1D_(N, imax, i, ghost, index)</div><div class="ttdef"><b>Definition:</b> <a href="a00231_source.html#l00040">arrayfunctions.h:40</a></div></div>
<div class="ttc" id="a00231_html_a89e8330d9e06dd0666c50833628a125c"><div class="ttname"><a href="a00231.html#a89e8330d9e06dd0666c50833628a125c">_ArrayCopy1D_</a></div><div class="ttdeci">#define _ArrayCopy1D_(x, y, size)</div><div class="ttdef"><b>Definition:</b> <a href="a00231_source.html#l00319">arrayfunctions.h:319</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a1e78fb9da89089d6cc5837ab14916e7f"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int gpuHyperbolicFunction </td>
          <td>(</td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>hyp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>u</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>s</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>m</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>t</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>LimFlag</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int(*)(double *, double *, int, void *, double)&#160;</td>
          <td class="paramname"><em>FluxFunction</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int(*)(double *, double *, double *, double *, double *, double *, int, void *, double)&#160;</td>
          <td class="paramname"><em>UpwindFunction</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>This function computes the hyperbolic term of the governing equations, expressed as follows:- </p>
<p class="formulaDsp">
\begin{equation} {\bf F} \left({\bf u}\right) = \sum_{d=0}^{D-1} \frac {\partial {\bf f}_d\left({\bf u}\right)} {\partial x_d} \end{equation}
</p>
<p> using a conservative finite-difference discretization is space: </p>
<p class="formulaDsp">
\begin{equation} \hat{\bf F} \left({\bf u}\right) = \sum_{d=0}^{D-1} \frac {1} {\Delta x_d} \left[ \hat{\bf f}_{d,j+1/2} - \hat{\bf f}_{d,j-1/2} \right] \end{equation}
</p>
<p> where \(d\) denotes the spatial dimension, \(D\) denotes the total number of spatial dimensions, the hat denotes the discretized quantity, and \(j\) is the grid coordinate along dimension \(d\). The approximation to the flux function \({\bf f}_d\) at the interfaces \(j\pm1/2\), denoted by \(\hat{\bf f}_{d,j\pm 1/2}\), are computed using the function <a class="el" href="a00316.html#ae6e53860597b32435f6ad086401e11a1">ReconstructHyperbolic()</a>. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">hyp</td><td>Array to hold the computed hyperbolic term (shares the same layout as u </td></tr>
    <tr><td class="paramname">u</td><td>Solution array </td></tr>
    <tr><td class="paramname">s</td><td>Solver object of type <a class="el" href="a00204.html" title="Structure containing all solver-specific variables and functions. ">HyPar</a> </td></tr>
    <tr><td class="paramname">m</td><td>MPI object of type <a class="el" href="a00207.html#a00674" title="Structure of MPI-related variables. ">MPIVariables</a> </td></tr>
    <tr><td class="paramname">t</td><td>Current simulation time </td></tr>
    <tr><td class="paramname">LimFlag</td><td>Flag to indicate if the nonlinear coefficients for solution-dependent interpolation method should be recomputed (see <a class="el" href="a00316.html#ae6e53860597b32435f6ad086401e11a1">ReconstructHyperbolic()</a> for an explanation on why this is needed) </td></tr>
    <tr><td class="paramname">FluxFunction</td><td>Function pointer to the flux function for the hyperbolic term </td></tr>
    <tr><td class="paramname">UpwindFunction</td><td>Function pointer to the upwinding function for the hyperbolic term </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="a00316_source.html#l00473">473</a> of file <a class="el" href="a00316_source.html">HyperbolicFunction_GPU.cu</a>.</p>
<div class="fragment"><div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;{</div>
<div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;    <a class="code" href="a00204.html">HyPar</a>         *solver = (<a class="code" href="a00204.html">HyPar</a>*)        s;</div>
<div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;    <a class="code" href="a00207.html#a00674">MPIVariables</a>  *mpi    = (<a class="code" href="a00207.html#a00674">MPIVariables</a>*) m;</div>
<div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;    <span class="keywordtype">int</span>           d;</div>
<div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;    <span class="keywordtype">double</span>        *FluxI  = solver-&gt;<a class="code" href="a00204.html#a983929b7b1511ff3e7800597adef6a91">fluxI</a>; <span class="comment">/* interface flux     */</span></div>
<div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;    <span class="keywordtype">double</span>        *FluxC  = solver-&gt;<a class="code" href="a00204.html#aee7ff3b51db01ee6ed4038ff5311ed24">fluxC</a>; <span class="comment">/* cell centered flux */</span></div>
<div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;</div>
<div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;    <span class="keywordtype">int</span>     ndims     = solver-&gt;<a class="code" href="a00204.html#a484873c74138512e41bc50d17b7d955a">ndims</a>;</div>
<div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;    <span class="keywordtype">int</span>     nvars     = solver-&gt;<a class="code" href="a00204.html#ae8f6d2fd6490d3153cb4133bf183a404">nvars</a>;</div>
<div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;    <span class="keywordtype">int</span>     ghosts    = solver-&gt;<a class="code" href="a00204.html#aafc992b5fa79d5a4036024615d03bce6">ghosts</a>;</div>
<div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;    <span class="keywordtype">int</span>     *dim      = solver-&gt;<a class="code" href="a00204.html#a38e0371f331cecbe63a77fa03e202afe">dim_local</a>;</div>
<div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;    <span class="keywordtype">int</span>     size      = solver-&gt;<a class="code" href="a00204.html#a20ee1fd00a220b98513127884a5558cf">npoints_local_wghosts</a>;</div>
<div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;    <span class="keywordtype">double</span>  *x        = solver-&gt;<a class="code" href="a00204.html#a12356f3dd3ff93b8a46d248bf1f074e7">gpu_x</a>;</div>
<div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;    <span class="keywordtype">double</span>  *dxinv    = solver-&gt;<a class="code" href="a00204.html#a7a147598c79bd4c442a294cac219ca82">gpu_dxinv</a>;</div>
<div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;    <span class="keywordtype">double</span>  *FluxI_p1, *FluxI_p2;</div>
<div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;</div>
<div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;    LimFlag = (LimFlag &amp;&amp; solver-&gt;<a class="code" href="a00204.html#a9a61d44b50cc9043a19bdc3c0f591d99">flag_nonlinearinterp</a> &amp;&amp; solver-&gt;<a class="code" href="a00204.html#afeeb150a9699ade5eccc7589fcae3fe0">SetInterpLimiterVar</a>);</div>
<div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;</div>
<div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;    <a class="code" href="a00232.html#a5211607a9910a4d3fd4c7001794c91ee">gpuMemset</a>(hyp, 0, size*nvars*<span class="keyword">sizeof</span>(<span class="keywordtype">double</span>));</div>
<div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;    <a class="code" href="a00232.html#a5211607a9910a4d3fd4c7001794c91ee">gpuMemset</a>(solver-&gt;<a class="code" href="a00204.html#aab84e51d0d957c60e7890c1d96c4579b">StageBoundaryBuffer</a>, 0, solver-&gt;<a class="code" href="a00204.html#a80b7df4626f7c6b2952f6c270aff213e">StageBoundaryBuffer_size</a>*<span class="keyword">sizeof</span>(<span class="keywordtype">double</span>));</div>
<div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;    <a class="code" href="a00232.html#a5211607a9910a4d3fd4c7001794c91ee">gpuMemset</a>(solver-&gt;<a class="code" href="a00204.html#ac3326fc53477d445133072e3f1fe6b59">StageBoundaryIntegral</a>, 0, 2*ndims*nvars*<span class="keyword">sizeof</span>(<span class="keywordtype">double</span>));</div>
<div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;</div>
<div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;    <span class="keywordflow">if</span> (!FluxFunction) <span class="keywordflow">return</span>(0); <span class="comment">/* zero hyperbolic term */</span></div>
<div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;    <span class="comment">/*solver-&gt;count_hyp++;*/</span></div>
<div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;</div>
<div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;    <span class="keywordtype">int</span> npoints_grid = 1; <span class="keywordflow">for</span> (d = 0; d &lt; ndims; d++) npoints_grid *= dim[d];</div>
<div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;    <span class="keywordtype">int</span> nblocks = (npoints_grid - 1) / <a class="code" href="a00234.html#aceca9611b1e048e233f2d9cc02f70796">GPU_THREADS_PER_BLOCK</a> + 1;</div>
<div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;    <span class="keywordtype">int</span> offset = 0;</div>
<div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;</div>
<div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;<span class="preprocessor">#if defined(GPU_STAT)</span></div>
<div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;<span class="preprocessor"></span>    cudaEvent_t start, stop;</div>
<div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;    <span class="keywordtype">float</span> milliseconds = 0;</div>
<div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;</div>
<div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;    checkCuda( cudaEventCreate(&amp;start) );</div>
<div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;    checkCuda( cudaEventCreate(&amp;stop) );</div>
<div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;<span class="preprocessor"></span></div>
<div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;    <span class="keywordflow">for</span> (d = 0; d &lt; ndims; d++) {</div>
<div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;        <span class="keywordtype">int</span> npoints_dim_interface = 1; <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;ndims; i++) npoints_dim_interface *= (i==d) ? (dim[i]+1) : dim[i];</div>
<div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;        <span class="comment">/* evaluate cell-centered flux */</span></div>
<div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;        FluxFunction(FluxC,u,d,solver,t);</div>
<div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;        <span class="comment">/* compute interface fluxes */</span></div>
<div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;        <a class="code" href="a00316.html#ae6e53860597b32435f6ad086401e11a1">ReconstructHyperbolic</a>(FluxI,FluxC,u,x+offset,d,solver,mpi,t,LimFlag,UpwindFunction);</div>
<div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;</div>
<div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;        FluxI_p1 = solver-&gt;<a class="code" href="a00204.html#aab84e51d0d957c60e7890c1d96c4579b">StageBoundaryBuffer</a>+(solver-&gt;<a class="code" href="a00204.html#a5de5f995ed280640a28ef2cee85b5877">gpu_npoints_boundary_offset</a>[d]*nvars);</div>
<div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;        FluxI_p2 = solver-&gt;<a class="code" href="a00204.html#aab84e51d0d957c60e7890c1d96c4579b">StageBoundaryBuffer</a>+(solver-&gt;<a class="code" href="a00204.html#a5de5f995ed280640a28ef2cee85b5877">gpu_npoints_boundary_offset</a>[d]+solver-&gt;<a class="code" href="a00204.html#a6ee825f6a1705dd150485b67e2ecfbf3">gpu_npoints_boundary</a>[d])*nvars;</div>
<div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;</div>
<div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;<span class="preprocessor">#if defined(GPU_STAT)</span></div>
<div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;<span class="preprocessor"></span>        checkCuda( cudaEventRecord(start, 0) );</div>
<div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;<span class="preprocessor"></span>        <span class="keywordflow">if</span> (ndims == 3) {</div>
<div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;          HyperbolicFunction_dim3_kernel&lt;&lt;&lt;nblocks, GPU_THREADS_PER_BLOCK&gt;&gt;&gt;(</div>
<div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;              npoints_grid, size, npoints_dim_interface, d, nvars, ghosts, offset,</div>
<div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;              solver-&gt;<a class="code" href="a00204.html#aada0460ecc47924f438072324b8806f5">gpu_dim_local</a>, FluxI, dxinv,</div>
<div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;              hyp, FluxI_p1, FluxI_p2</div>
<div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;          );</div>
<div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;          fprintf(stderr,<span class="stringliteral">&quot;gpuHyperbolicFunction(): Not implemented for ndims = %d!\n&quot;</span>, ndims);</div>
<div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;          exit(1);</div>
<div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;        }</div>
<div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;        cudaDeviceSynchronize();</div>
<div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;</div>
<div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;<span class="preprocessor">#if defined(GPU_STAT)</span></div>
<div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;<span class="preprocessor"></span>        checkCuda( cudaEventRecord(stop, 0) );</div>
<div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;        checkCuda( cudaEventSynchronize(stop) );</div>
<div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;        checkCuda( cudaEventElapsedTime(&amp;milliseconds, start, stop) );</div>
<div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;        printf(<span class="stringliteral">&quot;%-50s GPU time = %.6f dir = %d bandwidth (GB/s) = %.2f\n&quot;</span>,</div>
<div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;                <span class="stringliteral">&quot;HyperbolicFunction&quot;</span>, milliseconds*1e-3, d, (1e-6*2*npoints_grid*nvars*<span class="keyword">sizeof</span>(<span class="keywordtype">double</span>))/milliseconds);</div>
<div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;</div>
<div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;        checkCuda( cudaEventRecord(start, 0) );</div>
<div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;<span class="preprocessor"></span></div>
<div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;        StageBoundaryIntegral_kernel&lt;GPU_THREADS_PER_BLOCK&gt;&lt;&lt;&lt;1, <a class="code" href="a00234.html#aceca9611b1e048e233f2d9cc02f70796">GPU_THREADS_PER_BLOCK</a>, GPU_THREADS_PER_BLOCK*nvars*<span class="keyword">sizeof</span>(double)&gt;&gt;&gt;(</div>
<div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;          solver-&gt;<a class="code" href="a00204.html#a6ee825f6a1705dd150485b67e2ecfbf3">gpu_npoints_boundary</a>[d], nvars, -1, FluxI_p1,</div>
<div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;          solver-&gt;<a class="code" href="a00204.html#ac3326fc53477d445133072e3f1fe6b59">StageBoundaryIntegral</a> + 2*d*nvars</div>
<div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;        );</div>
<div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;        StageBoundaryIntegral_kernel&lt;GPU_THREADS_PER_BLOCK&gt;&lt;&lt;&lt;1, <a class="code" href="a00234.html#aceca9611b1e048e233f2d9cc02f70796">GPU_THREADS_PER_BLOCK</a>, GPU_THREADS_PER_BLOCK*nvars*<span class="keyword">sizeof</span>(double)&gt;&gt;&gt;(</div>
<div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;          solver-&gt;<a class="code" href="a00204.html#a6ee825f6a1705dd150485b67e2ecfbf3">gpu_npoints_boundary</a>[d], nvars, 1, FluxI_p2,</div>
<div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;          solver-&gt;<a class="code" href="a00204.html#ac3326fc53477d445133072e3f1fe6b59">StageBoundaryIntegral</a> + (2*d+1)*nvars</div>
<div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;        );</div>
<div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;        cudaDeviceSynchronize();</div>
<div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;</div>
<div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;<span class="preprocessor">#if defined(GPU_STAT)</span></div>
<div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;<span class="preprocessor"></span>        checkCuda( cudaEventRecord(stop, 0) );</div>
<div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;        checkCuda( cudaEventSynchronize(stop) );</div>
<div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;        checkCuda( cudaEventElapsedTime(&amp;milliseconds, start, stop) );</div>
<div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;        printf(<span class="stringliteral">&quot;%-50s GPU time = %.6f dir = %d bandwidth (GB/s) = %.2f\n&quot;</span>,</div>
<div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;                <span class="stringliteral">&quot;StageBoundaryIntegral&quot;</span>, milliseconds*1e-3, d, (1e-6*2*solver-&gt;<a class="code" href="a00204.html#a6ee825f6a1705dd150485b67e2ecfbf3">gpu_npoints_boundary</a>[d]*nvars*<span class="keyword">sizeof</span>(<span class="keywordtype">double</span>))/milliseconds);</div>
<div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;<span class="preprocessor"></span>        offset += dim[d] + 2*ghosts;</div>
<div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;    }</div>
<div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;</div>
<div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;    <span class="keywordflow">if</span> (solver-&gt;<a class="code" href="a00204.html#ae83b1b0117b6a805ead2e4728945814c">flag_ib</a>) <a class="code" href="a00232.html#afd6620a5112f7aeb8391dc20e0f3b048">gpuArrayBlockMultiply</a>(hyp, solver-&gt;<a class="code" href="a00204.html#a992b70a21ce15afa8e06a4e3997cab8b">gpu_iblank</a>, size, nvars);</div>
<div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;</div>
<div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;<span class="preprocessor">#if defined(GPU_STAT)</span></div>
<div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;<span class="preprocessor"></span>    checkCuda(cudaEventDestroy(start));</div>
<div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;    checkCuda(cudaEventDestroy(stop));</div>
<div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;<span class="preprocessor"></span></div>
<div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160;    <span class="keywordflow">return</span>(0);</div>
<div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160;}</div>
<div class="ttc" id="a00204_html_a20ee1fd00a220b98513127884a5558cf"><div class="ttname"><a href="a00204.html#a20ee1fd00a220b98513127884a5558cf">HyPar::npoints_local_wghosts</a></div><div class="ttdeci">int npoints_local_wghosts</div><div class="ttdef"><b>Definition:</b> <a href="a00240_source.html#l00042">hypar.h:42</a></div></div>
<div class="ttc" id="a00204_html_aab84e51d0d957c60e7890c1d96c4579b"><div class="ttname"><a href="a00204.html#aab84e51d0d957c60e7890c1d96c4579b">HyPar::StageBoundaryBuffer</a></div><div class="ttdeci">double * StageBoundaryBuffer</div><div class="ttdef"><b>Definition:</b> <a href="a00240_source.html#l00462">hypar.h:462</a></div></div>
<div class="ttc" id="a00232_html_afd6620a5112f7aeb8391dc20e0f3b048"><div class="ttname"><a href="a00232.html#afd6620a5112f7aeb8391dc20e0f3b048">gpuArrayBlockMultiply</a></div><div class="ttdeci">void gpuArrayBlockMultiply(double *, const double *, int, int)</div><div class="ttdef"><b>Definition:</b> <a href="a00274_source.html#l00193">ArrayImplementations_GPU.cu:193</a></div></div>
<div class="ttc" id="a00204_html_ae83b1b0117b6a805ead2e4728945814c"><div class="ttname"><a href="a00204.html#ae83b1b0117b6a805ead2e4728945814c">HyPar::flag_ib</a></div><div class="ttdeci">int flag_ib</div><div class="ttdef"><b>Definition:</b> <a href="a00240_source.html#l00441">hypar.h:441</a></div></div>
<div class="ttc" id="a00316_html_ae6e53860597b32435f6ad086401e11a1"><div class="ttname"><a href="a00316.html#ae6e53860597b32435f6ad086401e11a1">ReconstructHyperbolic</a></div><div class="ttdeci">static int ReconstructHyperbolic(double *, double *, double *, double *, int, void *, void *, double, int, int(*)(double *, double *, double *, double *, double *, double *, int, void *, double))</div><div class="ttdef"><b>Definition:</b> <a href="a00316_source.html#l00629">HyperbolicFunction_GPU.cu:629</a></div></div>
<div class="ttc" id="a00204_html_a38e0371f331cecbe63a77fa03e202afe"><div class="ttname"><a href="a00204.html#a38e0371f331cecbe63a77fa03e202afe">HyPar::dim_local</a></div><div class="ttdeci">int * dim_local</div><div class="ttdef"><b>Definition:</b> <a href="a00240_source.html#l00037">hypar.h:37</a></div></div>
<div class="ttc" id="a00204_html_a7a147598c79bd4c442a294cac219ca82"><div class="ttname"><a href="a00204.html#a7a147598c79bd4c442a294cac219ca82">HyPar::gpu_dxinv</a></div><div class="ttdeci">double * gpu_dxinv</div><div class="ttdef"><b>Definition:</b> <a href="a00240_source.html#l00458">hypar.h:458</a></div></div>
<div class="ttc" id="a00204_html_a6ee825f6a1705dd150485b67e2ecfbf3"><div class="ttname"><a href="a00204.html#a6ee825f6a1705dd150485b67e2ecfbf3">HyPar::gpu_npoints_boundary</a></div><div class="ttdeci">int gpu_npoints_boundary[3]</div><div class="ttdef"><b>Definition:</b> <a href="a00240_source.html#l00453">hypar.h:453</a></div></div>
<div class="ttc" id="a00204_html_a992b70a21ce15afa8e06a4e3997cab8b"><div class="ttname"><a href="a00204.html#a992b70a21ce15afa8e06a4e3997cab8b">HyPar::gpu_iblank</a></div><div class="ttdeci">double * gpu_iblank</div><div class="ttdef"><b>Definition:</b> <a href="a00240_source.html#l00456">hypar.h:456</a></div></div>
<div class="ttc" id="a00234_html_aceca9611b1e048e233f2d9cc02f70796"><div class="ttname"><a href="a00234.html#aceca9611b1e048e233f2d9cc02f70796">GPU_THREADS_PER_BLOCK</a></div><div class="ttdeci">#define GPU_THREADS_PER_BLOCK</div><div class="ttdef"><b>Definition:</b> <a href="a00234_source.html#l00007">basic_gpu.h:7</a></div></div>
<div class="ttc" id="a00204_html_aafc992b5fa79d5a4036024615d03bce6"><div class="ttname"><a href="a00204.html#aafc992b5fa79d5a4036024615d03bce6">HyPar::ghosts</a></div><div class="ttdeci">int ghosts</div><div class="ttdef"><b>Definition:</b> <a href="a00240_source.html#l00052">hypar.h:52</a></div></div>
<div class="ttc" id="a00204_html_afeeb150a9699ade5eccc7589fcae3fe0"><div class="ttname"><a href="a00204.html#afeeb150a9699ade5eccc7589fcae3fe0">HyPar::SetInterpLimiterVar</a></div><div class="ttdeci">int(* SetInterpLimiterVar)(double *, double *, double *, int, void *, void *)</div><div class="ttdef"><b>Definition:</b> <a href="a00240_source.html#l00234">hypar.h:234</a></div></div>
<div class="ttc" id="a00204_html_a983929b7b1511ff3e7800597adef6a91"><div class="ttname"><a href="a00204.html#a983929b7b1511ff3e7800597adef6a91">HyPar::fluxI</a></div><div class="ttdeci">double * fluxI</div><div class="ttdef"><b>Definition:</b> <a href="a00240_source.html#l00136">hypar.h:136</a></div></div>
<div class="ttc" id="a00204_html_aada0460ecc47924f438072324b8806f5"><div class="ttname"><a href="a00204.html#aada0460ecc47924f438072324b8806f5">HyPar::gpu_dim_local</a></div><div class="ttdeci">int * gpu_dim_local</div><div class="ttdef"><b>Definition:</b> <a href="a00240_source.html#l00455">hypar.h:455</a></div></div>
<div class="ttc" id="a00204_html_a12356f3dd3ff93b8a46d248bf1f074e7"><div class="ttname"><a href="a00204.html#a12356f3dd3ff93b8a46d248bf1f074e7">HyPar::gpu_x</a></div><div class="ttdeci">double * gpu_x</div><div class="ttdef"><b>Definition:</b> <a href="a00240_source.html#l00457">hypar.h:457</a></div></div>
<div class="ttc" id="a00204_html_a5de5f995ed280640a28ef2cee85b5877"><div class="ttname"><a href="a00204.html#a5de5f995ed280640a28ef2cee85b5877">HyPar::gpu_npoints_boundary_offset</a></div><div class="ttdeci">int gpu_npoints_boundary_offset[3]</div><div class="ttdef"><b>Definition:</b> <a href="a00240_source.html#l00452">hypar.h:452</a></div></div>
<div class="ttc" id="a00204_html_aee7ff3b51db01ee6ed4038ff5311ed24"><div class="ttname"><a href="a00204.html#aee7ff3b51db01ee6ed4038ff5311ed24">HyPar::fluxC</a></div><div class="ttdeci">double * fluxC</div><div class="ttdef"><b>Definition:</b> <a href="a00240_source.html#l00128">hypar.h:128</a></div></div>
<div class="ttc" id="a00204_html_ae8f6d2fd6490d3153cb4133bf183a404"><div class="ttname"><a href="a00204.html#ae8f6d2fd6490d3153cb4133bf183a404">HyPar::nvars</a></div><div class="ttdeci">int nvars</div><div class="ttdef"><b>Definition:</b> <a href="a00240_source.html#l00029">hypar.h:29</a></div></div>
<div class="ttc" id="a00232_html_a5211607a9910a4d3fd4c7001794c91ee"><div class="ttname"><a href="a00232.html#a5211607a9910a4d3fd4c7001794c91ee">gpuMemset</a></div><div class="ttdeci">void gpuMemset(void *, int, size_t)</div><div class="ttdef"><b>Definition:</b> <a href="a00274_source.html#l00131">ArrayImplementations_GPU.cu:131</a></div></div>
<div class="ttc" id="a00204_html_ac3326fc53477d445133072e3f1fe6b59"><div class="ttname"><a href="a00204.html#ac3326fc53477d445133072e3f1fe6b59">HyPar::StageBoundaryIntegral</a></div><div class="ttdeci">double * StageBoundaryIntegral</div><div class="ttdef"><b>Definition:</b> <a href="a00240_source.html#l00382">hypar.h:382</a></div></div>
<div class="ttc" id="a00204_html_a484873c74138512e41bc50d17b7d955a"><div class="ttname"><a href="a00204.html#a484873c74138512e41bc50d17b7d955a">HyPar::ndims</a></div><div class="ttdeci">int ndims</div><div class="ttdef"><b>Definition:</b> <a href="a00240_source.html#l00026">hypar.h:26</a></div></div>
<div class="ttc" id="a00204_html_a80b7df4626f7c6b2952f6c270aff213e"><div class="ttname"><a href="a00204.html#a80b7df4626f7c6b2952f6c270aff213e">HyPar::StageBoundaryBuffer_size</a></div><div class="ttdeci">int StageBoundaryBuffer_size</div><div class="ttdef"><b>Definition:</b> <a href="a00240_source.html#l00461">hypar.h:461</a></div></div>
<div class="ttc" id="a00207_html_a00674"><div class="ttname"><a href="a00207.html#a00674">MPIVariables</a></div><div class="ttdoc">Structure of MPI-related variables. </div><div class="ttdef"><b>Definition:</b> <a href="a00207_source.html#l00024">mpivars_struct.h:24</a></div></div>
<div class="ttc" id="a00204_html_a9a61d44b50cc9043a19bdc3c0f591d99"><div class="ttname"><a href="a00204.html#a9a61d44b50cc9043a19bdc3c0f591d99">HyPar::flag_nonlinearinterp</a></div><div class="ttdeci">int flag_nonlinearinterp</div><div class="ttdef"><b>Definition:</b> <a href="a00240_source.html#l00411">hypar.h:411</a></div></div>
<div class="ttc" id="a00204_html"><div class="ttname"><a href="a00204.html">HyPar</a></div><div class="ttdoc">Structure containing all solver-specific variables and functions. </div><div class="ttdef"><b>Definition:</b> <a href="a00240_source.html#l00023">hypar.h:23</a></div></div>
</div><!-- fragment -->
</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- Start of StatCounter Code for Default Guide -->
<script type="text/javascript">
var sc_project=10897352; 
var sc_invisible=1; 
var sc_security="83042f57"; 
var scJsHost = (("https:" == document.location.protocol) ?
"https://secure." : "http://www.");
document.write("<sc"+"ript type='text/javascript' src='" +
scJsHost+
"statcounter.com/counter/counter.js'></"+"script>");
</script>
<noscript><div class="statcounter"><a title="website
statistics" href="http://statcounter.com/"
target="_blank"><img class="statcounter"
src="//c.statcounter.com/10897352/0/83042f57/1/"
alt="website statistics"></a></div></noscript>
<!-- End of StatCounter Code for Default Guide -->
