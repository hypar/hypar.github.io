<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.5"/>
<title>HyPar: 2D Euler Equations (with gravitational force) - Rising Thermal Bubble</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script><script src="http://cdn.mathjax.org/mathjax/latest/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="doxygen_html_style.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">HyPar
   &#160;<span id="projectnumber">1.0</span>
   </div>
   <div id="projectbrief">Finite-Difference Hyperbolic-Parabolic PDE Solver on Cartesian Grids</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.5 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li class="current"><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Structures</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('a00124.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Data Structures</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Namespaces</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Macros</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Pages</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">2D Euler Equations (with gravitational force) - Rising Thermal Bubble </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>Location: <b>hypar/Examples/2D/NavierStokes2D/RisingThermalBubble_SparseGrids</b> (This directory contains all the input files needed to run this case.)</p>
<p>Governing equations: 2D Euler Equations (<a class="el" href="a00169.html" title="2D Navier Stokes equations (compressible flows) ">navierstokes2d.h</a> - By default, <a class="el" href="a00169.html#a3b92a4b98cedf64473b3c13dfa7674b4">NavierStokes2D::Re</a> is set to <b>-1</b> which makes the code skip the parabolic terms, i.e., the 2D Euler equations are solved.)</p>
<p>Reference:</p>
<ul>
<li>Giraldo, F.X., Restelli, M., "A study of spectral element and discontinuous Galerkin methods for the Navierâ€“Stokes equations in nonhydrostatic mesoscale atmospheric modeling: Equation sets and test cases", J. Comput. Phys., 227, 2008, 3849&ndash;3877, (Section 3.2).</li>
</ul>
<p>Domain: \(0 \le x,y \le 1000\,m\), "slip-wall" (<a class="el" href="a00189.html#af3a9f3ba15bc914ed0a88295aee147e8">_SLIP_WALL_</a>) boundary conditions on all sides.</p>
<p>Initial solution: See references above.</p>
<p>Other parameters (all dimensional quantities are in SI units):</p>
<ul>
<li>Specific heat ratio \(\gamma = 1.4\) (<a class="el" href="a00169.html#a72f9e01745b3a8203067ab84aefc9aea">NavierStokes2D::gamma</a>)</li>
<li>Universal gas constant \(R = 287.058\) (<a class="el" href="a00169.html#a228eb5e837a644887ac6e7bab3f42485">NavierStokes2D::R</a>)</li>
<li>Gravitational force per unit mass \(g = 9.8\) along <em>y-axis</em> (<a class="el" href="a00169.html#adf08e308b453bd2d4e117576e493ed03">NavierStokes2D::grav_y</a>)</li>
<li>Reference density (at zero altitude) \(\rho_{ref} = 1.1612055171196529\) (<a class="el" href="a00169.html#a1e6f66261d19a1c1c272e8808bd2657b">NavierStokes2D::rho0</a>)</li>
<li>Reference pressure (at zero altitude) \(P_{ref} = 100000\) (<a class="el" href="a00169.html#a8be9de5ac626cddcd15c5ec181619694">NavierStokes2D::p0</a>)</li>
<li>Hydrostatic balance type 2 (<a class="el" href="a00169.html#a2e01ef077b0fedaea9e286ccdf2fe259">NavierStokes2D::HB</a>)</li>
</ul>
<p>Numerical method:</p>
<ul>
<li>Spatial discretization (hyperbolic): 5th order upwind (<a class="el" href="a00153.html#aea7c973ffe0c37bca0703c1bf6175aaa" title="5th order upwind reconstruction (component-wise) on a uniform grid ">Interp1PrimFifthOrderUpwind()</a>)</li>
<li>Time integration: SSPRK3 (<a class="el" href="a00217.html#aca6ebec6e6998f0c509bb38fa91f3321">TimeRK()</a>, <a class="el" href="a00159.html#a97e67bb275d6a2dad40b184579559f82">_RK_SSP3_</a>)</li>
</ul>
<h2>Input files required: </h2>
<p><b>sparse_grids.inp</b> </p>
<div class="fragment"><div class="line">begin</div>
<div class="line">  log2_imin           3</div>
<div class="line">  interp_order        6</div>
<div class="line">  write_sg_solutions  no</div>
<div class="line">  write_sg_errors     no</div>
<div class="line">end</div>
</div><!-- fragment --><p><b>Note:</b> The remaining files are the same as what would be required for a conventional (non-sparse-grids) simulation.</p>
<p><b>solver.inp</b> </p>
<div class="fragment"><div class="line">begin</div>
<div class="line">  ndims               2</div>
<div class="line">  nvars               4</div>
<div class="line">  size                256 256</div>
<div class="line">  ghost               3</div>
<div class="line">  n_iter              30000</div>
<div class="line">  restart_iter        0</div>
<div class="line">  time_scheme         rk</div>
<div class="line">  time_scheme_type    ssprk3</div>
<div class="line">  hyp_space_scheme    upw5</div>
<div class="line">  hyp_flux_split      no</div>
<div class="line">  hyp_interp_type     components</div>
<div class="line">  par_space_type      nonconservative-2stage</div>
<div class="line">  par_space_scheme    4</div>
<div class="line">  dt                  0.01</div>
<div class="line">  conservation_check  no</div>
<div class="line">  screen_op_iter      500</div>
<div class="line">  file_op_iter        1000</div>
<div class="line">  input_mode          serial</div>
<div class="line">  ip_file_type        binary</div>
<div class="line">  output_mode         serial</div>
<div class="line">  op_file_format      binary</div>
<div class="line">  op_overwrite        no</div>
<div class="line">  model               navierstokes2d</div>
<div class="line">end</div>
</div><!-- fragment --><p><b>boundary.inp</b> </p>
<div class="fragment"><div class="line">4</div>
<div class="line">slip-wall   0     1     0        0      0   1000.0</div>
<div class="line">0.0 0.0</div>
<div class="line">slip-wall   0    -1     0        0      0   1000.0</div>
<div class="line">0.0 0.0</div>
<div class="line">slip-wall   1     1     0   1000.0      0        0</div>
<div class="line">0.0 0.0</div>
<div class="line">slip-wall   1    -1     0   1000.0      0        0</div>
<div class="line">0.0 0.0</div>
</div><!-- fragment --><p><b>physics.inp</b> </p>
<div class="fragment"><div class="line">begin</div>
<div class="line">  gamma     1.4</div>
<div class="line">  upwinding rusanov</div>
<div class="line">  gravity   0.0 9.8</div>
<div class="line">  rho_ref   1.1612055171196529</div>
<div class="line">  p_ref     100000.0</div>
<div class="line">  R         287.058</div>
<div class="line">  HB        2</div>
<div class="line">end</div>
</div><!-- fragment --><p>To generate <b>initial.inp</b> (initial solution), compile and run the following code in the run directory. </p>
<div class="fragment"><div class="line"><span class="preprocessor">#include &lt;stdio.h&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;stdlib.h&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;math.h&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;string.h&gt;</span></div>
<div class="line"></div>
<div class="line"><span class="keywordtype">double</span> <a class="code" href="a00199.html#a840eef18a5986381093ff8c176a2153c">raiseto</a>(<span class="keywordtype">double</span> x, <span class="keywordtype">double</span> a)</div>
<div class="line">{</div>
<div class="line">  <span class="keywordflow">return</span>(exp(a*log(x)));</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"><span class="keywordtype">int</span> <a class="code" href="a00318.html#a3c04138a5bfe5d72780bb7e82a18e627">main</a>()</div>
<div class="line">{</div>
<div class="line">  <span class="keywordtype">double</span> gamma    = 1.4;</div>
<div class="line">  <span class="keywordtype">double</span> R        = 287.058;</div>
<div class="line">  <span class="keywordtype">double</span> rho_ref  = 1.1612055171196529;</div>
<div class="line">  <span class="keywordtype">double</span> p_ref    = 100000.0;</div>
<div class="line">  <span class="keywordtype">double</span> grav_x   = 0.0;</div>
<div class="line">  <span class="keywordtype">double</span> grav_y   = 9.8;</div>
<div class="line">  <span class="keywordtype">int</span>    HB       = 0;</div>
<div class="line">  </div>
<div class="line">    <span class="keywordtype">int</span>   NI,NJ,ndims;</div>
<div class="line">  <span class="keywordtype">char</span>  ip_file_type[50]; strcpy(ip_file_type,<span class="stringliteral">&quot;ascii&quot;</span>);</div>
<div class="line">  FILE *in;</div>
<div class="line"></div>
<div class="line">  printf(<span class="stringliteral">&quot;Reading file \&quot;solver.inp\&quot;...\n&quot;</span>);</div>
<div class="line">  in = fopen(<span class="stringliteral">&quot;solver.inp&quot;</span>,<span class="stringliteral">&quot;r&quot;</span>);</div>
<div class="line">  <span class="keywordflow">if</span> (!in) {</div>
<div class="line">    printf(<span class="stringliteral">&quot;Error: Input file \&quot;solver.inp\&quot; not found.\n&quot;</span>);</div>
<div class="line">    <span class="keywordflow">return</span>(0);</div>
<div class="line">  } <span class="keywordflow">else</span> {</div>
<div class="line">    <span class="keywordtype">char</span> word[500];</div>
<div class="line">    fscanf(in,<span class="stringliteral">&quot;%s&quot;</span>,word);</div>
<div class="line">    <span class="keywordflow">if</span> (!strcmp(word, <span class="stringliteral">&quot;begin&quot;</span>)) {</div>
<div class="line">      <span class="keywordflow">while</span> (strcmp(word, <span class="stringliteral">&quot;end&quot;</span>)) {</div>
<div class="line">        fscanf(in,<span class="stringliteral">&quot;%s&quot;</span>,word);</div>
<div class="line">        <span class="keywordflow">if</span> (!strcmp(word, <span class="stringliteral">&quot;ndims&quot;</span>)) fscanf(in,<span class="stringliteral">&quot;%d&quot;</span>,&amp;ndims);</div>
<div class="line">        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcmp(word, <span class="stringliteral">&quot;size&quot;</span>)) {</div>
<div class="line">          fscanf(in,<span class="stringliteral">&quot;%d&quot;</span>,&amp;NI);</div>
<div class="line">          fscanf(in,<span class="stringliteral">&quot;%d&quot;</span>,&amp;NJ);</div>
<div class="line">        } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcmp(word, <span class="stringliteral">&quot;ip_file_type&quot;</span>)) fscanf(in,<span class="stringliteral">&quot;%s&quot;</span>,ip_file_type);</div>
<div class="line">      }</div>
<div class="line">    } <span class="keywordflow">else</span> printf(<span class="stringliteral">&quot;Error: Illegal format in solver.inp. Crash and burn!\n&quot;</span>);</div>
<div class="line">  }</div>
<div class="line">  fclose(in);</div>
<div class="line"></div>
<div class="line">  printf(<span class="stringliteral">&quot;Reading file \&quot;physics.inp\&quot;...\n&quot;</span>);</div>
<div class="line">  in = fopen(<span class="stringliteral">&quot;physics.inp&quot;</span>,<span class="stringliteral">&quot;r&quot;</span>);</div>
<div class="line">  <span class="keywordflow">if</span> (!in) {</div>
<div class="line">    printf(<span class="stringliteral">&quot;Error: Input file \&quot;physics.inp\&quot; not found.\n&quot;</span>);</div>
<div class="line">    <span class="keywordflow">return</span>(0);</div>
<div class="line">  } <span class="keywordflow">else</span> {</div>
<div class="line">    <span class="keywordtype">char</span> word[500];</div>
<div class="line">    fscanf(in,<span class="stringliteral">&quot;%s&quot;</span>,word);</div>
<div class="line">    <span class="keywordflow">if</span> (!strcmp(word, <span class="stringliteral">&quot;begin&quot;</span>)) {</div>
<div class="line">      <span class="keywordflow">while</span> (strcmp(word, <span class="stringliteral">&quot;end&quot;</span>)) {</div>
<div class="line">        fscanf(in,<span class="stringliteral">&quot;%s&quot;</span>,word);</div>
<div class="line">        <span class="keywordflow">if</span>      (!strcmp(word, <span class="stringliteral">&quot;rho_ref&quot;</span>)) fscanf(in,<span class="stringliteral">&quot;%lf&quot;</span>,&amp;rho_ref);</div>
<div class="line">        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcmp(word, <span class="stringliteral">&quot;p_ref&quot;</span>  )) fscanf(in,<span class="stringliteral">&quot;%lf&quot;</span>,&amp;p_ref  );</div>
<div class="line">        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcmp(word, <span class="stringliteral">&quot;gamma&quot;</span>  )) fscanf(in,<span class="stringliteral">&quot;%lf&quot;</span>,&amp;gamma  );</div>
<div class="line">        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcmp(word, <span class="stringliteral">&quot;R&quot;</span>      )) fscanf(in,<span class="stringliteral">&quot;%lf&quot;</span>,&amp;R      );</div>
<div class="line">        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcmp(word, <span class="stringliteral">&quot;HB&quot;</span>     )) fscanf(in,<span class="stringliteral">&quot;%d&quot;</span> ,&amp;HB     );</div>
<div class="line">        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcmp(word, <span class="stringliteral">&quot;gravity&quot;</span>)) {</div>
<div class="line">          fscanf(in,<span class="stringliteral">&quot;%lf&quot;</span>,&amp;grav_x );</div>
<div class="line">          fscanf(in,<span class="stringliteral">&quot;%lf&quot;</span>,&amp;grav_y );</div>
<div class="line">        }</div>
<div class="line">      }</div>
<div class="line">    } <span class="keywordflow">else</span> printf(<span class="stringliteral">&quot;Error: Illegal format in physics.inp. Crash and burn!\n&quot;</span>);</div>
<div class="line">  }</div>
<div class="line">  fclose(in);</div>
<div class="line"></div>
<div class="line">  <span class="keywordflow">if</span> (ndims != 2) {</div>
<div class="line">    printf(<span class="stringliteral">&quot;ndims is not 2 in solver.inp. this code is to generate 2D initial conditions\n&quot;</span>);</div>
<div class="line">    <span class="keywordflow">return</span>(0);</div>
<div class="line">  }</div>
<div class="line">  <span class="keywordflow">if</span> (HB != 2) {</div>
<div class="line">    printf(<span class="stringliteral">&quot;Error: Specify \&quot;HB\&quot; as 2 in physics.inp.\n&quot;</span>);</div>
<div class="line">  }</div>
<div class="line">    printf(<span class="stringliteral">&quot;Grid:\t\t\t%d X %d\n&quot;</span>,NI,NJ);</div>
<div class="line">  printf(<span class="stringliteral">&quot;Reference density and pressure: %lf, %lf.\n&quot;</span>,rho_ref,p_ref);</div>
<div class="line"></div>
<div class="line">    <span class="keywordtype">int</span> i,j;</div>
<div class="line">    <span class="keywordtype">double</span> dx = 1000.0  / ((double)(NI-1));</div>
<div class="line">    <span class="keywordtype">double</span> dy = 1000.0  / ((double)(NJ-1));</div>
<div class="line"></div>
<div class="line">    <span class="keywordtype">double</span> *x, *y, *u0, *u1, *u2, *u3;</div>
<div class="line">    x   = (<span class="keywordtype">double</span>*) calloc (NI   , <span class="keyword">sizeof</span>(<span class="keywordtype">double</span>));</div>
<div class="line">    y   = (<span class="keywordtype">double</span>*) calloc (NJ   , <span class="keyword">sizeof</span>(<span class="keywordtype">double</span>));</div>
<div class="line">    u0  = (<span class="keywordtype">double</span>*) calloc (NI*NJ, <span class="keyword">sizeof</span>(<span class="keywordtype">double</span>));</div>
<div class="line">    u1  = (<span class="keywordtype">double</span>*) calloc (NI*NJ, <span class="keyword">sizeof</span>(<span class="keywordtype">double</span>));</div>
<div class="line">    u2  = (<span class="keywordtype">double</span>*) calloc (NI*NJ, <span class="keyword">sizeof</span>(<span class="keywordtype">double</span>));</div>
<div class="line">    u3  = (<span class="keywordtype">double</span>*) calloc (NI*NJ, <span class="keyword">sizeof</span>(<span class="keywordtype">double</span>));</div>
<div class="line"></div>
<div class="line">  <span class="comment">/* Initial perturbation center */</span></div>
<div class="line">  <span class="keywordtype">double</span> xc = 500;</div>
<div class="line">  <span class="keywordtype">double</span> yc = 350;</div>
<div class="line">  <span class="keywordtype">double</span> Cp = gamma * R / (gamma-1.0);</div>
<div class="line"></div>
<div class="line">  <span class="comment">/* initial perturbation parameters */</span></div>
<div class="line">  <span class="keywordtype">double</span> tc = 0.5;</div>
<div class="line">  <span class="keywordtype">double</span> pi = 4.0*atan(1.0);</div>
<div class="line">  <span class="keywordtype">double</span> rc = 250.0;</div>
<div class="line">  <span class="keywordtype">double</span> T_ref = p_ref / (R * rho_ref);</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">for</span> (i = 0; i &lt; NI; i++){</div>
<div class="line">    <span class="keywordflow">for</span> (j = 0; j &lt; NJ; j++){</div>
<div class="line">        x[i] = i*dx;</div>
<div class="line">        y[j] = j*dy;</div>
<div class="line">      <span class="keywordtype">int</span> p = NJ*i + j;</div>
<div class="line"></div>
<div class="line">      <span class="comment">/* temperature peturbation */</span></div>
<div class="line">      <span class="keywordtype">double</span> r      = sqrt((x[i]-xc)*(x[i]-xc)+(y[j]-yc)*(y[j]-yc));</div>
<div class="line">      <span class="keywordtype">double</span> dtheta = (r&gt;rc ? 0.0 : (0.5*tc*(1.0+cos(pi*r/rc))) );</div>
<div class="line">      <span class="keywordtype">double</span> theta  = T_ref + dtheta;</div>
<div class="line">      <span class="keywordtype">double</span> Pexner = 1.0 - (grav_y*y[j])/(Cp*T_ref);</div>
<div class="line"></div>
<div class="line">      <span class="keywordtype">double</span> rho    = (p_ref/(R*theta)) * <a class="code" href="a00199.html#a840eef18a5986381093ff8c176a2153c">raiseto</a>(Pexner, (1.0/(gamma-1.0)));</div>
<div class="line">      <span class="keywordtype">double</span> E      = rho * (R/(gamma-1.0)) * theta*Pexner;</div>
<div class="line"></div>
<div class="line">      u0[p] = rho;</div>
<div class="line">      u1[p] = 0.0;</div>
<div class="line">      u2[p] = 0.0;</div>
<div class="line">      u3[p] = E;</div>
<div class="line">      }</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">  FILE *out;</div>
<div class="line">  <span class="keywordflow">if</span> (!strcmp(ip_file_type,<span class="stringliteral">&quot;ascii&quot;</span>)) {</div>
<div class="line">    printf(<span class="stringliteral">&quot;Writing ASCII initial solution file initial.inp\n&quot;</span>);</div>
<div class="line">    out = fopen(<span class="stringliteral">&quot;initial.inp&quot;</span>,<span class="stringliteral">&quot;w&quot;</span>);</div>
<div class="line">    <span class="keywordflow">for</span> (i = 0; i &lt; NI; i++)  fprintf(out,<span class="stringliteral">&quot;%lf &quot;</span>,x[i]);</div>
<div class="line">    fprintf(out,<span class="stringliteral">&quot;\n&quot;</span>);</div>
<div class="line">    <span class="keywordflow">for</span> (j = 0; j &lt; NJ; j++)  fprintf(out,<span class="stringliteral">&quot;%lf &quot;</span>,y[j]);</div>
<div class="line">    fprintf(out,<span class="stringliteral">&quot;\n&quot;</span>);</div>
<div class="line">    <span class="keywordflow">for</span> (j = 0; j &lt; NJ; j++)    {</div>
<div class="line">        <span class="keywordflow">for</span> (i = 0; i &lt; NI; i++)    {</div>
<div class="line">        <span class="keywordtype">int</span> p = NJ*i + j;</div>
<div class="line">        fprintf(out,<span class="stringliteral">&quot;%lf &quot;</span>,u0[p]);</div>
<div class="line">      }</div>
<div class="line">    }</div>
<div class="line">    fprintf(out,<span class="stringliteral">&quot;\n&quot;</span>);</div>
<div class="line">    <span class="keywordflow">for</span> (j = 0; j &lt; NJ; j++)    {</div>
<div class="line">        <span class="keywordflow">for</span> (i = 0; i &lt; NI; i++)    {</div>
<div class="line">        <span class="keywordtype">int</span> p = NJ*i + j;</div>
<div class="line">        fprintf(out,<span class="stringliteral">&quot;%lf &quot;</span>,u1[p]);</div>
<div class="line">      }</div>
<div class="line">    }</div>
<div class="line">    fprintf(out,<span class="stringliteral">&quot;\n&quot;</span>);</div>
<div class="line">    <span class="keywordflow">for</span> (j = 0; j &lt; NJ; j++)    {</div>
<div class="line">        <span class="keywordflow">for</span> (i = 0; i &lt; NI; i++)    {</div>
<div class="line">        <span class="keywordtype">int</span> p = NJ*i + j;</div>
<div class="line">        fprintf(out,<span class="stringliteral">&quot;%lf &quot;</span>,u2[p]);</div>
<div class="line">      }</div>
<div class="line">    }</div>
<div class="line">    fprintf(out,<span class="stringliteral">&quot;\n&quot;</span>);</div>
<div class="line">    <span class="keywordflow">for</span> (j = 0; j &lt; NJ; j++)    {</div>
<div class="line">        <span class="keywordflow">for</span> (i = 0; i &lt; NI; i++)    {</div>
<div class="line">        <span class="keywordtype">int</span> p = NJ*i + j;</div>
<div class="line">        fprintf(out,<span class="stringliteral">&quot;%lf &quot;</span>,u3[p]);</div>
<div class="line">      }</div>
<div class="line">    }</div>
<div class="line">    fprintf(out,<span class="stringliteral">&quot;\n&quot;</span>);</div>
<div class="line">      fclose(out);</div>
<div class="line">  } <span class="keywordflow">else</span> <span class="keywordflow">if</span> ((!strcmp(ip_file_type,<span class="stringliteral">&quot;binary&quot;</span>)) || (!strcmp(ip_file_type,<span class="stringliteral">&quot;bin&quot;</span>))) {</div>
<div class="line">    printf(<span class="stringliteral">&quot;Writing binary initial solution file initial.inp\n&quot;</span>);</div>
<div class="line">    out = fopen(<span class="stringliteral">&quot;initial.inp&quot;</span>,<span class="stringliteral">&quot;wb&quot;</span>);</div>
<div class="line">    fwrite(x,<span class="keyword">sizeof</span>(<span class="keywordtype">double</span>),NI,out);</div>
<div class="line">    fwrite(y,<span class="keyword">sizeof</span>(<span class="keywordtype">double</span>),NJ,out);</div>
<div class="line">    <span class="keywordtype">double</span> *U = (<span class="keywordtype">double</span>*) calloc (4*NI*NJ,<span class="keyword">sizeof</span>(<span class="keywordtype">double</span>));</div>
<div class="line">    <span class="keywordflow">for</span> (i=0; i &lt; NI; i++) {</div>
<div class="line">      <span class="keywordflow">for</span> (j = 0; j &lt; NJ; j++) {</div>
<div class="line">        <span class="keywordtype">int</span> p = NJ*i + j;</div>
<div class="line">        <span class="keywordtype">int</span> q = NI*j + i;</div>
<div class="line">        U[4*q+0] = u0[p];</div>
<div class="line">        U[4*q+1] = u1[p];</div>
<div class="line">        U[4*q+2] = u2[p];</div>
<div class="line">        U[4*q+3] = u3[p];</div>
<div class="line">      }</div>
<div class="line">    }</div>
<div class="line">    fwrite(U,<span class="keyword">sizeof</span>(<span class="keywordtype">double</span>),4*NI*NJ,out);</div>
<div class="line">    free(U);</div>
<div class="line">    fclose(out);</div>
<div class="line">  }</div>
<div class="line"></div>
<div class="line">    free(x);</div>
<div class="line">    free(y);</div>
<div class="line">    free(u0);</div>
<div class="line">    free(u1);</div>
<div class="line">    free(u2);</div>
<div class="line">    free(u3);</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">return</span>(0);</div>
<div class="line">}</div>
</div><!-- fragment --><h2>Output: </h2>
<p>Note that <b>iproc</b> does <b>not</b> need to be set for simulations using sparse grids. <a class="el" href="a00164.html" title="Structure containing all solver-specific variables and functions. ">HyPar</a> will automatically calculate the load balanced processor distribution for each sparse grid. If too many processors are specified, then it will return an error.</p>
<p>After running the code, there should be the following output files:</p>
<ul>
<li>op_fg_00000.dat, ..., op_fg_00030.dat: these contain the full grid solution at \(t=0, ..., 300\).</li>
</ul>
<p>Since <b>write_sg_solutions</b> is set to <b>no</b> in <b>sparse_grids.inp</b> (<a class="el" href="a00180.html#a634b90e62b481c87ad0ba4ee5c5feba4">SparseGridsSimulation::m_write_sg_solutions</a>), sparse grid solution files are not written out.</p>
<p><a class="el" href="a00164.html#a51a3b8c19b86e9e1df5be02b05a6613c">HyPar::op_file_format</a> is set to <em>binary</em> in <b>solver.inp</b>, and thus, all the files are written out in the binary format, see <a class="el" href="a00195.html#a067f454c26d85d6cfb4d7d878b3783c9">WriteBinary()</a>. The binary file contains the conserved variables \(\left(\rho, \rho u, \rho v, e\right)\). The following code converts these variables to the primitive variables of interest to atmospheric flows \(\left(\rho, u, v, p, \theta\right)\). It also writes out the hydrostatically balanced quantities \(\left(\rho_0,\pi_0, \theta_0\right)\) for this case that can be used to compute and plot the temperature and density perturbations. These variables are then written to either a tecplot2d or text file. (compile and run it in the run directory): </p>
<div class="fragment"><div class="line"><span class="comment">/*</span></div>
<div class="line"><span class="comment">  Rising Thermal Bubble:-</span></div>
<div class="line"><span class="comment">  The code takes a binary solution file (that contains the </span></div>
<div class="line"><span class="comment">  conserved variable (rho, rho*u, rho*v, e) as its input </span></div>
<div class="line"><span class="comment">  and calculates the primitive atmospheric flow variables:</span></div>
<div class="line"><span class="comment">  rho, u, v, P, theta, pi, rho0, P0, theta0, pi0</span></div>
<div class="line"><span class="comment">  and writes them to a tecplot file.</span></div>
<div class="line"><span class="comment">*/</span></div>
<div class="line"></div>
<div class="line"><span class="preprocessor">#include &lt;stdio.h&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;stdlib.h&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;string.h&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;math.h&gt;</span></div>
<div class="line"></div>
<div class="line"><span class="keyword">typedef</span> <span class="keyword">struct </span>_parameters_{</div>
<div class="line">  <span class="keywordtype">double</span> grav_x, grav_y, R, gamma, P_ref, rho_ref;</div>
<div class="line">  <span class="keywordtype">int</span> HB;</div>
<div class="line">} Parameters;</div>
<div class="line"></div>
<div class="line"><span class="keywordtype">void</span> IncrementFilename(<span class="keywordtype">char</span> *f)</div>
<div class="line">{</div>
<div class="line">  <span class="keywordflow">if</span> (f[10] == <span class="charliteral">&#39;9&#39;</span>) {</div>
<div class="line">    f[10] = <span class="charliteral">&#39;0&#39;</span>;</div>
<div class="line">    <span class="keywordflow">if</span> (f[9] == <span class="charliteral">&#39;9&#39;</span>) {</div>
<div class="line">      f[9] = <span class="charliteral">&#39;0&#39;</span>;</div>
<div class="line">      <span class="keywordflow">if</span> (f[8] == <span class="charliteral">&#39;9&#39;</span>) {</div>
<div class="line">        f[8] = <span class="charliteral">&#39;0&#39;</span>;</div>
<div class="line">        <span class="keywordflow">if</span> (f[7] == <span class="charliteral">&#39;9&#39;</span>) {</div>
<div class="line">          f[7] = <span class="charliteral">&#39;0&#39;</span>;</div>
<div class="line">          <span class="keywordflow">if</span> (f[6] == <span class="charliteral">&#39;9&#39;</span>) {</div>
<div class="line">            f[6] = <span class="charliteral">&#39;0&#39;</span>;</div>
<div class="line">            fprintf(stderr,<span class="stringliteral">&quot;Warning: file increment hit max limit. Resetting to zero.\n&quot;</span>);</div>
<div class="line">          } <span class="keywordflow">else</span> {</div>
<div class="line">            f[6]++;</div>
<div class="line">          }</div>
<div class="line">        } <span class="keywordflow">else</span> {</div>
<div class="line">          f[7]++;</div>
<div class="line">        }</div>
<div class="line">      } <span class="keywordflow">else</span> {</div>
<div class="line">        f[8]++;</div>
<div class="line">      }</div>
<div class="line">    } <span class="keywordflow">else</span> {</div>
<div class="line">      f[9]++;</div>
<div class="line">    }</div>
<div class="line">  } <span class="keywordflow">else</span> {</div>
<div class="line">    f[10]++;</div>
<div class="line">  }</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"><span class="keywordtype">double</span> <a class="code" href="a00199.html#a840eef18a5986381093ff8c176a2153c">raiseto</a>(<span class="keywordtype">double</span> x, <span class="keywordtype">double</span> a)</div>
<div class="line">{</div>
<div class="line">  <span class="keywordflow">return</span>(exp(a*log(x)));</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"><span class="keywordtype">void</span> <a class="code" href="a00195.html#a265b0583afb79edd2f2f5d5087e5c3bf">WriteTecplot2D</a>(<span class="keywordtype">int</span> nvars,<span class="keywordtype">int</span> imax, <span class="keywordtype">int</span> jmax,<span class="keywordtype">double</span> *x,<span class="keywordtype">double</span> *u,<span class="keywordtype">char</span> *f)</div>
<div class="line">{</div>
<div class="line">  printf(<span class="stringliteral">&quot;\tWriting tecplot solution file %s.\n&quot;</span>,f);</div>
<div class="line">  FILE *out;</div>
<div class="line">  out = fopen(f,<span class="stringliteral">&quot;w&quot;</span>);</div>
<div class="line">  <span class="keywordflow">if</span> (!out) {</div>
<div class="line">    fprintf(stderr,<span class="stringliteral">&quot;Error: could not open %s for writing.\n&quot;</span>,f);</div>
<div class="line">    <span class="keywordflow">return</span>;</div>
<div class="line">  }</div>
<div class="line"></div>
<div class="line">  <span class="keywordtype">double</span> *X = x;</div>
<div class="line">  <span class="keywordtype">double</span> *Y = x+imax;</div>
<div class="line"></div>
<div class="line">  <span class="comment">/* writing tecplot data file headers */</span></div>
<div class="line">  fprintf(out,<span class="stringliteral">&quot;VARIABLES=\&quot;I\&quot;,\&quot;J\&quot;,\&quot;X\&quot;,\&quot;Y\&quot;,&quot;</span>);</div>
<div class="line">  fprintf(out,<span class="stringliteral">&quot;\&quot;RHO\&quot;,\&quot;U\&quot;,\&quot;V\&quot;,\&quot;P\&quot;,&quot;</span>);</div>
<div class="line">  fprintf(out,<span class="stringliteral">&quot;\&quot;THETA\&quot;,\&quot;RHO0\&quot;,\&quot;P0\&quot;,&quot;</span>);</div>
<div class="line">  fprintf(out,<span class="stringliteral">&quot;\&quot;PI0\&quot;,\&quot;THETA0\&quot;,\n&quot;</span>);</div>
<div class="line">  fprintf(out,<span class="stringliteral">&quot;ZONE I=%d,J=%d,F=POINT\n&quot;</span>,imax,jmax);</div>
<div class="line"></div>
<div class="line">  <span class="comment">/* writing the data */</span></div>
<div class="line">  <span class="keywordtype">int</span> i,j;</div>
<div class="line">  <span class="keywordflow">for</span> (j=0; j&lt;jmax; j++) {</div>
<div class="line">    <span class="keywordflow">for</span> (i=0; i&lt;imax; i++) {</div>
<div class="line">      <span class="keywordtype">int</span> v, p = i + imax*j;</div>
<div class="line">      fprintf(out,<span class="stringliteral">&quot;%4d %4d &quot;</span>,i,j);</div>
<div class="line">      fprintf(out,<span class="stringliteral">&quot;%1.16E %1.16E &quot;</span>,X[i],Y[j]);</div>
<div class="line">      <span class="keywordflow">for</span> (v=0; v&lt;nvars; v++) fprintf(out,<span class="stringliteral">&quot;%1.16E &quot;</span>,u[nvars*p+v]);</div>
<div class="line">      fprintf(out,<span class="stringliteral">&quot;\n&quot;</span>);</div>
<div class="line">    }</div>
<div class="line">  }</div>
<div class="line">  fclose(out);</div>
<div class="line">  <span class="keywordflow">return</span>;</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"><span class="keywordtype">void</span> WriteText2D(<span class="keywordtype">int</span> nvars,<span class="keywordtype">int</span> imax, <span class="keywordtype">int</span> jmax,<span class="keywordtype">double</span> *x,<span class="keywordtype">double</span> *u,<span class="keywordtype">char</span> *f)</div>
<div class="line">{</div>
<div class="line">  printf(<span class="stringliteral">&quot;\tWriting text solution file %s.\n&quot;</span>,f);</div>
<div class="line">  FILE *out;</div>
<div class="line">  out = fopen(f,<span class="stringliteral">&quot;w&quot;</span>);</div>
<div class="line">  <span class="keywordflow">if</span> (!out) {</div>
<div class="line">    fprintf(stderr,<span class="stringliteral">&quot;Error: could not open %s for writing.\n&quot;</span>,f);</div>
<div class="line">    <span class="keywordflow">return</span>;</div>
<div class="line">  }</div>
<div class="line"></div>
<div class="line">  <span class="keywordtype">double</span> *X = x;</div>
<div class="line">  <span class="keywordtype">double</span> *Y = x+imax;</div>
<div class="line"></div>
<div class="line">  <span class="comment">/* writing the data */</span></div>
<div class="line">  <span class="keywordtype">int</span> i,j;</div>
<div class="line">  <span class="keywordflow">for</span> (j=0; j&lt;jmax; j++) {</div>
<div class="line">    <span class="keywordflow">for</span> (i=0; i&lt;imax; i++) {</div>
<div class="line">      <span class="keywordtype">int</span> v, p = i + imax*j;</div>
<div class="line">      fprintf(out,<span class="stringliteral">&quot;%4d %4d &quot;</span>,i,j);</div>
<div class="line">      fprintf(out,<span class="stringliteral">&quot;%1.16E %1.16E &quot;</span>,X[i],Y[j]);</div>
<div class="line">      <span class="keywordflow">for</span> (v=0; v&lt;nvars; v++) fprintf(out,<span class="stringliteral">&quot;%1.16E &quot;</span>,u[nvars*p+v]);</div>
<div class="line">      fprintf(out,<span class="stringliteral">&quot;\n&quot;</span>);</div>
<div class="line">    }</div>
<div class="line">  }</div>
<div class="line">  fclose(out);</div>
<div class="line">  <span class="keywordflow">return</span>;</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"><span class="keywordtype">int</span> PostProcess(<span class="keywordtype">char</span> *fname, <span class="keywordtype">char</span> *oname, <span class="keywordtype">void</span> *p, <span class="keywordtype">int</span> flag)</div>
<div class="line">{</div>
<div class="line">  Parameters *params = (Parameters*) p;</div>
<div class="line">  FILE *in; in = fopen(fname,<span class="stringliteral">&quot;rb&quot;</span>);</div>
<div class="line"></div>
<div class="line">  <span class="keywordflow">if</span> (!in) <span class="keywordflow">return</span>(-1);</div>
<div class="line"></div>
<div class="line">  printf(<span class="stringliteral">&quot;Reading file %s.\n&quot;</span>,fname);</div>
<div class="line">  <span class="keywordtype">int</span> ndims, nvars;</div>
<div class="line">  <span class="keywordtype">double</span> *U,*x;</div>
<div class="line"></div>
<div class="line">  <span class="comment">/* read the file headers */</span></div>
<div class="line">  fread(&amp;ndims,<span class="keyword">sizeof</span>(<span class="keywordtype">int</span>),1,in);</div>
<div class="line">  fread(&amp;nvars,<span class="keyword">sizeof</span>(<span class="keywordtype">int</span>),1,in);</div>
<div class="line"></div>
<div class="line">  <span class="comment">/* some checks */</span></div>
<div class="line">  <span class="keywordflow">if</span> (ndims != 2) {</div>
<div class="line">    printf(<span class="stringliteral">&quot;Error: ndims in %s not equal to 2!\n&quot;</span>,fname);</div>
<div class="line">    <span class="keywordflow">return</span>(1);</div>
<div class="line">  }</div>
<div class="line">  <span class="keywordflow">if</span> (nvars != 4) {</div>
<div class="line">    printf(<span class="stringliteral">&quot;Error: nvars in %s not equal to 4!\n&quot;</span>,fname);</div>
<div class="line">    <span class="keywordflow">return</span>(1);</div>
<div class="line">  }</div>
<div class="line"></div>
<div class="line">  <span class="comment">/* read dimensions */</span></div>
<div class="line">  <span class="keywordtype">int</span> dims[ndims];</div>
<div class="line">  fread(dims,<span class="keyword">sizeof</span>(<span class="keywordtype">int</span>),ndims,in);</div>
<div class="line">  printf(<span class="stringliteral">&quot;Dimensions: %d x %d\n&quot;</span>,dims[0],dims[1]);</div>
<div class="line">  printf(<span class="stringliteral">&quot;Nvars     : %d\n&quot;</span>,nvars);</div>
<div class="line"></div>
<div class="line">  <span class="comment">/* allocate grid and solution arrays */</span></div>
<div class="line">  x = (<span class="keywordtype">double</span>*) calloc (dims[0]+dims[1]       ,<span class="keyword">sizeof</span>(<span class="keywordtype">double</span>));</div>
<div class="line">  U = (<span class="keywordtype">double</span>*) calloc (dims[0]*dims[1]*nvars ,<span class="keyword">sizeof</span>(<span class="keywordtype">double</span>));</div>
<div class="line"></div>
<div class="line">  <span class="comment">/* read grid and solution */</span></div>
<div class="line">  fread(x,<span class="keyword">sizeof</span>(<span class="keywordtype">double</span>),dims[0]+dims[1]      ,in);</div>
<div class="line">  fread(U,<span class="keyword">sizeof</span>(<span class="keywordtype">double</span>),dims[0]*dims[1]*nvars,in);</div>
<div class="line">  <span class="comment">/* done reading */</span></div>
<div class="line">  fclose(in);</div>
<div class="line"></div>
<div class="line">  <span class="keywordtype">int</span> imax = dims[0];</div>
<div class="line">  <span class="keywordtype">int</span> jmax = dims[1];</div>
<div class="line"></div>
<div class="line">  <span class="comment">/* allocate primitive variable array (rho, u, v, P, theta, rho0, P0, pi0, theta0) */</span></div>
<div class="line">  <span class="keywordtype">int</span> evars = 5;</div>
<div class="line">  <span class="keywordtype">double</span> *Q = (<span class="keywordtype">double</span>*) calloc ((nvars+evars)*imax*jmax,<span class="keyword">sizeof</span>(double));</div>
<div class="line">    </div>
<div class="line">  <span class="comment">/* calculate primitive variables */</span></div>
<div class="line">  <span class="keywordtype">int</span> i, j;</div>
<div class="line">  <span class="keywordtype">double</span> *X           = x;</div>
<div class="line">  <span class="keywordtype">double</span> *Y           = x+imax;</div>
<div class="line">  <span class="keywordtype">double</span> grav_y       = params-&gt;grav_y;</div>
<div class="line">  <span class="keywordtype">double</span> R            = params-&gt;R;</div>
<div class="line">  <span class="keywordtype">double</span> gamma        = params-&gt;gamma;</div>
<div class="line">  <span class="keywordtype">double</span> P_ref        = params-&gt;P_ref;</div>
<div class="line">  <span class="keywordtype">double</span> rho_ref      = params-&gt;rho_ref;</div>
<div class="line">  <span class="keywordtype">double</span> T_ref        = P_ref / (R*rho_ref);</div>
<div class="line">  <span class="keywordtype">double</span> inv_gamma_m1 = 1.0 / (gamma-1.0);</div>
<div class="line">  <span class="keywordtype">double</span> Cp           = gamma * inv_gamma_m1 * R;</div>
<div class="line"></div>
<div class="line">  <span class="keywordflow">for</span> (i=0; i&lt;imax; i++) {</div>
<div class="line">    <span class="keywordflow">for</span> (j=0; j&lt;jmax; j++) {</div>
<div class="line">      <span class="keywordtype">int</span> p = i + imax*j;</div>
<div class="line"></div>
<div class="line">      <span class="keywordtype">double</span> rho0, theta0, Pexner, P0;</div>
<div class="line">      theta0  = T_ref;</div>
<div class="line">      Pexner  = 1.0 - (grav_y*Y[j])/(Cp*T_ref);</div>
<div class="line">      rho0    = (P_ref/(R*theta0)) * <a class="code" href="a00199.html#a840eef18a5986381093ff8c176a2153c">raiseto</a>(Pexner, inv_gamma_m1);</div>
<div class="line">      P0      = P_ref   * <a class="code" href="a00199.html#a840eef18a5986381093ff8c176a2153c">raiseto</a>(Pexner, gamma*inv_gamma_m1);</div>
<div class="line"></div>
<div class="line">      <span class="keywordtype">double</span> rho, uvel, vvel, E, P, theta;</div>
<div class="line">      rho   = U[nvars*p+0];</div>
<div class="line">      uvel  = U[nvars*p+1] / rho;</div>
<div class="line">      vvel  = U[nvars*p+2] / rho;</div>
<div class="line">      E     = U[nvars*p+3];</div>
<div class="line">      P     = (gamma-1.0) * (E - 0.5*rho*(uvel*uvel+vvel*vvel));</div>
<div class="line">      theta = (E-0.5*rho*(uvel*uvel+vvel*vvel))/(Pexner*rho) * ((gamma-1.0)/R);</div>
<div class="line"></div>
<div class="line">      Q[(nvars+evars)*p+0] = rho;</div>
<div class="line">      Q[(nvars+evars)*p+1] = uvel;</div>
<div class="line">      Q[(nvars+evars)*p+2] = vvel;</div>
<div class="line">      Q[(nvars+evars)*p+3] = P;</div>
<div class="line">      Q[(nvars+evars)*p+4] = theta;</div>
<div class="line">      Q[(nvars+evars)*p+5] = rho0;</div>
<div class="line">      Q[(nvars+evars)*p+6] = P0;</div>
<div class="line">      Q[(nvars+evars)*p+7] = Pexner;</div>
<div class="line">      Q[(nvars+evars)*p+8] = theta0;</div>
<div class="line">    }</div>
<div class="line">  }</div>
<div class="line"></div>
<div class="line">  <span class="comment">/* write Tecplot/Text file */</span></div>
<div class="line">  <span class="keywordflow">if</span> (flag) <a class="code" href="a00195.html#a265b0583afb79edd2f2f5d5087e5c3bf">WriteTecplot2D</a>(nvars+evars,imax,jmax,x,Q,oname);</div>
<div class="line">  <span class="keywordflow">else</span>      WriteText2D   (nvars+evars,imax,jmax,x,Q,oname);</div>
<div class="line"></div>
<div class="line">  <span class="comment">/* clean up */</span></div>
<div class="line">  free(U);</div>
<div class="line">  free(Q);</div>
<div class="line">  free(x);</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"><span class="keywordtype">int</span> <a class="code" href="a00318.html#a3c04138a5bfe5d72780bb7e82a18e627">main</a>()</div>
<div class="line">{</div>
<div class="line">  FILE *out1, *out2, *in, *inputs;</div>
<div class="line">  <span class="keywordtype">char</span> filename[50], op_file_format[50], tecfile[50], overwrite[50];</div>
<div class="line"></div>
<div class="line">  <span class="keywordtype">int</span> flag;</div>
<div class="line">  printf(<span class="stringliteral">&quot;Write tecplot file (1) or plain text file (0): &quot;</span>);</div>
<div class="line">  scanf(<span class="stringliteral">&quot;%d&quot;</span>,&amp;flag);</div>
<div class="line"></div>
<div class="line">  <span class="keywordflow">if</span> ((flag != 1) &amp;&amp; (flag != 0)) {</div>
<div class="line">    printf(<span class="stringliteral">&quot;Error: Invalid input. Should be 1 or 0.\n&quot;</span>);</div>
<div class="line">    <span class="keywordflow">return</span>(0);</div>
<div class="line">  }</div>
<div class="line"></div>
<div class="line">  printf(<span class="stringliteral">&quot;Reading solver.inp.\n&quot;</span>);</div>
<div class="line">  inputs = fopen(<span class="stringliteral">&quot;solver.inp&quot;</span>,<span class="stringliteral">&quot;r&quot;</span>);</div>
<div class="line">  <span class="keywordflow">if</span> (!inputs) {</div>
<div class="line">    fprintf(stderr,<span class="stringliteral">&quot;Error: File \&quot;solver.inp\&quot; not found.\n&quot;</span>);</div>
<div class="line">    <span class="keywordflow">return</span>(1);</div>
<div class="line">  } <span class="keywordflow">else</span> {</div>
<div class="line">      <span class="keywordtype">char</span> word[100];</div>
<div class="line">    fscanf(inputs,<span class="stringliteral">&quot;%s&quot;</span>,word);</div>
<div class="line">    <span class="keywordflow">if</span> (!strcmp(word, <span class="stringliteral">&quot;begin&quot;</span>)){</div>
<div class="line">        <span class="keywordflow">while</span> (strcmp(word, <span class="stringliteral">&quot;end&quot;</span>)){</div>
<div class="line">            fscanf(inputs,<span class="stringliteral">&quot;%s&quot;</span>,word);</div>
<div class="line">            <span class="keywordflow">if</span>      (!strcmp(word, <span class="stringliteral">&quot;op_file_format&quot;</span>   ))  fscanf(inputs,<span class="stringliteral">&quot;%s&quot;</span> ,op_file_format);</div>
<div class="line">            <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcmp(word, <span class="stringliteral">&quot;op_overwrite&quot;</span>     ))  fscanf(inputs,<span class="stringliteral">&quot;%s&quot;</span> ,overwrite      );</div>
<div class="line">      }</div>
<div class="line">    }</div>
<div class="line">    fclose(inputs);</div>
<div class="line">  }</div>
<div class="line">  <span class="keywordflow">if</span> (strcmp(op_file_format,<span class="stringliteral">&quot;binary&quot;</span>) &amp;&amp; strcmp(op_file_format,<span class="stringliteral">&quot;bin&quot;</span>)) {</div>
<div class="line">    printf(<span class="stringliteral">&quot;Error: solution output needs to be in binary files.\n&quot;</span>);</div>
<div class="line">    <span class="keywordflow">return</span>(0);</div>
<div class="line">  }</div>
<div class="line"></div>
<div class="line">  Parameters params;</div>
<div class="line">  <span class="comment">/* default values */</span></div>
<div class="line">  params.grav_x   = 0.0;</div>
<div class="line">  params.grav_y   = 9.8;</div>
<div class="line">  params.R        = 287.058;</div>
<div class="line">  params.gamma    = 1.4;</div>
<div class="line">  params.P_ref    = 100000.0;</div>
<div class="line">  params.rho_ref  = 100000.0 / (params.R * 300.0);</div>
<div class="line">  params.HB       = 0;</div>
<div class="line">  <span class="comment">/* read these parameters from file */</span></div>
<div class="line">  printf(<span class="stringliteral">&quot;Reading physics.inp.\n&quot;</span>);</div>
<div class="line">  inputs = fopen(<span class="stringliteral">&quot;physics.inp&quot;</span>,<span class="stringliteral">&quot;r&quot;</span>);</div>
<div class="line">  <span class="keywordflow">if</span> (!inputs) {</div>
<div class="line">    fprintf(stderr,<span class="stringliteral">&quot;Error: File \&quot;physics.inp\&quot; not found.\n&quot;</span>);</div>
<div class="line">    <span class="keywordflow">return</span>(1);</div>
<div class="line">  } <span class="keywordflow">else</span> {</div>
<div class="line">      <span class="keywordtype">char</span> word[100];</div>
<div class="line">    fscanf(inputs,<span class="stringliteral">&quot;%s&quot;</span>,word);</div>
<div class="line">    <span class="keywordflow">if</span> (!strcmp(word, <span class="stringliteral">&quot;begin&quot;</span>)){</div>
<div class="line">        <span class="keywordflow">while</span> (strcmp(word, <span class="stringliteral">&quot;end&quot;</span>)){</div>
<div class="line">            fscanf(inputs,<span class="stringliteral">&quot;%s&quot;</span>,word);</div>
<div class="line">            <span class="keywordflow">if</span>      (!strcmp(word, <span class="stringliteral">&quot;gamma&quot;</span>))    fscanf(inputs,<span class="stringliteral">&quot;%lf&quot;</span>,&amp;params.gamma);</div>
<div class="line">            <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcmp(word, <span class="stringliteral">&quot;gravity&quot;</span>)) {</div>
<div class="line">          fscanf(inputs,<span class="stringliteral">&quot;%lf&quot;</span>,&amp;params.grav_x);</div>
<div class="line">          fscanf(inputs,<span class="stringliteral">&quot;%lf&quot;</span>,&amp;params.grav_y);</div>
<div class="line">        } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcmp(word,<span class="stringliteral">&quot;p_ref&quot;</span>))   fscanf(inputs,<span class="stringliteral">&quot;%lf&quot;</span>,&amp;params.P_ref);</div>
<div class="line">        <span class="keywordflow">else</span> <span class="keywordflow">if</span>   (!strcmp(word,<span class="stringliteral">&quot;rho_ref&quot;</span>)) fscanf(inputs,<span class="stringliteral">&quot;%lf&quot;</span>,&amp;params.rho_ref);</div>
<div class="line">        <span class="keywordflow">else</span> <span class="keywordflow">if</span>   (!strcmp(word,<span class="stringliteral">&quot;HB&quot;</span>))      fscanf(inputs,<span class="stringliteral">&quot;%d&quot;</span>,&amp;params.HB);</div>
<div class="line">      }</div>
<div class="line">    }</div>
<div class="line">    fclose(inputs);</div>
<div class="line">  }</div>
<div class="line">  <span class="keywordflow">if</span> (params.HB != 2) {</div>
<div class="line">    printf(<span class="stringliteral">&quot;Error: \&quot;HB\&quot; must be specified as 2 in physics.inp.\n&quot;</span>);</div>
<div class="line">    <span class="keywordflow">return</span>(0);</div>
<div class="line">  }</div>
<div class="line"></div>
<div class="line">  <span class="keywordflow">if</span> (!strcmp(overwrite,<span class="stringliteral">&quot;no&quot;</span>)) {</div>
<div class="line">    strcpy(filename,<span class="stringliteral">&quot;op_fg_00000.bin&quot;</span>);</div>
<div class="line">    <span class="keywordflow">while</span>(1) {</div>
<div class="line">      <span class="comment">/* set filename */</span></div>
<div class="line">      strcpy(tecfile,filename);</div>
<div class="line">      tecfile[12] = <span class="charliteral">&#39;d&#39;</span>;</div>
<div class="line">      tecfile[13] = <span class="charliteral">&#39;a&#39;</span>;</div>
<div class="line">      tecfile[14] = <span class="charliteral">&#39;t&#39;</span>;</div>
<div class="line">      <span class="keywordtype">int</span> err = PostProcess(filename, tecfile, &amp;params, flag);</div>
<div class="line">      <span class="keywordflow">if</span> (err == -1) {</div>
<div class="line">        printf(<span class="stringliteral">&quot;No more files found. Exiting.\n&quot;</span>);</div>
<div class="line">        <span class="keywordflow">break</span>;</div>
<div class="line">      }</div>
<div class="line">      IncrementFilename(filename);</div>
<div class="line">    }</div>
<div class="line">  } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcmp(overwrite,<span class="stringliteral">&quot;yes&quot;</span>)) {</div>
<div class="line">    strcpy(filename,<span class="stringliteral">&quot;op_fg.bin&quot;</span>);</div>
<div class="line">    <span class="comment">/* set filename */</span></div>
<div class="line">    strcpy(tecfile,filename);</div>
<div class="line">    tecfile[6] = <span class="charliteral">&#39;d&#39;</span>;</div>
<div class="line">    tecfile[7] = <span class="charliteral">&#39;a&#39;</span>;</div>
<div class="line">    tecfile[8] = <span class="charliteral">&#39;t&#39;</span>;</div>
<div class="line">    <span class="keywordtype">int</span> err = PostProcess(filename, tecfile, &amp;params, flag);</div>
<div class="line">    <span class="keywordflow">if</span> (err == -1) {</div>
<div class="line">      printf(<span class="stringliteral">&quot;Error: op.bin not found.\n&quot;</span>);</div>
<div class="line">      <span class="keywordflow">return</span>(0);</div>
<div class="line">    }</div>
<div class="line">  }</div>
<div class="line"></div>
<div class="line">  <span class="keywordflow">return</span>(0);</div>
<div class="line">}</div>
</div><!-- fragment --><p>The following animation shows the potential temperature perturbation. It was plotted using VisIt (<a href="https://wci.llnl.gov/simulation/computer-codes/visit/">https://wci.llnl.gov/simulation/computer-codes/visit/</a>) with tecplot2d format chosen in the above postprocessing code. </p>
<div class="image">
<img src="Solution_SG_2DNavStokRTB.gif" alt="Solution_SG_2DNavStokRTB.gif"/>
</div>
<p>Expected screen output: </p>
<div class="fragment"><div class="line"><a class="code" href="a00164.html">HyPar</a> - Parallel (MPI) version with 32 processes</div>
<div class="line">Compiled with PETSc time integration.</div>
<div class="line">-- Sparse Grids <a class="code" href="a00177.html">Simulation</a> --</div>
<div class="line">Sparse grids inputs:</div>
<div class="line">  log2 of minimum grid size:  3</div>
<div class="line">  interpolation order:  6</div>
<div class="line">  write sparse grids solutions?  no</div>
<div class="line">Allocated full grid simulation <span class="keywordtype">object</span>(s).</div>
<div class="line">Reading solver inputs from file &quot;solver.inp&quot;.</div>
<div class="line">  No. of dimensions                          : 2</div>
<div class="line">  No. of variables                           : 4</div>
<div class="line">  Domain size                                : 256 256 </div>
<div class="line">  Processes along each dimension             : 8 4 </div>
<div class="line">  No. of ghosts pts                          : 3</div>
<div class="line">  No. of iter.                               : 30000</div>
<div class="line">  Restart iteration                          : 0</div>
<div class="line">  Time integration scheme                    : rk (ssprk3)</div>
<div class="line">  Spatial discretization scheme (hyperbolic) : upw5</div>
<div class="line">  Split hyperbolic flux term?                : no</div>
<div class="line">  Interpolation type for hyperbolic term     : components</div>
<div class="line">  Spatial discretization type   (parabolic ) : nonconservative-2stage</div>
<div class="line">  Spatial discretization scheme (parabolic ) : 4</div>
<div class="line">  Time Step                                  : 1.000000E-02</div>
<div class="line">  Check for conservation                     : no</div>
<div class="line">  Screen output iterations                   : 500</div>
<div class="line">  File output iterations                     : 1000</div>
<div class="line">  Initial solution file type                 : binary</div>
<div class="line">  Initial solution read mode                 : serial</div>
<div class="line">  Solution file write mode                   : serial</div>
<div class="line">  Solution file format                       : binary</div>
<div class="line">  Overwrite solution file                    : no</div>
<div class="line">  Physical model                             : navierstokes2d</div>
<div class="line">Processor distribution for full grid <span class="keywordtype">object</span>:    8   4</div>
<div class="line">Initializing sparse grids...</div>
<div class="line">  Number of spatial dimensions: 2</div>
<div class="line">  Computing sparse grids dimensions...</div>
<div class="line">  Number of sparse grid domains in combination technique: 11</div>
<div class="line">  Computing processor decompositions...</div>
<div class="line">Sparse Grids: Combination technique grids sizes and coefficients are:-</div>
<div class="line">    0: dim = (  256     8 ),  coeff = +1.00e+00, iproc = (   32     1 )</div>
<div class="line">    1: dim = (  128    16 ),  coeff = +1.00e+00, iproc = (   16     2 )</div>
<div class="line">    2: dim = (   64    32 ),  coeff = +1.00e+00, iproc = (    8     4 )</div>
<div class="line">    3: dim = (   32    64 ),  coeff = +1.00e+00, iproc = (    4     8 )</div>
<div class="line">    4: dim = (   16   128 ),  coeff = +1.00e+00, iproc = (    2    16 )</div>
<div class="line">    5: dim = (    8   256 ),  coeff = +1.00e+00, iproc = (    1    32 )</div>
<div class="line">    6: dim = (  128     8 ),  coeff = -1.00e+00, iproc = (   32     1 )</div>
<div class="line">    7: dim = (   64    16 ),  coeff = -1.00e+00, iproc = (   16     2 )</div>
<div class="line">    8: dim = (   32    32 ),  coeff = -1.00e+00, iproc = (    8     4 )</div>
<div class="line">    9: dim = (   16    64 ),  coeff = -1.00e+00, iproc = (    2    16 )</div>
<div class="line">   10: dim = (    8   128 ),  coeff = -1.00e+00, iproc = (    1    32 )</div>
<div class="line">Allocating data arrays for full grid.</div>
<div class="line">Partitioning domain and allocating data arrays.</div>
<div class="line">Reading array from binary file initial.inp (Serial mode).</div>
<div class="line">Volume integral of the initial solution:</div>
<div class="line"> 0:  1.1234279568688401E+06</div>
<div class="line"> 1:  0.0000000000000000E+00</div>
<div class="line"> 2:  0.0000000000000000E+00</div>
<div class="line"> 3:  2.3801254424407306E+11</div>
<div class="line">Interpolating grid coordinates to sparse grids domain 0.</div>
<div class="line">Interpolating grid coordinates to sparse grids domain 1.</div>
<div class="line">Interpolating grid coordinates to sparse grids domain 2.</div>
<div class="line">Interpolating grid coordinates to sparse grids domain 3.</div>
<div class="line">Interpolating grid coordinates to sparse grids domain 4.</div>
<div class="line">Interpolating grid coordinates to sparse grids domain 5.</div>
<div class="line">Interpolating grid coordinates to sparse grids domain 6.</div>
<div class="line">Interpolating grid coordinates to sparse grids domain 7.</div>
<div class="line">Interpolating grid coordinates to sparse grids domain 8.</div>
<div class="line">Interpolating grid coordinates to sparse grids domain 9.</div>
<div class="line">Interpolating grid coordinates to sparse grids domain 10.</div>
<div class="line">Domain 0: Reading boundary conditions from boundary.inp.</div>
<div class="line">  Boundary                      slip-wall:  Along dimension  0 and face +1</div>
<div class="line">  Boundary                      slip-wall:  Along dimension  0 and face -1</div>
<div class="line">  Boundary                      slip-wall:  Along dimension  1 and face +1</div>
<div class="line">  Boundary                      slip-wall:  Along dimension  1 and face -1</div>
<div class="line">4 boundary condition(s) read.</div>
<div class="line">Domain 1: Reading boundary conditions from boundary.inp.</div>
<div class="line">  Boundary                      slip-wall:  Along dimension  0 and face +1</div>
<div class="line">  Boundary                      slip-wall:  Along dimension  0 and face -1</div>
<div class="line">  Boundary                      slip-wall:  Along dimension  1 and face +1</div>
<div class="line">  Boundary                      slip-wall:  Along dimension  1 and face -1</div>
<div class="line">4 boundary condition(s) read.</div>
<div class="line">Domain 2: Reading boundary conditions from boundary.inp.</div>
<div class="line">  Boundary                      slip-wall:  Along dimension  0 and face +1</div>
<div class="line">  Boundary                      slip-wall:  Along dimension  0 and face -1</div>
<div class="line">  Boundary                      slip-wall:  Along dimension  1 and face +1</div>
<div class="line">  Boundary                      slip-wall:  Along dimension  1 and face -1</div>
<div class="line">4 boundary condition(s) read.</div>
<div class="line">Domain 3: Reading boundary conditions from boundary.inp.</div>
<div class="line">  Boundary                      slip-wall:  Along dimension  0 and face +1</div>
<div class="line">  Boundary                      slip-wall:  Along dimension  0 and face -1</div>
<div class="line">  Boundary                      slip-wall:  Along dimension  1 and face +1</div>
<div class="line">  Boundary                      slip-wall:  Along dimension  1 and face -1</div>
<div class="line">4 boundary condition(s) read.</div>
<div class="line">Domain 4: Reading boundary conditions from boundary.inp.</div>
<div class="line">  Boundary                      slip-wall:  Along dimension  0 and face +1</div>
<div class="line">  Boundary                      slip-wall:  Along dimension  0 and face -1</div>
<div class="line">  Boundary                      slip-wall:  Along dimension  1 and face +1</div>
<div class="line">  Boundary                      slip-wall:  Along dimension  1 and face -1</div>
<div class="line">4 boundary condition(s) read.</div>
<div class="line">Domain 5: Reading boundary conditions from boundary.inp.</div>
<div class="line">  Boundary                      slip-wall:  Along dimension  0 and face +1</div>
<div class="line">  Boundary                      slip-wall:  Along dimension  0 and face -1</div>
<div class="line">  Boundary                      slip-wall:  Along dimension  1 and face +1</div>
<div class="line">  Boundary                      slip-wall:  Along dimension  1 and face -1</div>
<div class="line">4 boundary condition(s) read.</div>
<div class="line">Domain 6: Reading boundary conditions from boundary.inp.</div>
<div class="line">  Boundary                      slip-wall:  Along dimension  0 and face +1</div>
<div class="line">  Boundary                      slip-wall:  Along dimension  0 and face -1</div>
<div class="line">  Boundary                      slip-wall:  Along dimension  1 and face +1</div>
<div class="line">  Boundary                      slip-wall:  Along dimension  1 and face -1</div>
<div class="line">4 boundary condition(s) read.</div>
<div class="line">Domain 7: Reading boundary conditions from boundary.inp.</div>
<div class="line">  Boundary                      slip-wall:  Along dimension  0 and face +1</div>
<div class="line">  Boundary                      slip-wall:  Along dimension  0 and face -1</div>
<div class="line">  Boundary                      slip-wall:  Along dimension  1 and face +1</div>
<div class="line">  Boundary                      slip-wall:  Along dimension  1 and face -1</div>
<div class="line">4 boundary condition(s) read.</div>
<div class="line">Domain 8: Reading boundary conditions from boundary.inp.</div>
<div class="line">  Boundary                      slip-wall:  Along dimension  0 and face +1</div>
<div class="line">  Boundary                      slip-wall:  Along dimension  0 and face -1</div>
<div class="line">  Boundary                      slip-wall:  Along dimension  1 and face +1</div>
<div class="line">  Boundary                      slip-wall:  Along dimension  1 and face -1</div>
<div class="line">4 boundary condition(s) read.</div>
<div class="line">Domain 9: Reading boundary conditions from boundary.inp.</div>
<div class="line">  Boundary                      slip-wall:  Along dimension  0 and face +1</div>
<div class="line">  Boundary                      slip-wall:  Along dimension  0 and face -1</div>
<div class="line">  Boundary                      slip-wall:  Along dimension  1 and face +1</div>
<div class="line">  Boundary                      slip-wall:  Along dimension  1 and face -1</div>
<div class="line">4 boundary condition(s) read.</div>
<div class="line">Domain 10: Reading boundary conditions from boundary.inp.</div>
<div class="line">  Boundary                      slip-wall:  Along dimension  0 and face +1</div>
<div class="line">  Boundary                      slip-wall:  Along dimension  0 and face -1</div>
<div class="line">  Boundary                      slip-wall:  Along dimension  1 and face +1</div>
<div class="line">  Boundary                      slip-wall:  Along dimension  1 and face -1</div>
<div class="line">4 boundary condition(s) read.</div>
<div class="line">Initializing solvers.</div>
<div class="line">Initializing physics. Model = &quot;navierstokes2d&quot;</div>
<div class="line">Reading physical model inputs from file &quot;physics.inp&quot;.</div>
<div class="line">Interpolating initial solution to sparse grids domain 0.</div>
<div class="line">  Volume integral of the initial solution on sparse grids domain 0:</div>
<div class="line">     0:  1.1234251586382261E+06</div>
<div class="line">     1:  0.0000000000000000E+00</div>
<div class="line">     2:  0.0000000000000000E+00</div>
<div class="line">     3:  2.3801105349946042E+11</div>
<div class="line">Interpolating initial solution to sparse grids domain 1.</div>
<div class="line">  Volume integral of the initial solution on sparse grids domain 1:</div>
<div class="line">     0:  1.1234271613915111E+06</div>
<div class="line">     1:  0.0000000000000000E+00</div>
<div class="line">     2:  0.0000000000000000E+00</div>
<div class="line">     3:  2.3801217265073633E+11</div>
<div class="line">Interpolating initial solution to sparse grids domain 2.</div>
<div class="line">  Volume integral of the initial solution on sparse grids domain 2:</div>
<div class="line">     0:  1.1234277731541058E+06</div>
<div class="line">     1:  0.0000000000000000E+00</div>
<div class="line">     2:  0.0000000000000000E+00</div>
<div class="line">     3:  2.3801245243865408E+11</div>
<div class="line">Interpolating initial solution to sparse grids domain 3.</div>
<div class="line">  Volume integral of the initial solution on sparse grids domain 3:</div>
<div class="line">     0:  1.1234449109078781E+06</div>
<div class="line">     1:  0.0000000000000000E+00</div>
<div class="line">     2:  0.0000000000000000E+00</div>
<div class="line">     3:  2.3801756102382306E+11</div>
<div class="line">Interpolating initial solution to sparse grids domain 4.</div>
<div class="line">  Volume integral of the initial solution on sparse grids domain 4:</div>
<div class="line">     0:  1.1233656900511470E+06</div>
<div class="line">     1:  0.0000000000000000E+00</div>
<div class="line">     2:  0.0000000000000000E+00</div>
<div class="line">     3:  2.3799406404289981E+11</div>
<div class="line">Interpolating initial solution to sparse grids domain 5.</div>
<div class="line">  Volume integral of the initial solution on sparse grids domain 5:</div>
<div class="line">     0:  1.1234285119873849E+06</div>
<div class="line">     1:  0.0000000000000000E+00</div>
<div class="line">     2:  0.0000000000000000E+00</div>
<div class="line">     3:  2.3801254424407306E+11</div>
<div class="line">Interpolating initial solution to sparse grids domain 6.</div>
<div class="line">  Volume integral of the initial solution on sparse grids domain 6:</div>
<div class="line">     0:  1.1234251586382259E+06</div>
<div class="line">     1:  0.0000000000000000E+00</div>
<div class="line">     2:  0.0000000000000000E+00</div>
<div class="line">     3:  2.3801105349946048E+11</div>
<div class="line">Interpolating initial solution to sparse grids domain 7.</div>
<div class="line">  Volume integral of the initial solution on sparse grids domain 7:</div>
<div class="line">     0:  1.1234271612869459E+06</div>
<div class="line">     1:  0.0000000000000000E+00</div>
<div class="line">     2:  0.0000000000000000E+00</div>
<div class="line">     3:  2.3801217265073633E+11</div>
<div class="line">Interpolating initial solution to sparse grids domain 8.</div>
<div class="line">  Volume integral of the initial solution on sparse grids domain 8:</div>
<div class="line">     0:  1.1234277774468665E+06</div>
<div class="line">     1:  0.0000000000000000E+00</div>
<div class="line">     2:  0.0000000000000000E+00</div>
<div class="line">     3:  2.3801245243865405E+11</div>
<div class="line">Interpolating initial solution to sparse grids domain 9.</div>
<div class="line">  Volume integral of the initial solution on sparse grids domain 9:</div>
<div class="line">     0:  1.1234449553994713E+06</div>
<div class="line">     1:  0.0000000000000000E+00</div>
<div class="line">     2:  0.0000000000000000E+00</div>
<div class="line">     3:  2.3801756102382306E+11</div>
<div class="line">Interpolating initial solution to sparse grids domain 10.</div>
<div class="line">  Volume integral of the initial solution on sparse grids domain 10:</div>
<div class="line">     0:  1.1233661938574852E+06</div>
<div class="line">     1:  0.0000000000000000E+00</div>
<div class="line">     2:  0.0000000000000000E+00</div>
<div class="line">     3:  2.3799406404289972E+11</div>
<div class="line">Setting up time integration.</div>
<div class="line">Solving in time (from 0 to 30000 iterations)</div>
<div class="line">Writing solution file op_fg_00000.bin.</div>
<div class="line">--</div>
<div class="line">Iteration:     500,  Time: 5.000e+00</div>
<div class="line">  Max CFL: 4.427E-01,  Max Diff. No.: -1.000E+00,    Norm: 6.5813E+00</div>
<div class="line">--</div>
<div class="line"></div>
<div class="line">--</div>
<div class="line">Iteration:    1000,  Time: 1.000e+01</div>
<div class="line">  Max CFL: 4.427E-01,  Max Diff. No.: -1.000E+00,    Norm: 5.5077E+00</div>
<div class="line">--</div>
<div class="line"></div>
<div class="line">Writing solution file op_fg_00001.bin.</div>
<div class="line">--</div>
<div class="line">Iteration:    1500,  Time: 1.500e+01</div>
<div class="line">  Max CFL: 4.427E-01,  Max Diff. No.: -1.000E+00,    Norm: 4.9858E+00</div>
<div class="line">--</div>
<div class="line"></div>
<div class="line">--</div>
<div class="line">Iteration:    2000,  Time: 2.000e+01</div>
<div class="line">  Max CFL: 4.427E-01,  Max Diff. No.: -1.000E+00,    Norm: 4.5788E+00</div>
<div class="line">--</div>
<div class="line"></div>
<div class="line">Writing solution file op_fg_00002.bin.</div>
<div class="line">--</div>
<div class="line">Iteration:    2500,  Time: 2.500e+01</div>
<div class="line">  Max CFL: 4.427E-01,  Max Diff. No.: -1.000E+00,    Norm: 4.2167E+00</div>
<div class="line">--</div>
<div class="line"></div>
<div class="line">--</div>
<div class="line">Iteration:    3000,  Time: 3.000e+01</div>
<div class="line">  Max CFL: 4.427E-01,  Max Diff. No.: -1.000E+00,    Norm: 3.9285E+00</div>
<div class="line">--</div>
<div class="line"></div>
<div class="line">Writing solution file op_fg_00003.bin.</div>
<div class="line">--</div>
<div class="line">Iteration:    3500,  Time: 3.500e+01</div>
<div class="line">  Max CFL: 4.427E-01,  Max Diff. No.: -1.000E+00,    Norm: 9.9974E-01</div>
<div class="line">--</div>
<div class="line"></div>
<div class="line">--</div>
<div class="line">Iteration:    4000,  Time: 4.000e+01</div>
<div class="line">  Max CFL: 4.427E-01,  Max Diff. No.: -1.000E+00,    Norm: 3.6060E+00</div>
<div class="line">--</div>
<div class="line"></div>
<div class="line">Writing solution file op_fg_00004.bin.</div>
<div class="line">--</div>
<div class="line">Iteration:    4500,  Time: 4.500e+01</div>
<div class="line">  Max CFL: 4.427E-01,  Max Diff. No.: -1.000E+00,    Norm: 3.5391E+00</div>
<div class="line">--</div>
<div class="line"></div>
<div class="line">--</div>
<div class="line">Iteration:    5000,  Time: 5.000e+01</div>
<div class="line">  Max CFL: 4.427E-01,  Max Diff. No.: -1.000E+00,    Norm: 3.4880E+00</div>
<div class="line">--</div>
<div class="line"></div>
<div class="line">Writing solution file op_fg_00005.bin.</div>
<div class="line">--</div>
<div class="line">Iteration:    5500,  Time: 5.500e+01</div>
<div class="line">  Max CFL: 4.427E-01,  Max Diff. No.: -1.000E+00,    Norm: 3.3799E+00</div>
<div class="line">--</div>
<div class="line"></div>
<div class="line">--</div>
<div class="line">Iteration:    6000,  Time: 6.000e+01</div>
<div class="line">  Max CFL: 4.427E-01,  Max Diff. No.: -1.000E+00,    Norm: 3.2350E+00</div>
<div class="line">--</div>
<div class="line"></div>
<div class="line">Writing solution file op_fg_00006.bin.</div>
<div class="line">--</div>
<div class="line">Iteration:    6500,  Time: 6.500e+01</div>
<div class="line">  Max CFL: 4.427E-01,  Max Diff. No.: -1.000E+00,    Norm: 3.1020E+00</div>
<div class="line">--</div>
<div class="line"></div>
<div class="line">--</div>
<div class="line">Iteration:    7000,  Time: 7.000e+01</div>
<div class="line">  Max CFL: 4.427E-01,  Max Diff. No.: -1.000E+00,    Norm: 7.8745E-01</div>
<div class="line">--</div>
<div class="line"></div>
<div class="line">Writing solution file op_fg_00007.bin.</div>
<div class="line">--</div>
<div class="line">Iteration:    7500,  Time: 7.500e+01</div>
<div class="line">  Max CFL: 4.427E-01,  Max Diff. No.: -1.000E+00,    Norm: 2.9683E+00</div>
<div class="line">--</div>
<div class="line"></div>
<div class="line">--</div>
<div class="line">Iteration:    8000,  Time: 8.000e+01</div>
<div class="line">  Max CFL: 4.427E-01,  Max Diff. No.: -1.000E+00,    Norm: 2.9582E+00</div>
<div class="line">--</div>
<div class="line"></div>
<div class="line">Writing solution file op_fg_00008.bin.</div>
<div class="line">--</div>
<div class="line">Iteration:    8500,  Time: 8.500e+01</div>
<div class="line">  Max CFL: 4.427E-01,  Max Diff. No.: -1.000E+00,    Norm: 2.9630E+00</div>
<div class="line">--</div>
<div class="line"></div>
<div class="line">--</div>
<div class="line">Iteration:    9000,  Time: 9.000e+01</div>
<div class="line">  Max CFL: 4.427E-01,  Max Diff. No.: -1.000E+00,    Norm: 2.8798E+00</div>
<div class="line">--</div>
<div class="line"></div>
<div class="line">Writing solution file op_fg_00009.bin.</div>
<div class="line">--</div>
<div class="line">Iteration:    9500,  Time: 9.500e+01</div>
<div class="line">  Max CFL: 4.427E-01,  Max Diff. No.: -1.000E+00,    Norm: 2.7983E+00</div>
<div class="line">--</div>
<div class="line"></div>
<div class="line">--</div>
<div class="line">Iteration:   10000,  Time: 1.000e+02</div>
<div class="line">  Max CFL: 4.427E-01,  Max Diff. No.: -1.000E+00,    Norm: 2.7053E+00</div>
<div class="line">--</div>
<div class="line"></div>
<div class="line">Writing solution file op_fg_00010.bin.</div>
<div class="line">--</div>
<div class="line">Iteration:   10500,  Time: 1.050e+02</div>
<div class="line">  Max CFL: 4.427E-01,  Max Diff. No.: -1.000E+00,    Norm: 7.4930E-01</div>
<div class="line">--</div>
<div class="line"></div>
<div class="line">--</div>
<div class="line">Iteration:   11000,  Time: 1.100e+02</div>
<div class="line">  Max CFL: 4.427E-01,  Max Diff. No.: -1.000E+00,    Norm: 2.6256E+00</div>
<div class="line">--</div>
<div class="line"></div>
<div class="line">Writing solution file op_fg_00011.bin.</div>
<div class="line">--</div>
<div class="line">Iteration:   11500,  Time: 1.150e+02</div>
<div class="line">  Max CFL: 4.427E-01,  Max Diff. No.: -1.000E+00,    Norm: 2.6302E+00</div>
<div class="line">--</div>
<div class="line"></div>
<div class="line">--</div>
<div class="line">Iteration:   12000,  Time: 1.200e+02</div>
<div class="line">  Max CFL: 4.427E-01,  Max Diff. No.: -1.000E+00,    Norm: 2.6453E+00</div>
<div class="line">--</div>
<div class="line"></div>
<div class="line">Writing solution file op_fg_00012.bin.</div>
<div class="line">--</div>
<div class="line">Iteration:   12500,  Time: 1.250e+02</div>
<div class="line">  Max CFL: 4.427E-01,  Max Diff. No.: -1.000E+00,    Norm: 2.5970E+00</div>
<div class="line">--</div>
<div class="line"></div>
<div class="line">--</div>
<div class="line">Iteration:   13000,  Time: 1.300e+02</div>
<div class="line">  Max CFL: 4.427E-01,  Max Diff. No.: -1.000E+00,    Norm: 2.5272E+00</div>
<div class="line">--</div>
<div class="line"></div>
<div class="line">Writing solution file op_fg_00013.bin.</div>
<div class="line">--</div>
<div class="line">Iteration:   13500,  Time: 1.350e+02</div>
<div class="line">  Max CFL: 4.427E-01,  Max Diff. No.: -1.000E+00,    Norm: 2.4529E+00</div>
<div class="line">--</div>
<div class="line"></div>
<div class="line">--</div>
<div class="line">Iteration:   14000,  Time: 1.400e+02</div>
<div class="line">  Max CFL: 4.427E-01,  Max Diff. No.: -1.000E+00,    Norm: 7.8316E-01</div>
<div class="line">--</div>
<div class="line"></div>
<div class="line">Writing solution file op_fg_00014.bin.</div>
<div class="line">--</div>
<div class="line">Iteration:   14500,  Time: 1.450e+02</div>
<div class="line">  Max CFL: 4.427E-01,  Max Diff. No.: -1.000E+00,    Norm: 2.3973E+00</div>
<div class="line">--</div>
<div class="line"></div>
<div class="line">--</div>
<div class="line">Iteration:   15000,  Time: 1.500e+02</div>
<div class="line">  Max CFL: 4.427E-01,  Max Diff. No.: -1.000E+00,    Norm: 2.4074E+00</div>
<div class="line">--</div>
<div class="line"></div>
<div class="line">Writing solution file op_fg_00015.bin.</div>
<div class="line">--</div>
<div class="line">Iteration:   15500,  Time: 1.550e+02</div>
<div class="line">  Max CFL: 4.427E-01,  Max Diff. No.: -1.000E+00,    Norm: 2.4236E+00</div>
<div class="line">--</div>
<div class="line"></div>
<div class="line">--</div>
<div class="line">Iteration:   16000,  Time: 1.600e+02</div>
<div class="line">  Max CFL: 4.427E-01,  Max Diff. No.: -1.000E+00,    Norm: 2.4106E+00</div>
<div class="line">--</div>
<div class="line"></div>
<div class="line">Writing solution file op_fg_00016.bin.</div>
<div class="line">--</div>
<div class="line">Iteration:   16500,  Time: 1.650e+02</div>
<div class="line">  Max CFL: 4.427E-01,  Max Diff. No.: -1.000E+00,    Norm: 2.3345E+00</div>
<div class="line">--</div>
<div class="line"></div>
<div class="line">--</div>
<div class="line">Iteration:   17000,  Time: 1.700e+02</div>
<div class="line">  Max CFL: 4.427E-01,  Max Diff. No.: -1.000E+00,    Norm: 2.2712E+00</div>
<div class="line">--</div>
<div class="line"></div>
<div class="line">Writing solution file op_fg_00017.bin.</div>
<div class="line">--</div>
<div class="line">Iteration:   17500,  Time: 1.750e+02</div>
<div class="line">  Max CFL: 4.427E-01,  Max Diff. No.: -1.000E+00,    Norm: 8.4438E-01</div>
<div class="line">--</div>
<div class="line"></div>
<div class="line">--</div>
<div class="line">Iteration:   18000,  Time: 1.800e+02</div>
<div class="line">  Max CFL: 4.427E-01,  Max Diff. No.: -1.000E+00,    Norm: 2.2288E+00</div>
<div class="line">--</div>
<div class="line"></div>
<div class="line">Writing solution file op_fg_00018.bin.</div>
<div class="line">--</div>
<div class="line">Iteration:   18500,  Time: 1.850e+02</div>
<div class="line">  Max CFL: 4.427E-01,  Max Diff. No.: -1.000E+00,    Norm: 2.2418E+00</div>
<div class="line">--</div>
<div class="line"></div>
<div class="line">--</div>
<div class="line">Iteration:   19000,  Time: 1.900e+02</div>
<div class="line">  Max CFL: 4.427E-01,  Max Diff. No.: -1.000E+00,    Norm: 2.2576E+00</div>
<div class="line">--</div>
<div class="line"></div>
<div class="line">Writing solution file op_fg_00019.bin.</div>
<div class="line">--</div>
<div class="line">Iteration:   19500,  Time: 1.950e+02</div>
<div class="line">  Max CFL: 4.427E-01,  Max Diff. No.: -1.000E+00,    Norm: 2.2643E+00</div>
<div class="line">--</div>
<div class="line"></div>
<div class="line">--</div>
<div class="line">Iteration:   20000,  Time: 2.000e+02</div>
<div class="line">  Max CFL: 4.427E-01,  Max Diff. No.: -1.000E+00,    Norm: 2.1870E+00</div>
<div class="line">--</div>
<div class="line"></div>
<div class="line">Writing solution file op_fg_00020.bin.</div>
<div class="line">--</div>
<div class="line">Iteration:   20500,  Time: 2.050e+02</div>
<div class="line">  Max CFL: 4.427E-01,  Max Diff. No.: -1.000E+00,    Norm: 2.1311E+00</div>
<div class="line">--</div>
<div class="line"></div>
<div class="line">--</div>
<div class="line">Iteration:   21000,  Time: 2.100e+02</div>
<div class="line">  Max CFL: 4.427E-01,  Max Diff. No.: -1.000E+00,    Norm: 9.1303E-01</div>
<div class="line">--</div>
<div class="line"></div>
<div class="line">Writing solution file op_fg_00021.bin.</div>
<div class="line">--</div>
<div class="line">Iteration:   21500,  Time: 2.150e+02</div>
<div class="line">  Max CFL: 4.427E-01,  Max Diff. No.: -1.000E+00,    Norm: 2.0969E+00</div>
<div class="line">--</div>
<div class="line"></div>
<div class="line">--</div>
<div class="line">Iteration:   22000,  Time: 2.200e+02</div>
<div class="line">  Max CFL: 4.427E-01,  Max Diff. No.: -1.000E+00,    Norm: 2.1118E+00</div>
<div class="line">--</div>
<div class="line"></div>
<div class="line">Writing solution file op_fg_00022.bin.</div>
<div class="line">--</div>
<div class="line">Iteration:   22500,  Time: 2.250e+02</div>
<div class="line">  Max CFL: 4.427E-01,  Max Diff. No.: -1.000E+00,    Norm: 2.1269E+00</div>
<div class="line">--</div>
<div class="line"></div>
<div class="line">--</div>
<div class="line">Iteration:   23000,  Time: 2.300e+02</div>
<div class="line">  Max CFL: 4.427E-01,  Max Diff. No.: -1.000E+00,    Norm: 2.1371E+00</div>
<div class="line">--</div>
<div class="line"></div>
<div class="line">Writing solution file op_fg_00023.bin.</div>
<div class="line">--</div>
<div class="line">Iteration:   23500,  Time: 2.350e+02</div>
<div class="line">  Max CFL: 4.427E-01,  Max Diff. No.: -1.000E+00,    Norm: 2.0685E+00</div>
<div class="line">--</div>
<div class="line"></div>
<div class="line">--</div>
<div class="line">Iteration:   24000,  Time: 2.400e+02</div>
<div class="line">  Max CFL: 4.427E-01,  Max Diff. No.: -1.000E+00,    Norm: 2.0180E+00</div>
<div class="line">--</div>
<div class="line"></div>
<div class="line">Writing solution file op_fg_00024.bin.</div>
<div class="line">--</div>
<div class="line">Iteration:   24500,  Time: 2.450e+02</div>
<div class="line">  Max CFL: 4.427E-01,  Max Diff. No.: -1.000E+00,    Norm: 9.8161E-01</div>
<div class="line">--</div>
<div class="line"></div>
<div class="line">--</div>
<div class="line">Iteration:   25000,  Time: 2.500e+02</div>
<div class="line">  Max CFL: 4.427E-01,  Max Diff. No.: -1.000E+00,    Norm: 1.9894E+00</div>
<div class="line">--</div>
<div class="line"></div>
<div class="line">Writing solution file op_fg_00025.bin.</div>
<div class="line">--</div>
<div class="line">Iteration:   25500,  Time: 2.550e+02</div>
<div class="line">  Max CFL: 4.427E-01,  Max Diff. No.: -1.000E+00,    Norm: 2.0059E+00</div>
<div class="line">--</div>
<div class="line"></div>
<div class="line">--</div>
<div class="line">Iteration:   26000,  Time: 2.600e+02</div>
<div class="line">  Max CFL: 4.427E-01,  Max Diff. No.: -1.000E+00,    Norm: 2.0204E+00</div>
<div class="line">--</div>
<div class="line"></div>
<div class="line">Writing solution file op_fg_00026.bin.</div>
<div class="line">--</div>
<div class="line">Iteration:   26500,  Time: 2.650e+02</div>
<div class="line">  Max CFL: 4.427E-01,  Max Diff. No.: -1.000E+00,    Norm: 2.0221E+00</div>
<div class="line">--</div>
<div class="line"></div>
<div class="line">--</div>
<div class="line">Iteration:   27000,  Time: 2.700e+02</div>
<div class="line">  Max CFL: 4.427E-01,  Max Diff. No.: -1.000E+00,    Norm: 1.9700E+00</div>
<div class="line">--</div>
<div class="line"></div>
<div class="line">Writing solution file op_fg_00027.bin.</div>
<div class="line">--</div>
<div class="line">Iteration:   27500,  Time: 2.750e+02</div>
<div class="line">  Max CFL: 4.427E-01,  Max Diff. No.: -1.000E+00,    Norm: 1.9239E+00</div>
<div class="line">--</div>
<div class="line"></div>
<div class="line">--</div>
<div class="line">Iteration:   28000,  Time: 2.800e+02</div>
<div class="line">  Max CFL: 4.427E-01,  Max Diff. No.: -1.000E+00,    Norm: 1.0484E+00</div>
<div class="line">--</div>
<div class="line"></div>
<div class="line">Writing solution file op_fg_00028.bin.</div>
<div class="line">--</div>
<div class="line">Iteration:   28500,  Time: 2.850e+02</div>
<div class="line">  Max CFL: 4.427E-01,  Max Diff. No.: -1.000E+00,    Norm: 1.8991E+00</div>
<div class="line">--</div>
<div class="line"></div>
<div class="line">--</div>
<div class="line">Iteration:   29000,  Time: 2.900e+02</div>
<div class="line">  Max CFL: 4.427E-01,  Max Diff. No.: -1.000E+00,    Norm: 1.9173E+00</div>
<div class="line">--</div>
<div class="line"></div>
<div class="line">Writing solution file op_fg_00029.bin.</div>
<div class="line">--</div>
<div class="line">Iteration:   29500,  Time: 2.950e+02</div>
<div class="line">  Max CFL: 4.427E-01,  Max Diff. No.: -1.000E+00,    Norm: 1.9311E+00</div>
<div class="line">--</div>
<div class="line"></div>
<div class="line">--</div>
<div class="line">Iteration:   30000,  Time: 3.000e+02</div>
<div class="line">  Max CFL: 4.427E-01,  Max Diff. No.: -1.000E+00,    Norm: 1.9177E+00</div>
<div class="line">--</div>
<div class="line"></div>
<div class="line">Writing solution file op_fg_00030.bin.</div>
<div class="line">Completed time integration (Final time: 300.000000).</div>
<div class="line"></div>
<div class="line">Solver runtime (in seconds): 6.0051986999999997E+01</div>
<div class="line">Total  runtime (in seconds): 6.0287636999999997E+01</div>
<div class="line">Deallocating arrays.</div>
<div class="line">Finished.</div>
</div><!-- fragment --> </div></div><!-- contents -->
</div><!-- doc-content -->
<!-- Start of StatCounter Code for Default Guide -->
<script type="text/javascript">
var sc_project=10897352; 
var sc_invisible=1; 
var sc_security="83042f57"; 
var scJsHost = (("https:" == document.location.protocol) ?
"https://secure." : "http://www.");
document.write("<sc"+"ript type='text/javascript' src='" +
scJsHost+
"statcounter.com/counter/counter.js'></"+"script>");
</script>
<noscript><div class="statcounter"><a title="website
statistics" href="http://statcounter.com/"
target="_blank"><img class="statcounter"
src="//c.statcounter.com/10897352/0/83042f57/1/"
alt="website statistics"></a></div></noscript>
<!-- End of StatCounter Code for Default Guide -->
