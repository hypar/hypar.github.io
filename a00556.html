<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.5"/>
<title>HyPar: src/PhysicalModels/ShallowWater1D/ShallowWater1DInitialize.c File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script><script src="http://cdn.mathjax.org/mathjax/latest/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="doxygen_html_style.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">HyPar
   &#160;<span id="projectnumber">1.0</span>
   </div>
   <div id="projectbrief">Finite-Difference Hyperbolic-Parabolic PDE Solver on Cartesian Grids</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.5 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Structures</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>Globals</span></a></li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('a00556.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Data Structures</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Namespaces</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(9)"><span class="SelectionMark">&#160;</span>Macros</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(10)"><span class="SelectionMark">&#160;</span>Pages</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">ShallowWater1DInitialize.c File Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>Initialize the 1D shallow water equations module.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &lt;stdio.h&gt;</code><br/>
<code>#include &lt;stdlib.h&gt;</code><br/>
<code>#include &lt;string.h&gt;</code><br/>
<code>#include &lt;<a class="el" href="a00231_source.html">basic.h</a>&gt;</code><br/>
<code>#include &lt;<a class="el" href="a00229_source.html">arrayfunctions.h</a>&gt;</code><br/>
<code>#include &lt;<a class="el" href="a00255_source.html">physicalmodels/shallowwater1d.h</a>&gt;</code><br/>
<code>#include &lt;<a class="el" href="a00248_source.html">mpivars.h</a>&gt;</code><br/>
<code>#include &lt;<a class="el" href="a00238_source.html">hypar.h</a>&gt;</code><br/>
</div>
<p><a href="a00556_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a7b3663fce862c5b4ae720697e1e60846"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00556.html#a7b3663fce862c5b4ae720697e1e60846">ShallowWater1DComputeCFL</a> (void *, void *, double, double)</td></tr>
<tr class="separator:a7b3663fce862c5b4ae720697e1e60846"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a210ddfbbff7f3fba24ad7f4041d19385"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00556.html#a210ddfbbff7f3fba24ad7f4041d19385">ShallowWater1DFlux</a> (double *, double *, int, void *, double)</td></tr>
<tr class="separator:a210ddfbbff7f3fba24ad7f4041d19385"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7d67bb3bf3ec360e81fd08640dd212fb"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00556.html#a7d67bb3bf3ec360e81fd08640dd212fb">ShallowWater1DSource</a> (double *, double *, void *, void *, double)</td></tr>
<tr class="separator:a7d67bb3bf3ec360e81fd08640dd212fb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a22643576d5e0c7799f56eb9409956d14"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00556.html#a22643576d5e0c7799f56eb9409956d14">ShallowWater1DUpwindRoe</a> (double *, double *, double *, double *, double *, double *, int, void *, double)</td></tr>
<tr class="separator:a22643576d5e0c7799f56eb9409956d14"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6a89017972d16c3f426ba64a70a39b60"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00556.html#a6a89017972d16c3f426ba64a70a39b60">ShallowWater1DUpwindLLF</a> (double *, double *, double *, double *, double *, double *, int, void *, double)</td></tr>
<tr class="separator:a6a89017972d16c3f426ba64a70a39b60"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a488d45759b0b962998e6df9e3c6061f6"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00556.html#a488d45759b0b962998e6df9e3c6061f6">ShallowWater1DJacobian</a> (double *, double *, void *, int, int, int)</td></tr>
<tr class="separator:a488d45759b0b962998e6df9e3c6061f6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5c2d4897fbfbf16e43f08d89c3688db6"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00556.html#a5c2d4897fbfbf16e43f08d89c3688db6">ShallowWater1DRoeAverage</a> (double *, double *, double *, void *)</td></tr>
<tr class="separator:a5c2d4897fbfbf16e43f08d89c3688db6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac7f0da5cc95a6d3e4f15e40ad86270e5"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00556.html#ac7f0da5cc95a6d3e4f15e40ad86270e5">ShallowWater1DLeftEigenvectors</a> (double *, double *, void *, int)</td></tr>
<tr class="separator:ac7f0da5cc95a6d3e4f15e40ad86270e5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aca4eced2ab6eaac693a487d7b8aae1ed"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00556.html#aca4eced2ab6eaac693a487d7b8aae1ed">ShallowWater1DRightEigenvectors</a> (double *, double *, void *, int)</td></tr>
<tr class="separator:aca4eced2ab6eaac693a487d7b8aae1ed"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a138e0a29442a4362e5542ab7eb8b0470"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00556.html#a138e0a29442a4362e5542ab7eb8b0470">ShallowWater1DTopography</a> (void *, void *, int, int, int *)</td></tr>
<tr class="separator:a138e0a29442a4362e5542ab7eb8b0470"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa3666c7f9bc8c5186fa29fa276d37f0d"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00556.html#aa3666c7f9bc8c5186fa29fa276d37f0d">ShallowWater1DSourceUpwindLLF</a> (double *, double *, double *, double *, int, void *, double)</td></tr>
<tr class="separator:aa3666c7f9bc8c5186fa29fa276d37f0d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1cc4010588279683914801de8595a306"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00556.html#a1cc4010588279683914801de8595a306">ShallowWater1DSourceUpwindRoe</a> (double *, double *, double *, double *, int, void *, double)</td></tr>
<tr class="separator:a1cc4010588279683914801de8595a306"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a17dd7e4115c7836a62018dbc5331d8c3"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00556.html#a17dd7e4115c7836a62018dbc5331d8c3">ShallowWater1DModifiedSolution</a> (double *, double *, int, void *, void *, double)</td></tr>
<tr class="separator:a17dd7e4115c7836a62018dbc5331d8c3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a247a345bc636847dd5f5770373a6f56f"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00556.html#a247a345bc636847dd5f5770373a6f56f">ShallowWater1DWriteTopography</a> (void *, void *)</td></tr>
<tr class="separator:a247a345bc636847dd5f5770373a6f56f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5f09926070a28319764e903b687681cc"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00556.html#a5f09926070a28319764e903b687681cc">ShallowWater1DInitialize</a> (void *s, void *m)</td></tr>
<tr class="separator:a5f09926070a28319764e903b687681cc"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Initialize the 1D shallow water equations module. </p>
<dl class="section author"><dt>Author</dt><dd>Debojyoti Ghosh </dd></dl>

<p>Definition in file <a class="el" href="a00556_source.html">ShallowWater1DInitialize.c</a>.</p>
</div><h2 class="groupheader">Function Documentation</h2>
<a class="anchor" id="a7b3663fce862c5b4ae720697e1e60846"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double ShallowWater1DComputeCFL </td>
          <td>(</td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>s</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>m</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>dt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>t</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Computes the maximum CFL number over the domain. Note that the CFL is computed over the local domain on this processor only. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">s</td><td>Solver object of type <a class="el" href="a00202.html" title="Structure containing all solver-specific variables and functions. ">HyPar</a> </td></tr>
    <tr><td class="paramname">m</td><td>MPI object of type <a class="el" href="a00205.html#a00663" title="Structure of MPI-related variables. ">MPIVariables</a> </td></tr>
    <tr><td class="paramname">dt</td><td>Time step size for which to compute the CFL </td></tr>
    <tr><td class="paramname">t</td><td>Time </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="a00552_source.html#l00017">17</a> of file <a class="el" href="a00552_source.html">ShallowWater1DComputeCFL.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;{</div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;  <a class="code" href="a00202.html">HyPar</a>           *solver = (<a class="code" href="a00202.html">HyPar</a>*)   s;</div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;  <a class="code" href="a00213.html">ShallowWater1D</a>  *param  = (<a class="code" href="a00213.html">ShallowWater1D</a>*) solver-&gt;<a class="code" href="a00202.html#a48e81a1806b5774943fd9a26e9a190f2">physics</a>;</div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;</div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;  <span class="keywordtype">int</span> *dim    = solver-&gt;<a class="code" href="a00202.html#a38e0371f331cecbe63a77fa03e202afe">dim_local</a>;</div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;  <span class="keywordtype">int</span> ghosts  = solver-&gt;<a class="code" href="a00202.html#aafc992b5fa79d5a4036024615d03bce6">ghosts</a>;</div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;  <span class="keywordtype">int</span> ndims   = solver-&gt;<a class="code" href="a00202.html#a484873c74138512e41bc50d17b7d955a">ndims</a>;</div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;  <span class="keywordtype">int</span> index[ndims];</div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;  <span class="keywordtype">double</span> *u   = solver-&gt;<a class="code" href="a00202.html#a3b6b999a764f1e2ea94bb5f28c7a558c">u</a>;</div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;</div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;  <span class="keywordtype">double</span> max_cfl = 0;</div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;  <span class="keywordtype">int</span> done = 0; <a class="code" href="a00229.html#a2b2826031c0cd92495ab351d3e599fc5">_ArraySetValue_</a>(index,ndims,0);</div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;  <span class="keywordflow">while</span> (!done) {</div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;    <span class="keywordtype">int</span> p; <a class="code" href="a00229.html#afbb862a2fdf5b72b1f9ace42f64b556f">_ArrayIndex1D_</a>(ndims,dim,index,ghosts,p);</div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;    <span class="keywordtype">double</span> h, v, c, dxinv, local_cfl;</div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;    <a class="code" href="a00255.html#ab6d0702f0bacbdb3f2644bd1f60938c0">_ShallowWater1DGetFlowVar_</a>((u+<a class="code" href="a00251.html#ad3395a55a5fde64d6603c7a82d7bf2c7">_MODEL_NVARS_</a>*p),h,v);</div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;    <a class="code" href="a00231.html#a9aa9bad8531d6733731a850ccc471a42">_GetCoordinate_</a>(0,index[0],dim,ghosts,solver-&gt;<a class="code" href="a00202.html#aa24a4f5e29bd70cbe5a2413be1ea9682">dxinv</a>,dxinv); <span class="comment">/* 1/dx */</span></div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;    c = sqrt(param-&gt;<a class="code" href="a00213.html#ab30c765b9be1b7776c97c899a12a66bb">g</a>*h); <span class="comment">/* speed of gravity waves */</span></div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;    local_cfl = (<a class="code" href="a00243.html#adf1be5ccbb7a2522b4f3a64043c72880">absolute</a>(v)+c)*dt*dxinv; <span class="comment">/* local cfl for this grid point */</span></div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;    <span class="keywordflow">if</span> (local_cfl &gt; max_cfl) max_cfl = local_cfl;</div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;    <a class="code" href="a00229.html#ac5ec1371623f11d03b0f42adaa24acbc">_ArrayIncrementIndex_</a>(ndims,dim,index,done);</div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;  }</div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;</div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;  <span class="keywordflow">return</span>(max_cfl);</div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;}</div>
<div class="ttc" id="a00229_html_a2b2826031c0cd92495ab351d3e599fc5"><div class="ttname"><a href="a00229.html#a2b2826031c0cd92495ab351d3e599fc5">_ArraySetValue_</a></div><div class="ttdeci">#define _ArraySetValue_(x, size, value)</div><div class="ttdef"><b>Definition:</b> <a href="a00229_source.html#l00169">arrayfunctions.h:169</a></div></div>
<div class="ttc" id="a00229_html_afbb862a2fdf5b72b1f9ace42f64b556f"><div class="ttname"><a href="a00229.html#afbb862a2fdf5b72b1f9ace42f64b556f">_ArrayIndex1D_</a></div><div class="ttdeci">#define _ArrayIndex1D_(N, imax, i, ghost, index)</div><div class="ttdef"><b>Definition:</b> <a href="a00229_source.html#l00040">arrayfunctions.h:40</a></div></div>
<div class="ttc" id="a00202_html_aa24a4f5e29bd70cbe5a2413be1ea9682"><div class="ttname"><a href="a00202.html#aa24a4f5e29bd70cbe5a2413be1ea9682">HyPar::dxinv</a></div><div class="ttdeci">double * dxinv</div><div class="ttdef"><b>Definition:</b> <a href="a00238_source.html#l00110">hypar.h:110</a></div></div>
<div class="ttc" id="a00213_html_ab30c765b9be1b7776c97c899a12a66bb"><div class="ttname"><a href="a00213.html#ab30c765b9be1b7776c97c899a12a66bb">ShallowWater1D::g</a></div><div class="ttdeci">double g</div><div class="ttdef"><b>Definition:</b> <a href="a00255_source.html#l00138">shallowwater1d.h:138</a></div></div>
<div class="ttc" id="a00202_html_a48e81a1806b5774943fd9a26e9a190f2"><div class="ttname"><a href="a00202.html#a48e81a1806b5774943fd9a26e9a190f2">HyPar::physics</a></div><div class="ttdeci">void * physics</div><div class="ttdef"><b>Definition:</b> <a href="a00238_source.html#l00261">hypar.h:261</a></div></div>
<div class="ttc" id="a00251_html_ad3395a55a5fde64d6603c7a82d7bf2c7"><div class="ttname"><a href="a00251.html#ad3395a55a5fde64d6603c7a82d7bf2c7">_MODEL_NVARS_</a></div><div class="ttdeci">#define _MODEL_NVARS_</div><div class="ttdef"><b>Definition:</b> <a href="a00251_source.html#l00058">euler1d.h:58</a></div></div>
<div class="ttc" id="a00202_html_a484873c74138512e41bc50d17b7d955a"><div class="ttname"><a href="a00202.html#a484873c74138512e41bc50d17b7d955a">HyPar::ndims</a></div><div class="ttdeci">int ndims</div><div class="ttdef"><b>Definition:</b> <a href="a00238_source.html#l00026">hypar.h:26</a></div></div>
<div class="ttc" id="a00202_html_a38e0371f331cecbe63a77fa03e202afe"><div class="ttname"><a href="a00202.html#a38e0371f331cecbe63a77fa03e202afe">HyPar::dim_local</a></div><div class="ttdeci">int * dim_local</div><div class="ttdef"><b>Definition:</b> <a href="a00238_source.html#l00037">hypar.h:37</a></div></div>
<div class="ttc" id="a00202_html_aafc992b5fa79d5a4036024615d03bce6"><div class="ttname"><a href="a00202.html#aafc992b5fa79d5a4036024615d03bce6">HyPar::ghosts</a></div><div class="ttdeci">int ghosts</div><div class="ttdef"><b>Definition:</b> <a href="a00238_source.html#l00052">hypar.h:52</a></div></div>
<div class="ttc" id="a00231_html_a9aa9bad8531d6733731a850ccc471a42"><div class="ttname"><a href="a00231.html#a9aa9bad8531d6733731a850ccc471a42">_GetCoordinate_</a></div><div class="ttdeci">#define _GetCoordinate_(dir, i, dim, ghosts, x, coord)</div><div class="ttdef"><b>Definition:</b> <a href="a00231_source.html#l00031">basic.h:31</a></div></div>
<div class="ttc" id="a00202_html_a3b6b999a764f1e2ea94bb5f28c7a558c"><div class="ttname"><a href="a00202.html#a3b6b999a764f1e2ea94bb5f28c7a558c">HyPar::u</a></div><div class="ttdeci">double * u</div><div class="ttdef"><b>Definition:</b> <a href="a00238_source.html#l00116">hypar.h:116</a></div></div>
<div class="ttc" id="a00213_html"><div class="ttname"><a href="a00213.html">ShallowWater1D</a></div><div class="ttdoc">Structure containing variables and parameters specific to the 1D Shallow Water equations. This structure contains the physical parameters, variables, and function pointers specific to the 1D ShallowWater equations. </div><div class="ttdef"><b>Definition:</b> <a href="a00255_source.html#l00137">shallowwater1d.h:137</a></div></div>
<div class="ttc" id="a00229_html_ac5ec1371623f11d03b0f42adaa24acbc"><div class="ttname"><a href="a00229.html#ac5ec1371623f11d03b0f42adaa24acbc">_ArrayIncrementIndex_</a></div><div class="ttdeci">#define _ArrayIncrementIndex_(N, imax, i, done)</div><div class="ttdef"><b>Definition:</b> <a href="a00229_source.html#l00126">arrayfunctions.h:126</a></div></div>
<div class="ttc" id="a00255_html_ab6d0702f0bacbdb3f2644bd1f60938c0"><div class="ttname"><a href="a00255.html#ab6d0702f0bacbdb3f2644bd1f60938c0">_ShallowWater1DGetFlowVar_</a></div><div class="ttdeci">#define _ShallowWater1DGetFlowVar_(u, h, v)</div><div class="ttdef"><b>Definition:</b> <a href="a00255_source.html#l00054">shallowwater1d.h:54</a></div></div>
<div class="ttc" id="a00202_html"><div class="ttname"><a href="a00202.html">HyPar</a></div><div class="ttdoc">Structure containing all solver-specific variables and functions. </div><div class="ttdef"><b>Definition:</b> <a href="a00238_source.html#l00023">hypar.h:23</a></div></div>
<div class="ttc" id="a00243_html_adf1be5ccbb7a2522b4f3a64043c72880"><div class="ttname"><a href="a00243.html#adf1be5ccbb7a2522b4f3a64043c72880">absolute</a></div><div class="ttdeci">#define absolute(a)</div><div class="ttdef"><b>Definition:</b> <a href="a00243_source.html#l00032">math_ops.h:32</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a210ddfbbff7f3fba24ad7f4041d19385"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ShallowWater1DFlux </td>
          <td>(</td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>f</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>u</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>dir</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>s</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>t</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Compute the hyperbolic flux over the local domain.<br/>
 </p>
<p class="formulaDsp">
\begin{equation} {\bf F}\left({\bf u}\right) = \left[\begin{array}{c} hu \\ hu^2 + \frac{1}{2} gh^2 \end{array}\right] \end{equation}
</p>
 <dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">f</td><td>Array to hold the computed flux (same size and layout as u) </td></tr>
    <tr><td class="paramname">u</td><td>Array containing the conserved solution </td></tr>
    <tr><td class="paramname">dir</td><td>Spatial dimension (unused since this is a 1D system) </td></tr>
    <tr><td class="paramname">s</td><td>Solver object of type <a class="el" href="a00202.html" title="Structure containing all solver-specific variables and functions. ">HyPar</a> </td></tr>
    <tr><td class="paramname">t</td><td>Current time </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="a00554_source.html#l00016">16</a> of file <a class="el" href="a00554_source.html">ShallowWater1DFlux.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;{</div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;  <a class="code" href="a00202.html">HyPar</a>             *solver = (<a class="code" href="a00202.html">HyPar</a>*)   s;</div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;  <a class="code" href="a00213.html">ShallowWater1D</a>    *param  = (<a class="code" href="a00213.html">ShallowWater1D</a>*) solver-&gt;<a class="code" href="a00202.html#a48e81a1806b5774943fd9a26e9a190f2">physics</a>;</div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;  <span class="keywordtype">int</span>               *dim    = solver-&gt;<a class="code" href="a00202.html#a38e0371f331cecbe63a77fa03e202afe">dim_local</a>;</div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;  <span class="keywordtype">int</span>               ghosts  = solver-&gt;<a class="code" href="a00202.html#aafc992b5fa79d5a4036024615d03bce6">ghosts</a>;</div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;  <span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">int</span>  ndims   = <a class="code" href="a00251.html#a57771c952ec174601addf43e1c0202b2">_MODEL_NDIMS_</a>;</div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;  <span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">int</span>  nvars   = <a class="code" href="a00251.html#ad3395a55a5fde64d6603c7a82d7bf2c7">_MODEL_NVARS_</a>;</div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;  <span class="keyword">static</span> <span class="keywordtype">int</span>        index[<a class="code" href="a00251.html#a57771c952ec174601addf43e1c0202b2">_MODEL_NDIMS_</a>], bounds[_MODEL_NDIMS_], offset[_MODEL_NDIMS_];</div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;</div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;  <span class="comment">/* set bounds for array index to include ghost points */</span></div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;  <a class="code" href="a00229.html#a197e4f9ce0b056b3f3addbbd9887f703">_ArrayAddCopy1D_</a>(dim,(2*ghosts),bounds,ndims);</div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;  <span class="comment">/* set offset such that index is compatible with ghost point arrangement */</span></div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;  <a class="code" href="a00229.html#a2b2826031c0cd92495ab351d3e599fc5">_ArraySetValue_</a>(offset,ndims,-ghosts);</div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;</div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;  <span class="keywordtype">int</span> done = 0; <a class="code" href="a00229.html#a2b2826031c0cd92495ab351d3e599fc5">_ArraySetValue_</a>(index,ndims,0);</div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;  <span class="keywordflow">while</span> (!done) {</div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;    <span class="keywordtype">int</span> p; <a class="code" href="a00229.html#a0739cb538f4d301fad3b45059ddd0738">_ArrayIndex1DWO_</a>(ndims,dim,index,offset,ghosts,p);</div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;    <span class="keywordtype">double</span> h, v;</div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;    <a class="code" href="a00255.html#ab6d0702f0bacbdb3f2644bd1f60938c0">_ShallowWater1DGetFlowVar_</a>((u+nvars*p),h,v);</div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;    <a class="code" href="a00255.html#adfdf0d9f6cf0e17a83afbfbe6e3013fc">_ShallowWater1DSetFlux_</a>((f+nvars*p),h,v,param-&gt;<a class="code" href="a00213.html#ab30c765b9be1b7776c97c899a12a66bb">g</a>);</div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;    <a class="code" href="a00229.html#ac5ec1371623f11d03b0f42adaa24acbc">_ArrayIncrementIndex_</a>(ndims,bounds,index,done);</div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;  }</div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;</div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;  <span class="keywordflow">return</span>(0);</div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;}</div>
<div class="ttc" id="a00229_html_a2b2826031c0cd92495ab351d3e599fc5"><div class="ttname"><a href="a00229.html#a2b2826031c0cd92495ab351d3e599fc5">_ArraySetValue_</a></div><div class="ttdeci">#define _ArraySetValue_(x, size, value)</div><div class="ttdef"><b>Definition:</b> <a href="a00229_source.html#l00169">arrayfunctions.h:169</a></div></div>
<div class="ttc" id="a00251_html_a57771c952ec174601addf43e1c0202b2"><div class="ttname"><a href="a00251.html#a57771c952ec174601addf43e1c0202b2">_MODEL_NDIMS_</a></div><div class="ttdeci">#define _MODEL_NDIMS_</div><div class="ttdef"><b>Definition:</b> <a href="a00251_source.html#l00056">euler1d.h:56</a></div></div>
<div class="ttc" id="a00213_html_ab30c765b9be1b7776c97c899a12a66bb"><div class="ttname"><a href="a00213.html#ab30c765b9be1b7776c97c899a12a66bb">ShallowWater1D::g</a></div><div class="ttdeci">double g</div><div class="ttdef"><b>Definition:</b> <a href="a00255_source.html#l00138">shallowwater1d.h:138</a></div></div>
<div class="ttc" id="a00202_html_a48e81a1806b5774943fd9a26e9a190f2"><div class="ttname"><a href="a00202.html#a48e81a1806b5774943fd9a26e9a190f2">HyPar::physics</a></div><div class="ttdeci">void * physics</div><div class="ttdef"><b>Definition:</b> <a href="a00238_source.html#l00261">hypar.h:261</a></div></div>
<div class="ttc" id="a00251_html_ad3395a55a5fde64d6603c7a82d7bf2c7"><div class="ttname"><a href="a00251.html#ad3395a55a5fde64d6603c7a82d7bf2c7">_MODEL_NVARS_</a></div><div class="ttdeci">#define _MODEL_NVARS_</div><div class="ttdef"><b>Definition:</b> <a href="a00251_source.html#l00058">euler1d.h:58</a></div></div>
<div class="ttc" id="a00202_html_a38e0371f331cecbe63a77fa03e202afe"><div class="ttname"><a href="a00202.html#a38e0371f331cecbe63a77fa03e202afe">HyPar::dim_local</a></div><div class="ttdeci">int * dim_local</div><div class="ttdef"><b>Definition:</b> <a href="a00238_source.html#l00037">hypar.h:37</a></div></div>
<div class="ttc" id="a00229_html_a197e4f9ce0b056b3f3addbbd9887f703"><div class="ttname"><a href="a00229.html#a197e4f9ce0b056b3f3addbbd9887f703">_ArrayAddCopy1D_</a></div><div class="ttdeci">#define _ArrayAddCopy1D_(x, a, y, size)</div><div class="ttdef"><b>Definition:</b> <a href="a00229_source.html#l00368">arrayfunctions.h:368</a></div></div>
<div class="ttc" id="a00202_html_aafc992b5fa79d5a4036024615d03bce6"><div class="ttname"><a href="a00202.html#aafc992b5fa79d5a4036024615d03bce6">HyPar::ghosts</a></div><div class="ttdeci">int ghosts</div><div class="ttdef"><b>Definition:</b> <a href="a00238_source.html#l00052">hypar.h:52</a></div></div>
<div class="ttc" id="a00213_html"><div class="ttname"><a href="a00213.html">ShallowWater1D</a></div><div class="ttdoc">Structure containing variables and parameters specific to the 1D Shallow Water equations. This structure contains the physical parameters, variables, and function pointers specific to the 1D ShallowWater equations. </div><div class="ttdef"><b>Definition:</b> <a href="a00255_source.html#l00137">shallowwater1d.h:137</a></div></div>
<div class="ttc" id="a00229_html_a0739cb538f4d301fad3b45059ddd0738"><div class="ttname"><a href="a00229.html#a0739cb538f4d301fad3b45059ddd0738">_ArrayIndex1DWO_</a></div><div class="ttdeci">#define _ArrayIndex1DWO_(N, imax, i, offset, ghost, index)</div><div class="ttdef"><b>Definition:</b> <a href="a00229_source.html#l00083">arrayfunctions.h:83</a></div></div>
<div class="ttc" id="a00255_html_adfdf0d9f6cf0e17a83afbfbe6e3013fc"><div class="ttname"><a href="a00255.html#adfdf0d9f6cf0e17a83afbfbe6e3013fc">_ShallowWater1DSetFlux_</a></div><div class="ttdeci">#define _ShallowWater1DSetFlux_(f, h, v, g)</div><div class="ttdef"><b>Definition:</b> <a href="a00255_source.html#l00064">shallowwater1d.h:64</a></div></div>
<div class="ttc" id="a00229_html_ac5ec1371623f11d03b0f42adaa24acbc"><div class="ttname"><a href="a00229.html#ac5ec1371623f11d03b0f42adaa24acbc">_ArrayIncrementIndex_</a></div><div class="ttdeci">#define _ArrayIncrementIndex_(N, imax, i, done)</div><div class="ttdef"><b>Definition:</b> <a href="a00229_source.html#l00126">arrayfunctions.h:126</a></div></div>
<div class="ttc" id="a00255_html_ab6d0702f0bacbdb3f2644bd1f60938c0"><div class="ttname"><a href="a00255.html#ab6d0702f0bacbdb3f2644bd1f60938c0">_ShallowWater1DGetFlowVar_</a></div><div class="ttdeci">#define _ShallowWater1DGetFlowVar_(u, h, v)</div><div class="ttdef"><b>Definition:</b> <a href="a00255_source.html#l00054">shallowwater1d.h:54</a></div></div>
<div class="ttc" id="a00202_html"><div class="ttname"><a href="a00202.html">HyPar</a></div><div class="ttdoc">Structure containing all solver-specific variables and functions. </div><div class="ttdef"><b>Definition:</b> <a href="a00238_source.html#l00023">hypar.h:23</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a7d67bb3bf3ec360e81fd08640dd212fb"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ShallowWater1DSource </td>
          <td>(</td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>source</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>u</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>s</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>m</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>t</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Compute the source terms for the 1D shallow water equations. The source term is computed according to the balanced formulation introduced in the reference below. The source term is reformulated and "discretized" in a similar fashion as the hyperbolic flux to ensure that the hydrostatic balance is maintained to machine precision.</p>
<ul>
<li>Xing, Y., Shu, C.-W., "High order finite difference WENO schemes with the
  exact conservation property for the shallow water equations", Journal of Computational Physics, 208, 2005, pp. 206-227. <a href="http://dx.doi.org/10.1016/j.jcp.2005.02.006">http://dx.doi.org/10.1016/j.jcp.2005.02.006</a> </li>
</ul>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">source</td><td>Computed source terms (array size &amp; layout same as u) </td></tr>
    <tr><td class="paramname">u</td><td>Solution (conserved variables) </td></tr>
    <tr><td class="paramname">s</td><td>Solver object of type <a class="el" href="a00202.html" title="Structure containing all solver-specific variables and functions. ">HyPar</a> </td></tr>
    <tr><td class="paramname">m</td><td>MPI object of type <a class="el" href="a00205.html#a00663" title="Structure of MPI-related variables. ">MPIVariables</a> </td></tr>
    <tr><td class="paramname">t</td><td>Current solution time </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="a00559_source.html#l00025">25</a> of file <a class="el" href="a00559_source.html">ShallowWater1DSource.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;{</div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;  <a class="code" href="a00202.html">HyPar</a>          *solver = (<a class="code" href="a00202.html">HyPar</a>* ) s;</div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;  <a class="code" href="a00205.html#a00663">MPIVariables</a>   *mpi = (<a class="code" href="a00205.html#a00663">MPIVariables</a>*) m;</div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;  <a class="code" href="a00213.html">ShallowWater1D</a> *param  = (<a class="code" href="a00213.html">ShallowWater1D</a>*) solver-&gt;<a class="code" href="a00202.html#a48e81a1806b5774943fd9a26e9a190f2">physics</a>;</div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;</div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;  <span class="keywordtype">int</span>     v, done, p, p1, p2;</div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;  <span class="keywordtype">double</span>  *SourceI = solver-&gt;<a class="code" href="a00202.html#a983929b7b1511ff3e7800597adef6a91">fluxI</a>; <span class="comment">/* interace source term       */</span></div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;  <span class="keywordtype">double</span>  *SourceC = solver-&gt;<a class="code" href="a00202.html#aee7ff3b51db01ee6ed4038ff5311ed24">fluxC</a>; <span class="comment">/* cell-centered source term  */</span></div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;  <span class="keywordtype">double</span>  *SourceL = solver-&gt;<a class="code" href="a00202.html#a99f72a44e29089b75fd11155bfcc1ff8">fL</a>;</div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;  <span class="keywordtype">double</span>  *SourceR = solver-&gt;<a class="code" href="a00202.html#abb50b7a404febaf647f7bd89f873b96e">fR</a>;</div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;</div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;  <span class="keywordtype">int</span>     ndims   = solver-&gt;<a class="code" href="a00202.html#a484873c74138512e41bc50d17b7d955a">ndims</a>;</div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;  <span class="keywordtype">int</span>     ghosts  = solver-&gt;<a class="code" href="a00202.html#aafc992b5fa79d5a4036024615d03bce6">ghosts</a>;</div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;  <span class="keywordtype">int</span>     *dim    = solver-&gt;<a class="code" href="a00202.html#a38e0371f331cecbe63a77fa03e202afe">dim_local</a>;</div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;  <span class="keywordtype">double</span>  *x      = solver-&gt;<a class="code" href="a00202.html#a711aad4cbe735871dd9e91ab575c878b">x</a>;</div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;  <span class="keywordtype">double</span>  *dxinv  = solver-&gt;<a class="code" href="a00202.html#aa24a4f5e29bd70cbe5a2413be1ea9682">dxinv</a>;</div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;  <span class="keywordtype">int</span>     index[ndims],index1[ndims],index2[ndims],dim_interface[ndims];</div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;</div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;  <span class="comment">/* set interface dimensions */</span></div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;  <a class="code" href="a00229.html#a89e8330d9e06dd0666c50833628a125c">_ArrayCopy1D_</a>(dim,dim_interface,ndims); dim_interface[<a class="code" href="a00251.html#a6a44057228e5f4b86e1c4d04b2a28977">_XDIR_</a>]++;</div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;  </div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;  <span class="comment">/* calculate the first source function */</span></div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;  <a class="code" href="a00231.html#ad6ab74942c9de13cf0b4c12eb0d91780">IERR</a> <a class="code" href="a00559.html#a784d099e1efac1033289d50478b47ccd">ShallowWater1DSourceFunction1</a>(SourceC,u,x,solver,mpi,t); <a class="code" href="a00231.html#add9cf96ae374934d245a1dc1ab697a42">CHECKERR</a>(ierr);</div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;  <span class="comment">/* calculate the left and right interface source terms */</span></div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;  <a class="code" href="a00231.html#ad6ab74942c9de13cf0b4c12eb0d91780">IERR</a> solver-&gt;<a class="code" href="a00202.html#a17e1cfc7de4fe33c6ee88f2cc42883e7">InterpolateInterfacesHyp</a>(SourceL,SourceC,u,x, 1,<a class="code" href="a00251.html#a6a44057228e5f4b86e1c4d04b2a28977">_XDIR_</a>,solver,mpi,0); <a class="code" href="a00231.html#add9cf96ae374934d245a1dc1ab697a42">CHECKERR</a>(ierr);</div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;  <a class="code" href="a00231.html#ad6ab74942c9de13cf0b4c12eb0d91780">IERR</a> solver-&gt;<a class="code" href="a00202.html#a17e1cfc7de4fe33c6ee88f2cc42883e7">InterpolateInterfacesHyp</a>(SourceR,SourceC,u,x,-1,<a class="code" href="a00251.html#a6a44057228e5f4b86e1c4d04b2a28977">_XDIR_</a>,solver,mpi,0); <a class="code" href="a00231.html#add9cf96ae374934d245a1dc1ab697a42">CHECKERR</a>(ierr);</div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;  <span class="comment">/* calculate the final interface source term */</span></div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;  <a class="code" href="a00231.html#ad6ab74942c9de13cf0b4c12eb0d91780">IERR</a> param-&gt;<a class="code" href="a00213.html#a3cb843ad67e4b14387b7fa21f6d4090b">SourceUpwind</a>(SourceI,SourceL,SourceR,u,<a class="code" href="a00251.html#a6a44057228e5f4b86e1c4d04b2a28977">_XDIR_</a>,solver,t);</div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;  <span class="comment">/* calculate the final cell-centered source term */</span></div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;  done = 0; <a class="code" href="a00229.html#a2b2826031c0cd92495ab351d3e599fc5">_ArraySetValue_</a>(index,ndims,0);</div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;  <span class="keywordflow">while</span> (!done) {</div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;    <a class="code" href="a00229.html#a89e8330d9e06dd0666c50833628a125c">_ArrayCopy1D_</a>(index,index1,ndims);</div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;    <a class="code" href="a00229.html#a89e8330d9e06dd0666c50833628a125c">_ArrayCopy1D_</a>(index,index2,ndims); index2[<a class="code" href="a00251.html#a6a44057228e5f4b86e1c4d04b2a28977">_XDIR_</a>]++;</div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;    <a class="code" href="a00229.html#afbb862a2fdf5b72b1f9ace42f64b556f">_ArrayIndex1D_</a>(ndims,dim          ,index ,ghosts,p );</div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;    <a class="code" href="a00229.html#afbb862a2fdf5b72b1f9ace42f64b556f">_ArrayIndex1D_</a>(ndims,dim_interface,index1,0     ,p1);</div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;    <a class="code" href="a00229.html#afbb862a2fdf5b72b1f9ace42f64b556f">_ArrayIndex1D_</a>(ndims,dim_interface,index2,0     ,p2);</div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;    <span class="keywordtype">double</span> dx_inverse;   <a class="code" href="a00231.html#a9aa9bad8531d6733731a850ccc471a42">_GetCoordinate_</a>(<a class="code" href="a00251.html#a6a44057228e5f4b86e1c4d04b2a28977">_XDIR_</a>,index[<a class="code" href="a00251.html#a6a44057228e5f4b86e1c4d04b2a28977">_XDIR_</a>],dim,ghosts,dxinv,dx_inverse);</div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;    <span class="keywordflow">for</span> (v=0; v&lt;<a class="code" href="a00251.html#ad3395a55a5fde64d6603c7a82d7bf2c7">_MODEL_NVARS_</a>; v++)</div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;      source[_MODEL_NVARS_*p+v] += (SourceI[_MODEL_NVARS_*p2+v]-SourceI[_MODEL_NVARS_*p1+v])*dx_inverse;</div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;    <a class="code" href="a00229.html#ac5ec1371623f11d03b0f42adaa24acbc">_ArrayIncrementIndex_</a>(ndims,dim,index,done);</div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;  }</div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;</div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;  <span class="comment">/* calculate the second source function */</span></div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;  <a class="code" href="a00231.html#ad6ab74942c9de13cf0b4c12eb0d91780">IERR</a> <a class="code" href="a00559.html#a6734df3ba5f1473c2bbaf2b9fb4df174">ShallowWater1DSourceFunction2</a>(SourceC,u,x,solver,mpi,t); <a class="code" href="a00231.html#add9cf96ae374934d245a1dc1ab697a42">CHECKERR</a>(ierr);</div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;  <span class="comment">/* calculate the left and right interface source terms */</span></div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;  <a class="code" href="a00231.html#ad6ab74942c9de13cf0b4c12eb0d91780">IERR</a> solver-&gt;<a class="code" href="a00202.html#a17e1cfc7de4fe33c6ee88f2cc42883e7">InterpolateInterfacesHyp</a>(SourceL,SourceC,u,x, 1,<a class="code" href="a00251.html#a6a44057228e5f4b86e1c4d04b2a28977">_XDIR_</a>,solver,mpi,0); <a class="code" href="a00231.html#add9cf96ae374934d245a1dc1ab697a42">CHECKERR</a>(ierr);</div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;  <a class="code" href="a00231.html#ad6ab74942c9de13cf0b4c12eb0d91780">IERR</a> solver-&gt;<a class="code" href="a00202.html#a17e1cfc7de4fe33c6ee88f2cc42883e7">InterpolateInterfacesHyp</a>(SourceR,SourceC,u,x,-1,<a class="code" href="a00251.html#a6a44057228e5f4b86e1c4d04b2a28977">_XDIR_</a>,solver,mpi,0); <a class="code" href="a00231.html#add9cf96ae374934d245a1dc1ab697a42">CHECKERR</a>(ierr);</div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;  <span class="comment">/* calculate the final interface source term */</span></div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;  <a class="code" href="a00231.html#ad6ab74942c9de13cf0b4c12eb0d91780">IERR</a> param-&gt;<a class="code" href="a00213.html#a3cb843ad67e4b14387b7fa21f6d4090b">SourceUpwind</a>(SourceI,SourceL,SourceR,u,<a class="code" href="a00251.html#a6a44057228e5f4b86e1c4d04b2a28977">_XDIR_</a>,solver,t);</div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;  <span class="comment">/* calculate the final cell-centered source term */</span></div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;  done = 0; <a class="code" href="a00229.html#a2b2826031c0cd92495ab351d3e599fc5">_ArraySetValue_</a>(index,ndims,0);</div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;  <span class="keywordflow">while</span> (!done) {</div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;    <a class="code" href="a00229.html#a89e8330d9e06dd0666c50833628a125c">_ArrayCopy1D_</a>(index,index1,ndims);</div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;    <a class="code" href="a00229.html#a89e8330d9e06dd0666c50833628a125c">_ArrayCopy1D_</a>(index,index2,ndims); index2[<a class="code" href="a00251.html#a6a44057228e5f4b86e1c4d04b2a28977">_XDIR_</a>]++;</div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;    <a class="code" href="a00229.html#afbb862a2fdf5b72b1f9ace42f64b556f">_ArrayIndex1D_</a>(ndims,dim          ,index ,ghosts,p );</div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;    <a class="code" href="a00229.html#afbb862a2fdf5b72b1f9ace42f64b556f">_ArrayIndex1D_</a>(ndims,dim_interface,index1,0     ,p1);</div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;    <a class="code" href="a00229.html#afbb862a2fdf5b72b1f9ace42f64b556f">_ArrayIndex1D_</a>(ndims,dim_interface,index2,0     ,p2);</div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;    <span class="keywordtype">double</span> dx_inverse;  <a class="code" href="a00231.html#a9aa9bad8531d6733731a850ccc471a42">_GetCoordinate_</a>(<a class="code" href="a00251.html#a6a44057228e5f4b86e1c4d04b2a28977">_XDIR_</a>,index[<a class="code" href="a00251.html#a6a44057228e5f4b86e1c4d04b2a28977">_XDIR_</a>],dim,ghosts,dxinv,dx_inverse);</div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;    <span class="keywordtype">double</span> h, vel;      <a class="code" href="a00255.html#ab6d0702f0bacbdb3f2644bd1f60938c0">_ShallowWater1DGetFlowVar_</a>((u+_MODEL_NVARS_*p),h,vel);</div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;    <span class="keywordtype">double</span> term[<a class="code" href="a00251.html#ad3395a55a5fde64d6603c7a82d7bf2c7">_MODEL_NVARS_</a>] = { 0.0, -param-&gt;<a class="code" href="a00213.html#ab30c765b9be1b7776c97c899a12a66bb">g</a> * (h + param-&gt;<a class="code" href="a00213.html#a3374c235742374318e70b42a6aa09a82">b</a>[p]) };</div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;    <span class="keywordflow">for</span> (v=0; v&lt;<a class="code" href="a00251.html#ad3395a55a5fde64d6603c7a82d7bf2c7">_MODEL_NVARS_</a>; v++) {</div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;      source[_MODEL_NVARS_*p+v] += term[v]*(SourceI[_MODEL_NVARS_*p2+v]-SourceI[_MODEL_NVARS_*p1+v])*dx_inverse;</div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;    }</div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;    vel = h; <span class="comment">/* useless statement to avoid compiler warning */</span></div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;    <a class="code" href="a00229.html#ac5ec1371623f11d03b0f42adaa24acbc">_ArrayIncrementIndex_</a>(ndims,dim,index,done);</div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;  }</div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;</div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;  <span class="keywordflow">return</span>(0);</div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;}</div>
<div class="ttc" id="a00202_html_abb50b7a404febaf647f7bd89f873b96e"><div class="ttname"><a href="a00202.html#abb50b7a404febaf647f7bd89f873b96e">HyPar::fR</a></div><div class="ttdeci">double * fR</div><div class="ttdef"><b>Definition:</b> <a href="a00238_source.html#l00139">hypar.h:139</a></div></div>
<div class="ttc" id="a00229_html_a2b2826031c0cd92495ab351d3e599fc5"><div class="ttname"><a href="a00229.html#a2b2826031c0cd92495ab351d3e599fc5">_ArraySetValue_</a></div><div class="ttdeci">#define _ArraySetValue_(x, size, value)</div><div class="ttdef"><b>Definition:</b> <a href="a00229_source.html#l00169">arrayfunctions.h:169</a></div></div>
<div class="ttc" id="a00213_html_a3cb843ad67e4b14387b7fa21f6d4090b"><div class="ttname"><a href="a00213.html#a3cb843ad67e4b14387b7fa21f6d4090b">ShallowWater1D::SourceUpwind</a></div><div class="ttdeci">int(* SourceUpwind)(double *, double *, double *, double *, int, void *, double)</div><div class="ttdef"><b>Definition:</b> <a href="a00255_source.html#l00150">shallowwater1d.h:150</a></div></div>
<div class="ttc" id="a00229_html_afbb862a2fdf5b72b1f9ace42f64b556f"><div class="ttname"><a href="a00229.html#afbb862a2fdf5b72b1f9ace42f64b556f">_ArrayIndex1D_</a></div><div class="ttdeci">#define _ArrayIndex1D_(N, imax, i, ghost, index)</div><div class="ttdef"><b>Definition:</b> <a href="a00229_source.html#l00040">arrayfunctions.h:40</a></div></div>
<div class="ttc" id="a00559_html_a6734df3ba5f1473c2bbaf2b9fb4df174"><div class="ttname"><a href="a00559.html#a6734df3ba5f1473c2bbaf2b9fb4df174">ShallowWater1DSourceFunction2</a></div><div class="ttdeci">static int ShallowWater1DSourceFunction2(double *, double *, double *, void *, void *, double)</div><div class="ttdef"><b>Definition:</b> <a href="a00559_source.html#l00155">ShallowWater1DSource.c:155</a></div></div>
<div class="ttc" id="a00202_html_aa24a4f5e29bd70cbe5a2413be1ea9682"><div class="ttname"><a href="a00202.html#aa24a4f5e29bd70cbe5a2413be1ea9682">HyPar::dxinv</a></div><div class="ttdeci">double * dxinv</div><div class="ttdef"><b>Definition:</b> <a href="a00238_source.html#l00110">hypar.h:110</a></div></div>
<div class="ttc" id="a00229_html_a89e8330d9e06dd0666c50833628a125c"><div class="ttname"><a href="a00229.html#a89e8330d9e06dd0666c50833628a125c">_ArrayCopy1D_</a></div><div class="ttdeci">#define _ArrayCopy1D_(x, y, size)</div><div class="ttdef"><b>Definition:</b> <a href="a00229_source.html#l00319">arrayfunctions.h:319</a></div></div>
<div class="ttc" id="a00213_html_ab30c765b9be1b7776c97c899a12a66bb"><div class="ttname"><a href="a00213.html#ab30c765b9be1b7776c97c899a12a66bb">ShallowWater1D::g</a></div><div class="ttdeci">double g</div><div class="ttdef"><b>Definition:</b> <a href="a00255_source.html#l00138">shallowwater1d.h:138</a></div></div>
<div class="ttc" id="a00202_html_a48e81a1806b5774943fd9a26e9a190f2"><div class="ttname"><a href="a00202.html#a48e81a1806b5774943fd9a26e9a190f2">HyPar::physics</a></div><div class="ttdeci">void * physics</div><div class="ttdef"><b>Definition:</b> <a href="a00238_source.html#l00261">hypar.h:261</a></div></div>
<div class="ttc" id="a00251_html_ad3395a55a5fde64d6603c7a82d7bf2c7"><div class="ttname"><a href="a00251.html#ad3395a55a5fde64d6603c7a82d7bf2c7">_MODEL_NVARS_</a></div><div class="ttdeci">#define _MODEL_NVARS_</div><div class="ttdef"><b>Definition:</b> <a href="a00251_source.html#l00058">euler1d.h:58</a></div></div>
<div class="ttc" id="a00202_html_a711aad4cbe735871dd9e91ab575c878b"><div class="ttname"><a href="a00202.html#a711aad4cbe735871dd9e91ab575c878b">HyPar::x</a></div><div class="ttdeci">double * x</div><div class="ttdef"><b>Definition:</b> <a href="a00238_source.html#l00107">hypar.h:107</a></div></div>
<div class="ttc" id="a00202_html_a484873c74138512e41bc50d17b7d955a"><div class="ttname"><a href="a00202.html#a484873c74138512e41bc50d17b7d955a">HyPar::ndims</a></div><div class="ttdeci">int ndims</div><div class="ttdef"><b>Definition:</b> <a href="a00238_source.html#l00026">hypar.h:26</a></div></div>
<div class="ttc" id="a00231_html_ad6ab74942c9de13cf0b4c12eb0d91780"><div class="ttname"><a href="a00231.html#ad6ab74942c9de13cf0b4c12eb0d91780">IERR</a></div><div class="ttdeci">#define IERR</div><div class="ttdef"><b>Definition:</b> <a href="a00231_source.html#l00016">basic.h:16</a></div></div>
<div class="ttc" id="a00251_html_a6a44057228e5f4b86e1c4d04b2a28977"><div class="ttname"><a href="a00251.html#a6a44057228e5f4b86e1c4d04b2a28977">_XDIR_</a></div><div class="ttdeci">#define _XDIR_</div><div class="ttdef"><b>Definition:</b> <a href="a00251_source.html#l00075">euler1d.h:75</a></div></div>
<div class="ttc" id="a00202_html_a38e0371f331cecbe63a77fa03e202afe"><div class="ttname"><a href="a00202.html#a38e0371f331cecbe63a77fa03e202afe">HyPar::dim_local</a></div><div class="ttdeci">int * dim_local</div><div class="ttdef"><b>Definition:</b> <a href="a00238_source.html#l00037">hypar.h:37</a></div></div>
<div class="ttc" id="a00202_html_aafc992b5fa79d5a4036024615d03bce6"><div class="ttname"><a href="a00202.html#aafc992b5fa79d5a4036024615d03bce6">HyPar::ghosts</a></div><div class="ttdeci">int ghosts</div><div class="ttdef"><b>Definition:</b> <a href="a00238_source.html#l00052">hypar.h:52</a></div></div>
<div class="ttc" id="a00559_html_a784d099e1efac1033289d50478b47ccd"><div class="ttname"><a href="a00559.html#a784d099e1efac1033289d50478b47ccd">ShallowWater1DSourceFunction1</a></div><div class="ttdeci">static int ShallowWater1DSourceFunction1(double *, double *, double *, void *, void *, double)</div><div class="ttdef"><b>Definition:</b> <a href="a00559_source.html#l00111">ShallowWater1DSource.c:111</a></div></div>
<div class="ttc" id="a00231_html_add9cf96ae374934d245a1dc1ab697a42"><div class="ttname"><a href="a00231.html#add9cf96ae374934d245a1dc1ab697a42">CHECKERR</a></div><div class="ttdeci">#define CHECKERR(ierr)</div><div class="ttdef"><b>Definition:</b> <a href="a00231_source.html#l00018">basic.h:18</a></div></div>
<div class="ttc" id="a00213_html_a3374c235742374318e70b42a6aa09a82"><div class="ttname"><a href="a00213.html#a3374c235742374318e70b42a6aa09a82">ShallowWater1D::b</a></div><div class="ttdeci">double * b</div><div class="ttdef"><b>Definition:</b> <a href="a00255_source.html#l00141">shallowwater1d.h:141</a></div></div>
<div class="ttc" id="a00231_html_a9aa9bad8531d6733731a850ccc471a42"><div class="ttname"><a href="a00231.html#a9aa9bad8531d6733731a850ccc471a42">_GetCoordinate_</a></div><div class="ttdeci">#define _GetCoordinate_(dir, i, dim, ghosts, x, coord)</div><div class="ttdef"><b>Definition:</b> <a href="a00231_source.html#l00031">basic.h:31</a></div></div>
<div class="ttc" id="a00205_html_a00663"><div class="ttname"><a href="a00205.html#a00663">MPIVariables</a></div><div class="ttdoc">Structure of MPI-related variables. </div><div class="ttdef"><b>Definition:</b> <a href="a00205_source.html#l00024">mpivars_struct.h:24</a></div></div>
<div class="ttc" id="a00202_html_a983929b7b1511ff3e7800597adef6a91"><div class="ttname"><a href="a00202.html#a983929b7b1511ff3e7800597adef6a91">HyPar::fluxI</a></div><div class="ttdeci">double * fluxI</div><div class="ttdef"><b>Definition:</b> <a href="a00238_source.html#l00136">hypar.h:136</a></div></div>
<div class="ttc" id="a00202_html_a99f72a44e29089b75fd11155bfcc1ff8"><div class="ttname"><a href="a00202.html#a99f72a44e29089b75fd11155bfcc1ff8">HyPar::fL</a></div><div class="ttdeci">double * fL</div><div class="ttdef"><b>Definition:</b> <a href="a00238_source.html#l00139">hypar.h:139</a></div></div>
<div class="ttc" id="a00213_html"><div class="ttname"><a href="a00213.html">ShallowWater1D</a></div><div class="ttdoc">Structure containing variables and parameters specific to the 1D Shallow Water equations. This structure contains the physical parameters, variables, and function pointers specific to the 1D ShallowWater equations. </div><div class="ttdef"><b>Definition:</b> <a href="a00255_source.html#l00137">shallowwater1d.h:137</a></div></div>
<div class="ttc" id="a00202_html_aee7ff3b51db01ee6ed4038ff5311ed24"><div class="ttname"><a href="a00202.html#aee7ff3b51db01ee6ed4038ff5311ed24">HyPar::fluxC</a></div><div class="ttdeci">double * fluxC</div><div class="ttdef"><b>Definition:</b> <a href="a00238_source.html#l00128">hypar.h:128</a></div></div>
<div class="ttc" id="a00229_html_ac5ec1371623f11d03b0f42adaa24acbc"><div class="ttname"><a href="a00229.html#ac5ec1371623f11d03b0f42adaa24acbc">_ArrayIncrementIndex_</a></div><div class="ttdeci">#define _ArrayIncrementIndex_(N, imax, i, done)</div><div class="ttdef"><b>Definition:</b> <a href="a00229_source.html#l00126">arrayfunctions.h:126</a></div></div>
<div class="ttc" id="a00202_html_a17e1cfc7de4fe33c6ee88f2cc42883e7"><div class="ttname"><a href="a00202.html#a17e1cfc7de4fe33c6ee88f2cc42883e7">HyPar::InterpolateInterfacesHyp</a></div><div class="ttdeci">int(* InterpolateInterfacesHyp)(double *, double *, double *, double *, int, int, void *, void *, int)</div><div class="ttdef"><b>Definition:</b> <a href="a00238_source.html#l00219">hypar.h:219</a></div></div>
<div class="ttc" id="a00255_html_ab6d0702f0bacbdb3f2644bd1f60938c0"><div class="ttname"><a href="a00255.html#ab6d0702f0bacbdb3f2644bd1f60938c0">_ShallowWater1DGetFlowVar_</a></div><div class="ttdeci">#define _ShallowWater1DGetFlowVar_(u, h, v)</div><div class="ttdef"><b>Definition:</b> <a href="a00255_source.html#l00054">shallowwater1d.h:54</a></div></div>
<div class="ttc" id="a00202_html"><div class="ttname"><a href="a00202.html">HyPar</a></div><div class="ttdoc">Structure containing all solver-specific variables and functions. </div><div class="ttdef"><b>Definition:</b> <a href="a00238_source.html#l00023">hypar.h:23</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a22643576d5e0c7799f56eb9409956d14"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ShallowWater1DUpwindRoe </td>
          <td>(</td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>fI</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>fL</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>fR</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>uL</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>uR</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>u</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>dir</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>s</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>t</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Roe's upwinding scheme. </p>
<p class="formulaDsp">
\begin{equation} {\bf f}_{j+1/2} = \frac{1}{2}\left[ {\bf f}_{j+1/2}^L + {\bf f}_{j+1/2}^R - \left| A\left({\bf u}_{j+1/2}^L,{\bf u}_{j+1/2}^R\right) \right| \left( {\bf u}_{j+1/2}^R - {\bf u}_{j+1/2}^L \right)\right] \end{equation}
</p>
<ul>
<li>Roe, P. L., Approximate Riemann solvers, parameter vectors, and difference schemes, Journal of Computational Physics, Vol. 43, No. 2, 1981, pp. 357372, <a href="http://dx.doi.org/10.1016/0021-9991(81)90128-5">http://dx.doi.org/10.1016/0021-9991(81)90128-5</a>.</li>
</ul>
<p>This upwinding scheme is modified for the balanced discretization of the 1D shallow water equations. See the following reference:</p>
<ul>
<li>Xing, Y., Shu, C.-W., "High order finite difference WENO schemes with the
  exact conservation property for the shallow water equations", Journal of Computational Physics, 208, 2005, pp. 206-227. <a href="http://dx.doi.org/10.1016/j.jcp.2005.02.006">http://dx.doi.org/10.1016/j.jcp.2005.02.006</a> </li>
</ul>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">fI</td><td>Computed upwind interface flux </td></tr>
    <tr><td class="paramname">fL</td><td>Left-biased reconstructed interface flux </td></tr>
    <tr><td class="paramname">fR</td><td>Right-biased reconstructed interface flux </td></tr>
    <tr><td class="paramname">uL</td><td>Left-biased reconstructed interface solution </td></tr>
    <tr><td class="paramname">uR</td><td>Right-biased reconstructed interface solution </td></tr>
    <tr><td class="paramname">u</td><td>Cell-centered solution </td></tr>
    <tr><td class="paramname">dir</td><td>Spatial dimension (unused since this is a 1D system) </td></tr>
    <tr><td class="paramname">s</td><td>Solver object of type <a class="el" href="a00202.html" title="Structure containing all solver-specific variables and functions. ">HyPar</a> </td></tr>
    <tr><td class="paramname">t</td><td>Current solution time </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="a00562_source.html#l00031">31</a> of file <a class="el" href="a00562_source.html">ShallowWater1DUpwind.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;{</div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;  <a class="code" href="a00202.html">HyPar</a>           *solver = (<a class="code" href="a00202.html">HyPar</a>*) s;</div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;  <a class="code" href="a00213.html">ShallowWater1D</a>  *param  = (<a class="code" href="a00213.html">ShallowWater1D</a>*) solver-&gt;<a class="code" href="a00202.html#a48e81a1806b5774943fd9a26e9a190f2">physics</a>;</div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;  <span class="keywordtype">int</span>             done,k;</div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;</div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;  <span class="keywordtype">int</span> ndims = solver-&gt;<a class="code" href="a00202.html#a484873c74138512e41bc50d17b7d955a">ndims</a>;</div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;  <span class="keywordtype">int</span> ghosts= solver-&gt;<a class="code" href="a00202.html#aafc992b5fa79d5a4036024615d03bce6">ghosts</a>;</div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;  <span class="keywordtype">int</span> *dim  = solver-&gt;<a class="code" href="a00202.html#a38e0371f331cecbe63a77fa03e202afe">dim_local</a>;</div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;</div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;  <span class="keywordtype">int</span> index_outer[ndims], index_inter[ndims], bounds_outer[ndims], bounds_inter[ndims];</div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;  <a class="code" href="a00229.html#a89e8330d9e06dd0666c50833628a125c">_ArrayCopy1D_</a>(dim,bounds_outer,ndims); bounds_outer[dir] =  1;</div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;  <a class="code" href="a00229.html#a89e8330d9e06dd0666c50833628a125c">_ArrayCopy1D_</a>(dim,bounds_inter,ndims); bounds_inter[dir] += 1;</div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;  <span class="keyword">static</span> <span class="keywordtype">double</span> R[<a class="code" href="a00251.html#ad3395a55a5fde64d6603c7a82d7bf2c7">_MODEL_NVARS_</a>*<a class="code" href="a00251.html#ad3395a55a5fde64d6603c7a82d7bf2c7">_MODEL_NVARS_</a>], D[<a class="code" href="a00251.html#ad3395a55a5fde64d6603c7a82d7bf2c7">_MODEL_NVARS_</a>*<a class="code" href="a00251.html#ad3395a55a5fde64d6603c7a82d7bf2c7">_MODEL_NVARS_</a>], L[<a class="code" href="a00251.html#ad3395a55a5fde64d6603c7a82d7bf2c7">_MODEL_NVARS_</a>*<a class="code" href="a00251.html#ad3395a55a5fde64d6603c7a82d7bf2c7">_MODEL_NVARS_</a>], </div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;                DL[<a class="code" href="a00251.html#ad3395a55a5fde64d6603c7a82d7bf2c7">_MODEL_NVARS_</a>*<a class="code" href="a00251.html#ad3395a55a5fde64d6603c7a82d7bf2c7">_MODEL_NVARS_</a>], modA[<a class="code" href="a00251.html#ad3395a55a5fde64d6603c7a82d7bf2c7">_MODEL_NVARS_</a>*<a class="code" href="a00251.html#ad3395a55a5fde64d6603c7a82d7bf2c7">_MODEL_NVARS_</a>];</div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;</div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;  done = 0; <a class="code" href="a00229.html#a2b2826031c0cd92495ab351d3e599fc5">_ArraySetValue_</a>(index_outer,ndims,0);</div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;  <span class="keywordflow">while</span> (!done) {</div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;    <a class="code" href="a00229.html#a89e8330d9e06dd0666c50833628a125c">_ArrayCopy1D_</a>(index_outer,index_inter,ndims);</div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;    <span class="keywordflow">for</span> (index_inter[dir] = 0; index_inter[dir] &lt; bounds_inter[dir]; index_inter[dir]++) {</div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;      <span class="keywordtype">int</span> p; <a class="code" href="a00229.html#afbb862a2fdf5b72b1f9ace42f64b556f">_ArrayIndex1D_</a>(ndims,bounds_inter,index_inter,0,p);</div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;      <span class="keywordtype">int</span> indexL[ndims]; <a class="code" href="a00229.html#a89e8330d9e06dd0666c50833628a125c">_ArrayCopy1D_</a>(index_inter,indexL,ndims); indexL[dir]--;</div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;      <span class="keywordtype">int</span> indexR[ndims]; <a class="code" href="a00229.html#a89e8330d9e06dd0666c50833628a125c">_ArrayCopy1D_</a>(index_inter,indexR,ndims);</div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;      <span class="keywordtype">int</span> pL; <a class="code" href="a00229.html#afbb862a2fdf5b72b1f9ace42f64b556f">_ArrayIndex1D_</a>(ndims,dim,indexL,ghosts,pL);</div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;      <span class="keywordtype">int</span> pR; <a class="code" href="a00229.html#afbb862a2fdf5b72b1f9ace42f64b556f">_ArrayIndex1D_</a>(ndims,dim,indexR,ghosts,pR);</div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;      <span class="keywordtype">double</span> udiff[<a class="code" href="a00251.html#ad3395a55a5fde64d6603c7a82d7bf2c7">_MODEL_NVARS_</a>], uavg[<a class="code" href="a00251.html#ad3395a55a5fde64d6603c7a82d7bf2c7">_MODEL_NVARS_</a>],udiss[<a class="code" href="a00251.html#ad3395a55a5fde64d6603c7a82d7bf2c7">_MODEL_NVARS_</a>];</div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;</div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;      <span class="comment">/* Roe&#39;s upwinding scheme */</span></div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;</div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;      udiff[0] = 0.5 * (uR[<a class="code" href="a00251.html#ad3395a55a5fde64d6603c7a82d7bf2c7">_MODEL_NVARS_</a>*p+0] - uL[<a class="code" href="a00251.html#ad3395a55a5fde64d6603c7a82d7bf2c7">_MODEL_NVARS_</a>*p+0]);</div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;      udiff[1] = 0.5 * (uR[<a class="code" href="a00251.html#ad3395a55a5fde64d6603c7a82d7bf2c7">_MODEL_NVARS_</a>*p+1] - uL[<a class="code" href="a00251.html#ad3395a55a5fde64d6603c7a82d7bf2c7">_MODEL_NVARS_</a>*p+1]);</div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;</div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;      <a class="code" href="a00255.html#af465e1911fb6168c0e308a42132deb35">_ShallowWater1DRoeAverage_</a>         (uavg,(u+<a class="code" href="a00251.html#ad3395a55a5fde64d6603c7a82d7bf2c7">_MODEL_NVARS_</a>*pL),(u+<a class="code" href="a00251.html#ad3395a55a5fde64d6603c7a82d7bf2c7">_MODEL_NVARS_</a>*pR),param); </div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;      <a class="code" href="a00255.html#a1faa098b23f173077df8a7c111dca644">_ShallowWater1DEigenvalues_</a>        (uavg,D,param,0);</div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;      <a class="code" href="a00255.html#ab304d572a9bf352c09735486f88de6f7">_ShallowWater1DLeftEigenvectors_</a>   (uavg,L,param,0);</div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;      <a class="code" href="a00255.html#a3c10806b3d5a56f4d0e9d4607dafcffc">_ShallowWater1DRightEigenvectors_</a>  (uavg,R,param,0);</div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;</div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;      k = 0; D[k] = <a class="code" href="a00243.html#adf1be5ccbb7a2522b4f3a64043c72880">absolute</a>(D[k]);</div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;      k = 3; D[k] = <a class="code" href="a00243.html#adf1be5ccbb7a2522b4f3a64043c72880">absolute</a>(D[k]);</div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;</div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;      <a class="code" href="a00246.html#a06a01d1e6572639588260002be308b61">MatMult2</a>(2,DL,D,L);</div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;      <a class="code" href="a00246.html#a06a01d1e6572639588260002be308b61">MatMult2</a>(2,modA,R,DL);</div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;</div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;      udiss[0] = modA[0*<a class="code" href="a00251.html#ad3395a55a5fde64d6603c7a82d7bf2c7">_MODEL_NVARS_</a>+0]*udiff[0] + modA[0*<a class="code" href="a00251.html#ad3395a55a5fde64d6603c7a82d7bf2c7">_MODEL_NVARS_</a>+1]*udiff[1];</div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;      udiss[1] = modA[1*<a class="code" href="a00251.html#ad3395a55a5fde64d6603c7a82d7bf2c7">_MODEL_NVARS_</a>+0]*udiff[0] + modA[1*<a class="code" href="a00251.html#ad3395a55a5fde64d6603c7a82d7bf2c7">_MODEL_NVARS_</a>+1]*udiff[1];</div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;</div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;      fI[<a class="code" href="a00251.html#ad3395a55a5fde64d6603c7a82d7bf2c7">_MODEL_NVARS_</a>*p+0] = 0.5 * (fL[<a class="code" href="a00251.html#ad3395a55a5fde64d6603c7a82d7bf2c7">_MODEL_NVARS_</a>*p+0]+fR[<a class="code" href="a00251.html#ad3395a55a5fde64d6603c7a82d7bf2c7">_MODEL_NVARS_</a>*p+0]) - udiss[0];</div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;      fI[<a class="code" href="a00251.html#ad3395a55a5fde64d6603c7a82d7bf2c7">_MODEL_NVARS_</a>*p+1] = 0.5 * (fL[<a class="code" href="a00251.html#ad3395a55a5fde64d6603c7a82d7bf2c7">_MODEL_NVARS_</a>*p+1]+fR[<a class="code" href="a00251.html#ad3395a55a5fde64d6603c7a82d7bf2c7">_MODEL_NVARS_</a>*p+1]) - udiss[1];</div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;    }</div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;    <a class="code" href="a00229.html#ac5ec1371623f11d03b0f42adaa24acbc">_ArrayIncrementIndex_</a>(ndims,bounds_outer,index_outer,done);</div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;  }</div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;</div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;  <span class="keywordflow">return</span>(0);</div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;}</div>
<div class="ttc" id="a00255_html_a3c10806b3d5a56f4d0e9d4607dafcffc"><div class="ttname"><a href="a00255.html#a3c10806b3d5a56f4d0e9d4607dafcffc">_ShallowWater1DRightEigenvectors_</a></div><div class="ttdeci">#define _ShallowWater1DRightEigenvectors_(u, R, p, dir)</div><div class="ttdef"><b>Definition:</b> <a href="a00255_source.html#l00117">shallowwater1d.h:117</a></div></div>
<div class="ttc" id="a00229_html_a2b2826031c0cd92495ab351d3e599fc5"><div class="ttname"><a href="a00229.html#a2b2826031c0cd92495ab351d3e599fc5">_ArraySetValue_</a></div><div class="ttdeci">#define _ArraySetValue_(x, size, value)</div><div class="ttdef"><b>Definition:</b> <a href="a00229_source.html#l00169">arrayfunctions.h:169</a></div></div>
<div class="ttc" id="a00229_html_afbb862a2fdf5b72b1f9ace42f64b556f"><div class="ttname"><a href="a00229.html#afbb862a2fdf5b72b1f9ace42f64b556f">_ArrayIndex1D_</a></div><div class="ttdeci">#define _ArrayIndex1D_(N, imax, i, ghost, index)</div><div class="ttdef"><b>Definition:</b> <a href="a00229_source.html#l00040">arrayfunctions.h:40</a></div></div>
<div class="ttc" id="a00229_html_a89e8330d9e06dd0666c50833628a125c"><div class="ttname"><a href="a00229.html#a89e8330d9e06dd0666c50833628a125c">_ArrayCopy1D_</a></div><div class="ttdeci">#define _ArrayCopy1D_(x, y, size)</div><div class="ttdef"><b>Definition:</b> <a href="a00229_source.html#l00319">arrayfunctions.h:319</a></div></div>
<div class="ttc" id="a00202_html_a48e81a1806b5774943fd9a26e9a190f2"><div class="ttname"><a href="a00202.html#a48e81a1806b5774943fd9a26e9a190f2">HyPar::physics</a></div><div class="ttdeci">void * physics</div><div class="ttdef"><b>Definition:</b> <a href="a00238_source.html#l00261">hypar.h:261</a></div></div>
<div class="ttc" id="a00251_html_ad3395a55a5fde64d6603c7a82d7bf2c7"><div class="ttname"><a href="a00251.html#ad3395a55a5fde64d6603c7a82d7bf2c7">_MODEL_NVARS_</a></div><div class="ttdeci">#define _MODEL_NVARS_</div><div class="ttdef"><b>Definition:</b> <a href="a00251_source.html#l00058">euler1d.h:58</a></div></div>
<div class="ttc" id="a00202_html_a484873c74138512e41bc50d17b7d955a"><div class="ttname"><a href="a00202.html#a484873c74138512e41bc50d17b7d955a">HyPar::ndims</a></div><div class="ttdeci">int ndims</div><div class="ttdef"><b>Definition:</b> <a href="a00238_source.html#l00026">hypar.h:26</a></div></div>
<div class="ttc" id="a00255_html_a1faa098b23f173077df8a7c111dca644"><div class="ttname"><a href="a00255.html#a1faa098b23f173077df8a7c111dca644">_ShallowWater1DEigenvalues_</a></div><div class="ttdeci">#define _ShallowWater1DEigenvalues_(u, D, p, dir)</div><div class="ttdef"><b>Definition:</b> <a href="a00255_source.html#l00093">shallowwater1d.h:93</a></div></div>
<div class="ttc" id="a00202_html_a38e0371f331cecbe63a77fa03e202afe"><div class="ttname"><a href="a00202.html#a38e0371f331cecbe63a77fa03e202afe">HyPar::dim_local</a></div><div class="ttdeci">int * dim_local</div><div class="ttdef"><b>Definition:</b> <a href="a00238_source.html#l00037">hypar.h:37</a></div></div>
<div class="ttc" id="a00202_html_aafc992b5fa79d5a4036024615d03bce6"><div class="ttname"><a href="a00202.html#aafc992b5fa79d5a4036024615d03bce6">HyPar::ghosts</a></div><div class="ttdeci">int ghosts</div><div class="ttdef"><b>Definition:</b> <a href="a00238_source.html#l00052">hypar.h:52</a></div></div>
<div class="ttc" id="a00255_html_af465e1911fb6168c0e308a42132deb35"><div class="ttname"><a href="a00255.html#af465e1911fb6168c0e308a42132deb35">_ShallowWater1DRoeAverage_</a></div><div class="ttdeci">#define _ShallowWater1DRoeAverage_(uavg, uL, uR, p)</div><div class="ttdef"><b>Definition:</b> <a href="a00255_source.html#l00074">shallowwater1d.h:74</a></div></div>
<div class="ttc" id="a00246_html_a06a01d1e6572639588260002be308b61"><div class="ttname"><a href="a00246.html#a06a01d1e6572639588260002be308b61">MatMult2</a></div><div class="ttdeci">#define MatMult2(N, A, X, Y)</div><div class="ttdef"><b>Definition:</b> <a href="a00246_source.html#l00032">matmult_native.h:32</a></div></div>
<div class="ttc" id="a00213_html"><div class="ttname"><a href="a00213.html">ShallowWater1D</a></div><div class="ttdoc">Structure containing variables and parameters specific to the 1D Shallow Water equations. This structure contains the physical parameters, variables, and function pointers specific to the 1D ShallowWater equations. </div><div class="ttdef"><b>Definition:</b> <a href="a00255_source.html#l00137">shallowwater1d.h:137</a></div></div>
<div class="ttc" id="a00229_html_ac5ec1371623f11d03b0f42adaa24acbc"><div class="ttname"><a href="a00229.html#ac5ec1371623f11d03b0f42adaa24acbc">_ArrayIncrementIndex_</a></div><div class="ttdeci">#define _ArrayIncrementIndex_(N, imax, i, done)</div><div class="ttdef"><b>Definition:</b> <a href="a00229_source.html#l00126">arrayfunctions.h:126</a></div></div>
<div class="ttc" id="a00255_html_ab304d572a9bf352c09735486f88de6f7"><div class="ttname"><a href="a00255.html#ab304d572a9bf352c09735486f88de6f7">_ShallowWater1DLeftEigenvectors_</a></div><div class="ttdeci">#define _ShallowWater1DLeftEigenvectors_(u, L, p, dir)</div><div class="ttdef"><b>Definition:</b> <a href="a00255_source.html#l00106">shallowwater1d.h:106</a></div></div>
<div class="ttc" id="a00202_html"><div class="ttname"><a href="a00202.html">HyPar</a></div><div class="ttdoc">Structure containing all solver-specific variables and functions. </div><div class="ttdef"><b>Definition:</b> <a href="a00238_source.html#l00023">hypar.h:23</a></div></div>
<div class="ttc" id="a00243_html_adf1be5ccbb7a2522b4f3a64043c72880"><div class="ttname"><a href="a00243.html#adf1be5ccbb7a2522b4f3a64043c72880">absolute</a></div><div class="ttdeci">#define absolute(a)</div><div class="ttdef"><b>Definition:</b> <a href="a00243_source.html#l00032">math_ops.h:32</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a6a89017972d16c3f426ba64a70a39b60"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ShallowWater1DUpwindLLF </td>
          <td>(</td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>fI</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>fL</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>fR</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>uL</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>uR</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>u</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>dir</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>s</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>t</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Characteristic-based local Lax-Friedrich upwinding scheme. </p>
<p class="formulaDsp">
\begin{align} \alpha_{j+1/2}^{k,L} &amp;= \sum_{k=1}^2 {\bf l}_{j+1/2}^k \cdot {\bf f}_{j+1/2}^{k,L}, \\ \alpha_{j+1/2}^{k,R} &amp;= \sum_{k=1}^2 {\bf l}_{j+1/2}^k \cdot {\bf f}_{j+1/2}^{k,R}, \\ v_{j+1/2}^{k,L} &amp;= \sum_{k=1}^2 {\bf l}_{j+1/2}^k \cdot {\bf u}_{j+1/2}^{k,L}, \\ v_{j+1/2}^{k,R} &amp;= \sum_{k=1}^2 {\bf l}_{j+1/2}^k \cdot {\bf u}_{j+1/2}^{k,R}, \\ \alpha_{j+1/2}^k &amp;= \frac{1}{2}\left[ \alpha_{j+1/2}^{k,L} + \alpha_{j+1/2}^{k,R} - \left(\max_{\left[j,j+1\right]} \lambda\right) \left( v_{j+1/2}^{k,R} - v_{j+1/2}^{k,L} \right) \right], \\ {\bf f}_{j+1/2} &amp;= \sum_{k=1}^2 \alpha_{j+1/2}^k {\bf r}_{j+1/2}^k \end{align}
</p>
<p> where \({\bf l}\), \({\bf r}\), and \(\lambda\) are the left-eigenvectors, right-eigenvectors and eigenvalues. The subscripts denote the grid locations.</p>
<ul>
<li>C.-W. Shu, and S. Osher, "Efficient implementation of essentially non-oscillatory schemes, II", J. Comput. Phys., 83 (1989), pp. 3278, <a href="http://dx.doi.org/10.1016/0021-9991(89)90222-2">http://dx.doi.org/10.1016/0021-9991(89)90222-2</a>.</li>
</ul>
<p>This upwinding scheme is modified for the balanced discretization of the 1D shallow water equations. See the following reference:</p>
<ul>
<li>Xing, Y., Shu, C.-W., "High order finite difference WENO schemes with the
  exact conservation property for the shallow water equations", Journal of Computational Physics, 208, 2005, pp. 206-227. <a href="http://dx.doi.org/10.1016/j.jcp.2005.02.006">http://dx.doi.org/10.1016/j.jcp.2005.02.006</a> </li>
</ul>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">fI</td><td>Computed upwind interface flux </td></tr>
    <tr><td class="paramname">fL</td><td>Left-biased reconstructed interface flux </td></tr>
    <tr><td class="paramname">fR</td><td>Right-biased reconstructed interface flux </td></tr>
    <tr><td class="paramname">uL</td><td>Left-biased reconstructed interface solution </td></tr>
    <tr><td class="paramname">uR</td><td>Right-biased reconstructed interface solution </td></tr>
    <tr><td class="paramname">u</td><td>Cell-centered solution </td></tr>
    <tr><td class="paramname">dir</td><td>Spatial dimension (unused since this is a 1D system) </td></tr>
    <tr><td class="paramname">s</td><td>Solver object of type <a class="el" href="a00202.html" title="Structure containing all solver-specific variables and functions. ">HyPar</a> </td></tr>
    <tr><td class="paramname">t</td><td>Current solution time </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="a00562_source.html#l00114">114</a> of file <a class="el" href="a00562_source.html">ShallowWater1DUpwind.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;{</div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;  <a class="code" href="a00202.html">HyPar</a>           *solver = (<a class="code" href="a00202.html">HyPar</a>*) s;</div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;  <a class="code" href="a00213.html">ShallowWater1D</a>  *param  = (<a class="code" href="a00213.html">ShallowWater1D</a>*) solver-&gt;<a class="code" href="a00202.html#a48e81a1806b5774943fd9a26e9a190f2">physics</a>;</div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;  <span class="keywordtype">int</span>             done,k;</div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;</div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;  <span class="keywordtype">int</span> ndims   = solver-&gt;<a class="code" href="a00202.html#a484873c74138512e41bc50d17b7d955a">ndims</a>;</div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;  <span class="keywordtype">int</span> *dim    = solver-&gt;<a class="code" href="a00202.html#a38e0371f331cecbe63a77fa03e202afe">dim_local</a>;</div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;  <span class="keywordtype">int</span> ghosts  = solver-&gt;<a class="code" href="a00202.html#aafc992b5fa79d5a4036024615d03bce6">ghosts</a>;</div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;</div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;  <span class="keywordtype">int</span> index_outer[ndims], index_inter[ndims], bounds_outer[ndims], bounds_inter[ndims];</div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;  <a class="code" href="a00229.html#a89e8330d9e06dd0666c50833628a125c">_ArrayCopy1D_</a>(dim,bounds_outer,ndims); bounds_outer[dir] =  1;</div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;  <a class="code" href="a00229.html#a89e8330d9e06dd0666c50833628a125c">_ArrayCopy1D_</a>(dim,bounds_inter,ndims); bounds_inter[dir] += 1;</div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;  <span class="keyword">static</span> <span class="keywordtype">double</span> R[<a class="code" href="a00251.html#ad3395a55a5fde64d6603c7a82d7bf2c7">_MODEL_NVARS_</a>*<a class="code" href="a00251.html#ad3395a55a5fde64d6603c7a82d7bf2c7">_MODEL_NVARS_</a>], D[<a class="code" href="a00251.html#ad3395a55a5fde64d6603c7a82d7bf2c7">_MODEL_NVARS_</a>*<a class="code" href="a00251.html#ad3395a55a5fde64d6603c7a82d7bf2c7">_MODEL_NVARS_</a>], L[<a class="code" href="a00251.html#ad3395a55a5fde64d6603c7a82d7bf2c7">_MODEL_NVARS_</a>*<a class="code" href="a00251.html#ad3395a55a5fde64d6603c7a82d7bf2c7">_MODEL_NVARS_</a>];</div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;</div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;  done = 0; <a class="code" href="a00229.html#a2b2826031c0cd92495ab351d3e599fc5">_ArraySetValue_</a>(index_outer,ndims,0);</div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;  <span class="keywordflow">while</span> (!done) {</div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;    <a class="code" href="a00229.html#a89e8330d9e06dd0666c50833628a125c">_ArrayCopy1D_</a>(index_outer,index_inter,ndims);</div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;    <span class="keywordflow">for</span> (index_inter[dir] = 0; index_inter[dir] &lt; bounds_inter[dir]; index_inter[dir]++) {</div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;      <span class="keywordtype">int</span> p; <a class="code" href="a00229.html#afbb862a2fdf5b72b1f9ace42f64b556f">_ArrayIndex1D_</a>(ndims,bounds_inter,index_inter,0,p);</div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;      <span class="keywordtype">int</span> indexL[ndims]; <a class="code" href="a00229.html#a89e8330d9e06dd0666c50833628a125c">_ArrayCopy1D_</a>(index_inter,indexL,ndims); indexL[dir]--;</div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;      <span class="keywordtype">int</span> indexR[ndims]; <a class="code" href="a00229.html#a89e8330d9e06dd0666c50833628a125c">_ArrayCopy1D_</a>(index_inter,indexR,ndims);</div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;      <span class="keywordtype">int</span> pL; <a class="code" href="a00229.html#afbb862a2fdf5b72b1f9ace42f64b556f">_ArrayIndex1D_</a>(ndims,dim,indexL,ghosts,pL);</div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;      <span class="keywordtype">int</span> pR; <a class="code" href="a00229.html#afbb862a2fdf5b72b1f9ace42f64b556f">_ArrayIndex1D_</a>(ndims,dim,indexR,ghosts,pR);</div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;      <span class="keywordtype">double</span> uavg[<a class="code" href="a00251.html#ad3395a55a5fde64d6603c7a82d7bf2c7">_MODEL_NVARS_</a>], fcL[<a class="code" href="a00251.html#ad3395a55a5fde64d6603c7a82d7bf2c7">_MODEL_NVARS_</a>], fcR[<a class="code" href="a00251.html#ad3395a55a5fde64d6603c7a82d7bf2c7">_MODEL_NVARS_</a>], </div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;             ucL[<a class="code" href="a00251.html#ad3395a55a5fde64d6603c7a82d7bf2c7">_MODEL_NVARS_</a>], ucR[<a class="code" href="a00251.html#ad3395a55a5fde64d6603c7a82d7bf2c7">_MODEL_NVARS_</a>], fc[<a class="code" href="a00251.html#ad3395a55a5fde64d6603c7a82d7bf2c7">_MODEL_NVARS_</a>];</div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;</div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;      <span class="comment">/* Local Lax-Friedrich upwinding scheme */</span></div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;</div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;      <a class="code" href="a00255.html#af465e1911fb6168c0e308a42132deb35">_ShallowWater1DRoeAverage_</a>       (uavg,(u+<a class="code" href="a00251.html#ad3395a55a5fde64d6603c7a82d7bf2c7">_MODEL_NVARS_</a>*pL),(u+<a class="code" href="a00251.html#ad3395a55a5fde64d6603c7a82d7bf2c7">_MODEL_NVARS_</a>*pR),param);</div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;      <a class="code" href="a00255.html#a1faa098b23f173077df8a7c111dca644">_ShallowWater1DEigenvalues_</a>      (uavg,D,param,0);</div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;      <a class="code" href="a00255.html#ab304d572a9bf352c09735486f88de6f7">_ShallowWater1DLeftEigenvectors_</a> (uavg,L,param,0);</div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;      <a class="code" href="a00255.html#a3c10806b3d5a56f4d0e9d4607dafcffc">_ShallowWater1DRightEigenvectors_</a>(uavg,R,param,0);</div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;</div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;      <span class="comment">/* calculate characteristic fluxes and variables */</span></div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;      <a class="code" href="a00246.html#a514be5a259cdafd270236704592c6036">MatVecMult2</a>(<a class="code" href="a00251.html#ad3395a55a5fde64d6603c7a82d7bf2c7">_MODEL_NVARS_</a>,ucL,L,(uL+<a class="code" href="a00251.html#ad3395a55a5fde64d6603c7a82d7bf2c7">_MODEL_NVARS_</a>*p));</div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;      <a class="code" href="a00246.html#a514be5a259cdafd270236704592c6036">MatVecMult2</a>(<a class="code" href="a00251.html#ad3395a55a5fde64d6603c7a82d7bf2c7">_MODEL_NVARS_</a>,ucR,L,(uR+<a class="code" href="a00251.html#ad3395a55a5fde64d6603c7a82d7bf2c7">_MODEL_NVARS_</a>*p));</div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;      <a class="code" href="a00246.html#a514be5a259cdafd270236704592c6036">MatVecMult2</a>(<a class="code" href="a00251.html#ad3395a55a5fde64d6603c7a82d7bf2c7">_MODEL_NVARS_</a>,fcL,L,(fL+<a class="code" href="a00251.html#ad3395a55a5fde64d6603c7a82d7bf2c7">_MODEL_NVARS_</a>*p));</div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;      <a class="code" href="a00246.html#a514be5a259cdafd270236704592c6036">MatVecMult2</a>(<a class="code" href="a00251.html#ad3395a55a5fde64d6603c7a82d7bf2c7">_MODEL_NVARS_</a>,fcR,L,(fR+<a class="code" href="a00251.html#ad3395a55a5fde64d6603c7a82d7bf2c7">_MODEL_NVARS_</a>*p));</div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;</div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;      <span class="keywordflow">for</span> (k = 0; k &lt; <a class="code" href="a00251.html#ad3395a55a5fde64d6603c7a82d7bf2c7">_MODEL_NVARS_</a>; k++) {</div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;        <span class="keywordtype">double</span> eigL,eigC,eigR;</div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;        <a class="code" href="a00255.html#a1faa098b23f173077df8a7c111dca644">_ShallowWater1DEigenvalues_</a>((u+_MODEL_NVARS_*pL),D,param,0);</div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;        eigL = D[k*_MODEL_NVARS_+k];</div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;        <a class="code" href="a00255.html#a1faa098b23f173077df8a7c111dca644">_ShallowWater1DEigenvalues_</a>((u+_MODEL_NVARS_*pR),D,param,0);</div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;        eigR = D[k*_MODEL_NVARS_+k];</div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;        <a class="code" href="a00255.html#a1faa098b23f173077df8a7c111dca644">_ShallowWater1DEigenvalues_</a>(uavg,D,param,0);</div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;        eigC = D[k*_MODEL_NVARS_+k];</div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;</div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;        <span class="keywordtype">double</span> alpha = <a class="code" href="a00243.html#aa0d45e1e67c5cacf5c9251fcd90a971b">max3</a>(<a class="code" href="a00243.html#adf1be5ccbb7a2522b4f3a64043c72880">absolute</a>(eigL),<a class="code" href="a00243.html#adf1be5ccbb7a2522b4f3a64043c72880">absolute</a>(eigC),<a class="code" href="a00243.html#adf1be5ccbb7a2522b4f3a64043c72880">absolute</a>(eigR));</div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;        fc[k] = 0.5 * (fcL[k] + fcR[k] + alpha * (ucL[k]-ucR[k]));</div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;      }</div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;</div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;      <span class="comment">/* calculate the interface flux from the characteristic flux */</span></div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;      <a class="code" href="a00246.html#a514be5a259cdafd270236704592c6036">MatVecMult2</a>(_MODEL_NVARS_,(fI+_MODEL_NVARS_*p),R,fc);</div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;    }</div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;    <a class="code" href="a00229.html#ac5ec1371623f11d03b0f42adaa24acbc">_ArrayIncrementIndex_</a>(ndims,bounds_outer,index_outer,done);</div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;  }</div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;</div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;  <span class="keywordflow">return</span>(0);</div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;}</div>
<div class="ttc" id="a00255_html_a3c10806b3d5a56f4d0e9d4607dafcffc"><div class="ttname"><a href="a00255.html#a3c10806b3d5a56f4d0e9d4607dafcffc">_ShallowWater1DRightEigenvectors_</a></div><div class="ttdeci">#define _ShallowWater1DRightEigenvectors_(u, R, p, dir)</div><div class="ttdef"><b>Definition:</b> <a href="a00255_source.html#l00117">shallowwater1d.h:117</a></div></div>
<div class="ttc" id="a00229_html_a2b2826031c0cd92495ab351d3e599fc5"><div class="ttname"><a href="a00229.html#a2b2826031c0cd92495ab351d3e599fc5">_ArraySetValue_</a></div><div class="ttdeci">#define _ArraySetValue_(x, size, value)</div><div class="ttdef"><b>Definition:</b> <a href="a00229_source.html#l00169">arrayfunctions.h:169</a></div></div>
<div class="ttc" id="a00229_html_afbb862a2fdf5b72b1f9ace42f64b556f"><div class="ttname"><a href="a00229.html#afbb862a2fdf5b72b1f9ace42f64b556f">_ArrayIndex1D_</a></div><div class="ttdeci">#define _ArrayIndex1D_(N, imax, i, ghost, index)</div><div class="ttdef"><b>Definition:</b> <a href="a00229_source.html#l00040">arrayfunctions.h:40</a></div></div>
<div class="ttc" id="a00229_html_a89e8330d9e06dd0666c50833628a125c"><div class="ttname"><a href="a00229.html#a89e8330d9e06dd0666c50833628a125c">_ArrayCopy1D_</a></div><div class="ttdeci">#define _ArrayCopy1D_(x, y, size)</div><div class="ttdef"><b>Definition:</b> <a href="a00229_source.html#l00319">arrayfunctions.h:319</a></div></div>
<div class="ttc" id="a00243_html_aa0d45e1e67c5cacf5c9251fcd90a971b"><div class="ttname"><a href="a00243.html#aa0d45e1e67c5cacf5c9251fcd90a971b">max3</a></div><div class="ttdeci">#define max3(a, b, c)</div><div class="ttdef"><b>Definition:</b> <a href="a00243_source.html#l00027">math_ops.h:27</a></div></div>
<div class="ttc" id="a00202_html_a48e81a1806b5774943fd9a26e9a190f2"><div class="ttname"><a href="a00202.html#a48e81a1806b5774943fd9a26e9a190f2">HyPar::physics</a></div><div class="ttdeci">void * physics</div><div class="ttdef"><b>Definition:</b> <a href="a00238_source.html#l00261">hypar.h:261</a></div></div>
<div class="ttc" id="a00251_html_ad3395a55a5fde64d6603c7a82d7bf2c7"><div class="ttname"><a href="a00251.html#ad3395a55a5fde64d6603c7a82d7bf2c7">_MODEL_NVARS_</a></div><div class="ttdeci">#define _MODEL_NVARS_</div><div class="ttdef"><b>Definition:</b> <a href="a00251_source.html#l00058">euler1d.h:58</a></div></div>
<div class="ttc" id="a00202_html_a484873c74138512e41bc50d17b7d955a"><div class="ttname"><a href="a00202.html#a484873c74138512e41bc50d17b7d955a">HyPar::ndims</a></div><div class="ttdeci">int ndims</div><div class="ttdef"><b>Definition:</b> <a href="a00238_source.html#l00026">hypar.h:26</a></div></div>
<div class="ttc" id="a00255_html_a1faa098b23f173077df8a7c111dca644"><div class="ttname"><a href="a00255.html#a1faa098b23f173077df8a7c111dca644">_ShallowWater1DEigenvalues_</a></div><div class="ttdeci">#define _ShallowWater1DEigenvalues_(u, D, p, dir)</div><div class="ttdef"><b>Definition:</b> <a href="a00255_source.html#l00093">shallowwater1d.h:93</a></div></div>
<div class="ttc" id="a00202_html_a38e0371f331cecbe63a77fa03e202afe"><div class="ttname"><a href="a00202.html#a38e0371f331cecbe63a77fa03e202afe">HyPar::dim_local</a></div><div class="ttdeci">int * dim_local</div><div class="ttdef"><b>Definition:</b> <a href="a00238_source.html#l00037">hypar.h:37</a></div></div>
<div class="ttc" id="a00202_html_aafc992b5fa79d5a4036024615d03bce6"><div class="ttname"><a href="a00202.html#aafc992b5fa79d5a4036024615d03bce6">HyPar::ghosts</a></div><div class="ttdeci">int ghosts</div><div class="ttdef"><b>Definition:</b> <a href="a00238_source.html#l00052">hypar.h:52</a></div></div>
<div class="ttc" id="a00255_html_af465e1911fb6168c0e308a42132deb35"><div class="ttname"><a href="a00255.html#af465e1911fb6168c0e308a42132deb35">_ShallowWater1DRoeAverage_</a></div><div class="ttdeci">#define _ShallowWater1DRoeAverage_(uavg, uL, uR, p)</div><div class="ttdef"><b>Definition:</b> <a href="a00255_source.html#l00074">shallowwater1d.h:74</a></div></div>
<div class="ttc" id="a00246_html_a514be5a259cdafd270236704592c6036"><div class="ttname"><a href="a00246.html#a514be5a259cdafd270236704592c6036">MatVecMult2</a></div><div class="ttdeci">#define MatVecMult2(N, y, A, x)</div><div class="ttdef"><b>Definition:</b> <a href="a00246_source.html#l00128">matmult_native.h:128</a></div></div>
<div class="ttc" id="a00213_html"><div class="ttname"><a href="a00213.html">ShallowWater1D</a></div><div class="ttdoc">Structure containing variables and parameters specific to the 1D Shallow Water equations. This structure contains the physical parameters, variables, and function pointers specific to the 1D ShallowWater equations. </div><div class="ttdef"><b>Definition:</b> <a href="a00255_source.html#l00137">shallowwater1d.h:137</a></div></div>
<div class="ttc" id="a00229_html_ac5ec1371623f11d03b0f42adaa24acbc"><div class="ttname"><a href="a00229.html#ac5ec1371623f11d03b0f42adaa24acbc">_ArrayIncrementIndex_</a></div><div class="ttdeci">#define _ArrayIncrementIndex_(N, imax, i, done)</div><div class="ttdef"><b>Definition:</b> <a href="a00229_source.html#l00126">arrayfunctions.h:126</a></div></div>
<div class="ttc" id="a00255_html_ab304d572a9bf352c09735486f88de6f7"><div class="ttname"><a href="a00255.html#ab304d572a9bf352c09735486f88de6f7">_ShallowWater1DLeftEigenvectors_</a></div><div class="ttdeci">#define _ShallowWater1DLeftEigenvectors_(u, L, p, dir)</div><div class="ttdef"><b>Definition:</b> <a href="a00255_source.html#l00106">shallowwater1d.h:106</a></div></div>
<div class="ttc" id="a00202_html"><div class="ttname"><a href="a00202.html">HyPar</a></div><div class="ttdoc">Structure containing all solver-specific variables and functions. </div><div class="ttdef"><b>Definition:</b> <a href="a00238_source.html#l00023">hypar.h:23</a></div></div>
<div class="ttc" id="a00243_html_adf1be5ccbb7a2522b4f3a64043c72880"><div class="ttname"><a href="a00243.html#adf1be5ccbb7a2522b4f3a64043c72880">absolute</a></div><div class="ttdeci">#define absolute(a)</div><div class="ttdef"><b>Definition:</b> <a href="a00243_source.html#l00032">math_ops.h:32</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a488d45759b0b962998e6df9e3c6061f6"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ShallowWater1DJacobian </td>
          <td>(</td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>Jac</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>u</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>p</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>dir</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>nvars</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>upw</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Function to compute the flux Jacobian of the 1D shallow water equations, given the solution at a grid point. The Jacobian is square matrix of size nvar=2, and is returned as a 1D array (double) of 4 elements in row-major format. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">Jac</td><td>Jacobian matrix: 1D array of size nvar^2 = 4 </td></tr>
    <tr><td class="paramname">u</td><td>solution at a grid point (array of size nvar = 2) </td></tr>
    <tr><td class="paramname">p</td><td>object containing the physics-related parameters </td></tr>
    <tr><td class="paramname">dir</td><td>dimension (x/y/z) (not used, since this is 1D system) </td></tr>
    <tr><td class="paramname">nvars</td><td>number of vector components </td></tr>
    <tr><td class="paramname">upw</td><td>0 -&gt; send back complete Jacobian, 1 -&gt; send back Jacobian of right(+)-moving flux, -1 -&gt; send back Jacobian of left(-)-moving flux </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="a00557_source.html#l00014">14</a> of file <a class="el" href="a00557_source.html">ShallowWater1DJacobian.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;{</div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;  <a class="code" href="a00213.html">ShallowWater1D</a>  *param = (<a class="code" href="a00213.html">ShallowWater1D</a>*) p;</div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;  <span class="keyword">static</span> <span class="keywordtype">double</span>   R[<a class="code" href="a00251.html#ad3395a55a5fde64d6603c7a82d7bf2c7">_MODEL_NVARS_</a>*<a class="code" href="a00251.html#ad3395a55a5fde64d6603c7a82d7bf2c7">_MODEL_NVARS_</a>], D[<a class="code" href="a00251.html#ad3395a55a5fde64d6603c7a82d7bf2c7">_MODEL_NVARS_</a>*<a class="code" href="a00251.html#ad3395a55a5fde64d6603c7a82d7bf2c7">_MODEL_NVARS_</a>], </div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;                  L[<a class="code" href="a00251.html#ad3395a55a5fde64d6603c7a82d7bf2c7">_MODEL_NVARS_</a>*<a class="code" href="a00251.html#ad3395a55a5fde64d6603c7a82d7bf2c7">_MODEL_NVARS_</a>], DL[<a class="code" href="a00251.html#ad3395a55a5fde64d6603c7a82d7bf2c7">_MODEL_NVARS_</a>*<a class="code" href="a00251.html#ad3395a55a5fde64d6603c7a82d7bf2c7">_MODEL_NVARS_</a>];</div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;</div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;  <span class="comment">/* get the eigenvalues and left,right eigenvectors */</span></div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;  <a class="code" href="a00255.html#a1faa098b23f173077df8a7c111dca644">_ShallowWater1DEigenvalues_</a>      (u,D,param,0);</div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;  <a class="code" href="a00255.html#ab304d572a9bf352c09735486f88de6f7">_ShallowWater1DLeftEigenvectors_</a> (u,L,param,0);</div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;  <a class="code" href="a00255.html#a3c10806b3d5a56f4d0e9d4607dafcffc">_ShallowWater1DRightEigenvectors_</a>(u,R,param,0);</div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;</div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;  <span class="keywordtype">int</span> aupw = <a class="code" href="a00243.html#adf1be5ccbb7a2522b4f3a64043c72880">absolute</a>(upw), k;</div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;  k = 0; D[k] = <a class="code" href="a00243.html#adf1be5ccbb7a2522b4f3a64043c72880">absolute</a>( (1-aupw)*D[k] + 0.5*aupw*(1+upw)*<a class="code" href="a00243.html#affe776513b24d84b39af8ab0930fef7f">max</a>(0,D[k]) + 0.5*aupw*(1-upw)*<a class="code" href="a00243.html#ac6afabdc09a49a433ee19d8a9486056d">min</a>(0,D[k]) );</div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;  k = 3; D[k] = <a class="code" href="a00243.html#adf1be5ccbb7a2522b4f3a64043c72880">absolute</a>( (1-aupw)*D[k] + 0.5*aupw*(1+upw)*<a class="code" href="a00243.html#affe776513b24d84b39af8ab0930fef7f">max</a>(0,D[k]) + 0.5*aupw*(1-upw)*<a class="code" href="a00243.html#ac6afabdc09a49a433ee19d8a9486056d">min</a>(0,D[k]) );</div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;</div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;  <a class="code" href="a00246.html#a06a01d1e6572639588260002be308b61">MatMult2</a>(2,DL,D,L);</div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;  <a class="code" href="a00246.html#a06a01d1e6572639588260002be308b61">MatMult2</a>(2,Jac,R,DL);</div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;</div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;  <span class="keywordflow">return</span>(0);</div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;}</div>
<div class="ttc" id="a00255_html_a3c10806b3d5a56f4d0e9d4607dafcffc"><div class="ttname"><a href="a00255.html#a3c10806b3d5a56f4d0e9d4607dafcffc">_ShallowWater1DRightEigenvectors_</a></div><div class="ttdeci">#define _ShallowWater1DRightEigenvectors_(u, R, p, dir)</div><div class="ttdef"><b>Definition:</b> <a href="a00255_source.html#l00117">shallowwater1d.h:117</a></div></div>
<div class="ttc" id="a00243_html_affe776513b24d84b39af8ab0930fef7f"><div class="ttname"><a href="a00243.html#affe776513b24d84b39af8ab0930fef7f">max</a></div><div class="ttdeci">#define max(a, b)</div><div class="ttdef"><b>Definition:</b> <a href="a00243_source.html#l00018">math_ops.h:18</a></div></div>
<div class="ttc" id="a00243_html_ac6afabdc09a49a433ee19d8a9486056d"><div class="ttname"><a href="a00243.html#ac6afabdc09a49a433ee19d8a9486056d">min</a></div><div class="ttdeci">#define min(a, b)</div><div class="ttdef"><b>Definition:</b> <a href="a00243_source.html#l00014">math_ops.h:14</a></div></div>
<div class="ttc" id="a00251_html_ad3395a55a5fde64d6603c7a82d7bf2c7"><div class="ttname"><a href="a00251.html#ad3395a55a5fde64d6603c7a82d7bf2c7">_MODEL_NVARS_</a></div><div class="ttdeci">#define _MODEL_NVARS_</div><div class="ttdef"><b>Definition:</b> <a href="a00251_source.html#l00058">euler1d.h:58</a></div></div>
<div class="ttc" id="a00255_html_a1faa098b23f173077df8a7c111dca644"><div class="ttname"><a href="a00255.html#a1faa098b23f173077df8a7c111dca644">_ShallowWater1DEigenvalues_</a></div><div class="ttdeci">#define _ShallowWater1DEigenvalues_(u, D, p, dir)</div><div class="ttdef"><b>Definition:</b> <a href="a00255_source.html#l00093">shallowwater1d.h:93</a></div></div>
<div class="ttc" id="a00246_html_a06a01d1e6572639588260002be308b61"><div class="ttname"><a href="a00246.html#a06a01d1e6572639588260002be308b61">MatMult2</a></div><div class="ttdeci">#define MatMult2(N, A, X, Y)</div><div class="ttdef"><b>Definition:</b> <a href="a00246_source.html#l00032">matmult_native.h:32</a></div></div>
<div class="ttc" id="a00213_html"><div class="ttname"><a href="a00213.html">ShallowWater1D</a></div><div class="ttdoc">Structure containing variables and parameters specific to the 1D Shallow Water equations. This structure contains the physical parameters, variables, and function pointers specific to the 1D ShallowWater equations. </div><div class="ttdef"><b>Definition:</b> <a href="a00255_source.html#l00137">shallowwater1d.h:137</a></div></div>
<div class="ttc" id="a00255_html_ab304d572a9bf352c09735486f88de6f7"><div class="ttname"><a href="a00255.html#ab304d572a9bf352c09735486f88de6f7">_ShallowWater1DLeftEigenvectors_</a></div><div class="ttdeci">#define _ShallowWater1DLeftEigenvectors_(u, L, p, dir)</div><div class="ttdef"><b>Definition:</b> <a href="a00255_source.html#l00106">shallowwater1d.h:106</a></div></div>
<div class="ttc" id="a00243_html_adf1be5ccbb7a2522b4f3a64043c72880"><div class="ttname"><a href="a00243.html#adf1be5ccbb7a2522b4f3a64043c72880">absolute</a></div><div class="ttdeci">#define absolute(a)</div><div class="ttdef"><b>Definition:</b> <a href="a00243_source.html#l00032">math_ops.h:32</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a5c2d4897fbfbf16e43f08d89c3688db6"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ShallowWater1DRoeAverage </td>
          <td>(</td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>uavg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>uL</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>uR</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>p</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Compute the Roe-averaged state for the 1D shallow water equations. This function just calls the macro <a class="el" href="a00255.html#af465e1911fb6168c0e308a42132deb35">_ShallowWater1DRoeAverage_</a> and is not used by any functions within the 1D shallow water module. However, it's necessary to define it and provide it to the the solver object (<a class="el" href="a00202.html" title="Structure containing all solver-specific variables and functions. ">HyPar</a>) so that it can then send it to interpolation functions for a characteristic-based reconstruction. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">uavg</td><td>The computed Roe-averaged state </td></tr>
    <tr><td class="paramname">uL</td><td>Left state (conserved variables) </td></tr>
    <tr><td class="paramname">uR</td><td>Right state (conserved variables) </td></tr>
    <tr><td class="paramname">p</td><td>Object of type <a class="el" href="a00213.html" title="Structure containing variables and parameters specific to the 1D Shallow Water equations. This structure contains the physical parameters, variables, and function pointers specific to the 1D ShallowWater equations. ">ShallowWater1D</a> with physics-related variables </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="a00555_source.html#l00016">16</a> of file <a class="el" href="a00555_source.html">ShallowWater1DFunctions.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;{</div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;  <a class="code" href="a00213.html">ShallowWater1D</a> *param  = (<a class="code" href="a00213.html">ShallowWater1D</a>*) p;</div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;  <a class="code" href="a00255.html#af465e1911fb6168c0e308a42132deb35">_ShallowWater1DRoeAverage_</a>(uavg,uL,uR,param);</div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;  <span class="keywordflow">return</span>(0);</div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;}</div>
<div class="ttc" id="a00255_html_af465e1911fb6168c0e308a42132deb35"><div class="ttname"><a href="a00255.html#af465e1911fb6168c0e308a42132deb35">_ShallowWater1DRoeAverage_</a></div><div class="ttdeci">#define _ShallowWater1DRoeAverage_(uavg, uL, uR, p)</div><div class="ttdef"><b>Definition:</b> <a href="a00255_source.html#l00074">shallowwater1d.h:74</a></div></div>
<div class="ttc" id="a00213_html"><div class="ttname"><a href="a00213.html">ShallowWater1D</a></div><div class="ttdoc">Structure containing variables and parameters specific to the 1D Shallow Water equations. This structure contains the physical parameters, variables, and function pointers specific to the 1D ShallowWater equations. </div><div class="ttdef"><b>Definition:</b> <a href="a00255_source.html#l00137">shallowwater1d.h:137</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ac7f0da5cc95a6d3e4f15e40ad86270e5"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ShallowWater1DLeftEigenvectors </td>
          <td>(</td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>u</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>L</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>p</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>dir</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Compute the left eigenvections for the 1D shallow water equations. This function just calls the macro <a class="el" href="a00255.html#ab304d572a9bf352c09735486f88de6f7">_ShallowWater1DLeftEigenvectors_</a> and is not used by any functions within the 1D shallow water module. However, it's necessary to define it and provide it to the the solver object (<a class="el" href="a00202.html" title="Structure containing all solver-specific variables and functions. ">HyPar</a>) so that it can then send it to interpolation functions for a characteristic-based reconstruction. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">u</td><td>Conserved solution at a grid point </td></tr>
    <tr><td class="paramname">L</td><td>Array of size nvar^2 = 2^2 to save the matrix of left eigenvectors in (row-major format). </td></tr>
    <tr><td class="paramname">p</td><td>Object of type <a class="el" href="a00213.html" title="Structure containing variables and parameters specific to the 1D Shallow Water equations. This structure contains the physical parameters, variables, and function pointers specific to the 1D ShallowWater equations. ">ShallowWater1D</a> with physics-related variables </td></tr>
    <tr><td class="paramname">dir</td><td>Spatial dimension (not used, since this is a 1D system) </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="a00553_source.html#l00019">19</a> of file <a class="el" href="a00553_source.html">ShallowWater1DEigen.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;{</div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;  <a class="code" href="a00213.html">ShallowWater1D</a> *param  = (<a class="code" href="a00213.html">ShallowWater1D</a>*)  p;</div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;  <a class="code" href="a00255.html#ab304d572a9bf352c09735486f88de6f7">_ShallowWater1DLeftEigenvectors_</a>(u,L,param,dir);</div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;  <span class="keywordflow">return</span>(0);</div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;}</div>
<div class="ttc" id="a00213_html"><div class="ttname"><a href="a00213.html">ShallowWater1D</a></div><div class="ttdoc">Structure containing variables and parameters specific to the 1D Shallow Water equations. This structure contains the physical parameters, variables, and function pointers specific to the 1D ShallowWater equations. </div><div class="ttdef"><b>Definition:</b> <a href="a00255_source.html#l00137">shallowwater1d.h:137</a></div></div>
<div class="ttc" id="a00255_html_ab304d572a9bf352c09735486f88de6f7"><div class="ttname"><a href="a00255.html#ab304d572a9bf352c09735486f88de6f7">_ShallowWater1DLeftEigenvectors_</a></div><div class="ttdeci">#define _ShallowWater1DLeftEigenvectors_(u, L, p, dir)</div><div class="ttdef"><b>Definition:</b> <a href="a00255_source.html#l00106">shallowwater1d.h:106</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="aca4eced2ab6eaac693a487d7b8aae1ed"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ShallowWater1DRightEigenvectors </td>
          <td>(</td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>u</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>R</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>p</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>dir</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Compute the right eigenvections for the 1D shallow water equations. This function just calls the macro <a class="el" href="a00255.html#a3c10806b3d5a56f4d0e9d4607dafcffc">_ShallowWater1DRightEigenvectors_</a> and is not used by any functions within the 1D shallow water module. However, it's necessary to define it and provide it to the the solver object (<a class="el" href="a00202.html" title="Structure containing all solver-specific variables and functions. ">HyPar</a>) so that it can then send it to interpolation functions for a characteristic-based reconstruction. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">u</td><td>Conserved solution at a grid point </td></tr>
    <tr><td class="paramname">R</td><td>Array of size nvar^2 = 2^2 to save the matrix of right eigenvectors in (row-major format). </td></tr>
    <tr><td class="paramname">p</td><td>Object of type <a class="el" href="a00213.html" title="Structure containing variables and parameters specific to the 1D Shallow Water equations. This structure contains the physical parameters, variables, and function pointers specific to the 1D ShallowWater equations. ">ShallowWater1D</a> with physics-related variables </td></tr>
    <tr><td class="paramname">dir</td><td>Spatial dimension (not used, since this is a 1D system) </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="a00553_source.html#l00038">38</a> of file <a class="el" href="a00553_source.html">ShallowWater1DEigen.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;{</div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;  <a class="code" href="a00213.html">ShallowWater1D</a> *param  = (<a class="code" href="a00213.html">ShallowWater1D</a>*)  p;</div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;  <a class="code" href="a00255.html#a3c10806b3d5a56f4d0e9d4607dafcffc">_ShallowWater1DRightEigenvectors_</a>(u,R,param,dir);</div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;  <span class="keywordflow">return</span>(0);</div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;}</div>
<div class="ttc" id="a00255_html_a3c10806b3d5a56f4d0e9d4607dafcffc"><div class="ttname"><a href="a00255.html#a3c10806b3d5a56f4d0e9d4607dafcffc">_ShallowWater1DRightEigenvectors_</a></div><div class="ttdeci">#define _ShallowWater1DRightEigenvectors_(u, R, p, dir)</div><div class="ttdef"><b>Definition:</b> <a href="a00255_source.html#l00117">shallowwater1d.h:117</a></div></div>
<div class="ttc" id="a00213_html"><div class="ttname"><a href="a00213.html">ShallowWater1D</a></div><div class="ttdoc">Structure containing variables and parameters specific to the 1D Shallow Water equations. This structure contains the physical parameters, variables, and function pointers specific to the 1D ShallowWater equations. </div><div class="ttdef"><b>Definition:</b> <a href="a00255_source.html#l00137">shallowwater1d.h:137</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a138e0a29442a4362e5542ab7eb8b0470"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ShallowWater1DTopography </td>
          <td>(</td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>s</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>m</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>idx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>nsims</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>dim_topo</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Set the bottom topography over the domain - reads the topography data from a file, if available, else sets it to a constant </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">s</td><td>Solver object of type <a class="el" href="a00202.html" title="Structure containing all solver-specific variables and functions. ">HyPar</a> </td></tr>
    <tr><td class="paramname">m</td><td>MPI object of type <a class="el" href="a00205.html#a00663" title="Structure of MPI-related variables. ">MPIVariables</a> </td></tr>
    <tr><td class="paramname">idx</td><td>Index of this simulation </td></tr>
    <tr><td class="paramname">nsims</td><td>Total number of simulations </td></tr>
    <tr><td class="paramname">dim_topo</td><td>Grid dimensions of the advection field stored in file </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="a00561_source.html#l00020">20</a> of file <a class="el" href="a00561_source.html">ShallowWater1DTopography.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;{</div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;  <a class="code" href="a00202.html">HyPar</a>          *solver = (<a class="code" href="a00202.html">HyPar</a>*) s;</div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;  <a class="code" href="a00205.html#a00663">MPIVariables</a>   *mpi    = (<a class="code" href="a00205.html#a00663">MPIVariables</a>*) m;</div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;  <a class="code" href="a00213.html">ShallowWater1D</a> *param  = (<a class="code" href="a00213.html">ShallowWater1D</a>*) solver-&gt;<a class="code" href="a00202.html#a48e81a1806b5774943fd9a26e9a190f2">physics</a>;</div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;  <span class="keywordtype">double</span>         *S      = param-&gt;<a class="code" href="a00213.html#a3374c235742374318e70b42a6aa09a82">b</a>;</div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;  <span class="keywordtype">int</span>            d, done, *dim = solver-&gt;<a class="code" href="a00202.html#a38e0371f331cecbe63a77fa03e202afe">dim_local</a>, </div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;                 ghosts = solver-&gt;<a class="code" href="a00202.html#aafc992b5fa79d5a4036024615d03bce6">ghosts</a>;</div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;  <a class="code" href="a00231.html#a68f50121fb9a7daeaf60e50cdef82ef3">_DECLARE_IERR_</a>;</div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;</div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;  <span class="keywordtype">char</span> fname_root[<a class="code" href="a00231.html#a51efea86a4d76d1259893f606b776573">_MAX_STRING_SIZE_</a>] = <span class="stringliteral">&quot;topography&quot;</span>;</div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;  if (idx &gt;= 0) {</div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;    <span class="keywordflow">if</span> (nsims &gt; 1) {</div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;      <span class="keywordtype">char</span> index[<a class="code" href="a00231.html#a51efea86a4d76d1259893f606b776573">_MAX_STRING_SIZE_</a>];</div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;      <a class="code" href="a00234.html#a3e3ad5aed581d9ae563190c365dadc41">GetStringFromInteger</a>(idx, index, (<span class="keywordtype">int</span>)log10(nsims)+1);</div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;      strcat(fname_root, <span class="stringliteral">&quot;_&quot;</span>);</div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;      strcat(fname_root, index);</div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;    }</div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;  }</div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;</div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;  <span class="comment">/* read topography from provided file, if available */</span></div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;  <span class="keywordflow">if</span> (dim_topo == NULL) {</div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;    <span class="keywordtype">int</span> ierr = <a class="code" href="a00239.html#afaf5b0d6e79b1e8674b397aebcb219dc">ReadArray</a>( solver-&gt;<a class="code" href="a00202.html#a484873c74138512e41bc50d17b7d955a">ndims</a>,</div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;                          1,</div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;                          solver-&gt;<a class="code" href="a00202.html#aa989ebb755986852177779cdf7bd8c85">dim_global</a>,</div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;                          solver-&gt;<a class="code" href="a00202.html#a38e0371f331cecbe63a77fa03e202afe">dim_local</a>,</div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;                          solver-&gt;<a class="code" href="a00202.html#aafc992b5fa79d5a4036024615d03bce6">ghosts</a>,</div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;                          solver,</div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;                          mpi,</div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;                          NULL,</div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;                          S,</div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;                          fname_root,</div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;                          &amp;param-&gt;<a class="code" href="a00213.html#a71b5cdadb8aec7421fa05a93ec51c102">topo_flag</a>);</div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;    <span class="keywordflow">if</span> (ierr) {</div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;      fprintf(stderr,<span class="stringliteral">&quot;Error in ShallowWater1DTopography()\n&quot;</span>);</div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;      fprintf(stderr,<span class="stringliteral">&quot;  ReadArray() returned error!\n&quot;</span>);</div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;      <span class="keywordflow">return</span> ierr;</div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;    }</div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;  } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;    <span class="keywordtype">int</span> ierr = <a class="code" href="a00239.html#ad0eb6700a70a6489148d41a48436da78">ReadArraywInterp</a>(  solver-&gt;<a class="code" href="a00202.html#a484873c74138512e41bc50d17b7d955a">ndims</a>,</div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;                                  1,</div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;                                  solver-&gt;<a class="code" href="a00202.html#aa989ebb755986852177779cdf7bd8c85">dim_global</a>,</div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;                                  solver-&gt;<a class="code" href="a00202.html#a38e0371f331cecbe63a77fa03e202afe">dim_local</a>,</div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;                                  dim_topo,</div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;                                  solver-&gt;<a class="code" href="a00202.html#aafc992b5fa79d5a4036024615d03bce6">ghosts</a>,</div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;                                  solver,</div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;                                  mpi,</div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;                                  NULL,</div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;                                  S,</div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;                                  fname_root,</div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;                                  &amp;param-&gt;<a class="code" href="a00213.html#a71b5cdadb8aec7421fa05a93ec51c102">topo_flag</a>);</div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;    <span class="keywordflow">if</span> (ierr) {</div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;      fprintf(stderr,<span class="stringliteral">&quot;Error in ShallowWater1DTopography()\n&quot;</span>);</div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;      fprintf(stderr,<span class="stringliteral">&quot;  ReadArraywInterp() returned error!\n&quot;</span>);</div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;      <span class="keywordflow">return</span> ierr;</div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;    }</div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;  }</div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;</div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;  <span class="keywordflow">if</span> (!param-&gt;<a class="code" href="a00213.html#a71b5cdadb8aec7421fa05a93ec51c102">topo_flag</a>) {</div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;    <span class="comment">/* if topography file not available, set it to zero */</span></div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;    <a class="code" href="a00229.html#a2b2826031c0cd92495ab351d3e599fc5">_ArraySetValue_</a>(S,solver-&gt;<a class="code" href="a00202.html#a20ee1fd00a220b98513127884a5558cf">npoints_local_wghosts</a>,0.0);</div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;  }</div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;</div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;  <span class="comment">/* if parallel, exchange MPI-boundary ghost point data */</span></div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;  <a class="code" href="a00231.html#ad6ab74942c9de13cf0b4c12eb0d91780">IERR</a> <a class="code" href="a00248.html#a60ace5964c051fa481e6a1e6f1ef75d7">MPIExchangeBoundariesnD</a>(<a class="code" href="a00251.html#a57771c952ec174601addf43e1c0202b2">_MODEL_NDIMS_</a>,1,solver-&gt;<a class="code" href="a00202.html#a38e0371f331cecbe63a77fa03e202afe">dim_local</a>,</div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;                                solver-&gt;<a class="code" href="a00202.html#aafc992b5fa79d5a4036024615d03bce6">ghosts</a>,mpi,S); <a class="code" href="a00231.html#add9cf96ae374934d245a1dc1ab697a42">CHECKERR</a>(ierr);</div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;</div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;</div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;  <span class="keywordflow">if</span> (param-&gt;<a class="code" href="a00213.html#a6f84a1093abf57dcbf0406b33f40f766">bt_type</a>) {</div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;    <span class="comment">/* if topography is periodic, then the overall problem must also be periodic</span></div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;<span class="comment">       (i.e. boundary conditions will be specified as periodic). Hence, </span></div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;<span class="comment">       MPIExchangeBoundariesnD() will take care of setting the ghosts points </span></div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;<span class="comment">       for multi-processor simulations. For single processor, set the ghost</span></div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;<span class="comment">       points accordingly. */</span></div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;    <span class="keywordtype">int</span> indexb[<a class="code" href="a00251.html#a57771c952ec174601addf43e1c0202b2">_MODEL_NDIMS_</a>], indexi[<a class="code" href="a00251.html#a57771c952ec174601addf43e1c0202b2">_MODEL_NDIMS_</a>], bounds[<a class="code" href="a00251.html#a57771c952ec174601addf43e1c0202b2">_MODEL_NDIMS_</a>], </div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;        offset[<a class="code" href="a00251.html#a57771c952ec174601addf43e1c0202b2">_MODEL_NDIMS_</a>];</div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;    <span class="keywordflow">for</span> (d = 0; d &lt; <a class="code" href="a00251.html#a57771c952ec174601addf43e1c0202b2">_MODEL_NDIMS_</a>; d++) {</div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;      <span class="keywordflow">if</span> (mpi-&gt;<a class="code" href="a00205.html#a0be0f30a83bc3f3d9f6ee3a36bbf2716">iproc</a>[d] == 1) {</div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;        <a class="code" href="a00229.html#a89e8330d9e06dd0666c50833628a125c">_ArrayCopy1D_</a>(dim,bounds,_MODEL_NDIMS_); bounds[d] = ghosts;</div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;        <span class="comment">/* left boundary */</span></div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;        done = 0; <a class="code" href="a00229.html#a2b2826031c0cd92495ab351d3e599fc5">_ArraySetValue_</a>(indexb,_MODEL_NDIMS_,0);</div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;        <a class="code" href="a00229.html#a2b2826031c0cd92495ab351d3e599fc5">_ArraySetValue_</a>(offset,_MODEL_NDIMS_,0); offset[d] = -ghosts;</div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;        <span class="keywordflow">while</span> (!done) {</div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;          <a class="code" href="a00229.html#a89e8330d9e06dd0666c50833628a125c">_ArrayCopy1D_</a>(indexb,indexi,_MODEL_NDIMS_); indexi[d] = indexb[d] + dim[d] - ghosts;</div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;          <span class="keywordtype">int</span> p1; <a class="code" href="a00229.html#a0739cb538f4d301fad3b45059ddd0738">_ArrayIndex1DWO_</a>(_MODEL_NDIMS_,dim,indexb,offset,ghosts,p1);</div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;          <span class="keywordtype">int</span> p2; <a class="code" href="a00229.html#afbb862a2fdf5b72b1f9ace42f64b556f">_ArrayIndex1D_</a>  (_MODEL_NDIMS_,dim,indexi,ghosts,p2);</div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;          S[p1] = S[p2];</div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;          <a class="code" href="a00229.html#ac5ec1371623f11d03b0f42adaa24acbc">_ArrayIncrementIndex_</a>(_MODEL_NDIMS_,bounds,indexb,done);</div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;        }</div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;        <span class="comment">/* right boundary */</span></div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;        done = 0; <a class="code" href="a00229.html#a2b2826031c0cd92495ab351d3e599fc5">_ArraySetValue_</a>(indexb,_MODEL_NDIMS_,0);</div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;        <a class="code" href="a00229.html#a2b2826031c0cd92495ab351d3e599fc5">_ArraySetValue_</a>(offset,_MODEL_NDIMS_,0); offset[d] = dim[d];</div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;        <span class="keywordflow">while</span> (!done) {</div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;          <a class="code" href="a00229.html#a89e8330d9e06dd0666c50833628a125c">_ArrayCopy1D_</a>(indexb,indexi,_MODEL_NDIMS_);</div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;          <span class="keywordtype">int</span> p1; <a class="code" href="a00229.html#a0739cb538f4d301fad3b45059ddd0738">_ArrayIndex1DWO_</a>(_MODEL_NDIMS_,dim,indexb,offset,ghosts,p1);</div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;          <span class="keywordtype">int</span> p2; <a class="code" href="a00229.html#afbb862a2fdf5b72b1f9ace42f64b556f">_ArrayIndex1D_</a>  (_MODEL_NDIMS_,dim,indexi,ghosts,p2);</div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;          S[p1] = S[p2];</div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;          <a class="code" href="a00229.html#ac5ec1371623f11d03b0f42adaa24acbc">_ArrayIncrementIndex_</a>(_MODEL_NDIMS_,bounds,indexb,done);</div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;        }</div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;      }</div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;    }</div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;  } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;    <span class="comment">/* if topography is not periodic, extrapolate it at the boundaries */</span></div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;    <span class="keywordtype">int</span> indexb[<a class="code" href="a00251.html#a57771c952ec174601addf43e1c0202b2">_MODEL_NDIMS_</a>], indexi[<a class="code" href="a00251.html#a57771c952ec174601addf43e1c0202b2">_MODEL_NDIMS_</a>], bounds[<a class="code" href="a00251.html#a57771c952ec174601addf43e1c0202b2">_MODEL_NDIMS_</a>], </div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;        offset[<a class="code" href="a00251.html#a57771c952ec174601addf43e1c0202b2">_MODEL_NDIMS_</a>];</div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;    <span class="keywordflow">for</span> (d = 0; d &lt; <a class="code" href="a00251.html#a57771c952ec174601addf43e1c0202b2">_MODEL_NDIMS_</a>; d++) {</div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;      <span class="comment">/* left boundary */</span></div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;      <span class="keywordflow">if</span> (!mpi-&gt;<a class="code" href="a00205.html#aa3c28612a64b8a97bde66b720e15c700">ip</a>[d]) {</div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;        <a class="code" href="a00229.html#a89e8330d9e06dd0666c50833628a125c">_ArrayCopy1D_</a>(dim,bounds,_MODEL_NDIMS_); bounds[d] = ghosts;</div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;        <a class="code" href="a00229.html#a2b2826031c0cd92495ab351d3e599fc5">_ArraySetValue_</a>(offset,_MODEL_NDIMS_,0); offset[d] = -ghosts;</div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;        done = 0; <a class="code" href="a00229.html#a2b2826031c0cd92495ab351d3e599fc5">_ArraySetValue_</a>(indexb,_MODEL_NDIMS_,0);</div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;        <span class="keywordflow">while</span> (!done) {</div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;          <a class="code" href="a00229.html#a89e8330d9e06dd0666c50833628a125c">_ArrayCopy1D_</a>(indexb,indexi,_MODEL_NDIMS_); indexi[d] = ghosts-1-indexb[d];</div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;          <span class="keywordtype">int</span> p1; <a class="code" href="a00229.html#a0739cb538f4d301fad3b45059ddd0738">_ArrayIndex1DWO_</a>(_MODEL_NDIMS_,dim,indexb,offset,ghosts,p1);</div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;          <span class="keywordtype">int</span> p2; <a class="code" href="a00229.html#afbb862a2fdf5b72b1f9ace42f64b556f">_ArrayIndex1D_</a>  (_MODEL_NDIMS_,dim,indexi,ghosts,p2);</div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;          S[p1] = S[p2];</div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;          <a class="code" href="a00229.html#ac5ec1371623f11d03b0f42adaa24acbc">_ArrayIncrementIndex_</a>(_MODEL_NDIMS_,bounds,indexb,done);</div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;        }</div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;      }</div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;      <span class="comment">/* right boundary */</span></div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;      <span class="keywordflow">if</span> (mpi-&gt;<a class="code" href="a00205.html#aa3c28612a64b8a97bde66b720e15c700">ip</a>[d] == mpi-&gt;<a class="code" href="a00205.html#a0be0f30a83bc3f3d9f6ee3a36bbf2716">iproc</a>[d]-1) {</div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;        <a class="code" href="a00229.html#a89e8330d9e06dd0666c50833628a125c">_ArrayCopy1D_</a>(dim,bounds,_MODEL_NDIMS_); bounds[d] = ghosts;</div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;        <a class="code" href="a00229.html#a2b2826031c0cd92495ab351d3e599fc5">_ArraySetValue_</a>(offset,_MODEL_NDIMS_,0); offset[d] = dim[d];</div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;        done = 0; <a class="code" href="a00229.html#a2b2826031c0cd92495ab351d3e599fc5">_ArraySetValue_</a>(indexb,_MODEL_NDIMS_,0);</div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;        <span class="keywordflow">while</span> (!done) {</div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;          <a class="code" href="a00229.html#a89e8330d9e06dd0666c50833628a125c">_ArrayCopy1D_</a>(indexb,indexi,_MODEL_NDIMS_); indexi[d] = dim[d]-1-indexb[d];</div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;          <span class="keywordtype">int</span> p1; <a class="code" href="a00229.html#a0739cb538f4d301fad3b45059ddd0738">_ArrayIndex1DWO_</a>(_MODEL_NDIMS_,dim,indexb,offset,ghosts,p1);</div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;          <span class="keywordtype">int</span> p2; <a class="code" href="a00229.html#afbb862a2fdf5b72b1f9ace42f64b556f">_ArrayIndex1D_</a>  (_MODEL_NDIMS_,dim,indexi,ghosts,p2);</div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;          S[p1] = S[p2];</div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;          <a class="code" href="a00229.html#ac5ec1371623f11d03b0f42adaa24acbc">_ArrayIncrementIndex_</a>(_MODEL_NDIMS_,bounds,indexb,done);</div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;        }</div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;      }</div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;    }</div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;  }</div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;</div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;  <span class="keywordflow">return</span>(0);</div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;}</div>
<div class="ttc" id="a00229_html_a2b2826031c0cd92495ab351d3e599fc5"><div class="ttname"><a href="a00229.html#a2b2826031c0cd92495ab351d3e599fc5">_ArraySetValue_</a></div><div class="ttdeci">#define _ArraySetValue_(x, size, value)</div><div class="ttdef"><b>Definition:</b> <a href="a00229_source.html#l00169">arrayfunctions.h:169</a></div></div>
<div class="ttc" id="a00248_html_a60ace5964c051fa481e6a1e6f1ef75d7"><div class="ttname"><a href="a00248.html#a60ace5964c051fa481e6a1e6f1ef75d7">MPIExchangeBoundariesnD</a></div><div class="ttdeci">int MPIExchangeBoundariesnD(int, int, int *, int, void *, double *)</div><div class="ttdef"><b>Definition:</b> <a href="a00383_source.html#l00042">MPIExchangeBoundariesnD.c:42</a></div></div>
<div class="ttc" id="a00234_html_a3e3ad5aed581d9ae563190c365dadc41"><div class="ttname"><a href="a00234.html#a3e3ad5aed581d9ae563190c365dadc41">GetStringFromInteger</a></div><div class="ttdeci">void GetStringFromInteger(int, char *, int)</div><div class="ttdef"><b>Definition:</b> <a href="a00296_source.html#l00015">CommonFunctions.c:15</a></div></div>
<div class="ttc" id="a00251_html_a57771c952ec174601addf43e1c0202b2"><div class="ttname"><a href="a00251.html#a57771c952ec174601addf43e1c0202b2">_MODEL_NDIMS_</a></div><div class="ttdeci">#define _MODEL_NDIMS_</div><div class="ttdef"><b>Definition:</b> <a href="a00251_source.html#l00056">euler1d.h:56</a></div></div>
<div class="ttc" id="a00229_html_afbb862a2fdf5b72b1f9ace42f64b556f"><div class="ttname"><a href="a00229.html#afbb862a2fdf5b72b1f9ace42f64b556f">_ArrayIndex1D_</a></div><div class="ttdeci">#define _ArrayIndex1D_(N, imax, i, ghost, index)</div><div class="ttdef"><b>Definition:</b> <a href="a00229_source.html#l00040">arrayfunctions.h:40</a></div></div>
<div class="ttc" id="a00229_html_a89e8330d9e06dd0666c50833628a125c"><div class="ttname"><a href="a00229.html#a89e8330d9e06dd0666c50833628a125c">_ArrayCopy1D_</a></div><div class="ttdeci">#define _ArrayCopy1D_(x, y, size)</div><div class="ttdef"><b>Definition:</b> <a href="a00229_source.html#l00319">arrayfunctions.h:319</a></div></div>
<div class="ttc" id="a00202_html_aa989ebb755986852177779cdf7bd8c85"><div class="ttname"><a href="a00202.html#aa989ebb755986852177779cdf7bd8c85">HyPar::dim_global</a></div><div class="ttdeci">int * dim_global</div><div class="ttdef"><b>Definition:</b> <a href="a00238_source.html#l00033">hypar.h:33</a></div></div>
<div class="ttc" id="a00231_html_a68f50121fb9a7daeaf60e50cdef82ef3"><div class="ttname"><a href="a00231.html#a68f50121fb9a7daeaf60e50cdef82ef3">_DECLARE_IERR_</a></div><div class="ttdeci">#define _DECLARE_IERR_</div><div class="ttdef"><b>Definition:</b> <a href="a00231_source.html#l00017">basic.h:17</a></div></div>
<div class="ttc" id="a00239_html_afaf5b0d6e79b1e8674b397aebcb219dc"><div class="ttname"><a href="a00239.html#afaf5b0d6e79b1e8674b397aebcb219dc">ReadArray</a></div><div class="ttdeci">int ReadArray(int, int, int *, int *, int, void *, void *, double *, double *, char *, int *)</div><div class="ttdef"><b>Definition:</b> <a href="a00364_source.html#l00025">ReadArray.c:25</a></div></div>
<div class="ttc" id="a00202_html_a48e81a1806b5774943fd9a26e9a190f2"><div class="ttname"><a href="a00202.html#a48e81a1806b5774943fd9a26e9a190f2">HyPar::physics</a></div><div class="ttdeci">void * physics</div><div class="ttdef"><b>Definition:</b> <a href="a00238_source.html#l00261">hypar.h:261</a></div></div>
<div class="ttc" id="a00213_html_a71b5cdadb8aec7421fa05a93ec51c102"><div class="ttname"><a href="a00213.html#a71b5cdadb8aec7421fa05a93ec51c102">ShallowWater1D::topo_flag</a></div><div class="ttdeci">int topo_flag</div><div class="ttdef"><b>Definition:</b> <a href="a00255_source.html#l00139">shallowwater1d.h:139</a></div></div>
<div class="ttc" id="a00202_html_a484873c74138512e41bc50d17b7d955a"><div class="ttname"><a href="a00202.html#a484873c74138512e41bc50d17b7d955a">HyPar::ndims</a></div><div class="ttdeci">int ndims</div><div class="ttdef"><b>Definition:</b> <a href="a00238_source.html#l00026">hypar.h:26</a></div></div>
<div class="ttc" id="a00231_html_ad6ab74942c9de13cf0b4c12eb0d91780"><div class="ttname"><a href="a00231.html#ad6ab74942c9de13cf0b4c12eb0d91780">IERR</a></div><div class="ttdeci">#define IERR</div><div class="ttdef"><b>Definition:</b> <a href="a00231_source.html#l00016">basic.h:16</a></div></div>
<div class="ttc" id="a00202_html_a38e0371f331cecbe63a77fa03e202afe"><div class="ttname"><a href="a00202.html#a38e0371f331cecbe63a77fa03e202afe">HyPar::dim_local</a></div><div class="ttdeci">int * dim_local</div><div class="ttdef"><b>Definition:</b> <a href="a00238_source.html#l00037">hypar.h:37</a></div></div>
<div class="ttc" id="a00202_html_aafc992b5fa79d5a4036024615d03bce6"><div class="ttname"><a href="a00202.html#aafc992b5fa79d5a4036024615d03bce6">HyPar::ghosts</a></div><div class="ttdeci">int ghosts</div><div class="ttdef"><b>Definition:</b> <a href="a00238_source.html#l00052">hypar.h:52</a></div></div>
<div class="ttc" id="a00202_html_a20ee1fd00a220b98513127884a5558cf"><div class="ttname"><a href="a00202.html#a20ee1fd00a220b98513127884a5558cf">HyPar::npoints_local_wghosts</a></div><div class="ttdeci">int npoints_local_wghosts</div><div class="ttdef"><b>Definition:</b> <a href="a00238_source.html#l00042">hypar.h:42</a></div></div>
<div class="ttc" id="a00231_html_add9cf96ae374934d245a1dc1ab697a42"><div class="ttname"><a href="a00231.html#add9cf96ae374934d245a1dc1ab697a42">CHECKERR</a></div><div class="ttdeci">#define CHECKERR(ierr)</div><div class="ttdef"><b>Definition:</b> <a href="a00231_source.html#l00018">basic.h:18</a></div></div>
<div class="ttc" id="a00213_html_a3374c235742374318e70b42a6aa09a82"><div class="ttname"><a href="a00213.html#a3374c235742374318e70b42a6aa09a82">ShallowWater1D::b</a></div><div class="ttdeci">double * b</div><div class="ttdef"><b>Definition:</b> <a href="a00255_source.html#l00141">shallowwater1d.h:141</a></div></div>
<div class="ttc" id="a00205_html_a00663"><div class="ttname"><a href="a00205.html#a00663">MPIVariables</a></div><div class="ttdoc">Structure of MPI-related variables. </div><div class="ttdef"><b>Definition:</b> <a href="a00205_source.html#l00024">mpivars_struct.h:24</a></div></div>
<div class="ttc" id="a00205_html_a0be0f30a83bc3f3d9f6ee3a36bbf2716"><div class="ttname"><a href="a00205.html#a0be0f30a83bc3f3d9f6ee3a36bbf2716">MPIVariables::iproc</a></div><div class="ttdeci">int * iproc</div><div class="ttdef"><b>Definition:</b> <a href="a00205_source.html#l00027">mpivars_struct.h:27</a></div></div>
<div class="ttc" id="a00213_html"><div class="ttname"><a href="a00213.html">ShallowWater1D</a></div><div class="ttdoc">Structure containing variables and parameters specific to the 1D Shallow Water equations. This structure contains the physical parameters, variables, and function pointers specific to the 1D ShallowWater equations. </div><div class="ttdef"><b>Definition:</b> <a href="a00255_source.html#l00137">shallowwater1d.h:137</a></div></div>
<div class="ttc" id="a00231_html_a51efea86a4d76d1259893f606b776573"><div class="ttname"><a href="a00231.html#a51efea86a4d76d1259893f606b776573">_MAX_STRING_SIZE_</a></div><div class="ttdeci">#define _MAX_STRING_SIZE_</div><div class="ttdef"><b>Definition:</b> <a href="a00231_source.html#l00014">basic.h:14</a></div></div>
<div class="ttc" id="a00239_html_ad0eb6700a70a6489148d41a48436da78"><div class="ttname"><a href="a00239.html#ad0eb6700a70a6489148d41a48436da78">ReadArraywInterp</a></div><div class="ttdeci">int ReadArraywInterp(int, int, int *, int *, int *, int, void *, void *, double *, double *, char *, int *)</div><div class="ttdef"><b>Definition:</b> <a href="a00365_source.html#l00028">ReadArraywInterp.c:28</a></div></div>
<div class="ttc" id="a00229_html_a0739cb538f4d301fad3b45059ddd0738"><div class="ttname"><a href="a00229.html#a0739cb538f4d301fad3b45059ddd0738">_ArrayIndex1DWO_</a></div><div class="ttdeci">#define _ArrayIndex1DWO_(N, imax, i, offset, ghost, index)</div><div class="ttdef"><b>Definition:</b> <a href="a00229_source.html#l00083">arrayfunctions.h:83</a></div></div>
<div class="ttc" id="a00229_html_ac5ec1371623f11d03b0f42adaa24acbc"><div class="ttname"><a href="a00229.html#ac5ec1371623f11d03b0f42adaa24acbc">_ArrayIncrementIndex_</a></div><div class="ttdeci">#define _ArrayIncrementIndex_(N, imax, i, done)</div><div class="ttdef"><b>Definition:</b> <a href="a00229_source.html#l00126">arrayfunctions.h:126</a></div></div>
<div class="ttc" id="a00213_html_a6f84a1093abf57dcbf0406b33f40f766"><div class="ttname"><a href="a00213.html#a6f84a1093abf57dcbf0406b33f40f766">ShallowWater1D::bt_type</a></div><div class="ttdeci">int bt_type</div><div class="ttdef"><b>Definition:</b> <a href="a00255_source.html#l00139">shallowwater1d.h:139</a></div></div>
<div class="ttc" id="a00205_html_aa3c28612a64b8a97bde66b720e15c700"><div class="ttname"><a href="a00205.html#aa3c28612a64b8a97bde66b720e15c700">MPIVariables::ip</a></div><div class="ttdeci">int * ip</div><div class="ttdef"><b>Definition:</b> <a href="a00205_source.html#l00028">mpivars_struct.h:28</a></div></div>
<div class="ttc" id="a00202_html"><div class="ttname"><a href="a00202.html">HyPar</a></div><div class="ttdoc">Structure containing all solver-specific variables and functions. </div><div class="ttdef"><b>Definition:</b> <a href="a00238_source.html#l00023">hypar.h:23</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="aa3666c7f9bc8c5186fa29fa276d37f0d"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ShallowWater1DSourceUpwindLLF </td>
          <td>(</td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>fI</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>fL</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>fR</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>u</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>dir</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>s</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>t</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Compute the "upwind" source term in the balanced formulation introduced in the reference below. The "upwind" state is just the arithmetic average of the left and right states.</p>
<ul>
<li>Xing, Y., Shu, C.-W., "High order finite difference WENO schemes with the
  exact conservation property for the shallow water equations", Journal of Computational Physics, 208, 2005, pp. 206-227. <a href="http://dx.doi.org/10.1016/j.jcp.2005.02.006">http://dx.doi.org/10.1016/j.jcp.2005.02.006</a> </li>
</ul>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">fI</td><td>Computed interface source term ("upwinded") </td></tr>
    <tr><td class="paramname">fL</td><td>Left-biased interface source term </td></tr>
    <tr><td class="paramname">fR</td><td>Right-biased interface source term </td></tr>
    <tr><td class="paramname">u</td><td>Solution (conserved variables) </td></tr>
    <tr><td class="paramname">dir</td><td>Spatial dimension (unused since this is a 1D case) </td></tr>
    <tr><td class="paramname">s</td><td>Solver object of type <a class="el" href="a00202.html" title="Structure containing all solver-specific variables and functions. ">HyPar</a> </td></tr>
    <tr><td class="paramname">t</td><td>Current solution time </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="a00560_source.html#l00022">22</a> of file <a class="el" href="a00560_source.html">ShallowWater1DSourceUpwind.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;{</div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;  <a class="code" href="a00202.html">HyPar</a>     *solver = (<a class="code" href="a00202.html">HyPar</a>*)    s;</div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;  <span class="keywordtype">int</span>       done,k;</div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;</div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;  <span class="keywordtype">int</span> ndims = solver-&gt;<a class="code" href="a00202.html#a484873c74138512e41bc50d17b7d955a">ndims</a>;</div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;  <span class="keywordtype">int</span> *dim  = solver-&gt;<a class="code" href="a00202.html#a38e0371f331cecbe63a77fa03e202afe">dim_local</a>;</div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;</div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;  <span class="keywordtype">int</span> index_outer[ndims], index_inter[ndims], bounds_outer[ndims], bounds_inter[ndims];</div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;  <a class="code" href="a00229.html#a89e8330d9e06dd0666c50833628a125c">_ArrayCopy1D_</a>(dim,bounds_outer,ndims); bounds_outer[dir] =  1;</div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;  <a class="code" href="a00229.html#a89e8330d9e06dd0666c50833628a125c">_ArrayCopy1D_</a>(dim,bounds_inter,ndims); bounds_inter[dir] += 1;</div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;</div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;  done = 0; <a class="code" href="a00229.html#a2b2826031c0cd92495ab351d3e599fc5">_ArraySetValue_</a>(index_outer,ndims,0);</div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;  <span class="keywordflow">while</span> (!done) {</div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;    <a class="code" href="a00229.html#a89e8330d9e06dd0666c50833628a125c">_ArrayCopy1D_</a>(index_outer,index_inter,ndims);</div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;    <span class="keywordflow">for</span> (index_inter[dir] = 0; index_inter[dir] &lt; bounds_inter[dir]; index_inter[dir]++) {</div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;      <span class="keywordtype">int</span> p;  <a class="code" href="a00229.html#afbb862a2fdf5b72b1f9ace42f64b556f">_ArrayIndex1D_</a>(ndims,bounds_inter,index_inter,0,p);</div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;      <span class="keywordflow">for</span> (k = 0; k &lt; <a class="code" href="a00251.html#ad3395a55a5fde64d6603c7a82d7bf2c7">_MODEL_NVARS_</a>; k++) </div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;        (fI+_MODEL_NVARS_*p)[k] = 0.5 * ((fL+_MODEL_NVARS_*p)[k] + (fR+_MODEL_NVARS_*p)[k]);</div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;    }</div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;    <a class="code" href="a00229.html#ac5ec1371623f11d03b0f42adaa24acbc">_ArrayIncrementIndex_</a>(ndims,bounds_outer,index_outer,done);</div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;  }</div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;</div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;  <span class="keywordflow">return</span>(0);</div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;}</div>
<div class="ttc" id="a00229_html_a2b2826031c0cd92495ab351d3e599fc5"><div class="ttname"><a href="a00229.html#a2b2826031c0cd92495ab351d3e599fc5">_ArraySetValue_</a></div><div class="ttdeci">#define _ArraySetValue_(x, size, value)</div><div class="ttdef"><b>Definition:</b> <a href="a00229_source.html#l00169">arrayfunctions.h:169</a></div></div>
<div class="ttc" id="a00229_html_afbb862a2fdf5b72b1f9ace42f64b556f"><div class="ttname"><a href="a00229.html#afbb862a2fdf5b72b1f9ace42f64b556f">_ArrayIndex1D_</a></div><div class="ttdeci">#define _ArrayIndex1D_(N, imax, i, ghost, index)</div><div class="ttdef"><b>Definition:</b> <a href="a00229_source.html#l00040">arrayfunctions.h:40</a></div></div>
<div class="ttc" id="a00229_html_a89e8330d9e06dd0666c50833628a125c"><div class="ttname"><a href="a00229.html#a89e8330d9e06dd0666c50833628a125c">_ArrayCopy1D_</a></div><div class="ttdeci">#define _ArrayCopy1D_(x, y, size)</div><div class="ttdef"><b>Definition:</b> <a href="a00229_source.html#l00319">arrayfunctions.h:319</a></div></div>
<div class="ttc" id="a00251_html_ad3395a55a5fde64d6603c7a82d7bf2c7"><div class="ttname"><a href="a00251.html#ad3395a55a5fde64d6603c7a82d7bf2c7">_MODEL_NVARS_</a></div><div class="ttdeci">#define _MODEL_NVARS_</div><div class="ttdef"><b>Definition:</b> <a href="a00251_source.html#l00058">euler1d.h:58</a></div></div>
<div class="ttc" id="a00202_html_a484873c74138512e41bc50d17b7d955a"><div class="ttname"><a href="a00202.html#a484873c74138512e41bc50d17b7d955a">HyPar::ndims</a></div><div class="ttdeci">int ndims</div><div class="ttdef"><b>Definition:</b> <a href="a00238_source.html#l00026">hypar.h:26</a></div></div>
<div class="ttc" id="a00202_html_a38e0371f331cecbe63a77fa03e202afe"><div class="ttname"><a href="a00202.html#a38e0371f331cecbe63a77fa03e202afe">HyPar::dim_local</a></div><div class="ttdeci">int * dim_local</div><div class="ttdef"><b>Definition:</b> <a href="a00238_source.html#l00037">hypar.h:37</a></div></div>
<div class="ttc" id="a00229_html_ac5ec1371623f11d03b0f42adaa24acbc"><div class="ttname"><a href="a00229.html#ac5ec1371623f11d03b0f42adaa24acbc">_ArrayIncrementIndex_</a></div><div class="ttdeci">#define _ArrayIncrementIndex_(N, imax, i, done)</div><div class="ttdef"><b>Definition:</b> <a href="a00229_source.html#l00126">arrayfunctions.h:126</a></div></div>
<div class="ttc" id="a00202_html"><div class="ttname"><a href="a00202.html">HyPar</a></div><div class="ttdoc">Structure containing all solver-specific variables and functions. </div><div class="ttdef"><b>Definition:</b> <a href="a00238_source.html#l00023">hypar.h:23</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a1cc4010588279683914801de8595a306"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ShallowWater1DSourceUpwindRoe </td>
          <td>(</td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>fI</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>fL</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>fR</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>u</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>dir</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>s</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>t</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Compute the "upwind" source term in the balanced formulation introduced in the reference below. The "upwind" state is just the arithmetic average of the left and right states.</p>
<ul>
<li>Xing, Y., Shu, C.-W., "High order finite difference WENO schemes with the
  exact conservation property for the shallow water equations", Journal of Computational Physics, 208, 2005, pp. 206-227. <a href="http://dx.doi.org/10.1016/j.jcp.2005.02.006">http://dx.doi.org/10.1016/j.jcp.2005.02.006</a> </li>
</ul>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">fI</td><td>Computed interface source term ("upwinded") </td></tr>
    <tr><td class="paramname">fL</td><td>Left-biased interface source term </td></tr>
    <tr><td class="paramname">fR</td><td>Right-biased interface source term </td></tr>
    <tr><td class="paramname">u</td><td>Solution (conserved variables) </td></tr>
    <tr><td class="paramname">dir</td><td>Spatial dimension (unused since this is a 1D case) </td></tr>
    <tr><td class="paramname">s</td><td>Solver object of type <a class="el" href="a00202.html" title="Structure containing all solver-specific variables and functions. ">HyPar</a> </td></tr>
    <tr><td class="paramname">t</td><td>Current solution time </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="a00560_source.html#l00064">64</a> of file <a class="el" href="a00560_source.html">ShallowWater1DSourceUpwind.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;{</div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;  <a class="code" href="a00202.html">HyPar</a>     *solver = (<a class="code" href="a00202.html">HyPar</a>*)    s;</div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;  <span class="keywordtype">int</span>       done,k;</div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;</div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;  <span class="keywordtype">int</span> ndims = solver-&gt;<a class="code" href="a00202.html#a484873c74138512e41bc50d17b7d955a">ndims</a>;</div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;  <span class="keywordtype">int</span> *dim  = solver-&gt;<a class="code" href="a00202.html#a38e0371f331cecbe63a77fa03e202afe">dim_local</a>;</div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;</div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;  <span class="keywordtype">int</span> index_outer[ndims], index_inter[ndims], bounds_outer[ndims], bounds_inter[ndims];</div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;  <a class="code" href="a00229.html#a89e8330d9e06dd0666c50833628a125c">_ArrayCopy1D_</a>(dim,bounds_outer,ndims); bounds_outer[dir] =  1;</div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;  <a class="code" href="a00229.html#a89e8330d9e06dd0666c50833628a125c">_ArrayCopy1D_</a>(dim,bounds_inter,ndims); bounds_inter[dir] += 1;</div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;</div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;  done = 0; <a class="code" href="a00229.html#a2b2826031c0cd92495ab351d3e599fc5">_ArraySetValue_</a>(index_outer,ndims,0);</div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;  <span class="keywordflow">while</span> (!done) {</div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;    <a class="code" href="a00229.html#a89e8330d9e06dd0666c50833628a125c">_ArrayCopy1D_</a>(index_outer,index_inter,ndims);</div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;    <span class="keywordflow">for</span> (index_inter[dir] = 0; index_inter[dir] &lt; bounds_inter[dir]; index_inter[dir]++) {</div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;      <span class="keywordtype">int</span> p;  <a class="code" href="a00229.html#afbb862a2fdf5b72b1f9ace42f64b556f">_ArrayIndex1D_</a>(ndims,bounds_inter,index_inter,0,p);</div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;      <span class="keywordflow">for</span> (k = 0; k &lt; <a class="code" href="a00251.html#ad3395a55a5fde64d6603c7a82d7bf2c7">_MODEL_NVARS_</a>; k++) </div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;        (fI+_MODEL_NVARS_*p)[k] = 0.5 * ((fL+_MODEL_NVARS_*p)[k] + (fR+_MODEL_NVARS_*p)[k]);</div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;    }</div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;    <a class="code" href="a00229.html#ac5ec1371623f11d03b0f42adaa24acbc">_ArrayIncrementIndex_</a>(ndims,bounds_outer,index_outer,done);</div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;  }</div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;</div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;  <span class="keywordflow">return</span>(0);</div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;}</div>
<div class="ttc" id="a00229_html_a2b2826031c0cd92495ab351d3e599fc5"><div class="ttname"><a href="a00229.html#a2b2826031c0cd92495ab351d3e599fc5">_ArraySetValue_</a></div><div class="ttdeci">#define _ArraySetValue_(x, size, value)</div><div class="ttdef"><b>Definition:</b> <a href="a00229_source.html#l00169">arrayfunctions.h:169</a></div></div>
<div class="ttc" id="a00229_html_afbb862a2fdf5b72b1f9ace42f64b556f"><div class="ttname"><a href="a00229.html#afbb862a2fdf5b72b1f9ace42f64b556f">_ArrayIndex1D_</a></div><div class="ttdeci">#define _ArrayIndex1D_(N, imax, i, ghost, index)</div><div class="ttdef"><b>Definition:</b> <a href="a00229_source.html#l00040">arrayfunctions.h:40</a></div></div>
<div class="ttc" id="a00229_html_a89e8330d9e06dd0666c50833628a125c"><div class="ttname"><a href="a00229.html#a89e8330d9e06dd0666c50833628a125c">_ArrayCopy1D_</a></div><div class="ttdeci">#define _ArrayCopy1D_(x, y, size)</div><div class="ttdef"><b>Definition:</b> <a href="a00229_source.html#l00319">arrayfunctions.h:319</a></div></div>
<div class="ttc" id="a00251_html_ad3395a55a5fde64d6603c7a82d7bf2c7"><div class="ttname"><a href="a00251.html#ad3395a55a5fde64d6603c7a82d7bf2c7">_MODEL_NVARS_</a></div><div class="ttdeci">#define _MODEL_NVARS_</div><div class="ttdef"><b>Definition:</b> <a href="a00251_source.html#l00058">euler1d.h:58</a></div></div>
<div class="ttc" id="a00202_html_a484873c74138512e41bc50d17b7d955a"><div class="ttname"><a href="a00202.html#a484873c74138512e41bc50d17b7d955a">HyPar::ndims</a></div><div class="ttdeci">int ndims</div><div class="ttdef"><b>Definition:</b> <a href="a00238_source.html#l00026">hypar.h:26</a></div></div>
<div class="ttc" id="a00202_html_a38e0371f331cecbe63a77fa03e202afe"><div class="ttname"><a href="a00202.html#a38e0371f331cecbe63a77fa03e202afe">HyPar::dim_local</a></div><div class="ttdeci">int * dim_local</div><div class="ttdef"><b>Definition:</b> <a href="a00238_source.html#l00037">hypar.h:37</a></div></div>
<div class="ttc" id="a00229_html_ac5ec1371623f11d03b0f42adaa24acbc"><div class="ttname"><a href="a00229.html#ac5ec1371623f11d03b0f42adaa24acbc">_ArrayIncrementIndex_</a></div><div class="ttdeci">#define _ArrayIncrementIndex_(N, imax, i, done)</div><div class="ttdef"><b>Definition:</b> <a href="a00229_source.html#l00126">arrayfunctions.h:126</a></div></div>
<div class="ttc" id="a00202_html"><div class="ttname"><a href="a00202.html">HyPar</a></div><div class="ttdoc">Structure containing all solver-specific variables and functions. </div><div class="ttdef"><b>Definition:</b> <a href="a00238_source.html#l00023">hypar.h:23</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a17dd7e4115c7836a62018dbc5331d8c3"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ShallowWater1DModifiedSolution </td>
          <td>(</td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>uC</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>u</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>d</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>s</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>m</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>waqt</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Compute the modified solution for the upwinding step in a balanced conservative finite-difference algorithm for the 1D shallow water equations. <br/>
<br/>
Refer to:</p>
<ul>
<li>Xing, Y., Shu, C.-W., "High order finite difference WENO schemes with the
  exact conservation property for the shallow water equations", Journal of Computational Physics, 208, 2005, pp. 206-227. <a href="http://dx.doi.org/10.1016/j.jcp.2005.02.006">http://dx.doi.org/10.1016/j.jcp.2005.02.006</a> </li>
</ul>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">uC</td><td>The modified solution (same array size and layout as u) </td></tr>
    <tr><td class="paramname">u</td><td>The solution (conserved variables) </td></tr>
    <tr><td class="paramname">d</td><td>Spatial dimension (unused since this is a 1D system) </td></tr>
    <tr><td class="paramname">s</td><td>Solver object of type <a class="el" href="a00202.html" title="Structure containing all solver-specific variables and functions. ">HyPar</a> </td></tr>
    <tr><td class="paramname">m</td><td>MPI object of type <a class="el" href="a00205.html#a00663" title="Structure of MPI-related variables. ">MPIVariables</a> </td></tr>
    <tr><td class="paramname">waqt</td><td>Current solution time </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="a00558_source.html#l00021">21</a> of file <a class="el" href="a00558_source.html">ShallowWater1DModifiedSolution.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;{</div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;  <a class="code" href="a00202.html">HyPar</a>           *solver = (<a class="code" href="a00202.html">HyPar</a>*) s;</div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;  <a class="code" href="a00213.html">ShallowWater1D</a>  *param  = (<a class="code" href="a00213.html">ShallowWater1D</a>*) solver-&gt;<a class="code" href="a00202.html#a48e81a1806b5774943fd9a26e9a190f2">physics</a>;</div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;</div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;  <span class="keywordtype">int</span>     ghosts  = solver-&gt;<a class="code" href="a00202.html#aafc992b5fa79d5a4036024615d03bce6">ghosts</a>;</div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;  <span class="keywordtype">int</span>     *dim    = solver-&gt;<a class="code" href="a00202.html#a38e0371f331cecbe63a77fa03e202afe">dim_local</a>;</div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;  <span class="keywordtype">int</span>     ndims   = solver-&gt;<a class="code" href="a00202.html#a484873c74138512e41bc50d17b7d955a">ndims</a>;</div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;  <span class="keywordtype">int</span>     index[ndims], bounds[ndims], offset[ndims];</div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;</div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;  <span class="comment">/* set bounds for array index to include ghost points */</span></div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;  <a class="code" href="a00229.html#a89e8330d9e06dd0666c50833628a125c">_ArrayCopy1D_</a>(dim,bounds,ndims);</div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;  <span class="keywordtype">int</span> i; <span class="keywordflow">for</span> (i=0; i&lt;ndims; i++) bounds[i] += 2*ghosts;</div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;</div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;  <span class="comment">/* set offset such that index is compatible with ghost point arrangement */</span></div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;  <a class="code" href="a00229.html#a2b2826031c0cd92495ab351d3e599fc5">_ArraySetValue_</a>(offset,ndims,-ghosts);</div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;</div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;  <span class="keywordtype">int</span> done = 0; <a class="code" href="a00229.html#a2b2826031c0cd92495ab351d3e599fc5">_ArraySetValue_</a>(index,ndims,0);</div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;  <span class="keywordflow">while</span> (!done) {</div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;    <span class="keywordtype">int</span> p; <a class="code" href="a00229.html#a0739cb538f4d301fad3b45059ddd0738">_ArrayIndex1DWO_</a>(ndims,dim,index,offset,ghosts,p);</div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;    <span class="keywordtype">double</span> h,v;</div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;    <a class="code" href="a00255.html#ab6d0702f0bacbdb3f2644bd1f60938c0">_ShallowWater1DGetFlowVar_</a>((u+<a class="code" href="a00251.html#ad3395a55a5fde64d6603c7a82d7bf2c7">_MODEL_NVARS_</a>*p),h,v);</div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;    uC[<a class="code" href="a00251.html#ad3395a55a5fde64d6603c7a82d7bf2c7">_MODEL_NVARS_</a>*p+0] = h + param-&gt;<a class="code" href="a00213.html#a3374c235742374318e70b42a6aa09a82">b</a>[p];</div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;    uC[<a class="code" href="a00251.html#ad3395a55a5fde64d6603c7a82d7bf2c7">_MODEL_NVARS_</a>*p+1] = h * v;</div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;    <a class="code" href="a00229.html#ac5ec1371623f11d03b0f42adaa24acbc">_ArrayIncrementIndex_</a>(ndims,bounds,index,done);</div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;  }</div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;  <span class="keywordflow">return</span>(0);</div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;}</div>
<div class="ttc" id="a00229_html_a2b2826031c0cd92495ab351d3e599fc5"><div class="ttname"><a href="a00229.html#a2b2826031c0cd92495ab351d3e599fc5">_ArraySetValue_</a></div><div class="ttdeci">#define _ArraySetValue_(x, size, value)</div><div class="ttdef"><b>Definition:</b> <a href="a00229_source.html#l00169">arrayfunctions.h:169</a></div></div>
<div class="ttc" id="a00229_html_a89e8330d9e06dd0666c50833628a125c"><div class="ttname"><a href="a00229.html#a89e8330d9e06dd0666c50833628a125c">_ArrayCopy1D_</a></div><div class="ttdeci">#define _ArrayCopy1D_(x, y, size)</div><div class="ttdef"><b>Definition:</b> <a href="a00229_source.html#l00319">arrayfunctions.h:319</a></div></div>
<div class="ttc" id="a00202_html_a48e81a1806b5774943fd9a26e9a190f2"><div class="ttname"><a href="a00202.html#a48e81a1806b5774943fd9a26e9a190f2">HyPar::physics</a></div><div class="ttdeci">void * physics</div><div class="ttdef"><b>Definition:</b> <a href="a00238_source.html#l00261">hypar.h:261</a></div></div>
<div class="ttc" id="a00251_html_ad3395a55a5fde64d6603c7a82d7bf2c7"><div class="ttname"><a href="a00251.html#ad3395a55a5fde64d6603c7a82d7bf2c7">_MODEL_NVARS_</a></div><div class="ttdeci">#define _MODEL_NVARS_</div><div class="ttdef"><b>Definition:</b> <a href="a00251_source.html#l00058">euler1d.h:58</a></div></div>
<div class="ttc" id="a00202_html_a484873c74138512e41bc50d17b7d955a"><div class="ttname"><a href="a00202.html#a484873c74138512e41bc50d17b7d955a">HyPar::ndims</a></div><div class="ttdeci">int ndims</div><div class="ttdef"><b>Definition:</b> <a href="a00238_source.html#l00026">hypar.h:26</a></div></div>
<div class="ttc" id="a00202_html_a38e0371f331cecbe63a77fa03e202afe"><div class="ttname"><a href="a00202.html#a38e0371f331cecbe63a77fa03e202afe">HyPar::dim_local</a></div><div class="ttdeci">int * dim_local</div><div class="ttdef"><b>Definition:</b> <a href="a00238_source.html#l00037">hypar.h:37</a></div></div>
<div class="ttc" id="a00202_html_aafc992b5fa79d5a4036024615d03bce6"><div class="ttname"><a href="a00202.html#aafc992b5fa79d5a4036024615d03bce6">HyPar::ghosts</a></div><div class="ttdeci">int ghosts</div><div class="ttdef"><b>Definition:</b> <a href="a00238_source.html#l00052">hypar.h:52</a></div></div>
<div class="ttc" id="a00213_html_a3374c235742374318e70b42a6aa09a82"><div class="ttname"><a href="a00213.html#a3374c235742374318e70b42a6aa09a82">ShallowWater1D::b</a></div><div class="ttdeci">double * b</div><div class="ttdef"><b>Definition:</b> <a href="a00255_source.html#l00141">shallowwater1d.h:141</a></div></div>
<div class="ttc" id="a00213_html"><div class="ttname"><a href="a00213.html">ShallowWater1D</a></div><div class="ttdoc">Structure containing variables and parameters specific to the 1D Shallow Water equations. This structure contains the physical parameters, variables, and function pointers specific to the 1D ShallowWater equations. </div><div class="ttdef"><b>Definition:</b> <a href="a00255_source.html#l00137">shallowwater1d.h:137</a></div></div>
<div class="ttc" id="a00229_html_a0739cb538f4d301fad3b45059ddd0738"><div class="ttname"><a href="a00229.html#a0739cb538f4d301fad3b45059ddd0738">_ArrayIndex1DWO_</a></div><div class="ttdeci">#define _ArrayIndex1DWO_(N, imax, i, offset, ghost, index)</div><div class="ttdef"><b>Definition:</b> <a href="a00229_source.html#l00083">arrayfunctions.h:83</a></div></div>
<div class="ttc" id="a00229_html_ac5ec1371623f11d03b0f42adaa24acbc"><div class="ttname"><a href="a00229.html#ac5ec1371623f11d03b0f42adaa24acbc">_ArrayIncrementIndex_</a></div><div class="ttdeci">#define _ArrayIncrementIndex_(N, imax, i, done)</div><div class="ttdef"><b>Definition:</b> <a href="a00229_source.html#l00126">arrayfunctions.h:126</a></div></div>
<div class="ttc" id="a00255_html_ab6d0702f0bacbdb3f2644bd1f60938c0"><div class="ttname"><a href="a00255.html#ab6d0702f0bacbdb3f2644bd1f60938c0">_ShallowWater1DGetFlowVar_</a></div><div class="ttdeci">#define _ShallowWater1DGetFlowVar_(u, h, v)</div><div class="ttdef"><b>Definition:</b> <a href="a00255_source.html#l00054">shallowwater1d.h:54</a></div></div>
<div class="ttc" id="a00202_html"><div class="ttname"><a href="a00202.html">HyPar</a></div><div class="ttdoc">Structure containing all solver-specific variables and functions. </div><div class="ttdef"><b>Definition:</b> <a href="a00238_source.html#l00023">hypar.h:23</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a247a345bc636847dd5f5770373a6f56f"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ShallowWater1DWriteTopography </td>
          <td>(</td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>s</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>m</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Write out the topography data to file </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">s</td><td>Solver object of type <a class="el" href="a00202.html" title="Structure containing all solver-specific variables and functions. ">HyPar</a> </td></tr>
    <tr><td class="paramname">m</td><td>MPI object of type <a class="el" href="a00205.html#a00663" title="Structure of MPI-related variables. ">MPIVariables</a> </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="a00563_source.html#l00016">16</a> of file <a class="el" href="a00563_source.html">ShallowWater1DWriteTopography.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;{</div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;  <a class="code" href="a00202.html">HyPar</a>           *solver = (<a class="code" href="a00202.html">HyPar</a>*)          s;</div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;  <a class="code" href="a00205.html#a00663">MPIVariables</a>    *mpi    = (<a class="code" href="a00205.html#a00663">MPIVariables</a>*)   m;</div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;  <a class="code" href="a00213.html">ShallowWater1D</a>  *params = (<a class="code" href="a00213.html">ShallowWater1D</a>*) solver-&gt;<a class="code" href="a00202.html#a48e81a1806b5774943fd9a26e9a190f2">physics</a>;</div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;  <a class="code" href="a00231.html#a68f50121fb9a7daeaf60e50cdef82ef3">_DECLARE_IERR_</a>;</div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;</div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;  if (params-&gt;<a class="code" href="a00213.html#a71b5cdadb8aec7421fa05a93ec51c102">topo_flag</a>) {</div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;</div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;    <span class="keywordtype">char</span> fname_root[<a class="code" href="a00231.html#a51efea86a4d76d1259893f606b776573">_MAX_STRING_SIZE_</a>] = <span class="stringliteral">&quot;topography&quot;</span>;</div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;    <span class="keywordflow">if</span> (solver-&gt;<a class="code" href="a00202.html#a9a0e87291e0e8b9c1445e5482e814c92">nsims</a> &gt; 1) {</div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;      <span class="keywordtype">char</span> index[<a class="code" href="a00231.html#a51efea86a4d76d1259893f606b776573">_MAX_STRING_SIZE_</a>];</div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;      <a class="code" href="a00234.html#a3e3ad5aed581d9ae563190c365dadc41">GetStringFromInteger</a>(solver-&gt;<a class="code" href="a00202.html#a34488172a8ec6e0aaa03cbea46092d3a">my_idx</a>, index, (<span class="keywordtype">int</span>)log10(solver-&gt;<a class="code" href="a00202.html#a9a0e87291e0e8b9c1445e5482e814c92">nsims</a>)+1);</div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;      strcat(fname_root, <span class="stringliteral">&quot;_&quot;</span>);</div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;      strcat(fname_root, index);</div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;      strcat(fname_root, <span class="stringliteral">&quot;_&quot;</span>);</div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;    }</div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;</div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;    <a class="code" href="a00231.html#ad6ab74942c9de13cf0b4c12eb0d91780">IERR</a> <a class="code" href="a00239.html#aaf888c739c5200d9c58a7154347069b0">WriteArray</a>(  solver-&gt;<a class="code" href="a00202.html#a484873c74138512e41bc50d17b7d955a">ndims</a>,</div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;                      1,</div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;                      solver-&gt;<a class="code" href="a00202.html#aa989ebb755986852177779cdf7bd8c85">dim_global</a>,</div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;                      solver-&gt;<a class="code" href="a00202.html#a38e0371f331cecbe63a77fa03e202afe">dim_local</a>,</div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;                      solver-&gt;<a class="code" href="a00202.html#aafc992b5fa79d5a4036024615d03bce6">ghosts</a>,</div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;                      solver-&gt;<a class="code" href="a00202.html#a711aad4cbe735871dd9e91ab575c878b">x</a>,</div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;                      params-&gt;<a class="code" href="a00213.html#a3374c235742374318e70b42a6aa09a82">b</a>,</div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;                      solver,mpi,</div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;                      fname_root ); <a class="code" href="a00231.html#add9cf96ae374934d245a1dc1ab697a42">CHECKERR</a>(ierr);</div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;</div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;  }</div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;</div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;  <span class="keywordflow">return</span>(0);</div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;}</div>
<div class="ttc" id="a00234_html_a3e3ad5aed581d9ae563190c365dadc41"><div class="ttname"><a href="a00234.html#a3e3ad5aed581d9ae563190c365dadc41">GetStringFromInteger</a></div><div class="ttdeci">void GetStringFromInteger(int, char *, int)</div><div class="ttdef"><b>Definition:</b> <a href="a00296_source.html#l00015">CommonFunctions.c:15</a></div></div>
<div class="ttc" id="a00202_html_aa989ebb755986852177779cdf7bd8c85"><div class="ttname"><a href="a00202.html#aa989ebb755986852177779cdf7bd8c85">HyPar::dim_global</a></div><div class="ttdeci">int * dim_global</div><div class="ttdef"><b>Definition:</b> <a href="a00238_source.html#l00033">hypar.h:33</a></div></div>
<div class="ttc" id="a00231_html_a68f50121fb9a7daeaf60e50cdef82ef3"><div class="ttname"><a href="a00231.html#a68f50121fb9a7daeaf60e50cdef82ef3">_DECLARE_IERR_</a></div><div class="ttdeci">#define _DECLARE_IERR_</div><div class="ttdef"><b>Definition:</b> <a href="a00231_source.html#l00017">basic.h:17</a></div></div>
<div class="ttc" id="a00202_html_a48e81a1806b5774943fd9a26e9a190f2"><div class="ttname"><a href="a00202.html#a48e81a1806b5774943fd9a26e9a190f2">HyPar::physics</a></div><div class="ttdeci">void * physics</div><div class="ttdef"><b>Definition:</b> <a href="a00238_source.html#l00261">hypar.h:261</a></div></div>
<div class="ttc" id="a00213_html_a71b5cdadb8aec7421fa05a93ec51c102"><div class="ttname"><a href="a00213.html#a71b5cdadb8aec7421fa05a93ec51c102">ShallowWater1D::topo_flag</a></div><div class="ttdeci">int topo_flag</div><div class="ttdef"><b>Definition:</b> <a href="a00255_source.html#l00139">shallowwater1d.h:139</a></div></div>
<div class="ttc" id="a00202_html_a711aad4cbe735871dd9e91ab575c878b"><div class="ttname"><a href="a00202.html#a711aad4cbe735871dd9e91ab575c878b">HyPar::x</a></div><div class="ttdeci">double * x</div><div class="ttdef"><b>Definition:</b> <a href="a00238_source.html#l00107">hypar.h:107</a></div></div>
<div class="ttc" id="a00202_html_a484873c74138512e41bc50d17b7d955a"><div class="ttname"><a href="a00202.html#a484873c74138512e41bc50d17b7d955a">HyPar::ndims</a></div><div class="ttdeci">int ndims</div><div class="ttdef"><b>Definition:</b> <a href="a00238_source.html#l00026">hypar.h:26</a></div></div>
<div class="ttc" id="a00231_html_ad6ab74942c9de13cf0b4c12eb0d91780"><div class="ttname"><a href="a00231.html#ad6ab74942c9de13cf0b4c12eb0d91780">IERR</a></div><div class="ttdeci">#define IERR</div><div class="ttdef"><b>Definition:</b> <a href="a00231_source.html#l00016">basic.h:16</a></div></div>
<div class="ttc" id="a00202_html_a34488172a8ec6e0aaa03cbea46092d3a"><div class="ttname"><a href="a00202.html#a34488172a8ec6e0aaa03cbea46092d3a">HyPar::my_idx</a></div><div class="ttdeci">int my_idx</div><div class="ttdef"><b>Definition:</b> <a href="a00238_source.html#l00061">hypar.h:61</a></div></div>
<div class="ttc" id="a00202_html_a38e0371f331cecbe63a77fa03e202afe"><div class="ttname"><a href="a00202.html#a38e0371f331cecbe63a77fa03e202afe">HyPar::dim_local</a></div><div class="ttdeci">int * dim_local</div><div class="ttdef"><b>Definition:</b> <a href="a00238_source.html#l00037">hypar.h:37</a></div></div>
<div class="ttc" id="a00202_html_aafc992b5fa79d5a4036024615d03bce6"><div class="ttname"><a href="a00202.html#aafc992b5fa79d5a4036024615d03bce6">HyPar::ghosts</a></div><div class="ttdeci">int ghosts</div><div class="ttdef"><b>Definition:</b> <a href="a00238_source.html#l00052">hypar.h:52</a></div></div>
<div class="ttc" id="a00231_html_add9cf96ae374934d245a1dc1ab697a42"><div class="ttname"><a href="a00231.html#add9cf96ae374934d245a1dc1ab697a42">CHECKERR</a></div><div class="ttdeci">#define CHECKERR(ierr)</div><div class="ttdef"><b>Definition:</b> <a href="a00231_source.html#l00018">basic.h:18</a></div></div>
<div class="ttc" id="a00213_html_a3374c235742374318e70b42a6aa09a82"><div class="ttname"><a href="a00213.html#a3374c235742374318e70b42a6aa09a82">ShallowWater1D::b</a></div><div class="ttdeci">double * b</div><div class="ttdef"><b>Definition:</b> <a href="a00255_source.html#l00141">shallowwater1d.h:141</a></div></div>
<div class="ttc" id="a00202_html_a9a0e87291e0e8b9c1445e5482e814c92"><div class="ttname"><a href="a00202.html#a9a0e87291e0e8b9c1445e5482e814c92">HyPar::nsims</a></div><div class="ttdeci">int nsims</div><div class="ttdef"><b>Definition:</b> <a href="a00238_source.html#l00064">hypar.h:64</a></div></div>
<div class="ttc" id="a00205_html_a00663"><div class="ttname"><a href="a00205.html#a00663">MPIVariables</a></div><div class="ttdoc">Structure of MPI-related variables. </div><div class="ttdef"><b>Definition:</b> <a href="a00205_source.html#l00024">mpivars_struct.h:24</a></div></div>
<div class="ttc" id="a00213_html"><div class="ttname"><a href="a00213.html">ShallowWater1D</a></div><div class="ttdoc">Structure containing variables and parameters specific to the 1D Shallow Water equations. This structure contains the physical parameters, variables, and function pointers specific to the 1D ShallowWater equations. </div><div class="ttdef"><b>Definition:</b> <a href="a00255_source.html#l00137">shallowwater1d.h:137</a></div></div>
<div class="ttc" id="a00231_html_a51efea86a4d76d1259893f606b776573"><div class="ttname"><a href="a00231.html#a51efea86a4d76d1259893f606b776573">_MAX_STRING_SIZE_</a></div><div class="ttdeci">#define _MAX_STRING_SIZE_</div><div class="ttdef"><b>Definition:</b> <a href="a00231_source.html#l00014">basic.h:14</a></div></div>
<div class="ttc" id="a00239_html_aaf888c739c5200d9c58a7154347069b0"><div class="ttname"><a href="a00239.html#aaf888c739c5200d9c58a7154347069b0">WriteArray</a></div><div class="ttdeci">int WriteArray(int, int, int *, int *, int, double *, double *, void *, void *, char *)</div><div class="ttdef"><b>Definition:</b> <a href="a00366_source.html#l00027">WriteArray.c:27</a></div></div>
<div class="ttc" id="a00202_html"><div class="ttname"><a href="a00202.html">HyPar</a></div><div class="ttdoc">Structure containing all solver-specific variables and functions. </div><div class="ttdef"><b>Definition:</b> <a href="a00238_source.html#l00023">hypar.h:23</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a5f09926070a28319764e903b687681cc"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ShallowWater1DInitialize </td>
          <td>(</td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>s</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>m</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Function to initialize the 1D shallow water equations (<a class="el" href="a00213.html" title="Structure containing variables and parameters specific to the 1D Shallow Water equations. This structure contains the physical parameters, variables, and function pointers specific to the 1D ShallowWater equations. ">ShallowWater1D</a>) module: Sets the default parameters, read in and set physics-related parameters, and set the physics-related function pointers in <a class="el" href="a00202.html" title="Structure containing all solver-specific variables and functions. ">HyPar</a>. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">s</td><td>Solver object of type <a class="el" href="a00202.html" title="Structure containing all solver-specific variables and functions. ">HyPar</a> </td></tr>
    <tr><td class="paramname">m</td><td>Object of type <a class="el" href="a00205.html#a00663" title="Structure of MPI-related variables. ">MPIVariables</a> containing MPI-related info </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="a00556_source.html#l00037">37</a> of file <a class="el" href="a00556_source.html">ShallowWater1DInitialize.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;{</div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;  <a class="code" href="a00202.html">HyPar</a>           *solver  = (<a class="code" href="a00202.html">HyPar</a>*)         s;</div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;  <a class="code" href="a00205.html#a00663">MPIVariables</a>    *mpi     = (<a class="code" href="a00205.html#a00663">MPIVariables</a>*)  m; </div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;  <a class="code" href="a00213.html">ShallowWater1D</a>  *physics = (<a class="code" href="a00213.html">ShallowWater1D</a>*)       solver-&gt;<a class="code" href="a00202.html#a48e81a1806b5774943fd9a26e9a190f2">physics</a>;</div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;  <span class="keywordtype">int</span>             ferr, d;</div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;</div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;  <span class="keyword">static</span> <span class="keywordtype">int</span> count = 0;</div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;</div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;  if (solver-&gt;<a class="code" href="a00202.html#ae8f6d2fd6490d3153cb4133bf183a404">nvars</a> != <a class="code" href="a00251.html#ad3395a55a5fde64d6603c7a82d7bf2c7">_MODEL_NVARS_</a>) {</div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;    fprintf(stderr,<span class="stringliteral">&quot;Error in ShallowWater1DInitialize(): nvars has to be %d.\n&quot;</span>,<a class="code" href="a00251.html#ad3395a55a5fde64d6603c7a82d7bf2c7">_MODEL_NVARS_</a>);</div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;    <span class="keywordflow">return</span>(1);</div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;  }</div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;  <span class="keywordflow">if</span> (solver-&gt;<a class="code" href="a00202.html#a484873c74138512e41bc50d17b7d955a">ndims</a> != <a class="code" href="a00251.html#a57771c952ec174601addf43e1c0202b2">_MODEL_NDIMS_</a>) {</div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;    fprintf(stderr,<span class="stringliteral">&quot;Error in ShallowWater1DInitialize(): ndims has to be %d.\n&quot;</span>,<a class="code" href="a00251.html#a57771c952ec174601addf43e1c0202b2">_MODEL_NDIMS_</a>);</div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;    <span class="keywordflow">return</span>(1);</div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;  }</div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;</div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;  <span class="comment">/* default values */</span></div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;  physics-&gt;<a class="code" href="a00213.html#ab30c765b9be1b7776c97c899a12a66bb">g</a>       = 1.0; </div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;  physics-&gt;<a class="code" href="a00213.html#a6f84a1093abf57dcbf0406b33f40f766">bt_type</a> = 0;</div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;  strcpy(physics-&gt;<a class="code" href="a00213.html#a57894a0f53d5b228bf64053367736bf9">upw_choice</a>,<span class="stringliteral">&quot;roe&quot;</span>);</div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;</div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;  <span class="comment">/* reading physical model specific inputs */</span></div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;  <span class="keywordflow">if</span> (!mpi-&gt;<a class="code" href="a00205.html#a6cfd95afd0afebd625b889fb6e58371c">rank</a>) {</div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;    FILE *in;</div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;    <span class="keywordflow">if</span> (!count) printf(<span class="stringliteral">&quot;Reading physical model inputs from file \&quot;physics.inp\&quot;.\n&quot;</span>);</div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;    in = fopen(<span class="stringliteral">&quot;physics.inp&quot;</span>,<span class="stringliteral">&quot;r&quot;</span>);</div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;    <span class="keywordflow">if</span> (!in) printf(<span class="stringliteral">&quot;Warning: File \&quot;physics.inp\&quot; not found. Using default values.\n&quot;</span>);</div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;    <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;      <span class="keywordtype">char</span> word[<a class="code" href="a00231.html#a51efea86a4d76d1259893f606b776573">_MAX_STRING_SIZE_</a>];</div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;      ferr = fscanf(in,<span class="stringliteral">&quot;%s&quot;</span>,word); <span class="keywordflow">if</span> (ferr != 1) <span class="keywordflow">return</span>(1);</div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;      <span class="keywordflow">if</span> (!strcmp(word, <span class="stringliteral">&quot;begin&quot;</span>)){</div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;          <span class="keywordflow">while</span> (strcmp(word, <span class="stringliteral">&quot;end&quot;</span>)){</div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;              ferr = fscanf(in,<span class="stringliteral">&quot;%s&quot;</span>,word); <span class="keywordflow">if</span> (ferr != 1) <span class="keywordflow">return</span>(1);</div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;          <span class="keywordflow">if</span> (!strcmp(word, <span class="stringliteral">&quot;gravity&quot;</span>)) { </div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;            ferr = fscanf(in,<span class="stringliteral">&quot;%lf&quot;</span>,&amp;physics-&gt;<a class="code" href="a00213.html#ab30c765b9be1b7776c97c899a12a66bb">g</a>); </div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;            <span class="keywordflow">if</span> (ferr != 1) <span class="keywordflow">return</span>(1);</div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;          } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcmp(word, <span class="stringliteral">&quot;topography_type&quot;</span>)) { </div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;            ferr = fscanf(in,<span class="stringliteral">&quot;%d&quot;</span>,&amp;physics-&gt;<a class="code" href="a00213.html#a6f84a1093abf57dcbf0406b33f40f766">bt_type</a>); </div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;            <span class="keywordflow">if</span> (ferr != 1) <span class="keywordflow">return</span>(1);</div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;          } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcmp(word,<span class="stringliteral">&quot;upwinding&quot;</span>)) {</div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;            ferr = fscanf(in,<span class="stringliteral">&quot;%s&quot;</span>,physics-&gt;<a class="code" href="a00213.html#a57894a0f53d5b228bf64053367736bf9">upw_choice</a>); </div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;            <span class="keywordflow">if</span> (ferr != 1) <span class="keywordflow">return</span>(1);</div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;          } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (strcmp(word,<span class="stringliteral">&quot;end&quot;</span>)) {</div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;            <span class="keywordtype">char</span> useless[<a class="code" href="a00231.html#a51efea86a4d76d1259893f606b776573">_MAX_STRING_SIZE_</a>];</div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;            ferr = fscanf(in,<span class="stringliteral">&quot;%s&quot;</span>,useless); <span class="keywordflow">if</span> (ferr != 1) <span class="keywordflow">return</span>(ferr);</div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;            printf(<span class="stringliteral">&quot;Warning: keyword %s in file \&quot;physics.inp\&quot; with value %s not &quot;</span>,word,useless);</div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;            printf(<span class="stringliteral">&quot;recognized or extraneous. Ignoring.\n&quot;</span>);</div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;          }</div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;        }</div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;          fprintf(stderr,<span class="stringliteral">&quot;Error: Illegal format in file \&quot;physics.inp\&quot;.\n&quot;</span>);</div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;        <span class="keywordflow">return</span>(1);</div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;        }</div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;    }</div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;    fclose(in);</div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;  }</div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;</div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;<span class="preprocessor">#ifndef serial</span></div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;<span class="preprocessor"></span>  <a class="code" href="a00231.html#ad6ab74942c9de13cf0b4c12eb0d91780">IERR</a> <a class="code" href="a00248.html#a45dcb265863a65d862bb16222e7e623c">MPIBroadcast_double</a>    (&amp;physics-&gt;<a class="code" href="a00213.html#ab30c765b9be1b7776c97c899a12a66bb">g</a>        ,1,0,&amp;mpi-&gt;<a class="code" href="a00205.html#adad7a6f85831f3ac84d854b6c80aef43">world</a>);                  <a class="code" href="a00231.html#add9cf96ae374934d245a1dc1ab697a42">CHECKERR</a>(ierr);</div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;  <a class="code" href="a00231.html#ad6ab74942c9de13cf0b4c12eb0d91780">IERR</a> <a class="code" href="a00248.html#acd7957559b9206224c7da3cab4f22b27">MPIBroadcast_integer</a>   (&amp;physics-&gt;<a class="code" href="a00213.html#a6f84a1093abf57dcbf0406b33f40f766">bt_type</a>  ,1,0,&amp;mpi-&gt;<a class="code" href="a00205.html#adad7a6f85831f3ac84d854b6c80aef43">world</a>);                  <a class="code" href="a00231.html#add9cf96ae374934d245a1dc1ab697a42">CHECKERR</a>(ierr);</div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;  <a class="code" href="a00231.html#ad6ab74942c9de13cf0b4c12eb0d91780">IERR</a> <a class="code" href="a00248.html#ad408e5a44e863cca50112d1e2f728597">MPIBroadcast_character</a> (physics-&gt;<a class="code" href="a00213.html#a57894a0f53d5b228bf64053367736bf9">upw_choice</a>,<a class="code" href="a00231.html#a51efea86a4d76d1259893f606b776573">_MAX_STRING_SIZE_</a>,0,&amp;mpi-&gt;<a class="code" href="a00205.html#adad7a6f85831f3ac84d854b6c80aef43">world</a>);  <a class="code" href="a00231.html#add9cf96ae374934d245a1dc1ab697a42">CHECKERR</a>(ierr);</div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;<span class="preprocessor"></span></div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;  <span class="comment">/* initializing physical model-specific functions */</span></div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;  solver-&gt;<a class="code" href="a00202.html#a73ad2e9dae43bf438ab8bfc4cd2e1bdd">ComputeCFL</a> = <a class="code" href="a00552.html#a71431a278135cf3bc23d5a0a393f1c9b">ShallowWater1DComputeCFL</a>;</div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;  solver-&gt;<a class="code" href="a00202.html#a0d895f9bb0c8a3e79a64dd2379e1f2dd">FFunction</a>  = <a class="code" href="a00554.html#ab8ef6342f2e68ddffa5fe5d5f50cc4ce">ShallowWater1DFlux</a>;</div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;  solver-&gt;<a class="code" href="a00202.html#a1685cd0c6b8c413bdbbe86d8f4475c58">SFunction</a>  = <a class="code" href="a00556.html#a7d67bb3bf3ec360e81fd08640dd212fb">ShallowWater1DSource</a>;</div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;  solver-&gt;<a class="code" href="a00202.html#af1dc5a4ba2bdc46dfd226e35772b4130">UFunction</a>  = <a class="code" href="a00556.html#a17dd7e4115c7836a62018dbc5331d8c3">ShallowWater1DModifiedSolution</a>;</div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;  solver-&gt;<a class="code" href="a00202.html#a528a3cd1723c061f3e8dfa6ffe1f5012">JFunction</a>  = <a class="code" href="a00556.html#a488d45759b0b962998e6df9e3c6061f6">ShallowWater1DJacobian</a>;</div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;  <span class="keywordflow">if</span>      (!strcmp(physics-&gt;<a class="code" href="a00213.html#a57894a0f53d5b228bf64053367736bf9">upw_choice</a>,<a class="code" href="a00251.html#abffeadaaee7a3a2baeeb28e395411d73">_ROE_</a> )) solver-&gt;<a class="code" href="a00202.html#a7eb68b9643feb74bd49f3a171b66eef1">Upwind</a> = <a class="code" href="a00556.html#a22643576d5e0c7799f56eb9409956d14">ShallowWater1DUpwindRoe</a>;</div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcmp(physics-&gt;<a class="code" href="a00213.html#a57894a0f53d5b228bf64053367736bf9">upw_choice</a>,<a class="code" href="a00251.html#a98a6bcc1b69abface4bef84cf0d51955">_LLF_</a> )) solver-&gt;<a class="code" href="a00202.html#a7eb68b9643feb74bd49f3a171b66eef1">Upwind</a> = <a class="code" href="a00556.html#a6a89017972d16c3f426ba64a70a39b60">ShallowWater1DUpwindLLF</a>;</div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;  <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;    <span class="keywordflow">if</span> (!mpi-&gt;<a class="code" href="a00205.html#a6cfd95afd0afebd625b889fb6e58371c">rank</a>) fprintf(stderr,<span class="stringliteral">&quot;Error in ShallowWater1DInitialize(): %s is not a valid upwinding scheme.\n&quot;</span>,</div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;                            physics-&gt;<a class="code" href="a00213.html#a57894a0f53d5b228bf64053367736bf9">upw_choice</a>);</div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;    <span class="keywordflow">return</span>(1);</div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;  }</div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;  solver-&gt;<a class="code" href="a00202.html#a7331366d789b2995436accbc35e1cc80">AveragingFunction</a>     = <a class="code" href="a00555.html#a58a7f69435429c6235c30655236fefd9">ShallowWater1DRoeAverage</a>;</div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;  solver-&gt;<a class="code" href="a00202.html#a8c603c73be1f08e408a1de94a088da7b">GetLeftEigenvectors</a>   = <a class="code" href="a00553.html#aa9519badea39145bc113cba2422016b3">ShallowWater1DLeftEigenvectors</a>;</div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;  solver-&gt;<a class="code" href="a00202.html#a22eef349f191a1aa267e14b08140c823">GetRightEigenvectors</a>  = <a class="code" href="a00553.html#af4a44ab4a02a19c10ad8f4d75f88f8d7">ShallowWater1DRightEigenvectors</a>;</div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;  solver-&gt;<a class="code" href="a00202.html#ab4c55736e92f7d72f04b8a957d82b054">PhysicsOutput</a>         = <a class="code" href="a00556.html#a247a345bc636847dd5f5770373a6f56f">ShallowWater1DWriteTopography</a>;</div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;   </div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;  <span class="keywordflow">if</span>      (!strcmp(physics-&gt;<a class="code" href="a00213.html#a57894a0f53d5b228bf64053367736bf9">upw_choice</a>,<a class="code" href="a00251.html#a98a6bcc1b69abface4bef84cf0d51955">_LLF_</a> )) physics-&gt;<a class="code" href="a00213.html#a3cb843ad67e4b14387b7fa21f6d4090b">SourceUpwind</a> = <a class="code" href="a00556.html#aa3666c7f9bc8c5186fa29fa276d37f0d">ShallowWater1DSourceUpwindLLF</a>;</div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcmp(physics-&gt;<a class="code" href="a00213.html#a57894a0f53d5b228bf64053367736bf9">upw_choice</a>,<a class="code" href="a00251.html#abffeadaaee7a3a2baeeb28e395411d73">_ROE_</a> )) physics-&gt;<a class="code" href="a00213.html#a3cb843ad67e4b14387b7fa21f6d4090b">SourceUpwind</a> = <a class="code" href="a00556.html#a1cc4010588279683914801de8595a306">ShallowWater1DSourceUpwindRoe</a>;</div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;</div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;  <span class="comment">/* allocate array to hold the bottom topography field */</span></div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;  physics-&gt;<a class="code" href="a00213.html#a3374c235742374318e70b42a6aa09a82">b</a> = (<span class="keywordtype">double</span>*) calloc (solver-&gt;<a class="code" href="a00202.html#a20ee1fd00a220b98513127884a5558cf">npoints_local_wghosts</a>, <span class="keyword">sizeof</span>(<span class="keywordtype">double</span>));</div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;  <span class="comment">/* set function pointer to read this topography */</span></div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;  solver-&gt;<a class="code" href="a00202.html#a4ac8912d5ab1bdedff4546d24910ae71">PhysicsInput</a> = <a class="code" href="a00556.html#a138e0a29442a4362e5542ab7eb8b0470">ShallowWater1DTopography</a>;</div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;</div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;  count++;</div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;  <span class="keywordflow">return</span>(0);</div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;}</div>
<div class="ttc" id="a00556_html_a7d67bb3bf3ec360e81fd08640dd212fb"><div class="ttname"><a href="a00556.html#a7d67bb3bf3ec360e81fd08640dd212fb">ShallowWater1DSource</a></div><div class="ttdeci">int ShallowWater1DSource(double *, double *, void *, void *, double)</div><div class="ttdef"><b>Definition:</b> <a href="a00559_source.html#l00025">ShallowWater1DSource.c:25</a></div></div>
<div class="ttc" id="a00556_html_a488d45759b0b962998e6df9e3c6061f6"><div class="ttname"><a href="a00556.html#a488d45759b0b962998e6df9e3c6061f6">ShallowWater1DJacobian</a></div><div class="ttdeci">int ShallowWater1DJacobian(double *, double *, void *, int, int, int)</div><div class="ttdef"><b>Definition:</b> <a href="a00557_source.html#l00014">ShallowWater1DJacobian.c:14</a></div></div>
<div class="ttc" id="a00202_html_a22eef349f191a1aa267e14b08140c823"><div class="ttname"><a href="a00202.html#a22eef349f191a1aa267e14b08140c823">HyPar::GetRightEigenvectors</a></div><div class="ttdeci">int(* GetRightEigenvectors)(double *, double *, void *, int)</div><div class="ttdef"><b>Definition:</b> <a href="a00238_source.html#l00354">hypar.h:354</a></div></div>
<div class="ttc" id="a00248_html_acd7957559b9206224c7da3cab4f22b27"><div class="ttname"><a href="a00248.html#acd7957559b9206224c7da3cab4f22b27">MPIBroadcast_integer</a></div><div class="ttdeci">int MPIBroadcast_integer(int *, int, int, void *)</div><div class="ttdef"><b>Definition:</b> <a href="a00380_source.html#l00023">MPIBroadcast.c:23</a></div></div>
<div class="ttc" id="a00213_html_a3cb843ad67e4b14387b7fa21f6d4090b"><div class="ttname"><a href="a00213.html#a3cb843ad67e4b14387b7fa21f6d4090b">ShallowWater1D::SourceUpwind</a></div><div class="ttdeci">int(* SourceUpwind)(double *, double *, double *, double *, int, void *, double)</div><div class="ttdef"><b>Definition:</b> <a href="a00255_source.html#l00150">shallowwater1d.h:150</a></div></div>
<div class="ttc" id="a00202_html_a8c603c73be1f08e408a1de94a088da7b"><div class="ttname"><a href="a00202.html#a8c603c73be1f08e408a1de94a088da7b">HyPar::GetLeftEigenvectors</a></div><div class="ttdeci">int(* GetLeftEigenvectors)(double *, double *, void *, int)</div><div class="ttdef"><b>Definition:</b> <a href="a00238_source.html#l00352">hypar.h:352</a></div></div>
<div class="ttc" id="a00251_html_a57771c952ec174601addf43e1c0202b2"><div class="ttname"><a href="a00251.html#a57771c952ec174601addf43e1c0202b2">_MODEL_NDIMS_</a></div><div class="ttdeci">#define _MODEL_NDIMS_</div><div class="ttdef"><b>Definition:</b> <a href="a00251_source.html#l00056">euler1d.h:56</a></div></div>
<div class="ttc" id="a00202_html_af1dc5a4ba2bdc46dfd226e35772b4130"><div class="ttname"><a href="a00202.html#af1dc5a4ba2bdc46dfd226e35772b4130">HyPar::UFunction</a></div><div class="ttdeci">int(* UFunction)(double *, double *, int, void *, void *, double)</div><div class="ttdef"><b>Definition:</b> <a href="a00238_source.html#l00316">hypar.h:316</a></div></div>
<div class="ttc" id="a00213_html_ab30c765b9be1b7776c97c899a12a66bb"><div class="ttname"><a href="a00213.html#ab30c765b9be1b7776c97c899a12a66bb">ShallowWater1D::g</a></div><div class="ttdeci">double g</div><div class="ttdef"><b>Definition:</b> <a href="a00255_source.html#l00138">shallowwater1d.h:138</a></div></div>
<div class="ttc" id="a00553_html_af4a44ab4a02a19c10ad8f4d75f88f8d7"><div class="ttname"><a href="a00553.html#af4a44ab4a02a19c10ad8f4d75f88f8d7">ShallowWater1DRightEigenvectors</a></div><div class="ttdeci">int ShallowWater1DRightEigenvectors(double *u, double *R, void *p, int dir)</div><div class="ttdef"><b>Definition:</b> <a href="a00553_source.html#l00038">ShallowWater1DEigen.c:38</a></div></div>
<div class="ttc" id="a00556_html_a1cc4010588279683914801de8595a306"><div class="ttname"><a href="a00556.html#a1cc4010588279683914801de8595a306">ShallowWater1DSourceUpwindRoe</a></div><div class="ttdeci">int ShallowWater1DSourceUpwindRoe(double *, double *, double *, double *, int, void *, double)</div><div class="ttdef"><b>Definition:</b> <a href="a00560_source.html#l00064">ShallowWater1DSourceUpwind.c:64</a></div></div>
<div class="ttc" id="a00554_html_ab8ef6342f2e68ddffa5fe5d5f50cc4ce"><div class="ttname"><a href="a00554.html#ab8ef6342f2e68ddffa5fe5d5f50cc4ce">ShallowWater1DFlux</a></div><div class="ttdeci">int ShallowWater1DFlux(double *f, double *u, int dir, void *s, double t)</div><div class="ttdef"><b>Definition:</b> <a href="a00554_source.html#l00016">ShallowWater1DFlux.c:16</a></div></div>
<div class="ttc" id="a00202_html_a48e81a1806b5774943fd9a26e9a190f2"><div class="ttname"><a href="a00202.html#a48e81a1806b5774943fd9a26e9a190f2">HyPar::physics</a></div><div class="ttdeci">void * physics</div><div class="ttdef"><b>Definition:</b> <a href="a00238_source.html#l00261">hypar.h:261</a></div></div>
<div class="ttc" id="a00251_html_ad3395a55a5fde64d6603c7a82d7bf2c7"><div class="ttname"><a href="a00251.html#ad3395a55a5fde64d6603c7a82d7bf2c7">_MODEL_NVARS_</a></div><div class="ttdeci">#define _MODEL_NVARS_</div><div class="ttdef"><b>Definition:</b> <a href="a00251_source.html#l00058">euler1d.h:58</a></div></div>
<div class="ttc" id="a00202_html_a484873c74138512e41bc50d17b7d955a"><div class="ttname"><a href="a00202.html#a484873c74138512e41bc50d17b7d955a">HyPar::ndims</a></div><div class="ttdeci">int ndims</div><div class="ttdef"><b>Definition:</b> <a href="a00238_source.html#l00026">hypar.h:26</a></div></div>
<div class="ttc" id="a00248_html_ad408e5a44e863cca50112d1e2f728597"><div class="ttname"><a href="a00248.html#ad408e5a44e863cca50112d1e2f728597">MPIBroadcast_character</a></div><div class="ttdeci">int MPIBroadcast_character(char *, int, int, void *)</div><div class="ttdef"><b>Definition:</b> <a href="a00380_source.html#l00037">MPIBroadcast.c:37</a></div></div>
<div class="ttc" id="a00556_html_a6a89017972d16c3f426ba64a70a39b60"><div class="ttname"><a href="a00556.html#a6a89017972d16c3f426ba64a70a39b60">ShallowWater1DUpwindLLF</a></div><div class="ttdeci">int ShallowWater1DUpwindLLF(double *, double *, double *, double *, double *, double *, int, void *, double)</div><div class="ttdef"><b>Definition:</b> <a href="a00562_source.html#l00114">ShallowWater1DUpwind.c:114</a></div></div>
<div class="ttc" id="a00231_html_ad6ab74942c9de13cf0b4c12eb0d91780"><div class="ttname"><a href="a00231.html#ad6ab74942c9de13cf0b4c12eb0d91780">IERR</a></div><div class="ttdeci">#define IERR</div><div class="ttdef"><b>Definition:</b> <a href="a00231_source.html#l00016">basic.h:16</a></div></div>
<div class="ttc" id="a00556_html_aa3666c7f9bc8c5186fa29fa276d37f0d"><div class="ttname"><a href="a00556.html#aa3666c7f9bc8c5186fa29fa276d37f0d">ShallowWater1DSourceUpwindLLF</a></div><div class="ttdeci">int ShallowWater1DSourceUpwindLLF(double *, double *, double *, double *, int, void *, double)</div><div class="ttdef"><b>Definition:</b> <a href="a00560_source.html#l00022">ShallowWater1DSourceUpwind.c:22</a></div></div>
<div class="ttc" id="a00202_html_a20ee1fd00a220b98513127884a5558cf"><div class="ttname"><a href="a00202.html#a20ee1fd00a220b98513127884a5558cf">HyPar::npoints_local_wghosts</a></div><div class="ttdeci">int npoints_local_wghosts</div><div class="ttdef"><b>Definition:</b> <a href="a00238_source.html#l00042">hypar.h:42</a></div></div>
<div class="ttc" id="a00231_html_add9cf96ae374934d245a1dc1ab697a42"><div class="ttname"><a href="a00231.html#add9cf96ae374934d245a1dc1ab697a42">CHECKERR</a></div><div class="ttdeci">#define CHECKERR(ierr)</div><div class="ttdef"><b>Definition:</b> <a href="a00231_source.html#l00018">basic.h:18</a></div></div>
<div class="ttc" id="a00202_html_a528a3cd1723c061f3e8dfa6ffe1f5012"><div class="ttname"><a href="a00202.html#a528a3cd1723c061f3e8dfa6ffe1f5012">HyPar::JFunction</a></div><div class="ttdeci">int(* JFunction)(double *, double *, void *, int, int, int)</div><div class="ttdef"><b>Definition:</b> <a href="a00238_source.html#l00321">hypar.h:321</a></div></div>
<div class="ttc" id="a00553_html_aa9519badea39145bc113cba2422016b3"><div class="ttname"><a href="a00553.html#aa9519badea39145bc113cba2422016b3">ShallowWater1DLeftEigenvectors</a></div><div class="ttdeci">int ShallowWater1DLeftEigenvectors(double *u, double *L, void *p, int dir)</div><div class="ttdef"><b>Definition:</b> <a href="a00553_source.html#l00019">ShallowWater1DEigen.c:19</a></div></div>
<div class="ttc" id="a00556_html_a17dd7e4115c7836a62018dbc5331d8c3"><div class="ttname"><a href="a00556.html#a17dd7e4115c7836a62018dbc5331d8c3">ShallowWater1DModifiedSolution</a></div><div class="ttdeci">int ShallowWater1DModifiedSolution(double *, double *, int, void *, void *, double)</div><div class="ttdef"><b>Definition:</b> <a href="a00558_source.html#l00021">ShallowWater1DModifiedSolution.c:21</a></div></div>
<div class="ttc" id="a00202_html_ab4c55736e92f7d72f04b8a957d82b054"><div class="ttname"><a href="a00202.html#ab4c55736e92f7d72f04b8a957d82b054">HyPar::PhysicsOutput</a></div><div class="ttdeci">int(* PhysicsOutput)(void *, void *)</div><div class="ttdef"><b>Definition:</b> <a href="a00238_source.html#l00342">hypar.h:342</a></div></div>
<div class="ttc" id="a00213_html_a3374c235742374318e70b42a6aa09a82"><div class="ttname"><a href="a00213.html#a3374c235742374318e70b42a6aa09a82">ShallowWater1D::b</a></div><div class="ttdeci">double * b</div><div class="ttdef"><b>Definition:</b> <a href="a00255_source.html#l00141">shallowwater1d.h:141</a></div></div>
<div class="ttc" id="a00202_html_a73ad2e9dae43bf438ab8bfc4cd2e1bdd"><div class="ttname"><a href="a00202.html#a73ad2e9dae43bf438ab8bfc4cd2e1bdd">HyPar::ComputeCFL</a></div><div class="ttdeci">double(* ComputeCFL)(void *, void *, double, double)</div><div class="ttdef"><b>Definition:</b> <a href="a00238_source.html#l00264">hypar.h:264</a></div></div>
<div class="ttc" id="a00202_html_ae8f6d2fd6490d3153cb4133bf183a404"><div class="ttname"><a href="a00202.html#ae8f6d2fd6490d3153cb4133bf183a404">HyPar::nvars</a></div><div class="ttdeci">int nvars</div><div class="ttdef"><b>Definition:</b> <a href="a00238_source.html#l00029">hypar.h:29</a></div></div>
<div class="ttc" id="a00205_html_a00663"><div class="ttname"><a href="a00205.html#a00663">MPIVariables</a></div><div class="ttdoc">Structure of MPI-related variables. </div><div class="ttdef"><b>Definition:</b> <a href="a00205_source.html#l00024">mpivars_struct.h:24</a></div></div>
<div class="ttc" id="a00555_html_a58a7f69435429c6235c30655236fefd9"><div class="ttname"><a href="a00555.html#a58a7f69435429c6235c30655236fefd9">ShallowWater1DRoeAverage</a></div><div class="ttdeci">int ShallowWater1DRoeAverage(double *uavg, double *uL, double *uR, void *p)</div><div class="ttdef"><b>Definition:</b> <a href="a00555_source.html#l00016">ShallowWater1DFunctions.c:16</a></div></div>
<div class="ttc" id="a00556_html_a247a345bc636847dd5f5770373a6f56f"><div class="ttname"><a href="a00556.html#a247a345bc636847dd5f5770373a6f56f">ShallowWater1DWriteTopography</a></div><div class="ttdeci">int ShallowWater1DWriteTopography(void *, void *)</div><div class="ttdef"><b>Definition:</b> <a href="a00563_source.html#l00016">ShallowWater1DWriteTopography.c:16</a></div></div>
<div class="ttc" id="a00213_html"><div class="ttname"><a href="a00213.html">ShallowWater1D</a></div><div class="ttdoc">Structure containing variables and parameters specific to the 1D Shallow Water equations. This structure contains the physical parameters, variables, and function pointers specific to the 1D ShallowWater equations. </div><div class="ttdef"><b>Definition:</b> <a href="a00255_source.html#l00137">shallowwater1d.h:137</a></div></div>
<div class="ttc" id="a00556_html_a22643576d5e0c7799f56eb9409956d14"><div class="ttname"><a href="a00556.html#a22643576d5e0c7799f56eb9409956d14">ShallowWater1DUpwindRoe</a></div><div class="ttdeci">int ShallowWater1DUpwindRoe(double *, double *, double *, double *, double *, double *, int, void *, double)</div><div class="ttdef"><b>Definition:</b> <a href="a00562_source.html#l00031">ShallowWater1DUpwind.c:31</a></div></div>
<div class="ttc" id="a00231_html_a51efea86a4d76d1259893f606b776573"><div class="ttname"><a href="a00231.html#a51efea86a4d76d1259893f606b776573">_MAX_STRING_SIZE_</a></div><div class="ttdeci">#define _MAX_STRING_SIZE_</div><div class="ttdef"><b>Definition:</b> <a href="a00231_source.html#l00014">basic.h:14</a></div></div>
<div class="ttc" id="a00202_html_a7eb68b9643feb74bd49f3a171b66eef1"><div class="ttname"><a href="a00202.html#a7eb68b9643feb74bd49f3a171b66eef1">HyPar::Upwind</a></div><div class="ttdeci">int(* Upwind)(double *, double *, double *, double *, double *, double *, int, void *, double)</div><div class="ttdef"><b>Definition:</b> <a href="a00238_source.html#l00290">hypar.h:290</a></div></div>
<div class="ttc" id="a00213_html_a6f84a1093abf57dcbf0406b33f40f766"><div class="ttname"><a href="a00213.html#a6f84a1093abf57dcbf0406b33f40f766">ShallowWater1D::bt_type</a></div><div class="ttdeci">int bt_type</div><div class="ttdef"><b>Definition:</b> <a href="a00255_source.html#l00139">shallowwater1d.h:139</a></div></div>
<div class="ttc" id="a00251_html_a98a6bcc1b69abface4bef84cf0d51955"><div class="ttname"><a href="a00251.html#a98a6bcc1b69abface4bef84cf0d51955">_LLF_</a></div><div class="ttdeci">#define _LLF_</div><div class="ttdef"><b>Definition:</b> <a href="a00251_source.html#l00066">euler1d.h:66</a></div></div>
<div class="ttc" id="a00205_html_a6cfd95afd0afebd625b889fb6e58371c"><div class="ttname"><a href="a00205.html#a6cfd95afd0afebd625b889fb6e58371c">MPIVariables::rank</a></div><div class="ttdeci">int rank</div><div class="ttdef"><b>Definition:</b> <a href="a00205_source.html#l00025">mpivars_struct.h:25</a></div></div>
<div class="ttc" id="a00251_html_abffeadaaee7a3a2baeeb28e395411d73"><div class="ttname"><a href="a00251.html#abffeadaaee7a3a2baeeb28e395411d73">_ROE_</a></div><div class="ttdeci">#define _ROE_</div><div class="ttdef"><b>Definition:</b> <a href="a00251_source.html#l00062">euler1d.h:62</a></div></div>
<div class="ttc" id="a00202_html_a1685cd0c6b8c413bdbbe86d8f4475c58"><div class="ttname"><a href="a00202.html#a1685cd0c6b8c413bdbbe86d8f4475c58">HyPar::SFunction</a></div><div class="ttdeci">int(* SFunction)(double *, double *, void *, void *, double)</div><div class="ttdef"><b>Definition:</b> <a href="a00238_source.html#l00312">hypar.h:312</a></div></div>
<div class="ttc" id="a00552_html_a71431a278135cf3bc23d5a0a393f1c9b"><div class="ttname"><a href="a00552.html#a71431a278135cf3bc23d5a0a393f1c9b">ShallowWater1DComputeCFL</a></div><div class="ttdeci">double ShallowWater1DComputeCFL(void *s, void *m, double dt, double t)</div><div class="ttdef"><b>Definition:</b> <a href="a00552_source.html#l00017">ShallowWater1DComputeCFL.c:17</a></div></div>
<div class="ttc" id="a00202_html_a0d895f9bb0c8a3e79a64dd2379e1f2dd"><div class="ttname"><a href="a00202.html#a0d895f9bb0c8a3e79a64dd2379e1f2dd">HyPar::FFunction</a></div><div class="ttdeci">int(* FFunction)(double *, double *, int, void *, double)</div><div class="ttdef"><b>Definition:</b> <a href="a00238_source.html#l00271">hypar.h:271</a></div></div>
<div class="ttc" id="a00213_html_a57894a0f53d5b228bf64053367736bf9"><div class="ttname"><a href="a00213.html#a57894a0f53d5b228bf64053367736bf9">ShallowWater1D::upw_choice</a></div><div class="ttdeci">char upw_choice[_MAX_STRING_SIZE_]</div><div class="ttdef"><b>Definition:</b> <a href="a00255_source.html#l00142">shallowwater1d.h:142</a></div></div>
<div class="ttc" id="a00205_html_adad7a6f85831f3ac84d854b6c80aef43"><div class="ttname"><a href="a00205.html#adad7a6f85831f3ac84d854b6c80aef43">MPIVariables::world</a></div><div class="ttdeci">MPI_Comm world</div><div class="ttdef"><b>Definition:</b> <a href="a00205_source.html#l00037">mpivars_struct.h:37</a></div></div>
<div class="ttc" id="a00202_html_a4ac8912d5ab1bdedff4546d24910ae71"><div class="ttname"><a href="a00202.html#a4ac8912d5ab1bdedff4546d24910ae71">HyPar::PhysicsInput</a></div><div class="ttdeci">int(* PhysicsInput)(void *, void *, int, int, int *)</div><div class="ttdef"><b>Definition:</b> <a href="a00238_source.html#l00346">hypar.h:346</a></div></div>
<div class="ttc" id="a00202_html_a7331366d789b2995436accbc35e1cc80"><div class="ttname"><a href="a00202.html#a7331366d789b2995436accbc35e1cc80">HyPar::AveragingFunction</a></div><div class="ttdeci">int(* AveragingFunction)(double *, double *, double *, void *)</div><div class="ttdef"><b>Definition:</b> <a href="a00238_source.html#l00349">hypar.h:349</a></div></div>
<div class="ttc" id="a00202_html"><div class="ttname"><a href="a00202.html">HyPar</a></div><div class="ttdoc">Structure containing all solver-specific variables and functions. </div><div class="ttdef"><b>Definition:</b> <a href="a00238_source.html#l00023">hypar.h:23</a></div></div>
<div class="ttc" id="a00248_html_a45dcb265863a65d862bb16222e7e623c"><div class="ttname"><a href="a00248.html#a45dcb265863a65d862bb16222e7e623c">MPIBroadcast_double</a></div><div class="ttdeci">int MPIBroadcast_double(double *, int, int, void *)</div><div class="ttdef"><b>Definition:</b> <a href="a00380_source.html#l00009">MPIBroadcast.c:9</a></div></div>
<div class="ttc" id="a00556_html_a138e0a29442a4362e5542ab7eb8b0470"><div class="ttname"><a href="a00556.html#a138e0a29442a4362e5542ab7eb8b0470">ShallowWater1DTopography</a></div><div class="ttdeci">int ShallowWater1DTopography(void *, void *, int, int, int *)</div><div class="ttdef"><b>Definition:</b> <a href="a00561_source.html#l00020">ShallowWater1DTopography.c:20</a></div></div>
</div><!-- fragment -->
</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- Start of StatCounter Code for Default Guide -->
<script type="text/javascript">
var sc_project=10897352; 
var sc_invisible=1; 
var sc_security="83042f57"; 
var scJsHost = (("https:" == document.location.protocol) ?
"https://secure." : "http://www.");
document.write("<sc"+"ript type='text/javascript' src='" +
scJsHost+
"statcounter.com/counter/counter.js'></"+"script>");
</script>
<noscript><div class="statcounter"><a title="website
statistics" href="http://statcounter.com/"
target="_blank"><img class="statcounter"
src="//c.statcounter.com/10897352/0/83042f57/1/"
alt="website statistics"></a></div></noscript>
<!-- End of StatCounter Code for Default Guide -->
