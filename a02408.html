<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.14"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>HyPar: SparseGridsSimulation Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
  $(document).ready(initResizable);
/* @license-end */</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script><script type="text/javascript" async src="http://cdn.mathjax.org/mathjax/latest/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="doxygen_html_style.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">HyPar
   &#160;<span id="projectnumber">1.0</span>
   </div>
   <div id="projectbrief">Finite-Difference Hyperbolic-Parabolic PDE Solver on Cartesian Grids</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.14 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('a02408.html','');});
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pro-methods">Protected Member Functions</a> &#124;
<a href="#pro-attribs">Protected Attributes</a>  </div>
  <div class="headertitle">
<div class="title">SparseGridsSimulation Class Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>Class describing sparse grids simulations.  
 <a href="a02408.html#details">More...</a></p>

<p><code>#include &lt;<a class="el" href="a01106_source.html">sparse_grids_simulation.h</a>&gt;</code></p>
<div class="dynheader">
Inheritance diagram for SparseGridsSimulation:</div>
<div class="dyncontent">
 <div class="center">
  <img src="a02408.png" usemap="#SparseGridsSimulation_map" alt=""/>
  <map id="SparseGridsSimulation_map" name="SparseGridsSimulation_map">
<area href="a02396.html" title="Base class for a simulation. " alt="Simulation" shape="rect" coords="0,0,139,24"/>
</map>
 </div></div>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:a5063c3937d0fcae16f124b2080672616"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a02408.html#a5063c3937d0fcae16f124b2080672616">SparseGridsSimulation</a> ()</td></tr>
<tr class="separator:a5063c3937d0fcae16f124b2080672616"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a40e4575adae532a05c62039d1a77210c"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a02408.html#a40e4575adae532a05c62039d1a77210c">~SparseGridsSimulation</a> ()</td></tr>
<tr class="separator:a40e4575adae532a05c62039d1a77210c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a663f682bd957ae31ef61104e3f896e8f"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a02408.html#a663f682bd957ae31ef61104e3f896e8f">define</a> (int, int)</td></tr>
<tr class="separator:a663f682bd957ae31ef61104e3f896e8f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aac7b43be31f27809e990d0d583faea0a"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a02408.html#aac7b43be31f27809e990d0d583faea0a">ReadInputs</a> ()</td></tr>
<tr class="separator:aac7b43be31f27809e990d0d583faea0a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a16e58435a7965b6c304c4d3e1600f0d7"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a02408.html#a16e58435a7965b6c304c4d3e1600f0d7">Initialize</a> ()</td></tr>
<tr class="separator:a16e58435a7965b6c304c4d3e1600f0d7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4f0b968820fa465fde318fa0100ff23f"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a02408.html#a4f0b968820fa465fde318fa0100ff23f">InitialSolution</a> ()</td></tr>
<tr class="separator:a4f0b968820fa465fde318fa0100ff23f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a60dd5da5980e23e6ac932f984aae72ec"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a02408.html#a60dd5da5980e23e6ac932f984aae72ec">InitializeBoundaries</a> ()</td></tr>
<tr class="separator:a60dd5da5980e23e6ac932f984aae72ec"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af0ad837e34bcb8c380a457b2dfa27519"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a02408.html#af0ad837e34bcb8c380a457b2dfa27519">InitializeImmersedBoundaries</a> ()</td></tr>
<tr class="separator:af0ad837e34bcb8c380a457b2dfa27519"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9ace884b88e00a7bfa10eb8289924b2a"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a02408.html#a9ace884b88e00a7bfa10eb8289924b2a">InitializePhysics</a> ()</td></tr>
<tr class="separator:a9ace884b88e00a7bfa10eb8289924b2a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5a04edfc0f9d6150b2e39b6939a53ef2"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a02408.html#a5a04edfc0f9d6150b2e39b6939a53ef2">InitializePhysicsData</a> ()</td></tr>
<tr class="separator:a5a04edfc0f9d6150b2e39b6939a53ef2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4a9517d2ee1026d57dd45f731c362ba6"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a02408.html#a4a9517d2ee1026d57dd45f731c362ba6">InitializeSolvers</a> ()</td></tr>
<tr class="separator:a4a9517d2ee1026d57dd45f731c362ba6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6009f77fd5b9738911ebf3196682316d"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a02408.html#a6009f77fd5b9738911ebf3196682316d">InitializationWrapup</a> ()</td></tr>
<tr class="separator:a6009f77fd5b9738911ebf3196682316d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a38b49ec2d9158c100958ea64b2a24ecc"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a02408.html#a38b49ec2d9158c100958ea64b2a24ecc">Solve</a> ()</td></tr>
<tr class="separator:a38b49ec2d9158c100958ea64b2a24ecc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad7d8bcadf64dc098044a1cbff213a92e"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a02408.html#ad7d8bcadf64dc098044a1cbff213a92e">WriteErrors</a> (double, double)</td></tr>
<tr class="separator:ad7d8bcadf64dc098044a1cbff213a92e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aaa1d139fcb55b1f038ab29d736d07f3d"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a02408.html#aaa1d139fcb55b1f038ab29d736d07f3d">isDefined</a> () const</td></tr>
<tr class="separator:aaa1d139fcb55b1f038ab29d736d07f3d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7c792ddc33ca725235519d368dba286a"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a02408.html#a7c792ddc33ca725235519d368dba286a">mpiCommDup</a> ()</td></tr>
<tr class="separator:a7c792ddc33ca725235519d368dba286a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af8fbcad8a3907d33ca0ec196ba3b2009"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a02408.html#af8fbcad8a3907d33ca0ec196ba3b2009">usePetscTS</a> (PetscBool a_flag)</td></tr>
<tr class="separator:af8fbcad8a3907d33ca0ec196ba3b2009"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7ca501c3eb23eabd91098fdcd5263048"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a02408.html#a7ca501c3eb23eabd91098fdcd5263048">SolvePETSc</a> ()</td></tr>
<tr class="separator:a7ca501c3eb23eabd91098fdcd5263048"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="inherit_header pub_methods_a02396"><td colspan="2" onclick="javascript:toggleInherit('pub_methods_a02396')"><img src="closed.png" alt="-"/>&#160;Public Member Functions inherited from <a class="el" href="a02396.html">Simulation</a></td></tr>
<tr class="memitem:a58593a84fc0ce797ddb852d3f64c1971 inherit pub_methods_a02396"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a02396.html#a58593a84fc0ce797ddb852d3f64c1971">Simulation</a> ()</td></tr>
<tr class="separator:a58593a84fc0ce797ddb852d3f64c1971 inherit pub_methods_a02396"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad0c02236c1d45f09c48a648186b5f4b1 inherit pub_methods_a02396"><td class="memItemLeft" align="right" valign="top">virtual&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a02396.html#ad0c02236c1d45f09c48a648186b5f4b1">~Simulation</a> ()</td></tr>
<tr class="separator:ad0c02236c1d45f09c48a648186b5f4b1 inherit pub_methods_a02396"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pro-methods"></a>
Protected Member Functions</h2></td></tr>
<tr class="memitem:a19987c0f2b999b6e820231a32667ddf2"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a02408.html#a19987c0f2b999b6e820231a32667ddf2">SanityChecks</a> ()</td></tr>
<tr class="separator:a19987c0f2b999b6e820231a32667ddf2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8597237e7fe0da204967fedff70bc314"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a02408.html#a8597237e7fe0da204967fedff70bc314">ComputeSGDimsAndCoeffs</a> ()</td></tr>
<tr class="separator:a8597237e7fe0da204967fedff70bc314"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad9caeac8fa38b61362225c3a40b2a4cc"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a02408.html#ad9caeac8fa38b61362225c3a40b2a4cc">ComputeProcessorDistribution</a> (<a class="el" href="a01106.html#a4e1436c018a5aad717fb73ca9004bcfc">ProcDistribution</a> &amp;, const <a class="el" href="a01106.html#a00167df288a1ca2c6c32af8d911975e0">GridDimensions</a> &amp;)</td></tr>
<tr class="separator:ad9caeac8fa38b61362225c3a40b2a4cc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab3307eb5eb7b5d7f20266a9ea97f4c09"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a02408.html#ab3307eb5eb7b5d7f20266a9ea97f4c09">GetCTGridSizes</a> (const int, std::vector&lt; <a class="el" href="a01106.html#a00167df288a1ca2c6c32af8d911975e0">GridDimensions</a> &gt; &amp;)</td></tr>
<tr class="separator:ab3307eb5eb7b5d7f20266a9ea97f4c09"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a02a78692b8cc62fbfb25bcdb20a9a590"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a02408.html#a02a78692b8cc62fbfb25bcdb20a9a590">InitializeBarebones</a> (<a class="el" href="a01100.html#a02400">SimulationObject</a> *)</td></tr>
<tr class="separator:a02a78692b8cc62fbfb25bcdb20a9a590"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afd984d88b028433d14fe3953937df374"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a02408.html#afd984d88b028433d14fe3953937df374">InitializeSolversBarebones</a> (<a class="el" href="a01100.html#a02400">SimulationObject</a> *)</td></tr>
<tr class="separator:afd984d88b028433d14fe3953937df374"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a562d4c4cc409a40b1bed1c82fc6ec0b9"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a02408.html#a562d4c4cc409a40b1bed1c82fc6ec0b9">CleanupBarebones</a> (<a class="el" href="a01100.html#a02400">SimulationObject</a> *)</td></tr>
<tr class="separator:a562d4c4cc409a40b1bed1c82fc6ec0b9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abc369c6ea10a947feae5c3f365670d6e"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a02408.html#abc369c6ea10a947feae5c3f365670d6e">SetSolverParameters</a> (<a class="el" href="a01100.html#a02400">SimulationObject</a> &amp;, const <a class="el" href="a01106.html#a00167df288a1ca2c6c32af8d911975e0">GridDimensions</a> &amp;, const <a class="el" href="a01106.html#a4e1436c018a5aad717fb73ca9004bcfc">ProcDistribution</a> &amp;, const <a class="el" href="a01100.html#a02400">SimulationObject</a> &amp;, const int, const int)</td></tr>
<tr class="separator:abc369c6ea10a947feae5c3f365670d6e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aba08ee83eb54edc5274b210c75e63e8c"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a02408.html#aba08ee83eb54edc5274b210c75e63e8c">OutputSolution</a> ()</td></tr>
<tr class="separator:aba08ee83eb54edc5274b210c75e63e8c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3854ff631312b4487e4b816b9ffbb8ad"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a02408.html#a3854ff631312b4487e4b816b9ffbb8ad">CombinationTechnique</a> (<a class="el" href="a01100.html#a02400">SimulationObject</a> *const)</td></tr>
<tr class="separator:a3854ff631312b4487e4b816b9ffbb8ad"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a96da5797b40184e2da41e3d1abfc9697"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a02408.html#a96da5797b40184e2da41e3d1abfc9697">interpolate</a> (<a class="el" href="a01100.html#a02400">SimulationObject</a> *const, const <a class="el" href="a01100.html#a02400">SimulationObject</a> *const)</td></tr>
<tr class="separator:a96da5797b40184e2da41e3d1abfc9697"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abb8abf06b6b5d0b4d804970b8b896bde"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a02408.html#abb8abf06b6b5d0b4d804970b8b896bde">interpolate</a> (const <a class="el" href="a01106.html#a00167df288a1ca2c6c32af8d911975e0">GridDimensions</a> &amp;, double **const, const <a class="el" href="a01100.html#a02400">SimulationObject</a> *const)</td></tr>
<tr class="separator:abb8abf06b6b5d0b4d804970b8b896bde"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a20303c6aa17833ad691479008c2ce676"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a02408.html#a20303c6aa17833ad691479008c2ce676">interpolateGrid</a> (<a class="el" href="a01100.html#a02400">SimulationObject</a> *const, const <a class="el" href="a01100.html#a02400">SimulationObject</a> *const)</td></tr>
<tr class="separator:a20303c6aa17833ad691479008c2ce676"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aef4dc57f1045e5594a6b12d0d5415023"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a02408.html#aef4dc57f1045e5594a6b12d0d5415023">coarsenGrid1D</a> (const <a class="el" href="a01106.html#a00167df288a1ca2c6c32af8d911975e0">GridDimensions</a> &amp;, const <a class="el" href="a01106.html#a00167df288a1ca2c6c32af8d911975e0">GridDimensions</a> &amp;, const double *const, double *const, int)</td></tr>
<tr class="separator:aef4dc57f1045e5594a6b12d0d5415023"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a895ea7a442b045e20ef7b41735b48e5e"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a02408.html#a895ea7a442b045e20ef7b41735b48e5e">refineGrid1D</a> (const <a class="el" href="a01106.html#a00167df288a1ca2c6c32af8d911975e0">GridDimensions</a> &amp;, const <a class="el" href="a01106.html#a00167df288a1ca2c6c32af8d911975e0">GridDimensions</a> &amp;, const double *const, double *const, int)</td></tr>
<tr class="separator:a895ea7a442b045e20ef7b41735b48e5e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2aba074a93f3c8800e268b85aa14a3a9"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a02408.html#a2aba074a93f3c8800e268b85aa14a3a9">fillGhostCells</a> (const <a class="el" href="a01106.html#a00167df288a1ca2c6c32af8d911975e0">GridDimensions</a> &amp;, const int, double *const, const int)</td></tr>
<tr class="separator:a2aba074a93f3c8800e268b85aa14a3a9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3b9da93464d7dafe5f3c64211703387b"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a02408.html#a3b9da93464d7dafe5f3c64211703387b">CalculateError</a> ()</td></tr>
<tr class="separator:a3b9da93464d7dafe5f3c64211703387b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa22a121c18471b27623988d9ada894af"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a02408.html#aa22a121c18471b27623988d9ada894af">computeError</a> (<a class="el" href="a01100.html#a02400">SimulationObject</a> &amp;, double *const)</td></tr>
<tr class="separator:aa22a121c18471b27623988d9ada894af"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad209b51783ddb3be5497d6cbe6a3e8af"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a02408.html#ad209b51783ddb3be5497d6cbe6a3e8af">isPowerOfTwo</a> (int x)</td></tr>
<tr class="separator:ad209b51783ddb3be5497d6cbe6a3e8af"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0c79a01f9c78a0aeed162d6eafed4ad5"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a02408.html#a0c79a01f9c78a0aeed162d6eafed4ad5">cfunc</a> (int a, int b)</td></tr>
<tr class="separator:a0c79a01f9c78a0aeed162d6eafed4ad5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5127a26373d94a3e3d4c46eca1e20cb7"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a02408.html#a5127a26373d94a3e3d4c46eca1e20cb7">factorial</a> (int a)</td></tr>
<tr class="separator:a5127a26373d94a3e3d4c46eca1e20cb7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a77a47bfc5b17b652a0ca888561f493e4"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a02408.html#a77a47bfc5b17b652a0ca888561f493e4">allocateGridArrays</a> (const <a class="el" href="a01106.html#a00167df288a1ca2c6c32af8d911975e0">GridDimensions</a> &amp;a_dim, double **const a_x, const int a_ngpt=0)</td></tr>
<tr class="separator:a77a47bfc5b17b652a0ca888561f493e4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a00beed94b3f705d20db508533bfc0fc0"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a02408.html#a00beed94b3f705d20db508533bfc0fc0">allocateDataArrays</a> (const <a class="el" href="a01106.html#a00167df288a1ca2c6c32af8d911975e0">GridDimensions</a> &amp;a_dim, const int a_nvars, double **const a_u, const int a_ngpt=0)</td></tr>
<tr class="separator:a00beed94b3f705d20db508533bfc0fc0"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pro-attribs"></a>
Protected Attributes</h2></td></tr>
<tr class="memitem:a4c049947a4c07f2d2df7d1374a4babae"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a02408.html#a4c049947a4c07f2d2df7d1374a4babae">m_is_defined</a></td></tr>
<tr class="separator:a4c049947a4c07f2d2df7d1374a4babae"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acd95922d6bb09419fb66435d114cdb5c"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a02408.html#acd95922d6bb09419fb66435d114cdb5c">m_nsims_sg</a></td></tr>
<tr class="separator:acd95922d6bb09419fb66435d114cdb5c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af3c229deae2a8e788c823dcc6f020b65"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a02408.html#af3c229deae2a8e788c823dcc6f020b65">m_ndims</a></td></tr>
<tr class="separator:af3c229deae2a8e788c823dcc6f020b65"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac6a822dc76382e4027cf94ac3e510056"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a02408.html#ac6a822dc76382e4027cf94ac3e510056">m_rank</a></td></tr>
<tr class="separator:ac6a822dc76382e4027cf94ac3e510056"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae5bbe5daa629a4f92b569cb632256780"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a02408.html#ae5bbe5daa629a4f92b569cb632256780">m_nproc</a></td></tr>
<tr class="separator:ae5bbe5daa629a4f92b569cb632256780"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a80c52a96f6a5a4851ac860d751587df6"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a02408.html#a80c52a96f6a5a4851ac860d751587df6">m_interp_order</a></td></tr>
<tr class="separator:a80c52a96f6a5a4851ac860d751587df6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1fde282f4347462c9c2dd34aac2ad998"><td class="memItemLeft" align="right" valign="top">std::vector&lt; bool &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a02408.html#a1fde282f4347462c9c2dd34aac2ad998">m_is_periodic</a></td></tr>
<tr class="separator:a1fde282f4347462c9c2dd34aac2ad998"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a634b90e62b481c87ad0ba4ee5c5feba4"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a02408.html#a634b90e62b481c87ad0ba4ee5c5feba4">m_write_sg_solutions</a></td></tr>
<tr class="separator:a634b90e62b481c87ad0ba4ee5c5feba4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8ccd402501119573dbadc7d6e96c59a2"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a02408.html#a8ccd402501119573dbadc7d6e96c59a2">m_print_sg_errors</a></td></tr>
<tr class="separator:a8ccd402501119573dbadc7d6e96c59a2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a41a86f682aa37c28c671759a11a494a8"><td class="memItemLeft" align="right" valign="top"><a class="el" href="a01100.html#a02400">SimulationObject</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a02408.html#a41a86f682aa37c28c671759a11a494a8">m_sim_fg</a></td></tr>
<tr class="separator:a41a86f682aa37c28c671759a11a494a8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afd006361179964b4e2c2cc65526247bd"><td class="memItemLeft" align="right" valign="top">std::vector&lt; <a class="el" href="a01100.html#a02400">SimulationObject</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a02408.html#afd006361179964b4e2c2cc65526247bd">m_sims_sg</a></td></tr>
<tr class="separator:afd006361179964b4e2c2cc65526247bd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adda60102f329d6d2f76ba7ff11e84564"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a02408.html#adda60102f329d6d2f76ba7ff11e84564">m_n_fg</a></td></tr>
<tr class="separator:adda60102f329d6d2f76ba7ff11e84564"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2e5b2d1500a445715e53baba327b79a7"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a02408.html#a2e5b2d1500a445715e53baba327b79a7">m_imin</a></td></tr>
<tr class="separator:a2e5b2d1500a445715e53baba327b79a7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8b468da0c8b3831ae8b1519d8781245f"><td class="memItemLeft" align="right" valign="top">std::vector&lt; <a class="el" href="a01106.html#a1ae060a4950606cbd05aca1122c4a890">SGCTElem</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a02408.html#a8b468da0c8b3831ae8b1519d8781245f">m_combination</a></td></tr>
<tr class="separator:a8b468da0c8b3831ae8b1519d8781245f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5da433fbee71264a45061bb0b3063326"><td class="memItemLeft" align="right" valign="top">std::vector&lt; <a class="el" href="a01106.html#a4e1436c018a5aad717fb73ca9004bcfc">ProcDistribution</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a02408.html#a5da433fbee71264a45061bb0b3063326">m_iprocs</a></td></tr>
<tr class="separator:a5da433fbee71264a45061bb0b3063326"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Class describing sparse grids simulations. </p>
<p>Class describing sparse grids simulations This class contains all data and functions needed to run a sparse grids simulation.</p>
<p>This class contains all data and functions needed to run sparse grids simulations. </p>

<p class="definition">Definition at line <a class="el" href="a01106_source.html#l00038">38</a> of file <a class="el" href="a01106_source.html">sparse_grids_simulation.h</a>.</p>
</div><h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a id="a5063c3937d0fcae16f124b2080672616"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5063c3937d0fcae16f124b2080672616">&#9670;&nbsp;</a></span>SparseGridsSimulation()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="a02408.html">SparseGridsSimulation</a> </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Constructor </p>

<p class="definition">Definition at line <a class="el" href="a01106_source.html#l00043">43</a> of file <a class="el" href="a01106_source.html">sparse_grids_simulation.h</a>.</p>
<div class="fragment"><div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;    {</div><div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;      <a class="code" href="a02408.html#a4c049947a4c07f2d2df7d1374a4babae">m_is_defined</a> = <span class="keyword">false</span>;</div><div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;</div><div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;      <a class="code" href="a02408.html#acd95922d6bb09419fb66435d114cdb5c">m_nsims_sg</a> = -1;</div><div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;      <a class="code" href="a02408.html#af3c229deae2a8e788c823dcc6f020b65">m_ndims</a> = -1;</div><div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;      <a class="code" href="a02408.html#ac6a822dc76382e4027cf94ac3e510056">m_rank</a> = -1;</div><div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;      <a class="code" href="a02408.html#ae5bbe5daa629a4f92b569cb632256780">m_nproc</a> = -1;</div><div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;</div><div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;      <a class="code" href="a02408.html#a41a86f682aa37c28c671759a11a494a8">m_sim_fg</a> = NULL;</div><div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;      <a class="code" href="a02408.html#afd006361179964b4e2c2cc65526247bd">m_sims_sg</a>.clear();</div><div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;</div><div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;      <a class="code" href="a02408.html#adda60102f329d6d2f76ba7ff11e84564">m_n_fg</a> = -1;</div><div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;      <a class="code" href="a02408.html#a2e5b2d1500a445715e53baba327b79a7">m_imin</a> = -1;</div><div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;</div><div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;      <a class="code" href="a02408.html#a80c52a96f6a5a4851ac860d751587df6">m_interp_order</a> = 6;</div><div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;</div><div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;      <a class="code" href="a02408.html#a1fde282f4347462c9c2dd34aac2ad998">m_is_periodic</a>.clear();</div><div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;      <a class="code" href="a02408.html#a8b468da0c8b3831ae8b1519d8781245f">m_combination</a>.clear();</div><div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;    }</div><div class="ttc" id="a02408_html_acd95922d6bb09419fb66435d114cdb5c"><div class="ttname"><a href="a02408.html#acd95922d6bb09419fb66435d114cdb5c">SparseGridsSimulation::m_nsims_sg</a></div><div class="ttdeci">int m_nsims_sg</div><div class="ttdef"><b>Definition:</b> <a href="a01106_source.html#l00214">sparse_grids_simulation.h:214</a></div></div>
<div class="ttc" id="a02408_html_a2e5b2d1500a445715e53baba327b79a7"><div class="ttname"><a href="a02408.html#a2e5b2d1500a445715e53baba327b79a7">SparseGridsSimulation::m_imin</a></div><div class="ttdeci">int m_imin</div><div class="ttdef"><b>Definition:</b> <a href="a01106_source.html#l00234">sparse_grids_simulation.h:234</a></div></div>
<div class="ttc" id="a02408_html_a41a86f682aa37c28c671759a11a494a8"><div class="ttname"><a href="a02408.html#a41a86f682aa37c28c671759a11a494a8">SparseGridsSimulation::m_sim_fg</a></div><div class="ttdeci">SimulationObject * m_sim_fg</div><div class="ttdef"><b>Definition:</b> <a href="a01106_source.html#l00230">sparse_grids_simulation.h:230</a></div></div>
<div class="ttc" id="a02408_html_a1fde282f4347462c9c2dd34aac2ad998"><div class="ttname"><a href="a02408.html#a1fde282f4347462c9c2dd34aac2ad998">SparseGridsSimulation::m_is_periodic</a></div><div class="ttdeci">std::vector&lt; bool &gt; m_is_periodic</div><div class="ttdef"><b>Definition:</b> <a href="a01106_source.html#l00222">sparse_grids_simulation.h:222</a></div></div>
<div class="ttc" id="a02408_html_af3c229deae2a8e788c823dcc6f020b65"><div class="ttname"><a href="a02408.html#af3c229deae2a8e788c823dcc6f020b65">SparseGridsSimulation::m_ndims</a></div><div class="ttdeci">int m_ndims</div><div class="ttdef"><b>Definition:</b> <a href="a01106_source.html#l00215">sparse_grids_simulation.h:215</a></div></div>
<div class="ttc" id="a02408_html_ac6a822dc76382e4027cf94ac3e510056"><div class="ttname"><a href="a02408.html#ac6a822dc76382e4027cf94ac3e510056">SparseGridsSimulation::m_rank</a></div><div class="ttdeci">int m_rank</div><div class="ttdef"><b>Definition:</b> <a href="a01106_source.html#l00216">sparse_grids_simulation.h:216</a></div></div>
<div class="ttc" id="a02408_html_a4c049947a4c07f2d2df7d1374a4babae"><div class="ttname"><a href="a02408.html#a4c049947a4c07f2d2df7d1374a4babae">SparseGridsSimulation::m_is_defined</a></div><div class="ttdeci">bool m_is_defined</div><div class="ttdef"><b>Definition:</b> <a href="a01106_source.html#l00212">sparse_grids_simulation.h:212</a></div></div>
<div class="ttc" id="a02408_html_afd006361179964b4e2c2cc65526247bd"><div class="ttname"><a href="a02408.html#afd006361179964b4e2c2cc65526247bd">SparseGridsSimulation::m_sims_sg</a></div><div class="ttdeci">std::vector&lt; SimulationObject &gt; m_sims_sg</div><div class="ttdef"><b>Definition:</b> <a href="a01106_source.html#l00231">sparse_grids_simulation.h:231</a></div></div>
<div class="ttc" id="a02408_html_adda60102f329d6d2f76ba7ff11e84564"><div class="ttname"><a href="a02408.html#adda60102f329d6d2f76ba7ff11e84564">SparseGridsSimulation::m_n_fg</a></div><div class="ttdeci">int m_n_fg</div><div class="ttdef"><b>Definition:</b> <a href="a01106_source.html#l00233">sparse_grids_simulation.h:233</a></div></div>
<div class="ttc" id="a02408_html_ae5bbe5daa629a4f92b569cb632256780"><div class="ttname"><a href="a02408.html#ae5bbe5daa629a4f92b569cb632256780">SparseGridsSimulation::m_nproc</a></div><div class="ttdeci">int m_nproc</div><div class="ttdef"><b>Definition:</b> <a href="a01106_source.html#l00216">sparse_grids_simulation.h:216</a></div></div>
<div class="ttc" id="a02408_html_a80c52a96f6a5a4851ac860d751587df6"><div class="ttname"><a href="a02408.html#a80c52a96f6a5a4851ac860d751587df6">SparseGridsSimulation::m_interp_order</a></div><div class="ttdeci">int m_interp_order</div><div class="ttdef"><b>Definition:</b> <a href="a01106_source.html#l00220">sparse_grids_simulation.h:220</a></div></div>
<div class="ttc" id="a02408_html_a8b468da0c8b3831ae8b1519d8781245f"><div class="ttname"><a href="a02408.html#a8b468da0c8b3831ae8b1519d8781245f">SparseGridsSimulation::m_combination</a></div><div class="ttdeci">std::vector&lt; SGCTElem &gt; m_combination</div><div class="ttdef"><b>Definition:</b> <a href="a01106_source.html#l00236">sparse_grids_simulation.h:236</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a40e4575adae532a05c62039d1a77210c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a40e4575adae532a05c62039d1a77210c">&#9670;&nbsp;</a></span>~SparseGridsSimulation()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">~<a class="el" href="a02408.html">SparseGridsSimulation</a> </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Destructor </p>

<p class="definition">Definition at line <a class="el" href="a01106_source.html#l00065">65</a> of file <a class="el" href="a01106_source.html">sparse_grids_simulation.h</a>.</p>
<div class="fragment"><div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;    {</div><div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;      <span class="keywordtype">int</span> err;</div><div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;      <span class="comment">/* clean up full grid object */</span></div><div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;      err = <a class="code" href="a02408.html#a562d4c4cc409a40b1bed1c82fc6ec0b9">CleanupBarebones</a>(<a class="code" href="a02408.html#a41a86f682aa37c28c671759a11a494a8">m_sim_fg</a>);</div><div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;      <span class="keyword">delete</span> <a class="code" href="a02408.html#a41a86f682aa37c28c671759a11a494a8">m_sim_fg</a>;</div><div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;      <span class="comment">/* clean up and delete sparse grids objects */</span></div><div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;      err = <a class="code" href="a01094.html#a315baa877650032461e4cc97eef45b6f">Cleanup</a>((<span class="keywordtype">void</span>*) <a class="code" href="a02408.html#afd006361179964b4e2c2cc65526247bd">m_sims_sg</a>.data(), <a class="code" href="a02408.html#acd95922d6bb09419fb66435d114cdb5c">m_nsims_sg</a>);</div><div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;      <span class="keywordflow">if</span> (err) {</div><div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;        printf( <span class="stringliteral">&quot;Error: CleanUp() returned with status %d on process %d.\n&quot;</span>,</div><div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;                err, <a class="code" href="a02408.html#ac6a822dc76382e4027cf94ac3e510056">m_rank</a> );</div><div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;      }</div><div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;      <a class="code" href="a02408.html#afd006361179964b4e2c2cc65526247bd">m_sims_sg</a>.clear();</div><div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;      <span class="comment">/* done */</span></div><div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;      <span class="keywordflow">return</span>;</div><div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;    }</div><div class="ttc" id="a02408_html_acd95922d6bb09419fb66435d114cdb5c"><div class="ttname"><a href="a02408.html#acd95922d6bb09419fb66435d114cdb5c">SparseGridsSimulation::m_nsims_sg</a></div><div class="ttdeci">int m_nsims_sg</div><div class="ttdef"><b>Definition:</b> <a href="a01106_source.html#l00214">sparse_grids_simulation.h:214</a></div></div>
<div class="ttc" id="a02408_html_a41a86f682aa37c28c671759a11a494a8"><div class="ttname"><a href="a02408.html#a41a86f682aa37c28c671759a11a494a8">SparseGridsSimulation::m_sim_fg</a></div><div class="ttdeci">SimulationObject * m_sim_fg</div><div class="ttdef"><b>Definition:</b> <a href="a01106_source.html#l00230">sparse_grids_simulation.h:230</a></div></div>
<div class="ttc" id="a02408_html_ac6a822dc76382e4027cf94ac3e510056"><div class="ttname"><a href="a02408.html#ac6a822dc76382e4027cf94ac3e510056">SparseGridsSimulation::m_rank</a></div><div class="ttdeci">int m_rank</div><div class="ttdef"><b>Definition:</b> <a href="a01106_source.html#l00216">sparse_grids_simulation.h:216</a></div></div>
<div class="ttc" id="a02408_html_a562d4c4cc409a40b1bed1c82fc6ec0b9"><div class="ttname"><a href="a02408.html#a562d4c4cc409a40b1bed1c82fc6ec0b9">SparseGridsSimulation::CleanupBarebones</a></div><div class="ttdeci">int CleanupBarebones(SimulationObject *)</div><div class="ttdef"><b>Definition:</b> <a href="a02177_source.html#l00142">SparseGridsMiscFuncs.cpp:142</a></div></div>
<div class="ttc" id="a02408_html_afd006361179964b4e2c2cc65526247bd"><div class="ttname"><a href="a02408.html#afd006361179964b4e2c2cc65526247bd">SparseGridsSimulation::m_sims_sg</a></div><div class="ttdeci">std::vector&lt; SimulationObject &gt; m_sims_sg</div><div class="ttdef"><b>Definition:</b> <a href="a01106_source.html#l00231">sparse_grids_simulation.h:231</a></div></div>
<div class="ttc" id="a01094_html_a315baa877650032461e4cc97eef45b6f"><div class="ttname"><a href="a01094.html#a315baa877650032461e4cc97eef45b6f">Cleanup</a></div><div class="ttdeci">int Cleanup(void *, int)</div><div class="ttdef"><b>Definition:</b> <a href="a02096_source.html#l00039">Cleanup.c:39</a></div></div>
</div><!-- fragment -->
</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a id="a663f682bd957ae31ef61104e3f896e8f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a663f682bd957ae31ef61104e3f896e8f">&#9670;&nbsp;</a></span>define()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int define </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>a_rank</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>a_nproc</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Define this object</p>
<p>Define the sparse grids simulation object - here, only the full grid simulation object <a class="el" href="a02408.html#a41a86f682aa37c28c671759a11a494a8">SparseGridsSimulation::m_sim_fg</a> is created.</p>
<p>This function also reads sparse grids inputs from the file <b>sparse_grids.inp</b>. Rank 0 reads in the inputs and broadcasts them to all the processors.<br />
<br />
The format of <b>sparse_grids.inp</b> is as follows:<br />
</p><pre class="fragment">begin
    &lt;keyword&gt;   &lt;value&gt;
    &lt;keyword&gt;   &lt;value&gt;
    ...
    &lt;keyword&gt;   &lt;value&gt;
end
</pre><p>where the list of keywords and their type are:<br />
</p><table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Keyword name  </th><th class="markdownTableHeadNone">Type  </th><th class="markdownTableHeadNone">Variable  </th><th class="markdownTableHeadNone">Default value --&mdash;   </th></tr>
<tr class="markdownTableBody" class="markdownTableRowOdd">
<td class="markdownTableBodyNone">log2_imin  </td><td class="markdownTableBodyNone">int  </td><td class="markdownTableBodyNone"><a class="el" href="a02408.html#a2e5b2d1500a445715e53baba327b79a7">SparseGridsSimulation::m_imin</a>  </td><td class="markdownTableBodyNone">2   </td></tr>
<tr class="markdownTableBody" class="markdownTableRowEven">
<td class="markdownTableBodyNone">interp_order  </td><td class="markdownTableBodyNone">int  </td><td class="markdownTableBodyNone"><a class="el" href="a02408.html#a80c52a96f6a5a4851ac860d751587df6">SparseGridsSimulation::m_interp_order</a>  </td><td class="markdownTableBodyNone">6   </td></tr>
<tr class="markdownTableBody" class="markdownTableRowOdd">
<td class="markdownTableBodyNone">write_sg_solution  </td><td class="markdownTableBodyNone">char[]  </td><td class="markdownTableBodyNone"><a class="el" href="a02408.html#a634b90e62b481c87ad0ba4ee5c5feba4">SparseGridsSimulation::m_write_sg_solutions</a>  </td><td class="markdownTableBodyNone">"no" (0)   </td></tr>
<tr class="markdownTableBody" class="markdownTableRowEven">
<td class="markdownTableBodyNone">write_sg_errors  </td><td class="markdownTableBodyNone">char[]  </td><td class="markdownTableBodyNone"><a class="el" href="a02408.html#a8ccd402501119573dbadc7d6e96c59a2">SparseGridsSimulation::m_print_sg_errors</a>  </td><td class="markdownTableBodyNone">"no" (0)   </td></tr>
</table>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">a_rank</td><td>MPI rank of this process </td></tr>
    <tr><td class="paramname">a_nproc</td><td>Total number of MPI ranks </td></tr>
  </table>
  </dd>
</dl>

<p>Implements <a class="el" href="a02396.html#a9d077b2f2c810dd3b49e73c3f5971f1e">Simulation</a>.</p>

<p class="definition">Definition at line <a class="el" href="a02156_source.html#l00033">33</a> of file <a class="el" href="a02156_source.html">SparseGridsDefine.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;{</div><div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;  <a class="code" href="a02408.html#ac6a822dc76382e4027cf94ac3e510056">m_rank</a> = a_rank;</div><div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;  <a class="code" href="a02408.html#ae5bbe5daa629a4f92b569cb632256780">m_nproc</a> = a_nproc;</div><div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;</div><div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="a02408.html#a41a86f682aa37c28c671759a11a494a8">m_sim_fg</a> != NULL) {</div><div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;    fprintf(stderr, <span class="stringliteral">&quot;Error in SparseGridsSimulation::define() -\n&quot;</span>);</div><div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;    fprintf(stderr, <span class="stringliteral">&quot;  m_sim_fg not NULL!\n&quot;</span>);</div><div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;    exit(1);</div><div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;  }</div><div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;</div><div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;  <span class="comment">/* default values */</span></div><div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;  <a class="code" href="a02408.html#a2e5b2d1500a445715e53baba327b79a7">m_imin</a> = 2;</div><div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;  <a class="code" href="a02408.html#a634b90e62b481c87ad0ba4ee5c5feba4">m_write_sg_solutions</a> = 0;</div><div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;  <a class="code" href="a02408.html#a8ccd402501119573dbadc7d6e96c59a2">m_print_sg_errors</a> = 0;</div><div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;  <a class="code" href="a02408.html#a80c52a96f6a5a4851ac860d751587df6">m_interp_order</a> = 6;</div><div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;</div><div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;  <span class="keywordflow">if</span> (!<a class="code" href="a02408.html#ac6a822dc76382e4027cf94ac3e510056">m_rank</a>) {</div><div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;</div><div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;    FILE *in;</div><div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;    in = fopen(<a class="code" href="a01106.html#a04580f398fca92aa5aec64d17520153d">_SPARSEGRIDS_SIM_INP_FNAME_</a>,<span class="stringliteral">&quot;r&quot;</span>);</div><div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;</div><div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;    <span class="keywordflow">if</span> (!in) {</div><div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;</div><div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;      fprintf(stderr, <span class="stringliteral">&quot;Error in SparseGridsSimulation::Define() -\n&quot;</span>);</div><div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;      fprintf(stderr, <span class="stringliteral">&quot;  %s file not found.\n&quot;</span>, <a class="code" href="a01106.html#a04580f398fca92aa5aec64d17520153d">_SPARSEGRIDS_SIM_INP_FNAME_</a>);</div><div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;      exit(1);</div><div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;</div><div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;    } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;</div><div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;      <span class="keywordtype">int</span> ferr;</div><div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;      <span class="keywordtype">char</span> word[<a class="code" href="a00965.html#a51efea86a4d76d1259893f606b776573">_MAX_STRING_SIZE_</a>];</div><div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;      ferr = fscanf(in,<span class="stringliteral">&quot;%s&quot;</span>, word); <span class="keywordflow">if</span> (ferr != 1) <span class="keywordflow">return</span>(1);</div><div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;</div><div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;      <span class="keywordflow">if</span> (std::string(word) == <span class="stringliteral">&quot;begin&quot;</span>) {</div><div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;</div><div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;        <span class="keywordflow">while</span> (std::string(word) != <span class="stringliteral">&quot;end&quot;</span>) {</div><div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;</div><div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;          ferr = fscanf(in,<span class="stringliteral">&quot;%s&quot;</span>,word); <span class="keywordflow">if</span> (ferr != 1) <span class="keywordflow">return</span>(1);</div><div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;</div><div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;          <span class="keywordflow">if</span> (std::string(word) == <span class="stringliteral">&quot;log2_imin&quot;</span>) {</div><div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;</div><div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;            ferr = fscanf(in,<span class="stringliteral">&quot;%d&quot;</span>,&amp;<a class="code" href="a02408.html#a2e5b2d1500a445715e53baba327b79a7">m_imin</a>); <span class="keywordflow">if</span> (ferr != 1) <span class="keywordflow">return</span>(1);</div><div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;</div><div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;          } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (std::string(word) == <span class="stringliteral">&quot;interp_order&quot;</span>) {</div><div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;</div><div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;            ferr = fscanf(in,<span class="stringliteral">&quot;%d&quot;</span>,&amp;<a class="code" href="a02408.html#a80c52a96f6a5a4851ac860d751587df6">m_interp_order</a>); <span class="keywordflow">if</span> (ferr != 1) <span class="keywordflow">return</span>(1);</div><div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;</div><div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;          } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (std::string(word) == <span class="stringliteral">&quot;write_sg_solutions&quot;</span>) {</div><div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;</div><div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;            <span class="keywordtype">char</span> answer[<a class="code" href="a00965.html#a51efea86a4d76d1259893f606b776573">_MAX_STRING_SIZE_</a>];</div><div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;            ferr = fscanf(in,<span class="stringliteral">&quot;%s&quot;</span>,answer); <span class="keywordflow">if</span> (ferr != 1) <span class="keywordflow">return</span>(1);</div><div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;            <a class="code" href="a02408.html#a634b90e62b481c87ad0ba4ee5c5feba4">m_write_sg_solutions</a> = (strcmp(answer,<span class="stringliteral">&quot;yes&quot;</span>) ? 0 : 1);</div><div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;</div><div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;          } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (std::string(word) == <span class="stringliteral">&quot;write_sg_errors&quot;</span>) {</div><div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;</div><div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;            <span class="keywordtype">char</span> answer[<a class="code" href="a00965.html#a51efea86a4d76d1259893f606b776573">_MAX_STRING_SIZE_</a>];</div><div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;            ferr = fscanf(in,<span class="stringliteral">&quot;%s&quot;</span>,answer); <span class="keywordflow">if</span> (ferr != 1) <span class="keywordflow">return</span>(1);</div><div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;            <a class="code" href="a02408.html#a8ccd402501119573dbadc7d6e96c59a2">m_print_sg_errors</a> = (strcmp(answer,<span class="stringliteral">&quot;yes&quot;</span>) ? 0 : 1);</div><div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;</div><div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;          } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (std::string(word) != <span class="stringliteral">&quot;end&quot;</span>) {</div><div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;</div><div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;            <span class="keywordtype">char</span> useless[<a class="code" href="a00965.html#a51efea86a4d76d1259893f606b776573">_MAX_STRING_SIZE_</a>];</div><div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;            ferr = fscanf(in,<span class="stringliteral">&quot;%s&quot;</span>,useless);</div><div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;            printf(<span class="stringliteral">&quot;Warning: keyword %s in file \&quot;%s\&quot; with value %s not recognized or extraneous. Ignoring.\n&quot;</span>,</div><div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;                    <a class="code" href="a01106.html#a04580f398fca92aa5aec64d17520153d">_SPARSEGRIDS_SIM_INP_FNAME_</a>, word, useless );</div><div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;</div><div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;          }</div><div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;</div><div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;          <span class="keywordflow">if</span> (ferr != 1) <span class="keywordflow">return</span>(1);</div><div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;        }</div><div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;</div><div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;      } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;        fprintf( stderr, <span class="stringliteral">&quot;Error: Illegal format in file \&quot;%s\&quot;. Word read is: %s\n&quot;</span>,</div><div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;                 <a class="code" href="a01106.html#a04580f398fca92aa5aec64d17520153d">_SPARSEGRIDS_SIM_INP_FNAME_</a>, word);</div><div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;        <span class="keywordflow">return</span> 1;</div><div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;      }</div><div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;</div><div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;      fclose(in);</div><div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;</div><div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;    }</div><div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;</div><div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;    <span class="comment">/* print useful stuff to screen */</span></div><div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;    printf(<span class="stringliteral">&quot;Sparse grids inputs:\n&quot;</span>);</div><div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;    printf(<span class="stringliteral">&quot;  log2 of minimum grid size:  %d\n&quot;</span>, <a class="code" href="a02408.html#a2e5b2d1500a445715e53baba327b79a7">m_imin</a>);</div><div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;    printf(<span class="stringliteral">&quot;  interpolation order:  %d\n&quot;</span>, <a class="code" href="a02408.html#a80c52a96f6a5a4851ac860d751587df6">m_interp_order</a>);</div><div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;    printf( <span class="stringliteral">&quot;  write sparse grids solutions?  %s\n&quot;</span>,</div><div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;            ( <a class="code" href="a02408.html#a634b90e62b481c87ad0ba4ee5c5feba4">m_write_sg_solutions</a> == 1 ? <span class="stringliteral">&quot;yes&quot;</span> : <span class="stringliteral">&quot;no&quot;</span> ) );</div><div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;  }</div><div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;</div><div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;<span class="preprocessor">#ifndef serial</span></div><div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;  MPI_Bcast(&amp;<a class="code" href="a02408.html#a2e5b2d1500a445715e53baba327b79a7">m_imin</a>,1,MPI_INT,0,MPI_COMM_WORLD);</div><div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;  MPI_Bcast(&amp;<a class="code" href="a02408.html#a80c52a96f6a5a4851ac860d751587df6">m_interp_order</a>,1,MPI_INT,0,MPI_COMM_WORLD);</div><div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;  MPI_Bcast(&amp;<a class="code" href="a02408.html#a634b90e62b481c87ad0ba4ee5c5feba4">m_write_sg_solutions</a>,1,MPI_INT,0,MPI_COMM_WORLD);</div><div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;  MPI_Bcast(&amp;<a class="code" href="a02408.html#a8ccd402501119573dbadc7d6e96c59a2">m_print_sg_errors</a>,1,MPI_INT,0,MPI_COMM_WORLD);</div><div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;</div><div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;  <a class="code" href="a02408.html#a41a86f682aa37c28c671759a11a494a8">m_sim_fg</a> = <span class="keyword">new</span> <a class="code" href="a01100.html#a02400">SimulationObject</a>;</div><div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;  <span class="comment">/* the following are deliberately set to junk values</span></div><div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;<span class="comment">   * to ensure they are never used */</span></div><div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;  <a class="code" href="a02408.html#a41a86f682aa37c28c671759a11a494a8">m_sim_fg</a>-&gt;<a class="code" href="a01100.html#a523947ce4fa7128c4c767163953253b9">solver</a>.<a class="code" href="a02280.html#a34488172a8ec6e0aaa03cbea46092d3a">my_idx</a> = -1;</div><div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;  <a class="code" href="a02408.html#a41a86f682aa37c28c671759a11a494a8">m_sim_fg</a>-&gt;<a class="code" href="a01100.html#a523947ce4fa7128c4c767163953253b9">solver</a>.<a class="code" href="a02280.html#a9a0e87291e0e8b9c1445e5482e814c92">nsims</a> = -1;</div><div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;  <span class="comment">/* these are okay */</span></div><div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;  <a class="code" href="a02408.html#a41a86f682aa37c28c671759a11a494a8">m_sim_fg</a>-&gt;<a class="code" href="a01100.html#a4afd2c7b3eb8fda452474ebdbe71c8c0">mpi</a>.<a class="code" href="a01028.html#a6cfd95afd0afebd625b889fb6e58371c">rank</a> = <a class="code" href="a02408.html#ac6a822dc76382e4027cf94ac3e510056">m_rank</a>;</div><div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;  <a class="code" href="a02408.html#a41a86f682aa37c28c671759a11a494a8">m_sim_fg</a>-&gt;<a class="code" href="a01100.html#a4afd2c7b3eb8fda452474ebdbe71c8c0">mpi</a>.<a class="code" href="a01028.html#ae68326adc3b3862f1162832f70727b06">nproc</a> = <a class="code" href="a02408.html#ae5bbe5daa629a4f92b569cb632256780">m_nproc</a>;</div><div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;</div><div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;  <span class="keywordflow">if</span> (!<a class="code" href="a02408.html#ac6a822dc76382e4027cf94ac3e510056">m_rank</a>) {</div><div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;    printf(<span class="stringliteral">&quot;Allocated full grid simulation object(s).\n&quot;</span>);</div><div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;  }</div><div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;</div><div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;  <a class="code" href="a02408.html#a4c049947a4c07f2d2df7d1374a4babae">m_is_defined</a> = <span class="keyword">true</span>;</div><div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;  <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;}</div><div class="ttc" id="a02408_html_a634b90e62b481c87ad0ba4ee5c5feba4"><div class="ttname"><a href="a02408.html#a634b90e62b481c87ad0ba4ee5c5feba4">SparseGridsSimulation::m_write_sg_solutions</a></div><div class="ttdeci">int m_write_sg_solutions</div><div class="ttdef"><b>Definition:</b> <a href="a01106_source.html#l00225">sparse_grids_simulation.h:225</a></div></div>
<div class="ttc" id="a00965_html_a51efea86a4d76d1259893f606b776573"><div class="ttname"><a href="a00965.html#a51efea86a4d76d1259893f606b776573">_MAX_STRING_SIZE_</a></div><div class="ttdeci">#define _MAX_STRING_SIZE_</div><div class="ttdef"><b>Definition:</b> <a href="a00965_source.html#l00014">basic.h:14</a></div></div>
<div class="ttc" id="a02408_html_a2e5b2d1500a445715e53baba327b79a7"><div class="ttname"><a href="a02408.html#a2e5b2d1500a445715e53baba327b79a7">SparseGridsSimulation::m_imin</a></div><div class="ttdeci">int m_imin</div><div class="ttdef"><b>Definition:</b> <a href="a01106_source.html#l00234">sparse_grids_simulation.h:234</a></div></div>
<div class="ttc" id="a02408_html_a41a86f682aa37c28c671759a11a494a8"><div class="ttname"><a href="a02408.html#a41a86f682aa37c28c671759a11a494a8">SparseGridsSimulation::m_sim_fg</a></div><div class="ttdeci">SimulationObject * m_sim_fg</div><div class="ttdef"><b>Definition:</b> <a href="a01106_source.html#l00230">sparse_grids_simulation.h:230</a></div></div>
<div class="ttc" id="a01100_html_a523947ce4fa7128c4c767163953253b9"><div class="ttname"><a href="a01100.html#a523947ce4fa7128c4c767163953253b9">SimulationObject::solver</a></div><div class="ttdeci">HyPar solver</div><div class="ttdef"><b>Definition:</b> <a href="a01100_source.html#l00026">simulation_object.h:26</a></div></div>
<div class="ttc" id="a01100_html_a02400"><div class="ttname"><a href="a01100.html#a02400">SimulationObject</a></div><div class="ttdoc">Structure defining a simulation. </div><div class="ttdef"><b>Definition:</b> <a href="a01100_source.html#l00023">simulation_object.h:23</a></div></div>
<div class="ttc" id="a02280_html_a34488172a8ec6e0aaa03cbea46092d3a"><div class="ttname"><a href="a02280.html#a34488172a8ec6e0aaa03cbea46092d3a">HyPar::my_idx</a></div><div class="ttdeci">int my_idx</div><div class="ttdef"><b>Definition:</b> <a href="a00986_source.html#l00061">hypar.h:61</a></div></div>
<div class="ttc" id="a02408_html_ac6a822dc76382e4027cf94ac3e510056"><div class="ttname"><a href="a02408.html#ac6a822dc76382e4027cf94ac3e510056">SparseGridsSimulation::m_rank</a></div><div class="ttdeci">int m_rank</div><div class="ttdef"><b>Definition:</b> <a href="a01106_source.html#l00216">sparse_grids_simulation.h:216</a></div></div>
<div class="ttc" id="a01100_html_a4afd2c7b3eb8fda452474ebdbe71c8c0"><div class="ttname"><a href="a01100.html#a4afd2c7b3eb8fda452474ebdbe71c8c0">SimulationObject::mpi</a></div><div class="ttdeci">MPIVariables mpi</div><div class="ttdef"><b>Definition:</b> <a href="a01100_source.html#l00025">simulation_object.h:25</a></div></div>
<div class="ttc" id="a02408_html_a4c049947a4c07f2d2df7d1374a4babae"><div class="ttname"><a href="a02408.html#a4c049947a4c07f2d2df7d1374a4babae">SparseGridsSimulation::m_is_defined</a></div><div class="ttdeci">bool m_is_defined</div><div class="ttdef"><b>Definition:</b> <a href="a01106_source.html#l00212">sparse_grids_simulation.h:212</a></div></div>
<div class="ttc" id="a02408_html_a8ccd402501119573dbadc7d6e96c59a2"><div class="ttname"><a href="a02408.html#a8ccd402501119573dbadc7d6e96c59a2">SparseGridsSimulation::m_print_sg_errors</a></div><div class="ttdeci">int m_print_sg_errors</div><div class="ttdef"><b>Definition:</b> <a href="a01106_source.html#l00228">sparse_grids_simulation.h:228</a></div></div>
<div class="ttc" id="a02280_html_a9a0e87291e0e8b9c1445e5482e814c92"><div class="ttname"><a href="a02280.html#a9a0e87291e0e8b9c1445e5482e814c92">HyPar::nsims</a></div><div class="ttdeci">int nsims</div><div class="ttdef"><b>Definition:</b> <a href="a00986_source.html#l00064">hypar.h:64</a></div></div>
<div class="ttc" id="a02408_html_ae5bbe5daa629a4f92b569cb632256780"><div class="ttname"><a href="a02408.html#ae5bbe5daa629a4f92b569cb632256780">SparseGridsSimulation::m_nproc</a></div><div class="ttdeci">int m_nproc</div><div class="ttdef"><b>Definition:</b> <a href="a01106_source.html#l00216">sparse_grids_simulation.h:216</a></div></div>
<div class="ttc" id="a02408_html_a80c52a96f6a5a4851ac860d751587df6"><div class="ttname"><a href="a02408.html#a80c52a96f6a5a4851ac860d751587df6">SparseGridsSimulation::m_interp_order</a></div><div class="ttdeci">int m_interp_order</div><div class="ttdef"><b>Definition:</b> <a href="a01106_source.html#l00220">sparse_grids_simulation.h:220</a></div></div>
<div class="ttc" id="a01028_html_a6cfd95afd0afebd625b889fb6e58371c"><div class="ttname"><a href="a01028.html#a6cfd95afd0afebd625b889fb6e58371c">MPIVariables::rank</a></div><div class="ttdeci">int rank</div><div class="ttdef"><b>Definition:</b> <a href="a01028_source.html#l00025">mpivars_struct.h:25</a></div></div>
<div class="ttc" id="a01028_html_ae68326adc3b3862f1162832f70727b06"><div class="ttname"><a href="a01028.html#ae68326adc3b3862f1162832f70727b06">MPIVariables::nproc</a></div><div class="ttdeci">int nproc</div><div class="ttdef"><b>Definition:</b> <a href="a01028_source.html#l00026">mpivars_struct.h:26</a></div></div>
<div class="ttc" id="a01106_html_a04580f398fca92aa5aec64d17520153d"><div class="ttname"><a href="a01106.html#a04580f398fca92aa5aec64d17520153d">_SPARSEGRIDS_SIM_INP_FNAME_</a></div><div class="ttdeci">#define _SPARSEGRIDS_SIM_INP_FNAME_</div><div class="ttdef"><b>Definition:</b> <a href="a01106_source.html#l00018">sparse_grids_simulation.h:18</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="aac7b43be31f27809e990d0d583faea0a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aac7b43be31f27809e990d0d583faea0a">&#9670;&nbsp;</a></span>ReadInputs()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int ReadInputs </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Read solver inputs for the full grid simulation object </p>

<p>Implements <a class="el" href="a02396.html#a244e2e73cec1f0fea51644611b95a948">Simulation</a>.</p>

<p class="definition">Definition at line <a class="el" href="a01106_source.html#l00086">86</a> of file <a class="el" href="a01106_source.html">sparse_grids_simulation.h</a>.</p>
<div class="fragment"><div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;    {</div><div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;      <span class="keywordtype">int</span> retval = <a class="code" href="a02408.html#aac7b43be31f27809e990d0d583faea0a">::ReadInputs</a>(  (<span class="keywordtype">void</span>*) <a class="code" href="a02408.html#a41a86f682aa37c28c671759a11a494a8">m_sim_fg</a>,</div><div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;                                  1, </div><div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;                                  <a class="code" href="a02408.html#ac6a822dc76382e4027cf94ac3e510056">m_rank</a> );</div><div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;      <span class="keywordflow">return</span> retval;</div><div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;    }</div><div class="ttc" id="a02408_html_a41a86f682aa37c28c671759a11a494a8"><div class="ttname"><a href="a02408.html#a41a86f682aa37c28c671759a11a494a8">SparseGridsSimulation::m_sim_fg</a></div><div class="ttdeci">SimulationObject * m_sim_fg</div><div class="ttdef"><b>Definition:</b> <a href="a01106_source.html#l00230">sparse_grids_simulation.h:230</a></div></div>
<div class="ttc" id="a02408_html_ac6a822dc76382e4027cf94ac3e510056"><div class="ttname"><a href="a02408.html#ac6a822dc76382e4027cf94ac3e510056">SparseGridsSimulation::m_rank</a></div><div class="ttdeci">int m_rank</div><div class="ttdef"><b>Definition:</b> <a href="a01106_source.html#l00216">sparse_grids_simulation.h:216</a></div></div>
<div class="ttc" id="a02408_html_aac7b43be31f27809e990d0d583faea0a"><div class="ttname"><a href="a02408.html#aac7b43be31f27809e990d0d583faea0a">SparseGridsSimulation::ReadInputs</a></div><div class="ttdeci">int ReadInputs()</div><div class="ttdef"><b>Definition:</b> <a href="a01106_source.html#l00086">sparse_grids_simulation.h:86</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a16e58435a7965b6c304c4d3e1600f0d7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a16e58435a7965b6c304c4d3e1600f0d7">&#9670;&nbsp;</a></span>Initialize()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int Initialize </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Initialize the simulation</p>
<p>Initialize all the stuff required for a sparse grids simulation. Before this function is called, the solver inputs for the full grid object has already been read, and therefore, the global dimensions and processor decompositions are available. This function does the following: </p>

<p>Implements <a class="el" href="a02396.html#a3b0c02ebf15841723aa500ffe7631fa8">Simulation</a>.</p>

<p class="definition">Definition at line <a class="el" href="a02165_source.html#l00015">15</a> of file <a class="el" href="a02165_source.html">SparseGridsInitialize.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;{</div><div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;  <span class="keywordtype">int</span> ierr;</div><div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;</div><div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;  <span class="comment">/* find out the number of spatial dimensions */</span></div><div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;  <a class="code" href="a02408.html#af3c229deae2a8e788c823dcc6f020b65">m_ndims</a> = <a class="code" href="a02408.html#a41a86f682aa37c28c671759a11a494a8">m_sim_fg</a>-&gt;<a class="code" href="a01100.html#a523947ce4fa7128c4c767163953253b9">solver</a>.<a class="code" href="a02280.html#a484873c74138512e41bc50d17b7d955a">ndims</a>;</div><div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;</div><div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;  <span class="comment">/* make sure full grid simulation object is allocated */</span></div><div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="a02408.html#a41a86f682aa37c28c671759a11a494a8">m_sim_fg</a> == NULL) {</div><div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;    fprintf(stderr, <span class="stringliteral">&quot;Error in SparseGridsSimulation::Initialize()\n&quot;</span>);</div><div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;    fprintf(stderr, <span class="stringliteral">&quot;  m_sim_fg is NULL on rank %d!\n&quot;</span>, <a class="code" href="a02408.html#ac6a822dc76382e4027cf94ac3e510056">m_rank</a>);</div><div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;    <span class="keywordflow">return</span> 1;</div><div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;  }</div><div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;</div><div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;  <span class="comment">/* set full grid processor distribution based on grid size and </span></div><div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;<span class="comment">   * number of MPI ranks */</span></div><div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;  <a class="code" href="a01106.html#a00167df288a1ca2c6c32af8d911975e0">GridDimensions</a> dim_fg(<a class="code" href="a02408.html#af3c229deae2a8e788c823dcc6f020b65">m_ndims</a>);</div><div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> d=0; d&lt;<a class="code" href="a02408.html#af3c229deae2a8e788c823dcc6f020b65">m_ndims</a>; d++) dim_fg[d] = <a class="code" href="a02408.html#a41a86f682aa37c28c671759a11a494a8">m_sim_fg</a>-&gt;<a class="code" href="a01100.html#a523947ce4fa7128c4c767163953253b9">solver</a>.<a class="code" href="a02280.html#aa989ebb755986852177779cdf7bd8c85">dim_global</a>[d];</div><div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;  <a class="code" href="a01106.html#a4e1436c018a5aad717fb73ca9004bcfc">ProcDistribution</a> iproc_fg;</div><div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;  <a class="code" href="a02408.html#ad9caeac8fa38b61362225c3a40b2a4cc">ComputeProcessorDistribution</a>(iproc_fg, dim_fg);</div><div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> d=0; d&lt;<a class="code" href="a02408.html#af3c229deae2a8e788c823dcc6f020b65">m_ndims</a>; d++) <a class="code" href="a02408.html#a41a86f682aa37c28c671759a11a494a8">m_sim_fg</a>-&gt;<a class="code" href="a01100.html#a4afd2c7b3eb8fda452474ebdbe71c8c0">mpi</a>.<a class="code" href="a01028.html#a0be0f30a83bc3f3d9f6ee3a36bbf2716">iproc</a>[d] = iproc_fg[d];</div><div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;  <a class="code" href="a01022.html#acd7957559b9206224c7da3cab4f22b27">MPIBroadcast_integer</a>( <a class="code" href="a02408.html#a41a86f682aa37c28c671759a11a494a8">m_sim_fg</a>-&gt;<a class="code" href="a01100.html#a4afd2c7b3eb8fda452474ebdbe71c8c0">mpi</a>.<a class="code" href="a01028.html#a0be0f30a83bc3f3d9f6ee3a36bbf2716">iproc</a>,</div><div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;                        <a class="code" href="a02408.html#af3c229deae2a8e788c823dcc6f020b65">m_ndims</a>,</div><div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;                        0,</div><div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;                        &amp;(<a class="code" href="a02408.html#a41a86f682aa37c28c671759a11a494a8">m_sim_fg</a>-&gt;<a class="code" href="a01100.html#a4afd2c7b3eb8fda452474ebdbe71c8c0">mpi</a>.<a class="code" href="a01028.html#adad7a6f85831f3ac84d854b6c80aef43">world</a>)); <a class="code" href="a00965.html#add9cf96ae374934d245a1dc1ab697a42">CHECKERR</a>(ierr);</div><div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;</div><div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;  <a class="code" href="a01094.html#ab7f2f81eb1c5fa3514754cac29eee868">::WriteInputs</a>( (<span class="keywordtype">void</span>*) <a class="code" href="a02408.html#a41a86f682aa37c28c671759a11a494a8">m_sim_fg</a>, 1, <a class="code" href="a02408.html#ac6a822dc76382e4027cf94ac3e510056">m_rank</a>);</div><div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;  <span class="keywordflow">if</span> (!<a class="code" href="a02408.html#ac6a822dc76382e4027cf94ac3e510056">m_rank</a>) {</div><div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;    printf(<span class="stringliteral">&quot;Processor distribution for full grid object: &quot;</span>);</div><div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> d=0; d&lt;<a class="code" href="a02408.html#af3c229deae2a8e788c823dcc6f020b65">m_ndims</a>; d++) printf(<span class="stringliteral">&quot; %3d&quot;</span>, iproc_fg[d]);</div><div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;    printf(<span class="stringliteral">&quot;\n&quot;</span>);</div><div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;  }</div><div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160; </div><div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;  <span class="keywordflow">if</span> (!<a class="code" href="a02408.html#ac6a822dc76382e4027cf94ac3e510056">m_rank</a>) printf(<span class="stringliteral">&quot;Initializing sparse grids...\n&quot;</span>);</div><div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;  <span class="keywordflow">if</span> (!<a class="code" href="a02408.html#ac6a822dc76382e4027cf94ac3e510056">m_rank</a>) printf(<span class="stringliteral">&quot;  Number of spatial dimensions: %d\n&quot;</span>, <a class="code" href="a02408.html#af3c229deae2a8e788c823dcc6f020b65">m_ndims</a>);</div><div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;</div><div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;  <span class="comment">/* some sanity checks */</span></div><div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;  ierr = <a class="code" href="a02408.html#a19987c0f2b999b6e820231a32667ddf2">SanityChecks</a>();</div><div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;  <span class="keywordflow">if</span> (ierr) <span class="keywordflow">return</span> ierr;</div><div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;</div><div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;  <span class="comment">/* compute the sizes of grids that go into the combination technique */</span></div><div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;  <span class="keywordflow">if</span> (!<a class="code" href="a02408.html#ac6a822dc76382e4027cf94ac3e510056">m_rank</a>) {</div><div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;    printf(<span class="stringliteral">&quot;  Computing sparse grids dimensions...\n&quot;</span>);</div><div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;  }</div><div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;  ierr = <a class="code" href="a02408.html#a8597237e7fe0da204967fedff70bc314">ComputeSGDimsAndCoeffs</a>();</div><div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;  <span class="keywordflow">if</span> (ierr) <span class="keywordflow">return</span> ierr;</div><div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;  <a class="code" href="a02408.html#acd95922d6bb09419fb66435d114cdb5c">m_nsims_sg</a> = <a class="code" href="a02408.html#a8b468da0c8b3831ae8b1519d8781245f">m_combination</a>.size();</div><div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;  <span class="keywordflow">if</span> (!<a class="code" href="a02408.html#ac6a822dc76382e4027cf94ac3e510056">m_rank</a>) {</div><div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;    printf( <span class="stringliteral">&quot;  Number of sparse grid domains in combination technique: %d\n&quot;</span>,</div><div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;            <a class="code" href="a02408.html#acd95922d6bb09419fb66435d114cdb5c">m_nsims_sg</a> );</div><div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;  }</div><div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="a02408.html#acd95922d6bb09419fb66435d114cdb5c">m_nsims_sg</a> == 0) {</div><div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;    fprintf(stderr, <span class="stringliteral">&quot;Error in SparseGridsSimulation::Initialize()\n&quot;</span>);</div><div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;    fprintf(stderr, <span class="stringliteral">&quot;  ComputeSGDimsAndCoeffs() returned empty vector!\n&quot;</span>);</div><div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;    <span class="keywordflow">return</span> 1;</div><div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;  }</div><div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;</div><div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;  <span class="comment">/* compute processor distributions for the sparse grids */</span></div><div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;  <span class="keywordflow">if</span> (!<a class="code" href="a02408.html#ac6a822dc76382e4027cf94ac3e510056">m_rank</a>) {</div><div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;    printf(<span class="stringliteral">&quot;  Computing processor decompositions...\n&quot;</span>);</div><div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;  }</div><div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;  <a class="code" href="a02408.html#a5da433fbee71264a45061bb0b3063326">m_iprocs</a>.resize(<a class="code" href="a02408.html#acd95922d6bb09419fb66435d114cdb5c">m_nsims_sg</a>);</div><div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="a02408.html#acd95922d6bb09419fb66435d114cdb5c">m_nsims_sg</a>; i++) {</div><div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;    ierr = <a class="code" href="a02408.html#ad9caeac8fa38b61362225c3a40b2a4cc">ComputeProcessorDistribution</a>(  <a class="code" href="a02408.html#a5da433fbee71264a45061bb0b3063326">m_iprocs</a>[i],</div><div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;                                          <a class="code" href="a02408.html#a8b468da0c8b3831ae8b1519d8781245f">m_combination</a>[i].<a class="code" href="a01106.html#af9ca06260bb76d53e9c99158533e471b">_dim_</a> );</div><div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;</div><div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;    <span class="keywordflow">if</span> (ierr) <span class="keywordflow">return</span> ierr;</div><div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;  }</div><div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;</div><div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;  <span class="comment">/* Print some stuff to screen */</span></div><div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;  <span class="keywordflow">if</span> (!<a class="code" href="a02408.html#ac6a822dc76382e4027cf94ac3e510056">m_rank</a>) {</div><div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;    printf(<span class="stringliteral">&quot;Sparse Grids: Combination technique grids sizes and coefficients are:-\n&quot;</span>);</div><div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="a02408.html#acd95922d6bb09419fb66435d114cdb5c">m_nsims_sg</a>; i++) {</div><div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;      printf(<span class="stringliteral">&quot;  %3d: dim = (&quot;</span>, i);</div><div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> d=0; d&lt;<a class="code" href="a02408.html#af3c229deae2a8e788c823dcc6f020b65">m_ndims</a>; d++) printf(<span class="stringliteral">&quot; %4d &quot;</span>, <a class="code" href="a02408.html#a8b468da0c8b3831ae8b1519d8781245f">m_combination</a>[i].<a class="code" href="a01106.html#af9ca06260bb76d53e9c99158533e471b">_dim_</a>[d]);</div><div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;      printf(<span class="stringliteral">&quot;),  coeff = %+1.2e, &quot;</span>, <a class="code" href="a02408.html#a8b468da0c8b3831ae8b1519d8781245f">m_combination</a>[i].<a class="code" href="a01106.html#a49e7a38c3e1faf8672f8b21b89f703a6">_coeff_</a>);</div><div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;      printf(<span class="stringliteral">&quot;iproc = (&quot;</span>);</div><div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> d=0; d&lt;<a class="code" href="a02408.html#af3c229deae2a8e788c823dcc6f020b65">m_ndims</a>; d++) printf(<span class="stringliteral">&quot; %4d &quot;</span>, <a class="code" href="a02408.html#a5da433fbee71264a45061bb0b3063326">m_iprocs</a>[i][d]);</div><div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;      printf(<span class="stringliteral">&quot;)\n&quot;</span>);</div><div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;    }</div><div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;  }</div><div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;</div><div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;  <span class="comment">/* allocate full grid data structures (only what is needed) */</span></div><div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;  ierr = <a class="code" href="a02408.html#a02a78692b8cc62fbfb25bcdb20a9a590">InitializeBarebones</a>(<a class="code" href="a02408.html#a41a86f682aa37c28c671759a11a494a8">m_sim_fg</a>);</div><div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;  <span class="keywordflow">if</span> (ierr) <span class="keywordflow">return</span> ierr;</div><div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;</div><div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;  <span class="comment">/* create sparse grids simulation objects */</span></div><div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;  <a class="code" href="a02408.html#afd006361179964b4e2c2cc65526247bd">m_sims_sg</a>.resize(<a class="code" href="a02408.html#acd95922d6bb09419fb66435d114cdb5c">m_nsims_sg</a>);</div><div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;  <span class="comment">/* set the solver parameters for the sparse grids sim objects */</span></div><div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="a02408.html#acd95922d6bb09419fb66435d114cdb5c">m_nsims_sg</a>; i++) {</div><div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;<span class="preprocessor">#ifndef serial</span></div><div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;    MPI_Comm_dup(MPI_COMM_WORLD, &amp;(<a class="code" href="a02408.html#afd006361179964b4e2c2cc65526247bd">m_sims_sg</a>[i].mpi.world));</div><div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;    ierr = <a class="code" href="a02408.html#abc369c6ea10a947feae5c3f365670d6e">SetSolverParameters</a>( <a class="code" href="a02408.html#afd006361179964b4e2c2cc65526247bd">m_sims_sg</a>[i],</div><div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;                                <a class="code" href="a02408.html#a8b468da0c8b3831ae8b1519d8781245f">m_combination</a>[i].<a class="code" href="a01106.html#af9ca06260bb76d53e9c99158533e471b">_dim_</a>,</div><div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;                                <a class="code" href="a02408.html#a5da433fbee71264a45061bb0b3063326">m_iprocs</a>[i],</div><div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;                                *<a class="code" href="a02408.html#a41a86f682aa37c28c671759a11a494a8">m_sim_fg</a>,</div><div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;                                i,</div><div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;                                <a class="code" href="a02408.html#acd95922d6bb09419fb66435d114cdb5c">m_nsims_sg</a> );</div><div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;    <span class="keywordflow">if</span> (ierr) <span class="keywordflow">return</span> ierr;</div><div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;  }</div><div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;</div><div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;  <span class="comment">/* allocate their data structures (everything) */</span></div><div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;  ierr = <a class="code" href="a02408.html#a16e58435a7965b6c304c4d3e1600f0d7">::Initialize</a>( (<span class="keywordtype">void</span>*) <a class="code" href="a02408.html#afd006361179964b4e2c2cc65526247bd">m_sims_sg</a>.data(), <a class="code" href="a02408.html#acd95922d6bb09419fb66435d114cdb5c">m_nsims_sg</a>);</div><div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;  <span class="keywordflow">if</span> (ierr) <span class="keywordflow">return</span> ierr;</div><div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;</div><div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;  <span class="comment">/* compute and report total NDOFs for sparse grids */</span></div><div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;  <span class="keywordtype">long</span> ndof_sg = 0;</div><div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="a02408.html#acd95922d6bb09419fb66435d114cdb5c">m_nsims_sg</a>; i++) {</div><div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;    ndof_sg += <a class="code" href="a02408.html#afd006361179964b4e2c2cc65526247bd">m_sims_sg</a>[i].solver.npoints_global;</div><div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;  }</div><div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;  <span class="keywordtype">long</span> ndof_fg = <a class="code" href="a02408.html#a41a86f682aa37c28c671759a11a494a8">m_sim_fg</a>-&gt;<a class="code" href="a01100.html#a523947ce4fa7128c4c767163953253b9">solver</a>.<a class="code" href="a02280.html#a4e67f54563a3c4ff005dfaf0130f957c">npoints_global</a>;</div><div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;  <span class="keywordflow">if</span> (!<a class="code" href="a02408.html#ac6a822dc76382e4027cf94ac3e510056">m_rank</a>) {</div><div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;    printf(<span class="stringliteral">&quot;Total number of DOFs:-\n&quot;</span>);</div><div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;    printf(<span class="stringliteral">&quot;  using sparse grids: %d\n&quot;</span>, (<span class="keywordtype">int</span>)ndof_sg);</div><div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;    printf(<span class="stringliteral">&quot;  using conventional grid: %d\n&quot;</span>, (<span class="keywordtype">int</span>)ndof_fg);</div><div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;  }</div><div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;</div><div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;  <span class="comment">/* done */</span></div><div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;  <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;}</div><div class="ttc" id="a02280_html_a484873c74138512e41bc50d17b7d955a"><div class="ttname"><a href="a02280.html#a484873c74138512e41bc50d17b7d955a">HyPar::ndims</a></div><div class="ttdeci">int ndims</div><div class="ttdef"><b>Definition:</b> <a href="a00986_source.html#l00026">hypar.h:26</a></div></div>
<div class="ttc" id="a02408_html_acd95922d6bb09419fb66435d114cdb5c"><div class="ttname"><a href="a02408.html#acd95922d6bb09419fb66435d114cdb5c">SparseGridsSimulation::m_nsims_sg</a></div><div class="ttdeci">int m_nsims_sg</div><div class="ttdef"><b>Definition:</b> <a href="a01106_source.html#l00214">sparse_grids_simulation.h:214</a></div></div>
<div class="ttc" id="a00965_html_add9cf96ae374934d245a1dc1ab697a42"><div class="ttname"><a href="a00965.html#add9cf96ae374934d245a1dc1ab697a42">CHECKERR</a></div><div class="ttdeci">#define CHECKERR(ierr)</div><div class="ttdef"><b>Definition:</b> <a href="a00965_source.html#l00018">basic.h:18</a></div></div>
<div class="ttc" id="a01106_html_a4e1436c018a5aad717fb73ca9004bcfc"><div class="ttname"><a href="a01106.html#a4e1436c018a5aad717fb73ca9004bcfc">ProcDistribution</a></div><div class="ttdeci">std::vector&lt; int &gt; ProcDistribution</div><div class="ttdef"><b>Definition:</b> <a href="a01106_source.html#l00021">sparse_grids_simulation.h:21</a></div></div>
<div class="ttc" id="a02408_html_abc369c6ea10a947feae5c3f365670d6e"><div class="ttname"><a href="a02408.html#abc369c6ea10a947feae5c3f365670d6e">SparseGridsSimulation::SetSolverParameters</a></div><div class="ttdeci">int SetSolverParameters(SimulationObject &amp;, const GridDimensions &amp;, const ProcDistribution &amp;, const SimulationObject &amp;, const int, const int)</div><div class="ttdef"><b>Definition:</b> <a href="a02186_source.html#l00011">SparseGridsSetSolverParameters.cpp:11</a></div></div>
<div class="ttc" id="a01028_html_adad7a6f85831f3ac84d854b6c80aef43"><div class="ttname"><a href="a01028.html#adad7a6f85831f3ac84d854b6c80aef43">MPIVariables::world</a></div><div class="ttdeci">MPI_Comm world</div><div class="ttdef"><b>Definition:</b> <a href="a01028_source.html#l00037">mpivars_struct.h:37</a></div></div>
<div class="ttc" id="a02280_html_aa989ebb755986852177779cdf7bd8c85"><div class="ttname"><a href="a02280.html#aa989ebb755986852177779cdf7bd8c85">HyPar::dim_global</a></div><div class="ttdeci">int * dim_global</div><div class="ttdef"><b>Definition:</b> <a href="a00986_source.html#l00033">hypar.h:33</a></div></div>
<div class="ttc" id="a01028_html_a0be0f30a83bc3f3d9f6ee3a36bbf2716"><div class="ttname"><a href="a01028.html#a0be0f30a83bc3f3d9f6ee3a36bbf2716">MPIVariables::iproc</a></div><div class="ttdeci">int * iproc</div><div class="ttdef"><b>Definition:</b> <a href="a01028_source.html#l00027">mpivars_struct.h:27</a></div></div>
<div class="ttc" id="a02408_html_a41a86f682aa37c28c671759a11a494a8"><div class="ttname"><a href="a02408.html#a41a86f682aa37c28c671759a11a494a8">SparseGridsSimulation::m_sim_fg</a></div><div class="ttdeci">SimulationObject * m_sim_fg</div><div class="ttdef"><b>Definition:</b> <a href="a01106_source.html#l00230">sparse_grids_simulation.h:230</a></div></div>
<div class="ttc" id="a01100_html_a523947ce4fa7128c4c767163953253b9"><div class="ttname"><a href="a01100.html#a523947ce4fa7128c4c767163953253b9">SimulationObject::solver</a></div><div class="ttdeci">HyPar solver</div><div class="ttdef"><b>Definition:</b> <a href="a01100_source.html#l00026">simulation_object.h:26</a></div></div>
<div class="ttc" id="a02408_html_af3c229deae2a8e788c823dcc6f020b65"><div class="ttname"><a href="a02408.html#af3c229deae2a8e788c823dcc6f020b65">SparseGridsSimulation::m_ndims</a></div><div class="ttdeci">int m_ndims</div><div class="ttdef"><b>Definition:</b> <a href="a01106_source.html#l00215">sparse_grids_simulation.h:215</a></div></div>
<div class="ttc" id="a02408_html_a8597237e7fe0da204967fedff70bc314"><div class="ttname"><a href="a02408.html#a8597237e7fe0da204967fedff70bc314">SparseGridsSimulation::ComputeSGDimsAndCoeffs</a></div><div class="ttdeci">int ComputeSGDimsAndCoeffs()</div><div class="ttdef"><b>Definition:</b> <a href="a02177_source.html#l00020">SparseGridsMiscFuncs.cpp:20</a></div></div>
<div class="ttc" id="a02408_html_a16e58435a7965b6c304c4d3e1600f0d7"><div class="ttname"><a href="a02408.html#a16e58435a7965b6c304c4d3e1600f0d7">SparseGridsSimulation::Initialize</a></div><div class="ttdeci">int Initialize()</div><div class="ttdef"><b>Definition:</b> <a href="a02165_source.html#l00015">SparseGridsInitialize.cpp:15</a></div></div>
<div class="ttc" id="a02408_html_ac6a822dc76382e4027cf94ac3e510056"><div class="ttname"><a href="a02408.html#ac6a822dc76382e4027cf94ac3e510056">SparseGridsSimulation::m_rank</a></div><div class="ttdeci">int m_rank</div><div class="ttdef"><b>Definition:</b> <a href="a01106_source.html#l00216">sparse_grids_simulation.h:216</a></div></div>
<div class="ttc" id="a02408_html_ad9caeac8fa38b61362225c3a40b2a4cc"><div class="ttname"><a href="a02408.html#ad9caeac8fa38b61362225c3a40b2a4cc">SparseGridsSimulation::ComputeProcessorDistribution</a></div><div class="ttdeci">int ComputeProcessorDistribution(ProcDistribution &amp;, const GridDimensions &amp;)</div><div class="ttdef"><b>Definition:</b> <a href="a02177_source.html#l00081">SparseGridsMiscFuncs.cpp:81</a></div></div>
<div class="ttc" id="a01106_html_a49e7a38c3e1faf8672f8b21b89f703a6"><div class="ttname"><a href="a01106.html#a49e7a38c3e1faf8672f8b21b89f703a6">_coeff_</a></div><div class="ttdeci">#define _coeff_</div><div class="ttdef"><b>Definition:</b> <a href="a01106_source.html#l00024">sparse_grids_simulation.h:24</a></div></div>
<div class="ttc" id="a01100_html_a4afd2c7b3eb8fda452474ebdbe71c8c0"><div class="ttname"><a href="a01100.html#a4afd2c7b3eb8fda452474ebdbe71c8c0">SimulationObject::mpi</a></div><div class="ttdeci">MPIVariables mpi</div><div class="ttdef"><b>Definition:</b> <a href="a01100_source.html#l00025">simulation_object.h:25</a></div></div>
<div class="ttc" id="a01094_html_ab7f2f81eb1c5fa3514754cac29eee868"><div class="ttname"><a href="a01094.html#ab7f2f81eb1c5fa3514754cac29eee868">WriteInputs</a></div><div class="ttdeci">int WriteInputs(void *, int, int)</div><div class="ttdef"><b>Definition:</b> <a href="a02147_source.html#l00015">WriteInputs.c:15</a></div></div>
<div class="ttc" id="a02408_html_afd006361179964b4e2c2cc65526247bd"><div class="ttname"><a href="a02408.html#afd006361179964b4e2c2cc65526247bd">SparseGridsSimulation::m_sims_sg</a></div><div class="ttdeci">std::vector&lt; SimulationObject &gt; m_sims_sg</div><div class="ttdef"><b>Definition:</b> <a href="a01106_source.html#l00231">sparse_grids_simulation.h:231</a></div></div>
<div class="ttc" id="a02408_html_a02a78692b8cc62fbfb25bcdb20a9a590"><div class="ttname"><a href="a02408.html#a02a78692b8cc62fbfb25bcdb20a9a590">SparseGridsSimulation::InitializeBarebones</a></div><div class="ttdeci">int InitializeBarebones(SimulationObject *)</div><div class="ttdef"><b>Definition:</b> <a href="a02177_source.html#l00190">SparseGridsMiscFuncs.cpp:190</a></div></div>
<div class="ttc" id="a02408_html_a5da433fbee71264a45061bb0b3063326"><div class="ttname"><a href="a02408.html#a5da433fbee71264a45061bb0b3063326">SparseGridsSimulation::m_iprocs</a></div><div class="ttdeci">std::vector&lt; ProcDistribution &gt; m_iprocs</div><div class="ttdef"><b>Definition:</b> <a href="a01106_source.html#l00237">sparse_grids_simulation.h:237</a></div></div>
<div class="ttc" id="a01022_html_acd7957559b9206224c7da3cab4f22b27"><div class="ttname"><a href="a01022.html#acd7957559b9206224c7da3cab4f22b27">MPIBroadcast_integer</a></div><div class="ttdeci">int MPIBroadcast_integer(int *, int, int, void *)</div><div class="ttdef"><b>Definition:</b> <a href="a01463_source.html#l00023">MPIBroadcast.c:23</a></div></div>
<div class="ttc" id="a02408_html_a8b468da0c8b3831ae8b1519d8781245f"><div class="ttname"><a href="a02408.html#a8b468da0c8b3831ae8b1519d8781245f">SparseGridsSimulation::m_combination</a></div><div class="ttdeci">std::vector&lt; SGCTElem &gt; m_combination</div><div class="ttdef"><b>Definition:</b> <a href="a01106_source.html#l00236">sparse_grids_simulation.h:236</a></div></div>
<div class="ttc" id="a02280_html_a4e67f54563a3c4ff005dfaf0130f957c"><div class="ttname"><a href="a02280.html#a4e67f54563a3c4ff005dfaf0130f957c">HyPar::npoints_global</a></div><div class="ttdeci">int npoints_global</div><div class="ttdef"><b>Definition:</b> <a href="a00986_source.html#l00040">hypar.h:40</a></div></div>
<div class="ttc" id="a02408_html_a19987c0f2b999b6e820231a32667ddf2"><div class="ttname"><a href="a02408.html#a19987c0f2b999b6e820231a32667ddf2">SparseGridsSimulation::SanityChecks</a></div><div class="ttdeci">int SanityChecks()</div><div class="ttdef"><b>Definition:</b> <a href="a02183_source.html#l00018">SparseGridsSanityChecks.cpp:18</a></div></div>
<div class="ttc" id="a01106_html_af9ca06260bb76d53e9c99158533e471b"><div class="ttname"><a href="a01106.html#af9ca06260bb76d53e9c99158533e471b">_dim_</a></div><div class="ttdeci">#define _dim_</div><div class="ttdef"><b>Definition:</b> <a href="a01106_source.html#l00025">sparse_grids_simulation.h:25</a></div></div>
<div class="ttc" id="a01106_html_a00167df288a1ca2c6c32af8d911975e0"><div class="ttname"><a href="a01106.html#a00167df288a1ca2c6c32af8d911975e0">GridDimensions</a></div><div class="ttdeci">std::vector&lt; int &gt; GridDimensions</div><div class="ttdef"><b>Definition:</b> <a href="a01106_source.html#l00020">sparse_grids_simulation.h:20</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a4f0b968820fa465fde318fa0100ff23f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4f0b968820fa465fde318fa0100ff23f">&#9670;&nbsp;</a></span>InitialSolution()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int InitialSolution </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Read initial solution</p>
<p>Reads in the initial solution for the full grid, saves it in the full grid object. Then interpolates (coarsens) the grid coordinates to all the sparge grids. The solution is not yet interpolated because boundary information is not yet available. It is done in <a class="el" href="a02408.html#a6009f77fd5b9738911ebf3196682316d">SparseGridsSimulation::InitializationWrapup()</a>. </p>

<p>Implements <a class="el" href="a02396.html#aca2404a81eabb4a12292d1e2e0475b13">Simulation</a>.</p>

<p class="definition">Definition at line <a class="el" href="a02168_source.html#l00017">17</a> of file <a class="el" href="a02168_source.html">SparseGridsInitialSolution.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;{</div><div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;  <span class="keywordtype">int</span> ierr;</div><div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;</div><div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;  <span class="comment">/* first, read in the full grid initial solution */</span></div><div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;  <span class="keywordtype">int</span> retval = <a class="code" href="a02408.html#a4f0b968820fa465fde318fa0100ff23f">::InitialSolution</a>( (<span class="keywordtype">void</span>*) <a class="code" href="a02408.html#a41a86f682aa37c28c671759a11a494a8">m_sim_fg</a>, 1 );</div><div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;  <span class="keywordflow">if</span> (retval) <span class="keywordflow">return</span> retval;</div><div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;</div><div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;  <span class="comment">/* now, interpolate to all the sparse grids */</span></div><div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> n = 0; n &lt; <a class="code" href="a02408.html#acd95922d6bb09419fb66435d114cdb5c">m_nsims_sg</a>; n++) {</div><div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;</div><div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="a02408.html#ac6a822dc76382e4027cf94ac3e510056">m_rank</a>) {</div><div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;      printf(<span class="stringliteral">&quot;Interpolating grid coordinates to sparse grids domain %d.\n&quot;</span>, n);</div><div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;    }</div><div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;    <a class="code" href="a02408.html#a20303c6aa17833ad691479008c2ce676">interpolateGrid</a>( &amp;<a class="code" href="a02408.html#afd006361179964b4e2c2cc65526247bd">m_sims_sg</a>[n], <a class="code" href="a02408.html#a41a86f682aa37c28c671759a11a494a8">m_sim_fg</a> );</div><div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;</div><div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;    <a class="code" href="a02280.html">HyPar</a>* solver = &amp;(<a class="code" href="a02408.html#afd006361179964b4e2c2cc65526247bd">m_sims_sg</a>[n].solver);</div><div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;    <a class="code" href="a01028.html#a02320">MPIVariables</a>* mpi = &amp;(<a class="code" href="a02408.html#afd006361179964b4e2c2cc65526247bd">m_sims_sg</a>[n].mpi);</div><div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;</div><div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;    <span class="keywordtype">int</span> nvars = solver-&gt;<a class="code" href="a02280.html#ae8f6d2fd6490d3153cb4133bf183a404">nvars</a>;</div><div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;    <span class="keywordtype">int</span> ghosts = solver-&gt;<a class="code" href="a02280.html#aafc992b5fa79d5a4036024615d03bce6">ghosts</a>;</div><div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;    <span class="keywordtype">int</span> *dim_local = solver-&gt;<a class="code" href="a02280.html#a38e0371f331cecbe63a77fa03e202afe">dim_local</a>;</div><div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;</div><div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;    <span class="comment">/* calculate dxinv */</span></div><div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;    {</div><div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;      <span class="keywordtype">int</span> offset = 0;</div><div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> d = 0; d &lt; <a class="code" href="a02408.html#af3c229deae2a8e788c823dcc6f020b65">m_ndims</a>; d++) {</div><div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; dim_local[d]; i++) {</div><div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;          solver-&gt;<a class="code" href="a02280.html#aa24a4f5e29bd70cbe5a2413be1ea9682">dxinv</a>[i+offset+ghosts] </div><div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;            = 2.0 / (   solver-&gt;<a class="code" href="a02280.html#a711aad4cbe735871dd9e91ab575c878b">x</a>[i+1+offset+ghosts]</div><div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;                      - solver-&gt;<a class="code" href="a02280.html#a711aad4cbe735871dd9e91ab575c878b">x</a>[i-1+offset+ghosts]  );</div><div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;        }</div><div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;        offset += (dim_local[d] + 2*ghosts);</div><div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;      }</div><div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;    }</div><div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;</div><div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;    <span class="comment">/* exchange MPI-boundary values of dxinv between processors */</span></div><div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;    {</div><div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;      <span class="keywordtype">int</span> offset = 0;</div><div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> d = 0; d &lt; <a class="code" href="a02408.html#af3c229deae2a8e788c823dcc6f020b65">m_ndims</a>; d++) {</div><div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;        ierr = <a class="code" href="a01022.html#ac2f0cce702a9ce439753286ce227c7a2">MPIExchangeBoundaries1D</a>( mpi,</div><div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;                                        &amp;(solver-&gt;<a class="code" href="a02280.html#aa24a4f5e29bd70cbe5a2413be1ea9682">dxinv</a>[offset]),</div><div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;                                        dim_local[d],</div><div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;                                        ghosts,</div><div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;                                        d,</div><div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;                                        <a class="code" href="a02408.html#af3c229deae2a8e788c823dcc6f020b65">m_ndims</a> );</div><div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;        <span class="keywordflow">if</span> (ierr) <span class="keywordflow">return</span> ierr;</div><div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;        offset += (dim_local[d] + 2*ghosts);</div><div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;      }</div><div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;    }</div><div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;</div><div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;    <span class="comment">/* fill in ghost values of dxinv at physical boundaries by extrapolation */</span></div><div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;    {</div><div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;      <span class="keywordtype">int</span> offset = 0;</div><div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> d = 0; d &lt; <a class="code" href="a02408.html#af3c229deae2a8e788c823dcc6f020b65">m_ndims</a>; d++) {</div><div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;        <span class="keywordtype">double</span> *dxinv = &amp;(solver-&gt;<a class="code" href="a02280.html#aa24a4f5e29bd70cbe5a2413be1ea9682">dxinv</a>[offset]);</div><div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;        <span class="keywordtype">int</span>    *dim = dim_local;</div><div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;        <span class="keywordflow">if</span> (mpi-&gt;<a class="code" href="a01028.html#aa3c28612a64b8a97bde66b720e15c700">ip</a>[d] == 0) {</div><div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;          <span class="comment">/* fill left boundary along this dimension */</span></div><div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;          <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; ghosts; i++) dxinv[i] = dxinv[ghosts];</div><div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;        }</div><div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;        <span class="keywordflow">if</span> (mpi-&gt;<a class="code" href="a01028.html#aa3c28612a64b8a97bde66b720e15c700">ip</a>[d] == mpi-&gt;<a class="code" href="a01028.html#a0be0f30a83bc3f3d9f6ee3a36bbf2716">iproc</a>[d]-1) {</div><div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;          <span class="comment">/* fill right boundary along this dimension */</span></div><div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;          <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = dim[d]+ghosts; i &lt; dim[d]+2*ghosts; i++) {</div><div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;            dxinv[i] = dxinv[dim[d]+ghosts-1];</div><div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;          }</div><div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;        }</div><div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;        offset  += (dim[d] + 2*ghosts);</div><div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;      }</div><div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;    }</div><div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;</div><div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;  }</div><div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;</div><div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;  <span class="keywordflow">return</span> 0; </div><div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;}</div><div class="ttc" id="a01022_html_ac2f0cce702a9ce439753286ce227c7a2"><div class="ttname"><a href="a01022.html#ac2f0cce702a9ce439753286ce227c7a2">MPIExchangeBoundaries1D</a></div><div class="ttdeci">int MPIExchangeBoundaries1D(void *, double *, int, int, int, int)</div><div class="ttdef"><b>Definition:</b> <a href="a01469_source.html#l00032">MPIExchangeBoundaries1D.c:32</a></div></div>
<div class="ttc" id="a02280_html"><div class="ttname"><a href="a02280.html">HyPar</a></div><div class="ttdoc">Structure containing all solver-specific variables and functions. </div><div class="ttdef"><b>Definition:</b> <a href="a00986_source.html#l00023">hypar.h:23</a></div></div>
<div class="ttc" id="a02408_html_acd95922d6bb09419fb66435d114cdb5c"><div class="ttname"><a href="a02408.html#acd95922d6bb09419fb66435d114cdb5c">SparseGridsSimulation::m_nsims_sg</a></div><div class="ttdeci">int m_nsims_sg</div><div class="ttdef"><b>Definition:</b> <a href="a01106_source.html#l00214">sparse_grids_simulation.h:214</a></div></div>
<div class="ttc" id="a02408_html_a20303c6aa17833ad691479008c2ce676"><div class="ttname"><a href="a02408.html#a20303c6aa17833ad691479008c2ce676">SparseGridsSimulation::interpolateGrid</a></div><div class="ttdeci">void interpolateGrid(SimulationObject *const, const SimulationObject *const)</div><div class="ttdef"><b>Definition:</b> <a href="a02174_source.html#l00020">SparseGridsInterpolateGrid.cpp:20</a></div></div>
<div class="ttc" id="a01028_html_a0be0f30a83bc3f3d9f6ee3a36bbf2716"><div class="ttname"><a href="a01028.html#a0be0f30a83bc3f3d9f6ee3a36bbf2716">MPIVariables::iproc</a></div><div class="ttdeci">int * iproc</div><div class="ttdef"><b>Definition:</b> <a href="a01028_source.html#l00027">mpivars_struct.h:27</a></div></div>
<div class="ttc" id="a02408_html_a41a86f682aa37c28c671759a11a494a8"><div class="ttname"><a href="a02408.html#a41a86f682aa37c28c671759a11a494a8">SparseGridsSimulation::m_sim_fg</a></div><div class="ttdeci">SimulationObject * m_sim_fg</div><div class="ttdef"><b>Definition:</b> <a href="a01106_source.html#l00230">sparse_grids_simulation.h:230</a></div></div>
<div class="ttc" id="a02408_html_af3c229deae2a8e788c823dcc6f020b65"><div class="ttname"><a href="a02408.html#af3c229deae2a8e788c823dcc6f020b65">SparseGridsSimulation::m_ndims</a></div><div class="ttdeci">int m_ndims</div><div class="ttdef"><b>Definition:</b> <a href="a01106_source.html#l00215">sparse_grids_simulation.h:215</a></div></div>
<div class="ttc" id="a02280_html_aa24a4f5e29bd70cbe5a2413be1ea9682"><div class="ttname"><a href="a02280.html#aa24a4f5e29bd70cbe5a2413be1ea9682">HyPar::dxinv</a></div><div class="ttdeci">double * dxinv</div><div class="ttdef"><b>Definition:</b> <a href="a00986_source.html#l00110">hypar.h:110</a></div></div>
<div class="ttc" id="a01028_html_aa3c28612a64b8a97bde66b720e15c700"><div class="ttname"><a href="a01028.html#aa3c28612a64b8a97bde66b720e15c700">MPIVariables::ip</a></div><div class="ttdeci">int * ip</div><div class="ttdef"><b>Definition:</b> <a href="a01028_source.html#l00028">mpivars_struct.h:28</a></div></div>
<div class="ttc" id="a02408_html_ac6a822dc76382e4027cf94ac3e510056"><div class="ttname"><a href="a02408.html#ac6a822dc76382e4027cf94ac3e510056">SparseGridsSimulation::m_rank</a></div><div class="ttdeci">int m_rank</div><div class="ttdef"><b>Definition:</b> <a href="a01106_source.html#l00216">sparse_grids_simulation.h:216</a></div></div>
<div class="ttc" id="a01028_html_a02320"><div class="ttname"><a href="a01028.html#a02320">MPIVariables</a></div><div class="ttdoc">Structure of MPI-related variables. </div><div class="ttdef"><b>Definition:</b> <a href="a01028_source.html#l00024">mpivars_struct.h:24</a></div></div>
<div class="ttc" id="a02408_html_afd006361179964b4e2c2cc65526247bd"><div class="ttname"><a href="a02408.html#afd006361179964b4e2c2cc65526247bd">SparseGridsSimulation::m_sims_sg</a></div><div class="ttdeci">std::vector&lt; SimulationObject &gt; m_sims_sg</div><div class="ttdef"><b>Definition:</b> <a href="a01106_source.html#l00231">sparse_grids_simulation.h:231</a></div></div>
<div class="ttc" id="a02280_html_a711aad4cbe735871dd9e91ab575c878b"><div class="ttname"><a href="a02280.html#a711aad4cbe735871dd9e91ab575c878b">HyPar::x</a></div><div class="ttdeci">double * x</div><div class="ttdef"><b>Definition:</b> <a href="a00986_source.html#l00107">hypar.h:107</a></div></div>
<div class="ttc" id="a02280_html_a38e0371f331cecbe63a77fa03e202afe"><div class="ttname"><a href="a02280.html#a38e0371f331cecbe63a77fa03e202afe">HyPar::dim_local</a></div><div class="ttdeci">int * dim_local</div><div class="ttdef"><b>Definition:</b> <a href="a00986_source.html#l00037">hypar.h:37</a></div></div>
<div class="ttc" id="a02280_html_ae8f6d2fd6490d3153cb4133bf183a404"><div class="ttname"><a href="a02280.html#ae8f6d2fd6490d3153cb4133bf183a404">HyPar::nvars</a></div><div class="ttdeci">int nvars</div><div class="ttdef"><b>Definition:</b> <a href="a00986_source.html#l00029">hypar.h:29</a></div></div>
<div class="ttc" id="a02280_html_aafc992b5fa79d5a4036024615d03bce6"><div class="ttname"><a href="a02280.html#aafc992b5fa79d5a4036024615d03bce6">HyPar::ghosts</a></div><div class="ttdeci">int ghosts</div><div class="ttdef"><b>Definition:</b> <a href="a00986_source.html#l00052">hypar.h:52</a></div></div>
<div class="ttc" id="a02408_html_a4f0b968820fa465fde318fa0100ff23f"><div class="ttname"><a href="a02408.html#a4f0b968820fa465fde318fa0100ff23f">SparseGridsSimulation::InitialSolution</a></div><div class="ttdeci">int InitialSolution()</div><div class="ttdef"><b>Definition:</b> <a href="a02168_source.html#l00017">SparseGridsInitialSolution.cpp:17</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a60dd5da5980e23e6ac932f984aae72ec"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a60dd5da5980e23e6ac932f984aae72ec">&#9670;&nbsp;</a></span>InitializeBoundaries()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int InitializeBoundaries </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Initialize the boundary conditions of the simulation </p>

<p>Implements <a class="el" href="a02396.html#a23867c4c08aaef0cbff05a2d4a5df403">Simulation</a>.</p>

<p class="definition">Definition at line <a class="el" href="a01106_source.html#l00101">101</a> of file <a class="el" href="a01106_source.html">sparse_grids_simulation.h</a>.</p>
<div class="fragment"><div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;    {</div><div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;      <span class="keywordtype">int</span> retval = <a class="code" href="a02408.html#a60dd5da5980e23e6ac932f984aae72ec">::InitializeBoundaries</a>(  (<span class="keywordtype">void</span>*) <a class="code" href="a02408.html#afd006361179964b4e2c2cc65526247bd">m_sims_sg</a>.data(),</div><div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;                                            <a class="code" href="a02408.html#acd95922d6bb09419fb66435d114cdb5c">m_nsims_sg</a> );</div><div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="a02408.html#acd95922d6bb09419fb66435d114cdb5c">m_nsims_sg</a> &gt; 0) {</div><div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;        <a class="code" href="a02408.html#a1fde282f4347462c9c2dd34aac2ad998">m_is_periodic</a>.resize(<a class="code" href="a02408.html#af3c229deae2a8e788c823dcc6f020b65">m_ndims</a>);</div><div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> d=0; d&lt;<a class="code" href="a02408.html#af3c229deae2a8e788c823dcc6f020b65">m_ndims</a>; d++) {</div><div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;          <a class="code" href="a02408.html#a1fde282f4347462c9c2dd34aac2ad998">m_is_periodic</a>[d] = ( <a class="code" href="a02408.html#afd006361179964b4e2c2cc65526247bd">m_sims_sg</a>[0].solver.isPeriodic[d] == 1 ? true : <span class="keyword">false</span>);</div><div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;          <a class="code" href="a02408.html#a41a86f682aa37c28c671759a11a494a8">m_sim_fg</a>-&gt;<a class="code" href="a01100.html#a523947ce4fa7128c4c767163953253b9">solver</a>.<a class="code" href="a02280.html#a40e3f67b1530d5ea4e913fc60b594802">isPeriodic</a>[d] = <a class="code" href="a02408.html#afd006361179964b4e2c2cc65526247bd">m_sims_sg</a>[0].solver.isPeriodic[d];</div><div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;        }</div><div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;      }</div><div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;      <span class="keywordflow">return</span> retval;</div><div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;    }</div><div class="ttc" id="a02408_html_acd95922d6bb09419fb66435d114cdb5c"><div class="ttname"><a href="a02408.html#acd95922d6bb09419fb66435d114cdb5c">SparseGridsSimulation::m_nsims_sg</a></div><div class="ttdeci">int m_nsims_sg</div><div class="ttdef"><b>Definition:</b> <a href="a01106_source.html#l00214">sparse_grids_simulation.h:214</a></div></div>
<div class="ttc" id="a02408_html_a41a86f682aa37c28c671759a11a494a8"><div class="ttname"><a href="a02408.html#a41a86f682aa37c28c671759a11a494a8">SparseGridsSimulation::m_sim_fg</a></div><div class="ttdeci">SimulationObject * m_sim_fg</div><div class="ttdef"><b>Definition:</b> <a href="a01106_source.html#l00230">sparse_grids_simulation.h:230</a></div></div>
<div class="ttc" id="a01100_html_a523947ce4fa7128c4c767163953253b9"><div class="ttname"><a href="a01100.html#a523947ce4fa7128c4c767163953253b9">SimulationObject::solver</a></div><div class="ttdeci">HyPar solver</div><div class="ttdef"><b>Definition:</b> <a href="a01100_source.html#l00026">simulation_object.h:26</a></div></div>
<div class="ttc" id="a02408_html_a1fde282f4347462c9c2dd34aac2ad998"><div class="ttname"><a href="a02408.html#a1fde282f4347462c9c2dd34aac2ad998">SparseGridsSimulation::m_is_periodic</a></div><div class="ttdeci">std::vector&lt; bool &gt; m_is_periodic</div><div class="ttdef"><b>Definition:</b> <a href="a01106_source.html#l00222">sparse_grids_simulation.h:222</a></div></div>
<div class="ttc" id="a02408_html_af3c229deae2a8e788c823dcc6f020b65"><div class="ttname"><a href="a02408.html#af3c229deae2a8e788c823dcc6f020b65">SparseGridsSimulation::m_ndims</a></div><div class="ttdeci">int m_ndims</div><div class="ttdef"><b>Definition:</b> <a href="a01106_source.html#l00215">sparse_grids_simulation.h:215</a></div></div>
<div class="ttc" id="a02408_html_afd006361179964b4e2c2cc65526247bd"><div class="ttname"><a href="a02408.html#afd006361179964b4e2c2cc65526247bd">SparseGridsSimulation::m_sims_sg</a></div><div class="ttdeci">std::vector&lt; SimulationObject &gt; m_sims_sg</div><div class="ttdef"><b>Definition:</b> <a href="a01106_source.html#l00231">sparse_grids_simulation.h:231</a></div></div>
<div class="ttc" id="a02280_html_a40e3f67b1530d5ea4e913fc60b594802"><div class="ttname"><a href="a02280.html#a40e3f67b1530d5ea4e913fc60b594802">HyPar::isPeriodic</a></div><div class="ttdeci">int * isPeriodic</div><div class="ttdef"><b>Definition:</b> <a href="a00986_source.html#l00162">hypar.h:162</a></div></div>
<div class="ttc" id="a02408_html_a60dd5da5980e23e6ac932f984aae72ec"><div class="ttname"><a href="a02408.html#a60dd5da5980e23e6ac932f984aae72ec">SparseGridsSimulation::InitializeBoundaries</a></div><div class="ttdeci">int InitializeBoundaries()</div><div class="ttdef"><b>Definition:</b> <a href="a01106_source.html#l00101">sparse_grids_simulation.h:101</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="af0ad837e34bcb8c380a457b2dfa27519"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af0ad837e34bcb8c380a457b2dfa27519">&#9670;&nbsp;</a></span>InitializeImmersedBoundaries()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int InitializeImmersedBoundaries </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Initialize the immersed boundary conditions of the simulation </p>

<p>Implements <a class="el" href="a02396.html#a999753d52ffe3a04de2035b561e4d025">Simulation</a>.</p>

<p class="definition">Definition at line <a class="el" href="a01106_source.html#l00116">116</a> of file <a class="el" href="a01106_source.html">sparse_grids_simulation.h</a>.</p>
<div class="fragment"><div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;    {</div><div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;      <span class="keywordtype">int</span> retval = <a class="code" href="a02408.html#af0ad837e34bcb8c380a457b2dfa27519">::InitializeImmersedBoundaries</a>(  (<span class="keywordtype">void</span>*) <a class="code" href="a02408.html#afd006361179964b4e2c2cc65526247bd">m_sims_sg</a>.data(),</div><div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;                                                    <a class="code" href="a02408.html#acd95922d6bb09419fb66435d114cdb5c">m_nsims_sg</a> );</div><div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;      <span class="keywordflow">return</span> retval;</div><div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;    }</div><div class="ttc" id="a02408_html_acd95922d6bb09419fb66435d114cdb5c"><div class="ttname"><a href="a02408.html#acd95922d6bb09419fb66435d114cdb5c">SparseGridsSimulation::m_nsims_sg</a></div><div class="ttdeci">int m_nsims_sg</div><div class="ttdef"><b>Definition:</b> <a href="a01106_source.html#l00214">sparse_grids_simulation.h:214</a></div></div>
<div class="ttc" id="a02408_html_af0ad837e34bcb8c380a457b2dfa27519"><div class="ttname"><a href="a02408.html#af0ad837e34bcb8c380a457b2dfa27519">SparseGridsSimulation::InitializeImmersedBoundaries</a></div><div class="ttdeci">int InitializeImmersedBoundaries()</div><div class="ttdef"><b>Definition:</b> <a href="a01106_source.html#l00116">sparse_grids_simulation.h:116</a></div></div>
<div class="ttc" id="a02408_html_afd006361179964b4e2c2cc65526247bd"><div class="ttname"><a href="a02408.html#afd006361179964b4e2c2cc65526247bd">SparseGridsSimulation::m_sims_sg</a></div><div class="ttdeci">std::vector&lt; SimulationObject &gt; m_sims_sg</div><div class="ttdef"><b>Definition:</b> <a href="a01106_source.html#l00231">sparse_grids_simulation.h:231</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a9ace884b88e00a7bfa10eb8289924b2a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9ace884b88e00a7bfa10eb8289924b2a">&#9670;&nbsp;</a></span>InitializePhysics()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int InitializePhysics </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Initialize the physics of the simulations </p>

<p>Implements <a class="el" href="a02396.html#a08475c88f057469d3c288deee654711a">Simulation</a>.</p>

<p class="definition">Definition at line <a class="el" href="a01106_source.html#l00124">124</a> of file <a class="el" href="a01106_source.html">sparse_grids_simulation.h</a>.</p>
<div class="fragment"><div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;    {</div><div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;      <span class="keywordtype">int</span> retval = <a class="code" href="a02408.html#a9ace884b88e00a7bfa10eb8289924b2a">::InitializePhysics</a>( (<span class="keywordtype">void</span>*) <a class="code" href="a02408.html#afd006361179964b4e2c2cc65526247bd">m_sims_sg</a>.data(),</div><div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;                                        <a class="code" href="a02408.html#acd95922d6bb09419fb66435d114cdb5c">m_nsims_sg</a> );</div><div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;      <span class="keywordflow">return</span> retval;</div><div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;    }</div><div class="ttc" id="a02408_html_a9ace884b88e00a7bfa10eb8289924b2a"><div class="ttname"><a href="a02408.html#a9ace884b88e00a7bfa10eb8289924b2a">SparseGridsSimulation::InitializePhysics</a></div><div class="ttdeci">int InitializePhysics()</div><div class="ttdef"><b>Definition:</b> <a href="a01106_source.html#l00124">sparse_grids_simulation.h:124</a></div></div>
<div class="ttc" id="a02408_html_acd95922d6bb09419fb66435d114cdb5c"><div class="ttname"><a href="a02408.html#acd95922d6bb09419fb66435d114cdb5c">SparseGridsSimulation::m_nsims_sg</a></div><div class="ttdeci">int m_nsims_sg</div><div class="ttdef"><b>Definition:</b> <a href="a01106_source.html#l00214">sparse_grids_simulation.h:214</a></div></div>
<div class="ttc" id="a02408_html_afd006361179964b4e2c2cc65526247bd"><div class="ttname"><a href="a02408.html#afd006361179964b4e2c2cc65526247bd">SparseGridsSimulation::m_sims_sg</a></div><div class="ttdeci">std::vector&lt; SimulationObject &gt; m_sims_sg</div><div class="ttdef"><b>Definition:</b> <a href="a01106_source.html#l00231">sparse_grids_simulation.h:231</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a5a04edfc0f9d6150b2e39b6939a53ef2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5a04edfc0f9d6150b2e39b6939a53ef2">&#9670;&nbsp;</a></span>InitializePhysicsData()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int InitializePhysicsData </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Initialize the physics of the simulations </p>

<p>Implements <a class="el" href="a02396.html#ab2386217f33289d0cc5a34b5851c846b">Simulation</a>.</p>

<p class="definition">Definition at line <a class="el" href="a01106_source.html#l00132">132</a> of file <a class="el" href="a01106_source.html">sparse_grids_simulation.h</a>.</p>
<div class="fragment"><div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;    {</div><div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ns = 0; ns &lt; <a class="code" href="a02408.html#afd006361179964b4e2c2cc65526247bd">m_sims_sg</a>.size(); ns++) {</div><div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;        <span class="keywordtype">int</span> retval = <a class="code" href="a02408.html#a5a04edfc0f9d6150b2e39b6939a53ef2">::InitializePhysicsData</a>( (<span class="keywordtype">void</span>*) &amp;(<a class="code" href="a02408.html#afd006361179964b4e2c2cc65526247bd">m_sims_sg</a>[ns]),</div><div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;                                              -1, </div><div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;                                              <a class="code" href="a02408.html#acd95922d6bb09419fb66435d114cdb5c">m_nsims_sg</a>,</div><div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;                                              <a class="code" href="a02408.html#a41a86f682aa37c28c671759a11a494a8">m_sim_fg</a>-&gt;<a class="code" href="a01100.html#a523947ce4fa7128c4c767163953253b9">solver</a>.<a class="code" href="a02280.html#aa989ebb755986852177779cdf7bd8c85">dim_global</a>);</div><div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;        <span class="keywordflow">if</span> (retval) {</div><div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;          fprintf(stderr, <span class="stringliteral">&quot;Error in SparseGridsSimulation::InitializePhysicsData()\n&quot;</span>);</div><div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;          fprintf(stderr, <span class="stringliteral">&quot;  InitializePhysicsData returned with error code %d on rank %d.\n&quot;</span>,</div><div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;                  retval, <a class="code" href="a02408.html#afd006361179964b4e2c2cc65526247bd">m_sims_sg</a>[ns].mpi.rank);</div><div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;          <span class="keywordflow">return</span> retval;</div><div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;        }</div><div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;      }</div><div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;      <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;    }</div><div class="ttc" id="a02408_html_acd95922d6bb09419fb66435d114cdb5c"><div class="ttname"><a href="a02408.html#acd95922d6bb09419fb66435d114cdb5c">SparseGridsSimulation::m_nsims_sg</a></div><div class="ttdeci">int m_nsims_sg</div><div class="ttdef"><b>Definition:</b> <a href="a01106_source.html#l00214">sparse_grids_simulation.h:214</a></div></div>
<div class="ttc" id="a02408_html_a5a04edfc0f9d6150b2e39b6939a53ef2"><div class="ttname"><a href="a02408.html#a5a04edfc0f9d6150b2e39b6939a53ef2">SparseGridsSimulation::InitializePhysicsData</a></div><div class="ttdeci">int InitializePhysicsData()</div><div class="ttdef"><b>Definition:</b> <a href="a01106_source.html#l00132">sparse_grids_simulation.h:132</a></div></div>
<div class="ttc" id="a02280_html_aa989ebb755986852177779cdf7bd8c85"><div class="ttname"><a href="a02280.html#aa989ebb755986852177779cdf7bd8c85">HyPar::dim_global</a></div><div class="ttdeci">int * dim_global</div><div class="ttdef"><b>Definition:</b> <a href="a00986_source.html#l00033">hypar.h:33</a></div></div>
<div class="ttc" id="a02408_html_a41a86f682aa37c28c671759a11a494a8"><div class="ttname"><a href="a02408.html#a41a86f682aa37c28c671759a11a494a8">SparseGridsSimulation::m_sim_fg</a></div><div class="ttdeci">SimulationObject * m_sim_fg</div><div class="ttdef"><b>Definition:</b> <a href="a01106_source.html#l00230">sparse_grids_simulation.h:230</a></div></div>
<div class="ttc" id="a01100_html_a523947ce4fa7128c4c767163953253b9"><div class="ttname"><a href="a01100.html#a523947ce4fa7128c4c767163953253b9">SimulationObject::solver</a></div><div class="ttdeci">HyPar solver</div><div class="ttdef"><b>Definition:</b> <a href="a01100_source.html#l00026">simulation_object.h:26</a></div></div>
<div class="ttc" id="a02408_html_afd006361179964b4e2c2cc65526247bd"><div class="ttname"><a href="a02408.html#afd006361179964b4e2c2cc65526247bd">SparseGridsSimulation::m_sims_sg</a></div><div class="ttdeci">std::vector&lt; SimulationObject &gt; m_sims_sg</div><div class="ttdef"><b>Definition:</b> <a href="a01106_source.html#l00231">sparse_grids_simulation.h:231</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a4a9517d2ee1026d57dd45f731c362ba6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4a9517d2ee1026d57dd45f731c362ba6">&#9670;&nbsp;</a></span>InitializeSolvers()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int InitializeSolvers </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Initialize the numerical solvers of the simulations </p>

<p>Implements <a class="el" href="a02396.html#a3bf2a3376442f0cb6d1678a1cc22ca70">Simulation</a>.</p>

<p class="definition">Definition at line <a class="el" href="a01106_source.html#l00150">150</a> of file <a class="el" href="a01106_source.html">sparse_grids_simulation.h</a>.</p>
<div class="fragment"><div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;    {</div><div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;      <span class="keywordtype">int</span> retval = <a class="code" href="a02408.html#a4a9517d2ee1026d57dd45f731c362ba6">::InitializeSolvers</a>( (<span class="keywordtype">void</span>*) <a class="code" href="a02408.html#afd006361179964b4e2c2cc65526247bd">m_sims_sg</a>.data(),</div><div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;                                        <a class="code" href="a02408.html#acd95922d6bb09419fb66435d114cdb5c">m_nsims_sg</a> );</div><div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;      <a class="code" href="a02408.html#afd984d88b028433d14fe3953937df374">InitializeSolversBarebones</a>(<a class="code" href="a02408.html#a41a86f682aa37c28c671759a11a494a8">m_sim_fg</a>);</div><div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;</div><div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;      <span class="comment">/* some modifications to output filename roots */</span></div><div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;<a class="code" href="a02408.html#acd95922d6bb09419fb66435d114cdb5c">m_nsims_sg</a>; i++) {</div><div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;        strcpy(<a class="code" href="a02408.html#afd006361179964b4e2c2cc65526247bd">m_sims_sg</a>[i].solver.op_fname_root, <span class="stringliteral">&quot;op_sg&quot;</span>);</div><div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;        strcpy(<a class="code" href="a02408.html#afd006361179964b4e2c2cc65526247bd">m_sims_sg</a>[i].solver.aux_op_fname_root, <span class="stringliteral">&quot;ts0_sg&quot;</span>);</div><div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;      }</div><div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;      strcpy(<a class="code" href="a02408.html#a41a86f682aa37c28c671759a11a494a8">m_sim_fg</a>-&gt;<a class="code" href="a01100.html#a523947ce4fa7128c4c767163953253b9">solver</a>.<a class="code" href="a02280.html#a2f63f9a875bb76e6107cb2e7c725d935">op_fname_root</a>, <span class="stringliteral">&quot;op_fg&quot;</span>);</div><div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;      strcpy(<a class="code" href="a02408.html#a41a86f682aa37c28c671759a11a494a8">m_sim_fg</a>-&gt;<a class="code" href="a01100.html#a523947ce4fa7128c4c767163953253b9">solver</a>.<a class="code" href="a02280.html#a5d741833915983fdcb695f262a73ae7e">aux_op_fname_root</a>, <span class="stringliteral">&quot;ts0_fg&quot;</span>);</div><div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;      <span class="keywordflow">return</span> retval;</div><div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;    }</div><div class="ttc" id="a02280_html_a2f63f9a875bb76e6107cb2e7c725d935"><div class="ttname"><a href="a02280.html#a2f63f9a875bb76e6107cb2e7c725d935">HyPar::op_fname_root</a></div><div class="ttdeci">char op_fname_root[_MAX_STRING_SIZE_]</div><div class="ttdef"><b>Definition:</b> <a href="a00986_source.html#l00201">hypar.h:201</a></div></div>
<div class="ttc" id="a02408_html_acd95922d6bb09419fb66435d114cdb5c"><div class="ttname"><a href="a02408.html#acd95922d6bb09419fb66435d114cdb5c">SparseGridsSimulation::m_nsims_sg</a></div><div class="ttdeci">int m_nsims_sg</div><div class="ttdef"><b>Definition:</b> <a href="a01106_source.html#l00214">sparse_grids_simulation.h:214</a></div></div>
<div class="ttc" id="a02280_html_a5d741833915983fdcb695f262a73ae7e"><div class="ttname"><a href="a02280.html#a5d741833915983fdcb695f262a73ae7e">HyPar::aux_op_fname_root</a></div><div class="ttdeci">char aux_op_fname_root[_MAX_STRING_SIZE_]</div><div class="ttdef"><b>Definition:</b> <a href="a00986_source.html#l00203">hypar.h:203</a></div></div>
<div class="ttc" id="a02408_html_a41a86f682aa37c28c671759a11a494a8"><div class="ttname"><a href="a02408.html#a41a86f682aa37c28c671759a11a494a8">SparseGridsSimulation::m_sim_fg</a></div><div class="ttdeci">SimulationObject * m_sim_fg</div><div class="ttdef"><b>Definition:</b> <a href="a01106_source.html#l00230">sparse_grids_simulation.h:230</a></div></div>
<div class="ttc" id="a01100_html_a523947ce4fa7128c4c767163953253b9"><div class="ttname"><a href="a01100.html#a523947ce4fa7128c4c767163953253b9">SimulationObject::solver</a></div><div class="ttdeci">HyPar solver</div><div class="ttdef"><b>Definition:</b> <a href="a01100_source.html#l00026">simulation_object.h:26</a></div></div>
<div class="ttc" id="a02408_html_afd984d88b028433d14fe3953937df374"><div class="ttname"><a href="a02408.html#afd984d88b028433d14fe3953937df374">SparseGridsSimulation::InitializeSolversBarebones</a></div><div class="ttdeci">int InitializeSolversBarebones(SimulationObject *)</div><div class="ttdef"><b>Definition:</b> <a href="a02177_source.html#l00320">SparseGridsMiscFuncs.cpp:320</a></div></div>
<div class="ttc" id="a02408_html_afd006361179964b4e2c2cc65526247bd"><div class="ttname"><a href="a02408.html#afd006361179964b4e2c2cc65526247bd">SparseGridsSimulation::m_sims_sg</a></div><div class="ttdeci">std::vector&lt; SimulationObject &gt; m_sims_sg</div><div class="ttdef"><b>Definition:</b> <a href="a01106_source.html#l00231">sparse_grids_simulation.h:231</a></div></div>
<div class="ttc" id="a02408_html_a4a9517d2ee1026d57dd45f731c362ba6"><div class="ttname"><a href="a02408.html#a4a9517d2ee1026d57dd45f731c362ba6">SparseGridsSimulation::InitializeSolvers</a></div><div class="ttdeci">int InitializeSolvers()</div><div class="ttdef"><b>Definition:</b> <a href="a01106_source.html#l00150">sparse_grids_simulation.h:150</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a6009f77fd5b9738911ebf3196682316d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6009f77fd5b9738911ebf3196682316d">&#9670;&nbsp;</a></span>InitializationWrapup()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int InitializationWrapup </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Wrap up initializations</p>
<p>Finish all the initializations: Interpolate the initial solution on the full grid to all the sparse grids, now that the boundary conditions are available. </p>

<p>Reimplemented from <a class="el" href="a02396.html#a3363557142da54ab3760911592b80f97">Simulation</a>.</p>

<p class="definition">Definition at line <a class="el" href="a02162_source.html#l00015">15</a> of file <a class="el" href="a02162_source.html">SparseGridsInitializationWrapup.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;{</div><div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;  <span class="keywordtype">int</span> ierr;</div><div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;</div><div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> n = 0; n &lt; <a class="code" href="a02408.html#acd95922d6bb09419fb66435d114cdb5c">m_nsims_sg</a>; n++) {</div><div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;</div><div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="a02408.html#ac6a822dc76382e4027cf94ac3e510056">m_rank</a>) {</div><div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;      printf(<span class="stringliteral">&quot;Interpolating initial solution to sparse grids domain %d.\n&quot;</span>, n);</div><div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;    }</div><div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;    <a class="code" href="a02408.html#a96da5797b40184e2da41e3d1abfc9697">interpolate</a>( &amp;<a class="code" href="a02408.html#afd006361179964b4e2c2cc65526247bd">m_sims_sg</a>[n], <a class="code" href="a02408.html#a41a86f682aa37c28c671759a11a494a8">m_sim_fg</a> );</div><div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;</div><div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;    <a class="code" href="a02280.html">HyPar</a>* solver = &amp;(<a class="code" href="a02408.html#afd006361179964b4e2c2cc65526247bd">m_sims_sg</a>[n].solver);</div><div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;    <a class="code" href="a01028.html#a02320">MPIVariables</a>* mpi = &amp;(<a class="code" href="a02408.html#afd006361179964b4e2c2cc65526247bd">m_sims_sg</a>[n].mpi);</div><div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;</div><div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;    <span class="keywordtype">int</span> nvars = solver-&gt;<a class="code" href="a02280.html#ae8f6d2fd6490d3153cb4133bf183a404">nvars</a>;</div><div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;    <span class="keywordtype">int</span> ghosts = solver-&gt;<a class="code" href="a02280.html#aafc992b5fa79d5a4036024615d03bce6">ghosts</a>;</div><div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;    <span class="keywordtype">int</span> *dim_local = solver-&gt;<a class="code" href="a02280.html#a38e0371f331cecbe63a77fa03e202afe">dim_local</a>;</div><div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;</div><div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;    <span class="comment">/* exchange MPI-boundary values of u between processors */</span></div><div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;    <a class="code" href="a01022.html#a60ace5964c051fa481e6a1e6f1ef75d7">MPIExchangeBoundariesnD</a>(  <a class="code" href="a02408.html#af3c229deae2a8e788c823dcc6f020b65">m_ndims</a>,</div><div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;                              nvars,</div><div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;                              dim_local,</div><div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;                              ghosts,</div><div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;                              mpi,</div><div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;                              solver-&gt;<a class="code" href="a02280.html#a3b6b999a764f1e2ea94bb5f28c7a558c">u</a>  );</div><div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;</div><div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;    <span class="comment">/* calculate volume integral of the initial solution */</span></div><div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;    ierr = <a class="code" href="a02162.html#a1f30168f72fce94d12bd0cc8d9322494">::VolumeIntegral</a>(solver-&gt;<a class="code" href="a02280.html#a3aec36aeb5caac1e87f5b4f5f75d5a23">VolumeIntegralInitial</a>,</div><div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;                            solver-&gt;<a class="code" href="a02280.html#a3b6b999a764f1e2ea94bb5f28c7a558c">u</a>,</div><div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;                            solver,</div><div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;                            mpi );</div><div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;    <span class="keywordflow">if</span> (ierr) <span class="keywordflow">return</span> ierr;</div><div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;</div><div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;    <span class="keywordflow">if</span> (!mpi-&gt;<a class="code" href="a01028.html#a6cfd95afd0afebd625b889fb6e58371c">rank</a>) {</div><div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;      printf(<span class="stringliteral">&quot;  Volume integral of the initial solution on sparse grids domain %d:\n&quot;</span>, n);</div><div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> d=0; d&lt;nvars; d++) {</div><div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;        printf(<span class="stringliteral">&quot;    %2d:  %1.16E\n&quot;</span>,d,solver-&gt;<a class="code" href="a02280.html#a3aec36aeb5caac1e87f5b4f5f75d5a23">VolumeIntegralInitial</a>[d]);</div><div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;      }</div><div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;    }</div><div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;</div><div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;    <span class="comment">/* Set initial total boundary flux integral to zero */</span></div><div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;    <a class="code" href="a00956.html#a2b2826031c0cd92495ab351d3e599fc5">_ArraySetValue_</a>( solver-&gt;<a class="code" href="a02280.html#a644ed0ed36ed4af1c396c0af6aca043d">TotalBoundaryIntegral</a>, nvars, 0 );</div><div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;</div><div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;  }</div><div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;</div><div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;  <span class="keywordflow">return</span> 0; </div><div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;}</div><div class="ttc" id="a02408_html_a96da5797b40184e2da41e3d1abfc9697"><div class="ttname"><a href="a02408.html#a96da5797b40184e2da41e3d1abfc9697">SparseGridsSimulation::interpolate</a></div><div class="ttdeci">void interpolate(SimulationObject *const, const SimulationObject *const)</div><div class="ttdef"><b>Definition:</b> <a href="a02171_source.html#l00015">SparseGridsInterpolate.cpp:15</a></div></div>
<div class="ttc" id="a02280_html"><div class="ttname"><a href="a02280.html">HyPar</a></div><div class="ttdoc">Structure containing all solver-specific variables and functions. </div><div class="ttdef"><b>Definition:</b> <a href="a00986_source.html#l00023">hypar.h:23</a></div></div>
<div class="ttc" id="a02408_html_acd95922d6bb09419fb66435d114cdb5c"><div class="ttname"><a href="a02408.html#acd95922d6bb09419fb66435d114cdb5c">SparseGridsSimulation::m_nsims_sg</a></div><div class="ttdeci">int m_nsims_sg</div><div class="ttdef"><b>Definition:</b> <a href="a01106_source.html#l00214">sparse_grids_simulation.h:214</a></div></div>
<div class="ttc" id="a02280_html_a3b6b999a764f1e2ea94bb5f28c7a558c"><div class="ttname"><a href="a02280.html#a3b6b999a764f1e2ea94bb5f28c7a558c">HyPar::u</a></div><div class="ttdeci">double * u</div><div class="ttdef"><b>Definition:</b> <a href="a00986_source.html#l00116">hypar.h:116</a></div></div>
<div class="ttc" id="a02162_html_a1f30168f72fce94d12bd0cc8d9322494"><div class="ttname"><a href="a02162.html#a1f30168f72fce94d12bd0cc8d9322494">VolumeIntegral</a></div><div class="ttdeci">int VolumeIntegral(double *, double *, void *, void *)</div><div class="ttdef"><b>Definition:</b> <a href="a01283_source.html#l00014">VolumeIntegral.c:14</a></div></div>
<div class="ttc" id="a01022_html_a60ace5964c051fa481e6a1e6f1ef75d7"><div class="ttname"><a href="a01022.html#a60ace5964c051fa481e6a1e6f1ef75d7">MPIExchangeBoundariesnD</a></div><div class="ttdeci">int MPIExchangeBoundariesnD(int, int, int *, int, void *, double *)</div><div class="ttdef"><b>Definition:</b> <a href="a01472_source.html#l00042">MPIExchangeBoundariesnD.c:42</a></div></div>
<div class="ttc" id="a02408_html_a41a86f682aa37c28c671759a11a494a8"><div class="ttname"><a href="a02408.html#a41a86f682aa37c28c671759a11a494a8">SparseGridsSimulation::m_sim_fg</a></div><div class="ttdeci">SimulationObject * m_sim_fg</div><div class="ttdef"><b>Definition:</b> <a href="a01106_source.html#l00230">sparse_grids_simulation.h:230</a></div></div>
<div class="ttc" id="a02280_html_a644ed0ed36ed4af1c396c0af6aca043d"><div class="ttname"><a href="a02280.html#a644ed0ed36ed4af1c396c0af6aca043d">HyPar::TotalBoundaryIntegral</a></div><div class="ttdeci">double * TotalBoundaryIntegral</div><div class="ttdef"><b>Definition:</b> <a href="a00986_source.html#l00381">hypar.h:381</a></div></div>
<div class="ttc" id="a02408_html_af3c229deae2a8e788c823dcc6f020b65"><div class="ttname"><a href="a02408.html#af3c229deae2a8e788c823dcc6f020b65">SparseGridsSimulation::m_ndims</a></div><div class="ttdeci">int m_ndims</div><div class="ttdef"><b>Definition:</b> <a href="a01106_source.html#l00215">sparse_grids_simulation.h:215</a></div></div>
<div class="ttc" id="a00956_html_a2b2826031c0cd92495ab351d3e599fc5"><div class="ttname"><a href="a00956.html#a2b2826031c0cd92495ab351d3e599fc5">_ArraySetValue_</a></div><div class="ttdeci">#define _ArraySetValue_(x, size, value)</div><div class="ttdef"><b>Definition:</b> <a href="a00956_source.html#l00169">arrayfunctions.h:169</a></div></div>
<div class="ttc" id="a02408_html_ac6a822dc76382e4027cf94ac3e510056"><div class="ttname"><a href="a02408.html#ac6a822dc76382e4027cf94ac3e510056">SparseGridsSimulation::m_rank</a></div><div class="ttdeci">int m_rank</div><div class="ttdef"><b>Definition:</b> <a href="a01106_source.html#l00216">sparse_grids_simulation.h:216</a></div></div>
<div class="ttc" id="a01028_html_a02320"><div class="ttname"><a href="a01028.html#a02320">MPIVariables</a></div><div class="ttdoc">Structure of MPI-related variables. </div><div class="ttdef"><b>Definition:</b> <a href="a01028_source.html#l00024">mpivars_struct.h:24</a></div></div>
<div class="ttc" id="a02408_html_afd006361179964b4e2c2cc65526247bd"><div class="ttname"><a href="a02408.html#afd006361179964b4e2c2cc65526247bd">SparseGridsSimulation::m_sims_sg</a></div><div class="ttdeci">std::vector&lt; SimulationObject &gt; m_sims_sg</div><div class="ttdef"><b>Definition:</b> <a href="a01106_source.html#l00231">sparse_grids_simulation.h:231</a></div></div>
<div class="ttc" id="a02280_html_a3aec36aeb5caac1e87f5b4f5f75d5a23"><div class="ttname"><a href="a02280.html#a3aec36aeb5caac1e87f5b4f5f75d5a23">HyPar::VolumeIntegralInitial</a></div><div class="ttdeci">double * VolumeIntegralInitial</div><div class="ttdef"><b>Definition:</b> <a href="a00986_source.html#l00375">hypar.h:375</a></div></div>
<div class="ttc" id="a02280_html_a38e0371f331cecbe63a77fa03e202afe"><div class="ttname"><a href="a02280.html#a38e0371f331cecbe63a77fa03e202afe">HyPar::dim_local</a></div><div class="ttdeci">int * dim_local</div><div class="ttdef"><b>Definition:</b> <a href="a00986_source.html#l00037">hypar.h:37</a></div></div>
<div class="ttc" id="a02280_html_ae8f6d2fd6490d3153cb4133bf183a404"><div class="ttname"><a href="a02280.html#ae8f6d2fd6490d3153cb4133bf183a404">HyPar::nvars</a></div><div class="ttdeci">int nvars</div><div class="ttdef"><b>Definition:</b> <a href="a00986_source.html#l00029">hypar.h:29</a></div></div>
<div class="ttc" id="a02280_html_aafc992b5fa79d5a4036024615d03bce6"><div class="ttname"><a href="a02280.html#aafc992b5fa79d5a4036024615d03bce6">HyPar::ghosts</a></div><div class="ttdeci">int ghosts</div><div class="ttdef"><b>Definition:</b> <a href="a00986_source.html#l00052">hypar.h:52</a></div></div>
<div class="ttc" id="a01028_html_a6cfd95afd0afebd625b889fb6e58371c"><div class="ttname"><a href="a01028.html#a6cfd95afd0afebd625b889fb6e58371c">MPIVariables::rank</a></div><div class="ttdeci">int rank</div><div class="ttdef"><b>Definition:</b> <a href="a01028_source.html#l00025">mpivars_struct.h:25</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a38b49ec2d9158c100958ea64b2a24ecc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a38b49ec2d9158c100958ea64b2a24ecc">&#9670;&nbsp;</a></span>Solve()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int Solve </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Run the simulation using native time integrators</p>
<p>This function integrates the semi-discrete ODE (obtained from discretizing the PDE in space) using natively implemented time integration methods. It initializes the time integration object, iterates the simulation for the required number of time steps, and calculates the errors. After the specified number of iterations, it writes out some information to the screen and the solution to a file. </p>

<p>Implements <a class="el" href="a02396.html#abf72f928c73259f7ce4cde2f6a2d8955">Simulation</a>.</p>

<p class="definition">Definition at line <a class="el" href="a02189_source.html#l00017">17</a> of file <a class="el" href="a02189_source.html">SparseGridsSolve.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;{</div><div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;  <span class="keywordtype">int</span> tic     = 0;</div><div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;</div><div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;  <span class="comment">/* write out iblank to file for visualization */</span></div><div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="a02408.html#a634b90e62b481c87ad0ba4ee5c5feba4">m_write_sg_solutions</a> == 1) {</div><div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ns = 0; ns &lt; <a class="code" href="a02408.html#acd95922d6bb09419fb66435d114cdb5c">m_nsims_sg</a>; ns++) {</div><div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="a02408.html#afd006361179964b4e2c2cc65526247bd">m_sims_sg</a>[ns].solver.flag_ib) {</div><div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;  </div><div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;        <span class="keywordtype">char</span> fname_root[<a class="code" href="a00965.html#a51efea86a4d76d1259893f606b776573">_MAX_STRING_SIZE_</a>] = <span class="stringliteral">&quot;iblank_sg&quot;</span>;</div><div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="a02408.html#acd95922d6bb09419fb66435d114cdb5c">m_nsims_sg</a> &gt; 1) {</div><div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;          <span class="keywordtype">char</span> index[<a class="code" href="a00965.html#a51efea86a4d76d1259893f606b776573">_MAX_STRING_SIZE_</a>];</div><div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;          <a class="code" href="a00974.html#a3e3ad5aed581d9ae563190c365dadc41">GetStringFromInteger</a>(ns, index, (<span class="keywordtype">int</span>)log10((<a class="code" href="a02408.html#acd95922d6bb09419fb66435d114cdb5c">m_nsims_sg</a>)+1));</div><div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;          strcat(fname_root, <span class="stringliteral">&quot;_&quot;</span>);</div><div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;          strcat(fname_root, index);</div><div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;        }</div><div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;  </div><div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;        <a class="code" href="a00995.html#aaf888c739c5200d9c58a7154347069b0">WriteArray</a>( <a class="code" href="a02408.html#afd006361179964b4e2c2cc65526247bd">m_sims_sg</a>[ns].solver.ndims,</div><div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;                    1,</div><div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;                    <a class="code" href="a02408.html#afd006361179964b4e2c2cc65526247bd">m_sims_sg</a>[ns].solver.dim_global,</div><div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;                    <a class="code" href="a02408.html#afd006361179964b4e2c2cc65526247bd">m_sims_sg</a>[ns].solver.dim_local,</div><div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;                    <a class="code" href="a02408.html#afd006361179964b4e2c2cc65526247bd">m_sims_sg</a>[ns].solver.ghosts,</div><div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;                    <a class="code" href="a02408.html#afd006361179964b4e2c2cc65526247bd">m_sims_sg</a>[ns].solver.x,</div><div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;                    <a class="code" href="a02408.html#afd006361179964b4e2c2cc65526247bd">m_sims_sg</a>[ns].solver.iblank,</div><div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;                    &amp;(<a class="code" href="a02408.html#afd006361179964b4e2c2cc65526247bd">m_sims_sg</a>[ns].solver),</div><div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;                    &amp;(<a class="code" href="a02408.html#afd006361179964b4e2c2cc65526247bd">m_sims_sg</a>[ns].mpi),</div><div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;                    fname_root );</div><div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;      }</div><div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;    }</div><div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;  }</div><div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="a02408.html#a41a86f682aa37c28c671759a11a494a8">m_sim_fg</a>-&gt;<a class="code" href="a01100.html#a523947ce4fa7128c4c767163953253b9">solver</a>.<a class="code" href="a02280.html#ae83b1b0117b6a805ead2e4728945814c">flag_ib</a>) {</div><div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;</div><div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;    <span class="keywordtype">char</span> fname_root[<a class="code" href="a00965.html#a51efea86a4d76d1259893f606b776573">_MAX_STRING_SIZE_</a>] = <span class="stringliteral">&quot;iblank&quot;</span>;</div><div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;    <a class="code" href="a00995.html#aaf888c739c5200d9c58a7154347069b0">WriteArray</a>( <a class="code" href="a02408.html#a41a86f682aa37c28c671759a11a494a8">m_sim_fg</a>-&gt;<a class="code" href="a01100.html#a523947ce4fa7128c4c767163953253b9">solver</a>.<a class="code" href="a02280.html#a484873c74138512e41bc50d17b7d955a">ndims</a>,</div><div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;                1,</div><div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;                <a class="code" href="a02408.html#a41a86f682aa37c28c671759a11a494a8">m_sim_fg</a>-&gt;<a class="code" href="a01100.html#a523947ce4fa7128c4c767163953253b9">solver</a>.<a class="code" href="a02280.html#aa989ebb755986852177779cdf7bd8c85">dim_global</a>,</div><div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;                <a class="code" href="a02408.html#a41a86f682aa37c28c671759a11a494a8">m_sim_fg</a>-&gt;<a class="code" href="a01100.html#a523947ce4fa7128c4c767163953253b9">solver</a>.<a class="code" href="a02280.html#a38e0371f331cecbe63a77fa03e202afe">dim_local</a>,</div><div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;                <a class="code" href="a02408.html#a41a86f682aa37c28c671759a11a494a8">m_sim_fg</a>-&gt;<a class="code" href="a01100.html#a523947ce4fa7128c4c767163953253b9">solver</a>.<a class="code" href="a02280.html#aafc992b5fa79d5a4036024615d03bce6">ghosts</a>,</div><div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;                <a class="code" href="a02408.html#a41a86f682aa37c28c671759a11a494a8">m_sim_fg</a>-&gt;<a class="code" href="a01100.html#a523947ce4fa7128c4c767163953253b9">solver</a>.<a class="code" href="a02280.html#a711aad4cbe735871dd9e91ab575c878b">x</a>,</div><div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;                <a class="code" href="a02408.html#a41a86f682aa37c28c671759a11a494a8">m_sim_fg</a>-&gt;<a class="code" href="a01100.html#a523947ce4fa7128c4c767163953253b9">solver</a>.<a class="code" href="a02280.html#a267ef7e03dbe9dd4440dee2fdf48619a">iblank</a>,</div><div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;                &amp;(<a class="code" href="a02408.html#a41a86f682aa37c28c671759a11a494a8">m_sim_fg</a>-&gt;<a class="code" href="a01100.html#a523947ce4fa7128c4c767163953253b9">solver</a>),</div><div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;                &amp;(<a class="code" href="a02408.html#a41a86f682aa37c28c671759a11a494a8">m_sim_fg</a>-&gt;<a class="code" href="a01100.html#a4afd2c7b3eb8fda452474ebdbe71c8c0">mpi</a>),</div><div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;                fname_root );</div><div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;  }</div><div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;</div><div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;  <span class="comment">/* Define and initialize the time-integration object */</span></div><div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;  <a class="code" href="a02412.html">TimeIntegration</a> TS;</div><div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;  <span class="keywordflow">if</span> (!<a class="code" href="a02408.html#ac6a822dc76382e4027cf94ac3e510056">m_rank</a>) printf(<span class="stringliteral">&quot;Setting up time integration.\n&quot;</span>);</div><div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;  <a class="code" href="a01112.html#a2ca35809be0e351ff2ad94532c2c0d68">TimeInitialize</a>((<span class="keywordtype">void</span>*)<a class="code" href="a02408.html#afd006361179964b4e2c2cc65526247bd">m_sims_sg</a>.data(), <a class="code" href="a02408.html#acd95922d6bb09419fb66435d114cdb5c">m_nsims_sg</a>, <a class="code" href="a02408.html#ac6a822dc76382e4027cf94ac3e510056">m_rank</a>, <a class="code" href="a02408.html#ae5bbe5daa629a4f92b569cb632256780">m_nproc</a>, &amp;TS);</div><div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;</div><div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;  <span class="keywordflow">if</span> (!<a class="code" href="a02408.html#ac6a822dc76382e4027cf94ac3e510056">m_rank</a>) {</div><div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;    printf( <span class="stringliteral">&quot;Solving in time (from %d to %d iterations)\n&quot;</span>,</div><div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;            TS.<a class="code" href="a02412.html#aafb41b96563d9966e8e9f458751f2960">restart_iter</a>,TS.<a class="code" href="a02412.html#af0d8e0d5d3de3869b941b66b6caaf964">n_iter</a>);</div><div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;  }</div><div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;</div><div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;  <span class="keywordflow">for</span> (TS.<a class="code" href="a02412.html#aab6f168571c2073e01e240524b8a3da0">iter</a> = TS.<a class="code" href="a02412.html#aafb41b96563d9966e8e9f458751f2960">restart_iter</a>; TS.<a class="code" href="a02412.html#aab6f168571c2073e01e240524b8a3da0">iter</a> &lt; TS.<a class="code" href="a02412.html#af0d8e0d5d3de3869b941b66b6caaf964">n_iter</a>; TS.<a class="code" href="a02412.html#aab6f168571c2073e01e240524b8a3da0">iter</a>++) {</div><div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;</div><div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;    <span class="comment">/* Write initial solution to file if this is the first iteration */</span></div><div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;    <span class="keywordflow">if</span> (!TS.<a class="code" href="a02412.html#aab6f168571c2073e01e240524b8a3da0">iter</a>) <a class="code" href="a02408.html#aba08ee83eb54edc5274b210c75e63e8c">OutputSolution</a>();</div><div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;</div><div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;    <span class="comment">/* Call pre-step function */</span></div><div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;    <a class="code" href="a01112.html#a2afba6dcdd13eb929ad4cb54a71eb470">TimePreStep</a>  (&amp;TS);</div><div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;</div><div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;    <span class="comment">/* Step in time */</span></div><div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;    <a class="code" href="a01112.html#acb00956b2e195653e3f8107b1ab1dc4d">TimeStep</a>     (&amp;TS);</div><div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;</div><div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;    <span class="comment">/* Call post-step function */</span></div><div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;    <a class="code" href="a01112.html#a25f8d76bc92804608cd299e63e23291c">TimePostStep</a> (&amp;TS);</div><div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;</div><div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;    <span class="comment">/* Print information to screen */</span></div><div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;    <a class="code" href="a01112.html#aa1ffb2050f4788b7c49b4576a9fe52ca">TimePrintStep</a>(&amp;TS);</div><div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;    tic++;</div><div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;</div><div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;    <span class="comment">/* Write intermediate solution to file */</span></div><div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;    <span class="keywordflow">if</span> ((TS.<a class="code" href="a02412.html#aab6f168571c2073e01e240524b8a3da0">iter</a>+1)%<a class="code" href="a02408.html#afd006361179964b4e2c2cc65526247bd">m_sims_sg</a>[0].solver.file_op_iter == 0) { </div><div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;      <a class="code" href="a02408.html#aba08ee83eb54edc5274b210c75e63e8c">OutputSolution</a>();</div><div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;      tic = 0; </div><div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;    }</div><div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;</div><div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;  }</div><div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;</div><div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;  <span class="comment">/* write a final solution file, if last iteration did not write one */</span></div><div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;  <span class="keywordflow">if</span> (tic || (!TS.<a class="code" href="a02412.html#af0d8e0d5d3de3869b941b66b6caaf964">n_iter</a>)) <a class="code" href="a02408.html#aba08ee83eb54edc5274b210c75e63e8c">OutputSolution</a>();</div><div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;</div><div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;  <span class="keywordflow">if</span> (!<a class="code" href="a02408.html#ac6a822dc76382e4027cf94ac3e510056">m_rank</a>) {</div><div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;    printf(<span class="stringliteral">&quot;Completed time integration (Final time: %f).\n&quot;</span>,TS.<a class="code" href="a02412.html#a28e4e78c0bf258662bef21d26c51fc0b">waqt</a>);</div><div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="a02408.html#acd95922d6bb09419fb66435d114cdb5c">m_nsims_sg</a> &gt; 1) printf(<span class="stringliteral">&quot;\n&quot;</span>);</div><div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;  }</div><div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;</div><div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;  <span class="comment">/* calculate error if exact solution has been provided */</span></div><div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;  <a class="code" href="a02408.html#a3b9da93464d7dafe5f3c64211703387b">CalculateError</a>();</div><div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;</div><div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;  <a class="code" href="a01112.html#a85984dec08cd43570151a625ab62f8d9">TimeCleanup</a>(&amp;TS);</div><div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;</div><div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;  <span class="keywordflow">return</span>(0);</div><div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;}</div><div class="ttc" id="a02280_html_a484873c74138512e41bc50d17b7d955a"><div class="ttname"><a href="a02280.html#a484873c74138512e41bc50d17b7d955a">HyPar::ndims</a></div><div class="ttdeci">int ndims</div><div class="ttdef"><b>Definition:</b> <a href="a00986_source.html#l00026">hypar.h:26</a></div></div>
<div class="ttc" id="a02408_html_a634b90e62b481c87ad0ba4ee5c5feba4"><div class="ttname"><a href="a02408.html#a634b90e62b481c87ad0ba4ee5c5feba4">SparseGridsSimulation::m_write_sg_solutions</a></div><div class="ttdeci">int m_write_sg_solutions</div><div class="ttdef"><b>Definition:</b> <a href="a01106_source.html#l00225">sparse_grids_simulation.h:225</a></div></div>
<div class="ttc" id="a01112_html_a2afba6dcdd13eb929ad4cb54a71eb470"><div class="ttname"><a href="a01112.html#a2afba6dcdd13eb929ad4cb54a71eb470">TimePreStep</a></div><div class="ttdeci">int TimePreStep(void *)</div><div class="ttdef"><b>Definition:</b> <a href="a02228_source.html#l00022">TimePreStep.c:22</a></div></div>
<div class="ttc" id="a02408_html_acd95922d6bb09419fb66435d114cdb5c"><div class="ttname"><a href="a02408.html#acd95922d6bb09419fb66435d114cdb5c">SparseGridsSimulation::m_nsims_sg</a></div><div class="ttdeci">int m_nsims_sg</div><div class="ttdef"><b>Definition:</b> <a href="a01106_source.html#l00214">sparse_grids_simulation.h:214</a></div></div>
<div class="ttc" id="a00965_html_a51efea86a4d76d1259893f606b776573"><div class="ttname"><a href="a00965.html#a51efea86a4d76d1259893f606b776573">_MAX_STRING_SIZE_</a></div><div class="ttdeci">#define _MAX_STRING_SIZE_</div><div class="ttdef"><b>Definition:</b> <a href="a00965_source.html#l00014">basic.h:14</a></div></div>
<div class="ttc" id="a01112_html_a25f8d76bc92804608cd299e63e23291c"><div class="ttname"><a href="a01112.html#a25f8d76bc92804608cd299e63e23291c">TimePostStep</a></div><div class="ttdeci">int TimePostStep(void *)</div><div class="ttdef"><b>Definition:</b> <a href="a02225_source.html#l00028">TimePostStep.c:28</a></div></div>
<div class="ttc" id="a02280_html_aa989ebb755986852177779cdf7bd8c85"><div class="ttname"><a href="a02280.html#aa989ebb755986852177779cdf7bd8c85">HyPar::dim_global</a></div><div class="ttdeci">int * dim_global</div><div class="ttdef"><b>Definition:</b> <a href="a00986_source.html#l00033">hypar.h:33</a></div></div>
<div class="ttc" id="a02408_html_a41a86f682aa37c28c671759a11a494a8"><div class="ttname"><a href="a02408.html#a41a86f682aa37c28c671759a11a494a8">SparseGridsSimulation::m_sim_fg</a></div><div class="ttdeci">SimulationObject * m_sim_fg</div><div class="ttdef"><b>Definition:</b> <a href="a01106_source.html#l00230">sparse_grids_simulation.h:230</a></div></div>
<div class="ttc" id="a01100_html_a523947ce4fa7128c4c767163953253b9"><div class="ttname"><a href="a01100.html#a523947ce4fa7128c4c767163953253b9">SimulationObject::solver</a></div><div class="ttdeci">HyPar solver</div><div class="ttdef"><b>Definition:</b> <a href="a01100_source.html#l00026">simulation_object.h:26</a></div></div>
<div class="ttc" id="a02412_html_aafb41b96563d9966e8e9f458751f2960"><div class="ttname"><a href="a02412.html#aafb41b96563d9966e8e9f458751f2960">TimeIntegration::restart_iter</a></div><div class="ttdeci">int restart_iter</div><div class="ttdef"><b>Definition:</b> <a href="a01118_source.html#l00035">timeintegration_struct.h:35</a></div></div>
<div class="ttc" id="a02408_html_a3b9da93464d7dafe5f3c64211703387b"><div class="ttname"><a href="a02408.html#a3b9da93464d7dafe5f3c64211703387b">SparseGridsSimulation::CalculateError</a></div><div class="ttdeci">void CalculateError()</div><div class="ttdef"><b>Definition:</b> <a href="a02150_source.html#l00017">SparseGridsCalculateError.cpp:17</a></div></div>
<div class="ttc" id="a02408_html_ac6a822dc76382e4027cf94ac3e510056"><div class="ttname"><a href="a02408.html#ac6a822dc76382e4027cf94ac3e510056">SparseGridsSimulation::m_rank</a></div><div class="ttdeci">int m_rank</div><div class="ttdef"><b>Definition:</b> <a href="a01106_source.html#l00216">sparse_grids_simulation.h:216</a></div></div>
<div class="ttc" id="a01112_html_a2ca35809be0e351ff2ad94532c2c0d68"><div class="ttname"><a href="a01112.html#a2ca35809be0e351ff2ad94532c2c0d68">TimeInitialize</a></div><div class="ttdeci">int TimeInitialize(void *, int, int, int, void *)</div><div class="ttdef"><b>Definition:</b> <a href="a02222_source.html#l00028">TimeInitialize.c:28</a></div></div>
<div class="ttc" id="a01100_html_a4afd2c7b3eb8fda452474ebdbe71c8c0"><div class="ttname"><a href="a01100.html#a4afd2c7b3eb8fda452474ebdbe71c8c0">SimulationObject::mpi</a></div><div class="ttdeci">MPIVariables mpi</div><div class="ttdef"><b>Definition:</b> <a href="a01100_source.html#l00025">simulation_object.h:25</a></div></div>
<div class="ttc" id="a01112_html_a85984dec08cd43570151a625ab62f8d9"><div class="ttname"><a href="a01112.html#a85984dec08cd43570151a625ab62f8d9">TimeCleanup</a></div><div class="ttdeci">int TimeCleanup(void *)</div><div class="ttdef"><b>Definition:</b> <a href="a02195_source.html#l00018">TimeCleanup.c:18</a></div></div>
<div class="ttc" id="a02408_html_afd006361179964b4e2c2cc65526247bd"><div class="ttname"><a href="a02408.html#afd006361179964b4e2c2cc65526247bd">SparseGridsSimulation::m_sims_sg</a></div><div class="ttdeci">std::vector&lt; SimulationObject &gt; m_sims_sg</div><div class="ttdef"><b>Definition:</b> <a href="a01106_source.html#l00231">sparse_grids_simulation.h:231</a></div></div>
<div class="ttc" id="a02280_html_a267ef7e03dbe9dd4440dee2fdf48619a"><div class="ttname"><a href="a02280.html#a267ef7e03dbe9dd4440dee2fdf48619a">HyPar::iblank</a></div><div class="ttdeci">double * iblank</div><div class="ttdef"><b>Definition:</b> <a href="a00986_source.html#l00431">hypar.h:431</a></div></div>
<div class="ttc" id="a02280_html_ae83b1b0117b6a805ead2e4728945814c"><div class="ttname"><a href="a02280.html#ae83b1b0117b6a805ead2e4728945814c">HyPar::flag_ib</a></div><div class="ttdeci">int flag_ib</div><div class="ttdef"><b>Definition:</b> <a href="a00986_source.html#l00436">hypar.h:436</a></div></div>
<div class="ttc" id="a01112_html_acb00956b2e195653e3f8107b1ab1dc4d"><div class="ttname"><a href="a01112.html#acb00956b2e195653e3f8107b1ab1dc4d">TimeStep</a></div><div class="ttdeci">int TimeStep(void *)</div><div class="ttdef"><b>Definition:</b> <a href="a02240_source.html#l00013">TimeStep.c:13</a></div></div>
<div class="ttc" id="a02412_html_a28e4e78c0bf258662bef21d26c51fc0b"><div class="ttname"><a href="a02412.html#a28e4e78c0bf258662bef21d26c51fc0b">TimeIntegration::waqt</a></div><div class="ttdeci">double waqt</div><div class="ttdef"><b>Definition:</b> <a href="a01118_source.html#l00037">timeintegration_struct.h:37</a></div></div>
<div class="ttc" id="a00974_html_a3e3ad5aed581d9ae563190c365dadc41"><div class="ttname"><a href="a00974.html#a3e3ad5aed581d9ae563190c365dadc41">GetStringFromInteger</a></div><div class="ttdeci">void GetStringFromInteger(int, char *, int)</div><div class="ttdef"><b>Definition:</b> <a href="a01211_source.html#l00015">CommonFunctions.c:15</a></div></div>
<div class="ttc" id="a02280_html_a711aad4cbe735871dd9e91ab575c878b"><div class="ttname"><a href="a02280.html#a711aad4cbe735871dd9e91ab575c878b">HyPar::x</a></div><div class="ttdeci">double * x</div><div class="ttdef"><b>Definition:</b> <a href="a00986_source.html#l00107">hypar.h:107</a></div></div>
<div class="ttc" id="a02412_html"><div class="ttname"><a href="a02412.html">TimeIntegration</a></div><div class="ttdoc">Structure of variables/parameters and function pointers for time integration. </div><div class="ttdef"><b>Definition:</b> <a href="a01118_source.html#l00029">timeintegration_struct.h:29</a></div></div>
<div class="ttc" id="a02408_html_ae5bbe5daa629a4f92b569cb632256780"><div class="ttname"><a href="a02408.html#ae5bbe5daa629a4f92b569cb632256780">SparseGridsSimulation::m_nproc</a></div><div class="ttdeci">int m_nproc</div><div class="ttdef"><b>Definition:</b> <a href="a01106_source.html#l00216">sparse_grids_simulation.h:216</a></div></div>
<div class="ttc" id="a02412_html_af0d8e0d5d3de3869b941b66b6caaf964"><div class="ttname"><a href="a02412.html#af0d8e0d5d3de3869b941b66b6caaf964">TimeIntegration::n_iter</a></div><div class="ttdeci">int n_iter</div><div class="ttdef"><b>Definition:</b> <a href="a01118_source.html#l00033">timeintegration_struct.h:33</a></div></div>
<div class="ttc" id="a00995_html_aaf888c739c5200d9c58a7154347069b0"><div class="ttname"><a href="a00995.html#aaf888c739c5200d9c58a7154347069b0">WriteArray</a></div><div class="ttdeci">int WriteArray(int, int, int *, int *, int, double *, double *, void *, void *, char *)</div><div class="ttdef"><b>Definition:</b> <a href="a01421_source.html#l00027">WriteArray.c:27</a></div></div>
<div class="ttc" id="a02408_html_aba08ee83eb54edc5274b210c75e63e8c"><div class="ttname"><a href="a02408.html#aba08ee83eb54edc5274b210c75e63e8c">SparseGridsSimulation::OutputSolution</a></div><div class="ttdeci">void OutputSolution()</div><div class="ttdef"><b>Definition:</b> <a href="a02180_source.html#l00011">SparseGridsOutputSolution.cpp:11</a></div></div>
<div class="ttc" id="a02280_html_a38e0371f331cecbe63a77fa03e202afe"><div class="ttname"><a href="a02280.html#a38e0371f331cecbe63a77fa03e202afe">HyPar::dim_local</a></div><div class="ttdeci">int * dim_local</div><div class="ttdef"><b>Definition:</b> <a href="a00986_source.html#l00037">hypar.h:37</a></div></div>
<div class="ttc" id="a02280_html_aafc992b5fa79d5a4036024615d03bce6"><div class="ttname"><a href="a02280.html#aafc992b5fa79d5a4036024615d03bce6">HyPar::ghosts</a></div><div class="ttdeci">int ghosts</div><div class="ttdef"><b>Definition:</b> <a href="a00986_source.html#l00052">hypar.h:52</a></div></div>
<div class="ttc" id="a02412_html_aab6f168571c2073e01e240524b8a3da0"><div class="ttname"><a href="a02412.html#aab6f168571c2073e01e240524b8a3da0">TimeIntegration::iter</a></div><div class="ttdeci">int iter</div><div class="ttdef"><b>Definition:</b> <a href="a01118_source.html#l00031">timeintegration_struct.h:31</a></div></div>
<div class="ttc" id="a01112_html_aa1ffb2050f4788b7c49b4576a9fe52ca"><div class="ttname"><a href="a01112.html#aa1ffb2050f4788b7c49b4576a9fe52ca">TimePrintStep</a></div><div class="ttdeci">int TimePrintStep(void *)</div><div class="ttdef"><b>Definition:</b> <a href="a02231_source.html#l00016">TimePrintStep.c:16</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ad7d8bcadf64dc098044a1cbff213a92e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad7d8bcadf64dc098044a1cbff213a92e">&#9670;&nbsp;</a></span>WriteErrors()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void WriteErrors </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>solver_runtime</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>main_runtime</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Write simulation errors and wall times to file</p>
<p>Writes out the errors and other data for the sparse grids simulation. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">solver_runtime</td><td>Measured runtime of solver </td></tr>
    <tr><td class="paramname">main_runtime</td><td>Measured total runtime </td></tr>
  </table>
  </dd>
</dl>

<p>Implements <a class="el" href="a02396.html#a556dad02c6a5947283592e416a33b605">Simulation</a>.</p>

<p class="definition">Definition at line <a class="el" href="a02192_source.html#l00014">14</a> of file <a class="el" href="a02192_source.html">SparseGridsWriteErrors.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;{</div><div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;  <span class="keywordflow">if</span> (!<a class="code" href="a02408.html#ac6a822dc76382e4027cf94ac3e510056">m_rank</a>) {</div><div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;</div><div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;    <span class="comment">/* Write sparse grids stuff, if asked for */</span></div><div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="a02408.html#a8ccd402501119573dbadc7d6e96c59a2">m_print_sg_errors</a> == 1) {</div><div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> n = 0; n &lt; <a class="code" href="a02408.html#acd95922d6bb09419fb66435d114cdb5c">m_nsims_sg</a>; n++) {</div><div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;  </div><div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;        <span class="keywordtype">char</span>  err_fname[<a class="code" href="a00965.html#a51efea86a4d76d1259893f606b776573">_MAX_STRING_SIZE_</a>],</div><div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;              cons_fname[<a class="code" href="a00965.html#a51efea86a4d76d1259893f606b776573">_MAX_STRING_SIZE_</a>],</div><div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;              fc_fname[<a class="code" href="a00965.html#a51efea86a4d76d1259893f606b776573">_MAX_STRING_SIZE_</a>];</div><div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;  </div><div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;        strcpy(err_fname, <span class="stringliteral">&quot;errors&quot;</span>);</div><div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;        strcpy(cons_fname,<span class="stringliteral">&quot;conservation&quot;</span>);</div><div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;        strcpy(fc_fname,  <span class="stringliteral">&quot;function_counts&quot;</span>);</div><div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;  </div><div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="a02408.html#acd95922d6bb09419fb66435d114cdb5c">m_nsims_sg</a> &gt; 1) {</div><div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;  </div><div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;          strcat(err_fname,<span class="stringliteral">&quot;_&quot;</span>);</div><div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;          strcat(cons_fname,<span class="stringliteral">&quot;_&quot;</span>);</div><div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;          strcat(fc_fname,<span class="stringliteral">&quot;_&quot;</span>);</div><div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;  </div><div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;          <span class="keywordtype">char</span> index[<a class="code" href="a00965.html#a51efea86a4d76d1259893f606b776573">_MAX_STRING_SIZE_</a>];</div><div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;          <a class="code" href="a00974.html#a3e3ad5aed581d9ae563190c365dadc41">GetStringFromInteger</a>(n, index, (<span class="keywordtype">int</span>)log10(<a class="code" href="a02408.html#acd95922d6bb09419fb66435d114cdb5c">m_nsims_sg</a>)+1);</div><div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;  </div><div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;          strcat(err_fname,index);</div><div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;          strcat(cons_fname,index);</div><div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;          strcat(fc_fname,index);</div><div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;        }</div><div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;  </div><div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;        strcat(err_fname,<span class="stringliteral">&quot;.dat&quot;</span>);</div><div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;        strcat(cons_fname,<span class="stringliteral">&quot;.dat&quot;</span>);</div><div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;        strcat(fc_fname,<span class="stringliteral">&quot;.dat&quot;</span>);</div><div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;  </div><div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;        FILE *out; </div><div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;        <span class="comment">/* write out solution errors and wall times to file */</span></div><div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;        <span class="keywordtype">int</span> d;</div><div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;        out = fopen(err_fname,<span class="stringliteral">&quot;w&quot;</span>);</div><div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;        <span class="keywordflow">for</span> (d=0; d&lt;<a class="code" href="a02408.html#afd006361179964b4e2c2cc65526247bd">m_sims_sg</a>[n].solver.ndims; d++) fprintf(out,<span class="stringliteral">&quot;%4d &quot;</span>,<a class="code" href="a02408.html#afd006361179964b4e2c2cc65526247bd">m_sims_sg</a>[n].solver.dim_global[d]);</div><div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;        <span class="keywordflow">for</span> (d=0; d&lt;<a class="code" href="a02408.html#afd006361179964b4e2c2cc65526247bd">m_sims_sg</a>[n].solver.ndims; d++) fprintf(out,<span class="stringliteral">&quot;%4d &quot;</span>,<a class="code" href="a02408.html#afd006361179964b4e2c2cc65526247bd">m_sims_sg</a>[n].mpi.iproc[d]);</div><div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;        fprintf(out,<span class="stringliteral">&quot;%1.16E  &quot;</span>,<a class="code" href="a02408.html#afd006361179964b4e2c2cc65526247bd">m_sims_sg</a>[n].solver.dt);</div><div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;        fprintf(out,<span class="stringliteral">&quot;%1.16E %1.16E %1.16E   &quot;</span>,<a class="code" href="a02408.html#afd006361179964b4e2c2cc65526247bd">m_sims_sg</a>[n].solver.error[0],<a class="code" href="a02408.html#afd006361179964b4e2c2cc65526247bd">m_sims_sg</a>[n].solver.error[1],<a class="code" href="a02408.html#afd006361179964b4e2c2cc65526247bd">m_sims_sg</a>[n].solver.error[2]);</div><div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;        fprintf(out,<span class="stringliteral">&quot;%1.16E %1.16E\n&quot;</span>,solver_runtime,main_runtime);</div><div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;        fclose(out);</div><div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;        <span class="comment">/* write out conservation errors to file */</span></div><div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;        out = fopen(cons_fname,<span class="stringliteral">&quot;w&quot;</span>);</div><div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;        <span class="keywordflow">for</span> (d=0; d&lt;<a class="code" href="a02408.html#afd006361179964b4e2c2cc65526247bd">m_sims_sg</a>[n].solver.ndims; d++) fprintf(out,<span class="stringliteral">&quot;%4d &quot;</span>,<a class="code" href="a02408.html#afd006361179964b4e2c2cc65526247bd">m_sims_sg</a>[n].solver.dim_global[d]);</div><div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;        <span class="keywordflow">for</span> (d=0; d&lt;<a class="code" href="a02408.html#afd006361179964b4e2c2cc65526247bd">m_sims_sg</a>[n].solver.ndims; d++) fprintf(out,<span class="stringliteral">&quot;%4d &quot;</span>,<a class="code" href="a02408.html#afd006361179964b4e2c2cc65526247bd">m_sims_sg</a>[n].mpi.iproc[d]);</div><div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;        fprintf(out,<span class="stringliteral">&quot;%1.16E  &quot;</span>,<a class="code" href="a02408.html#afd006361179964b4e2c2cc65526247bd">m_sims_sg</a>[n].solver.dt);</div><div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;        <span class="keywordflow">for</span> (d=0; d&lt;<a class="code" href="a02408.html#afd006361179964b4e2c2cc65526247bd">m_sims_sg</a>[n].solver.nvars; d++) fprintf(out,<span class="stringliteral">&quot;%1.16E &quot;</span>,<a class="code" href="a02408.html#afd006361179964b4e2c2cc65526247bd">m_sims_sg</a>[n].solver.ConservationError[d]);</div><div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;        fprintf(out,<span class="stringliteral">&quot;\n&quot;</span>);</div><div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;        fclose(out);</div><div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;        <span class="comment">/* write out function call counts to file */</span></div><div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;        out = fopen(fc_fname,<span class="stringliteral">&quot;w&quot;</span>);</div><div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;        fprintf(out,<span class="stringliteral">&quot;%d\n&quot;</span>,<a class="code" href="a02408.html#afd006361179964b4e2c2cc65526247bd">m_sims_sg</a>[n].solver.n_iter);</div><div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;        fprintf(out,<span class="stringliteral">&quot;%d\n&quot;</span>,<a class="code" href="a02408.html#afd006361179964b4e2c2cc65526247bd">m_sims_sg</a>[n].solver.count_hyp);</div><div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;        fprintf(out,<span class="stringliteral">&quot;%d\n&quot;</span>,<a class="code" href="a02408.html#afd006361179964b4e2c2cc65526247bd">m_sims_sg</a>[n].solver.count_par);</div><div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;        fprintf(out,<span class="stringliteral">&quot;%d\n&quot;</span>,<a class="code" href="a02408.html#afd006361179964b4e2c2cc65526247bd">m_sims_sg</a>[n].solver.count_sou);</div><div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;<span class="preprocessor">  #ifdef with_petsc</span></div><div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;        fprintf(out,<span class="stringliteral">&quot;%d\n&quot;</span>,<a class="code" href="a02408.html#afd006361179964b4e2c2cc65526247bd">m_sims_sg</a>[n].solver.count_RHSFunction);</div><div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;        fprintf(out,<span class="stringliteral">&quot;%d\n&quot;</span>,<a class="code" href="a02408.html#afd006361179964b4e2c2cc65526247bd">m_sims_sg</a>[n].solver.count_IFunction);</div><div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;        fprintf(out,<span class="stringliteral">&quot;%d\n&quot;</span>,<a class="code" href="a02408.html#afd006361179964b4e2c2cc65526247bd">m_sims_sg</a>[n].solver.count_IJacobian);</div><div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;        fprintf(out,<span class="stringliteral">&quot;%d\n&quot;</span>,<a class="code" href="a02408.html#afd006361179964b4e2c2cc65526247bd">m_sims_sg</a>[n].solver.count_IJacFunction);</div><div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;<span class="preprocessor">  #endif</span></div><div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;        fclose(out);</div><div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;  </div><div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;        <span class="comment">/* print solution errors, conservation errors, and wall times to screen */</span></div><div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="a02408.html#afd006361179964b4e2c2cc65526247bd">m_sims_sg</a>[n].solver.error[0] &gt;= 0) {</div><div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;          printf(<span class="stringliteral">&quot;Computed errors for sparse grids domain %d:\n&quot;</span>, n);</div><div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;          printf(<span class="stringliteral">&quot;  L1   Error: %1.16E\n&quot;</span>,<a class="code" href="a02408.html#afd006361179964b4e2c2cc65526247bd">m_sims_sg</a>[n].solver.error[0]);</div><div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;          printf(<span class="stringliteral">&quot;  L2   Error: %1.16E\n&quot;</span>,<a class="code" href="a02408.html#afd006361179964b4e2c2cc65526247bd">m_sims_sg</a>[n].solver.error[1]);</div><div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;          printf(<span class="stringliteral">&quot;  Linf Error: %1.16E\n&quot;</span>,<a class="code" href="a02408.html#afd006361179964b4e2c2cc65526247bd">m_sims_sg</a>[n].solver.error[2]);</div><div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;        }</div><div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;        <span class="keywordflow">if</span> (!strcmp(<a class="code" href="a02408.html#afd006361179964b4e2c2cc65526247bd">m_sims_sg</a>[n].solver.ConservationCheck,<span class="stringliteral">&quot;yes&quot;</span>)) {</div><div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;          printf(<span class="stringliteral">&quot;Conservation Errors:\n&quot;</span>);</div><div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;          <span class="keywordflow">for</span> (d=0; d&lt;<a class="code" href="a02408.html#afd006361179964b4e2c2cc65526247bd">m_sims_sg</a>[n].solver.nvars; d++) printf(<span class="stringliteral">&quot;\t%1.16E\n&quot;</span>,<a class="code" href="a02408.html#afd006361179964b4e2c2cc65526247bd">m_sims_sg</a>[n].solver.ConservationError[d]);</div><div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;          printf(<span class="stringliteral">&quot;\n&quot;</span>);</div><div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;        }</div><div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;  </div><div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;      }</div><div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;    }</div><div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;</div><div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;    <span class="comment">/* First write stuff for the full grid solution */</span></div><div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;    {</div><div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;      <span class="keywordtype">char</span>  err_fname[<a class="code" href="a00965.html#a51efea86a4d76d1259893f606b776573">_MAX_STRING_SIZE_</a>];</div><div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;      strcpy(err_fname,<span class="stringliteral">&quot;errors_fg&quot;</span>);</div><div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;      strcat(err_fname,<span class="stringliteral">&quot;.dat&quot;</span>);</div><div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;</div><div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;      FILE *out; </div><div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;      <span class="comment">/* write out solution errors and wall times to file */</span></div><div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;      <span class="keywordtype">int</span> d;</div><div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;      out = fopen(err_fname,<span class="stringliteral">&quot;w&quot;</span>);</div><div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;      <span class="keywordflow">for</span> (d=0; d&lt;<a class="code" href="a02408.html#a41a86f682aa37c28c671759a11a494a8">m_sim_fg</a>-&gt;<a class="code" href="a01100.html#a523947ce4fa7128c4c767163953253b9">solver</a>.<a class="code" href="a02280.html#a484873c74138512e41bc50d17b7d955a">ndims</a>; d++) fprintf(out,<span class="stringliteral">&quot;%4d &quot;</span>,<a class="code" href="a02408.html#a41a86f682aa37c28c671759a11a494a8">m_sim_fg</a>-&gt;<a class="code" href="a01100.html#a523947ce4fa7128c4c767163953253b9">solver</a>.<a class="code" href="a02280.html#aa989ebb755986852177779cdf7bd8c85">dim_global</a>[d]);</div><div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;      <span class="keywordflow">for</span> (d=0; d&lt;<a class="code" href="a02408.html#a41a86f682aa37c28c671759a11a494a8">m_sim_fg</a>-&gt;<a class="code" href="a01100.html#a523947ce4fa7128c4c767163953253b9">solver</a>.<a class="code" href="a02280.html#a484873c74138512e41bc50d17b7d955a">ndims</a>; d++) fprintf(out,<span class="stringliteral">&quot;%4d &quot;</span>,<a class="code" href="a02408.html#a41a86f682aa37c28c671759a11a494a8">m_sim_fg</a>-&gt;<a class="code" href="a01100.html#a4afd2c7b3eb8fda452474ebdbe71c8c0">mpi</a>.<a class="code" href="a01028.html#a0be0f30a83bc3f3d9f6ee3a36bbf2716">iproc</a>[d]);</div><div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;      fprintf(out,<span class="stringliteral">&quot;%1.16E  &quot;</span>,<a class="code" href="a02408.html#a41a86f682aa37c28c671759a11a494a8">m_sim_fg</a>-&gt;<a class="code" href="a01100.html#a523947ce4fa7128c4c767163953253b9">solver</a>.<a class="code" href="a02280.html#a03e28be41881b703c836edbfe9b51b17">dt</a>);</div><div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;      fprintf(out,<span class="stringliteral">&quot;%1.16E %1.16E %1.16E   &quot;</span>,<a class="code" href="a02408.html#a41a86f682aa37c28c671759a11a494a8">m_sim_fg</a>-&gt;<a class="code" href="a01100.html#a523947ce4fa7128c4c767163953253b9">solver</a>.<a class="code" href="a02280.html#aa40f27cb2afa2db0f0468962be8b3679">error</a>[0],<a class="code" href="a02408.html#a41a86f682aa37c28c671759a11a494a8">m_sim_fg</a>-&gt;<a class="code" href="a01100.html#a523947ce4fa7128c4c767163953253b9">solver</a>.<a class="code" href="a02280.html#aa40f27cb2afa2db0f0468962be8b3679">error</a>[1],<a class="code" href="a02408.html#a41a86f682aa37c28c671759a11a494a8">m_sim_fg</a>-&gt;<a class="code" href="a01100.html#a523947ce4fa7128c4c767163953253b9">solver</a>.<a class="code" href="a02280.html#aa40f27cb2afa2db0f0468962be8b3679">error</a>[2]);</div><div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;      fprintf(out,<span class="stringliteral">&quot;%1.16E %1.16E\n&quot;</span>,solver_runtime,main_runtime);</div><div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;      fclose(out);</div><div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;</div><div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;      <span class="comment">/* print solution errors, conservation errors, and wall times to screen */</span></div><div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="a02408.html#a41a86f682aa37c28c671759a11a494a8">m_sim_fg</a>-&gt;<a class="code" href="a01100.html#a523947ce4fa7128c4c767163953253b9">solver</a>.<a class="code" href="a02280.html#aa40f27cb2afa2db0f0468962be8b3679">error</a>[0] &gt;= 0) {</div><div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;        printf(<span class="stringliteral">&quot;Computed errors for full grid solution:\n&quot;</span>);</div><div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;        printf(<span class="stringliteral">&quot;  L1   Error: %1.16E\n&quot;</span>,<a class="code" href="a02408.html#a41a86f682aa37c28c671759a11a494a8">m_sim_fg</a>-&gt;<a class="code" href="a01100.html#a523947ce4fa7128c4c767163953253b9">solver</a>.<a class="code" href="a02280.html#aa40f27cb2afa2db0f0468962be8b3679">error</a>[0]);</div><div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;        printf(<span class="stringliteral">&quot;  L2   Error: %1.16E\n&quot;</span>,<a class="code" href="a02408.html#a41a86f682aa37c28c671759a11a494a8">m_sim_fg</a>-&gt;<a class="code" href="a01100.html#a523947ce4fa7128c4c767163953253b9">solver</a>.<a class="code" href="a02280.html#aa40f27cb2afa2db0f0468962be8b3679">error</a>[1]);</div><div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;        printf(<span class="stringliteral">&quot;  Linf Error: %1.16E\n&quot;</span>,<a class="code" href="a02408.html#a41a86f682aa37c28c671759a11a494a8">m_sim_fg</a>-&gt;<a class="code" href="a01100.html#a523947ce4fa7128c4c767163953253b9">solver</a>.<a class="code" href="a02280.html#aa40f27cb2afa2db0f0468962be8b3679">error</a>[2]);</div><div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;      }</div><div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;    }</div><div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;</div><div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;    <span class="comment">/* report wall times */</span></div><div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;    printf(<span class="stringliteral">&quot;Solver runtime (in seconds): %1.16E\n&quot;</span>,solver_runtime);</div><div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;    printf(<span class="stringliteral">&quot;Total  runtime (in seconds): %1.16E\n&quot;</span>,main_runtime);</div><div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;</div><div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;  }</div><div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;</div><div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;  <span class="keywordflow">return</span>;</div><div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;}</div><div class="ttc" id="a02280_html_a484873c74138512e41bc50d17b7d955a"><div class="ttname"><a href="a02280.html#a484873c74138512e41bc50d17b7d955a">HyPar::ndims</a></div><div class="ttdeci">int ndims</div><div class="ttdef"><b>Definition:</b> <a href="a00986_source.html#l00026">hypar.h:26</a></div></div>
<div class="ttc" id="a02408_html_acd95922d6bb09419fb66435d114cdb5c"><div class="ttname"><a href="a02408.html#acd95922d6bb09419fb66435d114cdb5c">SparseGridsSimulation::m_nsims_sg</a></div><div class="ttdeci">int m_nsims_sg</div><div class="ttdef"><b>Definition:</b> <a href="a01106_source.html#l00214">sparse_grids_simulation.h:214</a></div></div>
<div class="ttc" id="a00965_html_a51efea86a4d76d1259893f606b776573"><div class="ttname"><a href="a00965.html#a51efea86a4d76d1259893f606b776573">_MAX_STRING_SIZE_</a></div><div class="ttdeci">#define _MAX_STRING_SIZE_</div><div class="ttdef"><b>Definition:</b> <a href="a00965_source.html#l00014">basic.h:14</a></div></div>
<div class="ttc" id="a02280_html_aa989ebb755986852177779cdf7bd8c85"><div class="ttname"><a href="a02280.html#aa989ebb755986852177779cdf7bd8c85">HyPar::dim_global</a></div><div class="ttdeci">int * dim_global</div><div class="ttdef"><b>Definition:</b> <a href="a00986_source.html#l00033">hypar.h:33</a></div></div>
<div class="ttc" id="a01028_html_a0be0f30a83bc3f3d9f6ee3a36bbf2716"><div class="ttname"><a href="a01028.html#a0be0f30a83bc3f3d9f6ee3a36bbf2716">MPIVariables::iproc</a></div><div class="ttdeci">int * iproc</div><div class="ttdef"><b>Definition:</b> <a href="a01028_source.html#l00027">mpivars_struct.h:27</a></div></div>
<div class="ttc" id="a02408_html_a41a86f682aa37c28c671759a11a494a8"><div class="ttname"><a href="a02408.html#a41a86f682aa37c28c671759a11a494a8">SparseGridsSimulation::m_sim_fg</a></div><div class="ttdeci">SimulationObject * m_sim_fg</div><div class="ttdef"><b>Definition:</b> <a href="a01106_source.html#l00230">sparse_grids_simulation.h:230</a></div></div>
<div class="ttc" id="a01100_html_a523947ce4fa7128c4c767163953253b9"><div class="ttname"><a href="a01100.html#a523947ce4fa7128c4c767163953253b9">SimulationObject::solver</a></div><div class="ttdeci">HyPar solver</div><div class="ttdef"><b>Definition:</b> <a href="a01100_source.html#l00026">simulation_object.h:26</a></div></div>
<div class="ttc" id="a02408_html_ac6a822dc76382e4027cf94ac3e510056"><div class="ttname"><a href="a02408.html#ac6a822dc76382e4027cf94ac3e510056">SparseGridsSimulation::m_rank</a></div><div class="ttdeci">int m_rank</div><div class="ttdef"><b>Definition:</b> <a href="a01106_source.html#l00216">sparse_grids_simulation.h:216</a></div></div>
<div class="ttc" id="a01100_html_a4afd2c7b3eb8fda452474ebdbe71c8c0"><div class="ttname"><a href="a01100.html#a4afd2c7b3eb8fda452474ebdbe71c8c0">SimulationObject::mpi</a></div><div class="ttdeci">MPIVariables mpi</div><div class="ttdef"><b>Definition:</b> <a href="a01100_source.html#l00025">simulation_object.h:25</a></div></div>
<div class="ttc" id="a02408_html_a8ccd402501119573dbadc7d6e96c59a2"><div class="ttname"><a href="a02408.html#a8ccd402501119573dbadc7d6e96c59a2">SparseGridsSimulation::m_print_sg_errors</a></div><div class="ttdeci">int m_print_sg_errors</div><div class="ttdef"><b>Definition:</b> <a href="a01106_source.html#l00228">sparse_grids_simulation.h:228</a></div></div>
<div class="ttc" id="a02408_html_afd006361179964b4e2c2cc65526247bd"><div class="ttname"><a href="a02408.html#afd006361179964b4e2c2cc65526247bd">SparseGridsSimulation::m_sims_sg</a></div><div class="ttdeci">std::vector&lt; SimulationObject &gt; m_sims_sg</div><div class="ttdef"><b>Definition:</b> <a href="a01106_source.html#l00231">sparse_grids_simulation.h:231</a></div></div>
<div class="ttc" id="a02280_html_aa40f27cb2afa2db0f0468962be8b3679"><div class="ttname"><a href="a02280.html#aa40f27cb2afa2db0f0468962be8b3679">HyPar::error</a></div><div class="ttdeci">double error[3]</div><div class="ttdef"><b>Definition:</b> <a href="a00986_source.html#l00366">hypar.h:366</a></div></div>
<div class="ttc" id="a00974_html_a3e3ad5aed581d9ae563190c365dadc41"><div class="ttname"><a href="a00974.html#a3e3ad5aed581d9ae563190c365dadc41">GetStringFromInteger</a></div><div class="ttdeci">void GetStringFromInteger(int, char *, int)</div><div class="ttdef"><b>Definition:</b> <a href="a01211_source.html#l00015">CommonFunctions.c:15</a></div></div>
<div class="ttc" id="a02280_html_a03e28be41881b703c836edbfe9b51b17"><div class="ttname"><a href="a02280.html#a03e28be41881b703c836edbfe9b51b17">HyPar::dt</a></div><div class="ttdeci">double dt</div><div class="ttdef"><b>Definition:</b> <a href="a00986_source.html#l00067">hypar.h:67</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="aaa1d139fcb55b1f038ab29d736d07f3d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aaa1d139fcb55b1f038ab29d736d07f3d">&#9670;&nbsp;</a></span>isDefined()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool isDefined </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Return whether object is defined or not </p>

<p>Implements <a class="el" href="a02396.html#ab803f9379402affcb69a16a6eb2e82f9">Simulation</a>.</p>

<p class="definition">Definition at line <a class="el" href="a01106_source.html#l00176">176</a> of file <a class="el" href="a01106_source.html">sparse_grids_simulation.h</a>.</p>
<div class="fragment"><div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;{ <span class="keywordflow">return</span> <a class="code" href="a02408.html#a4c049947a4c07f2d2df7d1374a4babae">m_is_defined</a>; }</div><div class="ttc" id="a02408_html_a4c049947a4c07f2d2df7d1374a4babae"><div class="ttname"><a href="a02408.html#a4c049947a4c07f2d2df7d1374a4babae">SparseGridsSimulation::m_is_defined</a></div><div class="ttdeci">bool m_is_defined</div><div class="ttdef"><b>Definition:</b> <a href="a01106_source.html#l00212">sparse_grids_simulation.h:212</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a7c792ddc33ca725235519d368dba286a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7c792ddc33ca725235519d368dba286a">&#9670;&nbsp;</a></span>mpiCommDup()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int mpiCommDup </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Create duplicate MPI communicators </p>

<p>Implements <a class="el" href="a02396.html#aaf41c7505a305098ab14a34a640ccfc8">Simulation</a>.</p>

<p class="definition">Definition at line <a class="el" href="a01106_source.html#l00180">180</a> of file <a class="el" href="a01106_source.html">sparse_grids_simulation.h</a>.</p>
<div class="fragment"><div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;    {</div><div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;      <span class="keywordflow">if</span> (!<a class="code" href="a02408.html#a41a86f682aa37c28c671759a11a494a8">m_sim_fg</a>) {</div><div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;        fprintf(stderr, <span class="stringliteral">&quot;Error in SparseGridsSimulation::mpiCommDup()\n&quot;</span>);</div><div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;        fprintf(stderr, <span class="stringliteral">&quot;  m_sim_fg is not allocated on rank %d!\n&quot;</span>, <a class="code" href="a02408.html#ac6a822dc76382e4027cf94ac3e510056">m_rank</a>);</div><div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;        <span class="keywordflow">return</span> 1;</div><div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;      }</div><div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;      MPI_Comm_dup(MPI_COMM_WORLD, &amp;(<a class="code" href="a02408.html#a41a86f682aa37c28c671759a11a494a8">m_sim_fg</a>-&gt;<a class="code" href="a01100.html#a4afd2c7b3eb8fda452474ebdbe71c8c0">mpi</a>.<a class="code" href="a01028.html#adad7a6f85831f3ac84d854b6c80aef43">world</a>));</div><div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;      <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;    }</div><div class="ttc" id="a01028_html_adad7a6f85831f3ac84d854b6c80aef43"><div class="ttname"><a href="a01028.html#adad7a6f85831f3ac84d854b6c80aef43">MPIVariables::world</a></div><div class="ttdeci">MPI_Comm world</div><div class="ttdef"><b>Definition:</b> <a href="a01028_source.html#l00037">mpivars_struct.h:37</a></div></div>
<div class="ttc" id="a02408_html_a41a86f682aa37c28c671759a11a494a8"><div class="ttname"><a href="a02408.html#a41a86f682aa37c28c671759a11a494a8">SparseGridsSimulation::m_sim_fg</a></div><div class="ttdeci">SimulationObject * m_sim_fg</div><div class="ttdef"><b>Definition:</b> <a href="a01106_source.html#l00230">sparse_grids_simulation.h:230</a></div></div>
<div class="ttc" id="a02408_html_ac6a822dc76382e4027cf94ac3e510056"><div class="ttname"><a href="a02408.html#ac6a822dc76382e4027cf94ac3e510056">SparseGridsSimulation::m_rank</a></div><div class="ttdeci">int m_rank</div><div class="ttdef"><b>Definition:</b> <a href="a01106_source.html#l00216">sparse_grids_simulation.h:216</a></div></div>
<div class="ttc" id="a01100_html_a4afd2c7b3eb8fda452474ebdbe71c8c0"><div class="ttname"><a href="a01100.html#a4afd2c7b3eb8fda452474ebdbe71c8c0">SimulationObject::mpi</a></div><div class="ttdeci">MPIVariables mpi</div><div class="ttdef"><b>Definition:</b> <a href="a01100_source.html#l00025">simulation_object.h:25</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="af8fbcad8a3907d33ca0ec196ba3b2009"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af8fbcad8a3907d33ca0ec196ba3b2009">&#9670;&nbsp;</a></span>usePetscTS()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void usePetscTS </td>
          <td>(</td>
          <td class="paramtype">PetscBool&#160;</td>
          <td class="paramname"><em>a_flag</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Set flag whether to use PETSc time integration </p>

<p>Implements <a class="el" href="a02396.html#a14f1a22d151d2bac9c294f1e18b140d5">Simulation</a>.</p>

<p class="definition">Definition at line <a class="el" href="a01106_source.html#l00194">194</a> of file <a class="el" href="a01106_source.html">sparse_grids_simulation.h</a>.</p>
<div class="fragment"><div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;    {</div><div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;      <a class="code" href="a02408.html#a41a86f682aa37c28c671759a11a494a8">m_sim_fg</a>-&gt;<a class="code" href="a01100.html#a523947ce4fa7128c4c767163953253b9">solver</a>.<a class="code" href="a02280.html#ad195de8c64c407718e42cda9246be0d2">use_petscTS</a> = a_flag;</div><div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;    }</div><div class="ttc" id="a02280_html_ad195de8c64c407718e42cda9246be0d2"><div class="ttname"><a href="a02280.html#ad195de8c64c407718e42cda9246be0d2">HyPar::use_petscTS</a></div><div class="ttdeci">int use_petscTS</div><div class="ttdef"><b>Definition:</b> <a href="a00986_source.html#l00390">hypar.h:390</a></div></div>
<div class="ttc" id="a02408_html_a41a86f682aa37c28c671759a11a494a8"><div class="ttname"><a href="a02408.html#a41a86f682aa37c28c671759a11a494a8">SparseGridsSimulation::m_sim_fg</a></div><div class="ttdeci">SimulationObject * m_sim_fg</div><div class="ttdef"><b>Definition:</b> <a href="a01106_source.html#l00230">sparse_grids_simulation.h:230</a></div></div>
<div class="ttc" id="a01100_html_a523947ce4fa7128c4c767163953253b9"><div class="ttname"><a href="a01100.html#a523947ce4fa7128c4c767163953253b9">SimulationObject::solver</a></div><div class="ttdeci">HyPar solver</div><div class="ttdef"><b>Definition:</b> <a href="a01100_source.html#l00026">simulation_object.h:26</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a7ca501c3eb23eabd91098fdcd5263048"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7ca501c3eb23eabd91098fdcd5263048">&#9670;&nbsp;</a></span>SolvePETSc()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int SolvePETSc </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Run the simulation using PETSc time integrators </p>

<p>Implements <a class="el" href="a02396.html#ac6435b301a05aa540522666da5d92353">Simulation</a>.</p>

<p class="definition">Definition at line <a class="el" href="a01106_source.html#l00200">200</a> of file <a class="el" href="a01106_source.html">sparse_grids_simulation.h</a>.</p>
<div class="fragment"><div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;    {</div><div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;      <span class="keywordtype">int</span> retval = <a class="code" href="a02408.html#a7ca501c3eb23eabd91098fdcd5263048">::SolvePETSc</a>(  (<span class="keywordtype">void</span>*) <a class="code" href="a02408.html#afd006361179964b4e2c2cc65526247bd">m_sims_sg</a>.data(),</div><div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;                                  <a class="code" href="a02408.html#acd95922d6bb09419fb66435d114cdb5c">m_nsims_sg</a>,</div><div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;                                  <a class="code" href="a02408.html#ac6a822dc76382e4027cf94ac3e510056">m_rank</a>,</div><div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;                                  <a class="code" href="a02408.html#ae5bbe5daa629a4f92b569cb632256780">m_nproc</a> );</div><div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;      <span class="keywordflow">return</span> retval;</div><div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;    }</div><div class="ttc" id="a02408_html_acd95922d6bb09419fb66435d114cdb5c"><div class="ttname"><a href="a02408.html#acd95922d6bb09419fb66435d114cdb5c">SparseGridsSimulation::m_nsims_sg</a></div><div class="ttdeci">int m_nsims_sg</div><div class="ttdef"><b>Definition:</b> <a href="a01106_source.html#l00214">sparse_grids_simulation.h:214</a></div></div>
<div class="ttc" id="a02408_html_ac6a822dc76382e4027cf94ac3e510056"><div class="ttname"><a href="a02408.html#ac6a822dc76382e4027cf94ac3e510056">SparseGridsSimulation::m_rank</a></div><div class="ttdeci">int m_rank</div><div class="ttdef"><b>Definition:</b> <a href="a01106_source.html#l00216">sparse_grids_simulation.h:216</a></div></div>
<div class="ttc" id="a02408_html_afd006361179964b4e2c2cc65526247bd"><div class="ttname"><a href="a02408.html#afd006361179964b4e2c2cc65526247bd">SparseGridsSimulation::m_sims_sg</a></div><div class="ttdeci">std::vector&lt; SimulationObject &gt; m_sims_sg</div><div class="ttdef"><b>Definition:</b> <a href="a01106_source.html#l00231">sparse_grids_simulation.h:231</a></div></div>
<div class="ttc" id="a02408_html_a7ca501c3eb23eabd91098fdcd5263048"><div class="ttname"><a href="a02408.html#a7ca501c3eb23eabd91098fdcd5263048">SparseGridsSimulation::SolvePETSc</a></div><div class="ttdeci">int SolvePETSc()</div><div class="ttdef"><b>Definition:</b> <a href="a01106_source.html#l00200">sparse_grids_simulation.h:200</a></div></div>
<div class="ttc" id="a02408_html_ae5bbe5daa629a4f92b569cb632256780"><div class="ttname"><a href="a02408.html#ae5bbe5daa629a4f92b569cb632256780">SparseGridsSimulation::m_nproc</a></div><div class="ttdeci">int m_nproc</div><div class="ttdef"><b>Definition:</b> <a href="a01106_source.html#l00216">sparse_grids_simulation.h:216</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a19987c0f2b999b6e820231a32667ddf2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a19987c0f2b999b6e820231a32667ddf2">&#9670;&nbsp;</a></span>SanityChecks()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int SanityChecks </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Some basic sanity checks</p>
<p>Do some basic sanity checks to make sure that a sparse grids simulation can be carried out for this setup.</p>
<p>For the full grid:</p>
<ul>
<li>Check if grid sizes are same along all dimensions.</li>
<li>Check if grid size is a power of 2.</li>
<li>Check if number of MPI ranks are same along all dimensions.</li>
<li>Check if number of MPI ranks is a power of 2. </li>
</ul>

<p class="definition">Definition at line <a class="el" href="a02183_source.html#l00018">18</a> of file <a class="el" href="a02183_source.html">SparseGridsSanityChecks.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;{</div><div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;  <span class="keywordtype">int</span> *dim_global_fg = <a class="code" href="a02408.html#a41a86f682aa37c28c671759a11a494a8">m_sim_fg</a>-&gt;<a class="code" href="a01100.html#a523947ce4fa7128c4c767163953253b9">solver</a>.<a class="code" href="a02280.html#aa989ebb755986852177779cdf7bd8c85">dim_global</a>;</div><div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;  <span class="keywordtype">int</span> *iproc_fg = <a class="code" href="a02408.html#a41a86f682aa37c28c671759a11a494a8">m_sim_fg</a>-&gt;<a class="code" href="a01100.html#a4afd2c7b3eb8fda452474ebdbe71c8c0">mpi</a>.<a class="code" href="a01028.html#a0be0f30a83bc3f3d9f6ee3a36bbf2716">iproc</a>;</div><div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;</div><div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;  <span class="comment">/* check if grid sizes are same along all dimensions */</span></div><div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;  {</div><div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;    <span class="keywordtype">bool</span> flag = <span class="keyword">true</span>;</div><div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> d=0; d&lt;<a class="code" href="a02408.html#af3c229deae2a8e788c823dcc6f020b65">m_ndims</a>; d++) {</div><div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;      flag = flag &amp;&amp; (dim_global_fg[d] == dim_global_fg[0]);</div><div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;    }</div><div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;    <span class="keywordflow">if</span> (!flag) {</div><div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;      fprintf(stderr, <span class="stringliteral">&quot;Error in SparseGridsSimulation::SanityChecks()\n&quot;</span>);</div><div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;      fprintf(stderr, <span class="stringliteral">&quot;  full grid dimensions are not equal in all dimensions.\n&quot;</span>);</div><div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;      <span class="keywordflow">return</span> 1;</div><div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;    }</div><div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;  }</div><div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;</div><div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;  <span class="comment">/* check if grid size is a power of 2 */</span></div><div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;  {</div><div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;    <span class="keywordtype">bool</span> flag = <a class="code" href="a02408.html#ad209b51783ddb3be5497d6cbe6a3e8af">isPowerOfTwo</a>(dim_global_fg[0]);</div><div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;    <span class="keywordflow">if</span> (!flag) {</div><div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;      fprintf(stderr, <span class="stringliteral">&quot;Error in SparseGridsSimulation::SanityChecks()\n&quot;</span>);</div><div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;      fprintf(stderr, <span class="stringliteral">&quot;  full grid dimensions are not a power of 2.\n&quot;</span>);</div><div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;      <span class="keywordflow">return</span> 1;</div><div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;    }</div><div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;  }</div><div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;  </div><div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;  <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;}</div><div class="ttc" id="a02280_html_aa989ebb755986852177779cdf7bd8c85"><div class="ttname"><a href="a02280.html#aa989ebb755986852177779cdf7bd8c85">HyPar::dim_global</a></div><div class="ttdeci">int * dim_global</div><div class="ttdef"><b>Definition:</b> <a href="a00986_source.html#l00033">hypar.h:33</a></div></div>
<div class="ttc" id="a01028_html_a0be0f30a83bc3f3d9f6ee3a36bbf2716"><div class="ttname"><a href="a01028.html#a0be0f30a83bc3f3d9f6ee3a36bbf2716">MPIVariables::iproc</a></div><div class="ttdeci">int * iproc</div><div class="ttdef"><b>Definition:</b> <a href="a01028_source.html#l00027">mpivars_struct.h:27</a></div></div>
<div class="ttc" id="a02408_html_a41a86f682aa37c28c671759a11a494a8"><div class="ttname"><a href="a02408.html#a41a86f682aa37c28c671759a11a494a8">SparseGridsSimulation::m_sim_fg</a></div><div class="ttdeci">SimulationObject * m_sim_fg</div><div class="ttdef"><b>Definition:</b> <a href="a01106_source.html#l00230">sparse_grids_simulation.h:230</a></div></div>
<div class="ttc" id="a01100_html_a523947ce4fa7128c4c767163953253b9"><div class="ttname"><a href="a01100.html#a523947ce4fa7128c4c767163953253b9">SimulationObject::solver</a></div><div class="ttdeci">HyPar solver</div><div class="ttdef"><b>Definition:</b> <a href="a01100_source.html#l00026">simulation_object.h:26</a></div></div>
<div class="ttc" id="a02408_html_af3c229deae2a8e788c823dcc6f020b65"><div class="ttname"><a href="a02408.html#af3c229deae2a8e788c823dcc6f020b65">SparseGridsSimulation::m_ndims</a></div><div class="ttdeci">int m_ndims</div><div class="ttdef"><b>Definition:</b> <a href="a01106_source.html#l00215">sparse_grids_simulation.h:215</a></div></div>
<div class="ttc" id="a02408_html_ad209b51783ddb3be5497d6cbe6a3e8af"><div class="ttname"><a href="a02408.html#ad209b51783ddb3be5497d6cbe6a3e8af">SparseGridsSimulation::isPowerOfTwo</a></div><div class="ttdeci">bool isPowerOfTwo(int x)</div><div class="ttdef"><b>Definition:</b> <a href="a01106_source.html#l00317">sparse_grids_simulation.h:317</a></div></div>
<div class="ttc" id="a01100_html_a4afd2c7b3eb8fda452474ebdbe71c8c0"><div class="ttname"><a href="a01100.html#a4afd2c7b3eb8fda452474ebdbe71c8c0">SimulationObject::mpi</a></div><div class="ttdeci">MPIVariables mpi</div><div class="ttdef"><b>Definition:</b> <a href="a01100_source.html#l00025">simulation_object.h:25</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a8597237e7fe0da204967fedff70bc314"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8597237e7fe0da204967fedff70bc314">&#9670;&nbsp;</a></span>ComputeSGDimsAndCoeffs()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int ComputeSGDimsAndCoeffs </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Compute the number, coefficients, and dimensions of all the sparse grids that go into the combination technique. </p>

<p class="definition">Definition at line <a class="el" href="a02177_source.html#l00020">20</a> of file <a class="el" href="a02177_source.html">SparseGridsMiscFuncs.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;{</div><div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;  <a class="code" href="a02408.html#adda60102f329d6d2f76ba7ff11e84564">m_n_fg</a> = log2(<a class="code" href="a02408.html#a41a86f682aa37c28c671759a11a494a8">m_sim_fg</a>-&gt;<a class="code" href="a01100.html#a523947ce4fa7128c4c767163953253b9">solver</a>.<a class="code" href="a02280.html#aa989ebb755986852177779cdf7bd8c85">dim_global</a>[0]);</div><div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;  <span class="keywordtype">int</span> d = <a class="code" href="a02408.html#af3c229deae2a8e788c823dcc6f020b65">m_ndims</a>;</div><div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;</div><div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;  <span class="keywordtype">double</span> c1 = 1;</div><div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;  <a class="code" href="a02408.html#a8b468da0c8b3831ae8b1519d8781245f">m_combination</a>.clear();</div><div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> s = 1; s &lt;= d; s++) {</div><div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;</div><div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;    <span class="keywordtype">double</span> coeff = c1 * <a class="code" href="a02408.html#a0c79a01f9c78a0aeed162d6eafed4ad5">cfunc</a>(d-1,s-1);</div><div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;</div><div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;    std::vector&lt;GridDimensions&gt; dims(0);</div><div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;    <a class="code" href="a02408.html#ab3307eb5eb7b5d7f20266a9ea97f4c09">GetCTGridSizes</a>((<a class="code" href="a02408.html#adda60102f329d6d2f76ba7ff11e84564">m_n_fg</a>+(<a class="code" href="a02408.html#af3c229deae2a8e788c823dcc6f020b65">m_ndims</a>-1)*(<a class="code" href="a02408.html#a2e5b2d1500a445715e53baba327b79a7">m_imin</a>-1))+d-s, dims);</div><div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;    <span class="keywordflow">if</span> (dims.size() == 0) {</div><div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;      fprintf(stderr, <span class="stringliteral">&quot;Error in SparseGridsSimulation::ComputeSGDimsAndCoeffs()\n&quot;</span>);</div><div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;      fprintf(stderr, <span class="stringliteral">&quot;  GetCTGridSize() returned empty vector!\n&quot;</span>);</div><div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;      <a class="code" href="a02408.html#a8b468da0c8b3831ae8b1519d8781245f">m_combination</a>.clear();</div><div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;      <span class="keywordflow">return</span> 1;</div><div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;    }</div><div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;dims.size(); i++) {</div><div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;      <a class="code" href="a02408.html#a8b468da0c8b3831ae8b1519d8781245f">m_combination</a>.push_back(std::pair&lt;double,GridDimensions&gt;(coeff,dims[i]));</div><div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;    }</div><div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;</div><div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;    c1 *= -1;</div><div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;</div><div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;  }</div><div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;</div><div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;  <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;}</div><div class="ttc" id="a02408_html_a2e5b2d1500a445715e53baba327b79a7"><div class="ttname"><a href="a02408.html#a2e5b2d1500a445715e53baba327b79a7">SparseGridsSimulation::m_imin</a></div><div class="ttdeci">int m_imin</div><div class="ttdef"><b>Definition:</b> <a href="a01106_source.html#l00234">sparse_grids_simulation.h:234</a></div></div>
<div class="ttc" id="a02280_html_aa989ebb755986852177779cdf7bd8c85"><div class="ttname"><a href="a02280.html#aa989ebb755986852177779cdf7bd8c85">HyPar::dim_global</a></div><div class="ttdeci">int * dim_global</div><div class="ttdef"><b>Definition:</b> <a href="a00986_source.html#l00033">hypar.h:33</a></div></div>
<div class="ttc" id="a02408_html_a41a86f682aa37c28c671759a11a494a8"><div class="ttname"><a href="a02408.html#a41a86f682aa37c28c671759a11a494a8">SparseGridsSimulation::m_sim_fg</a></div><div class="ttdeci">SimulationObject * m_sim_fg</div><div class="ttdef"><b>Definition:</b> <a href="a01106_source.html#l00230">sparse_grids_simulation.h:230</a></div></div>
<div class="ttc" id="a01100_html_a523947ce4fa7128c4c767163953253b9"><div class="ttname"><a href="a01100.html#a523947ce4fa7128c4c767163953253b9">SimulationObject::solver</a></div><div class="ttdeci">HyPar solver</div><div class="ttdef"><b>Definition:</b> <a href="a01100_source.html#l00026">simulation_object.h:26</a></div></div>
<div class="ttc" id="a02408_html_af3c229deae2a8e788c823dcc6f020b65"><div class="ttname"><a href="a02408.html#af3c229deae2a8e788c823dcc6f020b65">SparseGridsSimulation::m_ndims</a></div><div class="ttdeci">int m_ndims</div><div class="ttdef"><b>Definition:</b> <a href="a01106_source.html#l00215">sparse_grids_simulation.h:215</a></div></div>
<div class="ttc" id="a02408_html_a0c79a01f9c78a0aeed162d6eafed4ad5"><div class="ttname"><a href="a02408.html#a0c79a01f9c78a0aeed162d6eafed4ad5">SparseGridsSimulation::cfunc</a></div><div class="ttdeci">double cfunc(int a, int b)</div><div class="ttdef"><b>Definition:</b> <a href="a01106_source.html#l00329">sparse_grids_simulation.h:329</a></div></div>
<div class="ttc" id="a02408_html_adda60102f329d6d2f76ba7ff11e84564"><div class="ttname"><a href="a02408.html#adda60102f329d6d2f76ba7ff11e84564">SparseGridsSimulation::m_n_fg</a></div><div class="ttdeci">int m_n_fg</div><div class="ttdef"><b>Definition:</b> <a href="a01106_source.html#l00233">sparse_grids_simulation.h:233</a></div></div>
<div class="ttc" id="a02408_html_ab3307eb5eb7b5d7f20266a9ea97f4c09"><div class="ttname"><a href="a02408.html#ab3307eb5eb7b5d7f20266a9ea97f4c09">SparseGridsSimulation::GetCTGridSizes</a></div><div class="ttdeci">void GetCTGridSizes(const int, std::vector&lt; GridDimensions &gt; &amp;)</div><div class="ttdef"><b>Definition:</b> <a href="a02177_source.html#l00052">SparseGridsMiscFuncs.cpp:52</a></div></div>
<div class="ttc" id="a02408_html_a8b468da0c8b3831ae8b1519d8781245f"><div class="ttname"><a href="a02408.html#a8b468da0c8b3831ae8b1519d8781245f">SparseGridsSimulation::m_combination</a></div><div class="ttdeci">std::vector&lt; SGCTElem &gt; m_combination</div><div class="ttdef"><b>Definition:</b> <a href="a01106_source.html#l00236">sparse_grids_simulation.h:236</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ad9caeac8fa38b61362225c3a40b2a4cc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad9caeac8fa38b61362225c3a40b2a4cc">&#9670;&nbsp;</a></span>ComputeProcessorDistribution()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int ComputeProcessorDistribution </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="a01106.html#a4e1436c018a5aad717fb73ca9004bcfc">ProcDistribution</a> &amp;&#160;</td>
          <td class="paramname"><em>a_iprocs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="a01106.html#a00167df288a1ca2c6c32af8d911975e0">GridDimensions</a> &amp;&#160;</td>
          <td class="paramname"><em>a_dim</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Compute the load-balanced MPI ranks distributions</p>
<p>Compute the load-balanced processor distribution for a given grid size and the total number of MPI ranks available </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">a_iprocs</td><td>Processor distribution to compute </td></tr>
    <tr><td class="paramname">a_dim</td><td>Grid dimensions </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="a02177_source.html#l00081">81</a> of file <a class="el" href="a02177_source.html">SparseGridsMiscFuncs.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;{</div><div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;  a_iprocs.resize(<a class="code" href="a02408.html#af3c229deae2a8e788c823dcc6f020b65">m_ndims</a>);</div><div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;  <span class="comment">/* get the normal vector for the grid dimensions */</span></div><div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;  std::vector&lt;double&gt; dvec;</div><div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;  <a class="code" href="a02264.html#a723506a5fd12767688e8642efc108cbc">StdVecOps::createNormalVector</a>(dvec, a_dim);</div><div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;</div><div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;  <span class="comment">/* calculate the maximum number of MPI ranks in each dimension */</span></div><div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;  <span class="keywordtype">int</span> max_procs[<a class="code" href="a02408.html#af3c229deae2a8e788c823dcc6f020b65">m_ndims</a>], min_procs[<a class="code" href="a02408.html#af3c229deae2a8e788c823dcc6f020b65">m_ndims</a>];</div><div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;<a class="code" href="a02408.html#af3c229deae2a8e788c823dcc6f020b65">m_ndims</a>; i++) {</div><div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;    max_procs[i] = a_dim[i]/<a class="code" href="a00965.html#ae8bb1abbd5e267c85c091fd59fe8e7e3">_MIN_GRID_PTS_PER_PROC_</a>;</div><div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;    min_procs[i] = 1;</div><div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;  }</div><div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;  <span class="keywordtype">int</span> max_nproc; <a class="code" href="a00956.html#abc65e9c6a51b875f46fdb054a0ecf604">_ArrayProduct1D_</a>(max_procs, <a class="code" href="a02408.html#af3c229deae2a8e788c823dcc6f020b65">m_ndims</a>, max_nproc);</div><div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;  <span class="keywordflow">if</span> (max_nproc &lt; <a class="code" href="a02408.html#ae5bbe5daa629a4f92b569cb632256780">m_nproc</a>) {</div><div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;    fprintf(stderr, <span class="stringliteral">&quot;Error in SparseGridsSimulation::ComputeProcessorDistribution() - rank %d\n&quot;</span>, <a class="code" href="a02408.html#ac6a822dc76382e4027cf94ac3e510056">m_rank</a>);</div><div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;    fprintf(stderr, <span class="stringliteral">&quot;  Number of MPI ranks greater than the maximum number of MPI ranks that can be used.\n&quot;</span>);</div><div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;    fprintf(stderr, <span class="stringliteral">&quot;  Please re-run with %d MPI ranks.\n&quot;</span>, max_nproc);</div><div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;    <span class="keywordflow">return</span> 1;</div><div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;  }</div><div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;</div><div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;  <span class="comment">/* find all the processor distributions that are okay, i.e., their product</span></div><div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;<span class="comment">   * is the total number of MPI ranks #SparseGridsSimulation::m_nproc */</span></div><div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;  std::vector&lt;ProcDistribution&gt; iproc_candidates(0);</div><div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;  <span class="keywordtype">int</span> iproc[<a class="code" href="a02408.html#af3c229deae2a8e788c823dcc6f020b65">m_ndims</a>], ubound[<a class="code" href="a02408.html#af3c229deae2a8e788c823dcc6f020b65">m_ndims</a>], done = 0;</div><div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> d=0; d&lt;<a class="code" href="a02408.html#af3c229deae2a8e788c823dcc6f020b65">m_ndims</a>; d++) ubound[d] = max_procs[d]+1;</div><div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;  <a class="code" href="a00956.html#a2b2826031c0cd92495ab351d3e599fc5">_ArraySetValue_</a>(iproc, <a class="code" href="a02408.html#af3c229deae2a8e788c823dcc6f020b65">m_ndims</a>, 1);</div><div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;  <span class="keywordflow">while</span> (!done) {</div><div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;    <span class="keywordtype">int</span> prod; <a class="code" href="a00956.html#abc65e9c6a51b875f46fdb054a0ecf604">_ArrayProduct1D_</a>(iproc, <a class="code" href="a02408.html#af3c229deae2a8e788c823dcc6f020b65">m_ndims</a>, prod);</div><div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;    <span class="keywordflow">if</span> (prod == <a class="code" href="a02408.html#ae5bbe5daa629a4f92b569cb632256780">m_nproc</a>) {</div><div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;      <a class="code" href="a01106.html#a4e1436c018a5aad717fb73ca9004bcfc">ProcDistribution</a> iproc_vec(<a class="code" href="a02408.html#af3c229deae2a8e788c823dcc6f020b65">m_ndims</a>);</div><div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> d = 0; d &lt; <a class="code" href="a02408.html#af3c229deae2a8e788c823dcc6f020b65">m_ndims</a>; d++) iproc_vec[d] = iproc[d];</div><div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;      iproc_candidates.push_back(iproc_vec);</div><div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;    }</div><div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;    <a class="code" href="a00956.html#a1ff9d0e331921d9b89003cfdee2f8241">_ArrayIncrementIndexWithLBound_</a>(<a class="code" href="a02408.html#af3c229deae2a8e788c823dcc6f020b65">m_ndims</a>,ubound,min_procs,iproc,done);</div><div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;  }</div><div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;  <span class="keywordflow">if</span> (iproc_candidates.size() == 0) {</div><div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;    fprintf(stderr, <span class="stringliteral">&quot;Error in SparseGridsSimulation::ComputeProcessorDistribution() - rank %d\n&quot;</span>, <a class="code" href="a02408.html#ac6a822dc76382e4027cf94ac3e510056">m_rank</a>);</div><div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;    fprintf(stderr, <span class="stringliteral">&quot;  Unable to fine candidate iprocs!\n&quot;</span>);</div><div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;    <span class="keywordflow">return</span> 1;</div><div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;  }</div><div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;</div><div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;  <span class="comment">/* find the candidate that is closest to the normalized dim vector */</span></div><div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;  <span class="keywordtype">double</span> min_norm = DBL_MAX;</div><div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i&lt;iproc_candidates.size(); i++) {</div><div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;    std::vector&lt;double&gt; pvec;</div><div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;    <a class="code" href="a02264.html#a723506a5fd12767688e8642efc108cbc">StdVecOps::createNormalVector</a>(pvec, iproc_candidates[i]);</div><div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;    <span class="keywordtype">double</span> norm = <a class="code" href="a02264.html#a7022a0455c73481fd8aa5b1c7b64bbee">StdVecOps::compute2Norm</a>(pvec, dvec);</div><div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;    <span class="keywordflow">if</span> (norm &lt; min_norm) {</div><div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;      min_norm = norm;</div><div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;      a_iprocs = iproc_candidates[i];</div><div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;    }</div><div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;  }</div><div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;</div><div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;  <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;}</div><div class="ttc" id="a01106_html_a4e1436c018a5aad717fb73ca9004bcfc"><div class="ttname"><a href="a01106.html#a4e1436c018a5aad717fb73ca9004bcfc">ProcDistribution</a></div><div class="ttdeci">std::vector&lt; int &gt; ProcDistribution</div><div class="ttdef"><b>Definition:</b> <a href="a01106_source.html#l00021">sparse_grids_simulation.h:21</a></div></div>
<div class="ttc" id="a02264_html_a723506a5fd12767688e8642efc108cbc"><div class="ttname"><a href="a02264.html#a723506a5fd12767688e8642efc108cbc">StdVecOps::createNormalVector</a></div><div class="ttdeci">void createNormalVector(std::vector&lt; double &gt; &amp;a_normal_vec, const int *a_vec, const int a_size)</div><div class="ttdef"><b>Definition:</b> <a href="a01109_source.html#l00070">std_vec_ops.h:70</a></div></div>
<div class="ttc" id="a00956_html_a1ff9d0e331921d9b89003cfdee2f8241"><div class="ttname"><a href="a00956.html#a1ff9d0e331921d9b89003cfdee2f8241">_ArrayIncrementIndexWithLBound_</a></div><div class="ttdeci">#define _ArrayIncrementIndexWithLBound_(N, imax, imin, i, done)</div><div class="ttdef"><b>Definition:</b> <a href="a00956_source.html#l00149">arrayfunctions.h:149</a></div></div>
<div class="ttc" id="a02408_html_af3c229deae2a8e788c823dcc6f020b65"><div class="ttname"><a href="a02408.html#af3c229deae2a8e788c823dcc6f020b65">SparseGridsSimulation::m_ndims</a></div><div class="ttdeci">int m_ndims</div><div class="ttdef"><b>Definition:</b> <a href="a01106_source.html#l00215">sparse_grids_simulation.h:215</a></div></div>
<div class="ttc" id="a00956_html_a2b2826031c0cd92495ab351d3e599fc5"><div class="ttname"><a href="a00956.html#a2b2826031c0cd92495ab351d3e599fc5">_ArraySetValue_</a></div><div class="ttdeci">#define _ArraySetValue_(x, size, value)</div><div class="ttdef"><b>Definition:</b> <a href="a00956_source.html#l00169">arrayfunctions.h:169</a></div></div>
<div class="ttc" id="a02408_html_ac6a822dc76382e4027cf94ac3e510056"><div class="ttname"><a href="a02408.html#ac6a822dc76382e4027cf94ac3e510056">SparseGridsSimulation::m_rank</a></div><div class="ttdeci">int m_rank</div><div class="ttdef"><b>Definition:</b> <a href="a01106_source.html#l00216">sparse_grids_simulation.h:216</a></div></div>
<div class="ttc" id="a00956_html_abc65e9c6a51b875f46fdb054a0ecf604"><div class="ttname"><a href="a00956.html#abc65e9c6a51b875f46fdb054a0ecf604">_ArrayProduct1D_</a></div><div class="ttdeci">#define _ArrayProduct1D_(x, size, p)</div><div class="ttdef"><b>Definition:</b> <a href="a00956_source.html#l00377">arrayfunctions.h:377</a></div></div>
<div class="ttc" id="a02408_html_ae5bbe5daa629a4f92b569cb632256780"><div class="ttname"><a href="a02408.html#ae5bbe5daa629a4f92b569cb632256780">SparseGridsSimulation::m_nproc</a></div><div class="ttdeci">int m_nproc</div><div class="ttdef"><b>Definition:</b> <a href="a01106_source.html#l00216">sparse_grids_simulation.h:216</a></div></div>
<div class="ttc" id="a02264_html_a7022a0455c73481fd8aa5b1c7b64bbee"><div class="ttname"><a href="a02264.html#a7022a0455c73481fd8aa5b1c7b64bbee">StdVecOps::compute2Norm</a></div><div class="ttdeci">double compute2Norm(const std::vector&lt; double &gt; &amp;a_a, const std::vector&lt; double &gt; &amp;a_b)</div><div class="ttdef"><b>Definition:</b> <a href="a01109_source.html#l00102">std_vec_ops.h:102</a></div></div>
<div class="ttc" id="a00965_html_ae8bb1abbd5e267c85c091fd59fe8e7e3"><div class="ttname"><a href="a00965.html#ae8bb1abbd5e267c85c091fd59fe8e7e3">_MIN_GRID_PTS_PER_PROC_</a></div><div class="ttdeci">#define _MIN_GRID_PTS_PER_PROC_</div><div class="ttdef"><b>Definition:</b> <a href="a00965_source.html#l00039">basic.h:39</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ab3307eb5eb7b5d7f20266a9ea97f4c09"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab3307eb5eb7b5d7f20266a9ea97f4c09">&#9670;&nbsp;</a></span>GetCTGridSizes()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void GetCTGridSizes </td>
          <td>(</td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>a_N</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::vector&lt; <a class="el" href="a01106.html#a00167df288a1ca2c6c32af8d911975e0">GridDimensions</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>a_dims</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Compute all grids such that the base2 logs of the size in each dimension adds up to the input argument </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">a_N</td><td>Desired sum of the base2 logs of grid sizes </td></tr>
    <tr><td class="paramname">a_dims</td><td>Vector of grid sizes </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="a02177_source.html#l00052">52</a> of file <a class="el" href="a02177_source.html">SparseGridsMiscFuncs.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;{</div><div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;  a_dims.clear();</div><div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;</div><div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;  <span class="keywordtype">int</span> index[<a class="code" href="a02408.html#af3c229deae2a8e788c823dcc6f020b65">m_ndims</a>], ubounds[<a class="code" href="a02408.html#af3c229deae2a8e788c823dcc6f020b65">m_ndims</a>], lbounds[<a class="code" href="a02408.html#af3c229deae2a8e788c823dcc6f020b65">m_ndims</a>];</div><div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;  <a class="code" href="a00956.html#a2b2826031c0cd92495ab351d3e599fc5">_ArraySetValue_</a>(index,  <a class="code" href="a02408.html#af3c229deae2a8e788c823dcc6f020b65">m_ndims</a>, <a class="code" href="a02408.html#a2e5b2d1500a445715e53baba327b79a7">m_imin</a>);</div><div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;  <a class="code" href="a00956.html#a2b2826031c0cd92495ab351d3e599fc5">_ArraySetValue_</a>(ubounds, <a class="code" href="a02408.html#af3c229deae2a8e788c823dcc6f020b65">m_ndims</a>, a_N);</div><div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;  <a class="code" href="a00956.html#a2b2826031c0cd92495ab351d3e599fc5">_ArraySetValue_</a>(lbounds, <a class="code" href="a02408.html#af3c229deae2a8e788c823dcc6f020b65">m_ndims</a>, <a class="code" href="a02408.html#a2e5b2d1500a445715e53baba327b79a7">m_imin</a>);</div><div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;</div><div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;  <span class="keywordtype">int</span> done = 0;</div><div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;  <span class="keywordflow">while</span> (!done) {</div><div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;    <span class="keywordtype">int</span> <a class="code" href="a02264.html#aca1295e3cf52d990f4cd1d5872f1385a">sum</a>; <a class="code" href="a00956.html#ac19904741f7ede6202c4d1e23acdab56">_ArraySum1D_</a>(index, <a class="code" href="a02264.html#aca1295e3cf52d990f4cd1d5872f1385a">sum</a>, <a class="code" href="a02408.html#af3c229deae2a8e788c823dcc6f020b65">m_ndims</a>);</div><div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="a02264.html#aca1295e3cf52d990f4cd1d5872f1385a">sum</a> == a_N) {</div><div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;      std::vector&lt;int&gt; tmp(<a class="code" href="a02408.html#af3c229deae2a8e788c823dcc6f020b65">m_ndims</a>);</div><div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> d=0; d&lt;<a class="code" href="a02408.html#af3c229deae2a8e788c823dcc6f020b65">m_ndims</a>; d++) {</div><div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;        <a class="code" href="a01007.html#a74ca90b3ea1d23b2f0ab160523e2f477">raiseto_int</a>( tmp[d], 2,index[d] );</div><div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;      }</div><div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;      a_dims.push_back(tmp);</div><div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;    }</div><div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;    <a class="code" href="a00956.html#a1ff9d0e331921d9b89003cfdee2f8241">_ArrayIncrementIndexWithLBound_</a>(<a class="code" href="a02408.html#af3c229deae2a8e788c823dcc6f020b65">m_ndims</a>,ubounds,lbounds,index,done);</div><div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;  }</div><div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;</div><div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;  <span class="keywordflow">return</span>;</div><div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;}</div><div class="ttc" id="a01007_html_a74ca90b3ea1d23b2f0ab160523e2f477"><div class="ttname"><a href="a01007.html#a74ca90b3ea1d23b2f0ab160523e2f477">raiseto_int</a></div><div class="ttdeci">#define raiseto_int(y, x, a)</div><div class="ttdef"><b>Definition:</b> <a href="a01007_source.html#l00042">math_ops.h:42</a></div></div>
<div class="ttc" id="a00956_html_ac19904741f7ede6202c4d1e23acdab56"><div class="ttname"><a href="a00956.html#ac19904741f7ede6202c4d1e23acdab56">_ArraySum1D_</a></div><div class="ttdeci">#define _ArraySum1D_(x, a, size)</div><div class="ttdef"><b>Definition:</b> <a href="a00956_source.html#l00179">arrayfunctions.h:179</a></div></div>
<div class="ttc" id="a02408_html_a2e5b2d1500a445715e53baba327b79a7"><div class="ttname"><a href="a02408.html#a2e5b2d1500a445715e53baba327b79a7">SparseGridsSimulation::m_imin</a></div><div class="ttdeci">int m_imin</div><div class="ttdef"><b>Definition:</b> <a href="a01106_source.html#l00234">sparse_grids_simulation.h:234</a></div></div>
<div class="ttc" id="a00956_html_a1ff9d0e331921d9b89003cfdee2f8241"><div class="ttname"><a href="a00956.html#a1ff9d0e331921d9b89003cfdee2f8241">_ArrayIncrementIndexWithLBound_</a></div><div class="ttdeci">#define _ArrayIncrementIndexWithLBound_(N, imax, imin, i, done)</div><div class="ttdef"><b>Definition:</b> <a href="a00956_source.html#l00149">arrayfunctions.h:149</a></div></div>
<div class="ttc" id="a02408_html_af3c229deae2a8e788c823dcc6f020b65"><div class="ttname"><a href="a02408.html#af3c229deae2a8e788c823dcc6f020b65">SparseGridsSimulation::m_ndims</a></div><div class="ttdeci">int m_ndims</div><div class="ttdef"><b>Definition:</b> <a href="a01106_source.html#l00215">sparse_grids_simulation.h:215</a></div></div>
<div class="ttc" id="a00956_html_a2b2826031c0cd92495ab351d3e599fc5"><div class="ttname"><a href="a00956.html#a2b2826031c0cd92495ab351d3e599fc5">_ArraySetValue_</a></div><div class="ttdeci">#define _ArraySetValue_(x, size, value)</div><div class="ttdef"><b>Definition:</b> <a href="a00956_source.html#l00169">arrayfunctions.h:169</a></div></div>
<div class="ttc" id="a02264_html_aca1295e3cf52d990f4cd1d5872f1385a"><div class="ttname"><a href="a02264.html#aca1295e3cf52d990f4cd1d5872f1385a">StdVecOps::sum</a></div><div class="ttdeci">long sum(const std::vector&lt; int &gt; &amp;a_iv)</div><div class="ttdef"><b>Definition:</b> <a href="a01109_source.html#l00018">std_vec_ops.h:18</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a02a78692b8cc62fbfb25bcdb20a9a590"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a02a78692b8cc62fbfb25bcdb20a9a590">&#9670;&nbsp;</a></span>InitializeBarebones()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int InitializeBarebones </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="a01100.html#a02400">SimulationObject</a> *&#160;</td>
          <td class="paramname"><em>simobj</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Initialize a "barebones" simulation object</p>
<p>A barebones initialization function for a simulation object. It will allocate data holders for only the stuff needed for storing a solution; this object <em>cannot</em> be used for an actual simulation. This function does the following:</p><ul>
<li>initializes the values for MPI variables</li>
<li>allocates memory for arrays to store full grid solution </li>
</ul>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">simobj</td><td>simulation objects of type <a class="el" href="a01100.html#a02400" title="Structure defining a simulation. ">SimulationObject</a> </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="a02177_source.html#l00190">190</a> of file <a class="el" href="a02177_source.html">SparseGridsMiscFuncs.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;{</div><div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;  <span class="comment">/* Set this to &quot;true&quot; since this is a barebones initialization */</span></div><div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;  simobj-&gt;<a class="code" href="a01100.html#a23988a34071e1a0f0de820a4043a1fc8">is_barebones</a> = 1;</div><div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;</div><div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;  <a class="code" href="a02280.html">HyPar</a>* solver = &amp;(simobj-&gt;<a class="code" href="a01100.html#a523947ce4fa7128c4c767163953253b9">solver</a>);</div><div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;  <a class="code" href="a01028.html#a02320">MPIVariables</a>* mpi = &amp;(simobj-&gt;<a class="code" href="a01100.html#a4afd2c7b3eb8fda452474ebdbe71c8c0">mpi</a>);</div><div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;</div><div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;  <span class="comment">/* allocations */</span></div><div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;  mpi-&gt;<a class="code" href="a01028.html#aa3c28612a64b8a97bde66b720e15c700">ip</a>             = (<span class="keywordtype">int</span>*) calloc (<a class="code" href="a02408.html#af3c229deae2a8e788c823dcc6f020b65">m_ndims</a>,<span class="keyword">sizeof</span>(<span class="keywordtype">int</span>));</div><div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;  mpi-&gt;<a class="code" href="a01028.html#a481013ba007a99a4237cde5eeb3c9a29">is</a>             = (<span class="keywordtype">int</span>*) calloc (<a class="code" href="a02408.html#af3c229deae2a8e788c823dcc6f020b65">m_ndims</a>,<span class="keyword">sizeof</span>(<span class="keywordtype">int</span>));</div><div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;  mpi-&gt;<a class="code" href="a01028.html#a7602de5ebb1b59ec35217e78a35a531e">ie</a>             = (<span class="keywordtype">int</span>*) calloc (<a class="code" href="a02408.html#af3c229deae2a8e788c823dcc6f020b65">m_ndims</a>,<span class="keyword">sizeof</span>(<span class="keywordtype">int</span>));</div><div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;  mpi-&gt;<a class="code" href="a01028.html#af40a5a3066fdb53a47e4627071abc2bc">bcperiodic</a>     = (<span class="keywordtype">int</span>*) calloc (<a class="code" href="a02408.html#af3c229deae2a8e788c823dcc6f020b65">m_ndims</a>,<span class="keyword">sizeof</span>(<span class="keywordtype">int</span>));</div><div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;  solver-&gt;<a class="code" href="a02280.html#a38e0371f331cecbe63a77fa03e202afe">dim_local</a>   = (<span class="keywordtype">int</span>*) calloc (<a class="code" href="a02408.html#af3c229deae2a8e788c823dcc6f020b65">m_ndims</a>,<span class="keyword">sizeof</span>(<span class="keywordtype">int</span>));</div><div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;  solver-&gt;<a class="code" href="a02280.html#a40e3f67b1530d5ea4e913fc60b594802">isPeriodic</a>  = (<span class="keywordtype">int</span>*) calloc (<a class="code" href="a02408.html#af3c229deae2a8e788c823dcc6f020b65">m_ndims</a>,<span class="keyword">sizeof</span>(<span class="keywordtype">int</span>));</div><div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;</div><div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;<span class="preprocessor">#ifndef serial</span></div><div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;  <span class="comment">/* Domain partitioning */</span></div><div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;  <span class="keywordtype">int</span> total_proc = 1;</div><div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;<a class="code" href="a02408.html#af3c229deae2a8e788c823dcc6f020b65">m_ndims</a>; i++) total_proc *= mpi-&gt;<a class="code" href="a01028.html#a0be0f30a83bc3f3d9f6ee3a36bbf2716">iproc</a>[i];</div><div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;</div><div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;  <span class="comment">/* calculate ndims-D rank of each process (ip[]) from rank in MPI_COMM_WORLD */</span></div><div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;  <a class="code" href="a00965.html#ad6ab74942c9de13cf0b4c12eb0d91780">IERR</a> <a class="code" href="a01022.html#afe59a0480bb81cc0d7877ba547b3e28c">MPIRanknD</a>( <a class="code" href="a02408.html#af3c229deae2a8e788c823dcc6f020b65">m_ndims</a>,</div><div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;                  <a class="code" href="a02408.html#ac6a822dc76382e4027cf94ac3e510056">m_rank</a>,</div><div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;                  mpi-&gt;<a class="code" href="a01028.html#a0be0f30a83bc3f3d9f6ee3a36bbf2716">iproc</a>,</div><div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;                  mpi-&gt;<a class="code" href="a01028.html#aa3c28612a64b8a97bde66b720e15c700">ip</a> ); <a class="code" href="a00965.html#add9cf96ae374934d245a1dc1ab697a42">CHECKERR</a>(ierr);</div><div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;</div><div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;  <span class="comment">/* calculate local domain sizes along each dimension */</span></div><div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;<a class="code" href="a02408.html#af3c229deae2a8e788c823dcc6f020b65">m_ndims</a>; i++) {</div><div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;    solver-&gt;<a class="code" href="a02280.html#a38e0371f331cecbe63a77fa03e202afe">dim_local</a>[i] = <a class="code" href="a01022.html#af8194ca5a460534fdbe391035a95c69d">MPIPartition1D</a>( solver-&gt;<a class="code" href="a02280.html#aa989ebb755986852177779cdf7bd8c85">dim_global</a>[i],</div><div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;                                           mpi-&gt;<a class="code" href="a01028.html#a0be0f30a83bc3f3d9f6ee3a36bbf2716">iproc</a>[i],</div><div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;                                           mpi-&gt;<a class="code" href="a01028.html#aa3c28612a64b8a97bde66b720e15c700">ip</a>[i] );</div><div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;  }</div><div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;</div><div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;  <span class="comment">/* calculate local domain limits in terms of global domain */</span></div><div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;  <a class="code" href="a00965.html#ad6ab74942c9de13cf0b4c12eb0d91780">IERR</a> <a class="code" href="a01022.html#a9a3fc32b7d4bea6a1dac44ab21c9202e">MPILocalDomainLimits</a>(  <a class="code" href="a02408.html#af3c229deae2a8e788c823dcc6f020b65">m_ndims</a>,</div><div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;                              <a class="code" href="a02408.html#ac6a822dc76382e4027cf94ac3e510056">m_rank</a>,</div><div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;                              &amp;(simobj-&gt;<a class="code" href="a01100.html#a4afd2c7b3eb8fda452474ebdbe71c8c0">mpi</a>),</div><div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;                              solver-&gt;<a class="code" href="a02280.html#aa989ebb755986852177779cdf7bd8c85">dim_global</a>,</div><div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;                              mpi-&gt;<a class="code" href="a01028.html#a481013ba007a99a4237cde5eeb3c9a29">is</a>,</div><div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;                              mpi-&gt;<a class="code" href="a01028.html#a7602de5ebb1b59ec35217e78a35a531e">ie</a>  );</div><div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;  <a class="code" href="a00965.html#add9cf96ae374934d245a1dc1ab697a42">CHECKERR</a>(ierr);</div><div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;</div><div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;  <span class="comment">/* create sub-communicators for parallel computations </span></div><div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;<span class="comment">   * along grid lines in each dimension */</span></div><div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;   <a class="code" href="a00965.html#ad6ab74942c9de13cf0b4c12eb0d91780">IERR</a> <a class="code" href="a01022.html#ade449de8860c4b1060ca15bf7a80476f">MPICreateCommunicators</a>(<a class="code" href="a02408.html#af3c229deae2a8e788c823dcc6f020b65">m_ndims</a>,&amp;(simobj-&gt;<a class="code" href="a01100.html#a4afd2c7b3eb8fda452474ebdbe71c8c0">mpi</a>)); <a class="code" href="a00965.html#add9cf96ae374934d245a1dc1ab697a42">CHECKERR</a>(ierr);</div><div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;</div><div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;  <span class="comment">/* initialize periodic BC flags to zero */</span></div><div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;solver-&gt;<a class="code" href="a02280.html#a484873c74138512e41bc50d17b7d955a">ndims</a>; i++) mpi-&gt;<a class="code" href="a01028.html#af40a5a3066fdb53a47e4627071abc2bc">bcperiodic</a>[i] = 0;</div><div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;  </div><div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;  <span class="comment">/* create communication groups */</span></div><div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;  <a class="code" href="a00965.html#ad6ab74942c9de13cf0b4c12eb0d91780">IERR</a> <a class="code" href="a01022.html#a87419c70e96bbafe1e63821ba1d2e975">MPICreateIOGroups</a>(&amp;(simobj-&gt;<a class="code" href="a01100.html#a4afd2c7b3eb8fda452474ebdbe71c8c0">mpi</a>)); <a class="code" href="a00965.html#add9cf96ae374934d245a1dc1ab697a42">CHECKERR</a>(ierr);</div><div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;</div><div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;<span class="preprocessor">#else</span></div><div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;</div><div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;<a class="code" href="a02408.html#af3c229deae2a8e788c823dcc6f020b65">m_ndims</a>; i++) {</div><div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;    mpi-&gt;<a class="code" href="a01028.html#aa3c28612a64b8a97bde66b720e15c700">ip</a>[i]            = 0;</div><div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;    solver-&gt;<a class="code" href="a02280.html#a38e0371f331cecbe63a77fa03e202afe">dim_local</a>[i]  = solver-&gt;<a class="code" href="a02280.html#aa989ebb755986852177779cdf7bd8c85">dim_global</a>[i];</div><div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;    mpi-&gt;<a class="code" href="a01028.html#a0be0f30a83bc3f3d9f6ee3a36bbf2716">iproc</a>[i]         = 1;</div><div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;    mpi-&gt;<a class="code" href="a01028.html#a481013ba007a99a4237cde5eeb3c9a29">is</a>[i]            = 0;</div><div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;    mpi-&gt;<a class="code" href="a01028.html#a7602de5ebb1b59ec35217e78a35a531e">ie</a>[i]            = solver-&gt;<a class="code" href="a02280.html#a38e0371f331cecbe63a77fa03e202afe">dim_local</a>[i];</div><div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;    mpi-&gt;<a class="code" href="a01028.html#af40a5a3066fdb53a47e4627071abc2bc">bcperiodic</a>[i]    = 0;</div><div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;  }</div><div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;</div><div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;</div><div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;  solver-&gt;<a class="code" href="a02280.html#a4e67f54563a3c4ff005dfaf0130f957c">npoints_global</a> </div><div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;    = solver-&gt;<a class="code" href="a02280.html#afae6319baba315ac1f0c56505610ed85">npoints_local</a> </div><div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;    = solver-&gt;<a class="code" href="a02280.html#a20ee1fd00a220b98513127884a5558cf">npoints_local_wghosts</a></div><div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;    = 1;</div><div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;<a class="code" href="a02408.html#af3c229deae2a8e788c823dcc6f020b65">m_ndims</a>; i++) {</div><div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;    solver-&gt;<a class="code" href="a02280.html#a4e67f54563a3c4ff005dfaf0130f957c">npoints_global</a> *= solver-&gt;<a class="code" href="a02280.html#aa989ebb755986852177779cdf7bd8c85">dim_global</a>[i];</div><div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;    solver-&gt;<a class="code" href="a02280.html#afae6319baba315ac1f0c56505610ed85">npoints_local</a> *= solver-&gt;<a class="code" href="a02280.html#a38e0371f331cecbe63a77fa03e202afe">dim_local</a> [i];</div><div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;    solver-&gt;<a class="code" href="a02280.html#a20ee1fd00a220b98513127884a5558cf">npoints_local_wghosts</a> *= (solver-&gt;<a class="code" href="a02280.html#a38e0371f331cecbe63a77fa03e202afe">dim_local</a>[i]+2*solver-&gt;<a class="code" href="a02280.html#aafc992b5fa79d5a4036024615d03bce6">ghosts</a>);</div><div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;  }</div><div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;</div><div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;  <span class="comment">/* Allocations */</span></div><div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;  <span class="keywordflow">if</span> (!<a class="code" href="a02408.html#ac6a822dc76382e4027cf94ac3e510056">m_rank</a>) printf(<span class="stringliteral">&quot;Allocating data arrays for full grid.\n&quot;</span>);</div><div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;  solver-&gt;<a class="code" href="a02280.html#a95e9e0f8a692321b83a2e0ce2789c485">index</a> = (<span class="keywordtype">int</span>*) calloc (<a class="code" href="a02408.html#af3c229deae2a8e788c823dcc6f020b65">m_ndims</a>,<span class="keyword">sizeof</span>(<span class="keywordtype">int</span>));</div><div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;  solver-&gt;<a class="code" href="a02280.html#a39dc7def53a36bdc722aa90f52e04561">stride_with_ghosts</a> = (<span class="keywordtype">int</span>*) calloc (solver-&gt;<a class="code" href="a02280.html#a484873c74138512e41bc50d17b7d955a">ndims</a>,<span class="keyword">sizeof</span>(<span class="keywordtype">int</span>));</div><div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;  solver-&gt;<a class="code" href="a02280.html#a98bbff775d127bdd2451b55ce3d06e06">stride_without_ghosts</a> = (<span class="keywordtype">int</span>*) calloc (solver-&gt;<a class="code" href="a02280.html#a484873c74138512e41bc50d17b7d955a">ndims</a>,<span class="keyword">sizeof</span>(<span class="keywordtype">int</span>));</div><div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;  <span class="keywordtype">int</span> accu1 = 1, accu2 = 1;</div><div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;solver-&gt;<a class="code" href="a02280.html#a484873c74138512e41bc50d17b7d955a">ndims</a>; i++) {</div><div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;    solver-&gt;<a class="code" href="a02280.html#a39dc7def53a36bdc722aa90f52e04561">stride_with_ghosts</a>[i]    = accu1;</div><div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;    solver-&gt;<a class="code" href="a02280.html#a98bbff775d127bdd2451b55ce3d06e06">stride_without_ghosts</a>[i] = accu2;</div><div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;    accu1 *= (solver-&gt;<a class="code" href="a02280.html#a38e0371f331cecbe63a77fa03e202afe">dim_local</a>[i]+2*solver-&gt;<a class="code" href="a02280.html#aafc992b5fa79d5a4036024615d03bce6">ghosts</a>);</div><div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;    accu2 *=  solver-&gt;<a class="code" href="a02280.html#a38e0371f331cecbe63a77fa03e202afe">dim_local</a>[i];</div><div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;  }</div><div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;</div><div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;</div><div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;  <span class="keywordtype">int</span> size;</div><div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;  <span class="comment">/* state variables */</span></div><div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;  size = 1;</div><div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;<a class="code" href="a02408.html#af3c229deae2a8e788c823dcc6f020b65">m_ndims</a>; i++) size *= (solver-&gt;<a class="code" href="a02280.html#a38e0371f331cecbe63a77fa03e202afe">dim_local</a>[i]+2*solver-&gt;<a class="code" href="a02280.html#aafc992b5fa79d5a4036024615d03bce6">ghosts</a>);</div><div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;  solver-&gt;<a class="code" href="a02280.html#a3b6b999a764f1e2ea94bb5f28c7a558c">u</a> = (<span class="keywordtype">double</span>*) calloc (solver-&gt;<a class="code" href="a02280.html#ae8f6d2fd6490d3153cb4133bf183a404">nvars</a>*size,<span class="keyword">sizeof</span>(<span class="keywordtype">double</span>));</div><div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;</div><div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;  <span class="comment">/* grid */</span></div><div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;  size = 0;</div><div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;<a class="code" href="a02408.html#af3c229deae2a8e788c823dcc6f020b65">m_ndims</a>; i++) size += (solver-&gt;<a class="code" href="a02280.html#a38e0371f331cecbe63a77fa03e202afe">dim_local</a>[i]+2*solver-&gt;<a class="code" href="a02280.html#aafc992b5fa79d5a4036024615d03bce6">ghosts</a>);</div><div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;  solver-&gt;<a class="code" href="a02280.html#a711aad4cbe735871dd9e91ab575c878b">x</a>     = (<span class="keywordtype">double</span>*) calloc (size,<span class="keyword">sizeof</span>(<span class="keywordtype">double</span>));</div><div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;  solver-&gt;<a class="code" href="a02280.html#aa24a4f5e29bd70cbe5a2413be1ea9682">dxinv</a> = (<span class="keywordtype">double</span>*) calloc (size,<span class="keyword">sizeof</span>(<span class="keywordtype">double</span>));</div><div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;    </div><div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;  <span class="comment">/* allocate MPI send/receive buffer arrays */</span></div><div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;  <span class="keywordtype">int</span> bufdim[solver-&gt;<a class="code" href="a02280.html#a484873c74138512e41bc50d17b7d955a">ndims</a>], maxbuf = 0;</div><div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> d = 0; d &lt; solver-&gt;<a class="code" href="a02280.html#a484873c74138512e41bc50d17b7d955a">ndims</a>; d++) {</div><div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;    bufdim[d] = 1;</div><div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; solver-&gt;<a class="code" href="a02280.html#a484873c74138512e41bc50d17b7d955a">ndims</a>; i++) {</div><div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;      <span class="keywordflow">if</span> (i == d) bufdim[d] *= solver-&gt;<a class="code" href="a02280.html#aafc992b5fa79d5a4036024615d03bce6">ghosts</a>;</div><div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;      <span class="keywordflow">else</span>        bufdim[d] *= solver-&gt;<a class="code" href="a02280.html#a38e0371f331cecbe63a77fa03e202afe">dim_local</a>[i];</div><div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;    }</div><div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;    <span class="keywordflow">if</span> (bufdim[d] &gt; maxbuf) maxbuf = bufdim[d];</div><div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;  }</div><div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;  maxbuf *= solver-&gt;<a class="code" href="a02280.html#ae8f6d2fd6490d3153cb4133bf183a404">nvars</a>;</div><div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;  mpi-&gt;<a class="code" href="a01028.html#a4c12bdea025b404c7dd79f368fc03efd">maxbuf</a>  = maxbuf;</div><div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;  mpi-&gt;<a class="code" href="a01028.html#aba3b15034da676474db917f9f5533085">sendbuf</a> = (<span class="keywordtype">double</span>*) calloc (2*solver-&gt;<a class="code" href="a02280.html#a484873c74138512e41bc50d17b7d955a">ndims</a>*maxbuf,<span class="keyword">sizeof</span>(<span class="keywordtype">double</span>));</div><div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;  mpi-&gt;<a class="code" href="a01028.html#afc23e46e08649e112e8d64d780cea5cb">recvbuf</a> = (<span class="keywordtype">double</span>*) calloc (2*solver-&gt;<a class="code" href="a02280.html#a484873c74138512e41bc50d17b7d955a">ndims</a>*maxbuf,<span class="keyword">sizeof</span>(<span class="keywordtype">double</span>));</div><div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;</div><div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;  solver-&gt;<a class="code" href="a02280.html#a57f7bff1d8bf27f2ca5c00270da00d05">VolumeIntegral</a>        = (<span class="keywordtype">double</span>*) calloc (solver-&gt;<a class="code" href="a02280.html#ae8f6d2fd6490d3153cb4133bf183a404">nvars</a>,<span class="keyword">sizeof</span>(<span class="keywordtype">double</span>));</div><div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;  solver-&gt;<a class="code" href="a02280.html#a3aec36aeb5caac1e87f5b4f5f75d5a23">VolumeIntegralInitial</a> = (<span class="keywordtype">double</span>*) calloc (solver-&gt;<a class="code" href="a02280.html#ae8f6d2fd6490d3153cb4133bf183a404">nvars</a>,<span class="keyword">sizeof</span>(<span class="keywordtype">double</span>));</div><div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;  solver-&gt;<a class="code" href="a02280.html#a644ed0ed36ed4af1c396c0af6aca043d">TotalBoundaryIntegral</a> = (<span class="keywordtype">double</span>*) calloc (solver-&gt;<a class="code" href="a02280.html#ae8f6d2fd6490d3153cb4133bf183a404">nvars</a>,<span class="keyword">sizeof</span>(<span class="keywordtype">double</span>));</div><div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;  solver-&gt;<a class="code" href="a02280.html#a965363cd64ce50ae17705dfb285dd0ab">ConservationError</a>     = (<span class="keywordtype">double</span>*) calloc (solver-&gt;<a class="code" href="a02280.html#ae8f6d2fd6490d3153cb4133bf183a404">nvars</a>,<span class="keyword">sizeof</span>(<span class="keywordtype">double</span>));</div><div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;</div><div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;solver-&gt;<a class="code" href="a02280.html#ae8f6d2fd6490d3153cb4133bf183a404">nvars</a>; i++) solver-&gt;<a class="code" href="a02280.html#a965363cd64ce50ae17705dfb285dd0ab">ConservationError</a>[i] = -1;</div><div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;</div><div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;  <span class="keywordflow">return</span>(0);</div><div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;}</div><div class="ttc" id="a02280_html_a484873c74138512e41bc50d17b7d955a"><div class="ttname"><a href="a02280.html#a484873c74138512e41bc50d17b7d955a">HyPar::ndims</a></div><div class="ttdeci">int ndims</div><div class="ttdef"><b>Definition:</b> <a href="a00986_source.html#l00026">hypar.h:26</a></div></div>
<div class="ttc" id="a02280_html"><div class="ttname"><a href="a02280.html">HyPar</a></div><div class="ttdoc">Structure containing all solver-specific variables and functions. </div><div class="ttdef"><b>Definition:</b> <a href="a00986_source.html#l00023">hypar.h:23</a></div></div>
<div class="ttc" id="a01028_html_aba3b15034da676474db917f9f5533085"><div class="ttname"><a href="a01028.html#aba3b15034da676474db917f9f5533085">MPIVariables::sendbuf</a></div><div class="ttdeci">double * sendbuf</div><div class="ttdef"><b>Definition:</b> <a href="a01028_source.html#l00051">mpivars_struct.h:51</a></div></div>
<div class="ttc" id="a00965_html_add9cf96ae374934d245a1dc1ab697a42"><div class="ttname"><a href="a00965.html#add9cf96ae374934d245a1dc1ab697a42">CHECKERR</a></div><div class="ttdeci">#define CHECKERR(ierr)</div><div class="ttdef"><b>Definition:</b> <a href="a00965_source.html#l00018">basic.h:18</a></div></div>
<div class="ttc" id="a02280_html_a965363cd64ce50ae17705dfb285dd0ab"><div class="ttname"><a href="a02280.html#a965363cd64ce50ae17705dfb285dd0ab">HyPar::ConservationError</a></div><div class="ttdeci">double * ConservationError</div><div class="ttdef"><b>Definition:</b> <a href="a00986_source.html#l00369">hypar.h:369</a></div></div>
<div class="ttc" id="a02280_html_a3b6b999a764f1e2ea94bb5f28c7a558c"><div class="ttname"><a href="a02280.html#a3b6b999a764f1e2ea94bb5f28c7a558c">HyPar::u</a></div><div class="ttdeci">double * u</div><div class="ttdef"><b>Definition:</b> <a href="a00986_source.html#l00116">hypar.h:116</a></div></div>
<div class="ttc" id="a02280_html_afae6319baba315ac1f0c56505610ed85"><div class="ttname"><a href="a02280.html#afae6319baba315ac1f0c56505610ed85">HyPar::npoints_local</a></div><div class="ttdeci">int npoints_local</div><div class="ttdef"><b>Definition:</b> <a href="a00986_source.html#l00042">hypar.h:42</a></div></div>
<div class="ttc" id="a02280_html_aa989ebb755986852177779cdf7bd8c85"><div class="ttname"><a href="a02280.html#aa989ebb755986852177779cdf7bd8c85">HyPar::dim_global</a></div><div class="ttdeci">int * dim_global</div><div class="ttdef"><b>Definition:</b> <a href="a00986_source.html#l00033">hypar.h:33</a></div></div>
<div class="ttc" id="a01028_html_a0be0f30a83bc3f3d9f6ee3a36bbf2716"><div class="ttname"><a href="a01028.html#a0be0f30a83bc3f3d9f6ee3a36bbf2716">MPIVariables::iproc</a></div><div class="ttdeci">int * iproc</div><div class="ttdef"><b>Definition:</b> <a href="a01028_source.html#l00027">mpivars_struct.h:27</a></div></div>
<div class="ttc" id="a01100_html_a523947ce4fa7128c4c767163953253b9"><div class="ttname"><a href="a01100.html#a523947ce4fa7128c4c767163953253b9">SimulationObject::solver</a></div><div class="ttdeci">HyPar solver</div><div class="ttdef"><b>Definition:</b> <a href="a01100_source.html#l00026">simulation_object.h:26</a></div></div>
<div class="ttc" id="a02280_html_a644ed0ed36ed4af1c396c0af6aca043d"><div class="ttname"><a href="a02280.html#a644ed0ed36ed4af1c396c0af6aca043d">HyPar::TotalBoundaryIntegral</a></div><div class="ttdeci">double * TotalBoundaryIntegral</div><div class="ttdef"><b>Definition:</b> <a href="a00986_source.html#l00381">hypar.h:381</a></div></div>
<div class="ttc" id="a01022_html_afe59a0480bb81cc0d7877ba547b3e28c"><div class="ttname"><a href="a01022.html#afe59a0480bb81cc0d7877ba547b3e28c">MPIRanknD</a></div><div class="ttdeci">int MPIRanknD(int, int, int *, int *)</div><div class="ttdef"><b>Definition:</b> <a href="a01514_source.html#l00027">MPIRanknD.c:27</a></div></div>
<div class="ttc" id="a02408_html_af3c229deae2a8e788c823dcc6f020b65"><div class="ttname"><a href="a02408.html#af3c229deae2a8e788c823dcc6f020b65">SparseGridsSimulation::m_ndims</a></div><div class="ttdeci">int m_ndims</div><div class="ttdef"><b>Definition:</b> <a href="a01106_source.html#l00215">sparse_grids_simulation.h:215</a></div></div>
<div class="ttc" id="a01022_html_a87419c70e96bbafe1e63821ba1d2e975"><div class="ttname"><a href="a01022.html#a87419c70e96bbafe1e63821ba1d2e975">MPICreateIOGroups</a></div><div class="ttdeci">int MPICreateIOGroups(void *)</div><div class="ttdef"><b>Definition:</b> <a href="a01490_source.html#l00037">MPIIOGroups.c:37</a></div></div>
<div class="ttc" id="a02280_html_a57f7bff1d8bf27f2ca5c00270da00d05"><div class="ttname"><a href="a02280.html#a57f7bff1d8bf27f2ca5c00270da00d05">HyPar::VolumeIntegral</a></div><div class="ttdeci">double * VolumeIntegral</div><div class="ttdef"><b>Definition:</b> <a href="a00986_source.html#l00373">hypar.h:373</a></div></div>
<div class="ttc" id="a01022_html_ade449de8860c4b1060ca15bf7a80476f"><div class="ttname"><a href="a01022.html#ade449de8860c4b1060ca15bf7a80476f">MPICreateCommunicators</a></div><div class="ttdeci">int MPICreateCommunicators(int, void *)</div><div class="ttdef"><b>Definition:</b> <a href="a01466_source.html#l00035">MPICommunicators.c:35</a></div></div>
<div class="ttc" id="a01028_html_af40a5a3066fdb53a47e4627071abc2bc"><div class="ttname"><a href="a01028.html#af40a5a3066fdb53a47e4627071abc2bc">MPIVariables::bcperiodic</a></div><div class="ttdeci">int * bcperiodic</div><div class="ttdef"><b>Definition:</b> <a href="a01028_source.html#l00031">mpivars_struct.h:31</a></div></div>
<div class="ttc" id="a02280_html_aa24a4f5e29bd70cbe5a2413be1ea9682"><div class="ttname"><a href="a02280.html#aa24a4f5e29bd70cbe5a2413be1ea9682">HyPar::dxinv</a></div><div class="ttdeci">double * dxinv</div><div class="ttdef"><b>Definition:</b> <a href="a00986_source.html#l00110">hypar.h:110</a></div></div>
<div class="ttc" id="a01028_html_aa3c28612a64b8a97bde66b720e15c700"><div class="ttname"><a href="a01028.html#aa3c28612a64b8a97bde66b720e15c700">MPIVariables::ip</a></div><div class="ttdeci">int * ip</div><div class="ttdef"><b>Definition:</b> <a href="a01028_source.html#l00028">mpivars_struct.h:28</a></div></div>
<div class="ttc" id="a02408_html_ac6a822dc76382e4027cf94ac3e510056"><div class="ttname"><a href="a02408.html#ac6a822dc76382e4027cf94ac3e510056">SparseGridsSimulation::m_rank</a></div><div class="ttdeci">int m_rank</div><div class="ttdef"><b>Definition:</b> <a href="a01106_source.html#l00216">sparse_grids_simulation.h:216</a></div></div>
<div class="ttc" id="a01028_html_a02320"><div class="ttname"><a href="a01028.html#a02320">MPIVariables</a></div><div class="ttdoc">Structure of MPI-related variables. </div><div class="ttdef"><b>Definition:</b> <a href="a01028_source.html#l00024">mpivars_struct.h:24</a></div></div>
<div class="ttc" id="a01100_html_a4afd2c7b3eb8fda452474ebdbe71c8c0"><div class="ttname"><a href="a01100.html#a4afd2c7b3eb8fda452474ebdbe71c8c0">SimulationObject::mpi</a></div><div class="ttdeci">MPIVariables mpi</div><div class="ttdef"><b>Definition:</b> <a href="a01100_source.html#l00025">simulation_object.h:25</a></div></div>
<div class="ttc" id="a02280_html_a40e3f67b1530d5ea4e913fc60b594802"><div class="ttname"><a href="a02280.html#a40e3f67b1530d5ea4e913fc60b594802">HyPar::isPeriodic</a></div><div class="ttdeci">int * isPeriodic</div><div class="ttdef"><b>Definition:</b> <a href="a00986_source.html#l00162">hypar.h:162</a></div></div>
<div class="ttc" id="a01028_html_afc23e46e08649e112e8d64d780cea5cb"><div class="ttname"><a href="a01028.html#afc23e46e08649e112e8d64d780cea5cb">MPIVariables::recvbuf</a></div><div class="ttdeci">double * recvbuf</div><div class="ttdef"><b>Definition:</b> <a href="a01028_source.html#l00051">mpivars_struct.h:51</a></div></div>
<div class="ttc" id="a01028_html_a481013ba007a99a4237cde5eeb3c9a29"><div class="ttname"><a href="a01028.html#a481013ba007a99a4237cde5eeb3c9a29">MPIVariables::is</a></div><div class="ttdeci">int * is</div><div class="ttdef"><b>Definition:</b> <a href="a01028_source.html#l00029">mpivars_struct.h:29</a></div></div>
<div class="ttc" id="a00965_html_ad6ab74942c9de13cf0b4c12eb0d91780"><div class="ttname"><a href="a00965.html#ad6ab74942c9de13cf0b4c12eb0d91780">IERR</a></div><div class="ttdeci">#define IERR</div><div class="ttdef"><b>Definition:</b> <a href="a00965_source.html#l00016">basic.h:16</a></div></div>
<div class="ttc" id="a01022_html_af8194ca5a460534fdbe391035a95c69d"><div class="ttname"><a href="a01022.html#af8194ca5a460534fdbe391035a95c69d">MPIPartition1D</a></div><div class="ttdeci">int MPIPartition1D(int, int, int)</div><div class="ttdef"><b>Definition:</b> <a href="a01502_source.html#l00014">MPIPartition1D.c:14</a></div></div>
<div class="ttc" id="a02280_html_a39dc7def53a36bdc722aa90f52e04561"><div class="ttname"><a href="a02280.html#a39dc7def53a36bdc722aa90f52e04561">HyPar::stride_with_ghosts</a></div><div class="ttdeci">int * stride_with_ghosts</div><div class="ttdef"><b>Definition:</b> <a href="a00986_source.html#l00409">hypar.h:409</a></div></div>
<div class="ttc" id="a02280_html_a711aad4cbe735871dd9e91ab575c878b"><div class="ttname"><a href="a02280.html#a711aad4cbe735871dd9e91ab575c878b">HyPar::x</a></div><div class="ttdeci">double * x</div><div class="ttdef"><b>Definition:</b> <a href="a00986_source.html#l00107">hypar.h:107</a></div></div>
<div class="ttc" id="a02280_html_a98bbff775d127bdd2451b55ce3d06e06"><div class="ttname"><a href="a02280.html#a98bbff775d127bdd2451b55ce3d06e06">HyPar::stride_without_ghosts</a></div><div class="ttdeci">int * stride_without_ghosts</div><div class="ttdef"><b>Definition:</b> <a href="a00986_source.html#l00411">hypar.h:411</a></div></div>
<div class="ttc" id="a01028_html_a7602de5ebb1b59ec35217e78a35a531e"><div class="ttname"><a href="a01028.html#a7602de5ebb1b59ec35217e78a35a531e">MPIVariables::ie</a></div><div class="ttdeci">int * ie</div><div class="ttdef"><b>Definition:</b> <a href="a01028_source.html#l00029">mpivars_struct.h:29</a></div></div>
<div class="ttc" id="a01022_html_a9a3fc32b7d4bea6a1dac44ab21c9202e"><div class="ttname"><a href="a01022.html#a9a3fc32b7d4bea6a1dac44ab21c9202e">MPILocalDomainLimits</a></div><div class="ttdeci">int MPILocalDomainLimits(int, int, void *, int *, int *, int *)</div><div class="ttdef"><b>Definition:</b> <a href="a01493_source.html#l00018">MPILocalDomainLimits.c:18</a></div></div>
<div class="ttc" id="a02280_html_a95e9e0f8a692321b83a2e0ce2789c485"><div class="ttname"><a href="a02280.html#a95e9e0f8a692321b83a2e0ce2789c485">HyPar::index</a></div><div class="ttdeci">int * index</div><div class="ttdef"><b>Definition:</b> <a href="a00986_source.html#l00102">hypar.h:102</a></div></div>
<div class="ttc" id="a02280_html_a3aec36aeb5caac1e87f5b4f5f75d5a23"><div class="ttname"><a href="a02280.html#a3aec36aeb5caac1e87f5b4f5f75d5a23">HyPar::VolumeIntegralInitial</a></div><div class="ttdeci">double * VolumeIntegralInitial</div><div class="ttdef"><b>Definition:</b> <a href="a00986_source.html#l00375">hypar.h:375</a></div></div>
<div class="ttc" id="a01028_html_a4c12bdea025b404c7dd79f368fc03efd"><div class="ttname"><a href="a01028.html#a4c12bdea025b404c7dd79f368fc03efd">MPIVariables::maxbuf</a></div><div class="ttdeci">int maxbuf</div><div class="ttdef"><b>Definition:</b> <a href="a01028_source.html#l00053">mpivars_struct.h:53</a></div></div>
<div class="ttc" id="a02280_html_a4e67f54563a3c4ff005dfaf0130f957c"><div class="ttname"><a href="a02280.html#a4e67f54563a3c4ff005dfaf0130f957c">HyPar::npoints_global</a></div><div class="ttdeci">int npoints_global</div><div class="ttdef"><b>Definition:</b> <a href="a00986_source.html#l00040">hypar.h:40</a></div></div>
<div class="ttc" id="a02280_html_a38e0371f331cecbe63a77fa03e202afe"><div class="ttname"><a href="a02280.html#a38e0371f331cecbe63a77fa03e202afe">HyPar::dim_local</a></div><div class="ttdeci">int * dim_local</div><div class="ttdef"><b>Definition:</b> <a href="a00986_source.html#l00037">hypar.h:37</a></div></div>
<div class="ttc" id="a02280_html_ae8f6d2fd6490d3153cb4133bf183a404"><div class="ttname"><a href="a02280.html#ae8f6d2fd6490d3153cb4133bf183a404">HyPar::nvars</a></div><div class="ttdeci">int nvars</div><div class="ttdef"><b>Definition:</b> <a href="a00986_source.html#l00029">hypar.h:29</a></div></div>
<div class="ttc" id="a02280_html_a20ee1fd00a220b98513127884a5558cf"><div class="ttname"><a href="a02280.html#a20ee1fd00a220b98513127884a5558cf">HyPar::npoints_local_wghosts</a></div><div class="ttdeci">int npoints_local_wghosts</div><div class="ttdef"><b>Definition:</b> <a href="a00986_source.html#l00042">hypar.h:42</a></div></div>
<div class="ttc" id="a02280_html_aafc992b5fa79d5a4036024615d03bce6"><div class="ttname"><a href="a02280.html#aafc992b5fa79d5a4036024615d03bce6">HyPar::ghosts</a></div><div class="ttdeci">int ghosts</div><div class="ttdef"><b>Definition:</b> <a href="a00986_source.html#l00052">hypar.h:52</a></div></div>
<div class="ttc" id="a01100_html_a23988a34071e1a0f0de820a4043a1fc8"><div class="ttname"><a href="a01100.html#a23988a34071e1a0f0de820a4043a1fc8">SimulationObject::is_barebones</a></div><div class="ttdeci">int is_barebones</div><div class="ttdef"><b>Definition:</b> <a href="a01100_source.html#l00027">simulation_object.h:27</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="afd984d88b028433d14fe3953937df374"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afd984d88b028433d14fe3953937df374">&#9670;&nbsp;</a></span>InitializeSolversBarebones()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int InitializeSolversBarebones </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="a01100.html#a02400">SimulationObject</a> *&#160;</td>
          <td class="paramname"><em>sim</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Initialize some function pointers for a "barebones" simulation object</p>
<p>This function initializes all some function pointers needed by a barebones simulation object. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">sim</td><td>simulation objects of type <a class="el" href="a01100.html#a02400" title="Structure defining a simulation. ">SimulationObject</a> </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="a02177_source.html#l00320">320</a> of file <a class="el" href="a02177_source.html">SparseGridsMiscFuncs.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;{</div><div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;  <span class="keywordflow">if</span> (sim-&gt;<a class="code" href="a01100.html#a23988a34071e1a0f0de820a4043a1fc8">is_barebones</a> != 1) {</div><div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;    fprintf(stderr, <span class="stringliteral">&quot;Error in SparseGridsSimulation::InitializeSolversBarebones() - \n&quot;</span>);</div><div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;    fprintf(stderr, <span class="stringliteral">&quot;  simulation object is not barebones type.\n&quot;</span>);</div><div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;  }</div><div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;</div><div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;  <span class="keywordtype">int</span> ns;</div><div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;</div><div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;  <a class="code" href="a02280.html">HyPar</a>        *solver   = &amp;(sim-&gt;<a class="code" href="a01100.html#a523947ce4fa7128c4c767163953253b9">solver</a>);</div><div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;  <a class="code" href="a01028.html#a02320">MPIVariables</a> *mpi      = &amp;(sim-&gt;<a class="code" href="a01100.html#a4afd2c7b3eb8fda452474ebdbe71c8c0">mpi</a>);</div><div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;</div><div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;  solver-&gt;<a class="code" href="a02280.html#ad607a144bb3dbf119fd52c47757212dd">ParabolicFunction</a>         = NULL;</div><div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;  solver-&gt;<a class="code" href="a02280.html#ad620f41c8df5d995ba6304fa21079103">SecondDerivativePar</a>       = NULL;</div><div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;  solver-&gt;<a class="code" href="a02280.html#a70476d05a40159f61242a8dae0526cc3">FirstDerivativePar</a>        = NULL;</div><div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;  solver-&gt;<a class="code" href="a02280.html#a5b70211377c8260e3f192934a72847df">InterpolateInterfacesPar</a>  = NULL;</div><div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;</div><div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;  solver-&gt;<a class="code" href="a02280.html#a29c46b81ad574e4dfbad5a7211487dcb">interp</a>                = NULL;</div><div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;  solver-&gt;<a class="code" href="a02280.html#a56318721d534e74a96b440f8542a0232">compact</a>               = NULL;</div><div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;  solver-&gt;<a class="code" href="a02280.html#a1dbfa1e479a373073b6ebf72401a7f0f">lusolver</a>              = NULL;</div><div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;  solver-&gt;<a class="code" href="a02280.html#a2d62ab02e21f9c436002b4a5ec3c973d">SetInterpLimiterVar</a>   = NULL;</div><div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;  solver-&gt;<a class="code" href="a02280.html#a9a61d44b50cc9043a19bdc3c0f591d99">flag_nonlinearinterp</a>  = 0;</div><div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;  solver-&gt;<a class="code" href="a02280.html#a1d36fea92472416e32e039b86dea0b18">time_integrator</a> = NULL;</div><div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;  solver-&gt;<a class="code" href="a02280.html#adec095311615891040de11341c01a77f">msti</a> = NULL;</div><div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;  </div><div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;  <span class="comment">/* Solution output function */</span></div><div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;  solver-&gt;<a class="code" href="a02280.html#a860eb760680191b057e06768287554be">WriteOutput</a>    = NULL; <span class="comment">/* default - no output */</span></div><div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;  solver-&gt;<a class="code" href="a02280.html#a0805db42e429173752189696c3c96909">filename_index</a> = NULL;</div><div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;  <span class="keywordflow">if</span> (!strcmp(solver-&gt;<a class="code" href="a02280.html#a5f89e286a9eaffdb66d966fa6a290d3f">output_mode</a>,<span class="stringliteral">&quot;serial&quot;</span>)) {</div><div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;    solver-&gt;<a class="code" href="a02280.html#af474ca4577de91b658e4399ad0a6d7b3">index_length</a> = 5;</div><div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;    solver-&gt;<a class="code" href="a02280.html#a0805db42e429173752189696c3c96909">filename_index</a> = (<span class="keywordtype">char</span>*) calloc (solver-&gt;<a class="code" href="a02280.html#af474ca4577de91b658e4399ad0a6d7b3">index_length</a>+1,<span class="keyword">sizeof</span>(<span class="keywordtype">char</span>));</div><div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;    <span class="keywordtype">int</span> i; <span class="keywordflow">for</span> (i=0; i&lt;solver-&gt;<a class="code" href="a02280.html#af474ca4577de91b658e4399ad0a6d7b3">index_length</a>; i++) solver-&gt;<a class="code" href="a02280.html#a0805db42e429173752189696c3c96909">filename_index</a>[i] = <span class="charliteral">&#39;0&#39;</span>;</div><div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;    solver-&gt;<a class="code" href="a02280.html#a0805db42e429173752189696c3c96909">filename_index</a>[solver-&gt;<a class="code" href="a02280.html#af474ca4577de91b658e4399ad0a6d7b3">index_length</a>] = (<span class="keywordtype">char</span>) 0;</div><div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;    <span class="keywordflow">if</span> (!strcmp(solver-&gt;<a class="code" href="a02280.html#a51a3b8c19b86e9e1df5be02b05a6613c">op_file_format</a>,<span class="stringliteral">&quot;text&quot;</span>)) {</div><div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;      solver-&gt;<a class="code" href="a02280.html#a860eb760680191b057e06768287554be">WriteOutput</a> = <a class="code" href="a00995.html#a3355a71faf3d87f6715ad627db08ac9e">WriteText</a>;</div><div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;      strcpy(solver-&gt;<a class="code" href="a02280.html#a25f6a0c8fded2ee6bd9593c737bc3a51">solnfilename_extn</a>,<span class="stringliteral">&quot;.dat&quot;</span>);</div><div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcmp(solver-&gt;<a class="code" href="a02280.html#a51a3b8c19b86e9e1df5be02b05a6613c">op_file_format</a>,<span class="stringliteral">&quot;tecplot2d&quot;</span>)) {</div><div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;      solver-&gt;<a class="code" href="a02280.html#a860eb760680191b057e06768287554be">WriteOutput</a> = <a class="code" href="a00995.html#a265b0583afb79edd2f2f5d5087e5c3bf">WriteTecplot2D</a>;</div><div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;      strcpy(solver-&gt;<a class="code" href="a02280.html#a25f6a0c8fded2ee6bd9593c737bc3a51">solnfilename_extn</a>,<span class="stringliteral">&quot;.dat&quot;</span>);</div><div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcmp(solver-&gt;<a class="code" href="a02280.html#a51a3b8c19b86e9e1df5be02b05a6613c">op_file_format</a>,<span class="stringliteral">&quot;tecplot3d&quot;</span>)) {</div><div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;      solver-&gt;<a class="code" href="a02280.html#a860eb760680191b057e06768287554be">WriteOutput</a> = <a class="code" href="a00995.html#a5bdb048ecc5ae7ab61622e4764f3133e">WriteTecplot3D</a>;</div><div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;      strcpy(solver-&gt;<a class="code" href="a02280.html#a25f6a0c8fded2ee6bd9593c737bc3a51">solnfilename_extn</a>,<span class="stringliteral">&quot;.dat&quot;</span>);</div><div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> ((!strcmp(solver-&gt;<a class="code" href="a02280.html#a51a3b8c19b86e9e1df5be02b05a6613c">op_file_format</a>,<span class="stringliteral">&quot;binary&quot;</span>)) || (!strcmp(solver-&gt;<a class="code" href="a02280.html#a51a3b8c19b86e9e1df5be02b05a6613c">op_file_format</a>,<span class="stringliteral">&quot;bin&quot;</span>))) {</div><div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;      solver-&gt;<a class="code" href="a02280.html#a860eb760680191b057e06768287554be">WriteOutput</a> = <a class="code" href="a00995.html#a067f454c26d85d6cfb4d7d878b3783c9">WriteBinary</a>;</div><div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;      strcpy(solver-&gt;<a class="code" href="a02280.html#a25f6a0c8fded2ee6bd9593c737bc3a51">solnfilename_extn</a>,<span class="stringliteral">&quot;.bin&quot;</span>);</div><div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcmp(solver-&gt;<a class="code" href="a02280.html#a51a3b8c19b86e9e1df5be02b05a6613c">op_file_format</a>,<span class="stringliteral">&quot;none&quot;</span>)) {</div><div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;      solver-&gt;<a class="code" href="a02280.html#a860eb760680191b057e06768287554be">WriteOutput</a> = NULL;</div><div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;    } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;      fprintf(stderr,<span class="stringliteral">&quot;Error (domain %d): %s is not a supported file format.\n&quot;</span>,</div><div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;              ns, solver-&gt;<a class="code" href="a02280.html#a51a3b8c19b86e9e1df5be02b05a6613c">op_file_format</a>);</div><div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;      <span class="keywordflow">return</span>(1);</div><div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;    }</div><div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;    <span class="keywordflow">if</span> ((!strcmp(solver-&gt;<a class="code" href="a02280.html#a4e93cb107e180ef982b74cef7726b70f">op_overwrite</a>,<span class="stringliteral">&quot;no&quot;</span>)) &amp;&amp; solver-&gt;<a class="code" href="a02280.html#aafb41b96563d9966e8e9f458751f2960">restart_iter</a>) {</div><div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;      <span class="comment">/* if it&#39;s a restart run, fast-forward the filename */</span></div><div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;      <span class="keywordtype">int</span> t;</div><div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;      <span class="keywordflow">for</span> (t=0; t&lt;solver-&gt;<a class="code" href="a02280.html#aafb41b96563d9966e8e9f458751f2960">restart_iter</a>; t++) </div><div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;        <span class="keywordflow">if</span> ((t+1)%solver-&gt;<a class="code" href="a02280.html#a6ff746b30ee55a3bbb9f3306c145f27a">file_op_iter</a> == 0) <a class="code" href="a02177.html#a55a796b622e90a00d1cb9164ab40c1c3">IncrementFilenameIndex</a>(solver-&gt;<a class="code" href="a02280.html#a0805db42e429173752189696c3c96909">filename_index</a>,solver-&gt;<a class="code" href="a02280.html#af474ca4577de91b658e4399ad0a6d7b3">index_length</a>);</div><div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;    }</div><div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;  } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcmp(solver-&gt;<a class="code" href="a02280.html#a5f89e286a9eaffdb66d966fa6a290d3f">output_mode</a>,<span class="stringliteral">&quot;parallel&quot;</span>)) {</div><div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;    <span class="keywordflow">if</span> (!strcmp(solver-&gt;<a class="code" href="a02280.html#a51a3b8c19b86e9e1df5be02b05a6613c">op_file_format</a>,<span class="stringliteral">&quot;none&quot;</span>)) solver-&gt;<a class="code" href="a02280.html#a860eb760680191b057e06768287554be">WriteOutput</a> = NULL;</div><div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;    <span class="keywordflow">else</span> {</div><div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;      <span class="comment">/* only binary file writing supported in parallel mode */</span></div><div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;      <span class="comment">/* use post-processing scripts to convert              */</span></div><div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;      solver-&gt;<a class="code" href="a02280.html#a860eb760680191b057e06768287554be">WriteOutput</a> = <a class="code" href="a00995.html#a067f454c26d85d6cfb4d7d878b3783c9">WriteBinary</a>;</div><div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;      strcpy(solver-&gt;<a class="code" href="a02280.html#a25f6a0c8fded2ee6bd9593c737bc3a51">solnfilename_extn</a>,<span class="stringliteral">&quot;.bin&quot;</span>);</div><div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;    }</div><div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;  } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;</div><div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;    fprintf(stderr,<span class="stringliteral">&quot;Error (domain %d): %s is not a supported output mode.\n&quot;</span>,</div><div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;            ns, solver-&gt;<a class="code" href="a02280.html#a5f89e286a9eaffdb66d966fa6a290d3f">output_mode</a>);</div><div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;    fprintf(stderr,<span class="stringliteral">&quot;Should be \&quot;serial\&quot; or \&quot;parallel\&quot;.    \n&quot;</span>);</div><div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;    <span class="keywordflow">return</span>(1);</div><div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;</div><div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;  }</div><div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;</div><div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;  <span class="keywordflow">return</span>(0);</div><div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;}</div><div class="ttc" id="a02280_html_a9a61d44b50cc9043a19bdc3c0f591d99"><div class="ttname"><a href="a02280.html#a9a61d44b50cc9043a19bdc3c0f591d99">HyPar::flag_nonlinearinterp</a></div><div class="ttdeci">int flag_nonlinearinterp</div><div class="ttdef"><b>Definition:</b> <a href="a00986_source.html#l00406">hypar.h:406</a></div></div>
<div class="ttc" id="a02280_html_a51a3b8c19b86e9e1df5be02b05a6613c"><div class="ttname"><a href="a02280.html#a51a3b8c19b86e9e1df5be02b05a6613c">HyPar::op_file_format</a></div><div class="ttdeci">char op_file_format[_MAX_STRING_SIZE_]</div><div class="ttdef"><b>Definition:</b> <a href="a00986_source.html#l00186">hypar.h:186</a></div></div>
<div class="ttc" id="a02280_html_a1d36fea92472416e32e039b86dea0b18"><div class="ttname"><a href="a02280.html#a1d36fea92472416e32e039b86dea0b18">HyPar::time_integrator</a></div><div class="ttdeci">void * time_integrator</div><div class="ttdef"><b>Definition:</b> <a href="a00986_source.html#l00165">hypar.h:165</a></div></div>
<div class="ttc" id="a02280_html"><div class="ttname"><a href="a02280.html">HyPar</a></div><div class="ttdoc">Structure containing all solver-specific variables and functions. </div><div class="ttdef"><b>Definition:</b> <a href="a00986_source.html#l00023">hypar.h:23</a></div></div>
<div class="ttc" id="a02280_html_a5b70211377c8260e3f192934a72847df"><div class="ttname"><a href="a02280.html#a5b70211377c8260e3f192934a72847df">HyPar::InterpolateInterfacesPar</a></div><div class="ttdeci">int(* InterpolateInterfacesPar)(double *, double *, int, void *, void *)</div><div class="ttdef"><b>Definition:</b> <a href="a00986_source.html#l00234">hypar.h:234</a></div></div>
<div class="ttc" id="a00995_html_a265b0583afb79edd2f2f5d5087e5c3bf"><div class="ttname"><a href="a00995.html#a265b0583afb79edd2f2f5d5087e5c3bf">WriteTecplot2D</a></div><div class="ttdeci">int WriteTecplot2D(int, int, int *, double *, double *, char *, int *)</div><div class="ttdef"><b>Definition:</b> <a href="a01427_source.html#l00019">WriteTecplot2D.c:19</a></div></div>
<div class="ttc" id="a02280_html_a860eb760680191b057e06768287554be"><div class="ttname"><a href="a02280.html#a860eb760680191b057e06768287554be">HyPar::WriteOutput</a></div><div class="ttdeci">int(* WriteOutput)(int, int, int *, double *, double *, char *, int *)</div><div class="ttdef"><b>Definition:</b> <a href="a00986_source.html#l00206">hypar.h:206</a></div></div>
<div class="ttc" id="a00995_html_a5bdb048ecc5ae7ab61622e4764f3133e"><div class="ttname"><a href="a00995.html#a5bdb048ecc5ae7ab61622e4764f3133e">WriteTecplot3D</a></div><div class="ttdeci">int WriteTecplot3D(int, int, int *, double *, double *, char *, int *)</div><div class="ttdef"><b>Definition:</b> <a href="a01430_source.html#l00019">WriteTecplot3D.c:19</a></div></div>
<div class="ttc" id="a02280_html_aafb41b96563d9966e8e9f458751f2960"><div class="ttname"><a href="a02280.html#aafb41b96563d9966e8e9f458751f2960">HyPar::restart_iter</a></div><div class="ttdeci">int restart_iter</div><div class="ttdef"><b>Definition:</b> <a href="a00986_source.html#l00058">hypar.h:58</a></div></div>
<div class="ttc" id="a02280_html_a6ff746b30ee55a3bbb9f3306c145f27a"><div class="ttname"><a href="a02280.html#a6ff746b30ee55a3bbb9f3306c145f27a">HyPar::file_op_iter</a></div><div class="ttdeci">int file_op_iter</div><div class="ttdef"><b>Definition:</b> <a href="a00986_source.html#l00171">hypar.h:171</a></div></div>
<div class="ttc" id="a01100_html_a523947ce4fa7128c4c767163953253b9"><div class="ttname"><a href="a01100.html#a523947ce4fa7128c4c767163953253b9">SimulationObject::solver</a></div><div class="ttdeci">HyPar solver</div><div class="ttdef"><b>Definition:</b> <a href="a01100_source.html#l00026">simulation_object.h:26</a></div></div>
<div class="ttc" id="a02280_html_ad620f41c8df5d995ba6304fa21079103"><div class="ttname"><a href="a02280.html#ad620f41c8df5d995ba6304fa21079103">HyPar::SecondDerivativePar</a></div><div class="ttdeci">int(* SecondDerivativePar)(double *, double *, int, void *, void *)</div><div class="ttdef"><b>Definition:</b> <a href="a00986_source.html#l00242">hypar.h:242</a></div></div>
<div class="ttc" id="a00995_html_a067f454c26d85d6cfb4d7d878b3783c9"><div class="ttname"><a href="a00995.html#a067f454c26d85d6cfb4d7d878b3783c9">WriteBinary</a></div><div class="ttdeci">int WriteBinary(int, int, int *, double *, double *, char *, int *)</div><div class="ttdef"><b>Definition:</b> <a href="a01424_source.html#l00034">WriteBinary.c:34</a></div></div>
<div class="ttc" id="a02280_html_a4e93cb107e180ef982b74cef7726b70f"><div class="ttname"><a href="a02280.html#a4e93cb107e180ef982b74cef7726b70f">HyPar::op_overwrite</a></div><div class="ttdeci">char op_overwrite[_MAX_STRING_SIZE_]</div><div class="ttdef"><b>Definition:</b> <a href="a00986_source.html#l00191">hypar.h:191</a></div></div>
<div class="ttc" id="a01028_html_a02320"><div class="ttname"><a href="a01028.html#a02320">MPIVariables</a></div><div class="ttdoc">Structure of MPI-related variables. </div><div class="ttdef"><b>Definition:</b> <a href="a01028_source.html#l00024">mpivars_struct.h:24</a></div></div>
<div class="ttc" id="a02280_html_a56318721d534e74a96b440f8542a0232"><div class="ttname"><a href="a02280.html#a56318721d534e74a96b440f8542a0232">HyPar::compact</a></div><div class="ttdeci">void * compact</div><div class="ttdef"><b>Definition:</b> <a href="a00986_source.html#l00359">hypar.h:359</a></div></div>
<div class="ttc" id="a02280_html_a29c46b81ad574e4dfbad5a7211487dcb"><div class="ttname"><a href="a02280.html#a29c46b81ad574e4dfbad5a7211487dcb">HyPar::interp</a></div><div class="ttdeci">void * interp</div><div class="ttdef"><b>Definition:</b> <a href="a00986_source.html#l00357">hypar.h:357</a></div></div>
<div class="ttc" id="a01100_html_a4afd2c7b3eb8fda452474ebdbe71c8c0"><div class="ttname"><a href="a01100.html#a4afd2c7b3eb8fda452474ebdbe71c8c0">SimulationObject::mpi</a></div><div class="ttdeci">MPIVariables mpi</div><div class="ttdef"><b>Definition:</b> <a href="a01100_source.html#l00025">simulation_object.h:25</a></div></div>
<div class="ttc" id="a02280_html_a1dbfa1e479a373073b6ebf72401a7f0f"><div class="ttname"><a href="a02280.html#a1dbfa1e479a373073b6ebf72401a7f0f">HyPar::lusolver</a></div><div class="ttdeci">void * lusolver</div><div class="ttdef"><b>Definition:</b> <a href="a00986_source.html#l00363">hypar.h:363</a></div></div>
<div class="ttc" id="a02280_html_adec095311615891040de11341c01a77f"><div class="ttname"><a href="a02280.html#adec095311615891040de11341c01a77f">HyPar::msti</a></div><div class="ttdeci">void * msti</div><div class="ttdef"><b>Definition:</b> <a href="a00986_source.html#l00361">hypar.h:361</a></div></div>
<div class="ttc" id="a02280_html_ad607a144bb3dbf119fd52c47757212dd"><div class="ttname"><a href="a02280.html#ad607a144bb3dbf119fd52c47757212dd">HyPar::ParabolicFunction</a></div><div class="ttdeci">int(* ParabolicFunction)(double *, double *, void *, void *, double)</div><div class="ttdef"><b>Definition:</b> <a href="a00986_source.html#l00251">hypar.h:251</a></div></div>
<div class="ttc" id="a02280_html_a25f6a0c8fded2ee6bd9593c737bc3a51"><div class="ttname"><a href="a02280.html#a25f6a0c8fded2ee6bd9593c737bc3a51">HyPar::solnfilename_extn</a></div><div class="ttdeci">char solnfilename_extn[_MAX_STRING_SIZE_]</div><div class="ttdef"><b>Definition:</b> <a href="a00986_source.html#l00198">hypar.h:198</a></div></div>
<div class="ttc" id="a02177_html_a55a796b622e90a00d1cb9164ab40c1c3"><div class="ttname"><a href="a02177.html#a55a796b622e90a00d1cb9164ab40c1c3">IncrementFilenameIndex</a></div><div class="ttdeci">void IncrementFilenameIndex(char *, int)</div><div class="ttdef"><b>Definition:</b> <a href="a01259_source.html#l00046">IncrementFilename.c:46</a></div></div>
<div class="ttc" id="a02280_html_a70476d05a40159f61242a8dae0526cc3"><div class="ttname"><a href="a02280.html#a70476d05a40159f61242a8dae0526cc3">HyPar::FirstDerivativePar</a></div><div class="ttdeci">int(* FirstDerivativePar)(double *, double *, int, int, void *, void *)</div><div class="ttdef"><b>Definition:</b> <a href="a00986_source.html#l00238">hypar.h:238</a></div></div>
<div class="ttc" id="a02280_html_a5f89e286a9eaffdb66d966fa6a290d3f"><div class="ttname"><a href="a02280.html#a5f89e286a9eaffdb66d966fa6a290d3f">HyPar::output_mode</a></div><div class="ttdeci">char output_mode[_MAX_STRING_SIZE_]</div><div class="ttdef"><b>Definition:</b> <a href="a00986_source.html#l00183">hypar.h:183</a></div></div>
<div class="ttc" id="a00995_html_a3355a71faf3d87f6715ad627db08ac9e"><div class="ttname"><a href="a00995.html#a3355a71faf3d87f6715ad627db08ac9e">WriteText</a></div><div class="ttdeci">int WriteText(int, int, int *, double *, double *, char *, int *)</div><div class="ttdef"><b>Definition:</b> <a href="a01433_source.html#l00027">WriteText.c:27</a></div></div>
<div class="ttc" id="a02280_html_af474ca4577de91b658e4399ad0a6d7b3"><div class="ttname"><a href="a02280.html#af474ca4577de91b658e4399ad0a6d7b3">HyPar::index_length</a></div><div class="ttdeci">int index_length</div><div class="ttdef"><b>Definition:</b> <a href="a00986_source.html#l00196">hypar.h:196</a></div></div>
<div class="ttc" id="a02280_html_a0805db42e429173752189696c3c96909"><div class="ttname"><a href="a02280.html#a0805db42e429173752189696c3c96909">HyPar::filename_index</a></div><div class="ttdeci">char * filename_index</div><div class="ttdef"><b>Definition:</b> <a href="a00986_source.html#l00194">hypar.h:194</a></div></div>
<div class="ttc" id="a02280_html_a2d62ab02e21f9c436002b4a5ec3c973d"><div class="ttname"><a href="a02280.html#a2d62ab02e21f9c436002b4a5ec3c973d">HyPar::SetInterpLimiterVar</a></div><div class="ttdeci">int(* SetInterpLimiterVar)(double *, double *, double *, int, void *, void *)</div><div class="ttdef"><b>Definition:</b> <a href="a00986_source.html#l00229">hypar.h:229</a></div></div>
<div class="ttc" id="a01100_html_a23988a34071e1a0f0de820a4043a1fc8"><div class="ttname"><a href="a01100.html#a23988a34071e1a0f0de820a4043a1fc8">SimulationObject::is_barebones</a></div><div class="ttdeci">int is_barebones</div><div class="ttdef"><b>Definition:</b> <a href="a01100_source.html#l00027">simulation_object.h:27</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a562d4c4cc409a40b1bed1c82fc6ec0b9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a562d4c4cc409a40b1bed1c82fc6ec0b9">&#9670;&nbsp;</a></span>CleanupBarebones()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int CleanupBarebones </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="a01100.html#a02400">SimulationObject</a> *&#160;</td>
          <td class="paramname"><em>sim</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Cleanup (deallocate) a "barebones" simulation object</p>
<p>Cleanup (deallocation) function for a barebones simulation object that has been allocated using <a class="el" href="a02408.html#a02a78692b8cc62fbfb25bcdb20a9a590">SparseGridsSimulation::InitializeBarebones()</a>. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">sim</td><td>simulation objects of type <a class="el" href="a01100.html#a02400" title="Structure defining a simulation. ">SimulationObject</a> </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="a02177_source.html#l00142">142</a> of file <a class="el" href="a02177_source.html">SparseGridsMiscFuncs.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;{</div><div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;  <span class="keywordflow">if</span> (sim-&gt;<a class="code" href="a01100.html#a23988a34071e1a0f0de820a4043a1fc8">is_barebones</a> == 0) {</div><div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;    fprintf(stderr, <span class="stringliteral">&quot;Error in SparseGridsSimulation::CleanupBarebones()\n&quot;</span>);</div><div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;    fprintf(stderr, <span class="stringliteral">&quot;  Simulation object is not a barebones one.\n&quot;</span>);</div><div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;    <span class="keywordflow">return</span> 1;</div><div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;  }</div><div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;</div><div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;  <a class="code" href="a02280.html">HyPar</a>* solver = &amp;(sim-&gt;<a class="code" href="a01100.html#a523947ce4fa7128c4c767163953253b9">solver</a>);</div><div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;  <a class="code" href="a01028.html#a02320">MPIVariables</a>* mpi = &amp;(sim-&gt;<a class="code" href="a01100.html#a4afd2c7b3eb8fda452474ebdbe71c8c0">mpi</a>);</div><div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;</div><div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;  <span class="comment">/* Free the communicators created */</span></div><div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;  <a class="code" href="a00965.html#ad6ab74942c9de13cf0b4c12eb0d91780">IERR</a> <a class="code" href="a01022.html#af59eb9eb78e6e99df5630429e5383617">MPIFreeCommunicators</a>(solver-&gt;<a class="code" href="a02280.html#a484873c74138512e41bc50d17b7d955a">ndims</a>,mpi); <a class="code" href="a00965.html#add9cf96ae374934d245a1dc1ab697a42">CHECKERR</a>(ierr);</div><div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;</div><div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;  <span class="comment">/* These variables are allocated in Initialize.c */</span></div><div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;  free(solver-&gt;<a class="code" href="a02280.html#aa989ebb755986852177779cdf7bd8c85">dim_global</a>);</div><div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;  free(solver-&gt;<a class="code" href="a02280.html#a9a4a95bad0d4f4769e5e3cd8798a158a">dim_global_ex</a>);</div><div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;  free(solver-&gt;<a class="code" href="a02280.html#a38e0371f331cecbe63a77fa03e202afe">dim_local</a>);</div><div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;  free(solver-&gt;<a class="code" href="a02280.html#a95e9e0f8a692321b83a2e0ce2789c485">index</a>);</div><div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;  free(solver-&gt;<a class="code" href="a02280.html#a40e3f67b1530d5ea4e913fc60b594802">isPeriodic</a>);</div><div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;  free(solver-&gt;<a class="code" href="a02280.html#a3b6b999a764f1e2ea94bb5f28c7a558c">u</a>);</div><div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;  free(solver-&gt;<a class="code" href="a02280.html#a711aad4cbe735871dd9e91ab575c878b">x</a>);</div><div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;  free(solver-&gt;<a class="code" href="a02280.html#aa24a4f5e29bd70cbe5a2413be1ea9682">dxinv</a>);</div><div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;  free(mpi-&gt;<a class="code" href="a01028.html#a0be0f30a83bc3f3d9f6ee3a36bbf2716">iproc</a>);</div><div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;  free(mpi-&gt;<a class="code" href="a01028.html#aa3c28612a64b8a97bde66b720e15c700">ip</a>);</div><div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;  free(mpi-&gt;<a class="code" href="a01028.html#a481013ba007a99a4237cde5eeb3c9a29">is</a>);</div><div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;  free(mpi-&gt;<a class="code" href="a01028.html#a7602de5ebb1b59ec35217e78a35a531e">ie</a>);</div><div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;  free(mpi-&gt;<a class="code" href="a01028.html#af40a5a3066fdb53a47e4627071abc2bc">bcperiodic</a>);</div><div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;  free(mpi-&gt;<a class="code" href="a01028.html#aba3b15034da676474db917f9f5533085">sendbuf</a>);</div><div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;  free(mpi-&gt;<a class="code" href="a01028.html#afc23e46e08649e112e8d64d780cea5cb">recvbuf</a>);</div><div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;  free(solver-&gt;<a class="code" href="a02280.html#a57f7bff1d8bf27f2ca5c00270da00d05">VolumeIntegral</a>);</div><div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;  free(solver-&gt;<a class="code" href="a02280.html#a3aec36aeb5caac1e87f5b4f5f75d5a23">VolumeIntegralInitial</a>);</div><div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;  free(solver-&gt;<a class="code" href="a02280.html#a644ed0ed36ed4af1c396c0af6aca043d">TotalBoundaryIntegral</a>);</div><div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;  free(solver-&gt;<a class="code" href="a02280.html#a965363cd64ce50ae17705dfb285dd0ab">ConservationError</a>);</div><div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;  free(solver-&gt;<a class="code" href="a02280.html#a39dc7def53a36bdc722aa90f52e04561">stride_with_ghosts</a>);</div><div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;  free(solver-&gt;<a class="code" href="a02280.html#a98bbff775d127bdd2451b55ce3d06e06">stride_without_ghosts</a>);</div><div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;  <span class="keywordflow">if</span> (solver-&gt;<a class="code" href="a02280.html#a0805db42e429173752189696c3c96909">filename_index</a>) free(solver-&gt;<a class="code" href="a02280.html#a0805db42e429173752189696c3c96909">filename_index</a>);</div><div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;</div><div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;  <span class="keywordflow">return</span>(0);</div><div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;}</div><div class="ttc" id="a02280_html_a484873c74138512e41bc50d17b7d955a"><div class="ttname"><a href="a02280.html#a484873c74138512e41bc50d17b7d955a">HyPar::ndims</a></div><div class="ttdeci">int ndims</div><div class="ttdef"><b>Definition:</b> <a href="a00986_source.html#l00026">hypar.h:26</a></div></div>
<div class="ttc" id="a02280_html"><div class="ttname"><a href="a02280.html">HyPar</a></div><div class="ttdoc">Structure containing all solver-specific variables and functions. </div><div class="ttdef"><b>Definition:</b> <a href="a00986_source.html#l00023">hypar.h:23</a></div></div>
<div class="ttc" id="a01028_html_aba3b15034da676474db917f9f5533085"><div class="ttname"><a href="a01028.html#aba3b15034da676474db917f9f5533085">MPIVariables::sendbuf</a></div><div class="ttdeci">double * sendbuf</div><div class="ttdef"><b>Definition:</b> <a href="a01028_source.html#l00051">mpivars_struct.h:51</a></div></div>
<div class="ttc" id="a00965_html_add9cf96ae374934d245a1dc1ab697a42"><div class="ttname"><a href="a00965.html#add9cf96ae374934d245a1dc1ab697a42">CHECKERR</a></div><div class="ttdeci">#define CHECKERR(ierr)</div><div class="ttdef"><b>Definition:</b> <a href="a00965_source.html#l00018">basic.h:18</a></div></div>
<div class="ttc" id="a02280_html_a965363cd64ce50ae17705dfb285dd0ab"><div class="ttname"><a href="a02280.html#a965363cd64ce50ae17705dfb285dd0ab">HyPar::ConservationError</a></div><div class="ttdeci">double * ConservationError</div><div class="ttdef"><b>Definition:</b> <a href="a00986_source.html#l00369">hypar.h:369</a></div></div>
<div class="ttc" id="a02280_html_a3b6b999a764f1e2ea94bb5f28c7a558c"><div class="ttname"><a href="a02280.html#a3b6b999a764f1e2ea94bb5f28c7a558c">HyPar::u</a></div><div class="ttdeci">double * u</div><div class="ttdef"><b>Definition:</b> <a href="a00986_source.html#l00116">hypar.h:116</a></div></div>
<div class="ttc" id="a02280_html_aa989ebb755986852177779cdf7bd8c85"><div class="ttname"><a href="a02280.html#aa989ebb755986852177779cdf7bd8c85">HyPar::dim_global</a></div><div class="ttdeci">int * dim_global</div><div class="ttdef"><b>Definition:</b> <a href="a00986_source.html#l00033">hypar.h:33</a></div></div>
<div class="ttc" id="a01028_html_a0be0f30a83bc3f3d9f6ee3a36bbf2716"><div class="ttname"><a href="a01028.html#a0be0f30a83bc3f3d9f6ee3a36bbf2716">MPIVariables::iproc</a></div><div class="ttdeci">int * iproc</div><div class="ttdef"><b>Definition:</b> <a href="a01028_source.html#l00027">mpivars_struct.h:27</a></div></div>
<div class="ttc" id="a01100_html_a523947ce4fa7128c4c767163953253b9"><div class="ttname"><a href="a01100.html#a523947ce4fa7128c4c767163953253b9">SimulationObject::solver</a></div><div class="ttdeci">HyPar solver</div><div class="ttdef"><b>Definition:</b> <a href="a01100_source.html#l00026">simulation_object.h:26</a></div></div>
<div class="ttc" id="a02280_html_a644ed0ed36ed4af1c396c0af6aca043d"><div class="ttname"><a href="a02280.html#a644ed0ed36ed4af1c396c0af6aca043d">HyPar::TotalBoundaryIntegral</a></div><div class="ttdeci">double * TotalBoundaryIntegral</div><div class="ttdef"><b>Definition:</b> <a href="a00986_source.html#l00381">hypar.h:381</a></div></div>
<div class="ttc" id="a02280_html_a57f7bff1d8bf27f2ca5c00270da00d05"><div class="ttname"><a href="a02280.html#a57f7bff1d8bf27f2ca5c00270da00d05">HyPar::VolumeIntegral</a></div><div class="ttdeci">double * VolumeIntegral</div><div class="ttdef"><b>Definition:</b> <a href="a00986_source.html#l00373">hypar.h:373</a></div></div>
<div class="ttc" id="a01028_html_af40a5a3066fdb53a47e4627071abc2bc"><div class="ttname"><a href="a01028.html#af40a5a3066fdb53a47e4627071abc2bc">MPIVariables::bcperiodic</a></div><div class="ttdeci">int * bcperiodic</div><div class="ttdef"><b>Definition:</b> <a href="a01028_source.html#l00031">mpivars_struct.h:31</a></div></div>
<div class="ttc" id="a02280_html_aa24a4f5e29bd70cbe5a2413be1ea9682"><div class="ttname"><a href="a02280.html#aa24a4f5e29bd70cbe5a2413be1ea9682">HyPar::dxinv</a></div><div class="ttdeci">double * dxinv</div><div class="ttdef"><b>Definition:</b> <a href="a00986_source.html#l00110">hypar.h:110</a></div></div>
<div class="ttc" id="a01028_html_aa3c28612a64b8a97bde66b720e15c700"><div class="ttname"><a href="a01028.html#aa3c28612a64b8a97bde66b720e15c700">MPIVariables::ip</a></div><div class="ttdeci">int * ip</div><div class="ttdef"><b>Definition:</b> <a href="a01028_source.html#l00028">mpivars_struct.h:28</a></div></div>
<div class="ttc" id="a01028_html_a02320"><div class="ttname"><a href="a01028.html#a02320">MPIVariables</a></div><div class="ttdoc">Structure of MPI-related variables. </div><div class="ttdef"><b>Definition:</b> <a href="a01028_source.html#l00024">mpivars_struct.h:24</a></div></div>
<div class="ttc" id="a01100_html_a4afd2c7b3eb8fda452474ebdbe71c8c0"><div class="ttname"><a href="a01100.html#a4afd2c7b3eb8fda452474ebdbe71c8c0">SimulationObject::mpi</a></div><div class="ttdeci">MPIVariables mpi</div><div class="ttdef"><b>Definition:</b> <a href="a01100_source.html#l00025">simulation_object.h:25</a></div></div>
<div class="ttc" id="a02280_html_a40e3f67b1530d5ea4e913fc60b594802"><div class="ttname"><a href="a02280.html#a40e3f67b1530d5ea4e913fc60b594802">HyPar::isPeriodic</a></div><div class="ttdeci">int * isPeriodic</div><div class="ttdef"><b>Definition:</b> <a href="a00986_source.html#l00162">hypar.h:162</a></div></div>
<div class="ttc" id="a01028_html_afc23e46e08649e112e8d64d780cea5cb"><div class="ttname"><a href="a01028.html#afc23e46e08649e112e8d64d780cea5cb">MPIVariables::recvbuf</a></div><div class="ttdeci">double * recvbuf</div><div class="ttdef"><b>Definition:</b> <a href="a01028_source.html#l00051">mpivars_struct.h:51</a></div></div>
<div class="ttc" id="a01028_html_a481013ba007a99a4237cde5eeb3c9a29"><div class="ttname"><a href="a01028.html#a481013ba007a99a4237cde5eeb3c9a29">MPIVariables::is</a></div><div class="ttdeci">int * is</div><div class="ttdef"><b>Definition:</b> <a href="a01028_source.html#l00029">mpivars_struct.h:29</a></div></div>
<div class="ttc" id="a02280_html_a9a4a95bad0d4f4769e5e3cd8798a158a"><div class="ttname"><a href="a02280.html#a9a4a95bad0d4f4769e5e3cd8798a158a">HyPar::dim_global_ex</a></div><div class="ttdeci">int * dim_global_ex</div><div class="ttdef"><b>Definition:</b> <a href="a00986_source.html#l00075">hypar.h:75</a></div></div>
<div class="ttc" id="a00965_html_ad6ab74942c9de13cf0b4c12eb0d91780"><div class="ttname"><a href="a00965.html#ad6ab74942c9de13cf0b4c12eb0d91780">IERR</a></div><div class="ttdeci">#define IERR</div><div class="ttdef"><b>Definition:</b> <a href="a00965_source.html#l00016">basic.h:16</a></div></div>
<div class="ttc" id="a01022_html_af59eb9eb78e6e99df5630429e5383617"><div class="ttname"><a href="a01022.html#af59eb9eb78e6e99df5630429e5383617">MPIFreeCommunicators</a></div><div class="ttdeci">int MPIFreeCommunicators(int, void *)</div><div class="ttdef"><b>Definition:</b> <a href="a01466_source.html#l00075">MPICommunicators.c:75</a></div></div>
<div class="ttc" id="a02280_html_a39dc7def53a36bdc722aa90f52e04561"><div class="ttname"><a href="a02280.html#a39dc7def53a36bdc722aa90f52e04561">HyPar::stride_with_ghosts</a></div><div class="ttdeci">int * stride_with_ghosts</div><div class="ttdef"><b>Definition:</b> <a href="a00986_source.html#l00409">hypar.h:409</a></div></div>
<div class="ttc" id="a02280_html_a711aad4cbe735871dd9e91ab575c878b"><div class="ttname"><a href="a02280.html#a711aad4cbe735871dd9e91ab575c878b">HyPar::x</a></div><div class="ttdeci">double * x</div><div class="ttdef"><b>Definition:</b> <a href="a00986_source.html#l00107">hypar.h:107</a></div></div>
<div class="ttc" id="a02280_html_a98bbff775d127bdd2451b55ce3d06e06"><div class="ttname"><a href="a02280.html#a98bbff775d127bdd2451b55ce3d06e06">HyPar::stride_without_ghosts</a></div><div class="ttdeci">int * stride_without_ghosts</div><div class="ttdef"><b>Definition:</b> <a href="a00986_source.html#l00411">hypar.h:411</a></div></div>
<div class="ttc" id="a01028_html_a7602de5ebb1b59ec35217e78a35a531e"><div class="ttname"><a href="a01028.html#a7602de5ebb1b59ec35217e78a35a531e">MPIVariables::ie</a></div><div class="ttdeci">int * ie</div><div class="ttdef"><b>Definition:</b> <a href="a01028_source.html#l00029">mpivars_struct.h:29</a></div></div>
<div class="ttc" id="a02280_html_a95e9e0f8a692321b83a2e0ce2789c485"><div class="ttname"><a href="a02280.html#a95e9e0f8a692321b83a2e0ce2789c485">HyPar::index</a></div><div class="ttdeci">int * index</div><div class="ttdef"><b>Definition:</b> <a href="a00986_source.html#l00102">hypar.h:102</a></div></div>
<div class="ttc" id="a02280_html_a3aec36aeb5caac1e87f5b4f5f75d5a23"><div class="ttname"><a href="a02280.html#a3aec36aeb5caac1e87f5b4f5f75d5a23">HyPar::VolumeIntegralInitial</a></div><div class="ttdeci">double * VolumeIntegralInitial</div><div class="ttdef"><b>Definition:</b> <a href="a00986_source.html#l00375">hypar.h:375</a></div></div>
<div class="ttc" id="a02280_html_a0805db42e429173752189696c3c96909"><div class="ttname"><a href="a02280.html#a0805db42e429173752189696c3c96909">HyPar::filename_index</a></div><div class="ttdeci">char * filename_index</div><div class="ttdef"><b>Definition:</b> <a href="a00986_source.html#l00194">hypar.h:194</a></div></div>
<div class="ttc" id="a02280_html_a38e0371f331cecbe63a77fa03e202afe"><div class="ttname"><a href="a02280.html#a38e0371f331cecbe63a77fa03e202afe">HyPar::dim_local</a></div><div class="ttdeci">int * dim_local</div><div class="ttdef"><b>Definition:</b> <a href="a00986_source.html#l00037">hypar.h:37</a></div></div>
<div class="ttc" id="a01100_html_a23988a34071e1a0f0de820a4043a1fc8"><div class="ttname"><a href="a01100.html#a23988a34071e1a0f0de820a4043a1fc8">SimulationObject::is_barebones</a></div><div class="ttdeci">int is_barebones</div><div class="ttdef"><b>Definition:</b> <a href="a01100_source.html#l00027">simulation_object.h:27</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="abc369c6ea10a947feae5c3f365670d6e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abc369c6ea10a947feae5c3f365670d6e">&#9670;&nbsp;</a></span>SetSolverParameters()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int SetSolverParameters </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="a01100.html#a02400">SimulationObject</a> &amp;&#160;</td>
          <td class="paramname"><em>a_dst_sim</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="a01106.html#a00167df288a1ca2c6c32af8d911975e0">GridDimensions</a> &amp;&#160;</td>
          <td class="paramname"><em>a_dim_global</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="a01106.html#a4e1436c018a5aad717fb73ca9004bcfc">ProcDistribution</a> &amp;&#160;</td>
          <td class="paramname"><em>a_iproc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="a01100.html#a02400">SimulationObject</a> &amp;&#160;</td>
          <td class="paramname"><em>a_src_sim</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>a_idx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>a_nsims</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Set solver parameters for a simulation object</p>
<p>Set the solver parameters (stuff that is usually read in from solver.inp) for a simulation object, where the global grid sizes and processor distribution are specified, and all other parameters are same as a source simulation object </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">a_dst_sim</td><td><a class="el" href="a02396.html" title="Base class for a simulation. ">Simulation</a> object </td></tr>
    <tr><td class="paramname">a_dim_global</td><td>Specified global grid sizes </td></tr>
    <tr><td class="paramname">a_iproc</td><td>Specified processor distibution </td></tr>
    <tr><td class="paramname">a_src_sim</td><td>Source simulation object </td></tr>
    <tr><td class="paramname">a_idx</td><td>Index or serial number </td></tr>
    <tr><td class="paramname">a_nsims</td><td>Total number of simulations </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="a02186_source.html#l00011">11</a> of file <a class="el" href="a02186_source.html">SparseGridsSetSolverParameters.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;{</div><div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;  a_dst_sim.<a class="code" href="a01100.html#a523947ce4fa7128c4c767163953253b9">solver</a>.<a class="code" href="a02280.html#a34488172a8ec6e0aaa03cbea46092d3a">my_idx</a> = a_idx;</div><div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;  a_dst_sim.<a class="code" href="a01100.html#a523947ce4fa7128c4c767163953253b9">solver</a>.<a class="code" href="a02280.html#a9a0e87291e0e8b9c1445e5482e814c92">nsims</a> = a_nsims;</div><div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;</div><div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;  a_dst_sim.<a class="code" href="a01100.html#a4afd2c7b3eb8fda452474ebdbe71c8c0">mpi</a>.<a class="code" href="a01028.html#a6cfd95afd0afebd625b889fb6e58371c">rank</a> = <a class="code" href="a02408.html#ac6a822dc76382e4027cf94ac3e510056">m_rank</a>;</div><div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;  a_dst_sim.<a class="code" href="a01100.html#a4afd2c7b3eb8fda452474ebdbe71c8c0">mpi</a>.<a class="code" href="a01028.html#ae68326adc3b3862f1162832f70727b06">nproc</a> = <a class="code" href="a02408.html#ae5bbe5daa629a4f92b569cb632256780">m_nproc</a>;</div><div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;</div><div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;  a_dst_sim.<a class="code" href="a01100.html#a523947ce4fa7128c4c767163953253b9">solver</a>.<a class="code" href="a02280.html#a484873c74138512e41bc50d17b7d955a">ndims</a> = a_src_sim.<a class="code" href="a01100.html#a523947ce4fa7128c4c767163953253b9">solver</a>.<a class="code" href="a02280.html#a484873c74138512e41bc50d17b7d955a">ndims</a>;</div><div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;  a_dst_sim.<a class="code" href="a01100.html#a523947ce4fa7128c4c767163953253b9">solver</a>.<a class="code" href="a02280.html#ae8f6d2fd6490d3153cb4133bf183a404">nvars</a> = a_src_sim.<a class="code" href="a01100.html#a523947ce4fa7128c4c767163953253b9">solver</a>.<a class="code" href="a02280.html#ae8f6d2fd6490d3153cb4133bf183a404">nvars</a>;</div><div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;  a_dst_sim.<a class="code" href="a01100.html#a523947ce4fa7128c4c767163953253b9">solver</a>.<a class="code" href="a02280.html#aafc992b5fa79d5a4036024615d03bce6">ghosts</a> = a_src_sim.<a class="code" href="a01100.html#a523947ce4fa7128c4c767163953253b9">solver</a>.<a class="code" href="a02280.html#aafc992b5fa79d5a4036024615d03bce6">ghosts</a>;</div><div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;</div><div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;  a_dst_sim.<a class="code" href="a01100.html#a523947ce4fa7128c4c767163953253b9">solver</a>.<a class="code" href="a02280.html#aa989ebb755986852177779cdf7bd8c85">dim_global</a> = (<span class="keywordtype">int</span>*) calloc (a_dst_sim.<a class="code" href="a01100.html#a523947ce4fa7128c4c767163953253b9">solver</a>.<a class="code" href="a02280.html#a484873c74138512e41bc50d17b7d955a">ndims</a>,<span class="keyword">sizeof</span>(<span class="keywordtype">int</span>));</div><div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;  a_dst_sim.<a class="code" href="a01100.html#a4afd2c7b3eb8fda452474ebdbe71c8c0">mpi</a>.<a class="code" href="a01028.html#a0be0f30a83bc3f3d9f6ee3a36bbf2716">iproc</a>         = (<span class="keywordtype">int</span>*) calloc (a_dst_sim.<a class="code" href="a01100.html#a523947ce4fa7128c4c767163953253b9">solver</a>.<a class="code" href="a02280.html#a484873c74138512e41bc50d17b7d955a">ndims</a>,<span class="keyword">sizeof</span>(<span class="keywordtype">int</span>));</div><div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> d = 0; d &lt; a_dst_sim.<a class="code" href="a01100.html#a523947ce4fa7128c4c767163953253b9">solver</a>.<a class="code" href="a02280.html#a484873c74138512e41bc50d17b7d955a">ndims</a>; d++) {</div><div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;    a_dst_sim.<a class="code" href="a01100.html#a523947ce4fa7128c4c767163953253b9">solver</a>.<a class="code" href="a02280.html#aa989ebb755986852177779cdf7bd8c85">dim_global</a>[d] = a_dim_global[d];</div><div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;    a_dst_sim.<a class="code" href="a01100.html#a4afd2c7b3eb8fda452474ebdbe71c8c0">mpi</a>.<a class="code" href="a01028.html#a0be0f30a83bc3f3d9f6ee3a36bbf2716">iproc</a>[d] = a_iproc[d];</div><div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;  }</div><div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;</div><div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;  a_dst_sim.<a class="code" href="a01100.html#a523947ce4fa7128c4c767163953253b9">solver</a>.<a class="code" href="a02280.html#af0d8e0d5d3de3869b941b66b6caaf964">n_iter</a>       = a_src_sim.<a class="code" href="a01100.html#a523947ce4fa7128c4c767163953253b9">solver</a>.<a class="code" href="a02280.html#af0d8e0d5d3de3869b941b66b6caaf964">n_iter</a>;</div><div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;  a_dst_sim.<a class="code" href="a01100.html#a523947ce4fa7128c4c767163953253b9">solver</a>.<a class="code" href="a02280.html#aafb41b96563d9966e8e9f458751f2960">restart_iter</a> = a_src_sim.<a class="code" href="a01100.html#a523947ce4fa7128c4c767163953253b9">solver</a>.<a class="code" href="a02280.html#aafb41b96563d9966e8e9f458751f2960">restart_iter</a>;</div><div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;</div><div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;  strcpy(a_dst_sim.<a class="code" href="a01100.html#a523947ce4fa7128c4c767163953253b9">solver</a>.<a class="code" href="a02280.html#a138e751362d14724df8e6ab27c4a5e55">time_scheme</a>, a_src_sim.<a class="code" href="a01100.html#a523947ce4fa7128c4c767163953253b9">solver</a>.<a class="code" href="a02280.html#a138e751362d14724df8e6ab27c4a5e55">time_scheme</a>);</div><div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;  strcpy(a_dst_sim.<a class="code" href="a01100.html#a523947ce4fa7128c4c767163953253b9">solver</a>.<a class="code" href="a02280.html#a61750696383420ba8bcc7d9e44a538e2">time_scheme_type</a>, a_src_sim.<a class="code" href="a01100.html#a523947ce4fa7128c4c767163953253b9">solver</a>.<a class="code" href="a02280.html#a61750696383420ba8bcc7d9e44a538e2">time_scheme_type</a>);</div><div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;  strcpy(a_dst_sim.<a class="code" href="a01100.html#a523947ce4fa7128c4c767163953253b9">solver</a>.<a class="code" href="a02280.html#ad29846eeb9c83b329a8d7c1fe69d46b2">spatial_scheme_hyp</a>, a_src_sim.<a class="code" href="a01100.html#a523947ce4fa7128c4c767163953253b9">solver</a>.<a class="code" href="a02280.html#ad29846eeb9c83b329a8d7c1fe69d46b2">spatial_scheme_hyp</a>);</div><div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;  strcpy(a_dst_sim.<a class="code" href="a01100.html#a523947ce4fa7128c4c767163953253b9">solver</a>.<a class="code" href="a02280.html#a5bed0cb9665daad89f4377c4f7609df4">SplitHyperbolicFlux</a>, a_src_sim.<a class="code" href="a01100.html#a523947ce4fa7128c4c767163953253b9">solver</a>.<a class="code" href="a02280.html#a5bed0cb9665daad89f4377c4f7609df4">SplitHyperbolicFlux</a>);</div><div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;  strcpy(a_dst_sim.<a class="code" href="a01100.html#a523947ce4fa7128c4c767163953253b9">solver</a>.<a class="code" href="a02280.html#a9591ba0fadb863561474e2ba251d2594">interp_type</a>, a_src_sim.<a class="code" href="a01100.html#a523947ce4fa7128c4c767163953253b9">solver</a>.<a class="code" href="a02280.html#a9591ba0fadb863561474e2ba251d2594">interp_type</a>);</div><div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;  strcpy(a_dst_sim.<a class="code" href="a01100.html#a523947ce4fa7128c4c767163953253b9">solver</a>.<a class="code" href="a02280.html#ad45d57b33d578bf602574a221bf53d93">spatial_type_par</a>, a_src_sim.<a class="code" href="a01100.html#a523947ce4fa7128c4c767163953253b9">solver</a>.<a class="code" href="a02280.html#ad45d57b33d578bf602574a221bf53d93">spatial_type_par</a>);</div><div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;  strcpy(a_dst_sim.<a class="code" href="a01100.html#a523947ce4fa7128c4c767163953253b9">solver</a>.<a class="code" href="a02280.html#a170f2f6cc8ac86b78fcb376c2392e290">spatial_scheme_par</a>, a_src_sim.<a class="code" href="a01100.html#a523947ce4fa7128c4c767163953253b9">solver</a>.<a class="code" href="a02280.html#a170f2f6cc8ac86b78fcb376c2392e290">spatial_scheme_par</a>);</div><div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;</div><div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;  a_dst_sim.<a class="code" href="a01100.html#a523947ce4fa7128c4c767163953253b9">solver</a>.<a class="code" href="a02280.html#a03e28be41881b703c836edbfe9b51b17">dt</a> = a_src_sim.<a class="code" href="a01100.html#a523947ce4fa7128c4c767163953253b9">solver</a>.<a class="code" href="a02280.html#a03e28be41881b703c836edbfe9b51b17">dt</a>;</div><div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;</div><div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;  strcpy(a_dst_sim.<a class="code" href="a01100.html#a523947ce4fa7128c4c767163953253b9">solver</a>.<a class="code" href="a02280.html#ac92c34fe456d92c694eacd2231f5a7b1">ConservationCheck</a>, a_src_sim.<a class="code" href="a01100.html#a523947ce4fa7128c4c767163953253b9">solver</a>.<a class="code" href="a02280.html#ac92c34fe456d92c694eacd2231f5a7b1">ConservationCheck</a>);</div><div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;</div><div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;  a_dst_sim.<a class="code" href="a01100.html#a523947ce4fa7128c4c767163953253b9">solver</a>.<a class="code" href="a02280.html#a74ff7fa96cbfc4ee87f508f964e94409">screen_op_iter</a> = a_src_sim.<a class="code" href="a01100.html#a523947ce4fa7128c4c767163953253b9">solver</a>.<a class="code" href="a02280.html#a74ff7fa96cbfc4ee87f508f964e94409">screen_op_iter</a>;</div><div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;  a_dst_sim.<a class="code" href="a01100.html#a523947ce4fa7128c4c767163953253b9">solver</a>.<a class="code" href="a02280.html#a6ff746b30ee55a3bbb9f3306c145f27a">file_op_iter</a> = a_src_sim.<a class="code" href="a01100.html#a523947ce4fa7128c4c767163953253b9">solver</a>.<a class="code" href="a02280.html#a6ff746b30ee55a3bbb9f3306c145f27a">file_op_iter</a>;</div><div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;</div><div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;  strcpy(a_dst_sim.<a class="code" href="a01100.html#a523947ce4fa7128c4c767163953253b9">solver</a>.<a class="code" href="a02280.html#a51a3b8c19b86e9e1df5be02b05a6613c">op_file_format</a>, a_src_sim.<a class="code" href="a01100.html#a523947ce4fa7128c4c767163953253b9">solver</a>.<a class="code" href="a02280.html#a51a3b8c19b86e9e1df5be02b05a6613c">op_file_format</a>);</div><div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;  strcpy(a_dst_sim.<a class="code" href="a01100.html#a523947ce4fa7128c4c767163953253b9">solver</a>.<a class="code" href="a02280.html#a83f3dcd022f744511a44f2a31a824ac8">ip_file_type</a>, a_src_sim.<a class="code" href="a01100.html#a523947ce4fa7128c4c767163953253b9">solver</a>.<a class="code" href="a02280.html#a83f3dcd022f744511a44f2a31a824ac8">ip_file_type</a>);</div><div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;</div><div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;  strcpy(a_dst_sim.<a class="code" href="a01100.html#a523947ce4fa7128c4c767163953253b9">solver</a>.<a class="code" href="a02280.html#a0a0b9dc97c7c278a019939d301db9399">input_mode</a>, a_src_sim.<a class="code" href="a01100.html#a523947ce4fa7128c4c767163953253b9">solver</a>.<a class="code" href="a02280.html#a0a0b9dc97c7c278a019939d301db9399">input_mode</a>);</div><div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;  strcpy(a_dst_sim.<a class="code" href="a01100.html#a523947ce4fa7128c4c767163953253b9">solver</a>.<a class="code" href="a02280.html#a5f89e286a9eaffdb66d966fa6a290d3f">output_mode</a>, a_src_sim.<a class="code" href="a01100.html#a523947ce4fa7128c4c767163953253b9">solver</a>.<a class="code" href="a02280.html#a5f89e286a9eaffdb66d966fa6a290d3f">output_mode</a>);</div><div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;  a_dst_sim.<a class="code" href="a01100.html#a4afd2c7b3eb8fda452474ebdbe71c8c0">mpi</a>.<a class="code" href="a01028.html#a297fca986fa3aa27de07a0c746ffaaa8">N_IORanks</a> = a_src_sim.<a class="code" href="a01100.html#a4afd2c7b3eb8fda452474ebdbe71c8c0">mpi</a>.<a class="code" href="a01028.html#a297fca986fa3aa27de07a0c746ffaaa8">N_IORanks</a>;</div><div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;</div><div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;  strcpy(a_dst_sim.<a class="code" href="a01100.html#a523947ce4fa7128c4c767163953253b9">solver</a>.<a class="code" href="a02280.html#a4e93cb107e180ef982b74cef7726b70f">op_overwrite</a>, a_src_sim.<a class="code" href="a01100.html#a523947ce4fa7128c4c767163953253b9">solver</a>.<a class="code" href="a02280.html#a4e93cb107e180ef982b74cef7726b70f">op_overwrite</a>);</div><div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;  strcpy(a_dst_sim.<a class="code" href="a01100.html#a523947ce4fa7128c4c767163953253b9">solver</a>.<a class="code" href="a02280.html#ad3fe4b266b398f3a7567ac1b241d99a2">model</a>, a_src_sim.<a class="code" href="a01100.html#a523947ce4fa7128c4c767163953253b9">solver</a>.<a class="code" href="a02280.html#ad3fe4b266b398f3a7567ac1b241d99a2">model</a>);</div><div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;  strcpy(a_dst_sim.<a class="code" href="a01100.html#a523947ce4fa7128c4c767163953253b9">solver</a>.<a class="code" href="a02280.html#a43ee3672350b4fd385871b6512e5d47b">ib_filename</a>, a_src_sim.<a class="code" href="a01100.html#a523947ce4fa7128c4c767163953253b9">solver</a>.<a class="code" href="a02280.html#a43ee3672350b4fd385871b6512e5d47b">ib_filename</a>);</div><div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;</div><div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;  a_dst_sim.<a class="code" href="a01100.html#a523947ce4fa7128c4c767163953253b9">solver</a>.<a class="code" href="a02280.html#ae83b1b0117b6a805ead2e4728945814c">flag_ib</a> = a_src_sim.<a class="code" href="a01100.html#a523947ce4fa7128c4c767163953253b9">solver</a>.<a class="code" href="a02280.html#ae83b1b0117b6a805ead2e4728945814c">flag_ib</a>;</div><div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;</div><div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;<span class="preprocessor">#ifdef with_petsc</span></div><div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;  a_dst_sim.<a class="code" href="a01100.html#a523947ce4fa7128c4c767163953253b9">solver</a>.<a class="code" href="a02280.html#ad195de8c64c407718e42cda9246be0d2">use_petscTS</a> = a_src_sim.<a class="code" href="a01100.html#a523947ce4fa7128c4c767163953253b9">solver</a>.<a class="code" href="a02280.html#ad195de8c64c407718e42cda9246be0d2">use_petscTS</a>;</div><div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;</div><div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;  <span class="keywordflow">return</span>(0);</div><div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;}</div><div class="ttc" id="a02280_html_a484873c74138512e41bc50d17b7d955a"><div class="ttname"><a href="a02280.html#a484873c74138512e41bc50d17b7d955a">HyPar::ndims</a></div><div class="ttdeci">int ndims</div><div class="ttdef"><b>Definition:</b> <a href="a00986_source.html#l00026">hypar.h:26</a></div></div>
<div class="ttc" id="a02280_html_a51a3b8c19b86e9e1df5be02b05a6613c"><div class="ttname"><a href="a02280.html#a51a3b8c19b86e9e1df5be02b05a6613c">HyPar::op_file_format</a></div><div class="ttdeci">char op_file_format[_MAX_STRING_SIZE_]</div><div class="ttdef"><b>Definition:</b> <a href="a00986_source.html#l00186">hypar.h:186</a></div></div>
<div class="ttc" id="a02280_html_ad195de8c64c407718e42cda9246be0d2"><div class="ttname"><a href="a02280.html#ad195de8c64c407718e42cda9246be0d2">HyPar::use_petscTS</a></div><div class="ttdeci">int use_petscTS</div><div class="ttdef"><b>Definition:</b> <a href="a00986_source.html#l00390">hypar.h:390</a></div></div>
<div class="ttc" id="a02280_html_a0a0b9dc97c7c278a019939d301db9399"><div class="ttname"><a href="a02280.html#a0a0b9dc97c7c278a019939d301db9399">HyPar::input_mode</a></div><div class="ttdeci">char input_mode[_MAX_STRING_SIZE_]</div><div class="ttdef"><b>Definition:</b> <a href="a00986_source.html#l00177">hypar.h:177</a></div></div>
<div class="ttc" id="a02280_html_aafb41b96563d9966e8e9f458751f2960"><div class="ttname"><a href="a02280.html#aafb41b96563d9966e8e9f458751f2960">HyPar::restart_iter</a></div><div class="ttdeci">int restart_iter</div><div class="ttdef"><b>Definition:</b> <a href="a00986_source.html#l00058">hypar.h:58</a></div></div>
<div class="ttc" id="a02280_html_a6ff746b30ee55a3bbb9f3306c145f27a"><div class="ttname"><a href="a02280.html#a6ff746b30ee55a3bbb9f3306c145f27a">HyPar::file_op_iter</a></div><div class="ttdeci">int file_op_iter</div><div class="ttdef"><b>Definition:</b> <a href="a00986_source.html#l00171">hypar.h:171</a></div></div>
<div class="ttc" id="a02280_html_aa989ebb755986852177779cdf7bd8c85"><div class="ttname"><a href="a02280.html#aa989ebb755986852177779cdf7bd8c85">HyPar::dim_global</a></div><div class="ttdeci">int * dim_global</div><div class="ttdef"><b>Definition:</b> <a href="a00986_source.html#l00033">hypar.h:33</a></div></div>
<div class="ttc" id="a01028_html_a0be0f30a83bc3f3d9f6ee3a36bbf2716"><div class="ttname"><a href="a01028.html#a0be0f30a83bc3f3d9f6ee3a36bbf2716">MPIVariables::iproc</a></div><div class="ttdeci">int * iproc</div><div class="ttdef"><b>Definition:</b> <a href="a01028_source.html#l00027">mpivars_struct.h:27</a></div></div>
<div class="ttc" id="a01100_html_a523947ce4fa7128c4c767163953253b9"><div class="ttname"><a href="a01100.html#a523947ce4fa7128c4c767163953253b9">SimulationObject::solver</a></div><div class="ttdeci">HyPar solver</div><div class="ttdef"><b>Definition:</b> <a href="a01100_source.html#l00026">simulation_object.h:26</a></div></div>
<div class="ttc" id="a02280_html_a74ff7fa96cbfc4ee87f508f964e94409"><div class="ttname"><a href="a02280.html#a74ff7fa96cbfc4ee87f508f964e94409">HyPar::screen_op_iter</a></div><div class="ttdeci">int screen_op_iter</div><div class="ttdef"><b>Definition:</b> <a href="a00986_source.html#l00168">hypar.h:168</a></div></div>
<div class="ttc" id="a02280_html_ac92c34fe456d92c694eacd2231f5a7b1"><div class="ttname"><a href="a02280.html#ac92c34fe456d92c694eacd2231f5a7b1">HyPar::ConservationCheck</a></div><div class="ttdeci">char ConservationCheck[_MAX_STRING_SIZE_]</div><div class="ttdef"><b>Definition:</b> <a href="a00986_source.html#l00371">hypar.h:371</a></div></div>
<div class="ttc" id="a02280_html_a138e751362d14724df8e6ab27c4a5e55"><div class="ttname"><a href="a02280.html#a138e751362d14724df8e6ab27c4a5e55">HyPar::time_scheme</a></div><div class="ttdeci">char time_scheme[_MAX_STRING_SIZE_]</div><div class="ttdef"><b>Definition:</b> <a href="a00986_source.html#l00078">hypar.h:78</a></div></div>
<div class="ttc" id="a02280_html_a34488172a8ec6e0aaa03cbea46092d3a"><div class="ttname"><a href="a02280.html#a34488172a8ec6e0aaa03cbea46092d3a">HyPar::my_idx</a></div><div class="ttdeci">int my_idx</div><div class="ttdef"><b>Definition:</b> <a href="a00986_source.html#l00061">hypar.h:61</a></div></div>
<div class="ttc" id="a02280_html_a43ee3672350b4fd385871b6512e5d47b"><div class="ttname"><a href="a02280.html#a43ee3672350b4fd385871b6512e5d47b">HyPar::ib_filename</a></div><div class="ttdeci">char ib_filename[_MAX_STRING_SIZE_]</div><div class="ttdef"><b>Definition:</b> <a href="a00986_source.html#l00434">hypar.h:434</a></div></div>
<div class="ttc" id="a02408_html_ac6a822dc76382e4027cf94ac3e510056"><div class="ttname"><a href="a02408.html#ac6a822dc76382e4027cf94ac3e510056">SparseGridsSimulation::m_rank</a></div><div class="ttdeci">int m_rank</div><div class="ttdef"><b>Definition:</b> <a href="a01106_source.html#l00216">sparse_grids_simulation.h:216</a></div></div>
<div class="ttc" id="a02280_html_a4e93cb107e180ef982b74cef7726b70f"><div class="ttname"><a href="a02280.html#a4e93cb107e180ef982b74cef7726b70f">HyPar::op_overwrite</a></div><div class="ttdeci">char op_overwrite[_MAX_STRING_SIZE_]</div><div class="ttdef"><b>Definition:</b> <a href="a00986_source.html#l00191">hypar.h:191</a></div></div>
<div class="ttc" id="a02280_html_ad45d57b33d578bf602574a221bf53d93"><div class="ttname"><a href="a02280.html#ad45d57b33d578bf602574a221bf53d93">HyPar::spatial_type_par</a></div><div class="ttdeci">char spatial_type_par[_MAX_STRING_SIZE_]</div><div class="ttdef"><b>Definition:</b> <a href="a00986_source.html#l00096">hypar.h:96</a></div></div>
<div class="ttc" id="a01100_html_a4afd2c7b3eb8fda452474ebdbe71c8c0"><div class="ttname"><a href="a01100.html#a4afd2c7b3eb8fda452474ebdbe71c8c0">SimulationObject::mpi</a></div><div class="ttdeci">MPIVariables mpi</div><div class="ttdef"><b>Definition:</b> <a href="a01100_source.html#l00025">simulation_object.h:25</a></div></div>
<div class="ttc" id="a02280_html_a9a0e87291e0e8b9c1445e5482e814c92"><div class="ttname"><a href="a02280.html#a9a0e87291e0e8b9c1445e5482e814c92">HyPar::nsims</a></div><div class="ttdeci">int nsims</div><div class="ttdef"><b>Definition:</b> <a href="a00986_source.html#l00064">hypar.h:64</a></div></div>
<div class="ttc" id="a02280_html_ae83b1b0117b6a805ead2e4728945814c"><div class="ttname"><a href="a02280.html#ae83b1b0117b6a805ead2e4728945814c">HyPar::flag_ib</a></div><div class="ttdeci">int flag_ib</div><div class="ttdef"><b>Definition:</b> <a href="a00986_source.html#l00436">hypar.h:436</a></div></div>
<div class="ttc" id="a02280_html_a5bed0cb9665daad89f4377c4f7609df4"><div class="ttname"><a href="a02280.html#a5bed0cb9665daad89f4377c4f7609df4">HyPar::SplitHyperbolicFlux</a></div><div class="ttdeci">char SplitHyperbolicFlux[_MAX_STRING_SIZE_]</div><div class="ttdef"><b>Definition:</b> <a href="a00986_source.html#l00092">hypar.h:92</a></div></div>
<div class="ttc" id="a02280_html_af0d8e0d5d3de3869b941b66b6caaf964"><div class="ttname"><a href="a02280.html#af0d8e0d5d3de3869b941b66b6caaf964">HyPar::n_iter</a></div><div class="ttdeci">int n_iter</div><div class="ttdef"><b>Definition:</b> <a href="a00986_source.html#l00055">hypar.h:55</a></div></div>
<div class="ttc" id="a02280_html_ad3fe4b266b398f3a7567ac1b241d99a2"><div class="ttname"><a href="a02280.html#ad3fe4b266b398f3a7567ac1b241d99a2">HyPar::model</a></div><div class="ttdeci">char model[_MAX_STRING_SIZE_]</div><div class="ttdef"><b>Definition:</b> <a href="a00986_source.html#l00258">hypar.h:258</a></div></div>
<div class="ttc" id="a02280_html_a83f3dcd022f744511a44f2a31a824ac8"><div class="ttname"><a href="a02280.html#a83f3dcd022f744511a44f2a31a824ac8">HyPar::ip_file_type</a></div><div class="ttdeci">char ip_file_type[_MAX_STRING_SIZE_]</div><div class="ttdef"><b>Definition:</b> <a href="a00986_source.html#l00180">hypar.h:180</a></div></div>
<div class="ttc" id="a02408_html_ae5bbe5daa629a4f92b569cb632256780"><div class="ttname"><a href="a02408.html#ae5bbe5daa629a4f92b569cb632256780">SparseGridsSimulation::m_nproc</a></div><div class="ttdeci">int m_nproc</div><div class="ttdef"><b>Definition:</b> <a href="a01106_source.html#l00216">sparse_grids_simulation.h:216</a></div></div>
<div class="ttc" id="a02280_html_a61750696383420ba8bcc7d9e44a538e2"><div class="ttname"><a href="a02280.html#a61750696383420ba8bcc7d9e44a538e2">HyPar::time_scheme_type</a></div><div class="ttdeci">char time_scheme_type[_MAX_STRING_SIZE_]</div><div class="ttdef"><b>Definition:</b> <a href="a00986_source.html#l00081">hypar.h:81</a></div></div>
<div class="ttc" id="a02280_html_a9591ba0fadb863561474e2ba251d2594"><div class="ttname"><a href="a02280.html#a9591ba0fadb863561474e2ba251d2594">HyPar::interp_type</a></div><div class="ttdeci">char interp_type[_MAX_STRING_SIZE_]</div><div class="ttdef"><b>Definition:</b> <a href="a00986_source.html#l00088">hypar.h:88</a></div></div>
<div class="ttc" id="a02280_html_a03e28be41881b703c836edbfe9b51b17"><div class="ttname"><a href="a02280.html#a03e28be41881b703c836edbfe9b51b17">HyPar::dt</a></div><div class="ttdeci">double dt</div><div class="ttdef"><b>Definition:</b> <a href="a00986_source.html#l00067">hypar.h:67</a></div></div>
<div class="ttc" id="a02280_html_a5f89e286a9eaffdb66d966fa6a290d3f"><div class="ttname"><a href="a02280.html#a5f89e286a9eaffdb66d966fa6a290d3f">HyPar::output_mode</a></div><div class="ttdeci">char output_mode[_MAX_STRING_SIZE_]</div><div class="ttdef"><b>Definition:</b> <a href="a00986_source.html#l00183">hypar.h:183</a></div></div>
<div class="ttc" id="a02280_html_a170f2f6cc8ac86b78fcb376c2392e290"><div class="ttname"><a href="a02280.html#a170f2f6cc8ac86b78fcb376c2392e290">HyPar::spatial_scheme_par</a></div><div class="ttdeci">char spatial_scheme_par[_MAX_STRING_SIZE_]</div><div class="ttdef"><b>Definition:</b> <a href="a00986_source.html#l00099">hypar.h:99</a></div></div>
<div class="ttc" id="a01028_html_a297fca986fa3aa27de07a0c746ffaaa8"><div class="ttname"><a href="a01028.html#a297fca986fa3aa27de07a0c746ffaaa8">MPIVariables::N_IORanks</a></div><div class="ttdeci">int N_IORanks</div><div class="ttdef"><b>Definition:</b> <a href="a01028_source.html#l00041">mpivars_struct.h:41</a></div></div>
<div class="ttc" id="a02280_html_ad29846eeb9c83b329a8d7c1fe69d46b2"><div class="ttname"><a href="a02280.html#ad29846eeb9c83b329a8d7c1fe69d46b2">HyPar::spatial_scheme_hyp</a></div><div class="ttdeci">char spatial_scheme_hyp[_MAX_STRING_SIZE_]</div><div class="ttdef"><b>Definition:</b> <a href="a00986_source.html#l00084">hypar.h:84</a></div></div>
<div class="ttc" id="a02280_html_ae8f6d2fd6490d3153cb4133bf183a404"><div class="ttname"><a href="a02280.html#ae8f6d2fd6490d3153cb4133bf183a404">HyPar::nvars</a></div><div class="ttdeci">int nvars</div><div class="ttdef"><b>Definition:</b> <a href="a00986_source.html#l00029">hypar.h:29</a></div></div>
<div class="ttc" id="a02280_html_aafc992b5fa79d5a4036024615d03bce6"><div class="ttname"><a href="a02280.html#aafc992b5fa79d5a4036024615d03bce6">HyPar::ghosts</a></div><div class="ttdeci">int ghosts</div><div class="ttdef"><b>Definition:</b> <a href="a00986_source.html#l00052">hypar.h:52</a></div></div>
<div class="ttc" id="a01028_html_a6cfd95afd0afebd625b889fb6e58371c"><div class="ttname"><a href="a01028.html#a6cfd95afd0afebd625b889fb6e58371c">MPIVariables::rank</a></div><div class="ttdeci">int rank</div><div class="ttdef"><b>Definition:</b> <a href="a01028_source.html#l00025">mpivars_struct.h:25</a></div></div>
<div class="ttc" id="a01028_html_ae68326adc3b3862f1162832f70727b06"><div class="ttname"><a href="a01028.html#ae68326adc3b3862f1162832f70727b06">MPIVariables::nproc</a></div><div class="ttdeci">int nproc</div><div class="ttdef"><b>Definition:</b> <a href="a01028_source.html#l00026">mpivars_struct.h:26</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="aba08ee83eb54edc5274b210c75e63e8c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aba08ee83eb54edc5274b210c75e63e8c">&#9670;&nbsp;</a></span>OutputSolution()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void OutputSolution </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Output solutions to file</p>
<p>Write solutions to file </p>

<p class="definition">Definition at line <a class="el" href="a02180_source.html#l00011">11</a> of file <a class="el" href="a02180_source.html">SparseGridsOutputSolution.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;{</div><div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;  <span class="comment">/* if asked for, write individual sparse grids solutions */</span></div><div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="a02408.html#a634b90e62b481c87ad0ba4ee5c5feba4">m_write_sg_solutions</a> == 1) {</div><div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ns = 0; ns &lt; <a class="code" href="a02408.html#acd95922d6bb09419fb66435d114cdb5c">m_nsims_sg</a>; ns++) {</div><div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="a02408.html#afd006361179964b4e2c2cc65526247bd">m_sims_sg</a>[ns].solver.PhysicsOutput) {</div><div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;        <a class="code" href="a02408.html#afd006361179964b4e2c2cc65526247bd">m_sims_sg</a>[ns].solver.PhysicsOutput( &amp;(<a class="code" href="a02408.html#afd006361179964b4e2c2cc65526247bd">m_sims_sg</a>[ns].solver),</div><div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;                                            &amp;(<a class="code" href="a02408.html#afd006361179964b4e2c2cc65526247bd">m_sims_sg</a>[ns].mpi) );</div><div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;      }</div><div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;    }</div><div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;    <a class="code" href="a02408.html#aba08ee83eb54edc5274b210c75e63e8c">::OutputSolution</a>((<span class="keywordtype">void</span>*)<a class="code" href="a02408.html#afd006361179964b4e2c2cc65526247bd">m_sims_sg</a>.data(), <a class="code" href="a02408.html#acd95922d6bb09419fb66435d114cdb5c">m_nsims_sg</a>);</div><div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;  }</div><div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;</div><div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;  <span class="comment">/* Combine the sparse grids solutions to full grid */</span></div><div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;  <a class="code" href="a02408.html#a3854ff631312b4487e4b816b9ffbb8ad">CombinationTechnique</a>(<a class="code" href="a02408.html#a41a86f682aa37c28c671759a11a494a8">m_sim_fg</a>);</div><div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;</div><div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;  <span class="comment">/* Write the full grid solution */</span></div><div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;  <a class="code" href="a02408.html#aba08ee83eb54edc5274b210c75e63e8c">::OutputSolution</a>((<span class="keywordtype">void</span>*)<a class="code" href="a02408.html#a41a86f682aa37c28c671759a11a494a8">m_sim_fg</a>, 1);</div><div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;</div><div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;  <span class="keywordflow">return</span>;</div><div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;}</div><div class="ttc" id="a02408_html_a634b90e62b481c87ad0ba4ee5c5feba4"><div class="ttname"><a href="a02408.html#a634b90e62b481c87ad0ba4ee5c5feba4">SparseGridsSimulation::m_write_sg_solutions</a></div><div class="ttdeci">int m_write_sg_solutions</div><div class="ttdef"><b>Definition:</b> <a href="a01106_source.html#l00225">sparse_grids_simulation.h:225</a></div></div>
<div class="ttc" id="a02408_html_acd95922d6bb09419fb66435d114cdb5c"><div class="ttname"><a href="a02408.html#acd95922d6bb09419fb66435d114cdb5c">SparseGridsSimulation::m_nsims_sg</a></div><div class="ttdeci">int m_nsims_sg</div><div class="ttdef"><b>Definition:</b> <a href="a01106_source.html#l00214">sparse_grids_simulation.h:214</a></div></div>
<div class="ttc" id="a02408_html_a41a86f682aa37c28c671759a11a494a8"><div class="ttname"><a href="a02408.html#a41a86f682aa37c28c671759a11a494a8">SparseGridsSimulation::m_sim_fg</a></div><div class="ttdeci">SimulationObject * m_sim_fg</div><div class="ttdef"><b>Definition:</b> <a href="a01106_source.html#l00230">sparse_grids_simulation.h:230</a></div></div>
<div class="ttc" id="a02408_html_a3854ff631312b4487e4b816b9ffbb8ad"><div class="ttname"><a href="a02408.html#a3854ff631312b4487e4b816b9ffbb8ad">SparseGridsSimulation::CombinationTechnique</a></div><div class="ttdeci">void CombinationTechnique(SimulationObject *const)</div><div class="ttdef"><b>Definition:</b> <a href="a02153_source.html#l00023">SparseGridsCombinationTechnique.cpp:23</a></div></div>
<div class="ttc" id="a02408_html_afd006361179964b4e2c2cc65526247bd"><div class="ttname"><a href="a02408.html#afd006361179964b4e2c2cc65526247bd">SparseGridsSimulation::m_sims_sg</a></div><div class="ttdeci">std::vector&lt; SimulationObject &gt; m_sims_sg</div><div class="ttdef"><b>Definition:</b> <a href="a01106_source.html#l00231">sparse_grids_simulation.h:231</a></div></div>
<div class="ttc" id="a02408_html_aba08ee83eb54edc5274b210c75e63e8c"><div class="ttname"><a href="a02408.html#aba08ee83eb54edc5274b210c75e63e8c">SparseGridsSimulation::OutputSolution</a></div><div class="ttdeci">void OutputSolution()</div><div class="ttdef"><b>Definition:</b> <a href="a02180_source.html#l00011">SparseGridsOutputSolution.cpp:11</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a3854ff631312b4487e4b816b9ffbb8ad"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3854ff631312b4487e4b816b9ffbb8ad">&#9670;&nbsp;</a></span>CombinationTechnique()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void CombinationTechnique </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="a01100.html#a02400">SimulationObject</a> * const&#160;</td>
          <td class="paramname"><em>a_sim</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Combination technique</p>
<p>Implements the combination technique where the solutions from all the sparse grids are combined to give a higher-resolution solution.</p>
<p>The sparse grids domains may have different processor layouts, so this combination is carried out on rank 0, and the solution is distributed. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">a_sim</td><td>target simulation object on which to combine </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="a02153_source.html#l00023">23</a> of file <a class="el" href="a02153_source.html">SparseGridsCombinationTechnique.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;{</div><div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;  <span class="keywordtype">double</span>** u_sg = (<span class="keywordtype">double</span>**) calloc (<a class="code" href="a02408.html#acd95922d6bb09419fb66435d114cdb5c">m_nsims_sg</a>, <span class="keyword">sizeof</span>(<span class="keywordtype">double</span>*));</div><div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;  std::vector&lt;double&gt; coeffs(<a class="code" href="a02408.html#acd95922d6bb09419fb66435d114cdb5c">m_nsims_sg</a>, 0.0);</div><div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> n=0; n&lt;<a class="code" href="a02408.html#acd95922d6bb09419fb66435d114cdb5c">m_nsims_sg</a>; n++) {</div><div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;    u_sg[n] = <a class="code" href="a02408.html#afd006361179964b4e2c2cc65526247bd">m_sims_sg</a>[n].solver.u;</div><div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;    coeffs[n] = <a class="code" href="a02408.html#a8b468da0c8b3831ae8b1519d8781245f">m_combination</a>[n]._coeff_;</div><div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;  }</div><div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;</div><div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;  <a class="code" href="a02153.html#a804036e137ca2564ae58b98f675d833b">::CombineSolutions</a>( <a class="code" href="a02408.html#afd006361179964b4e2c2cc65526247bd">m_sims_sg</a>.data(),</div><div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;                      u_sg,</div><div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;                      <a class="code" href="a02408.html#acd95922d6bb09419fb66435d114cdb5c">m_nsims_sg</a>,</div><div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;                      a_sim,</div><div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;                      a_sim-&gt;<a class="code" href="a01100.html#a523947ce4fa7128c4c767163953253b9">solver</a>.<a class="code" href="a02280.html#a3b6b999a764f1e2ea94bb5f28c7a558c">u</a>,</div><div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;                      coeffs.data() );</div><div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;</div><div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;  <span class="comment">/* done */</span></div><div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;  <span class="keywordflow">return</span>;</div><div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;}</div><div class="ttc" id="a02408_html_acd95922d6bb09419fb66435d114cdb5c"><div class="ttname"><a href="a02408.html#acd95922d6bb09419fb66435d114cdb5c">SparseGridsSimulation::m_nsims_sg</a></div><div class="ttdeci">int m_nsims_sg</div><div class="ttdef"><b>Definition:</b> <a href="a01106_source.html#l00214">sparse_grids_simulation.h:214</a></div></div>
<div class="ttc" id="a02280_html_a3b6b999a764f1e2ea94bb5f28c7a558c"><div class="ttname"><a href="a02280.html#a3b6b999a764f1e2ea94bb5f28c7a558c">HyPar::u</a></div><div class="ttdeci">double * u</div><div class="ttdef"><b>Definition:</b> <a href="a00986_source.html#l00116">hypar.h:116</a></div></div>
<div class="ttc" id="a01100_html_a523947ce4fa7128c4c767163953253b9"><div class="ttname"><a href="a01100.html#a523947ce4fa7128c4c767163953253b9">SimulationObject::solver</a></div><div class="ttdeci">HyPar solver</div><div class="ttdef"><b>Definition:</b> <a href="a01100_source.html#l00026">simulation_object.h:26</a></div></div>
<div class="ttc" id="a02408_html_afd006361179964b4e2c2cc65526247bd"><div class="ttname"><a href="a02408.html#afd006361179964b4e2c2cc65526247bd">SparseGridsSimulation::m_sims_sg</a></div><div class="ttdeci">std::vector&lt; SimulationObject &gt; m_sims_sg</div><div class="ttdef"><b>Definition:</b> <a href="a01106_source.html#l00231">sparse_grids_simulation.h:231</a></div></div>
<div class="ttc" id="a02408_html_a8b468da0c8b3831ae8b1519d8781245f"><div class="ttname"><a href="a02408.html#a8b468da0c8b3831ae8b1519d8781245f">SparseGridsSimulation::m_combination</a></div><div class="ttdeci">std::vector&lt; SGCTElem &gt; m_combination</div><div class="ttdef"><b>Definition:</b> <a href="a01106_source.html#l00236">sparse_grids_simulation.h:236</a></div></div>
<div class="ttc" id="a02153_html_a804036e137ca2564ae58b98f675d833b"><div class="ttname"><a href="a02153.html#a804036e137ca2564ae58b98f675d833b">CombineSolutions</a></div><div class="ttdeci">void CombineSolutions(SimulationObject *, double *const *const, const int, SimulationObject *, double *const, const double *const)</div><div class="ttdef"><b>Definition:</b> <a href="a02099_source.html#l00019">CombineSolutions.c:19</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a96da5797b40184e2da41e3d1abfc9697"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a96da5797b40184e2da41e3d1abfc9697">&#9670;&nbsp;</a></span>interpolate() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void interpolate </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="a01100.html#a02400">SimulationObject</a> * const&#160;</td>
          <td class="paramname"><em>a_dst</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="a01100.html#a02400">SimulationObject</a> * const&#160;</td>
          <td class="paramname"><em>a_src</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Interpolate data from one simulation object to another</p>
<p>Interpolate data from one grid to another. Note that along each dimension, the ratio of the number of grid points in the source grid and that in the destination grid must be an integer power of 2 (negative or positive). </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">a_dst</td><td>Destination object </td></tr>
    <tr><td class="paramname">a_src</td><td>Source object </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="a02171_source.html#l00015">15</a> of file <a class="el" href="a02171_source.html">SparseGridsInterpolate.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;{</div><div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;  <span class="comment">/* get the destination grid dimensions */</span></div><div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;  <a class="code" href="a01106.html#a00167df288a1ca2c6c32af8d911975e0">GridDimensions</a> dim_dst;</div><div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;  <a class="code" href="a02264.html#a53cafdf187fdf401cda2700b0c2f223c">StdVecOps::copyFrom</a>(dim_dst, a_dst-&gt;<a class="code" href="a01100.html#a523947ce4fa7128c4c767163953253b9">solver</a>.<a class="code" href="a02280.html#aa989ebb755986852177779cdf7bd8c85">dim_global</a>, <a class="code" href="a02408.html#af3c229deae2a8e788c823dcc6f020b65">m_ndims</a>);</div><div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;</div><div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;  <span class="comment">/* get number of vector components */</span></div><div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;  <span class="keywordtype">int</span> nvars = a_src-&gt;<a class="code" href="a01100.html#a523947ce4fa7128c4c767163953253b9">solver</a>.<a class="code" href="a02280.html#ae8f6d2fd6490d3153cb4133bf183a404">nvars</a>;</div><div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;  <span class="keywordflow">if</span> (nvars != a_dst-&gt;<a class="code" href="a01100.html#a523947ce4fa7128c4c767163953253b9">solver</a>.<a class="code" href="a02280.html#ae8f6d2fd6490d3153cb4133bf183a404">nvars</a>) {</div><div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;    fprintf(stderr, <span class="stringliteral">&quot;Error in SparseGridsSimulation::interpolate(): unequal nvars\n&quot;</span>);</div><div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;    exit(1);</div><div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;  }</div><div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;</div><div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;  <span class="keywordtype">double</span> *ug_dst = NULL;</div><div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;  <a class="code" href="a02408.html#a96da5797b40184e2da41e3d1abfc9697">interpolate</a>(dim_dst, &amp;ug_dst, a_src); </div><div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;</div><div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;  <span class="comment">/* partition the destination */</span></div><div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;  <a class="code" href="a01022.html#a25eaada04db84ccf1c979d4301f5093f">MPIPartitionArraynDwGhosts</a>( <a class="code" href="a02408.html#af3c229deae2a8e788c823dcc6f020b65">m_ndims</a>,</div><div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;                              (<span class="keywordtype">void</span>*) &amp;(a_dst-&gt;<a class="code" href="a01100.html#a4afd2c7b3eb8fda452474ebdbe71c8c0">mpi</a>),</div><div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;                              (a_dst-&gt;<a class="code" href="a01100.html#a4afd2c7b3eb8fda452474ebdbe71c8c0">mpi</a>.<a class="code" href="a01028.html#a6cfd95afd0afebd625b889fb6e58371c">rank</a> ? NULL : ug_dst),</div><div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;                              a_dst-&gt;<a class="code" href="a01100.html#a523947ce4fa7128c4c767163953253b9">solver</a>.<a class="code" href="a02280.html#a3b6b999a764f1e2ea94bb5f28c7a558c">u</a>,</div><div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;                              a_dst-&gt;<a class="code" href="a01100.html#a523947ce4fa7128c4c767163953253b9">solver</a>.<a class="code" href="a02280.html#aa989ebb755986852177779cdf7bd8c85">dim_global</a>,</div><div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;                              a_dst-&gt;<a class="code" href="a01100.html#a523947ce4fa7128c4c767163953253b9">solver</a>.<a class="code" href="a02280.html#a38e0371f331cecbe63a77fa03e202afe">dim_local</a>,</div><div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;                              a_dst-&gt;<a class="code" href="a01100.html#a523947ce4fa7128c4c767163953253b9">solver</a>.<a class="code" href="a02280.html#aafc992b5fa79d5a4036024615d03bce6">ghosts</a>,</div><div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;                              nvars); </div><div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;</div><div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;  <span class="keywordflow">if</span> (!<a class="code" href="a02408.html#ac6a822dc76382e4027cf94ac3e510056">m_rank</a>) {</div><div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;    free(ug_dst);</div><div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;  }</div><div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;</div><div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;  <span class="keywordflow">return</span>;</div><div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;}</div><div class="ttc" id="a02408_html_a96da5797b40184e2da41e3d1abfc9697"><div class="ttname"><a href="a02408.html#a96da5797b40184e2da41e3d1abfc9697">SparseGridsSimulation::interpolate</a></div><div class="ttdeci">void interpolate(SimulationObject *const, const SimulationObject *const)</div><div class="ttdef"><b>Definition:</b> <a href="a02171_source.html#l00015">SparseGridsInterpolate.cpp:15</a></div></div>
<div class="ttc" id="a02280_html_a3b6b999a764f1e2ea94bb5f28c7a558c"><div class="ttname"><a href="a02280.html#a3b6b999a764f1e2ea94bb5f28c7a558c">HyPar::u</a></div><div class="ttdeci">double * u</div><div class="ttdef"><b>Definition:</b> <a href="a00986_source.html#l00116">hypar.h:116</a></div></div>
<div class="ttc" id="a02280_html_aa989ebb755986852177779cdf7bd8c85"><div class="ttname"><a href="a02280.html#aa989ebb755986852177779cdf7bd8c85">HyPar::dim_global</a></div><div class="ttdeci">int * dim_global</div><div class="ttdef"><b>Definition:</b> <a href="a00986_source.html#l00033">hypar.h:33</a></div></div>
<div class="ttc" id="a01100_html_a523947ce4fa7128c4c767163953253b9"><div class="ttname"><a href="a01100.html#a523947ce4fa7128c4c767163953253b9">SimulationObject::solver</a></div><div class="ttdeci">HyPar solver</div><div class="ttdef"><b>Definition:</b> <a href="a01100_source.html#l00026">simulation_object.h:26</a></div></div>
<div class="ttc" id="a02408_html_af3c229deae2a8e788c823dcc6f020b65"><div class="ttname"><a href="a02408.html#af3c229deae2a8e788c823dcc6f020b65">SparseGridsSimulation::m_ndims</a></div><div class="ttdeci">int m_ndims</div><div class="ttdef"><b>Definition:</b> <a href="a01106_source.html#l00215">sparse_grids_simulation.h:215</a></div></div>
<div class="ttc" id="a02408_html_ac6a822dc76382e4027cf94ac3e510056"><div class="ttname"><a href="a02408.html#ac6a822dc76382e4027cf94ac3e510056">SparseGridsSimulation::m_rank</a></div><div class="ttdeci">int m_rank</div><div class="ttdef"><b>Definition:</b> <a href="a01106_source.html#l00216">sparse_grids_simulation.h:216</a></div></div>
<div class="ttc" id="a01100_html_a4afd2c7b3eb8fda452474ebdbe71c8c0"><div class="ttname"><a href="a01100.html#a4afd2c7b3eb8fda452474ebdbe71c8c0">SimulationObject::mpi</a></div><div class="ttdeci">MPIVariables mpi</div><div class="ttdef"><b>Definition:</b> <a href="a01100_source.html#l00025">simulation_object.h:25</a></div></div>
<div class="ttc" id="a02264_html_a53cafdf187fdf401cda2700b0c2f223c"><div class="ttname"><a href="a02264.html#a53cafdf187fdf401cda2700b0c2f223c">StdVecOps::copyFrom</a></div><div class="ttdeci">void copyFrom(std::vector&lt; int &gt; &amp;a_iv, const int *const a_iv_carr, int a_n)</div><div class="ttdef"><b>Definition:</b> <a href="a01109_source.html#l00036">std_vec_ops.h:36</a></div></div>
<div class="ttc" id="a01022_html_a25eaada04db84ccf1c979d4301f5093f"><div class="ttname"><a href="a01022.html#a25eaada04db84ccf1c979d4301f5093f">MPIPartitionArraynDwGhosts</a></div><div class="ttdeci">int MPIPartitionArraynDwGhosts(int, void *, double *, double *, int *, int *, int, int)</div><div class="ttdef"><b>Definition:</b> <a href="a01508_source.html#l00114">MPIPartitionArraynD.c:114</a></div></div>
<div class="ttc" id="a02280_html_a38e0371f331cecbe63a77fa03e202afe"><div class="ttname"><a href="a02280.html#a38e0371f331cecbe63a77fa03e202afe">HyPar::dim_local</a></div><div class="ttdeci">int * dim_local</div><div class="ttdef"><b>Definition:</b> <a href="a00986_source.html#l00037">hypar.h:37</a></div></div>
<div class="ttc" id="a02280_html_ae8f6d2fd6490d3153cb4133bf183a404"><div class="ttname"><a href="a02280.html#ae8f6d2fd6490d3153cb4133bf183a404">HyPar::nvars</a></div><div class="ttdeci">int nvars</div><div class="ttdef"><b>Definition:</b> <a href="a00986_source.html#l00029">hypar.h:29</a></div></div>
<div class="ttc" id="a02280_html_aafc992b5fa79d5a4036024615d03bce6"><div class="ttname"><a href="a02280.html#aafc992b5fa79d5a4036024615d03bce6">HyPar::ghosts</a></div><div class="ttdeci">int ghosts</div><div class="ttdef"><b>Definition:</b> <a href="a00986_source.html#l00052">hypar.h:52</a></div></div>
<div class="ttc" id="a01028_html_a6cfd95afd0afebd625b889fb6e58371c"><div class="ttname"><a href="a01028.html#a6cfd95afd0afebd625b889fb6e58371c">MPIVariables::rank</a></div><div class="ttdeci">int rank</div><div class="ttdef"><b>Definition:</b> <a href="a01028_source.html#l00025">mpivars_struct.h:25</a></div></div>
<div class="ttc" id="a01106_html_a00167df288a1ca2c6c32af8d911975e0"><div class="ttname"><a href="a01106.html#a00167df288a1ca2c6c32af8d911975e0">GridDimensions</a></div><div class="ttdeci">std::vector&lt; int &gt; GridDimensions</div><div class="ttdef"><b>Definition:</b> <a href="a01106_source.html#l00020">sparse_grids_simulation.h:20</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="abb8abf06b6b5d0b4d804970b8b896bde"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abb8abf06b6b5d0b4d804970b8b896bde">&#9670;&nbsp;</a></span>interpolate() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void interpolate </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="a01106.html#a00167df288a1ca2c6c32af8d911975e0">GridDimensions</a> &amp;&#160;</td>
          <td class="paramname"><em>a_dim_dst</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double ** const&#160;</td>
          <td class="paramname"><em>a_u_dst</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="a01100.html#a02400">SimulationObject</a> * const&#160;</td>
          <td class="paramname"><em>a_src</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Interpolate data from a simulation to a global C-array</p>
<p>Interpolate data from one grid to another of a desired resolution. Note that along each dimension, the ratio of the number of grid points in the source grid and that in the destination grid must be an integer power of 2 (negative or positive).</p>
<p>The incoming pointer must be NULL. After this function is executed, it will point to a chunk of memory with the interpolated solution. This is the <em>global</em> solution.</p>
<p>Since the source and destination grids may have different processor layouts, the interpolation is carried out on rank 0 by allocating global arrays on it. Therefore, this function is <em>not</em> scalable. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">a_dim_dst</td><td>grid dimensions to interpolate to </td></tr>
    <tr><td class="paramname">a_u_dst</td><td>pointer to array containing interpolated data </td></tr>
    <tr><td class="paramname">a_src</td><td>Source object </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="a02171_source.html#l00063">63</a> of file <a class="el" href="a02171_source.html">SparseGridsInterpolate.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;{</div><div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;  <span class="keywordflow">if</span> ((*a_u_dst) != NULL) {</div><div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;    fprintf(stderr, <span class="stringliteral">&quot;Error in SparseGridsSimulation::interpolate() - \n&quot;</span>);</div><div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;    fprintf(stderr, <span class="stringliteral">&quot;  a_u_dst is not NULL!\n&quot;</span>);</div><div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;    exit(1);</div><div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;  }</div><div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;</div><div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;  <span class="comment">/* get the source grid dimensions */</span></div><div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;  <a class="code" href="a01106.html#a00167df288a1ca2c6c32af8d911975e0">GridDimensions</a> dim_src;</div><div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;  <a class="code" href="a02264.html#a53cafdf187fdf401cda2700b0c2f223c">StdVecOps::copyFrom</a>(dim_src, a_src-&gt;<a class="code" href="a01100.html#a523947ce4fa7128c4c767163953253b9">solver</a>.<a class="code" href="a02280.html#aa989ebb755986852177779cdf7bd8c85">dim_global</a>, <a class="code" href="a02408.html#af3c229deae2a8e788c823dcc6f020b65">m_ndims</a>);</div><div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;</div><div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;  <span class="comment">/* get number of vector components and number of ghost points*/</span></div><div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;  <span class="keywordtype">int</span> nvars = a_src-&gt;<a class="code" href="a01100.html#a523947ce4fa7128c4c767163953253b9">solver</a>.<a class="code" href="a02280.html#ae8f6d2fd6490d3153cb4133bf183a404">nvars</a>;</div><div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;  <span class="keywordtype">int</span> ghosts = a_src-&gt;<a class="code" href="a01100.html#a523947ce4fa7128c4c767163953253b9">solver</a>.<a class="code" href="a02280.html#aafc992b5fa79d5a4036024615d03bce6">ghosts</a>;</div><div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;</div><div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;  <span class="comment">/* gather the source on rank 0 */</span></div><div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;  <span class="keywordtype">double</span> *ug_src = NULL;</div><div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;  <span class="keywordflow">if</span> (!<a class="code" href="a02408.html#ac6a822dc76382e4027cf94ac3e510056">m_rank</a>) <a class="code" href="a02408.html#a00beed94b3f705d20db508533bfc0fc0">allocateDataArrays</a>(dim_src, nvars, &amp;ug_src, ghosts);</div><div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;  <a class="code" href="a01022.html#a81ef82bfd40dff69eb5b975c102133f2">MPIGatherArraynDwGhosts</a>( <a class="code" href="a02408.html#af3c229deae2a8e788c823dcc6f020b65">m_ndims</a>,</div><div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;                           (<span class="keywordtype">void</span>*) &amp;(a_src-&gt;<a class="code" href="a01100.html#a4afd2c7b3eb8fda452474ebdbe71c8c0">mpi</a>),</div><div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;                           ug_src,</div><div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;                           a_src-&gt;<a class="code" href="a01100.html#a523947ce4fa7128c4c767163953253b9">solver</a>.<a class="code" href="a02280.html#a3b6b999a764f1e2ea94bb5f28c7a558c">u</a>,</div><div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;                           a_src-&gt;<a class="code" href="a01100.html#a523947ce4fa7128c4c767163953253b9">solver</a>.<a class="code" href="a02280.html#aa989ebb755986852177779cdf7bd8c85">dim_global</a>,</div><div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;                           a_src-&gt;<a class="code" href="a01100.html#a523947ce4fa7128c4c767163953253b9">solver</a>.<a class="code" href="a02280.html#a38e0371f331cecbe63a77fa03e202afe">dim_local</a>,</div><div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;                           ghosts,</div><div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;                           nvars );</div><div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;</div><div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;  std::vector&lt;int&gt; periodic_arr(<a class="code" href="a02408.html#af3c229deae2a8e788c823dcc6f020b65">m_ndims</a>);</div><div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;<a class="code" href="a02408.html#af3c229deae2a8e788c823dcc6f020b65">m_ndims</a>; i++) {</div><div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;    periodic_arr[i] = (<a class="code" href="a02408.html#a1fde282f4347462c9c2dd34aac2ad998">m_is_periodic</a>[i] ? 1 : 0);</div><div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;  }</div><div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;</div><div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;  <span class="keywordflow">if</span> (!<a class="code" href="a02408.html#ac6a822dc76382e4027cf94ac3e510056">m_rank</a>) {</div><div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;    <span class="keywordtype">int</span> ierr = <a class="code" href="a01010.html#a4293421dad25c62114f4a7453d6376aa">::InterpolateGlobalnDVar</a>(  a_dim_dst.data(),</div><div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;                                          a_u_dst,</div><div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;                                          dim_src.data(),</div><div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;                                          ug_src,</div><div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;                                          nvars,</div><div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;                                          ghosts,</div><div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;                                          <a class="code" href="a02408.html#af3c229deae2a8e788c823dcc6f020b65">m_ndims</a>,</div><div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;                                          periodic_arr.data());</div><div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;    <span class="keywordflow">if</span> (ierr) {</div><div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;      fprintf(stderr,<span class="stringliteral">&quot;InterpolateGlobalnDVar() returned with error!\n&quot;</span>);</div><div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;      exit(1);</div><div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;    }</div><div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;  }</div><div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;</div><div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;  <span class="keywordflow">return</span>;</div><div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;}</div><div class="ttc" id="a02280_html_a3b6b999a764f1e2ea94bb5f28c7a558c"><div class="ttname"><a href="a02280.html#a3b6b999a764f1e2ea94bb5f28c7a558c">HyPar::u</a></div><div class="ttdeci">double * u</div><div class="ttdef"><b>Definition:</b> <a href="a00986_source.html#l00116">hypar.h:116</a></div></div>
<div class="ttc" id="a02280_html_aa989ebb755986852177779cdf7bd8c85"><div class="ttname"><a href="a02280.html#aa989ebb755986852177779cdf7bd8c85">HyPar::dim_global</a></div><div class="ttdeci">int * dim_global</div><div class="ttdef"><b>Definition:</b> <a href="a00986_source.html#l00033">hypar.h:33</a></div></div>
<div class="ttc" id="a01100_html_a523947ce4fa7128c4c767163953253b9"><div class="ttname"><a href="a01100.html#a523947ce4fa7128c4c767163953253b9">SimulationObject::solver</a></div><div class="ttdeci">HyPar solver</div><div class="ttdef"><b>Definition:</b> <a href="a01100_source.html#l00026">simulation_object.h:26</a></div></div>
<div class="ttc" id="a02408_html_a1fde282f4347462c9c2dd34aac2ad998"><div class="ttname"><a href="a02408.html#a1fde282f4347462c9c2dd34aac2ad998">SparseGridsSimulation::m_is_periodic</a></div><div class="ttdeci">std::vector&lt; bool &gt; m_is_periodic</div><div class="ttdef"><b>Definition:</b> <a href="a01106_source.html#l00222">sparse_grids_simulation.h:222</a></div></div>
<div class="ttc" id="a02408_html_af3c229deae2a8e788c823dcc6f020b65"><div class="ttname"><a href="a02408.html#af3c229deae2a8e788c823dcc6f020b65">SparseGridsSimulation::m_ndims</a></div><div class="ttdeci">int m_ndims</div><div class="ttdef"><b>Definition:</b> <a href="a01106_source.html#l00215">sparse_grids_simulation.h:215</a></div></div>
<div class="ttc" id="a02408_html_a00beed94b3f705d20db508533bfc0fc0"><div class="ttname"><a href="a02408.html#a00beed94b3f705d20db508533bfc0fc0">SparseGridsSimulation::allocateDataArrays</a></div><div class="ttdeci">void allocateDataArrays(const GridDimensions &amp;a_dim, const int a_nvars, double **const a_u, const int a_ngpt=0)</div><div class="ttdef"><b>Definition:</b> <a href="a01106_source.html#l00358">sparse_grids_simulation.h:358</a></div></div>
<div class="ttc" id="a01010_html_a4293421dad25c62114f4a7453d6376aa"><div class="ttname"><a href="a01010.html#a4293421dad25c62114f4a7453d6376aa">InterpolateGlobalnDVar</a></div><div class="ttdeci">int InterpolateGlobalnDVar(const int *const, double **const, const int *const, double *const, const int, const int, const int, const int *const)</div><div class="ttdef"><b>Definition:</b> <a href="a01457_source.html#l00317">InterpolateGlobalnDVar.c:317</a></div></div>
<div class="ttc" id="a02408_html_ac6a822dc76382e4027cf94ac3e510056"><div class="ttname"><a href="a02408.html#ac6a822dc76382e4027cf94ac3e510056">SparseGridsSimulation::m_rank</a></div><div class="ttdeci">int m_rank</div><div class="ttdef"><b>Definition:</b> <a href="a01106_source.html#l00216">sparse_grids_simulation.h:216</a></div></div>
<div class="ttc" id="a01100_html_a4afd2c7b3eb8fda452474ebdbe71c8c0"><div class="ttname"><a href="a01100.html#a4afd2c7b3eb8fda452474ebdbe71c8c0">SimulationObject::mpi</a></div><div class="ttdeci">MPIVariables mpi</div><div class="ttdef"><b>Definition:</b> <a href="a01100_source.html#l00025">simulation_object.h:25</a></div></div>
<div class="ttc" id="a02264_html_a53cafdf187fdf401cda2700b0c2f223c"><div class="ttname"><a href="a02264.html#a53cafdf187fdf401cda2700b0c2f223c">StdVecOps::copyFrom</a></div><div class="ttdeci">void copyFrom(std::vector&lt; int &gt; &amp;a_iv, const int *const a_iv_carr, int a_n)</div><div class="ttdef"><b>Definition:</b> <a href="a01109_source.html#l00036">std_vec_ops.h:36</a></div></div>
<div class="ttc" id="a02280_html_a38e0371f331cecbe63a77fa03e202afe"><div class="ttname"><a href="a02280.html#a38e0371f331cecbe63a77fa03e202afe">HyPar::dim_local</a></div><div class="ttdeci">int * dim_local</div><div class="ttdef"><b>Definition:</b> <a href="a00986_source.html#l00037">hypar.h:37</a></div></div>
<div class="ttc" id="a02280_html_ae8f6d2fd6490d3153cb4133bf183a404"><div class="ttname"><a href="a02280.html#ae8f6d2fd6490d3153cb4133bf183a404">HyPar::nvars</a></div><div class="ttdeci">int nvars</div><div class="ttdef"><b>Definition:</b> <a href="a00986_source.html#l00029">hypar.h:29</a></div></div>
<div class="ttc" id="a02280_html_aafc992b5fa79d5a4036024615d03bce6"><div class="ttname"><a href="a02280.html#aafc992b5fa79d5a4036024615d03bce6">HyPar::ghosts</a></div><div class="ttdeci">int ghosts</div><div class="ttdef"><b>Definition:</b> <a href="a00986_source.html#l00052">hypar.h:52</a></div></div>
<div class="ttc" id="a01022_html_a81ef82bfd40dff69eb5b975c102133f2"><div class="ttname"><a href="a01022.html#a81ef82bfd40dff69eb5b975c102133f2">MPIGatherArraynDwGhosts</a></div><div class="ttdeci">int MPIGatherArraynDwGhosts(int, void *, double *, double *, int *, int *, int, int)</div><div class="ttdef"><b>Definition:</b> <a href="a01481_source.html#l00115">MPIGatherArraynD.c:115</a></div></div>
<div class="ttc" id="a01106_html_a00167df288a1ca2c6c32af8d911975e0"><div class="ttname"><a href="a01106.html#a00167df288a1ca2c6c32af8d911975e0">GridDimensions</a></div><div class="ttdeci">std::vector&lt; int &gt; GridDimensions</div><div class="ttdef"><b>Definition:</b> <a href="a01106_source.html#l00020">sparse_grids_simulation.h:20</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a20303c6aa17833ad691479008c2ce676"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a20303c6aa17833ad691479008c2ce676">&#9670;&nbsp;</a></span>interpolateGrid()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void interpolateGrid </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="a01100.html#a02400">SimulationObject</a> * const&#160;</td>
          <td class="paramname"><em>a_dst</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="a01100.html#a02400">SimulationObject</a> * const&#160;</td>
          <td class="paramname"><em>a_src</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Interpolate data from one simulation object to another</p>
<p>Interpolate grid coordinates from one grid to another. Note that along each dimension, the ratio of the number of grid points in the source grid and that in the destination grid must be an integer power of 2 (negative or positive).</p>
<p>Since the source and destination grids may have different processor layouts, the interpolation is carried out on rank 0 by allocating global arrays on it. Therefore, this function is <em>not</em> scalable. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">a_dst</td><td>Destination object </td></tr>
    <tr><td class="paramname">a_src</td><td>Source object </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="a02174_source.html#l00020">20</a> of file <a class="el" href="a02174_source.html">SparseGridsInterpolateGrid.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;{</div><div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;  <span class="comment">/* get the source and destination grid dimensions */</span></div><div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;  <a class="code" href="a01106.html#a00167df288a1ca2c6c32af8d911975e0">GridDimensions</a> dim_src, dim_dst;</div><div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;  <a class="code" href="a02264.html#a53cafdf187fdf401cda2700b0c2f223c">StdVecOps::copyFrom</a>(dim_src, a_src-&gt;<a class="code" href="a01100.html#a523947ce4fa7128c4c767163953253b9">solver</a>.<a class="code" href="a02280.html#aa989ebb755986852177779cdf7bd8c85">dim_global</a>, <a class="code" href="a02408.html#af3c229deae2a8e788c823dcc6f020b65">m_ndims</a>);</div><div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;  <a class="code" href="a02264.html#a53cafdf187fdf401cda2700b0c2f223c">StdVecOps::copyFrom</a>(dim_dst, a_dst-&gt;<a class="code" href="a01100.html#a523947ce4fa7128c4c767163953253b9">solver</a>.<a class="code" href="a02280.html#aa989ebb755986852177779cdf7bd8c85">dim_global</a>, <a class="code" href="a02408.html#af3c229deae2a8e788c823dcc6f020b65">m_ndims</a>);</div><div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;</div><div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;  <span class="comment">/* gather the source on rank 0 */</span></div><div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;  <span class="keywordtype">double</span>* xg_src = NULL;</div><div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;  <span class="keywordflow">if</span> (!<a class="code" href="a02408.html#ac6a822dc76382e4027cf94ac3e510056">m_rank</a>) <a class="code" href="a02408.html#a77a47bfc5b17b652a0ca888561f493e4">allocateGridArrays</a>(dim_src, &amp;xg_src);</div><div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;  {</div><div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;    <span class="keywordtype">int</span> offset_global, offset_local;</div><div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;    offset_global = offset_local = 0;</div><div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> d=0; d&lt;<a class="code" href="a02408.html#af3c229deae2a8e788c823dcc6f020b65">m_ndims</a>; d++) {</div><div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;      <a class="code" href="a01022.html#ac4c9e0736d7419f96307c6e6298d3f45">MPIGatherArray1D</a>(  (<span class="keywordtype">void</span>*) &amp;(a_src-&gt;<a class="code" href="a01100.html#a4afd2c7b3eb8fda452474ebdbe71c8c0">mpi</a>),</div><div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;                         (a_src-&gt;<a class="code" href="a01100.html#a4afd2c7b3eb8fda452474ebdbe71c8c0">mpi</a>.<a class="code" href="a01028.html#a6cfd95afd0afebd625b889fb6e58371c">rank</a> ? NULL : &amp;xg_src[offset_global]),</div><div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;                         &amp;(a_src-&gt;<a class="code" href="a01100.html#a523947ce4fa7128c4c767163953253b9">solver</a>.<a class="code" href="a02280.html#a711aad4cbe735871dd9e91ab575c878b">x</a>[offset_local+a_src-&gt;<a class="code" href="a01100.html#a523947ce4fa7128c4c767163953253b9">solver</a>.<a class="code" href="a02280.html#aafc992b5fa79d5a4036024615d03bce6">ghosts</a>]),</div><div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;                         a_src-&gt;<a class="code" href="a01100.html#a4afd2c7b3eb8fda452474ebdbe71c8c0">mpi</a>.<a class="code" href="a01028.html#a481013ba007a99a4237cde5eeb3c9a29">is</a>[d],</div><div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;                         a_src-&gt;<a class="code" href="a01100.html#a4afd2c7b3eb8fda452474ebdbe71c8c0">mpi</a>.<a class="code" href="a01028.html#a7602de5ebb1b59ec35217e78a35a531e">ie</a>[d],</div><div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;                         a_src-&gt;<a class="code" href="a01100.html#a523947ce4fa7128c4c767163953253b9">solver</a>.<a class="code" href="a02280.html#a38e0371f331cecbe63a77fa03e202afe">dim_local</a>[d],</div><div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;                         0 );</div><div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;      offset_global += a_src-&gt;<a class="code" href="a01100.html#a523947ce4fa7128c4c767163953253b9">solver</a>.<a class="code" href="a02280.html#aa989ebb755986852177779cdf7bd8c85">dim_global</a>[d];</div><div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;      offset_local  += a_src-&gt;<a class="code" href="a01100.html#a523947ce4fa7128c4c767163953253b9">solver</a>.<a class="code" href="a02280.html#a38e0371f331cecbe63a77fa03e202afe">dim_local</a> [d] + 2*a_src-&gt;<a class="code" href="a01100.html#a523947ce4fa7128c4c767163953253b9">solver</a>.<a class="code" href="a02280.html#aafc992b5fa79d5a4036024615d03bce6">ghosts</a>;</div><div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;    }</div><div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;  }</div><div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;</div><div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;  <span class="comment">/* now do the interpolation, dimension-by-dimension */</span></div><div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;  <span class="keywordtype">double</span> *xg_dst = NULL;</div><div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;  <span class="keywordflow">if</span> (!<a class="code" href="a02408.html#ac6a822dc76382e4027cf94ac3e510056">m_rank</a>) {</div><div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;</div><div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;    <a class="code" href="a01106.html#a00167df288a1ca2c6c32af8d911975e0">GridDimensions</a> dim_to(<a class="code" href="a02408.html#af3c229deae2a8e788c823dcc6f020b65">m_ndims</a>,0);</div><div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;    <a class="code" href="a01106.html#a00167df288a1ca2c6c32af8d911975e0">GridDimensions</a> dim_from(<a class="code" href="a02408.html#af3c229deae2a8e788c823dcc6f020b65">m_ndims</a>,0);</div><div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;</div><div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;    <span class="keywordtype">double</span>* x_from;</div><div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;    <span class="keywordtype">double</span>* x_to;</div><div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;</div><div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;    dim_to = dim_src;</div><div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;    x_to = xg_src;</div><div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;    x_from = NULL;</div><div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;</div><div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> dir = 0; dir &lt; <a class="code" href="a02408.html#af3c229deae2a8e788c823dcc6f020b65">m_ndims</a>; dir++) {</div><div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;</div><div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;      dim_from = dim_to;</div><div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;      dim_to[dir] = dim_dst[dir];</div><div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;</div><div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;      <span class="keywordflow">if</span> (dim_from[dir] == dim_to[dir]) <span class="keywordflow">continue</span>;</div><div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;</div><div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;      <span class="keywordtype">double</span> fac = (dim_to[dir] &gt; dim_from[dir] ? </div><div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;                        (double)dim_to[dir]/(<span class="keywordtype">double</span>)dim_from[dir] </div><div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;                      : (double)dim_from[dir]/(<span class="keywordtype">double</span>)dim_to[dir] );</div><div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;      <span class="keywordflow">if</span> (!<a class="code" href="a02408.html#ad209b51783ddb3be5497d6cbe6a3e8af">isPowerOfTwo</a>((<span class="keywordtype">int</span>)fac)) {</div><div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;        fprintf(stderr,<span class="stringliteral">&quot;Error in SparseGridsSimulation::interpolate() - \n&quot;</span>);</div><div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;        fprintf(stderr,<span class="stringliteral">&quot;  refinement/coarsening factor not a power of 2!\n&quot;</span>);</div><div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;        exit(1);</div><div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;      }</div><div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;</div><div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;      <span class="keywordflow">if</span> (x_from != NULL) free(x_from);</div><div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;      x_from = x_to;</div><div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;</div><div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;      <a class="code" href="a02408.html#a77a47bfc5b17b652a0ca888561f493e4">allocateGridArrays</a>(dim_to, &amp;x_to);</div><div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;      <span class="keywordflow">if</span> (dim_to[dir] &lt; dim_from[dir]) {</div><div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;        <a class="code" href="a02408.html#aef4dc57f1045e5594a6b12d0d5415023">coarsenGrid1D</a>(dim_from, dim_to, x_from, x_to, dir);</div><div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;      } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;        <a class="code" href="a02408.html#a895ea7a442b045e20ef7b41735b48e5e">refineGrid1D</a>(dim_from, dim_to, x_from, x_to, dir);</div><div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;      }</div><div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;  </div><div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;    }</div><div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;</div><div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;    <span class="comment">/* dim_to should be equal to dim_dst now */</span></div><div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> d = 0; d &lt; <a class="code" href="a02408.html#af3c229deae2a8e788c823dcc6f020b65">m_ndims</a>; d++) {</div><div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;      <span class="keywordflow">if</span> (dim_to[d] != dim_dst[d]) {</div><div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;        fprintf(stderr,<span class="stringliteral">&quot;Error in SparseGridsSimulation::interpolate() - \n&quot;</span>);</div><div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;        fprintf(stderr,<span class="stringliteral">&quot;  dim_to[%d] != dim_dst[%d]!\n&quot;</span>, d, d);</div><div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;        exit(1);</div><div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;      }</div><div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;    }</div><div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;</div><div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;    <span class="keywordflow">if</span> (x_from != NULL) free(x_from);</div><div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;    xg_dst = x_to;</div><div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;</div><div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;  }</div><div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;</div><div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;  <span class="comment">/* partition the destination */</span></div><div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;  <span class="keywordtype">int</span> offset_global = 0, offset_local = 0;</div><div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> d=0; d&lt;<a class="code" href="a02408.html#af3c229deae2a8e788c823dcc6f020b65">m_ndims</a>; d++) {</div><div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;    <a class="code" href="a01022.html#a77f4e7a03979d9fabce2a536a113ff42">MPIPartitionArray1D</a>(  (<span class="keywordtype">void</span>*) &amp;(a_dst-&gt;<a class="code" href="a01100.html#a4afd2c7b3eb8fda452474ebdbe71c8c0">mpi</a>),</div><div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;                          (a_dst-&gt;<a class="code" href="a01100.html#a4afd2c7b3eb8fda452474ebdbe71c8c0">mpi</a>.<a class="code" href="a01028.html#a6cfd95afd0afebd625b889fb6e58371c">rank</a> ? NULL : &amp;xg_dst[offset_global]),</div><div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;                          &amp;(a_dst-&gt;<a class="code" href="a01100.html#a523947ce4fa7128c4c767163953253b9">solver</a>.<a class="code" href="a02280.html#a711aad4cbe735871dd9e91ab575c878b">x</a>[offset_local+a_dst-&gt;<a class="code" href="a01100.html#a523947ce4fa7128c4c767163953253b9">solver</a>.<a class="code" href="a02280.html#aafc992b5fa79d5a4036024615d03bce6">ghosts</a>]),</div><div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;                          a_dst-&gt;<a class="code" href="a01100.html#a4afd2c7b3eb8fda452474ebdbe71c8c0">mpi</a>.<a class="code" href="a01028.html#a481013ba007a99a4237cde5eeb3c9a29">is</a>[d],</div><div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;                          a_dst-&gt;<a class="code" href="a01100.html#a4afd2c7b3eb8fda452474ebdbe71c8c0">mpi</a>.<a class="code" href="a01028.html#a7602de5ebb1b59ec35217e78a35a531e">ie</a>[d],</div><div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;                          a_dst-&gt;<a class="code" href="a01100.html#a523947ce4fa7128c4c767163953253b9">solver</a>.<a class="code" href="a02280.html#a38e0371f331cecbe63a77fa03e202afe">dim_local</a>[d],</div><div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;                          0);</div><div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;    offset_global += a_dst-&gt;<a class="code" href="a01100.html#a523947ce4fa7128c4c767163953253b9">solver</a>.<a class="code" href="a02280.html#aa989ebb755986852177779cdf7bd8c85">dim_global</a>[d];</div><div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;    offset_local  += a_dst-&gt;<a class="code" href="a01100.html#a523947ce4fa7128c4c767163953253b9">solver</a>.<a class="code" href="a02280.html#a38e0371f331cecbe63a77fa03e202afe">dim_local</a> [d] + 2*a_dst-&gt;<a class="code" href="a01100.html#a523947ce4fa7128c4c767163953253b9">solver</a>.<a class="code" href="a02280.html#aafc992b5fa79d5a4036024615d03bce6">ghosts</a>;</div><div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;  }</div><div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;</div><div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;  <span class="keywordflow">if</span> (!<a class="code" href="a02408.html#ac6a822dc76382e4027cf94ac3e510056">m_rank</a>) {</div><div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;    free(xg_dst);</div><div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;  }</div><div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;</div><div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;  <span class="comment">/* exchange MPI-boundary values of x between processors */</span></div><div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;  {</div><div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;    <span class="keywordtype">int</span> offset = 0;</div><div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> d = 0; d &lt; <a class="code" href="a02408.html#af3c229deae2a8e788c823dcc6f020b65">m_ndims</a>; d++) {</div><div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;      <a class="code" href="a01022.html#ac2f0cce702a9ce439753286ce227c7a2">MPIExchangeBoundaries1D</a>(  (<span class="keywordtype">void</span>*) &amp;(a_dst-&gt;<a class="code" href="a01100.html#a4afd2c7b3eb8fda452474ebdbe71c8c0">mpi</a>),</div><div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;                                &amp;(a_dst-&gt;<a class="code" href="a01100.html#a523947ce4fa7128c4c767163953253b9">solver</a>.<a class="code" href="a02280.html#a711aad4cbe735871dd9e91ab575c878b">x</a>[offset]),</div><div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;                                a_dst-&gt;<a class="code" href="a01100.html#a523947ce4fa7128c4c767163953253b9">solver</a>.<a class="code" href="a02280.html#a38e0371f331cecbe63a77fa03e202afe">dim_local</a>[d],</div><div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;                                a_dst-&gt;<a class="code" href="a01100.html#a523947ce4fa7128c4c767163953253b9">solver</a>.<a class="code" href="a02280.html#aafc992b5fa79d5a4036024615d03bce6">ghosts</a>,</div><div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;                                d,</div><div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;                                <a class="code" href="a02408.html#af3c229deae2a8e788c823dcc6f020b65">m_ndims</a>);</div><div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;      offset += (a_dst-&gt;<a class="code" href="a01100.html#a523947ce4fa7128c4c767163953253b9">solver</a>.<a class="code" href="a02280.html#a38e0371f331cecbe63a77fa03e202afe">dim_local</a>[d] + 2*a_dst-&gt;<a class="code" href="a01100.html#a523947ce4fa7128c4c767163953253b9">solver</a>.<a class="code" href="a02280.html#aafc992b5fa79d5a4036024615d03bce6">ghosts</a>);</div><div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;    }</div><div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;  }</div><div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;  <span class="comment">/* fill in ghost values of x at physical boundaries by extrapolation */</span></div><div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;  {</div><div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;    <span class="keywordtype">int</span> offset = 0;</div><div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> d = 0; d &lt; <a class="code" href="a02408.html#af3c229deae2a8e788c823dcc6f020b65">m_ndims</a>; d++) {</div><div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;      <span class="keywordtype">double</span>* X       = &amp;(a_dst-&gt;<a class="code" href="a01100.html#a523947ce4fa7128c4c767163953253b9">solver</a>.<a class="code" href="a02280.html#a711aad4cbe735871dd9e91ab575c878b">x</a>[offset]);</div><div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;      <span class="keywordtype">int</span>*    dim     = a_dst-&gt;<a class="code" href="a01100.html#a523947ce4fa7128c4c767163953253b9">solver</a>.<a class="code" href="a02280.html#a38e0371f331cecbe63a77fa03e202afe">dim_local</a>;</div><div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;      <span class="keywordtype">int</span>     ghosts  = a_dst-&gt;<a class="code" href="a01100.html#a523947ce4fa7128c4c767163953253b9">solver</a>.<a class="code" href="a02280.html#aafc992b5fa79d5a4036024615d03bce6">ghosts</a>;</div><div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;      <span class="keywordflow">if</span> (a_dst-&gt;<a class="code" href="a01100.html#a4afd2c7b3eb8fda452474ebdbe71c8c0">mpi</a>.<a class="code" href="a01028.html#aa3c28612a64b8a97bde66b720e15c700">ip</a>[d] == 0) {</div><div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;        <span class="comment">/* fill left boundary along this dimension */</span></div><div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; ghosts; i++) {</div><div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;          <span class="keywordtype">int</span> delta = ghosts - i;</div><div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;          X[i] = X[ghosts] + ((double) delta) * (X[ghosts]-X[ghosts+1]);</div><div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;        }</div><div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;      }</div><div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;      <span class="keywordflow">if</span> (a_dst-&gt;<a class="code" href="a01100.html#a4afd2c7b3eb8fda452474ebdbe71c8c0">mpi</a>.<a class="code" href="a01028.html#aa3c28612a64b8a97bde66b720e15c700">ip</a>[d] == a_dst-&gt;<a class="code" href="a01100.html#a4afd2c7b3eb8fda452474ebdbe71c8c0">mpi</a>.<a class="code" href="a01028.html#a0be0f30a83bc3f3d9f6ee3a36bbf2716">iproc</a>[d]-1) {</div><div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;        <span class="comment">/* fill right boundary along this dimension */</span></div><div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = dim[d]+ghosts; i &lt; dim[d]+2*ghosts; i++) {</div><div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;          <span class="keywordtype">int</span> delta = i - (dim[d]+ghosts-1);</div><div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;          X[i] =  X[dim[d]+ghosts-1] </div><div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;                  + ((double) delta) * (X[dim[d]+ghosts-1]-X[dim[d]+ghosts-2]);</div><div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;        }</div><div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;      }</div><div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;      offset  += (dim[d] + 2*ghosts);</div><div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;    }</div><div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;  }</div><div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;  <span class="keywordflow">return</span>;</div><div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;}</div><div class="ttc" id="a01022_html_ac2f0cce702a9ce439753286ce227c7a2"><div class="ttname"><a href="a01022.html#ac2f0cce702a9ce439753286ce227c7a2">MPIExchangeBoundaries1D</a></div><div class="ttdeci">int MPIExchangeBoundaries1D(void *, double *, int, int, int, int)</div><div class="ttdef"><b>Definition:</b> <a href="a01469_source.html#l00032">MPIExchangeBoundaries1D.c:32</a></div></div>
<div class="ttc" id="a02280_html_aa989ebb755986852177779cdf7bd8c85"><div class="ttname"><a href="a02280.html#aa989ebb755986852177779cdf7bd8c85">HyPar::dim_global</a></div><div class="ttdeci">int * dim_global</div><div class="ttdef"><b>Definition:</b> <a href="a00986_source.html#l00033">hypar.h:33</a></div></div>
<div class="ttc" id="a01028_html_a0be0f30a83bc3f3d9f6ee3a36bbf2716"><div class="ttname"><a href="a01028.html#a0be0f30a83bc3f3d9f6ee3a36bbf2716">MPIVariables::iproc</a></div><div class="ttdeci">int * iproc</div><div class="ttdef"><b>Definition:</b> <a href="a01028_source.html#l00027">mpivars_struct.h:27</a></div></div>
<div class="ttc" id="a01100_html_a523947ce4fa7128c4c767163953253b9"><div class="ttname"><a href="a01100.html#a523947ce4fa7128c4c767163953253b9">SimulationObject::solver</a></div><div class="ttdeci">HyPar solver</div><div class="ttdef"><b>Definition:</b> <a href="a01100_source.html#l00026">simulation_object.h:26</a></div></div>
<div class="ttc" id="a02408_html_af3c229deae2a8e788c823dcc6f020b65"><div class="ttname"><a href="a02408.html#af3c229deae2a8e788c823dcc6f020b65">SparseGridsSimulation::m_ndims</a></div><div class="ttdeci">int m_ndims</div><div class="ttdef"><b>Definition:</b> <a href="a01106_source.html#l00215">sparse_grids_simulation.h:215</a></div></div>
<div class="ttc" id="a02408_html_ad209b51783ddb3be5497d6cbe6a3e8af"><div class="ttname"><a href="a02408.html#ad209b51783ddb3be5497d6cbe6a3e8af">SparseGridsSimulation::isPowerOfTwo</a></div><div class="ttdeci">bool isPowerOfTwo(int x)</div><div class="ttdef"><b>Definition:</b> <a href="a01106_source.html#l00317">sparse_grids_simulation.h:317</a></div></div>
<div class="ttc" id="a01028_html_aa3c28612a64b8a97bde66b720e15c700"><div class="ttname"><a href="a01028.html#aa3c28612a64b8a97bde66b720e15c700">MPIVariables::ip</a></div><div class="ttdeci">int * ip</div><div class="ttdef"><b>Definition:</b> <a href="a01028_source.html#l00028">mpivars_struct.h:28</a></div></div>
<div class="ttc" id="a02408_html_ac6a822dc76382e4027cf94ac3e510056"><div class="ttname"><a href="a02408.html#ac6a822dc76382e4027cf94ac3e510056">SparseGridsSimulation::m_rank</a></div><div class="ttdeci">int m_rank</div><div class="ttdef"><b>Definition:</b> <a href="a01106_source.html#l00216">sparse_grids_simulation.h:216</a></div></div>
<div class="ttc" id="a01100_html_a4afd2c7b3eb8fda452474ebdbe71c8c0"><div class="ttname"><a href="a01100.html#a4afd2c7b3eb8fda452474ebdbe71c8c0">SimulationObject::mpi</a></div><div class="ttdeci">MPIVariables mpi</div><div class="ttdef"><b>Definition:</b> <a href="a01100_source.html#l00025">simulation_object.h:25</a></div></div>
<div class="ttc" id="a01028_html_a481013ba007a99a4237cde5eeb3c9a29"><div class="ttname"><a href="a01028.html#a481013ba007a99a4237cde5eeb3c9a29">MPIVariables::is</a></div><div class="ttdeci">int * is</div><div class="ttdef"><b>Definition:</b> <a href="a01028_source.html#l00029">mpivars_struct.h:29</a></div></div>
<div class="ttc" id="a02408_html_a895ea7a442b045e20ef7b41735b48e5e"><div class="ttname"><a href="a02408.html#a895ea7a442b045e20ef7b41735b48e5e">SparseGridsSimulation::refineGrid1D</a></div><div class="ttdeci">void refineGrid1D(const GridDimensions &amp;, const GridDimensions &amp;, const double *const, double *const, int)</div><div class="ttdef"><b>Definition:</b> <a href="a02174_source.html#l00238">SparseGridsInterpolateGrid.cpp:238</a></div></div>
<div class="ttc" id="a01022_html_a77f4e7a03979d9fabce2a536a113ff42"><div class="ttname"><a href="a01022.html#a77f4e7a03979d9fabce2a536a113ff42">MPIPartitionArray1D</a></div><div class="ttdeci">int MPIPartitionArray1D(void *, double *, double *, int, int, int, int)</div><div class="ttdef"><b>Definition:</b> <a href="a01505_source.html#l00025">MPIPartitionArray1D.c:25</a></div></div>
<div class="ttc" id="a02280_html_a711aad4cbe735871dd9e91ab575c878b"><div class="ttname"><a href="a02280.html#a711aad4cbe735871dd9e91ab575c878b">HyPar::x</a></div><div class="ttdeci">double * x</div><div class="ttdef"><b>Definition:</b> <a href="a00986_source.html#l00107">hypar.h:107</a></div></div>
<div class="ttc" id="a02264_html_a53cafdf187fdf401cda2700b0c2f223c"><div class="ttname"><a href="a02264.html#a53cafdf187fdf401cda2700b0c2f223c">StdVecOps::copyFrom</a></div><div class="ttdeci">void copyFrom(std::vector&lt; int &gt; &amp;a_iv, const int *const a_iv_carr, int a_n)</div><div class="ttdef"><b>Definition:</b> <a href="a01109_source.html#l00036">std_vec_ops.h:36</a></div></div>
<div class="ttc" id="a02408_html_aef4dc57f1045e5594a6b12d0d5415023"><div class="ttname"><a href="a02408.html#aef4dc57f1045e5594a6b12d0d5415023">SparseGridsSimulation::coarsenGrid1D</a></div><div class="ttdeci">void coarsenGrid1D(const GridDimensions &amp;, const GridDimensions &amp;, const double *const, double *const, int)</div><div class="ttdef"><b>Definition:</b> <a href="a02174_source.html#l00168">SparseGridsInterpolateGrid.cpp:168</a></div></div>
<div class="ttc" id="a02408_html_a77a47bfc5b17b652a0ca888561f493e4"><div class="ttname"><a href="a02408.html#a77a47bfc5b17b652a0ca888561f493e4">SparseGridsSimulation::allocateGridArrays</a></div><div class="ttdeci">void allocateGridArrays(const GridDimensions &amp;a_dim, double **const a_x, const int a_ngpt=0)</div><div class="ttdef"><b>Definition:</b> <a href="a01106_source.html#l00343">sparse_grids_simulation.h:343</a></div></div>
<div class="ttc" id="a01028_html_a7602de5ebb1b59ec35217e78a35a531e"><div class="ttname"><a href="a01028.html#a7602de5ebb1b59ec35217e78a35a531e">MPIVariables::ie</a></div><div class="ttdeci">int * ie</div><div class="ttdef"><b>Definition:</b> <a href="a01028_source.html#l00029">mpivars_struct.h:29</a></div></div>
<div class="ttc" id="a01022_html_ac4c9e0736d7419f96307c6e6298d3f45"><div class="ttname"><a href="a01022.html#ac4c9e0736d7419f96307c6e6298d3f45">MPIGatherArray1D</a></div><div class="ttdeci">int MPIGatherArray1D(void *, double *, double *, int, int, int, int)</div><div class="ttdef"><b>Definition:</b> <a href="a01478_source.html#l00026">MPIGatherArray1D.c:26</a></div></div>
<div class="ttc" id="a02280_html_a38e0371f331cecbe63a77fa03e202afe"><div class="ttname"><a href="a02280.html#a38e0371f331cecbe63a77fa03e202afe">HyPar::dim_local</a></div><div class="ttdeci">int * dim_local</div><div class="ttdef"><b>Definition:</b> <a href="a00986_source.html#l00037">hypar.h:37</a></div></div>
<div class="ttc" id="a02280_html_aafc992b5fa79d5a4036024615d03bce6"><div class="ttname"><a href="a02280.html#aafc992b5fa79d5a4036024615d03bce6">HyPar::ghosts</a></div><div class="ttdeci">int ghosts</div><div class="ttdef"><b>Definition:</b> <a href="a00986_source.html#l00052">hypar.h:52</a></div></div>
<div class="ttc" id="a01028_html_a6cfd95afd0afebd625b889fb6e58371c"><div class="ttname"><a href="a01028.html#a6cfd95afd0afebd625b889fb6e58371c">MPIVariables::rank</a></div><div class="ttdeci">int rank</div><div class="ttdef"><b>Definition:</b> <a href="a01028_source.html#l00025">mpivars_struct.h:25</a></div></div>
<div class="ttc" id="a01106_html_a00167df288a1ca2c6c32af8d911975e0"><div class="ttname"><a href="a01106.html#a00167df288a1ca2c6c32af8d911975e0">GridDimensions</a></div><div class="ttdeci">std::vector&lt; int &gt; GridDimensions</div><div class="ttdef"><b>Definition:</b> <a href="a01106_source.html#l00020">sparse_grids_simulation.h:20</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="aef4dc57f1045e5594a6b12d0d5415023"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aef4dc57f1045e5594a6b12d0d5415023">&#9670;&nbsp;</a></span>coarsenGrid1D()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void coarsenGrid1D </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="a01106.html#a00167df288a1ca2c6c32af8d911975e0">GridDimensions</a> &amp;&#160;</td>
          <td class="paramname"><em>a_dim_src</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="a01106.html#a00167df288a1ca2c6c32af8d911975e0">GridDimensions</a> &amp;&#160;</td>
          <td class="paramname"><em>a_dim_dst</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double * const&#160;</td>
          <td class="paramname"><em>a_x_src</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double * const&#160;</td>
          <td class="paramname"><em>a_x_dst</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>a_dir</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Coarsen along a given dimension</p>
<p>Coarsen along a given dimension - the source and destination must have the same sizes along all other dimensions.</p>
<p>Note that the grid must <em>not</em> have any ghost points! </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">a_dim_src</td><td>Grid size of source data </td></tr>
    <tr><td class="paramname">a_dim_dst</td><td>Grid size of destination data </td></tr>
    <tr><td class="paramname">a_x_src</td><td>Source grid </td></tr>
    <tr><td class="paramname">a_x_dst</td><td>Destination grid </td></tr>
    <tr><td class="paramname">a_dir</td><td>Dimension along which to coarsen </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="a02174_source.html#l00168">168</a> of file <a class="el" href="a02174_source.html">SparseGridsInterpolateGrid.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;{</div><div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> d = 0; d &lt; <a class="code" href="a02408.html#af3c229deae2a8e788c823dcc6f020b65">m_ndims</a>; d++) {</div><div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;    <span class="keywordflow">if</span> ((d != a_dir) &amp;&amp; (a_dim_src[d] != a_dim_dst[d])) {</div><div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;      fprintf(stderr, <span class="stringliteral">&quot;Error in SparseGridsSimulation::coarsenGrid1D() -\n&quot;</span>);</div><div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;      fprintf(stderr, <span class="stringliteral">&quot; a_dim_src[%d] != a_dim_dst[%d]\n&quot;</span>, d, d);</div><div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;      exit(1);</div><div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;    }</div><div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;  }</div><div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;</div><div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;  <span class="keywordtype">int</span> n_src = a_dim_src[a_dir];</div><div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;  <span class="keywordtype">int</span> n_dst = a_dim_dst[a_dir];</div><div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;  <span class="keywordflow">if</span> (n_dst &gt; n_src) {</div><div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;    fprintf(stderr, <span class="stringliteral">&quot;Error in SparseGridsSimulation::coarsenGrid1D() -\n&quot;</span>);</div><div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;    fprintf(stderr, <span class="stringliteral">&quot; destination grid is finer than source grid along a_dir!\n&quot;</span>);</div><div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;    exit(1);</div><div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;  }</div><div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;</div><div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;  <span class="keywordtype">double</span> fac = ((double) n_src) / ((double) n_dst);</div><div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;  <span class="keywordtype">int</span> stride = (int) fac;</div><div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;  <span class="keywordflow">if</span> (std::abs(((<span class="keywordtype">double</span>)stride)-fac) &gt; <a class="code" href="a00965.html#abfd977805f9104d0141377f9b4ac954e">_MACHINE_ZERO_</a>) {</div><div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;    fprintf(stderr, <span class="stringliteral">&quot;Error in SparseGridsSimulation::coarsenGrid1D() -\n&quot;</span>);</div><div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;    fprintf(stderr, <span class="stringliteral">&quot;  non-integer coarsening factor!\n&quot;</span>);</div><div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;    exit(1);</div><div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;  }</div><div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;</div><div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">double</span>* x_src = a_x_src;</div><div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;  <span class="keywordtype">double</span>* x_dst = a_x_dst;</div><div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;</div><div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> d = 0; d &lt; <a class="code" href="a02408.html#af3c229deae2a8e788c823dcc6f020b65">m_ndims</a>; d++) {</div><div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;</div><div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;    <span class="keywordflow">if</span> (d == a_dir) {</div><div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;</div><div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; a_dim_dst[d]; i++) {</div><div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;        <span class="keywordtype">double</span> avg = 0;</div><div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j=stride*i; j&lt;stride*(i+1); j++) {</div><div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;          <span class="keywordflow">if</span> (j &gt;= n_src) {</div><div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;            fprintf(stderr, <span class="stringliteral">&quot;Error in SparseGridsSimulation::coarsenGrid1D() -\n&quot;</span>);</div><div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;            fprintf(stderr, <span class="stringliteral">&quot;  j &gt;= n_src!\n&quot;</span>);</div><div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;            exit(1);</div><div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;          }</div><div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;          avg += x_src[j];</div><div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;        }</div><div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;        avg /= (double) stride;</div><div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;        x_dst[i] = avg;</div><div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;      }</div><div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;</div><div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;    } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;</div><div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;      <a class="code" href="a00956.html#a89e8330d9e06dd0666c50833628a125c">_ArrayCopy1D_</a>(x_src, x_dst, a_dim_dst[d]);</div><div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;      </div><div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;    }</div><div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;</div><div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;    x_src += a_dim_src[d];</div><div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;    x_dst += a_dim_dst[d];</div><div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;  }</div><div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;  </div><div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;  <span class="keywordflow">return</span>;</div><div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;}</div><div class="ttc" id="a02408_html_af3c229deae2a8e788c823dcc6f020b65"><div class="ttname"><a href="a02408.html#af3c229deae2a8e788c823dcc6f020b65">SparseGridsSimulation::m_ndims</a></div><div class="ttdeci">int m_ndims</div><div class="ttdef"><b>Definition:</b> <a href="a01106_source.html#l00215">sparse_grids_simulation.h:215</a></div></div>
<div class="ttc" id="a00956_html_a89e8330d9e06dd0666c50833628a125c"><div class="ttname"><a href="a00956.html#a89e8330d9e06dd0666c50833628a125c">_ArrayCopy1D_</a></div><div class="ttdeci">#define _ArrayCopy1D_(x, y, size)</div><div class="ttdef"><b>Definition:</b> <a href="a00956_source.html#l00319">arrayfunctions.h:319</a></div></div>
<div class="ttc" id="a00965_html_abfd977805f9104d0141377f9b4ac954e"><div class="ttname"><a href="a00965.html#abfd977805f9104d0141377f9b4ac954e">_MACHINE_ZERO_</a></div><div class="ttdeci">#define _MACHINE_ZERO_</div><div class="ttdef"><b>Definition:</b> <a href="a00965_source.html#l00026">basic.h:26</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a895ea7a442b045e20ef7b41735b48e5e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a895ea7a442b045e20ef7b41735b48e5e">&#9670;&nbsp;</a></span>refineGrid1D()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void refineGrid1D </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="a01106.html#a00167df288a1ca2c6c32af8d911975e0">GridDimensions</a> &amp;&#160;</td>
          <td class="paramname"><em>a_dim_src</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="a01106.html#a00167df288a1ca2c6c32af8d911975e0">GridDimensions</a> &amp;&#160;</td>
          <td class="paramname"><em>a_dim_dst</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double * const&#160;</td>
          <td class="paramname"><em>a_x_src</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double * const&#160;</td>
          <td class="paramname"><em>a_x_dst</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>a_dir</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Refine along a given dimension</p>
<p>Refine along a given dimension - the source and destination must have the same sizes along all other dimensions.</p>
<p>Note that the grid must <em>not</em> have any ghost points! </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">a_dim_src</td><td>Grid size of source data </td></tr>
    <tr><td class="paramname">a_dim_dst</td><td>Grid size of destination data </td></tr>
    <tr><td class="paramname">a_x_src</td><td>Source grid </td></tr>
    <tr><td class="paramname">a_x_dst</td><td>Destination grid </td></tr>
    <tr><td class="paramname">a_dir</td><td>Dimension along which to refine </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="a02174_source.html#l00238">238</a> of file <a class="el" href="a02174_source.html">SparseGridsInterpolateGrid.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;{</div><div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> d = 0; d &lt; <a class="code" href="a02408.html#af3c229deae2a8e788c823dcc6f020b65">m_ndims</a>; d++) {</div><div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;    <span class="keywordflow">if</span> ((d != a_dir) &amp;&amp; (a_dim_src[d] != a_dim_dst[d])) {</div><div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;      fprintf(stderr, <span class="stringliteral">&quot;Error in SparseGridsSimulation::coarsenGrid1D() -\n&quot;</span>);</div><div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;      fprintf(stderr, <span class="stringliteral">&quot; a_dim_src[%d] != a_dim_dst[%d]\n&quot;</span>, d, d);</div><div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;      exit(1);</div><div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;    }</div><div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;  }</div><div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;</div><div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;  <span class="keywordtype">int</span> n_src = a_dim_src[a_dir];</div><div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;  <span class="keywordtype">int</span> n_dst = a_dim_dst[a_dir];</div><div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;  <span class="keywordflow">if</span> (n_dst &lt; n_src) {</div><div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;    fprintf(stderr, <span class="stringliteral">&quot;Error in SparseGridsSimulation::refineGrid1D() -\n&quot;</span>);</div><div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;    fprintf(stderr, <span class="stringliteral">&quot;  destination grid is coarser than source grid along a_dir!\n&quot;</span>);</div><div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;    exit(1);</div><div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;  }</div><div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;</div><div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;  <span class="keywordtype">double</span> fac = ((double) n_dst) / ((double) n_src);</div><div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;  <span class="keywordtype">int</span> stride = (int) fac;</div><div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;  <span class="keywordflow">if</span> (std::abs(((<span class="keywordtype">double</span>)stride)-fac) &gt; <a class="code" href="a00965.html#abfd977805f9104d0141377f9b4ac954e">_MACHINE_ZERO_</a>) {</div><div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;    fprintf(stderr, <span class="stringliteral">&quot;Error in SparseGridsSimulation::refineGrid1D() -\n&quot;</span>);</div><div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;    fprintf(stderr, <span class="stringliteral">&quot;  non-integer refinement factor!\n&quot;</span>);</div><div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;    exit(1);</div><div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;  }</div><div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;</div><div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;  <span class="keywordtype">int</span> offset = 0;</div><div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> d = 0; d &lt; a_dir; d++) offset += a_dim_src[d];</div><div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">double</span>* x_src = a_x_src + offset;</div><div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;  <span class="keywordtype">double</span>* x_dst = a_x_dst + offset;</div><div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;</div><div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;  fprintf(stderr, <span class="stringliteral">&quot;Error in SparseGridsSimulation::refineGrid1D() -\n&quot;</span>);</div><div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;  fprintf(stderr, <span class="stringliteral">&quot;  NOT YET IMPLEMENTED! Why do you need this?\n&quot;</span>);</div><div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;  exit(1);</div><div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;  </div><div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;  <span class="keywordflow">return</span>;</div><div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;}</div><div class="ttc" id="a02408_html_af3c229deae2a8e788c823dcc6f020b65"><div class="ttname"><a href="a02408.html#af3c229deae2a8e788c823dcc6f020b65">SparseGridsSimulation::m_ndims</a></div><div class="ttdeci">int m_ndims</div><div class="ttdef"><b>Definition:</b> <a href="a01106_source.html#l00215">sparse_grids_simulation.h:215</a></div></div>
<div class="ttc" id="a00965_html_abfd977805f9104d0141377f9b4ac954e"><div class="ttname"><a href="a00965.html#abfd977805f9104d0141377f9b4ac954e">_MACHINE_ZERO_</a></div><div class="ttdeci">#define _MACHINE_ZERO_</div><div class="ttdef"><b>Definition:</b> <a href="a00965_source.html#l00026">basic.h:26</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a2aba074a93f3c8800e268b85aa14a3a9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2aba074a93f3c8800e268b85aa14a3a9">&#9670;&nbsp;</a></span>fillGhostCells()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void fillGhostCells </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="a01106.html#a00167df288a1ca2c6c32af8d911975e0">GridDimensions</a> &amp;&#160;</td>
          <td class="paramname"><em>a_dim</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>a_ngpt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double * const&#160;</td>
          <td class="paramname"><em>a_u</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>a_nvars</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Fill ghost cells for interpolation</p>
<p>Fill the ghost cells of a solution. Note that the solution array <em>must</em> be a global one (not one that is partitioned among MPI ranks). This is not a parallel operation (it will execute independently on multiple MPI ranks, if called by multiple processes).</p>
<p>For periodicity along any dimension, the ghost cells are filled appropriately from the other side of the domain. Otherwise, the interior data is extrapolated by a 4th order polynomial (assuming uniform grid spacing). </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">a_dim</td><td>grid dimensions of solution </td></tr>
    <tr><td class="paramname">a_ngpt</td><td>number of ghost cells </td></tr>
    <tr><td class="paramname">a_u</td><td>solution array </td></tr>
    <tr><td class="paramname">a_nvars</td><td>number of vector components of the solution </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="a02159_source.html#l00018">18</a> of file <a class="el" href="a02159_source.html">SparseGridsFillGhostCells.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;{</div><div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="a02408.html#a1fde282f4347462c9c2dd34aac2ad998">m_is_periodic</a>.size() != <a class="code" href="a02408.html#af3c229deae2a8e788c823dcc6f020b65">m_ndims</a>) {</div><div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;    fprintf(stderr, <span class="stringliteral">&quot;Error in SparseGridsSimulation::fillGhostCells() -\n&quot;</span>);</div><div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;    fprintf(stderr, <span class="stringliteral">&quot;m_is_periodic.size() != m_ndims \n&quot;</span>);</div><div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;    exit(1);</div><div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;  }</div><div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;</div><div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> d = 0; d &lt; <a class="code" href="a02408.html#af3c229deae2a8e788c823dcc6f020b65">m_ndims</a>; d++) {</div><div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;</div><div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;    <span class="keywordtype">int</span> bounds[<a class="code" href="a02408.html#af3c229deae2a8e788c823dcc6f020b65">m_ndims</a>];</div><div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;    <a class="code" href="a00956.html#a89e8330d9e06dd0666c50833628a125c">_ArrayCopy1D_</a>(a_dim, bounds, <a class="code" href="a02408.html#af3c229deae2a8e788c823dcc6f020b65">m_ndims</a>);</div><div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;    bounds[d] = a_ngpt;</div><div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;</div><div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;    <span class="keywordtype">int</span> index[<a class="code" href="a02408.html#af3c229deae2a8e788c823dcc6f020b65">m_ndims</a>];</div><div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;    <a class="code" href="a00956.html#a2b2826031c0cd92495ab351d3e599fc5">_ArraySetValue_</a>(index, <a class="code" href="a02408.html#af3c229deae2a8e788c823dcc6f020b65">m_ndims</a>, 0);</div><div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;</div><div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="a02408.html#a1fde282f4347462c9c2dd34aac2ad998">m_is_periodic</a>[d]) {</div><div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;      </div><div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;      <span class="comment">/* periodic case */</span></div><div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;</div><div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;      <span class="keywordtype">int</span> done = 0;</div><div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;      <span class="keywordflow">while</span> (!done) {</div><div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;</div><div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;        {</div><div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;          <span class="comment">/* low end - face = 1 */</span></div><div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;</div><div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;          <span class="keywordtype">int</span> p_gpt = 0, </div><div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;              p_int = 0;</div><div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;</div><div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;          <span class="keywordtype">int</span> index_gpt[<a class="code" href="a02408.html#af3c229deae2a8e788c823dcc6f020b65">m_ndims</a>];</div><div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;          <a class="code" href="a00956.html#a89e8330d9e06dd0666c50833628a125c">_ArrayCopy1D_</a>(index, index_gpt, <a class="code" href="a02408.html#af3c229deae2a8e788c823dcc6f020b65">m_ndims</a>);</div><div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;          index_gpt[d] -= a_ngpt;</div><div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;          <a class="code" href="a00956.html#afbb862a2fdf5b72b1f9ace42f64b556f">_ArrayIndex1D_</a>(<a class="code" href="a02408.html#af3c229deae2a8e788c823dcc6f020b65">m_ndims</a>, a_dim, index_gpt, a_ngpt, p_gpt);</div><div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;</div><div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;          <span class="keywordtype">int</span> index_int[<a class="code" href="a02408.html#af3c229deae2a8e788c823dcc6f020b65">m_ndims</a>];</div><div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;          <a class="code" href="a00956.html#a89e8330d9e06dd0666c50833628a125c">_ArrayCopy1D_</a>(index, index_int, <a class="code" href="a02408.html#af3c229deae2a8e788c823dcc6f020b65">m_ndims</a>);</div><div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;          index_int[d] += (a_dim[d]-a_ngpt);</div><div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;          <a class="code" href="a00956.html#afbb862a2fdf5b72b1f9ace42f64b556f">_ArrayIndex1D_</a>(<a class="code" href="a02408.html#af3c229deae2a8e788c823dcc6f020b65">m_ndims</a>, a_dim, index_int, a_ngpt, p_int);</div><div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;</div><div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;          <a class="code" href="a00956.html#a89e8330d9e06dd0666c50833628a125c">_ArrayCopy1D_</a>((a_u+a_nvars*p_int), (a_u+a_nvars*p_gpt), a_nvars);</div><div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;        }</div><div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;</div><div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;        {</div><div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;          <span class="comment">/* high end - face = -1 */</span></div><div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;</div><div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;          <span class="keywordtype">int</span> p_gpt = 0, </div><div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;              p_int = 0;</div><div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;</div><div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;          <span class="keywordtype">int</span> index_gpt[<a class="code" href="a02408.html#af3c229deae2a8e788c823dcc6f020b65">m_ndims</a>];</div><div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;          <a class="code" href="a00956.html#a89e8330d9e06dd0666c50833628a125c">_ArrayCopy1D_</a>(index, index_gpt, <a class="code" href="a02408.html#af3c229deae2a8e788c823dcc6f020b65">m_ndims</a>);</div><div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;          index_gpt[d] += a_dim[d];</div><div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;          <a class="code" href="a00956.html#afbb862a2fdf5b72b1f9ace42f64b556f">_ArrayIndex1D_</a>(<a class="code" href="a02408.html#af3c229deae2a8e788c823dcc6f020b65">m_ndims</a>, a_dim, index_gpt, a_ngpt, p_gpt);</div><div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;</div><div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;          <span class="keywordtype">int</span> index_int[<a class="code" href="a02408.html#af3c229deae2a8e788c823dcc6f020b65">m_ndims</a>];</div><div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;          <a class="code" href="a00956.html#a89e8330d9e06dd0666c50833628a125c">_ArrayCopy1D_</a>(index, index_int, <a class="code" href="a02408.html#af3c229deae2a8e788c823dcc6f020b65">m_ndims</a>);</div><div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;          <a class="code" href="a00956.html#afbb862a2fdf5b72b1f9ace42f64b556f">_ArrayIndex1D_</a>(<a class="code" href="a02408.html#af3c229deae2a8e788c823dcc6f020b65">m_ndims</a>, a_dim, index_int, a_ngpt, p_int);</div><div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;</div><div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;          <a class="code" href="a00956.html#a89e8330d9e06dd0666c50833628a125c">_ArrayCopy1D_</a>((a_u+a_nvars*p_int), (a_u+a_nvars*p_gpt), a_nvars);</div><div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;        }</div><div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;</div><div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;        <a class="code" href="a00956.html#ac5ec1371623f11d03b0f42adaa24acbc">_ArrayIncrementIndex_</a>(<a class="code" href="a02408.html#af3c229deae2a8e788c823dcc6f020b65">m_ndims</a>, bounds, index, done);</div><div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;</div><div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;      }</div><div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;</div><div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;    } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;</div><div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;      <span class="comment">/* not periodic - extrapolate */</span></div><div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;</div><div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;      <span class="keywordtype">int</span> done = 0;</div><div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;      <span class="keywordflow">while</span> (!done) {</div><div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;</div><div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;        {</div><div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;          <span class="comment">/* low end - face = 1 */</span></div><div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;</div><div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;          <span class="keywordtype">int</span> p_gpt = 0, </div><div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;              p_int_0 = 0,</div><div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;              p_int_1 = 0,</div><div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;              p_int_2 = 0,</div><div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;              p_int_3 = 0;</div><div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;</div><div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;          <span class="keywordtype">int</span> index_gpt[<a class="code" href="a02408.html#af3c229deae2a8e788c823dcc6f020b65">m_ndims</a>];</div><div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;          <a class="code" href="a00956.html#a89e8330d9e06dd0666c50833628a125c">_ArrayCopy1D_</a>(index, index_gpt, <a class="code" href="a02408.html#af3c229deae2a8e788c823dcc6f020b65">m_ndims</a>);</div><div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;          index_gpt[d] -= a_ngpt;</div><div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;          <a class="code" href="a00956.html#afbb862a2fdf5b72b1f9ace42f64b556f">_ArrayIndex1D_</a>(<a class="code" href="a02408.html#af3c229deae2a8e788c823dcc6f020b65">m_ndims</a>, a_dim, index_gpt, a_ngpt, p_gpt);</div><div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;</div><div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;          <span class="keywordtype">int</span> index_int[<a class="code" href="a02408.html#af3c229deae2a8e788c823dcc6f020b65">m_ndims</a>];</div><div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;          <a class="code" href="a00956.html#a89e8330d9e06dd0666c50833628a125c">_ArrayCopy1D_</a>(index, index_int, <a class="code" href="a02408.html#af3c229deae2a8e788c823dcc6f020b65">m_ndims</a>);</div><div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;</div><div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;          index_int[d] = 0;</div><div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;          <a class="code" href="a00956.html#afbb862a2fdf5b72b1f9ace42f64b556f">_ArrayIndex1D_</a>(<a class="code" href="a02408.html#af3c229deae2a8e788c823dcc6f020b65">m_ndims</a>, a_dim, index_int, a_ngpt, p_int_0);</div><div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;          index_int[d]++;</div><div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;          <a class="code" href="a00956.html#afbb862a2fdf5b72b1f9ace42f64b556f">_ArrayIndex1D_</a>(<a class="code" href="a02408.html#af3c229deae2a8e788c823dcc6f020b65">m_ndims</a>, a_dim, index_int, a_ngpt, p_int_1);</div><div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;          index_int[d]++;</div><div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;          <a class="code" href="a00956.html#afbb862a2fdf5b72b1f9ace42f64b556f">_ArrayIndex1D_</a>(<a class="code" href="a02408.html#af3c229deae2a8e788c823dcc6f020b65">m_ndims</a>, a_dim, index_int, a_ngpt, p_int_2);</div><div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;          index_int[d]++;</div><div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;          <a class="code" href="a00956.html#afbb862a2fdf5b72b1f9ace42f64b556f">_ArrayIndex1D_</a>(<a class="code" href="a02408.html#af3c229deae2a8e788c823dcc6f020b65">m_ndims</a>, a_dim, index_int, a_ngpt, p_int_3);</div><div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;</div><div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;          <span class="keywordtype">double</span> alpha = - (double) (a_ngpt - index[d]);</div><div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;          <span class="keywordtype">double</span> c0 = -((-2.0 + alpha)*(-1.0 + alpha)*alpha)/6.0;</div><div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;          <span class="keywordtype">double</span> c1 = ((-2.0 + alpha)*(-1.0 + alpha)*(1.0 + alpha))/2.0;</div><div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;          <span class="keywordtype">double</span> c2 = (alpha*(2.0 + alpha - alpha*alpha))/2.0;</div><div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;          <span class="keywordtype">double</span> c3 = (alpha*(-1.0 + alpha*alpha))/6.0;</div><div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;</div><div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;          <span class="keywordflow">for</span> (<span class="keywordtype">int</span> v = 0; v &lt; a_nvars; v++) {</div><div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;    </div><div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;            a_u[p_gpt*a_nvars+v] =    c0 * a_u[p_int_0*a_nvars+v]</div><div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;                                    + c1 * a_u[p_int_1*a_nvars+v]</div><div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;                                    + c2 * a_u[p_int_2*a_nvars+v]</div><div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;                                    + c3 * a_u[p_int_3*a_nvars+v];</div><div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;    </div><div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;          }</div><div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;</div><div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;        }</div><div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;</div><div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;        {</div><div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;          <span class="comment">/* high end - face = -1 */</span></div><div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;</div><div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;          <span class="keywordtype">int</span> p_gpt = 0, </div><div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;              p_int_0 = 0,</div><div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;              p_int_1 = 0,</div><div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;              p_int_2 = 0,</div><div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;              p_int_3 = 0;</div><div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;</div><div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;          <span class="keywordtype">int</span> index_gpt[<a class="code" href="a02408.html#af3c229deae2a8e788c823dcc6f020b65">m_ndims</a>];</div><div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;          <a class="code" href="a00956.html#a89e8330d9e06dd0666c50833628a125c">_ArrayCopy1D_</a>(index, index_gpt, <a class="code" href="a02408.html#af3c229deae2a8e788c823dcc6f020b65">m_ndims</a>);</div><div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;          index_gpt[d] += a_dim[d];</div><div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;          <a class="code" href="a00956.html#afbb862a2fdf5b72b1f9ace42f64b556f">_ArrayIndex1D_</a>(<a class="code" href="a02408.html#af3c229deae2a8e788c823dcc6f020b65">m_ndims</a>, a_dim, index_gpt, a_ngpt, p_gpt);</div><div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;</div><div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;          <span class="keywordtype">int</span> index_int[<a class="code" href="a02408.html#af3c229deae2a8e788c823dcc6f020b65">m_ndims</a>];</div><div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;          <a class="code" href="a00956.html#a89e8330d9e06dd0666c50833628a125c">_ArrayCopy1D_</a>(index, index_int, <a class="code" href="a02408.html#af3c229deae2a8e788c823dcc6f020b65">m_ndims</a>);</div><div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;</div><div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;          index_int[d] = a_dim[d]-1;</div><div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;          <a class="code" href="a00956.html#afbb862a2fdf5b72b1f9ace42f64b556f">_ArrayIndex1D_</a>(<a class="code" href="a02408.html#af3c229deae2a8e788c823dcc6f020b65">m_ndims</a>, a_dim, index, a_ngpt, p_int_0);</div><div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;          index_int[d]--;</div><div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;          <a class="code" href="a00956.html#afbb862a2fdf5b72b1f9ace42f64b556f">_ArrayIndex1D_</a>(<a class="code" href="a02408.html#af3c229deae2a8e788c823dcc6f020b65">m_ndims</a>, a_dim, index, a_ngpt, p_int_1);</div><div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;          index_int[d]--;</div><div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;          <a class="code" href="a00956.html#afbb862a2fdf5b72b1f9ace42f64b556f">_ArrayIndex1D_</a>(<a class="code" href="a02408.html#af3c229deae2a8e788c823dcc6f020b65">m_ndims</a>, a_dim, index, a_ngpt, p_int_2);</div><div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;          index_int[d]--;</div><div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;          <a class="code" href="a00956.html#afbb862a2fdf5b72b1f9ace42f64b556f">_ArrayIndex1D_</a>(<a class="code" href="a02408.html#af3c229deae2a8e788c823dcc6f020b65">m_ndims</a>, a_dim, index, a_ngpt, p_int_3);</div><div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;</div><div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;          <span class="keywordtype">double</span> alpha = - (double) (index[d]+1);</div><div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;          <span class="keywordtype">double</span> c0 = -((-2.0 + alpha)*(-1.0 + alpha)*alpha)/6.0;</div><div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;          <span class="keywordtype">double</span> c1 = ((-2.0 + alpha)*(-1.0 + alpha)*(1.0 + alpha))/2.0;</div><div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;          <span class="keywordtype">double</span> c2 = (alpha*(2.0 + alpha - alpha*alpha))/2.0;</div><div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;          <span class="keywordtype">double</span> c3 = (alpha*(-1.0 + alpha*alpha))/6.0;</div><div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;</div><div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;          <span class="keywordflow">for</span> (<span class="keywordtype">int</span> v = 0; v &lt; a_nvars; v++) {</div><div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;    </div><div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;            a_u[p_gpt*a_nvars+v] =    c0 * a_u[p_int_0*a_nvars+v]</div><div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;                                    + c1 * a_u[p_int_1*a_nvars+v]</div><div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;                                    + c2 * a_u[p_int_2*a_nvars+v]</div><div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;                                    + c3 * a_u[p_int_3*a_nvars+v];</div><div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;    </div><div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;          }</div><div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;</div><div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;        }</div><div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;</div><div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;        <a class="code" href="a00956.html#ac5ec1371623f11d03b0f42adaa24acbc">_ArrayIncrementIndex_</a>(<a class="code" href="a02408.html#af3c229deae2a8e788c823dcc6f020b65">m_ndims</a>, bounds, index, done);</div><div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;</div><div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;      }</div><div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;</div><div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;    }</div><div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;</div><div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;  }</div><div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;</div><div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;  <span class="keywordflow">return</span>;</div><div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;}</div><div class="ttc" id="a00956_html_ac5ec1371623f11d03b0f42adaa24acbc"><div class="ttname"><a href="a00956.html#ac5ec1371623f11d03b0f42adaa24acbc">_ArrayIncrementIndex_</a></div><div class="ttdeci">#define _ArrayIncrementIndex_(N, imax, i, done)</div><div class="ttdef"><b>Definition:</b> <a href="a00956_source.html#l00126">arrayfunctions.h:126</a></div></div>
<div class="ttc" id="a02408_html_a1fde282f4347462c9c2dd34aac2ad998"><div class="ttname"><a href="a02408.html#a1fde282f4347462c9c2dd34aac2ad998">SparseGridsSimulation::m_is_periodic</a></div><div class="ttdeci">std::vector&lt; bool &gt; m_is_periodic</div><div class="ttdef"><b>Definition:</b> <a href="a01106_source.html#l00222">sparse_grids_simulation.h:222</a></div></div>
<div class="ttc" id="a02408_html_af3c229deae2a8e788c823dcc6f020b65"><div class="ttname"><a href="a02408.html#af3c229deae2a8e788c823dcc6f020b65">SparseGridsSimulation::m_ndims</a></div><div class="ttdeci">int m_ndims</div><div class="ttdef"><b>Definition:</b> <a href="a01106_source.html#l00215">sparse_grids_simulation.h:215</a></div></div>
<div class="ttc" id="a00956_html_a2b2826031c0cd92495ab351d3e599fc5"><div class="ttname"><a href="a00956.html#a2b2826031c0cd92495ab351d3e599fc5">_ArraySetValue_</a></div><div class="ttdeci">#define _ArraySetValue_(x, size, value)</div><div class="ttdef"><b>Definition:</b> <a href="a00956_source.html#l00169">arrayfunctions.h:169</a></div></div>
<div class="ttc" id="a00956_html_a89e8330d9e06dd0666c50833628a125c"><div class="ttname"><a href="a00956.html#a89e8330d9e06dd0666c50833628a125c">_ArrayCopy1D_</a></div><div class="ttdeci">#define _ArrayCopy1D_(x, y, size)</div><div class="ttdef"><b>Definition:</b> <a href="a00956_source.html#l00319">arrayfunctions.h:319</a></div></div>
<div class="ttc" id="a00956_html_afbb862a2fdf5b72b1f9ace42f64b556f"><div class="ttname"><a href="a00956.html#afbb862a2fdf5b72b1f9ace42f64b556f">_ArrayIndex1D_</a></div><div class="ttdeci">#define _ArrayIndex1D_(N, imax, i, ghost, index)</div><div class="ttdef"><b>Definition:</b> <a href="a00956_source.html#l00040">arrayfunctions.h:40</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a3b9da93464d7dafe5f3c64211703387b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3b9da93464d7dafe5f3c64211703387b">&#9670;&nbsp;</a></span>CalculateError()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void CalculateError </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Calculate errors</p>
<p>Calculates the error in the solution if the exact solution is available. The exact solution should be provided in the file "exact.inp" in the same format as the initial solution. </p>

<p class="definition">Definition at line <a class="el" href="a02150_source.html#l00017">17</a> of file <a class="el" href="a02150_source.html">SparseGridsCalculateError.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;{</div><div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;  <span class="keywordtype">int</span> exact_flag;</div><div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;  <span class="keywordtype">double</span> *uex = NULL;</div><div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;</div><div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;  <span class="comment">/* read in full grid exact solution, if available */</span></div><div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;  {</div><div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;    <a class="code" href="a02280.html">HyPar</a>* solver = &amp;(<a class="code" href="a02408.html#a41a86f682aa37c28c671759a11a494a8">m_sim_fg</a>-&gt;<a class="code" href="a01100.html#a523947ce4fa7128c4c767163953253b9">solver</a>);</div><div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;    <a class="code" href="a01028.html#a02320">MPIVariables</a>* mpi = &amp;(<a class="code" href="a02408.html#a41a86f682aa37c28c671759a11a494a8">m_sim_fg</a>-&gt;<a class="code" href="a01100.html#a4afd2c7b3eb8fda452474ebdbe71c8c0">mpi</a>);</div><div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;    <span class="keywordtype">long</span> size = solver-&gt;<a class="code" href="a02280.html#ae8f6d2fd6490d3153cb4133bf183a404">nvars</a> * solver-&gt;<a class="code" href="a02280.html#a20ee1fd00a220b98513127884a5558cf">npoints_local_wghosts</a>;</div><div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;    uex = (<span class="keywordtype">double</span>*) calloc (size, <span class="keyword">sizeof</span>(<span class="keywordtype">double</span>));</div><div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;  </div><div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;    <span class="keywordtype">char</span> fname_root[<a class="code" href="a00965.html#a51efea86a4d76d1259893f606b776573">_MAX_STRING_SIZE_</a>] = <span class="stringliteral">&quot;exact&quot;</span>;</div><div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;    <a class="code" href="a00965.html#ad6ab74942c9de13cf0b4c12eb0d91780">IERR</a> <a class="code" href="a02150.html#aef6e3464d167cab9e23a9eacb8f62882">ExactSolution</a>( solver,</div><div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;                        mpi,</div><div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;                        uex,</div><div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;                        fname_root,</div><div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;                        &amp;exact_flag ); <a class="code" href="a00965.html#add9cf96ae374934d245a1dc1ab697a42">CHECKERR</a>(ierr);</div><div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;  }</div><div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;</div><div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> n=0; n&lt;<a class="code" href="a02408.html#acd95922d6bb09419fb66435d114cdb5c">m_nsims_sg</a>; n++) {</div><div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;<span class="comment">//    TimeError(  &amp;(m_sims_sg[n].solver),</span></div><div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;<span class="comment">//                &amp;(m_sims_sg[n].mpi),</span></div><div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;<span class="comment">//                uex );</span></div><div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;  }</div><div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;</div><div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;  <span class="keywordflow">if</span> (!exact_flag) {</div><div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;</div><div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;    <span class="comment">/* No exact solution available */</span></div><div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> n=0; n&lt;<a class="code" href="a02408.html#acd95922d6bb09419fb66435d114cdb5c">m_nsims_sg</a>; n++) {</div><div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;      <a class="code" href="a02408.html#afd006361179964b4e2c2cc65526247bd">m_sims_sg</a>[n].solver.error[0] </div><div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;        = <a class="code" href="a02408.html#afd006361179964b4e2c2cc65526247bd">m_sims_sg</a>[n].solver.error[1] </div><div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;        = <a class="code" href="a02408.html#afd006361179964b4e2c2cc65526247bd">m_sims_sg</a>[n].solver.error[2] </div><div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;        = -1;</div><div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;    }</div><div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;    <a class="code" href="a02408.html#a41a86f682aa37c28c671759a11a494a8">m_sim_fg</a>-&gt;<a class="code" href="a01100.html#a523947ce4fa7128c4c767163953253b9">solver</a>.<a class="code" href="a02280.html#aa40f27cb2afa2db0f0468962be8b3679">error</a>[0] </div><div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;      = <a class="code" href="a02408.html#a41a86f682aa37c28c671759a11a494a8">m_sim_fg</a>-&gt;<a class="code" href="a01100.html#a523947ce4fa7128c4c767163953253b9">solver</a>.<a class="code" href="a02280.html#aa40f27cb2afa2db0f0468962be8b3679">error</a>[1] </div><div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;      = <a class="code" href="a02408.html#a41a86f682aa37c28c671759a11a494a8">m_sim_fg</a>-&gt;<a class="code" href="a01100.html#a523947ce4fa7128c4c767163953253b9">solver</a>.<a class="code" href="a02280.html#aa40f27cb2afa2db0f0468962be8b3679">error</a>[2] </div><div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;      = -1;</div><div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;</div><div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;  } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;</div><div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;    std::vector&lt;int&gt; periodic_arr(<a class="code" href="a02408.html#af3c229deae2a8e788c823dcc6f020b65">m_ndims</a>);</div><div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;<a class="code" href="a02408.html#af3c229deae2a8e788c823dcc6f020b65">m_ndims</a>; i++) {</div><div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;      periodic_arr[i] = (<a class="code" href="a02408.html#a1fde282f4347462c9c2dd34aac2ad998">m_is_periodic</a>[i] ? 1 : 0);</div><div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;    }</div><div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;</div><div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;    <span class="keywordtype">double</span> *uex2 = NULL;</div><div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;</div><div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="a02408.html#a8ccd402501119573dbadc7d6e96c59a2">m_print_sg_errors</a> == 1) {</div><div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;      <span class="keywordtype">long</span> size =   <a class="code" href="a02408.html#a41a86f682aa37c28c671759a11a494a8">m_sim_fg</a>-&gt;<a class="code" href="a01100.html#a523947ce4fa7128c4c767163953253b9">solver</a>.<a class="code" href="a02280.html#ae8f6d2fd6490d3153cb4133bf183a404">nvars</a> </div><div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;                  * <a class="code" href="a02408.html#a41a86f682aa37c28c671759a11a494a8">m_sim_fg</a>-&gt;<a class="code" href="a01100.html#a523947ce4fa7128c4c767163953253b9">solver</a>.<a class="code" href="a02280.html#a20ee1fd00a220b98513127884a5558cf">npoints_local_wghosts</a>;</div><div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;      uex2 = (<span class="keywordtype">double</span>*) calloc(size, <span class="keyword">sizeof</span>(<span class="keywordtype">double</span>));</div><div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;      <a class="code" href="a00956.html#a89e8330d9e06dd0666c50833628a125c">_ArrayCopy1D_</a>(uex, uex2, size);</div><div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;    }</div><div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;</div><div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;    <span class="comment">/* calculate error for full grid */</span></div><div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;    <a class="code" href="a02408.html#aa22a121c18471b27623988d9ada894af">computeError</a>( *<a class="code" href="a02408.html#a41a86f682aa37c28c671759a11a494a8">m_sim_fg</a>, uex );</div><div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;</div><div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;    <span class="comment">/* calculate error for sparse grids */</span></div><div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="a02408.html#a8ccd402501119573dbadc7d6e96c59a2">m_print_sg_errors</a> == 1) {</div><div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> n = 0; n &lt; <a class="code" href="a02408.html#acd95922d6bb09419fb66435d114cdb5c">m_nsims_sg</a>; n++) {</div><div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;  </div><div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;        <a class="code" href="a01106.html#a00167df288a1ca2c6c32af8d911975e0">GridDimensions</a> dim_fg(<a class="code" href="a02408.html#af3c229deae2a8e788c823dcc6f020b65">m_ndims</a>,0);</div><div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;        <a class="code" href="a02264.html#a53cafdf187fdf401cda2700b0c2f223c">StdVecOps::copyFrom</a>(dim_fg, <a class="code" href="a02408.html#a41a86f682aa37c28c671759a11a494a8">m_sim_fg</a>-&gt;<a class="code" href="a01100.html#a523947ce4fa7128c4c767163953253b9">solver</a>.<a class="code" href="a02280.html#aa989ebb755986852177779cdf7bd8c85">dim_global</a>, <a class="code" href="a02408.html#af3c229deae2a8e788c823dcc6f020b65">m_ndims</a>);</div><div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;  </div><div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;        <a class="code" href="a01106.html#a00167df288a1ca2c6c32af8d911975e0">GridDimensions</a> dim_sg(<a class="code" href="a02408.html#af3c229deae2a8e788c823dcc6f020b65">m_ndims</a>,0);</div><div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;        <a class="code" href="a02264.html#a53cafdf187fdf401cda2700b0c2f223c">StdVecOps::copyFrom</a>(dim_sg, <a class="code" href="a02408.html#afd006361179964b4e2c2cc65526247bd">m_sims_sg</a>[n].solver.<a class="code" href="a02280.html#aa989ebb755986852177779cdf7bd8c85">dim_global</a>, <a class="code" href="a02408.html#af3c229deae2a8e788c823dcc6f020b65">m_ndims</a>);</div><div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;  </div><div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;        <span class="comment">/* assemble the global exact solution on full grid */</span></div><div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;        <span class="keywordtype">double</span> *uex_global_fg = NULL;</div><div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;        <span class="keywordflow">if</span> (!<a class="code" href="a02408.html#ac6a822dc76382e4027cf94ac3e510056">m_rank</a>) {</div><div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;          <a class="code" href="a02408.html#a00beed94b3f705d20db508533bfc0fc0">allocateDataArrays</a>( dim_fg, </div><div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;                              <a class="code" href="a02408.html#a41a86f682aa37c28c671759a11a494a8">m_sim_fg</a>-&gt;<a class="code" href="a01100.html#a523947ce4fa7128c4c767163953253b9">solver</a>.<a class="code" href="a02280.html#ae8f6d2fd6490d3153cb4133bf183a404">nvars</a>, </div><div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;                              &amp;uex_global_fg, </div><div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;                              <a class="code" href="a02408.html#a41a86f682aa37c28c671759a11a494a8">m_sim_fg</a>-&gt;<a class="code" href="a01100.html#a523947ce4fa7128c4c767163953253b9">solver</a>.<a class="code" href="a02280.html#aafc992b5fa79d5a4036024615d03bce6">ghosts</a>);</div><div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;        }</div><div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;        <a class="code" href="a01022.html#a81ef82bfd40dff69eb5b975c102133f2">MPIGatherArraynDwGhosts</a>( <a class="code" href="a02408.html#af3c229deae2a8e788c823dcc6f020b65">m_ndims</a>,</div><div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;                                 (<span class="keywordtype">void</span>*) &amp;(<a class="code" href="a02408.html#a41a86f682aa37c28c671759a11a494a8">m_sim_fg</a>-&gt;<a class="code" href="a01100.html#a4afd2c7b3eb8fda452474ebdbe71c8c0">mpi</a>),</div><div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;                                 uex_global_fg,</div><div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;                                 uex2,</div><div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;                                 <a class="code" href="a02408.html#a41a86f682aa37c28c671759a11a494a8">m_sim_fg</a>-&gt;<a class="code" href="a01100.html#a523947ce4fa7128c4c767163953253b9">solver</a>.<a class="code" href="a02280.html#aa989ebb755986852177779cdf7bd8c85">dim_global</a>,</div><div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;                                 <a class="code" href="a02408.html#a41a86f682aa37c28c671759a11a494a8">m_sim_fg</a>-&gt;<a class="code" href="a01100.html#a523947ce4fa7128c4c767163953253b9">solver</a>.<a class="code" href="a02280.html#a38e0371f331cecbe63a77fa03e202afe">dim_local</a>,</div><div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;                                 <a class="code" href="a02408.html#a41a86f682aa37c28c671759a11a494a8">m_sim_fg</a>-&gt;<a class="code" href="a01100.html#a523947ce4fa7128c4c767163953253b9">solver</a>.<a class="code" href="a02280.html#aafc992b5fa79d5a4036024615d03bce6">ghosts</a>,</div><div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;                                 <a class="code" href="a02408.html#a41a86f682aa37c28c671759a11a494a8">m_sim_fg</a>-&gt;<a class="code" href="a01100.html#a523947ce4fa7128c4c767163953253b9">solver</a>.<a class="code" href="a02280.html#ae8f6d2fd6490d3153cb4133bf183a404">nvars</a> );</div><div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;  </div><div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;        <span class="comment">/* interpolate to sparse grid - </span></div><div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;<span class="comment">         * this will delete the full grid array*/</span></div><div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;        <span class="keywordtype">double</span> *uex_global_sg = NULL;</div><div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;        <span class="keywordflow">if</span> (!<a class="code" href="a02408.html#ac6a822dc76382e4027cf94ac3e510056">m_rank</a>) {</div><div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;          <span class="keywordtype">int</span> ierr = <a class="code" href="a01010.html#a4293421dad25c62114f4a7453d6376aa">::InterpolateGlobalnDVar</a>(  dim_sg.data(),</div><div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;                                                &amp;uex_global_sg,</div><div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;                                                dim_fg.data(),</div><div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;                                                uex_global_fg,</div><div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;                                                <a class="code" href="a02408.html#afd006361179964b4e2c2cc65526247bd">m_sims_sg</a>[n].solver.nvars,</div><div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;                                                <a class="code" href="a02408.html#afd006361179964b4e2c2cc65526247bd">m_sims_sg</a>[n].solver.ghosts,</div><div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;                                                <a class="code" href="a02408.html#af3c229deae2a8e788c823dcc6f020b65">m_ndims</a>,</div><div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;                                                periodic_arr.data() );</div><div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;          <span class="keywordflow">if</span> (ierr) {</div><div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;            fprintf(stderr,<span class="stringliteral">&quot;InterpolateGlobalnDVar() returned with error!\n&quot;</span>);</div><div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;            exit(1);</div><div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;          }</div><div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;        }</div><div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;  </div><div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;        <span class="comment">/* allocate local exact solution on this sparse grid */</span></div><div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;        <span class="keywordtype">long</span> size = <a class="code" href="a02408.html#afd006361179964b4e2c2cc65526247bd">m_sims_sg</a>[n].solver.nvars </div><div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;                    * <a class="code" href="a02408.html#afd006361179964b4e2c2cc65526247bd">m_sims_sg</a>[n].solver.npoints_local_wghosts;</div><div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;        <span class="keywordtype">double</span>* uex_sg = (<span class="keywordtype">double</span>*) calloc(size, <span class="keyword">sizeof</span>(<span class="keywordtype">double</span>));</div><div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;  </div><div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;        <span class="comment">/* partition the global exact solution to local on this sparse grid */</span></div><div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;        <a class="code" href="a01022.html#a25eaada04db84ccf1c979d4301f5093f">MPIPartitionArraynDwGhosts</a>( <a class="code" href="a02408.html#af3c229deae2a8e788c823dcc6f020b65">m_ndims</a>,</div><div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;                                    (<span class="keywordtype">void</span>*) &amp;(<a class="code" href="a02408.html#afd006361179964b4e2c2cc65526247bd">m_sims_sg</a>[n].mpi),</div><div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;                                    (<a class="code" href="a02408.html#ac6a822dc76382e4027cf94ac3e510056">m_rank</a> ? NULL : uex_global_sg),</div><div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;                                    uex_sg,</div><div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;                                    <a class="code" href="a02408.html#afd006361179964b4e2c2cc65526247bd">m_sims_sg</a>[n].solver.<a class="code" href="a02280.html#aa989ebb755986852177779cdf7bd8c85">dim_global</a>,</div><div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;                                    <a class="code" href="a02408.html#afd006361179964b4e2c2cc65526247bd">m_sims_sg</a>[n].solver.dim_local,</div><div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;                                    <a class="code" href="a02408.html#afd006361179964b4e2c2cc65526247bd">m_sims_sg</a>[n].solver.ghosts,</div><div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;                                    <a class="code" href="a02408.html#afd006361179964b4e2c2cc65526247bd">m_sims_sg</a>[n].solver.nvars );</div><div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;  </div><div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;        <span class="comment">/* delete the global exact solution array */</span></div><div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;        <span class="keywordflow">if</span> (!<a class="code" href="a02408.html#ac6a822dc76382e4027cf94ac3e510056">m_rank</a>) free(uex_global_sg);</div><div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;  </div><div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;        <span class="comment">/* compute the error */</span></div><div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;        <a class="code" href="a02408.html#aa22a121c18471b27623988d9ada894af">computeError</a>( <a class="code" href="a02408.html#afd006361179964b4e2c2cc65526247bd">m_sims_sg</a>[n], uex_sg);</div><div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;  </div><div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;        <span class="comment">/* delete the exact solution array */</span></div><div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;        free(uex_sg);</div><div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;      }</div><div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;      free(uex2);</div><div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;    }</div><div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;</div><div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;  }</div><div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;</div><div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;  free(uex);</div><div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;  <span class="keywordflow">return</span>;</div><div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;}</div><div class="ttc" id="a02280_html"><div class="ttname"><a href="a02280.html">HyPar</a></div><div class="ttdoc">Structure containing all solver-specific variables and functions. </div><div class="ttdef"><b>Definition:</b> <a href="a00986_source.html#l00023">hypar.h:23</a></div></div>
<div class="ttc" id="a02408_html_acd95922d6bb09419fb66435d114cdb5c"><div class="ttname"><a href="a02408.html#acd95922d6bb09419fb66435d114cdb5c">SparseGridsSimulation::m_nsims_sg</a></div><div class="ttdeci">int m_nsims_sg</div><div class="ttdef"><b>Definition:</b> <a href="a01106_source.html#l00214">sparse_grids_simulation.h:214</a></div></div>
<div class="ttc" id="a00965_html_add9cf96ae374934d245a1dc1ab697a42"><div class="ttname"><a href="a00965.html#add9cf96ae374934d245a1dc1ab697a42">CHECKERR</a></div><div class="ttdeci">#define CHECKERR(ierr)</div><div class="ttdef"><b>Definition:</b> <a href="a00965_source.html#l00018">basic.h:18</a></div></div>
<div class="ttc" id="a00965_html_a51efea86a4d76d1259893f606b776573"><div class="ttname"><a href="a00965.html#a51efea86a4d76d1259893f606b776573">_MAX_STRING_SIZE_</a></div><div class="ttdeci">#define _MAX_STRING_SIZE_</div><div class="ttdef"><b>Definition:</b> <a href="a00965_source.html#l00014">basic.h:14</a></div></div>
<div class="ttc" id="a02280_html_aa989ebb755986852177779cdf7bd8c85"><div class="ttname"><a href="a02280.html#aa989ebb755986852177779cdf7bd8c85">HyPar::dim_global</a></div><div class="ttdeci">int * dim_global</div><div class="ttdef"><b>Definition:</b> <a href="a00986_source.html#l00033">hypar.h:33</a></div></div>
<div class="ttc" id="a02408_html_a41a86f682aa37c28c671759a11a494a8"><div class="ttname"><a href="a02408.html#a41a86f682aa37c28c671759a11a494a8">SparseGridsSimulation::m_sim_fg</a></div><div class="ttdeci">SimulationObject * m_sim_fg</div><div class="ttdef"><b>Definition:</b> <a href="a01106_source.html#l00230">sparse_grids_simulation.h:230</a></div></div>
<div class="ttc" id="a01100_html_a523947ce4fa7128c4c767163953253b9"><div class="ttname"><a href="a01100.html#a523947ce4fa7128c4c767163953253b9">SimulationObject::solver</a></div><div class="ttdeci">HyPar solver</div><div class="ttdef"><b>Definition:</b> <a href="a01100_source.html#l00026">simulation_object.h:26</a></div></div>
<div class="ttc" id="a02408_html_a1fde282f4347462c9c2dd34aac2ad998"><div class="ttname"><a href="a02408.html#a1fde282f4347462c9c2dd34aac2ad998">SparseGridsSimulation::m_is_periodic</a></div><div class="ttdeci">std::vector&lt; bool &gt; m_is_periodic</div><div class="ttdef"><b>Definition:</b> <a href="a01106_source.html#l00222">sparse_grids_simulation.h:222</a></div></div>
<div class="ttc" id="a02408_html_af3c229deae2a8e788c823dcc6f020b65"><div class="ttname"><a href="a02408.html#af3c229deae2a8e788c823dcc6f020b65">SparseGridsSimulation::m_ndims</a></div><div class="ttdeci">int m_ndims</div><div class="ttdef"><b>Definition:</b> <a href="a01106_source.html#l00215">sparse_grids_simulation.h:215</a></div></div>
<div class="ttc" id="a02408_html_a00beed94b3f705d20db508533bfc0fc0"><div class="ttname"><a href="a02408.html#a00beed94b3f705d20db508533bfc0fc0">SparseGridsSimulation::allocateDataArrays</a></div><div class="ttdeci">void allocateDataArrays(const GridDimensions &amp;a_dim, const int a_nvars, double **const a_u, const int a_ngpt=0)</div><div class="ttdef"><b>Definition:</b> <a href="a01106_source.html#l00358">sparse_grids_simulation.h:358</a></div></div>
<div class="ttc" id="a01010_html_a4293421dad25c62114f4a7453d6376aa"><div class="ttname"><a href="a01010.html#a4293421dad25c62114f4a7453d6376aa">InterpolateGlobalnDVar</a></div><div class="ttdeci">int InterpolateGlobalnDVar(const int *const, double **const, const int *const, double *const, const int, const int, const int, const int *const)</div><div class="ttdef"><b>Definition:</b> <a href="a01457_source.html#l00317">InterpolateGlobalnDVar.c:317</a></div></div>
<div class="ttc" id="a00956_html_a89e8330d9e06dd0666c50833628a125c"><div class="ttname"><a href="a00956.html#a89e8330d9e06dd0666c50833628a125c">_ArrayCopy1D_</a></div><div class="ttdeci">#define _ArrayCopy1D_(x, y, size)</div><div class="ttdef"><b>Definition:</b> <a href="a00956_source.html#l00319">arrayfunctions.h:319</a></div></div>
<div class="ttc" id="a02408_html_ac6a822dc76382e4027cf94ac3e510056"><div class="ttname"><a href="a02408.html#ac6a822dc76382e4027cf94ac3e510056">SparseGridsSimulation::m_rank</a></div><div class="ttdeci">int m_rank</div><div class="ttdef"><b>Definition:</b> <a href="a01106_source.html#l00216">sparse_grids_simulation.h:216</a></div></div>
<div class="ttc" id="a01028_html_a02320"><div class="ttname"><a href="a01028.html#a02320">MPIVariables</a></div><div class="ttdoc">Structure of MPI-related variables. </div><div class="ttdef"><b>Definition:</b> <a href="a01028_source.html#l00024">mpivars_struct.h:24</a></div></div>
<div class="ttc" id="a01100_html_a4afd2c7b3eb8fda452474ebdbe71c8c0"><div class="ttname"><a href="a01100.html#a4afd2c7b3eb8fda452474ebdbe71c8c0">SimulationObject::mpi</a></div><div class="ttdeci">MPIVariables mpi</div><div class="ttdef"><b>Definition:</b> <a href="a01100_source.html#l00025">simulation_object.h:25</a></div></div>
<div class="ttc" id="a02408_html_a8ccd402501119573dbadc7d6e96c59a2"><div class="ttname"><a href="a02408.html#a8ccd402501119573dbadc7d6e96c59a2">SparseGridsSimulation::m_print_sg_errors</a></div><div class="ttdeci">int m_print_sg_errors</div><div class="ttdef"><b>Definition:</b> <a href="a01106_source.html#l00228">sparse_grids_simulation.h:228</a></div></div>
<div class="ttc" id="a02408_html_afd006361179964b4e2c2cc65526247bd"><div class="ttname"><a href="a02408.html#afd006361179964b4e2c2cc65526247bd">SparseGridsSimulation::m_sims_sg</a></div><div class="ttdeci">std::vector&lt; SimulationObject &gt; m_sims_sg</div><div class="ttdef"><b>Definition:</b> <a href="a01106_source.html#l00231">sparse_grids_simulation.h:231</a></div></div>
<div class="ttc" id="a00965_html_ad6ab74942c9de13cf0b4c12eb0d91780"><div class="ttname"><a href="a00965.html#ad6ab74942c9de13cf0b4c12eb0d91780">IERR</a></div><div class="ttdeci">#define IERR</div><div class="ttdef"><b>Definition:</b> <a href="a00965_source.html#l00016">basic.h:16</a></div></div>
<div class="ttc" id="a02408_html_aa22a121c18471b27623988d9ada894af"><div class="ttname"><a href="a02408.html#aa22a121c18471b27623988d9ada894af">SparseGridsSimulation::computeError</a></div><div class="ttdeci">void computeError(SimulationObject &amp;, double *const)</div><div class="ttdef"><b>Definition:</b> <a href="a02150_source.html#l00155">SparseGridsCalculateError.cpp:155</a></div></div>
<div class="ttc" id="a02280_html_aa40f27cb2afa2db0f0468962be8b3679"><div class="ttname"><a href="a02280.html#aa40f27cb2afa2db0f0468962be8b3679">HyPar::error</a></div><div class="ttdeci">double error[3]</div><div class="ttdef"><b>Definition:</b> <a href="a00986_source.html#l00366">hypar.h:366</a></div></div>
<div class="ttc" id="a02150_html_aef6e3464d167cab9e23a9eacb8f62882"><div class="ttname"><a href="a02150.html#aef6e3464d167cab9e23a9eacb8f62882">ExactSolution</a></div><div class="ttdeci">int ExactSolution(void *, void *, double *, char *, int *)</div><div class="ttdef"><b>Definition:</b> <a href="a01250_source.html#l00016">ExactSolution.c:16</a></div></div>
<div class="ttc" id="a02264_html_a53cafdf187fdf401cda2700b0c2f223c"><div class="ttname"><a href="a02264.html#a53cafdf187fdf401cda2700b0c2f223c">StdVecOps::copyFrom</a></div><div class="ttdeci">void copyFrom(std::vector&lt; int &gt; &amp;a_iv, const int *const a_iv_carr, int a_n)</div><div class="ttdef"><b>Definition:</b> <a href="a01109_source.html#l00036">std_vec_ops.h:36</a></div></div>
<div class="ttc" id="a01022_html_a25eaada04db84ccf1c979d4301f5093f"><div class="ttname"><a href="a01022.html#a25eaada04db84ccf1c979d4301f5093f">MPIPartitionArraynDwGhosts</a></div><div class="ttdeci">int MPIPartitionArraynDwGhosts(int, void *, double *, double *, int *, int *, int, int)</div><div class="ttdef"><b>Definition:</b> <a href="a01508_source.html#l00114">MPIPartitionArraynD.c:114</a></div></div>
<div class="ttc" id="a02280_html_a38e0371f331cecbe63a77fa03e202afe"><div class="ttname"><a href="a02280.html#a38e0371f331cecbe63a77fa03e202afe">HyPar::dim_local</a></div><div class="ttdeci">int * dim_local</div><div class="ttdef"><b>Definition:</b> <a href="a00986_source.html#l00037">hypar.h:37</a></div></div>
<div class="ttc" id="a02280_html_ae8f6d2fd6490d3153cb4133bf183a404"><div class="ttname"><a href="a02280.html#ae8f6d2fd6490d3153cb4133bf183a404">HyPar::nvars</a></div><div class="ttdeci">int nvars</div><div class="ttdef"><b>Definition:</b> <a href="a00986_source.html#l00029">hypar.h:29</a></div></div>
<div class="ttc" id="a02280_html_a20ee1fd00a220b98513127884a5558cf"><div class="ttname"><a href="a02280.html#a20ee1fd00a220b98513127884a5558cf">HyPar::npoints_local_wghosts</a></div><div class="ttdeci">int npoints_local_wghosts</div><div class="ttdef"><b>Definition:</b> <a href="a00986_source.html#l00042">hypar.h:42</a></div></div>
<div class="ttc" id="a02280_html_aafc992b5fa79d5a4036024615d03bce6"><div class="ttname"><a href="a02280.html#aafc992b5fa79d5a4036024615d03bce6">HyPar::ghosts</a></div><div class="ttdeci">int ghosts</div><div class="ttdef"><b>Definition:</b> <a href="a00986_source.html#l00052">hypar.h:52</a></div></div>
<div class="ttc" id="a01022_html_a81ef82bfd40dff69eb5b975c102133f2"><div class="ttname"><a href="a01022.html#a81ef82bfd40dff69eb5b975c102133f2">MPIGatherArraynDwGhosts</a></div><div class="ttdeci">int MPIGatherArraynDwGhosts(int, void *, double *, double *, int *, int *, int, int)</div><div class="ttdef"><b>Definition:</b> <a href="a01481_source.html#l00115">MPIGatherArraynD.c:115</a></div></div>
<div class="ttc" id="a01106_html_a00167df288a1ca2c6c32af8d911975e0"><div class="ttname"><a href="a01106.html#a00167df288a1ca2c6c32af8d911975e0">GridDimensions</a></div><div class="ttdeci">std::vector&lt; int &gt; GridDimensions</div><div class="ttdef"><b>Definition:</b> <a href="a01106_source.html#l00020">sparse_grids_simulation.h:20</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="aa22a121c18471b27623988d9ada894af"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa22a121c18471b27623988d9ada894af">&#9670;&nbsp;</a></span>computeError()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void computeError </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="a01100.html#a02400">SimulationObject</a> &amp;&#160;</td>
          <td class="paramname"><em>a_sim</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double * const&#160;</td>
          <td class="paramname"><em>a_uex</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Compute error for a simulation object</p>
<p>compute errors for a particular simulation object </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">a_sim</td><td><a class="el" href="a02396.html" title="Base class for a simulation. ">Simulation</a> object </td></tr>
    <tr><td class="paramname">a_uex</td><td>Exact solution </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="a02150_source.html#l00155">155</a> of file <a class="el" href="a02150_source.html">SparseGridsCalculateError.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;{</div><div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;  <span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">double</span> tolerance = 1e-15;</div><div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;</div><div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;  <a class="code" href="a02280.html">HyPar</a>* solver = &amp;(a_sim.<a class="code" href="a01100.html#a523947ce4fa7128c4c767163953253b9">solver</a>);</div><div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;  <a class="code" href="a01028.html#a02320">MPIVariables</a>* mpi = &amp;(a_sim.<a class="code" href="a01100.html#a4afd2c7b3eb8fda452474ebdbe71c8c0">mpi</a>);</div><div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;</div><div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;  <span class="keywordflow">if</span> (a_uex == NULL) {</div><div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;    fprintf(stderr, <span class="stringliteral">&quot;Error in SparseGrids::computeError() -\n&quot;</span>);</div><div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;    fprintf(stderr, <span class="stringliteral">&quot;  exact solution pointer in NULL.\n&quot;</span>);</div><div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;    exit(1);</div><div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;  }</div><div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;</div><div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;  <span class="comment">/* calculate solution norms (for relative error) */</span></div><div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;  <span class="keywordtype">double</span> <a class="code" href="a02264.html#aca1295e3cf52d990f4cd1d5872f1385a">sum</a>, global_sum;</div><div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;  <span class="keywordtype">double</span> solution_norm[3] = {0.0,0.0,0.0};</div><div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;  <span class="comment">/* L1 */</span></div><div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;  <a class="code" href="a02264.html#aca1295e3cf52d990f4cd1d5872f1385a">sum</a> = <a class="code" href="a00956.html#a60a3d838d95d860a21de20936f7bb910">ArraySumAbsnD</a>   (solver-&gt;<a class="code" href="a02280.html#ae8f6d2fd6490d3153cb4133bf183a404">nvars</a>,solver-&gt;<a class="code" href="a02280.html#a484873c74138512e41bc50d17b7d955a">ndims</a>,solver-&gt;<a class="code" href="a02280.html#a38e0371f331cecbe63a77fa03e202afe">dim_local</a>,</div><div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;                         solver-&gt;<a class="code" href="a02280.html#aafc992b5fa79d5a4036024615d03bce6">ghosts</a>,solver-&gt;<a class="code" href="a02280.html#a95e9e0f8a692321b83a2e0ce2789c485">index</a>,a_uex);</div><div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;  global_sum = 0; <a class="code" href="a01022.html#abd61f932b070ee84262d9d98b6dd854f">MPISum_double</a>(&amp;global_sum,&amp;<a class="code" href="a02264.html#aca1295e3cf52d990f4cd1d5872f1385a">sum</a>,1,&amp;mpi-&gt;<a class="code" href="a01028.html#adad7a6f85831f3ac84d854b6c80aef43">world</a>);</div><div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;  solution_norm[0] = global_sum/((double)solver-&gt;<a class="code" href="a02280.html#a4e67f54563a3c4ff005dfaf0130f957c">npoints_global</a>);</div><div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;  <span class="comment">/* L2 */</span></div><div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;  <a class="code" href="a02264.html#aca1295e3cf52d990f4cd1d5872f1385a">sum</a> = <a class="code" href="a00956.html#a8c279db0af78d8ff386cf1a023a405dd">ArraySumSquarenD</a>(solver-&gt;<a class="code" href="a02280.html#ae8f6d2fd6490d3153cb4133bf183a404">nvars</a>,solver-&gt;<a class="code" href="a02280.html#a484873c74138512e41bc50d17b7d955a">ndims</a>,solver-&gt;<a class="code" href="a02280.html#a38e0371f331cecbe63a77fa03e202afe">dim_local</a>,</div><div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;                         solver-&gt;<a class="code" href="a02280.html#aafc992b5fa79d5a4036024615d03bce6">ghosts</a>,solver-&gt;<a class="code" href="a02280.html#a95e9e0f8a692321b83a2e0ce2789c485">index</a>,a_uex);</div><div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;  global_sum = 0; <a class="code" href="a01022.html#abd61f932b070ee84262d9d98b6dd854f">MPISum_double</a>(&amp;global_sum,&amp;<a class="code" href="a02264.html#aca1295e3cf52d990f4cd1d5872f1385a">sum</a>,1,&amp;mpi-&gt;<a class="code" href="a01028.html#adad7a6f85831f3ac84d854b6c80aef43">world</a>);</div><div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;  solution_norm[1] = sqrt(global_sum/((<span class="keywordtype">double</span>)solver-&gt;<a class="code" href="a02280.html#a4e67f54563a3c4ff005dfaf0130f957c">npoints_global</a>));</div><div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;  <span class="comment">/* Linf */</span></div><div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;  <a class="code" href="a02264.html#aca1295e3cf52d990f4cd1d5872f1385a">sum</a> = <a class="code" href="a00956.html#ac20bd4916c6169956e5bf80777c6ab8f">ArrayMaxnD</a>      (solver-&gt;<a class="code" href="a02280.html#ae8f6d2fd6490d3153cb4133bf183a404">nvars</a>,solver-&gt;<a class="code" href="a02280.html#a484873c74138512e41bc50d17b7d955a">ndims</a>,solver-&gt;<a class="code" href="a02280.html#a38e0371f331cecbe63a77fa03e202afe">dim_local</a>,</div><div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;                         solver-&gt;<a class="code" href="a02280.html#aafc992b5fa79d5a4036024615d03bce6">ghosts</a>,solver-&gt;<a class="code" href="a02280.html#a95e9e0f8a692321b83a2e0ce2789c485">index</a>,a_uex);</div><div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;  global_sum = 0; <a class="code" href="a01022.html#a33aa37e0050ec72dadb8d63851df51ec">MPIMax_double</a>(&amp;global_sum,&amp;<a class="code" href="a02264.html#aca1295e3cf52d990f4cd1d5872f1385a">sum</a>,1,&amp;mpi-&gt;<a class="code" href="a01028.html#adad7a6f85831f3ac84d854b6c80aef43">world</a>);</div><div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;  solution_norm[2] = global_sum;</div><div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;</div><div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;  <span class="comment">/* compute error = difference between exact and numerical solution */</span></div><div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;  <span class="keywordtype">long</span> size = solver-&gt;<a class="code" href="a02280.html#ae8f6d2fd6490d3153cb4133bf183a404">nvars</a>*solver-&gt;<a class="code" href="a02280.html#a20ee1fd00a220b98513127884a5558cf">npoints_local_wghosts</a>;</div><div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;  <a class="code" href="a00956.html#a4cd66304bc41a7751842230af3063b62">_ArrayAXPY_</a>(solver-&gt;<a class="code" href="a02280.html#a3b6b999a764f1e2ea94bb5f28c7a558c">u</a>,-1.0,a_uex,size);</div><div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;</div><div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;  <span class="comment">/* calculate L1 norm of error */</span></div><div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;  <a class="code" href="a02264.html#aca1295e3cf52d990f4cd1d5872f1385a">sum</a> = <a class="code" href="a00956.html#a60a3d838d95d860a21de20936f7bb910">ArraySumAbsnD</a>   (solver-&gt;<a class="code" href="a02280.html#ae8f6d2fd6490d3153cb4133bf183a404">nvars</a>,solver-&gt;<a class="code" href="a02280.html#a484873c74138512e41bc50d17b7d955a">ndims</a>,solver-&gt;<a class="code" href="a02280.html#a38e0371f331cecbe63a77fa03e202afe">dim_local</a>,</div><div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;                         solver-&gt;<a class="code" href="a02280.html#aafc992b5fa79d5a4036024615d03bce6">ghosts</a>,solver-&gt;<a class="code" href="a02280.html#a95e9e0f8a692321b83a2e0ce2789c485">index</a>,a_uex);</div><div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;  global_sum = 0; <a class="code" href="a01022.html#abd61f932b070ee84262d9d98b6dd854f">MPISum_double</a>(&amp;global_sum,&amp;<a class="code" href="a02264.html#aca1295e3cf52d990f4cd1d5872f1385a">sum</a>,1,&amp;mpi-&gt;<a class="code" href="a01028.html#adad7a6f85831f3ac84d854b6c80aef43">world</a>);</div><div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;  solver-&gt;<a class="code" href="a02280.html#aa40f27cb2afa2db0f0468962be8b3679">error</a>[0] = global_sum/((double)solver-&gt;<a class="code" href="a02280.html#a4e67f54563a3c4ff005dfaf0130f957c">npoints_global</a>);</div><div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;</div><div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;  <span class="comment">/* calculate L2 norm of error */</span></div><div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;  <a class="code" href="a02264.html#aca1295e3cf52d990f4cd1d5872f1385a">sum</a> = <a class="code" href="a00956.html#a8c279db0af78d8ff386cf1a023a405dd">ArraySumSquarenD</a>(solver-&gt;<a class="code" href="a02280.html#ae8f6d2fd6490d3153cb4133bf183a404">nvars</a>,solver-&gt;<a class="code" href="a02280.html#a484873c74138512e41bc50d17b7d955a">ndims</a>,solver-&gt;<a class="code" href="a02280.html#a38e0371f331cecbe63a77fa03e202afe">dim_local</a>,</div><div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;                         solver-&gt;<a class="code" href="a02280.html#aafc992b5fa79d5a4036024615d03bce6">ghosts</a>,solver-&gt;<a class="code" href="a02280.html#a95e9e0f8a692321b83a2e0ce2789c485">index</a>,a_uex);</div><div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;  global_sum = 0; <a class="code" href="a01022.html#abd61f932b070ee84262d9d98b6dd854f">MPISum_double</a>(&amp;global_sum,&amp;<a class="code" href="a02264.html#aca1295e3cf52d990f4cd1d5872f1385a">sum</a>,1,&amp;mpi-&gt;<a class="code" href="a01028.html#adad7a6f85831f3ac84d854b6c80aef43">world</a>);</div><div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;  solver-&gt;<a class="code" href="a02280.html#aa40f27cb2afa2db0f0468962be8b3679">error</a>[1] = sqrt(global_sum/((<span class="keywordtype">double</span>)solver-&gt;<a class="code" href="a02280.html#a4e67f54563a3c4ff005dfaf0130f957c">npoints_global</a>));</div><div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;</div><div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;  <span class="comment">/* calculate Linf norm of error */</span></div><div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;  <a class="code" href="a02264.html#aca1295e3cf52d990f4cd1d5872f1385a">sum</a> = <a class="code" href="a00956.html#ac20bd4916c6169956e5bf80777c6ab8f">ArrayMaxnD</a>      (solver-&gt;<a class="code" href="a02280.html#ae8f6d2fd6490d3153cb4133bf183a404">nvars</a>,solver-&gt;<a class="code" href="a02280.html#a484873c74138512e41bc50d17b7d955a">ndims</a>,solver-&gt;<a class="code" href="a02280.html#a38e0371f331cecbe63a77fa03e202afe">dim_local</a>,</div><div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;                         solver-&gt;<a class="code" href="a02280.html#aafc992b5fa79d5a4036024615d03bce6">ghosts</a>,solver-&gt;<a class="code" href="a02280.html#a95e9e0f8a692321b83a2e0ce2789c485">index</a>,a_uex);</div><div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;  global_sum = 0; <a class="code" href="a01022.html#a33aa37e0050ec72dadb8d63851df51ec">MPIMax_double</a>(&amp;global_sum,&amp;<a class="code" href="a02264.html#aca1295e3cf52d990f4cd1d5872f1385a">sum</a>,1,&amp;mpi-&gt;<a class="code" href="a01028.html#adad7a6f85831f3ac84d854b6c80aef43">world</a>);</div><div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;  solver-&gt;<a class="code" href="a02280.html#aa40f27cb2afa2db0f0468962be8b3679">error</a>[2] = global_sum;</div><div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;</div><div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;  <span class="comment">/* </span></div><div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;<span class="comment">    decide whether to normalize and report relative errors, </span></div><div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;<span class="comment">    or report absolute errors.</span></div><div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;<span class="comment">  */</span></div><div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;  <span class="keywordflow">if</span> (    (solution_norm[0] &gt; tolerance) </div><div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;      &amp;&amp;  (solution_norm[1] &gt; tolerance) </div><div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;      &amp;&amp;  (solution_norm[2] &gt; tolerance) ) {</div><div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;    solver-&gt;<a class="code" href="a02280.html#aa40f27cb2afa2db0f0468962be8b3679">error</a>[0] /= solution_norm[0];</div><div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;    solver-&gt;<a class="code" href="a02280.html#aa40f27cb2afa2db0f0468962be8b3679">error</a>[1] /= solution_norm[1];</div><div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;    solver-&gt;<a class="code" href="a02280.html#aa40f27cb2afa2db0f0468962be8b3679">error</a>[2] /= solution_norm[2];</div><div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;  }</div><div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;</div><div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;  <span class="keywordflow">return</span>;</div><div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;}</div><div class="ttc" id="a02280_html_a484873c74138512e41bc50d17b7d955a"><div class="ttname"><a href="a02280.html#a484873c74138512e41bc50d17b7d955a">HyPar::ndims</a></div><div class="ttdeci">int ndims</div><div class="ttdef"><b>Definition:</b> <a href="a00986_source.html#l00026">hypar.h:26</a></div></div>
<div class="ttc" id="a02280_html"><div class="ttname"><a href="a02280.html">HyPar</a></div><div class="ttdoc">Structure containing all solver-specific variables and functions. </div><div class="ttdef"><b>Definition:</b> <a href="a00986_source.html#l00023">hypar.h:23</a></div></div>
<div class="ttc" id="a00956_html_a4cd66304bc41a7751842230af3063b62"><div class="ttname"><a href="a00956.html#a4cd66304bc41a7751842230af3063b62">_ArrayAXPY_</a></div><div class="ttdeci">#define _ArrayAXPY_(x, a, y, size)</div><div class="ttdef"><b>Definition:</b> <a href="a00956_source.html#l00271">arrayfunctions.h:271</a></div></div>
<div class="ttc" id="a00956_html_ac20bd4916c6169956e5bf80777c6ab8f"><div class="ttname"><a href="a00956.html#ac20bd4916c6169956e5bf80777c6ab8f">ArrayMaxnD</a></div><div class="ttdeci">INLINE double ArrayMaxnD(int, int, int *, int, int *, double *)</div><div class="ttdef"><b>Definition:</b> <a href="a00956_source.html#l00486">arrayfunctions.h:486</a></div></div>
<div class="ttc" id="a02280_html_a3b6b999a764f1e2ea94bb5f28c7a558c"><div class="ttname"><a href="a02280.html#a3b6b999a764f1e2ea94bb5f28c7a558c">HyPar::u</a></div><div class="ttdeci">double * u</div><div class="ttdef"><b>Definition:</b> <a href="a00986_source.html#l00116">hypar.h:116</a></div></div>
<div class="ttc" id="a01028_html_adad7a6f85831f3ac84d854b6c80aef43"><div class="ttname"><a href="a01028.html#adad7a6f85831f3ac84d854b6c80aef43">MPIVariables::world</a></div><div class="ttdeci">MPI_Comm world</div><div class="ttdef"><b>Definition:</b> <a href="a01028_source.html#l00037">mpivars_struct.h:37</a></div></div>
<div class="ttc" id="a01100_html_a523947ce4fa7128c4c767163953253b9"><div class="ttname"><a href="a01100.html#a523947ce4fa7128c4c767163953253b9">SimulationObject::solver</a></div><div class="ttdeci">HyPar solver</div><div class="ttdef"><b>Definition:</b> <a href="a01100_source.html#l00026">simulation_object.h:26</a></div></div>
<div class="ttc" id="a00956_html_a8c279db0af78d8ff386cf1a023a405dd"><div class="ttname"><a href="a00956.html#a8c279db0af78d8ff386cf1a023a405dd">ArraySumSquarenD</a></div><div class="ttdeci">INLINE double ArraySumSquarenD(int, int, int *, int, int *, double *)</div><div class="ttdef"><b>Definition:</b> <a href="a00956_source.html#l00529">arrayfunctions.h:529</a></div></div>
<div class="ttc" id="a01028_html_a02320"><div class="ttname"><a href="a01028.html#a02320">MPIVariables</a></div><div class="ttdoc">Structure of MPI-related variables. </div><div class="ttdef"><b>Definition:</b> <a href="a01028_source.html#l00024">mpivars_struct.h:24</a></div></div>
<div class="ttc" id="a01100_html_a4afd2c7b3eb8fda452474ebdbe71c8c0"><div class="ttname"><a href="a01100.html#a4afd2c7b3eb8fda452474ebdbe71c8c0">SimulationObject::mpi</a></div><div class="ttdeci">MPIVariables mpi</div><div class="ttdef"><b>Definition:</b> <a href="a01100_source.html#l00025">simulation_object.h:25</a></div></div>
<div class="ttc" id="a02264_html_aca1295e3cf52d990f4cd1d5872f1385a"><div class="ttname"><a href="a02264.html#aca1295e3cf52d990f4cd1d5872f1385a">StdVecOps::sum</a></div><div class="ttdeci">long sum(const std::vector&lt; int &gt; &amp;a_iv)</div><div class="ttdef"><b>Definition:</b> <a href="a01109_source.html#l00018">std_vec_ops.h:18</a></div></div>
<div class="ttc" id="a02280_html_aa40f27cb2afa2db0f0468962be8b3679"><div class="ttname"><a href="a02280.html#aa40f27cb2afa2db0f0468962be8b3679">HyPar::error</a></div><div class="ttdeci">double error[3]</div><div class="ttdef"><b>Definition:</b> <a href="a00986_source.html#l00366">hypar.h:366</a></div></div>
<div class="ttc" id="a01022_html_a33aa37e0050ec72dadb8d63851df51ec"><div class="ttname"><a href="a01022.html#a33aa37e0050ec72dadb8d63851df51ec">MPIMax_double</a></div><div class="ttdeci">int MPIMax_double(double *, double *, int, void *)</div><div class="ttdef"><b>Definition:</b> <a href="a01496_source.html#l00038">MPIMax.c:38</a></div></div>
<div class="ttc" id="a02280_html_a95e9e0f8a692321b83a2e0ce2789c485"><div class="ttname"><a href="a02280.html#a95e9e0f8a692321b83a2e0ce2789c485">HyPar::index</a></div><div class="ttdeci">int * index</div><div class="ttdef"><b>Definition:</b> <a href="a00986_source.html#l00102">hypar.h:102</a></div></div>
<div class="ttc" id="a00956_html_a60a3d838d95d860a21de20936f7bb910"><div class="ttname"><a href="a00956.html#a60a3d838d95d860a21de20936f7bb910">ArraySumAbsnD</a></div><div class="ttdeci">INLINE double ArraySumAbsnD(int, int, int *, int, int *, double *)</div><div class="ttdef"><b>Definition:</b> <a href="a00956_source.html#l00510">arrayfunctions.h:510</a></div></div>
<div class="ttc" id="a01022_html_abd61f932b070ee84262d9d98b6dd854f"><div class="ttname"><a href="a01022.html#abd61f932b070ee84262d9d98b6dd854f">MPISum_double</a></div><div class="ttdeci">int MPISum_double(double *, double *, int, void *)</div><div class="ttdef"><b>Definition:</b> <a href="a01517_source.html#l00039">MPISum.c:39</a></div></div>
<div class="ttc" id="a02280_html_a4e67f54563a3c4ff005dfaf0130f957c"><div class="ttname"><a href="a02280.html#a4e67f54563a3c4ff005dfaf0130f957c">HyPar::npoints_global</a></div><div class="ttdeci">int npoints_global</div><div class="ttdef"><b>Definition:</b> <a href="a00986_source.html#l00040">hypar.h:40</a></div></div>
<div class="ttc" id="a02280_html_a38e0371f331cecbe63a77fa03e202afe"><div class="ttname"><a href="a02280.html#a38e0371f331cecbe63a77fa03e202afe">HyPar::dim_local</a></div><div class="ttdeci">int * dim_local</div><div class="ttdef"><b>Definition:</b> <a href="a00986_source.html#l00037">hypar.h:37</a></div></div>
<div class="ttc" id="a02280_html_ae8f6d2fd6490d3153cb4133bf183a404"><div class="ttname"><a href="a02280.html#ae8f6d2fd6490d3153cb4133bf183a404">HyPar::nvars</a></div><div class="ttdeci">int nvars</div><div class="ttdef"><b>Definition:</b> <a href="a00986_source.html#l00029">hypar.h:29</a></div></div>
<div class="ttc" id="a02280_html_a20ee1fd00a220b98513127884a5558cf"><div class="ttname"><a href="a02280.html#a20ee1fd00a220b98513127884a5558cf">HyPar::npoints_local_wghosts</a></div><div class="ttdeci">int npoints_local_wghosts</div><div class="ttdef"><b>Definition:</b> <a href="a00986_source.html#l00042">hypar.h:42</a></div></div>
<div class="ttc" id="a02280_html_aafc992b5fa79d5a4036024615d03bce6"><div class="ttname"><a href="a02280.html#aafc992b5fa79d5a4036024615d03bce6">HyPar::ghosts</a></div><div class="ttdeci">int ghosts</div><div class="ttdef"><b>Definition:</b> <a href="a00986_source.html#l00052">hypar.h:52</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ad209b51783ddb3be5497d6cbe6a3e8af"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad209b51783ddb3be5497d6cbe6a3e8af">&#9670;&nbsp;</a></span>isPowerOfTwo()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool isPowerOfTwo </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>x</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Checks if an integer is a power of 2 </p>

<p class="definition">Definition at line <a class="el" href="a01106_source.html#l00317">317</a> of file <a class="el" href="a01106_source.html">sparse_grids_simulation.h</a>.</p>
<div class="fragment"><div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;    {</div><div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;      <span class="keywordflow">if</span> (x == 0)  <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;</div><div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;      <span class="keywordflow">while</span> (x &gt; 1) {</div><div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;        <span class="keywordflow">if</span> (x%2 != 0) <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;        x /= 2;</div><div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;      }</div><div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">true</span>;</div><div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;    }</div></div><!-- fragment -->
</div>
</div>
<a id="a0c79a01f9c78a0aeed162d6eafed4ad5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0c79a01f9c78a0aeed162d6eafed4ad5">&#9670;&nbsp;</a></span>cfunc()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">double cfunc </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>a</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>b</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>The combination/choose function from probability stuff </p>

<p class="definition">Definition at line <a class="el" href="a01106_source.html#l00329">329</a> of file <a class="el" href="a01106_source.html">sparse_grids_simulation.h</a>.</p>
<div class="fragment"><div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;    {</div><div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;      <span class="keywordflow">return</span> ( ( (<span class="keywordtype">double</span>)<a class="code" href="a02408.html#a5127a26373d94a3e3d4c46eca1e20cb7">factorial</a>(a) ) / ( (<span class="keywordtype">double</span>) (<a class="code" href="a02408.html#a5127a26373d94a3e3d4c46eca1e20cb7">factorial</a>(b)*<a class="code" href="a02408.html#a5127a26373d94a3e3d4c46eca1e20cb7">factorial</a>(a-b)) ) );</div><div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;    }</div><div class="ttc" id="a02408_html_a5127a26373d94a3e3d4c46eca1e20cb7"><div class="ttname"><a href="a02408.html#a5127a26373d94a3e3d4c46eca1e20cb7">SparseGridsSimulation::factorial</a></div><div class="ttdeci">int factorial(int a)</div><div class="ttdef"><b>Definition:</b> <a href="a01106_source.html#l00335">sparse_grids_simulation.h:335</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a5127a26373d94a3e3d4c46eca1e20cb7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5127a26373d94a3e3d4c46eca1e20cb7">&#9670;&nbsp;</a></span>factorial()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int factorial </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>a</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Factorial function </p>

<p class="definition">Definition at line <a class="el" href="a01106_source.html#l00335">335</a> of file <a class="el" href="a01106_source.html">sparse_grids_simulation.h</a>.</p>
<div class="fragment"><div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;    {</div><div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;      <span class="keywordtype">int</span> retval = 1.0;</div><div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=1; i&lt;=a; i++) retval *= i;</div><div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;      <span class="keywordflow">return</span> retval;</div><div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;    }</div></div><!-- fragment -->
</div>
</div>
<a id="a77a47bfc5b17b652a0ca888561f493e4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a77a47bfc5b17b652a0ca888561f493e4">&#9670;&nbsp;</a></span>allocateGridArrays()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void allocateGridArrays </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="a01106.html#a00167df288a1ca2c6c32af8d911975e0">GridDimensions</a> &amp;&#160;</td>
          <td class="paramname"><em>a_dim</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double **const&#160;</td>
          <td class="paramname"><em>a_x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>a_ngpt</em> = <code>0</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Allocate grid array given grid dimension </p>

<p class="definition">Definition at line <a class="el" href="a01106_source.html#l00343">343</a> of file <a class="el" href="a01106_source.html">sparse_grids_simulation.h</a>.</p>
<div class="fragment"><div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;    {</div><div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;      <a class="code" href="a01106.html#a00167df288a1ca2c6c32af8d911975e0">GridDimensions</a> dim_wghosts = a_dim;</div><div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;dim_wghosts.size(); i++) {</div><div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;        dim_wghosts[i] += (2*a_ngpt);</div><div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;      }</div><div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;      <span class="keywordtype">long</span> size_x = <a class="code" href="a02264.html#aca1295e3cf52d990f4cd1d5872f1385a">StdVecOps::sum</a>(dim_wghosts);</div><div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;      (*a_x) = (<span class="keywordtype">double</span>*) calloc (size_x, <span class="keyword">sizeof</span>(<span class="keywordtype">double</span>));</div><div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;size_x; i++) (*a_x)[i] = 0.0;</div><div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;      <span class="keywordflow">return</span>;</div><div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;    }</div><div class="ttc" id="a02264_html_aca1295e3cf52d990f4cd1d5872f1385a"><div class="ttname"><a href="a02264.html#aca1295e3cf52d990f4cd1d5872f1385a">StdVecOps::sum</a></div><div class="ttdeci">long sum(const std::vector&lt; int &gt; &amp;a_iv)</div><div class="ttdef"><b>Definition:</b> <a href="a01109_source.html#l00018">std_vec_ops.h:18</a></div></div>
<div class="ttc" id="a01106_html_a00167df288a1ca2c6c32af8d911975e0"><div class="ttname"><a href="a01106.html#a00167df288a1ca2c6c32af8d911975e0">GridDimensions</a></div><div class="ttdeci">std::vector&lt; int &gt; GridDimensions</div><div class="ttdef"><b>Definition:</b> <a href="a01106_source.html#l00020">sparse_grids_simulation.h:20</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a00beed94b3f705d20db508533bfc0fc0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a00beed94b3f705d20db508533bfc0fc0">&#9670;&nbsp;</a></span>allocateDataArrays()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void allocateDataArrays </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="a01106.html#a00167df288a1ca2c6c32af8d911975e0">GridDimensions</a> &amp;&#160;</td>
          <td class="paramname"><em>a_dim</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>a_nvars</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double **const&#160;</td>
          <td class="paramname"><em>a_u</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>a_ngpt</em> = <code>0</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Allocate data arrays given grid dimension </p>

<p class="definition">Definition at line <a class="el" href="a01106_source.html#l00358">358</a> of file <a class="el" href="a01106_source.html">sparse_grids_simulation.h</a>.</p>
<div class="fragment"><div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;    {</div><div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;      <a class="code" href="a01106.html#a00167df288a1ca2c6c32af8d911975e0">GridDimensions</a> dim_wghosts = a_dim;</div><div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;dim_wghosts.size(); i++) {</div><div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;        dim_wghosts[i] += (2*a_ngpt);</div><div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;      }</div><div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;      <span class="keywordtype">long</span> size_u = a_nvars*<a class="code" href="a02264.html#ad74c53c19ad5dfb91fadd66c774e33bc">StdVecOps::product</a>(dim_wghosts);</div><div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;      (*a_u) = (<span class="keywordtype">double</span>*) calloc (size_u, <span class="keyword">sizeof</span>(<span class="keywordtype">double</span>));</div><div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;size_u; i++) (*a_u)[i] = 0.0;</div><div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;      <span class="keywordflow">return</span>;</div><div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;    }</div><div class="ttc" id="a01106_html_a00167df288a1ca2c6c32af8d911975e0"><div class="ttname"><a href="a01106.html#a00167df288a1ca2c6c32af8d911975e0">GridDimensions</a></div><div class="ttdeci">std::vector&lt; int &gt; GridDimensions</div><div class="ttdef"><b>Definition:</b> <a href="a01106_source.html#l00020">sparse_grids_simulation.h:20</a></div></div>
<div class="ttc" id="a02264_html_ad74c53c19ad5dfb91fadd66c774e33bc"><div class="ttname"><a href="a02264.html#ad74c53c19ad5dfb91fadd66c774e33bc">StdVecOps::product</a></div><div class="ttdeci">long product(const std::vector&lt; int &gt; &amp;a_iv)</div><div class="ttdef"><b>Definition:</b> <a href="a01109_source.html#l00027">std_vec_ops.h:27</a></div></div>
</div><!-- fragment -->
</div>
</div>
<h2 class="groupheader">Field Documentation</h2>
<a id="a4c049947a4c07f2d2df7d1374a4babae"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4c049947a4c07f2d2df7d1374a4babae">&#9670;&nbsp;</a></span>m_is_defined</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool m_is_defined</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Boolean to show if this object is defined </p>

<p class="definition">Definition at line <a class="el" href="a01106_source.html#l00212">212</a> of file <a class="el" href="a01106_source.html">sparse_grids_simulation.h</a>.</p>

</div>
</div>
<a id="acd95922d6bb09419fb66435d114cdb5c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#acd95922d6bb09419fb66435d114cdb5c">&#9670;&nbsp;</a></span>m_nsims_sg</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int m_nsims_sg</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Number of sparse grids simulations </p>

<p class="definition">Definition at line <a class="el" href="a01106_source.html#l00214">214</a> of file <a class="el" href="a01106_source.html">sparse_grids_simulation.h</a>.</p>

</div>
</div>
<a id="af3c229deae2a8e788c823dcc6f020b65"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af3c229deae2a8e788c823dcc6f020b65">&#9670;&nbsp;</a></span>m_ndims</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int m_ndims</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Number of spatial dimensions </p>

<p class="definition">Definition at line <a class="el" href="a01106_source.html#l00215">215</a> of file <a class="el" href="a01106_source.html">sparse_grids_simulation.h</a>.</p>

</div>
</div>
<a id="ac6a822dc76382e4027cf94ac3e510056"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac6a822dc76382e4027cf94ac3e510056">&#9670;&nbsp;</a></span>m_rank</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int m_rank</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>MPI rank of this process </p>

<p class="definition">Definition at line <a class="el" href="a01106_source.html#l00216">216</a> of file <a class="el" href="a01106_source.html">sparse_grids_simulation.h</a>.</p>

</div>
</div>
<a id="ae5bbe5daa629a4f92b569cb632256780"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae5bbe5daa629a4f92b569cb632256780">&#9670;&nbsp;</a></span>m_nproc</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int m_nproc</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Total number of MPI ranks </p>

<p class="definition">Definition at line <a class="el" href="a01106_source.html#l00216">216</a> of file <a class="el" href="a01106_source.html">sparse_grids_simulation.h</a>.</p>

</div>
</div>
<a id="a80c52a96f6a5a4851ac860d751587df6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a80c52a96f6a5a4851ac860d751587df6">&#9670;&nbsp;</a></span>m_interp_order</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int m_interp_order</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Order of interpolation between grids (input - <b>sparse_grids.inp</b> ) </p>

<p class="definition">Definition at line <a class="el" href="a01106_source.html#l00220">220</a> of file <a class="el" href="a01106_source.html">sparse_grids_simulation.h</a>.</p>

</div>
</div>
<a id="a1fde282f4347462c9c2dd34aac2ad998"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1fde282f4347462c9c2dd34aac2ad998">&#9670;&nbsp;</a></span>m_is_periodic</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt;bool&gt; m_is_periodic</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Periodicity along each dimension </p>

<p class="definition">Definition at line <a class="el" href="a01106_source.html#l00222">222</a> of file <a class="el" href="a01106_source.html">sparse_grids_simulation.h</a>.</p>

</div>
</div>
<a id="a634b90e62b481c87ad0ba4ee5c5feba4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a634b90e62b481c87ad0ba4ee5c5feba4">&#9670;&nbsp;</a></span>m_write_sg_solutions</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int m_write_sg_solutions</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Write out the sparse grid solutions to file? (input - <b>sparse_grids.inp</b> ) </p>

<p class="definition">Definition at line <a class="el" href="a01106_source.html#l00225">225</a> of file <a class="el" href="a01106_source.html">sparse_grids_simulation.h</a>.</p>

</div>
</div>
<a id="a8ccd402501119573dbadc7d6e96c59a2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8ccd402501119573dbadc7d6e96c59a2">&#9670;&nbsp;</a></span>m_print_sg_errors</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int m_print_sg_errors</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Print and write out the sparse grid errors? (input - <b>sparse_grids.inp</b> ) </p>

<p class="definition">Definition at line <a class="el" href="a01106_source.html#l00228">228</a> of file <a class="el" href="a01106_source.html">sparse_grids_simulation.h</a>.</p>

</div>
</div>
<a id="a41a86f682aa37c28c671759a11a494a8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a41a86f682aa37c28c671759a11a494a8">&#9670;&nbsp;</a></span>m_sim_fg</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="a01100.html#a02400">SimulationObject</a>* m_sim_fg</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>full grid simulation object </p>

<p class="definition">Definition at line <a class="el" href="a01106_source.html#l00230">230</a> of file <a class="el" href="a01106_source.html">sparse_grids_simulation.h</a>.</p>

</div>
</div>
<a id="afd006361179964b4e2c2cc65526247bd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afd006361179964b4e2c2cc65526247bd">&#9670;&nbsp;</a></span>m_sims_sg</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt;<a class="el" href="a01100.html#a02400">SimulationObject</a>&gt; m_sims_sg</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>vector of sparse grids simulation objects </p>

<p class="definition">Definition at line <a class="el" href="a01106_source.html#l00231">231</a> of file <a class="el" href="a01106_source.html">sparse_grids_simulation.h</a>.</p>

</div>
</div>
<a id="adda60102f329d6d2f76ba7ff11e84564"></a>
<h2 class="memtitle"><span class="permalink"><a href="#adda60102f329d6d2f76ba7ff11e84564">&#9670;&nbsp;</a></span>m_n_fg</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int m_n_fg</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Base2 log of the number of grid points along a dimension of the full grid </p>

<p class="definition">Definition at line <a class="el" href="a01106_source.html#l00233">233</a> of file <a class="el" href="a01106_source.html">sparse_grids_simulation.h</a>.</p>

</div>
</div>
<a id="a2e5b2d1500a445715e53baba327b79a7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2e5b2d1500a445715e53baba327b79a7">&#9670;&nbsp;</a></span>m_imin</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int m_imin</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Base2 log of the minimum number of grid points along any dimension (input - <b>sparse_grids.inp</b> ) </p>

<p class="definition">Definition at line <a class="el" href="a01106_source.html#l00234">234</a> of file <a class="el" href="a01106_source.html">sparse_grids_simulation.h</a>.</p>

</div>
</div>
<a id="a8b468da0c8b3831ae8b1519d8781245f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8b468da0c8b3831ae8b1519d8781245f">&#9670;&nbsp;</a></span>m_combination</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt;<a class="el" href="a01106.html#a1ae060a4950606cbd05aca1122c4a890">SGCTElem</a>&gt; m_combination</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Coefficients and grid dimensions for the combination technique </p>

<p class="definition">Definition at line <a class="el" href="a01106_source.html#l00236">236</a> of file <a class="el" href="a01106_source.html">sparse_grids_simulation.h</a>.</p>

</div>
</div>
<a id="a5da433fbee71264a45061bb0b3063326"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5da433fbee71264a45061bb0b3063326">&#9670;&nbsp;</a></span>m_iprocs</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt;<a class="el" href="a01106.html#a4e1436c018a5aad717fb73ca9004bcfc">ProcDistribution</a>&gt; m_iprocs</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>MPI ranks along each dimension for the grids in the combination technique </p>

<p class="definition">Definition at line <a class="el" href="a01106_source.html#l00237">237</a> of file <a class="el" href="a01106_source.html">sparse_grids_simulation.h</a>.</p>

</div>
</div>
<hr/>The documentation for this class was generated from the following files:<ul>
<li>include/<a class="el" href="a01106_source.html">sparse_grids_simulation.h</a></li>
<li>src/SparseGrids/<a class="el" href="a02150_source.html">SparseGridsCalculateError.cpp</a></li>
<li>src/SparseGrids/<a class="el" href="a02153_source.html">SparseGridsCombinationTechnique.cpp</a></li>
<li>src/SparseGrids/<a class="el" href="a02156_source.html">SparseGridsDefine.cpp</a></li>
<li>src/SparseGrids/<a class="el" href="a02159_source.html">SparseGridsFillGhostCells.cpp</a></li>
<li>src/SparseGrids/<a class="el" href="a02162_source.html">SparseGridsInitializationWrapup.cpp</a></li>
<li>src/SparseGrids/<a class="el" href="a02165_source.html">SparseGridsInitialize.cpp</a></li>
<li>src/SparseGrids/<a class="el" href="a02168_source.html">SparseGridsInitialSolution.cpp</a></li>
<li>src/SparseGrids/<a class="el" href="a02171_source.html">SparseGridsInterpolate.cpp</a></li>
<li>src/SparseGrids/<a class="el" href="a02174_source.html">SparseGridsInterpolateGrid.cpp</a></li>
<li>src/SparseGrids/<a class="el" href="a02177_source.html">SparseGridsMiscFuncs.cpp</a></li>
<li>src/SparseGrids/<a class="el" href="a02180_source.html">SparseGridsOutputSolution.cpp</a></li>
<li>src/SparseGrids/<a class="el" href="a02183_source.html">SparseGridsSanityChecks.cpp</a></li>
<li>src/SparseGrids/<a class="el" href="a02186_source.html">SparseGridsSetSolverParameters.cpp</a></li>
<li>src/SparseGrids/<a class="el" href="a02189_source.html">SparseGridsSolve.cpp</a></li>
<li>src/SparseGrids/<a class="el" href="a02192_source.html">SparseGridsWriteErrors.cpp</a></li>
</ul>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- Start of StatCounter Code for Default Guide -->
<script type="text/javascript">
var sc_project=10897352; 
var sc_invisible=1; 
var sc_security="83042f57"; 
var scJsHost = (("https:" == document.location.protocol) ?
"https://secure." : "http://www.");
document.write("<sc"+"ript type='text/javascript' src='" +
scJsHost+
"statcounter.com/counter/counter.js'></"+"script>");
</script>
<noscript><div class="statcounter"><a title="website
statistics" href="http://statcounter.com/"
target="_blank"><img class="statcounter"
src="//c.statcounter.com/10897352/0/83042f57/1/"
alt="website statistics"></a></div></noscript>
<!-- End of StatCounter Code for Default Guide -->
