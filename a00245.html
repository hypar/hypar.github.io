<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.5"/>
<title>HyPar: include/simulation.h File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script><script src="http://cdn.mathjax.org/mathjax/latest/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="doxygen_html_style.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">HyPar
   &#160;<span id="projectnumber">1.0</span>
   </div>
   <div id="projectbrief">Finite-Difference Hyperbolic-Parabolic PDE Solver on Cartesian Grids</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.5 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Structures</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>Globals</span></a></li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('a00245.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Data Structures</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Namespaces</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Macros</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Pages</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#nested-classes">Data Structures</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">simulation.h File Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>Base class for simulation and declarations for C functions.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &lt;<a class="el" href="a00208_source.html">simulation_object.h</a>&gt;</code><br/>
<code>#include &lt;<a class="el" href="a00235_source.html">mpivars_cpp.h</a>&gt;</code><br/>
<code>#include &lt;<a class="el" href="a00236_source.html">petscinterface.h</a>&gt;</code><br/>
</div>
<p><a href="a00245_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="nested-classes"></a>
Data Structures</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00207.html">Simulation</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Base class for a simulation.  <a href="a00207.html#details">More...</a><br/></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a31fac45bcc0a8e9dd578cc1d8515d173"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00245.html#a31fac45bcc0a8e9dd578cc1d8515d173">ReadInputs</a> (void *, int, int)</td></tr>
<tr class="separator:a31fac45bcc0a8e9dd578cc1d8515d173"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab7f2f81eb1c5fa3514754cac29eee868"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00245.html#ab7f2f81eb1c5fa3514754cac29eee868">WriteInputs</a> (void *, int, int)</td></tr>
<tr class="separator:ab7f2f81eb1c5fa3514754cac29eee868"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a74087f11196b3689b296e53eb14b69f3"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00245.html#a74087f11196b3689b296e53eb14b69f3">Initialize</a> (void *, int)</td></tr>
<tr class="separator:a74087f11196b3689b296e53eb14b69f3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a23523232e5e6dd7cdec11754be4c21aa"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00245.html#a23523232e5e6dd7cdec11754be4c21aa">InitialSolution</a> (void *, int)</td></tr>
<tr class="separator:a23523232e5e6dd7cdec11754be4c21aa"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3a27bf10eed2122900356dd89b66731b"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00245.html#a3a27bf10eed2122900356dd89b66731b">InitializeBoundaries</a> (void *, int)</td></tr>
<tr class="separator:a3a27bf10eed2122900356dd89b66731b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6ac8578eb0216a84307bfb3b2fba816f"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00245.html#a6ac8578eb0216a84307bfb3b2fba816f">InitializeImmersedBoundaries</a> (void *, int)</td></tr>
<tr class="separator:a6ac8578eb0216a84307bfb3b2fba816f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5dc056a75d14ab6ba9292bcad6928a72"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00245.html#a5dc056a75d14ab6ba9292bcad6928a72">InitializePhysics</a> (void *, int)</td></tr>
<tr class="separator:a5dc056a75d14ab6ba9292bcad6928a72"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a71b1a72469ef2aa60521dcfb2fda2f1a"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00245.html#a71b1a72469ef2aa60521dcfb2fda2f1a">InitializePhysicsData</a> (void *, int, int, int *)</td></tr>
<tr class="separator:a71b1a72469ef2aa60521dcfb2fda2f1a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad3f393b89ecd5a544c52e1099722337a"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00245.html#ad3f393b89ecd5a544c52e1099722337a">InitializeSolvers</a> (void *, int)</td></tr>
<tr class="separator:ad3f393b89ecd5a544c52e1099722337a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a315baa877650032461e4cc97eef45b6f"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00245.html#a315baa877650032461e4cc97eef45b6f">Cleanup</a> (void *, int)</td></tr>
<tr class="separator:a315baa877650032461e4cc97eef45b6f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad7007f198eeb61eb9f73f7ab0df71900"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00245.html#ad7007f198eeb61eb9f73f7ab0df71900">SimWriteErrors</a> (void *, int, int, double, double)</td></tr>
<tr class="separator:ad7007f198eeb61eb9f73f7ab0df71900"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1a054e1b92ee41a9e38926d18c6628bf"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00245.html#a1a054e1b92ee41a9e38926d18c6628bf">SolvePETSc</a> (void *, int, int, int)</td></tr>
<tr class="memdesc:a1a054e1b92ee41a9e38926d18c6628bf"><td class="mdescLeft">&#160;</td><td class="mdescRight">Integrate in time with PETSc.  <a href="#a1a054e1b92ee41a9e38926d18c6628bf">More...</a><br/></td></tr>
<tr class="separator:a1a054e1b92ee41a9e38926d18c6628bf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7347183ec04d39b43cf35d1fe68ace4d"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00245.html#a7347183ec04d39b43cf35d1fe68ace4d">Solve</a> (void *, int, int, int)</td></tr>
<tr class="separator:a7347183ec04d39b43cf35d1fe68ace4d"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Base class for simulation and declarations for C functions. </p>
<dl class="section author"><dt>Author</dt><dd>Debojyoti Ghosh </dd></dl>

<p>Definition in file <a class="el" href="a00245_source.html">simulation.h</a>.</p>
</div><h2 class="groupheader">Function Documentation</h2>
<a class="anchor" id="a31fac45bcc0a8e9dd578cc1d8515d173"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ReadInputs </td>
          <td>(</td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>s</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>nsims</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>rank</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Read the input parameters</p>
<p>Read the simulation inputs from the file <b>solver.inp</b>. Rank 0 reads in the inputs and broadcasts them to all the processors.<br/>
<br/>
The format of <b>solver.inp</b> is as follows:<br/>
</p>
<pre class="fragment">begin
    &lt;keyword&gt;   &lt;value&gt;
    &lt;keyword&gt;   &lt;value&gt;
    &lt;keyword&gt;   &lt;value&gt;
    ...
    &lt;keyword&gt;   &lt;value&gt;
end
</pre><p>where the list of keywords and their type are:<br/>
</p>
<table class="doxtable">
<tr>
<th>Keyword name </th><th>Type </th><th>Variable </th><th>Default value  </th></tr>
<tr>
<td>ndims </td><td>int </td><td><a class="el" href="a00194.html#a484873c74138512e41bc50d17b7d955a">HyPar::ndims</a> </td><td>1 </td></tr>
<tr>
<td>nvars </td><td>int </td><td><a class="el" href="a00194.html#ae8f6d2fd6490d3153cb4133bf183a404">HyPar::nvars</a> </td><td>1 </td></tr>
<tr>
<td>size </td><td>int[ndims] </td><td><a class="el" href="a00194.html#aa989ebb755986852177779cdf7bd8c85">HyPar::dim_global</a> </td><td>must be specified </td></tr>
<tr>
<td>iproc </td><td>int[ndims] </td><td><a class="el" href="a00197.html#a0be0f30a83bc3f3d9f6ee3a36bbf2716">MPIVariables::iproc</a> </td><td>must be specified (see notes below) </td></tr>
<tr>
<td>ghost </td><td>int </td><td><a class="el" href="a00194.html#aafc992b5fa79d5a4036024615d03bce6">HyPar::ghosts</a> </td><td>1 </td></tr>
<tr>
<td>n_iter </td><td>int </td><td><a class="el" href="a00194.html#af0d8e0d5d3de3869b941b66b6caaf964">HyPar::n_iter</a> </td><td>0 </td></tr>
<tr>
<td>restart_iter </td><td>int </td><td><a class="el" href="a00194.html#aafb41b96563d9966e8e9f458751f2960">HyPar::restart_iter</a> </td><td>0 </td></tr>
<tr>
<td>time_scheme </td><td>char[] </td><td><a class="el" href="a00194.html#a138e751362d14724df8e6ab27c4a5e55">HyPar::time_scheme</a> </td><td>euler </td></tr>
<tr>
<td>time_scheme_type </td><td>char[] </td><td><a class="el" href="a00194.html#a61750696383420ba8bcc7d9e44a538e2">HyPar::time_scheme_type</a> </td><td>none </td></tr>
<tr>
<td>hyp_space_scheme </td><td>char[] </td><td><a class="el" href="a00194.html#ad29846eeb9c83b329a8d7c1fe69d46b2">HyPar::spatial_scheme_hyp</a> </td><td>1 </td></tr>
<tr>
<td>hyp_flux_split </td><td>char[] </td><td><a class="el" href="a00194.html#a5bed0cb9665daad89f4377c4f7609df4">HyPar::SplitHyperbolicFlux</a> </td><td>no </td></tr>
<tr>
<td>hyp_interp_type </td><td>char[] </td><td><a class="el" href="a00194.html#a9591ba0fadb863561474e2ba251d2594">HyPar::interp_type</a> </td><td>characteristic </td></tr>
<tr>
<td>par_space_type </td><td>char[] </td><td><a class="el" href="a00194.html#ad45d57b33d578bf602574a221bf53d93">HyPar::spatial_type_par</a> </td><td>nonconservative-1stage </td></tr>
<tr>
<td>par_space_scheme </td><td>char[] </td><td><a class="el" href="a00194.html#a170f2f6cc8ac86b78fcb376c2392e290">HyPar::spatial_scheme_par</a> </td><td>2 </td></tr>
<tr>
<td>dt </td><td>double </td><td><a class="el" href="a00194.html#a03e28be41881b703c836edbfe9b51b17">HyPar::dt</a> </td><td>0.0 </td></tr>
<tr>
<td>conservation_check </td><td>char[] </td><td><a class="el" href="a00194.html#ac92c34fe456d92c694eacd2231f5a7b1">HyPar::ConservationCheck</a> </td><td>no </td></tr>
<tr>
<td>screen_op_iter </td><td>int </td><td><a class="el" href="a00194.html#a74ff7fa96cbfc4ee87f508f964e94409">HyPar::screen_op_iter</a> </td><td>1 </td></tr>
<tr>
<td>file_op_iter </td><td>int </td><td><a class="el" href="a00194.html#a6ff746b30ee55a3bbb9f3306c145f27a">HyPar::file_op_iter</a> </td><td>1000 </td></tr>
<tr>
<td>op_file_format </td><td>char[] </td><td><a class="el" href="a00194.html#a51a3b8c19b86e9e1df5be02b05a6613c">HyPar::op_file_format</a> </td><td>text </td></tr>
<tr>
<td>ip_file_type </td><td>char[] </td><td><a class="el" href="a00194.html#a83f3dcd022f744511a44f2a31a824ac8">HyPar::ip_file_type</a> </td><td>ascii </td></tr>
<tr>
<td>input_mode </td><td>char[] </td><td><a class="el" href="a00194.html#a0a0b9dc97c7c278a019939d301db9399">HyPar::input_mode</a> </td><td>serial </td></tr>
<tr>
<td>output_mode </td><td>char[] </td><td><a class="el" href="a00194.html#a5f89e286a9eaffdb66d966fa6a290d3f">HyPar::output_mode</a> </td><td>serial </td></tr>
<tr>
<td>op_overwrite </td><td>char[] </td><td><a class="el" href="a00194.html#a4e93cb107e180ef982b74cef7726b70f">HyPar::op_overwrite</a> </td><td>no </td></tr>
<tr>
<td>model </td><td>char[] </td><td><a class="el" href="a00194.html#ad3fe4b266b398f3a7567ac1b241d99a2">HyPar::model</a> </td><td>must be specified </td></tr>
<tr>
<td>immersed_body </td><td>char[] </td><td><a class="el" href="a00194.html#a43ee3672350b4fd385871b6512e5d47b">HyPar::ib_filename</a> </td><td>"none" </td></tr>
<tr>
<td>size_exact </td><td>int[ndims] </td><td><a class="el" href="a00194.html#a9a4a95bad0d4f4769e5e3cd8798a158a">HyPar::dim_global_ex</a> </td><td><a class="el" href="a00194.html#aa989ebb755986852177779cdf7bd8c85">HyPar::dim_global</a> </td></tr>
</table>
<p><b>Notes:</b> </p>
<ul>
<li>"ndims" <b>must</b> be specified <b>before</b> "size".</li>
<li>the input "iproc" is ignored when running a sparse grids simulation.</li>
<li><p class="startli">if "input_mode" or "output_mode" are set to "parallel" or "mpi-io", the number of I/O ranks must be specified right after as an integer. For example: </p>
<pre class="fragment">begin
    ...
    input_mode  parallel 4
    ...
end
</pre><p class="startli">This means that 4 MPI ranks will participate in file I/O (assuming total MPI ranks is more than 4) (see <a class="el" href="a00340.html#adaa1bd7f962777f3b7ce886a94a8338e">ReadArrayParallel()</a>, <a class="el" href="a00342.html#a1548f4cea5254257d93790952941c351">WriteArrayParallel()</a>, <a class="el" href="a00340.html#ac69cac66cd56d57f21a094418a649714">ReadArrayMPI_IO()</a> ).</p>
<ul>
<li>The number of I/O ranks specified for "input_mode" and "output_mode" <b>must</b> <b>be</b> <b>same</b>. Otherwise, the value for the one specified last will be used.</li>
<li>The number of I/O ranks must be such that the total number of MPI ranks is an integer multiple. Otherwise, the code will use only 1 I/O rank.</li>
</ul>
</li>
<li>If any of the keywords are not present, the default value is used, except the ones whose default values say "must be specified". Thus, keywords that are not required for a particular simulation may be left out of the solver.inp input file. For example,<ul>
<li>a <a class="el" href="a00187.html" title="Structure containing variables and parameters specific to the 1D Euler equations. This structure cont...">Euler1D</a> simulation does not need "par_space_type" or "par_space_scheme" because it does not have a parabolic term.</li>
<li>unless a conservation check is required, "conservation_check" can be left out and the code will not check for conservation.</li>
<li>"immersed_body" need not be specified if there are no immersed bodies present. <b>NOTE:</b> However, if it is specified, and a file of that filename does not exist, it will result in an error. </li>
</ul>
</li>
</ul>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">s</td><td>Array of simulation objects of type <a class="el" href="a00208.html#a00626" title="Structure defining a simulation. ">SimulationObject</a> of size nsims </td></tr>
    <tr><td class="paramname">nsims</td><td>Number of simulation objects </td></tr>
    <tr><td class="paramname">rank</td><td>MPI rank of this process </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="a00561_source.html#l00090">90</a> of file <a class="el" href="a00561_source.html">ReadInputs.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;{</div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;  <a class="code" href="a00208.html#a00626">SimulationObject</a> *sim = (<a class="code" href="a00208.html#a00626">SimulationObject</a>*) s;</div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;  <span class="keywordtype">int</span> n, ferr    = 0;</div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;</div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;  <span class="keywordflow">if</span> (sim == NULL) {</div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;    printf(<span class="stringliteral">&quot;Error: simulation object array is NULL!\n&quot;</span>);</div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;    printf(<span class="stringliteral">&quot;Please consider killing this run.\n&quot;</span>);</div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;    <span class="keywordflow">return</span>(1);</div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;  }</div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;</div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;  <span class="keywordflow">if</span> (!rank) {</div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;</div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;    <span class="comment">/* set some default values for optional inputs */</span></div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;    <span class="keywordflow">for</span> (n = 0; n &lt; nsims; n++) {</div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;      sim[n].<a class="code" href="a00208.html#a523947ce4fa7128c4c767163953253b9">solver</a>.<a class="code" href="a00194.html#a484873c74138512e41bc50d17b7d955a">ndims</a>           = 1;</div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;      sim[n].<a class="code" href="a00208.html#a523947ce4fa7128c4c767163953253b9">solver</a>.<a class="code" href="a00194.html#ae8f6d2fd6490d3153cb4133bf183a404">nvars</a>           = 1;</div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;      sim[n].<a class="code" href="a00208.html#a523947ce4fa7128c4c767163953253b9">solver</a>.<a class="code" href="a00194.html#aafc992b5fa79d5a4036024615d03bce6">ghosts</a>          = 1;</div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;      sim[n].<a class="code" href="a00208.html#a523947ce4fa7128c4c767163953253b9">solver</a>.<a class="code" href="a00194.html#aa989ebb755986852177779cdf7bd8c85">dim_global</a>      = NULL;</div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;      sim[n].<a class="code" href="a00208.html#a523947ce4fa7128c4c767163953253b9">solver</a>.<a class="code" href="a00194.html#a38e0371f331cecbe63a77fa03e202afe">dim_local</a>       = NULL;</div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;      sim[n].<a class="code" href="a00208.html#a523947ce4fa7128c4c767163953253b9">solver</a>.<a class="code" href="a00194.html#a9a4a95bad0d4f4769e5e3cd8798a158a">dim_global_ex</a>   = NULL;</div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;      sim[n].<a class="code" href="a00208.html#a4afd2c7b3eb8fda452474ebdbe71c8c0">mpi</a>.<a class="code" href="a00197.html#a0be0f30a83bc3f3d9f6ee3a36bbf2716">iproc</a>              = NULL;</div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;      sim[n].<a class="code" href="a00208.html#a4afd2c7b3eb8fda452474ebdbe71c8c0">mpi</a>.<a class="code" href="a00197.html#a297fca986fa3aa27de07a0c746ffaaa8">N_IORanks</a>          = 1;</div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;      sim[n].<a class="code" href="a00208.html#a523947ce4fa7128c4c767163953253b9">solver</a>.<a class="code" href="a00194.html#a03e28be41881b703c836edbfe9b51b17">dt</a>              = 0.0;</div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;      sim[n].<a class="code" href="a00208.html#a523947ce4fa7128c4c767163953253b9">solver</a>.<a class="code" href="a00194.html#af0d8e0d5d3de3869b941b66b6caaf964">n_iter</a>          = 0;</div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;      sim[n].<a class="code" href="a00208.html#a523947ce4fa7128c4c767163953253b9">solver</a>.<a class="code" href="a00194.html#aafb41b96563d9966e8e9f458751f2960">restart_iter</a>    = 0;</div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;      sim[n].<a class="code" href="a00208.html#a523947ce4fa7128c4c767163953253b9">solver</a>.<a class="code" href="a00194.html#a74ff7fa96cbfc4ee87f508f964e94409">screen_op_iter</a>  = 1;</div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;      sim[n].<a class="code" href="a00208.html#a523947ce4fa7128c4c767163953253b9">solver</a>.<a class="code" href="a00194.html#a6ff746b30ee55a3bbb9f3306c145f27a">file_op_iter</a>    = 1000;</div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;      sim[n].<a class="code" href="a00208.html#a523947ce4fa7128c4c767163953253b9">solver</a>.<a class="code" href="a00194.html#aa6022244a5ae02a5f457172dbf69f3e5">write_residual</a>  = 0;</div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;      sim[n].<a class="code" href="a00208.html#a523947ce4fa7128c4c767163953253b9">solver</a>.<a class="code" href="a00194.html#ae83b1b0117b6a805ead2e4728945814c">flag_ib</a>         = 0;</div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;      strcpy(sim[n].solver.time_scheme        ,<span class="stringliteral">&quot;euler&quot;</span>         );</div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;      strcpy(sim[n].solver.time_scheme_type   ,<span class="stringliteral">&quot; &quot;</span>             );</div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;      strcpy(sim[n].solver.spatial_scheme_hyp ,<span class="stringliteral">&quot;1&quot;</span>             );</div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;      strcpy(sim[n].solver.spatial_type_par   ,<a class="code" href="a00224.html#a18ee8cd9b4297a259b08aa4cdfe30aa1">_NC_1STAGE_</a>     );</div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;      strcpy(sim[n].solver.spatial_scheme_par ,<span class="stringliteral">&quot;2&quot;</span>             );</div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;      strcpy(sim[n].solver.interp_type        ,<span class="stringliteral">&quot;characteristic&quot;</span>);</div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;      strcpy(sim[n].solver.ip_file_type       ,<span class="stringliteral">&quot;ascii&quot;</span>         );</div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;      strcpy(sim[n].solver.input_mode         ,<span class="stringliteral">&quot;serial&quot;</span>        );</div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;      strcpy(sim[n].solver.output_mode        ,<span class="stringliteral">&quot;serial&quot;</span>        );</div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;      strcpy(sim[n].solver.op_file_format     ,<span class="stringliteral">&quot;text&quot;</span>          );</div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;      strcpy(sim[n].solver.op_overwrite       ,<span class="stringliteral">&quot;no&quot;</span>            );</div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;      strcpy(sim[n].solver.model              ,<span class="stringliteral">&quot;none&quot;</span>          );</div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;      strcpy(sim[n].solver.ConservationCheck  ,<span class="stringliteral">&quot;no&quot;</span>            );</div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;      strcpy(sim[n].solver.SplitHyperbolicFlux,<span class="stringliteral">&quot;no&quot;</span>            );</div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;      strcpy(sim[n].solver.ib_filename        ,<span class="stringliteral">&quot;none&quot;</span>          );</div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;    }</div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;    </div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;    <span class="comment">/* open the file */</span></div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;    FILE *in;</div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;    printf(<span class="stringliteral">&quot;Reading solver inputs from file \&quot;solver.inp\&quot;.\n&quot;</span>);</div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;    in = fopen(<span class="stringliteral">&quot;solver.inp&quot;</span>,<span class="stringliteral">&quot;r&quot;</span>);</div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;    <span class="keywordflow">if</span> (!in) {</div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;      fprintf(stderr,<span class="stringliteral">&quot;Error: File \&quot;solver.inp\&quot; not found.\n&quot;</span>);</div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;      fprintf(stderr,<span class="stringliteral">&quot;Please consider killing this run.\n&quot;</span>);</div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;      <span class="keywordflow">return</span>(1);</div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;    }</div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;</div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;    <span class="comment">/* reading solver inputs */</span></div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;    <span class="keywordtype">char</span> word[<a class="code" href="a00218.html#a51efea86a4d76d1259893f606b776573">_MAX_STRING_SIZE_</a>];</div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;    ferr = fscanf(in,<span class="stringliteral">&quot;%s&quot;</span>,word); <span class="keywordflow">if</span> (ferr != 1) <span class="keywordflow">return</span>(1);</div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;</div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;    <span class="keywordflow">if</span> (!strcmp(word, <span class="stringliteral">&quot;begin&quot;</span>)){</div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;</div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;      <span class="keywordflow">while</span> (strcmp(word, <span class="stringliteral">&quot;end&quot;</span>)) {</div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;</div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;          ferr = fscanf(in,<span class="stringliteral">&quot;%s&quot;</span>,word); <span class="keywordflow">if</span> (ferr != 1) <span class="keywordflow">return</span>(1);</div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;</div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;        <span class="keywordflow">if</span> (!strcmp(word, <span class="stringliteral">&quot;ndims&quot;</span>)) {</div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;</div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;          ferr = fscanf(in,<span class="stringliteral">&quot;%d&quot;</span>,&amp;(sim[0].solver.ndims)); <span class="keywordflow">if</span> (ferr != 1) <span class="keywordflow">return</span>(1);</div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;          sim[0].<a class="code" href="a00208.html#a523947ce4fa7128c4c767163953253b9">solver</a>.<a class="code" href="a00194.html#aa989ebb755986852177779cdf7bd8c85">dim_global</a>    = (<span class="keywordtype">int</span>*) calloc (sim[0].solver.ndims,<span class="keyword">sizeof</span>(<span class="keywordtype">int</span>));</div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;          sim[0].<a class="code" href="a00208.html#a4afd2c7b3eb8fda452474ebdbe71c8c0">mpi</a>.<a class="code" href="a00197.html#a0be0f30a83bc3f3d9f6ee3a36bbf2716">iproc</a>            = (<span class="keywordtype">int</span>*) calloc (sim[0].solver.ndims,<span class="keyword">sizeof</span>(<span class="keywordtype">int</span>));</div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;          sim[0].<a class="code" href="a00208.html#a523947ce4fa7128c4c767163953253b9">solver</a>.<a class="code" href="a00194.html#a9a4a95bad0d4f4769e5e3cd8798a158a">dim_global_ex</a> = (<span class="keywordtype">int</span>*) calloc (sim[0].solver.ndims,<span class="keyword">sizeof</span>(<span class="keywordtype">int</span>));</div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;</div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;          <span class="keywordtype">int</span> n;</div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;          <span class="keywordflow">for</span> (n = 1; n &lt; nsims; n++) {</div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;            sim[n].<a class="code" href="a00208.html#a523947ce4fa7128c4c767163953253b9">solver</a>.<a class="code" href="a00194.html#a484873c74138512e41bc50d17b7d955a">ndims</a> = sim[0].<a class="code" href="a00208.html#a523947ce4fa7128c4c767163953253b9">solver</a>.<a class="code" href="a00194.html#a484873c74138512e41bc50d17b7d955a">ndims</a>;</div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;            sim[n].<a class="code" href="a00208.html#a523947ce4fa7128c4c767163953253b9">solver</a>.<a class="code" href="a00194.html#aa989ebb755986852177779cdf7bd8c85">dim_global</a>    = (<span class="keywordtype">int</span>*) calloc (sim[n].solver.ndims,<span class="keyword">sizeof</span>(<span class="keywordtype">int</span>));</div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;            sim[n].<a class="code" href="a00208.html#a4afd2c7b3eb8fda452474ebdbe71c8c0">mpi</a>.<a class="code" href="a00197.html#a0be0f30a83bc3f3d9f6ee3a36bbf2716">iproc</a>            = (<span class="keywordtype">int</span>*) calloc (sim[n].solver.ndims,<span class="keyword">sizeof</span>(<span class="keywordtype">int</span>));</div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;            sim[n].<a class="code" href="a00208.html#a523947ce4fa7128c4c767163953253b9">solver</a>.<a class="code" href="a00194.html#a9a4a95bad0d4f4769e5e3cd8798a158a">dim_global_ex</a> = (<span class="keywordtype">int</span>*) calloc (sim[n].solver.ndims,<span class="keyword">sizeof</span>(<span class="keywordtype">int</span>));</div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;          }</div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;</div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;        } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcmp(word, <span class="stringliteral">&quot;nvars&quot;</span>)) {</div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;          </div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;          ferr = fscanf(in,<span class="stringliteral">&quot;%d&quot;</span>,&amp;(sim[0].solver.nvars));</div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;          <span class="keywordflow">for</span> (<span class="keywordtype">int</span> n = 1; n &lt; nsims; n++) sim[n].solver.nvars = sim[0].<a class="code" href="a00208.html#a523947ce4fa7128c4c767163953253b9">solver</a>.<a class="code" href="a00194.html#ae8f6d2fd6490d3153cb4133bf183a404">nvars</a>;</div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;</div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;        } <span class="keywordflow">else</span> <span class="keywordflow">if</span>   (!strcmp(word, <span class="stringliteral">&quot;size&quot;</span>)) {</div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;</div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;          <span class="keywordflow">for</span> (<span class="keywordtype">int</span> n = 0; n &lt; nsims; n++) {</div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;            <span class="keywordflow">if</span> (!sim[n].solver.dim_global) {</div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;              fprintf(stderr,<span class="stringliteral">&quot;Error in ReadInputs(): dim_global not allocated for n=%d.\n&quot;</span>, n);</div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;              fprintf(stderr,<span class="stringliteral">&quot;Please specify ndims before dimensions.\n&quot;</span>         );</div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;              <span class="keywordflow">return</span>(1);</div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;            } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;              <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;sim[n].<a class="code" href="a00208.html#a523947ce4fa7128c4c767163953253b9">solver</a>.<a class="code" href="a00194.html#a484873c74138512e41bc50d17b7d955a">ndims</a>; i++) {</div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;                ferr = fscanf(in,<span class="stringliteral">&quot;%d&quot;</span>,&amp;(sim[n].solver.dim_global[i]));</div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;                <span class="keywordflow">if</span> (ferr != 1) {</div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;                  fprintf(stderr,<span class="stringliteral">&quot;Error in ReadInputs() while reading grid sizes for domain %d.\n&quot;</span>, n);</div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;                  <span class="keywordflow">return</span>(1);</div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;                }</div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;                sim[n].<a class="code" href="a00208.html#a523947ce4fa7128c4c767163953253b9">solver</a>.<a class="code" href="a00194.html#a9a4a95bad0d4f4769e5e3cd8798a158a">dim_global_ex</a>[i] = sim[n].<a class="code" href="a00208.html#a523947ce4fa7128c4c767163953253b9">solver</a>.<a class="code" href="a00194.html#aa989ebb755986852177779cdf7bd8c85">dim_global</a>[i];</div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;              }</div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;            }</div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;          }</div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;</div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;        } <span class="keywordflow">else</span> <span class="keywordflow">if</span>   (!strcmp(word, <span class="stringliteral">&quot;size_exact&quot;</span>)) {</div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;</div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;          <span class="keywordflow">for</span> (<span class="keywordtype">int</span> n = 0; n &lt; nsims; n++) {</div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;            <span class="keywordflow">if</span> (!sim[n].solver.dim_global_ex) {</div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;              fprintf(stderr,<span class="stringliteral">&quot;Error in ReadInputs(): dim_global_ex not allocated for n=%d.\n&quot;</span>, n);</div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;              fprintf(stderr,<span class="stringliteral">&quot;Please specify ndims before dimensions.\n&quot;</span>         );</div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;              <span class="keywordflow">return</span>(1);</div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;            } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;              <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;sim[n].<a class="code" href="a00208.html#a523947ce4fa7128c4c767163953253b9">solver</a>.<a class="code" href="a00194.html#a484873c74138512e41bc50d17b7d955a">ndims</a>; i++) {</div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;                ferr = fscanf(in,<span class="stringliteral">&quot;%d&quot;</span>,&amp;(sim[n].solver.dim_global_ex[i]));</div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;                <span class="keywordflow">if</span> (ferr != 1) {</div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;                  fprintf(stderr,<span class="stringliteral">&quot;Error in ReadInputs() while reading exact solution grid sizes for domain %d.\n&quot;</span>, n);</div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;                  <span class="keywordflow">return</span>(1);</div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;                }</div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;              }</div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;            }</div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;          }</div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;</div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;        } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcmp(word, <span class="stringliteral">&quot;iproc&quot;</span>)) {</div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;</div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;          <span class="keywordtype">int</span> n;</div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;          <span class="keywordflow">for</span> (n = 0; n &lt; nsims; n++) {</div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;            <span class="keywordflow">if</span> (!sim[n].mpi.iproc) {</div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;              fprintf(stderr,<span class="stringliteral">&quot;Error in ReadInputs(): iproc not allocated for n=%d.\n&quot;</span>, n);</div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;              fprintf(stderr,<span class="stringliteral">&quot;Please specify ndims before iproc.\n&quot;</span>         );</div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;              <span class="keywordflow">return</span>(1);</div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;            } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;              <span class="keywordtype">int</span> i;</div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;              <span class="keywordflow">for</span> (i=0; i&lt;sim[n].<a class="code" href="a00208.html#a523947ce4fa7128c4c767163953253b9">solver</a>.<a class="code" href="a00194.html#a484873c74138512e41bc50d17b7d955a">ndims</a>; i++) {</div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;                ferr = fscanf(in,<span class="stringliteral">&quot;%d&quot;</span>,&amp;(sim[n].mpi.iproc[i]));</div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;                <span class="keywordflow">if</span> (ferr != 1) {</div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;                  fprintf(stderr,<span class="stringliteral">&quot;Error in ReadInputs() while reading iproc for domain %d.\n&quot;</span>, n);</div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;                  <span class="keywordflow">return</span>(1);</div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;                }</div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;              }</div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;            }</div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;          }</div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;</div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;              } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcmp(word, <span class="stringliteral">&quot;ghost&quot;</span>)) {</div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;          </div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;          ferr = fscanf(in,<span class="stringliteral">&quot;%d&quot;</span>,&amp;(sim[0].solver.ghosts));</div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;</div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;          <span class="keywordtype">int</span> n;</div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;          <span class="keywordflow">for</span> (n = 1; n &lt; nsims; n++) sim[n].solver.ghosts = sim[0].<a class="code" href="a00208.html#a523947ce4fa7128c4c767163953253b9">solver</a>.<a class="code" href="a00194.html#aafc992b5fa79d5a4036024615d03bce6">ghosts</a>;</div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;</div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;        } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcmp(word, <span class="stringliteral">&quot;n_iter&quot;</span>)) { </div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;</div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;          ferr = fscanf(in,<span class="stringliteral">&quot;%d&quot;</span>,&amp;(sim[0].solver.n_iter));</div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;</div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;          <span class="keywordtype">int</span> n;</div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;          <span class="keywordflow">for</span> (n = 1; n &lt; nsims; n++) sim[n].solver.n_iter = sim[0].<a class="code" href="a00208.html#a523947ce4fa7128c4c767163953253b9">solver</a>.<a class="code" href="a00194.html#af0d8e0d5d3de3869b941b66b6caaf964">n_iter</a>;</div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;</div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;        } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcmp(word, <span class="stringliteral">&quot;restart_iter&quot;</span>)) { </div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;</div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;          ferr = fscanf(in,<span class="stringliteral">&quot;%d&quot;</span>,&amp;(sim[0].solver.restart_iter));</div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;</div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;          <span class="keywordtype">int</span> n;</div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;          <span class="keywordflow">for</span> (n = 1; n &lt; nsims; n++) sim[n].solver.restart_iter = sim[0].<a class="code" href="a00208.html#a523947ce4fa7128c4c767163953253b9">solver</a>.<a class="code" href="a00194.html#aafb41b96563d9966e8e9f458751f2960">restart_iter</a>;</div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;</div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;        } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcmp(word, <span class="stringliteral">&quot;time_scheme&quot;</span>)) { </div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;</div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;          ferr = fscanf(in,<span class="stringliteral">&quot;%s&quot;</span>,sim[0].solver.time_scheme);</div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;</div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;          <span class="keywordtype">int</span> n;</div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;          <span class="keywordflow">for</span> (n = 1; n &lt; nsims; n++) strcpy(sim[n].solver.time_scheme, sim[0].<a class="code" href="a00208.html#a523947ce4fa7128c4c767163953253b9">solver</a>.<a class="code" href="a00194.html#a138e751362d14724df8e6ab27c4a5e55">time_scheme</a>);</div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;</div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;        }   <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcmp(word, <span class="stringliteral">&quot;time_scheme_type&quot;</span> )) { </div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;</div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;          ferr = fscanf(in,<span class="stringliteral">&quot;%s&quot;</span>,sim[0].solver.time_scheme_type);</div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;</div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;          <span class="keywordtype">int</span> n;</div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;          <span class="keywordflow">for</span> (n = 1; n &lt; nsims; n++) strcpy(sim[n].solver.time_scheme_type, sim[0].<a class="code" href="a00208.html#a523947ce4fa7128c4c767163953253b9">solver</a>.<a class="code" href="a00194.html#a61750696383420ba8bcc7d9e44a538e2">time_scheme_type</a>);</div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;</div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;        }   <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcmp(word, <span class="stringliteral">&quot;hyp_space_scheme&quot;</span>)) { </div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;</div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;          ferr = fscanf(in,<span class="stringliteral">&quot;%s&quot;</span>,sim[0].solver.spatial_scheme_hyp);</div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;</div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;          <span class="keywordtype">int</span> n;</div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;          <span class="keywordflow">for</span> (n = 1; n &lt; nsims; n++) strcpy(sim[n].solver.spatial_scheme_hyp, sim[0].<a class="code" href="a00208.html#a523947ce4fa7128c4c767163953253b9">solver</a>.<a class="code" href="a00194.html#ad29846eeb9c83b329a8d7c1fe69d46b2">spatial_scheme_hyp</a>);</div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;</div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;        }   <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcmp(word, <span class="stringliteral">&quot;hyp_flux_split&quot;</span>)) { </div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;</div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;          ferr = fscanf(in,<span class="stringliteral">&quot;%s&quot;</span>,sim[0].solver.SplitHyperbolicFlux);</div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;</div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;          <span class="keywordtype">int</span> n;</div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;          <span class="keywordflow">for</span> (n = 1; n &lt; nsims; n++) strcpy(sim[n].solver.SplitHyperbolicFlux, sim[0].<a class="code" href="a00208.html#a523947ce4fa7128c4c767163953253b9">solver</a>.<a class="code" href="a00194.html#a5bed0cb9665daad89f4377c4f7609df4">SplitHyperbolicFlux</a>);</div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;</div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;        }   <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcmp(word, <span class="stringliteral">&quot;hyp_interp_type&quot;</span>)) { </div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;</div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;          ferr = fscanf(in,<span class="stringliteral">&quot;%s&quot;</span>,sim[0].solver.interp_type);</div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;</div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;          <span class="keywordtype">int</span> n;</div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;          <span class="keywordflow">for</span> (n = 1; n &lt; nsims; n++) strcpy(sim[n].solver.interp_type, sim[0].<a class="code" href="a00208.html#a523947ce4fa7128c4c767163953253b9">solver</a>.<a class="code" href="a00194.html#a9591ba0fadb863561474e2ba251d2594">interp_type</a>);</div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;</div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;        }   <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcmp(word, <span class="stringliteral">&quot;par_space_type&quot;</span>)) { </div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;</div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;          ferr = fscanf(in,<span class="stringliteral">&quot;%s&quot;</span>,sim[0].solver.spatial_type_par);</div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;</div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;          <span class="keywordtype">int</span> n;</div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;          <span class="keywordflow">for</span> (n = 1; n &lt; nsims; n++) strcpy(sim[n].solver.spatial_type_par, sim[0].<a class="code" href="a00208.html#a523947ce4fa7128c4c767163953253b9">solver</a>.<a class="code" href="a00194.html#ad45d57b33d578bf602574a221bf53d93">spatial_type_par</a>);</div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;</div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;        }   <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcmp(word, <span class="stringliteral">&quot;par_space_scheme&quot;</span>)) { </div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;</div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;          ferr = fscanf(in,<span class="stringliteral">&quot;%s&quot;</span>,sim[0].solver.spatial_scheme_par);</div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;</div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;          <span class="keywordtype">int</span> n;</div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;          <span class="keywordflow">for</span> (n = 1; n &lt; nsims; n++) strcpy(sim[n].solver.spatial_scheme_par, sim[0].<a class="code" href="a00208.html#a523947ce4fa7128c4c767163953253b9">solver</a>.<a class="code" href="a00194.html#a170f2f6cc8ac86b78fcb376c2392e290">spatial_scheme_par</a>);</div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;</div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;        }   <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcmp(word, <span class="stringliteral">&quot;dt&quot;</span>)) { </div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;</div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;          ferr = fscanf(in,<span class="stringliteral">&quot;%lf&quot;</span>,&amp;(sim[0].solver.dt));</div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;</div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;          <span class="keywordtype">int</span> n;</div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;          <span class="keywordflow">for</span> (n = 1; n &lt; nsims; n++) sim[n].solver.dt = sim[0].<a class="code" href="a00208.html#a523947ce4fa7128c4c767163953253b9">solver</a>.<a class="code" href="a00194.html#a03e28be41881b703c836edbfe9b51b17">dt</a>;</div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;</div>
<div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;        }   <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcmp(word, <span class="stringliteral">&quot;conservation_check&quot;</span> )) { </div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;</div>
<div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;          ferr = fscanf(in,<span class="stringliteral">&quot;%s&quot;</span>,sim[0].solver.ConservationCheck);</div>
<div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;</div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;          <span class="keywordtype">int</span> n;</div>
<div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;          <span class="keywordflow">for</span> (n = 1; n &lt; nsims; n++) strcpy(sim[n].solver.ConservationCheck, sim[0].<a class="code" href="a00208.html#a523947ce4fa7128c4c767163953253b9">solver</a>.<a class="code" href="a00194.html#ac92c34fe456d92c694eacd2231f5a7b1">ConservationCheck</a>);</div>
<div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;</div>
<div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;        }   <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcmp(word, <span class="stringliteral">&quot;screen_op_iter&quot;</span>)) { </div>
<div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;</div>
<div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;          ferr = fscanf(in,<span class="stringliteral">&quot;%d&quot;</span>,&amp;(sim[0].solver.screen_op_iter));</div>
<div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;</div>
<div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;          <span class="keywordtype">int</span> n;</div>
<div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;          <span class="keywordflow">for</span> (n = 1; n &lt; nsims; n++) sim[n].solver.screen_op_iter = sim[0].<a class="code" href="a00208.html#a523947ce4fa7128c4c767163953253b9">solver</a>.<a class="code" href="a00194.html#a74ff7fa96cbfc4ee87f508f964e94409">screen_op_iter</a>;</div>
<div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;</div>
<div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;        }   <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcmp(word, <span class="stringliteral">&quot;file_op_iter&quot;</span>)) { </div>
<div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;</div>
<div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;          ferr = fscanf(in,<span class="stringliteral">&quot;%d&quot;</span>,&amp;(sim[0].solver.file_op_iter));</div>
<div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;</div>
<div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;          <span class="keywordtype">int</span> n;</div>
<div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;          <span class="keywordflow">for</span> (n = 1; n &lt; nsims; n++) sim[n].solver.file_op_iter = sim[0].<a class="code" href="a00208.html#a523947ce4fa7128c4c767163953253b9">solver</a>.<a class="code" href="a00194.html#a6ff746b30ee55a3bbb9f3306c145f27a">file_op_iter</a>;</div>
<div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;</div>
<div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;        }   <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcmp(word, <span class="stringliteral">&quot;op_file_format&quot;</span>)) { </div>
<div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;</div>
<div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;          ferr = fscanf(in,<span class="stringliteral">&quot;%s&quot;</span>,sim[0].solver.op_file_format);</div>
<div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;</div>
<div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;          <span class="keywordtype">int</span> n;</div>
<div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;          <span class="keywordflow">for</span> (n = 1; n &lt; nsims; n++) strcpy(sim[n].solver.op_file_format, sim[0].<a class="code" href="a00208.html#a523947ce4fa7128c4c767163953253b9">solver</a>.<a class="code" href="a00194.html#a51a3b8c19b86e9e1df5be02b05a6613c">op_file_format</a>);</div>
<div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;</div>
<div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;        }   <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcmp(word, <span class="stringliteral">&quot;ip_file_type&quot;</span>)) { </div>
<div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;</div>
<div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;          ferr = fscanf(in,<span class="stringliteral">&quot;%s&quot;</span>,sim[0].solver.ip_file_type);</div>
<div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;</div>
<div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;          <span class="keywordtype">int</span> n;</div>
<div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;          <span class="keywordflow">for</span> (n = 1; n &lt; nsims; n++) strcpy(sim[n].solver.ip_file_type, sim[0].<a class="code" href="a00208.html#a523947ce4fa7128c4c767163953253b9">solver</a>.<a class="code" href="a00194.html#a83f3dcd022f744511a44f2a31a824ac8">ip_file_type</a>);</div>
<div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;</div>
<div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;        }   <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcmp(word, <span class="stringliteral">&quot;input_mode&quot;</span>)) {</div>
<div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;</div>
<div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;          ferr = fscanf(in,<span class="stringliteral">&quot;%s&quot;</span>,sim[0].solver.input_mode);</div>
<div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;          <span class="keywordflow">if</span> (strcmp(sim[0].solver.input_mode,<span class="stringliteral">&quot;serial&quot;</span>)) ferr = fscanf(in,<span class="stringliteral">&quot;%d&quot;</span>,&amp;(sim[0].mpi.N_IORanks));</div>
<div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;</div>
<div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;          <span class="keywordtype">int</span> n;</div>
<div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;          <span class="keywordflow">for</span> (n = 1; n &lt; nsims; n++) {</div>
<div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;            strcpy(sim[n].solver.input_mode, sim[0].<a class="code" href="a00208.html#a523947ce4fa7128c4c767163953253b9">solver</a>.<a class="code" href="a00194.html#a0a0b9dc97c7c278a019939d301db9399">input_mode</a>);</div>
<div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;            <span class="keywordflow">if</span> (strcmp(sim[n].solver.input_mode,<span class="stringliteral">&quot;serial&quot;</span>)) sim[n].<a class="code" href="a00208.html#a4afd2c7b3eb8fda452474ebdbe71c8c0">mpi</a>.<a class="code" href="a00197.html#a297fca986fa3aa27de07a0c746ffaaa8">N_IORanks</a> = sim[0].<a class="code" href="a00208.html#a4afd2c7b3eb8fda452474ebdbe71c8c0">mpi</a>.<a class="code" href="a00197.html#a297fca986fa3aa27de07a0c746ffaaa8">N_IORanks</a>;</div>
<div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;          }</div>
<div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;</div>
<div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;            } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcmp(word, <span class="stringliteral">&quot;output_mode&quot;</span>))  {</div>
<div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;</div>
<div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;          ferr = fscanf(in,<span class="stringliteral">&quot;%s&quot;</span>,sim[0].solver.output_mode);</div>
<div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;          <span class="keywordflow">if</span> (strcmp(sim[0].solver.output_mode,<span class="stringliteral">&quot;serial&quot;</span>)) ferr = fscanf(in,<span class="stringliteral">&quot;%d&quot;</span>,&amp;(sim[0].mpi.N_IORanks));</div>
<div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;</div>
<div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;          <span class="keywordtype">int</span> n;</div>
<div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;          <span class="keywordflow">for</span> (n = 1; n &lt; nsims; n++) {</div>
<div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;            strcpy(sim[n].solver.output_mode, sim[0].<a class="code" href="a00208.html#a523947ce4fa7128c4c767163953253b9">solver</a>.<a class="code" href="a00194.html#a5f89e286a9eaffdb66d966fa6a290d3f">output_mode</a>);</div>
<div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;            <span class="keywordflow">if</span> (strcmp(sim[n].solver.output_mode,<span class="stringliteral">&quot;serial&quot;</span>)) sim[n].<a class="code" href="a00208.html#a4afd2c7b3eb8fda452474ebdbe71c8c0">mpi</a>.<a class="code" href="a00197.html#a297fca986fa3aa27de07a0c746ffaaa8">N_IORanks</a> = sim[0].<a class="code" href="a00208.html#a4afd2c7b3eb8fda452474ebdbe71c8c0">mpi</a>.<a class="code" href="a00197.html#a297fca986fa3aa27de07a0c746ffaaa8">N_IORanks</a>;</div>
<div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;          }</div>
<div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;</div>
<div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;        } <span class="keywordflow">else</span> <span class="keywordflow">if</span>   (!strcmp(word, <span class="stringliteral">&quot;op_overwrite&quot;</span>)) {</div>
<div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;</div>
<div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;          ferr = fscanf(in,<span class="stringliteral">&quot;%s&quot;</span>,sim[0].solver.op_overwrite);</div>
<div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;</div>
<div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;          <span class="keywordtype">int</span> n;</div>
<div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;          <span class="keywordflow">for</span> (n = 1; n &lt; nsims; n++) strcpy(sim[n].solver.op_overwrite, sim[0].<a class="code" href="a00208.html#a523947ce4fa7128c4c767163953253b9">solver</a>.<a class="code" href="a00194.html#a4e93cb107e180ef982b74cef7726b70f">op_overwrite</a>);</div>
<div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;</div>
<div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;        }   <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcmp(word, <span class="stringliteral">&quot;model&quot;</span>)) {</div>
<div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;</div>
<div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;          ferr = fscanf(in,<span class="stringliteral">&quot;%s&quot;</span>,sim[0].solver.model);</div>
<div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;</div>
<div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;          <span class="keywordtype">int</span> n;</div>
<div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;          <span class="keywordflow">for</span> (n = 1; n &lt; nsims; n++) strcpy(sim[n].solver.model, sim[0].<a class="code" href="a00208.html#a523947ce4fa7128c4c767163953253b9">solver</a>.<a class="code" href="a00194.html#ad3fe4b266b398f3a7567ac1b241d99a2">model</a>);</div>
<div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;</div>
<div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;        }   <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcmp(word, <span class="stringliteral">&quot;immersed_body&quot;</span>)) {</div>
<div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;</div>
<div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;          ferr = fscanf(in,<span class="stringliteral">&quot;%s&quot;</span>,sim[0].solver.ib_filename);</div>
<div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;</div>
<div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;          <span class="keywordtype">int</span> n;</div>
<div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;          <span class="keywordflow">for</span> (n = 1; n &lt; nsims; n++) strcpy(sim[n].solver.ib_filename, sim[0].<a class="code" href="a00208.html#a523947ce4fa7128c4c767163953253b9">solver</a>.<a class="code" href="a00194.html#a43ee3672350b4fd385871b6512e5d47b">ib_filename</a>);</div>
<div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;</div>
<div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;        } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (strcmp(word, <span class="stringliteral">&quot;end&quot;</span>)) {</div>
<div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;</div>
<div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;          <span class="keywordtype">char</span> useless[<a class="code" href="a00218.html#a51efea86a4d76d1259893f606b776573">_MAX_STRING_SIZE_</a>];</div>
<div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;          ferr = fscanf(in,<span class="stringliteral">&quot;%s&quot;</span>,useless);</div>
<div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;          printf(<span class="stringliteral">&quot;Warning: keyword %s in file \&quot;solver.inp\&quot; with value %s not recognized or extraneous. Ignoring.\n&quot;</span>,</div>
<div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;                  word,useless);</div>
<div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;</div>
<div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;        }</div>
<div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;        <span class="keywordflow">if</span> (ferr != 1) <span class="keywordflow">return</span>(1);</div>
<div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;</div>
<div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;      }</div>
<div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;    </div>
<div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;</div>
<div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;          fprintf(stderr,<span class="stringliteral">&quot;Error: Illegal format in file \&quot;solver.inp\&quot;.\n&quot;</span>);</div>
<div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;      <span class="keywordflow">return</span>(1);</div>
<div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;</div>
<div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;    }</div>
<div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;</div>
<div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;    <span class="comment">/* close the file */</span></div>
<div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;    fclose(in);</div>
<div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;   </div>
<div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;    <span class="comment">/* some checks */</span></div>
<div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;    <span class="keywordflow">for</span> (n = 0; n &lt; nsims; n++) {</div>
<div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;</div>
<div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;      <span class="keywordflow">if</span> (sim[n].solver.screen_op_iter &lt;= 0)  sim[n].<a class="code" href="a00208.html#a523947ce4fa7128c4c767163953253b9">solver</a>.<a class="code" href="a00194.html#a74ff7fa96cbfc4ee87f508f964e94409">screen_op_iter</a> = 1;</div>
<div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;      <span class="keywordflow">if</span> (sim[n].solver.file_op_iter &lt;= 0)    sim[n].<a class="code" href="a00208.html#a523947ce4fa7128c4c767163953253b9">solver</a>.<a class="code" href="a00194.html#a6ff746b30ee55a3bbb9f3306c145f27a">file_op_iter</a>   = sim[n].<a class="code" href="a00208.html#a523947ce4fa7128c4c767163953253b9">solver</a>.<a class="code" href="a00194.html#af0d8e0d5d3de3869b941b66b6caaf964">n_iter</a>;</div>
<div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;</div>
<div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;      <span class="keywordflow">if</span> ((sim[n].solver.ndims != 3) &amp;&amp; (strcmp(sim[n].solver.ib_filename,<span class="stringliteral">&quot;none&quot;</span>))) {</div>
<div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;        printf(<span class="stringliteral">&quot;Warning: immersed boundaries not implemented for ndims = %d. &quot;</span>,sim[n].solver.ndims);</div>
<div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;        printf(<span class="stringliteral">&quot;Ignoring input for \&quot;immersed_body\&quot; (%s).\n&quot;</span>,sim[n].solver.ib_filename);</div>
<div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;        strcpy(sim[n].solver.ib_filename,<span class="stringliteral">&quot;none&quot;</span>);</div>
<div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;      }</div>
<div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;      sim[n].<a class="code" href="a00208.html#a523947ce4fa7128c4c767163953253b9">solver</a>.<a class="code" href="a00194.html#ae83b1b0117b6a805ead2e4728945814c">flag_ib</a> = strcmp(sim[n].solver.ib_filename,<span class="stringliteral">&quot;none&quot;</span>);</div>
<div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;</div>
<div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;      <span class="comment">/* restart only supported for binary output files */</span></div>
<div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;      <span class="keywordflow">if</span> ((sim[n].solver.restart_iter != 0) &amp;&amp; strcmp(sim[n].solver.op_file_format,<span class="stringliteral">&quot;binary&quot;</span>)) {</div>
<div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;        <span class="keywordflow">if</span> (!sim[n].mpi.rank) fprintf(stderr,<span class="stringliteral">&quot;Error in ReadInputs(): Restart is supported only for binary output files.\n&quot;</span>);</div>
<div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;        <span class="keywordflow">return</span>(1);</div>
<div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;      }</div>
<div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;    }</div>
<div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;  }</div>
<div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;</div>
<div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;<span class="preprocessor">#ifndef serial</span></div>
<div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;<span class="preprocessor"></span>  <span class="keywordflow">for</span> (n = 0; n &lt; nsims; n++) {</div>
<div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;</div>
<div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;    <span class="comment">/* Broadcast the input parameters */</span></div>
<div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;    <a class="code" href="a00218.html#ad6ab74942c9de13cf0b4c12eb0d91780">IERR</a> <a class="code" href="a00234.html#acd7957559b9206224c7da3cab4f22b27">MPIBroadcast_integer</a>(&amp;(sim[n].solver.ndims),1,0,&amp;(sim[n].<a class="code" href="a00208.html#a4afd2c7b3eb8fda452474ebdbe71c8c0">mpi</a>.<a class="code" href="a00197.html#adad7a6f85831f3ac84d854b6c80aef43">world</a>)); <a class="code" href="a00218.html#add9cf96ae374934d245a1dc1ab697a42">CHECKERR</a>(ierr);</div>
<div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;    <span class="keywordflow">if</span> (sim[n].mpi.rank) {</div>
<div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;      sim[n].<a class="code" href="a00208.html#a523947ce4fa7128c4c767163953253b9">solver</a>.<a class="code" href="a00194.html#aa989ebb755986852177779cdf7bd8c85">dim_global</a>    = (<span class="keywordtype">int</span>*) calloc (sim[n].solver.ndims,<span class="keyword">sizeof</span>(<span class="keywordtype">int</span>));</div>
<div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;      sim[n].<a class="code" href="a00208.html#a4afd2c7b3eb8fda452474ebdbe71c8c0">mpi</a>.<a class="code" href="a00197.html#a0be0f30a83bc3f3d9f6ee3a36bbf2716">iproc</a>            = (<span class="keywordtype">int</span>*) calloc (sim[n].solver.ndims,<span class="keyword">sizeof</span>(<span class="keywordtype">int</span>));</div>
<div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;      sim[n].<a class="code" href="a00208.html#a523947ce4fa7128c4c767163953253b9">solver</a>.<a class="code" href="a00194.html#a9a4a95bad0d4f4769e5e3cd8798a158a">dim_global_ex</a> = (<span class="keywordtype">int</span>*) calloc (sim[n].solver.ndims,<span class="keyword">sizeof</span>(<span class="keywordtype">int</span>));</div>
<div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;    }</div>
<div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;    <a class="code" href="a00218.html#ad6ab74942c9de13cf0b4c12eb0d91780">IERR</a> <a class="code" href="a00234.html#acd7957559b9206224c7da3cab4f22b27">MPIBroadcast_integer</a>(&amp;(sim[n].solver.nvars)         ,1                  ,0,&amp;(sim[n].<a class="code" href="a00208.html#a4afd2c7b3eb8fda452474ebdbe71c8c0">mpi</a>.<a class="code" href="a00197.html#adad7a6f85831f3ac84d854b6c80aef43">world</a>)); <a class="code" href="a00218.html#add9cf96ae374934d245a1dc1ab697a42">CHECKERR</a>(ierr);</div>
<div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;    <a class="code" href="a00218.html#ad6ab74942c9de13cf0b4c12eb0d91780">IERR</a> <a class="code" href="a00234.html#acd7957559b9206224c7da3cab4f22b27">MPIBroadcast_integer</a>( sim[n].solver.dim_global      ,sim[n].<a class="code" href="a00208.html#a523947ce4fa7128c4c767163953253b9">solver</a>.<a class="code" href="a00194.html#a484873c74138512e41bc50d17b7d955a">ndims</a>,0,&amp;(sim[n].<a class="code" href="a00208.html#a4afd2c7b3eb8fda452474ebdbe71c8c0">mpi</a>.<a class="code" href="a00197.html#adad7a6f85831f3ac84d854b6c80aef43">world</a>)); <a class="code" href="a00218.html#add9cf96ae374934d245a1dc1ab697a42">CHECKERR</a>(ierr);</div>
<div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;    <a class="code" href="a00218.html#ad6ab74942c9de13cf0b4c12eb0d91780">IERR</a> <a class="code" href="a00234.html#acd7957559b9206224c7da3cab4f22b27">MPIBroadcast_integer</a>( sim[n].solver.dim_global_ex   ,sim[n].<a class="code" href="a00208.html#a523947ce4fa7128c4c767163953253b9">solver</a>.<a class="code" href="a00194.html#a484873c74138512e41bc50d17b7d955a">ndims</a>,0,&amp;(sim[n].<a class="code" href="a00208.html#a4afd2c7b3eb8fda452474ebdbe71c8c0">mpi</a>.<a class="code" href="a00197.html#adad7a6f85831f3ac84d854b6c80aef43">world</a>)); <a class="code" href="a00218.html#add9cf96ae374934d245a1dc1ab697a42">CHECKERR</a>(ierr);</div>
<div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;    <a class="code" href="a00218.html#ad6ab74942c9de13cf0b4c12eb0d91780">IERR</a> <a class="code" href="a00234.html#acd7957559b9206224c7da3cab4f22b27">MPIBroadcast_integer</a>( sim[n].mpi.iproc              ,sim[n].<a class="code" href="a00208.html#a523947ce4fa7128c4c767163953253b9">solver</a>.<a class="code" href="a00194.html#a484873c74138512e41bc50d17b7d955a">ndims</a>,0,&amp;(sim[n].<a class="code" href="a00208.html#a4afd2c7b3eb8fda452474ebdbe71c8c0">mpi</a>.<a class="code" href="a00197.html#adad7a6f85831f3ac84d854b6c80aef43">world</a>)); <a class="code" href="a00218.html#add9cf96ae374934d245a1dc1ab697a42">CHECKERR</a>(ierr);</div>
<div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;    <a class="code" href="a00218.html#ad6ab74942c9de13cf0b4c12eb0d91780">IERR</a> <a class="code" href="a00234.html#acd7957559b9206224c7da3cab4f22b27">MPIBroadcast_integer</a>(&amp;(sim[n].mpi.N_IORanks)        ,1                  ,0,&amp;(sim[n].<a class="code" href="a00208.html#a4afd2c7b3eb8fda452474ebdbe71c8c0">mpi</a>.<a class="code" href="a00197.html#adad7a6f85831f3ac84d854b6c80aef43">world</a>)); <a class="code" href="a00218.html#add9cf96ae374934d245a1dc1ab697a42">CHECKERR</a>(ierr);</div>
<div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;    <a class="code" href="a00218.html#ad6ab74942c9de13cf0b4c12eb0d91780">IERR</a> <a class="code" href="a00234.html#acd7957559b9206224c7da3cab4f22b27">MPIBroadcast_integer</a>(&amp;(sim[n].solver.ghosts)        ,1                  ,0,&amp;(sim[n].<a class="code" href="a00208.html#a4afd2c7b3eb8fda452474ebdbe71c8c0">mpi</a>.<a class="code" href="a00197.html#adad7a6f85831f3ac84d854b6c80aef43">world</a>)); <a class="code" href="a00218.html#add9cf96ae374934d245a1dc1ab697a42">CHECKERR</a>(ierr);</div>
<div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;    <a class="code" href="a00218.html#ad6ab74942c9de13cf0b4c12eb0d91780">IERR</a> <a class="code" href="a00234.html#acd7957559b9206224c7da3cab4f22b27">MPIBroadcast_integer</a>(&amp;(sim[n].solver.n_iter)        ,1                  ,0,&amp;(sim[n].<a class="code" href="a00208.html#a4afd2c7b3eb8fda452474ebdbe71c8c0">mpi</a>.<a class="code" href="a00197.html#adad7a6f85831f3ac84d854b6c80aef43">world</a>)); <a class="code" href="a00218.html#add9cf96ae374934d245a1dc1ab697a42">CHECKERR</a>(ierr);</div>
<div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;    <a class="code" href="a00218.html#ad6ab74942c9de13cf0b4c12eb0d91780">IERR</a> <a class="code" href="a00234.html#acd7957559b9206224c7da3cab4f22b27">MPIBroadcast_integer</a>(&amp;(sim[n].solver.restart_iter)  ,1                  ,0,&amp;(sim[n].<a class="code" href="a00208.html#a4afd2c7b3eb8fda452474ebdbe71c8c0">mpi</a>.<a class="code" href="a00197.html#adad7a6f85831f3ac84d854b6c80aef43">world</a>)); <a class="code" href="a00218.html#add9cf96ae374934d245a1dc1ab697a42">CHECKERR</a>(ierr);</div>
<div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;    <a class="code" href="a00218.html#ad6ab74942c9de13cf0b4c12eb0d91780">IERR</a> <a class="code" href="a00234.html#acd7957559b9206224c7da3cab4f22b27">MPIBroadcast_integer</a>(&amp;(sim[n].solver.screen_op_iter),1                  ,0,&amp;(sim[n].<a class="code" href="a00208.html#a4afd2c7b3eb8fda452474ebdbe71c8c0">mpi</a>.<a class="code" href="a00197.html#adad7a6f85831f3ac84d854b6c80aef43">world</a>)); <a class="code" href="a00218.html#add9cf96ae374934d245a1dc1ab697a42">CHECKERR</a>(ierr);</div>
<div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;    <a class="code" href="a00218.html#ad6ab74942c9de13cf0b4c12eb0d91780">IERR</a> <a class="code" href="a00234.html#acd7957559b9206224c7da3cab4f22b27">MPIBroadcast_integer</a>(&amp;(sim[n].solver.file_op_iter)  ,1                  ,0,&amp;(sim[n].<a class="code" href="a00208.html#a4afd2c7b3eb8fda452474ebdbe71c8c0">mpi</a>.<a class="code" href="a00197.html#adad7a6f85831f3ac84d854b6c80aef43">world</a>)); <a class="code" href="a00218.html#add9cf96ae374934d245a1dc1ab697a42">CHECKERR</a>(ierr);</div>
<div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;    <a class="code" href="a00218.html#ad6ab74942c9de13cf0b4c12eb0d91780">IERR</a> <a class="code" href="a00234.html#acd7957559b9206224c7da3cab4f22b27">MPIBroadcast_integer</a>(&amp;(sim[n].solver.flag_ib)       ,1                  ,0,&amp;(sim[n].<a class="code" href="a00208.html#a4afd2c7b3eb8fda452474ebdbe71c8c0">mpi</a>.<a class="code" href="a00197.html#adad7a6f85831f3ac84d854b6c80aef43">world</a>)); <a class="code" href="a00218.html#add9cf96ae374934d245a1dc1ab697a42">CHECKERR</a>(ierr);</div>
<div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;  </div>
<div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;    <a class="code" href="a00218.html#ad6ab74942c9de13cf0b4c12eb0d91780">IERR</a> <a class="code" href="a00234.html#ad408e5a44e863cca50112d1e2f728597">MPIBroadcast_character</a>(sim[n].solver.time_scheme        ,<a class="code" href="a00218.html#a51efea86a4d76d1259893f606b776573">_MAX_STRING_SIZE_</a>,0,&amp;(sim[n].<a class="code" href="a00208.html#a4afd2c7b3eb8fda452474ebdbe71c8c0">mpi</a>.<a class="code" href="a00197.html#adad7a6f85831f3ac84d854b6c80aef43">world</a>)); <a class="code" href="a00218.html#add9cf96ae374934d245a1dc1ab697a42">CHECKERR</a>(ierr);</div>
<div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;    <a class="code" href="a00218.html#ad6ab74942c9de13cf0b4c12eb0d91780">IERR</a> <a class="code" href="a00234.html#ad408e5a44e863cca50112d1e2f728597">MPIBroadcast_character</a>(sim[n].solver.time_scheme_type   ,<a class="code" href="a00218.html#a51efea86a4d76d1259893f606b776573">_MAX_STRING_SIZE_</a>,0,&amp;(sim[n].<a class="code" href="a00208.html#a4afd2c7b3eb8fda452474ebdbe71c8c0">mpi</a>.<a class="code" href="a00197.html#adad7a6f85831f3ac84d854b6c80aef43">world</a>)); <a class="code" href="a00218.html#add9cf96ae374934d245a1dc1ab697a42">CHECKERR</a>(ierr);</div>
<div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;    <a class="code" href="a00218.html#ad6ab74942c9de13cf0b4c12eb0d91780">IERR</a> <a class="code" href="a00234.html#ad408e5a44e863cca50112d1e2f728597">MPIBroadcast_character</a>(sim[n].solver.spatial_scheme_hyp ,<a class="code" href="a00218.html#a51efea86a4d76d1259893f606b776573">_MAX_STRING_SIZE_</a>,0,&amp;(sim[n].<a class="code" href="a00208.html#a4afd2c7b3eb8fda452474ebdbe71c8c0">mpi</a>.<a class="code" href="a00197.html#adad7a6f85831f3ac84d854b6c80aef43">world</a>)); <a class="code" href="a00218.html#add9cf96ae374934d245a1dc1ab697a42">CHECKERR</a>(ierr);</div>
<div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;    <a class="code" href="a00218.html#ad6ab74942c9de13cf0b4c12eb0d91780">IERR</a> <a class="code" href="a00234.html#ad408e5a44e863cca50112d1e2f728597">MPIBroadcast_character</a>(sim[n].solver.interp_type        ,<a class="code" href="a00218.html#a51efea86a4d76d1259893f606b776573">_MAX_STRING_SIZE_</a>,0,&amp;(sim[n].<a class="code" href="a00208.html#a4afd2c7b3eb8fda452474ebdbe71c8c0">mpi</a>.<a class="code" href="a00197.html#adad7a6f85831f3ac84d854b6c80aef43">world</a>)); <a class="code" href="a00218.html#add9cf96ae374934d245a1dc1ab697a42">CHECKERR</a>(ierr);</div>
<div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;    <a class="code" href="a00218.html#ad6ab74942c9de13cf0b4c12eb0d91780">IERR</a> <a class="code" href="a00234.html#ad408e5a44e863cca50112d1e2f728597">MPIBroadcast_character</a>(sim[n].solver.spatial_type_par   ,<a class="code" href="a00218.html#a51efea86a4d76d1259893f606b776573">_MAX_STRING_SIZE_</a>,0,&amp;(sim[n].<a class="code" href="a00208.html#a4afd2c7b3eb8fda452474ebdbe71c8c0">mpi</a>.<a class="code" href="a00197.html#adad7a6f85831f3ac84d854b6c80aef43">world</a>)); <a class="code" href="a00218.html#add9cf96ae374934d245a1dc1ab697a42">CHECKERR</a>(ierr);</div>
<div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;    <a class="code" href="a00218.html#ad6ab74942c9de13cf0b4c12eb0d91780">IERR</a> <a class="code" href="a00234.html#ad408e5a44e863cca50112d1e2f728597">MPIBroadcast_character</a>(sim[n].solver.spatial_scheme_par ,<a class="code" href="a00218.html#a51efea86a4d76d1259893f606b776573">_MAX_STRING_SIZE_</a>,0,&amp;(sim[n].<a class="code" href="a00208.html#a4afd2c7b3eb8fda452474ebdbe71c8c0">mpi</a>.<a class="code" href="a00197.html#adad7a6f85831f3ac84d854b6c80aef43">world</a>)); <a class="code" href="a00218.html#add9cf96ae374934d245a1dc1ab697a42">CHECKERR</a>(ierr);</div>
<div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;    <a class="code" href="a00218.html#ad6ab74942c9de13cf0b4c12eb0d91780">IERR</a> <a class="code" href="a00234.html#ad408e5a44e863cca50112d1e2f728597">MPIBroadcast_character</a>(sim[n].solver.ConservationCheck  ,<a class="code" href="a00218.html#a51efea86a4d76d1259893f606b776573">_MAX_STRING_SIZE_</a>,0,&amp;(sim[n].<a class="code" href="a00208.html#a4afd2c7b3eb8fda452474ebdbe71c8c0">mpi</a>.<a class="code" href="a00197.html#adad7a6f85831f3ac84d854b6c80aef43">world</a>)); <a class="code" href="a00218.html#add9cf96ae374934d245a1dc1ab697a42">CHECKERR</a>(ierr);</div>
<div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;    <a class="code" href="a00218.html#ad6ab74942c9de13cf0b4c12eb0d91780">IERR</a> <a class="code" href="a00234.html#ad408e5a44e863cca50112d1e2f728597">MPIBroadcast_character</a>(sim[n].solver.SplitHyperbolicFlux,<a class="code" href="a00218.html#a51efea86a4d76d1259893f606b776573">_MAX_STRING_SIZE_</a>,0,&amp;(sim[n].<a class="code" href="a00208.html#a4afd2c7b3eb8fda452474ebdbe71c8c0">mpi</a>.<a class="code" href="a00197.html#adad7a6f85831f3ac84d854b6c80aef43">world</a>)); <a class="code" href="a00218.html#add9cf96ae374934d245a1dc1ab697a42">CHECKERR</a>(ierr);</div>
<div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;    <a class="code" href="a00218.html#ad6ab74942c9de13cf0b4c12eb0d91780">IERR</a> <a class="code" href="a00234.html#ad408e5a44e863cca50112d1e2f728597">MPIBroadcast_character</a>(sim[n].solver.op_file_format     ,<a class="code" href="a00218.html#a51efea86a4d76d1259893f606b776573">_MAX_STRING_SIZE_</a>,0,&amp;(sim[n].<a class="code" href="a00208.html#a4afd2c7b3eb8fda452474ebdbe71c8c0">mpi</a>.<a class="code" href="a00197.html#adad7a6f85831f3ac84d854b6c80aef43">world</a>)); <a class="code" href="a00218.html#add9cf96ae374934d245a1dc1ab697a42">CHECKERR</a>(ierr);</div>
<div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;    <a class="code" href="a00218.html#ad6ab74942c9de13cf0b4c12eb0d91780">IERR</a> <a class="code" href="a00234.html#ad408e5a44e863cca50112d1e2f728597">MPIBroadcast_character</a>(sim[n].solver.ip_file_type       ,<a class="code" href="a00218.html#a51efea86a4d76d1259893f606b776573">_MAX_STRING_SIZE_</a>,0,&amp;(sim[n].<a class="code" href="a00208.html#a4afd2c7b3eb8fda452474ebdbe71c8c0">mpi</a>.<a class="code" href="a00197.html#adad7a6f85831f3ac84d854b6c80aef43">world</a>)); <a class="code" href="a00218.html#add9cf96ae374934d245a1dc1ab697a42">CHECKERR</a>(ierr);</div>
<div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;    <a class="code" href="a00218.html#ad6ab74942c9de13cf0b4c12eb0d91780">IERR</a> <a class="code" href="a00234.html#ad408e5a44e863cca50112d1e2f728597">MPIBroadcast_character</a>(sim[n].solver.input_mode         ,<a class="code" href="a00218.html#a51efea86a4d76d1259893f606b776573">_MAX_STRING_SIZE_</a>,0,&amp;(sim[n].<a class="code" href="a00208.html#a4afd2c7b3eb8fda452474ebdbe71c8c0">mpi</a>.<a class="code" href="a00197.html#adad7a6f85831f3ac84d854b6c80aef43">world</a>)); <a class="code" href="a00218.html#add9cf96ae374934d245a1dc1ab697a42">CHECKERR</a>(ierr);</div>
<div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;    <a class="code" href="a00218.html#ad6ab74942c9de13cf0b4c12eb0d91780">IERR</a> <a class="code" href="a00234.html#ad408e5a44e863cca50112d1e2f728597">MPIBroadcast_character</a>(sim[n].solver.output_mode        ,<a class="code" href="a00218.html#a51efea86a4d76d1259893f606b776573">_MAX_STRING_SIZE_</a>,0,&amp;(sim[n].<a class="code" href="a00208.html#a4afd2c7b3eb8fda452474ebdbe71c8c0">mpi</a>.<a class="code" href="a00197.html#adad7a6f85831f3ac84d854b6c80aef43">world</a>)); <a class="code" href="a00218.html#add9cf96ae374934d245a1dc1ab697a42">CHECKERR</a>(ierr);</div>
<div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;    <a class="code" href="a00218.html#ad6ab74942c9de13cf0b4c12eb0d91780">IERR</a> <a class="code" href="a00234.html#ad408e5a44e863cca50112d1e2f728597">MPIBroadcast_character</a>(sim[n].solver.op_overwrite       ,<a class="code" href="a00218.html#a51efea86a4d76d1259893f606b776573">_MAX_STRING_SIZE_</a>,0,&amp;(sim[n].<a class="code" href="a00208.html#a4afd2c7b3eb8fda452474ebdbe71c8c0">mpi</a>.<a class="code" href="a00197.html#adad7a6f85831f3ac84d854b6c80aef43">world</a>)); <a class="code" href="a00218.html#add9cf96ae374934d245a1dc1ab697a42">CHECKERR</a>(ierr);</div>
<div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;    <a class="code" href="a00218.html#ad6ab74942c9de13cf0b4c12eb0d91780">IERR</a> <a class="code" href="a00234.html#ad408e5a44e863cca50112d1e2f728597">MPIBroadcast_character</a>(sim[n].solver.model              ,<a class="code" href="a00218.html#a51efea86a4d76d1259893f606b776573">_MAX_STRING_SIZE_</a>,0,&amp;(sim[n].<a class="code" href="a00208.html#a4afd2c7b3eb8fda452474ebdbe71c8c0">mpi</a>.<a class="code" href="a00197.html#adad7a6f85831f3ac84d854b6c80aef43">world</a>)); <a class="code" href="a00218.html#add9cf96ae374934d245a1dc1ab697a42">CHECKERR</a>(ierr);</div>
<div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;    <a class="code" href="a00218.html#ad6ab74942c9de13cf0b4c12eb0d91780">IERR</a> <a class="code" href="a00234.html#ad408e5a44e863cca50112d1e2f728597">MPIBroadcast_character</a>(sim[n].solver.ib_filename        ,<a class="code" href="a00218.html#a51efea86a4d76d1259893f606b776573">_MAX_STRING_SIZE_</a>,0,&amp;(sim[n].<a class="code" href="a00208.html#a4afd2c7b3eb8fda452474ebdbe71c8c0">mpi</a>.<a class="code" href="a00197.html#adad7a6f85831f3ac84d854b6c80aef43">world</a>)); <a class="code" href="a00218.html#add9cf96ae374934d245a1dc1ab697a42">CHECKERR</a>(ierr);</div>
<div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;  </div>
<div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;    <a class="code" href="a00218.html#ad6ab74942c9de13cf0b4c12eb0d91780">IERR</a> <a class="code" href="a00234.html#a45dcb265863a65d862bb16222e7e623c">MPIBroadcast_double</a>(&amp;(sim[n].solver.dt),1,0,&amp;(sim[n].<a class="code" href="a00208.html#a4afd2c7b3eb8fda452474ebdbe71c8c0">mpi</a>.<a class="code" href="a00197.html#adad7a6f85831f3ac84d854b6c80aef43">world</a>)); <a class="code" href="a00218.html#add9cf96ae374934d245a1dc1ab697a42">CHECKERR</a>(ierr);</div>
<div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;</div>
<div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;  }</div>
<div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;<span class="preprocessor"></span></div>
<div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;  <span class="keywordflow">return</span>(0);</div>
<div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;}</div>
<div class="ttc" id="a00194_html_a9a4a95bad0d4f4769e5e3cd8798a158a"><div class="ttname"><a href="a00194.html#a9a4a95bad0d4f4769e5e3cd8798a158a">HyPar::dim_global_ex</a></div><div class="ttdeci">int * dim_global_ex</div><div class="ttdef"><b>Definition:</b> <a href="a00224_source.html#l00067">hypar.h:67</a></div></div>
<div class="ttc" id="a00194_html_a170f2f6cc8ac86b78fcb376c2392e290"><div class="ttname"><a href="a00194.html#a170f2f6cc8ac86b78fcb376c2392e290">HyPar::spatial_scheme_par</a></div><div class="ttdeci">char spatial_scheme_par[_MAX_STRING_SIZE_]</div><div class="ttdef"><b>Definition:</b> <a href="a00224_source.html#l00091">hypar.h:91</a></div></div>
<div class="ttc" id="a00208_html_a4afd2c7b3eb8fda452474ebdbe71c8c0"><div class="ttname"><a href="a00208.html#a4afd2c7b3eb8fda452474ebdbe71c8c0">SimulationObject::mpi</a></div><div class="ttdeci">MPIVariables mpi</div><div class="ttdef"><b>Definition:</b> <a href="a00208_source.html#l00025">simulation_object.h:25</a></div></div>
<div class="ttc" id="a00197_html_a297fca986fa3aa27de07a0c746ffaaa8"><div class="ttname"><a href="a00197.html#a297fca986fa3aa27de07a0c746ffaaa8">MPIVariables::N_IORanks</a></div><div class="ttdeci">int N_IORanks</div><div class="ttdef"><b>Definition:</b> <a href="a00197_source.html#l00041">mpivars_struct.h:41</a></div></div>
<div class="ttc" id="a00194_html_ad3fe4b266b398f3a7567ac1b241d99a2"><div class="ttname"><a href="a00194.html#ad3fe4b266b398f3a7567ac1b241d99a2">HyPar::model</a></div><div class="ttdeci">char model[_MAX_STRING_SIZE_]</div><div class="ttdef"><b>Definition:</b> <a href="a00224_source.html#l00250">hypar.h:250</a></div></div>
<div class="ttc" id="a00218_html_ad6ab74942c9de13cf0b4c12eb0d91780"><div class="ttname"><a href="a00218.html#ad6ab74942c9de13cf0b4c12eb0d91780">IERR</a></div><div class="ttdeci">#define IERR</div><div class="ttdef"><b>Definition:</b> <a href="a00218_source.html#l00012">basic.h:12</a></div></div>
<div class="ttc" id="a00194_html_a5bed0cb9665daad89f4377c4f7609df4"><div class="ttname"><a href="a00194.html#a5bed0cb9665daad89f4377c4f7609df4">HyPar::SplitHyperbolicFlux</a></div><div class="ttdeci">char SplitHyperbolicFlux[_MAX_STRING_SIZE_]</div><div class="ttdef"><b>Definition:</b> <a href="a00224_source.html#l00084">hypar.h:84</a></div></div>
<div class="ttc" id="a00194_html_aa989ebb755986852177779cdf7bd8c85"><div class="ttname"><a href="a00194.html#aa989ebb755986852177779cdf7bd8c85">HyPar::dim_global</a></div><div class="ttdeci">int * dim_global</div><div class="ttdef"><b>Definition:</b> <a href="a00224_source.html#l00032">hypar.h:32</a></div></div>
<div class="ttc" id="a00208_html_a00626"><div class="ttname"><a href="a00208.html#a00626">SimulationObject</a></div><div class="ttdoc">Structure defining a simulation. </div><div class="ttdef"><b>Definition:</b> <a href="a00208_source.html#l00023">simulation_object.h:23</a></div></div>
<div class="ttc" id="a00194_html_ad45d57b33d578bf602574a221bf53d93"><div class="ttname"><a href="a00194.html#ad45d57b33d578bf602574a221bf53d93">HyPar::spatial_type_par</a></div><div class="ttdeci">char spatial_type_par[_MAX_STRING_SIZE_]</div><div class="ttdef"><b>Definition:</b> <a href="a00224_source.html#l00088">hypar.h:88</a></div></div>
<div class="ttc" id="a00194_html_a51a3b8c19b86e9e1df5be02b05a6613c"><div class="ttname"><a href="a00194.html#a51a3b8c19b86e9e1df5be02b05a6613c">HyPar::op_file_format</a></div><div class="ttdeci">char op_file_format[_MAX_STRING_SIZE_]</div><div class="ttdef"><b>Definition:</b> <a href="a00224_source.html#l00178">hypar.h:178</a></div></div>
<div class="ttc" id="a00224_html_a18ee8cd9b4297a259b08aa4cdfe30aa1"><div class="ttname"><a href="a00224.html#a18ee8cd9b4297a259b08aa4cdfe30aa1">_NC_1STAGE_</a></div><div class="ttdeci">#define _NC_1STAGE_</div><div class="ttdef"><b>Definition:</b> <a href="a00224_source.html#l00429">hypar.h:429</a></div></div>
<div class="ttc" id="a00194_html_a6ff746b30ee55a3bbb9f3306c145f27a"><div class="ttname"><a href="a00194.html#a6ff746b30ee55a3bbb9f3306c145f27a">HyPar::file_op_iter</a></div><div class="ttdeci">int file_op_iter</div><div class="ttdef"><b>Definition:</b> <a href="a00224_source.html#l00163">hypar.h:163</a></div></div>
<div class="ttc" id="a00194_html_a4e93cb107e180ef982b74cef7726b70f"><div class="ttname"><a href="a00194.html#a4e93cb107e180ef982b74cef7726b70f">HyPar::op_overwrite</a></div><div class="ttdeci">char op_overwrite[_MAX_STRING_SIZE_]</div><div class="ttdef"><b>Definition:</b> <a href="a00224_source.html#l00183">hypar.h:183</a></div></div>
<div class="ttc" id="a00194_html_aafc992b5fa79d5a4036024615d03bce6"><div class="ttname"><a href="a00194.html#aafc992b5fa79d5a4036024615d03bce6">HyPar::ghosts</a></div><div class="ttdeci">int ghosts</div><div class="ttdef"><b>Definition:</b> <a href="a00224_source.html#l00044">hypar.h:44</a></div></div>
<div class="ttc" id="a00194_html_a9591ba0fadb863561474e2ba251d2594"><div class="ttname"><a href="a00194.html#a9591ba0fadb863561474e2ba251d2594">HyPar::interp_type</a></div><div class="ttdeci">char interp_type[_MAX_STRING_SIZE_]</div><div class="ttdef"><b>Definition:</b> <a href="a00224_source.html#l00080">hypar.h:80</a></div></div>
<div class="ttc" id="a00194_html_aafb41b96563d9966e8e9f458751f2960"><div class="ttname"><a href="a00194.html#aafb41b96563d9966e8e9f458751f2960">HyPar::restart_iter</a></div><div class="ttdeci">int restart_iter</div><div class="ttdef"><b>Definition:</b> <a href="a00224_source.html#l00050">hypar.h:50</a></div></div>
<div class="ttc" id="a00194_html_ac92c34fe456d92c694eacd2231f5a7b1"><div class="ttname"><a href="a00194.html#ac92c34fe456d92c694eacd2231f5a7b1">HyPar::ConservationCheck</a></div><div class="ttdeci">char ConservationCheck[_MAX_STRING_SIZE_]</div><div class="ttdef"><b>Definition:</b> <a href="a00224_source.html#l00352">hypar.h:352</a></div></div>
<div class="ttc" id="a00234_html_ad408e5a44e863cca50112d1e2f728597"><div class="ttname"><a href="a00234.html#ad408e5a44e863cca50112d1e2f728597">MPIBroadcast_character</a></div><div class="ttdeci">int MPIBroadcast_character(char *, int, int, void *)</div><div class="ttdef"><b>Definition:</b> <a href="a00356_source.html#l00037">MPIBroadcast.c:37</a></div></div>
<div class="ttc" id="a00194_html_a74ff7fa96cbfc4ee87f508f964e94409"><div class="ttname"><a href="a00194.html#a74ff7fa96cbfc4ee87f508f964e94409">HyPar::screen_op_iter</a></div><div class="ttdeci">int screen_op_iter</div><div class="ttdef"><b>Definition:</b> <a href="a00224_source.html#l00160">hypar.h:160</a></div></div>
<div class="ttc" id="a00194_html_a5f89e286a9eaffdb66d966fa6a290d3f"><div class="ttname"><a href="a00194.html#a5f89e286a9eaffdb66d966fa6a290d3f">HyPar::output_mode</a></div><div class="ttdeci">char output_mode[_MAX_STRING_SIZE_]</div><div class="ttdef"><b>Definition:</b> <a href="a00224_source.html#l00175">hypar.h:175</a></div></div>
<div class="ttc" id="a00194_html_aa6022244a5ae02a5f457172dbf69f3e5"><div class="ttname"><a href="a00194.html#aa6022244a5ae02a5f457172dbf69f3e5">HyPar::write_residual</a></div><div class="ttdeci">int write_residual</div><div class="ttdef"><b>Definition:</b> <a href="a00224_source.html#l00166">hypar.h:166</a></div></div>
<div class="ttc" id="a00194_html_a03e28be41881b703c836edbfe9b51b17"><div class="ttname"><a href="a00194.html#a03e28be41881b703c836edbfe9b51b17">HyPar::dt</a></div><div class="ttdeci">double dt</div><div class="ttdef"><b>Definition:</b> <a href="a00224_source.html#l00059">hypar.h:59</a></div></div>
<div class="ttc" id="a00194_html_a138e751362d14724df8e6ab27c4a5e55"><div class="ttname"><a href="a00194.html#a138e751362d14724df8e6ab27c4a5e55">HyPar::time_scheme</a></div><div class="ttdeci">char time_scheme[_MAX_STRING_SIZE_]</div><div class="ttdef"><b>Definition:</b> <a href="a00224_source.html#l00070">hypar.h:70</a></div></div>
<div class="ttc" id="a00218_html_add9cf96ae374934d245a1dc1ab697a42"><div class="ttname"><a href="a00218.html#add9cf96ae374934d245a1dc1ab697a42">CHECKERR</a></div><div class="ttdeci">#define CHECKERR(ierr)</div><div class="ttdef"><b>Definition:</b> <a href="a00218_source.html#l00014">basic.h:14</a></div></div>
<div class="ttc" id="a00197_html_adad7a6f85831f3ac84d854b6c80aef43"><div class="ttname"><a href="a00197.html#adad7a6f85831f3ac84d854b6c80aef43">MPIVariables::world</a></div><div class="ttdeci">MPI_Comm world</div><div class="ttdef"><b>Definition:</b> <a href="a00197_source.html#l00037">mpivars_struct.h:37</a></div></div>
<div class="ttc" id="a00208_html_a523947ce4fa7128c4c767163953253b9"><div class="ttname"><a href="a00208.html#a523947ce4fa7128c4c767163953253b9">SimulationObject::solver</a></div><div class="ttdeci">HyPar solver</div><div class="ttdef"><b>Definition:</b> <a href="a00208_source.html#l00026">simulation_object.h:26</a></div></div>
<div class="ttc" id="a00194_html_ae8f6d2fd6490d3153cb4133bf183a404"><div class="ttname"><a href="a00194.html#ae8f6d2fd6490d3153cb4133bf183a404">HyPar::nvars</a></div><div class="ttdeci">int nvars</div><div class="ttdef"><b>Definition:</b> <a href="a00224_source.html#l00029">hypar.h:29</a></div></div>
<div class="ttc" id="a00194_html_ae83b1b0117b6a805ead2e4728945814c"><div class="ttname"><a href="a00194.html#ae83b1b0117b6a805ead2e4728945814c">HyPar::flag_ib</a></div><div class="ttdeci">int flag_ib</div><div class="ttdef"><b>Definition:</b> <a href="a00224_source.html#l00417">hypar.h:417</a></div></div>
<div class="ttc" id="a00234_html_acd7957559b9206224c7da3cab4f22b27"><div class="ttname"><a href="a00234.html#acd7957559b9206224c7da3cab4f22b27">MPIBroadcast_integer</a></div><div class="ttdeci">int MPIBroadcast_integer(int *, int, int, void *)</div><div class="ttdef"><b>Definition:</b> <a href="a00356_source.html#l00023">MPIBroadcast.c:23</a></div></div>
<div class="ttc" id="a00194_html_af0d8e0d5d3de3869b941b66b6caaf964"><div class="ttname"><a href="a00194.html#af0d8e0d5d3de3869b941b66b6caaf964">HyPar::n_iter</a></div><div class="ttdeci">int n_iter</div><div class="ttdef"><b>Definition:</b> <a href="a00224_source.html#l00047">hypar.h:47</a></div></div>
<div class="ttc" id="a00194_html_a43ee3672350b4fd385871b6512e5d47b"><div class="ttname"><a href="a00194.html#a43ee3672350b4fd385871b6512e5d47b">HyPar::ib_filename</a></div><div class="ttdeci">char ib_filename[_MAX_STRING_SIZE_]</div><div class="ttdef"><b>Definition:</b> <a href="a00224_source.html#l00415">hypar.h:415</a></div></div>
<div class="ttc" id="a00194_html_a61750696383420ba8bcc7d9e44a538e2"><div class="ttname"><a href="a00194.html#a61750696383420ba8bcc7d9e44a538e2">HyPar::time_scheme_type</a></div><div class="ttdeci">char time_scheme_type[_MAX_STRING_SIZE_]</div><div class="ttdef"><b>Definition:</b> <a href="a00224_source.html#l00073">hypar.h:73</a></div></div>
<div class="ttc" id="a00197_html_a0be0f30a83bc3f3d9f6ee3a36bbf2716"><div class="ttname"><a href="a00197.html#a0be0f30a83bc3f3d9f6ee3a36bbf2716">MPIVariables::iproc</a></div><div class="ttdeci">int * iproc</div><div class="ttdef"><b>Definition:</b> <a href="a00197_source.html#l00027">mpivars_struct.h:27</a></div></div>
<div class="ttc" id="a00234_html_a45dcb265863a65d862bb16222e7e623c"><div class="ttname"><a href="a00234.html#a45dcb265863a65d862bb16222e7e623c">MPIBroadcast_double</a></div><div class="ttdeci">int MPIBroadcast_double(double *, int, int, void *)</div><div class="ttdef"><b>Definition:</b> <a href="a00356_source.html#l00009">MPIBroadcast.c:9</a></div></div>
<div class="ttc" id="a00194_html_a83f3dcd022f744511a44f2a31a824ac8"><div class="ttname"><a href="a00194.html#a83f3dcd022f744511a44f2a31a824ac8">HyPar::ip_file_type</a></div><div class="ttdeci">char ip_file_type[_MAX_STRING_SIZE_]</div><div class="ttdef"><b>Definition:</b> <a href="a00224_source.html#l00172">hypar.h:172</a></div></div>
<div class="ttc" id="a00194_html_a484873c74138512e41bc50d17b7d955a"><div class="ttname"><a href="a00194.html#a484873c74138512e41bc50d17b7d955a">HyPar::ndims</a></div><div class="ttdeci">int ndims</div><div class="ttdef"><b>Definition:</b> <a href="a00224_source.html#l00026">hypar.h:26</a></div></div>
<div class="ttc" id="a00194_html_a0a0b9dc97c7c278a019939d301db9399"><div class="ttname"><a href="a00194.html#a0a0b9dc97c7c278a019939d301db9399">HyPar::input_mode</a></div><div class="ttdeci">char input_mode[_MAX_STRING_SIZE_]</div><div class="ttdef"><b>Definition:</b> <a href="a00224_source.html#l00169">hypar.h:169</a></div></div>
<div class="ttc" id="a00194_html_ad29846eeb9c83b329a8d7c1fe69d46b2"><div class="ttname"><a href="a00194.html#ad29846eeb9c83b329a8d7c1fe69d46b2">HyPar::spatial_scheme_hyp</a></div><div class="ttdeci">char spatial_scheme_hyp[_MAX_STRING_SIZE_]</div><div class="ttdef"><b>Definition:</b> <a href="a00224_source.html#l00076">hypar.h:76</a></div></div>
<div class="ttc" id="a00218_html_a51efea86a4d76d1259893f606b776573"><div class="ttname"><a href="a00218.html#a51efea86a4d76d1259893f606b776573">_MAX_STRING_SIZE_</a></div><div class="ttdeci">#define _MAX_STRING_SIZE_</div><div class="ttdef"><b>Definition:</b> <a href="a00218_source.html#l00010">basic.h:10</a></div></div>
<div class="ttc" id="a00194_html_a38e0371f331cecbe63a77fa03e202afe"><div class="ttname"><a href="a00194.html#a38e0371f331cecbe63a77fa03e202afe">HyPar::dim_local</a></div><div class="ttdeci">int * dim_local</div><div class="ttdef"><b>Definition:</b> <a href="a00224_source.html#l00035">hypar.h:35</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ab7f2f81eb1c5fa3514754cac29eee868"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int WriteInputs </td>
          <td>(</td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>s</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>nsims</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>rank</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Write the input parameters</p>
<p>Write the simulation inputs read from the file <b>solver.inp</b>. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">s</td><td>Array of simulation objects of type <a class="el" href="a00208.html#a00626" title="Structure defining a simulation. ">SimulationObject</a> of size nsims </td></tr>
    <tr><td class="paramname">nsims</td><td>Number of simulation objects </td></tr>
    <tr><td class="paramname">rank</td><td>MPI rank of this process </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="a00566_source.html#l00015">15</a> of file <a class="el" href="a00566_source.html">WriteInputs.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;{</div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;  <a class="code" href="a00208.html#a00626">SimulationObject</a> *sim = (<a class="code" href="a00208.html#a00626">SimulationObject</a>*) s;</div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;  <span class="keywordtype">int</span> n;</div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;</div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;  <span class="keywordflow">if</span> (sim == NULL)  <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;</div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;  <span class="keywordflow">if</span> (!rank) {</div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;</div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;    printf(<span class="stringliteral">&quot;  No. of dimensions                          : %d\n&quot;</span>,sim[0].solver.ndims);</div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;    printf(<span class="stringliteral">&quot;  No. of variables                           : %d\n&quot;</span>,sim[0].solver.nvars);</div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;    <span class="keywordflow">if</span> (nsims &gt; 1) {</div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;      printf(<span class="stringliteral">&quot;  Domain sizes:\n&quot;</span>);</div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> n = 0; n &lt; nsims; n++) {</div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;        printf(<span class="stringliteral">&quot;    domain %3d - &quot;</span>, n);</div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;sim[n].<a class="code" href="a00208.html#a523947ce4fa7128c4c767163953253b9">solver</a>.<a class="code" href="a00194.html#a484873c74138512e41bc50d17b7d955a">ndims</a>; i++) printf (<span class="stringliteral">&quot;%d &quot;</span>,sim[n].solver.dim_global[i]);</div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;        printf(<span class="stringliteral">&quot;\n&quot;</span>);</div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;      }</div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;<span class="preprocessor">#ifndef serial</span></div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;<span class="preprocessor"></span>        printf(<span class="stringliteral">&quot;  Processes along each dimension:\n&quot;</span>);</div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> n = 0; n &lt; nsims; n++) {</div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;        printf(<span class="stringliteral">&quot;    domain %3d - &quot;</span>, n);</div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;sim[n].<a class="code" href="a00208.html#a523947ce4fa7128c4c767163953253b9">solver</a>.<a class="code" href="a00194.html#a484873c74138512e41bc50d17b7d955a">ndims</a>; i++) printf (<span class="stringliteral">&quot;%d &quot;</span>,sim[n].mpi.iproc[i]);</div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;        printf(<span class="stringliteral">&quot;\n&quot;</span>);</div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;      }</div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;<span class="preprocessor"></span>      printf(<span class="stringliteral">&quot;  Exact solution domain sizes:\n&quot;</span>);</div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> n = 0; n &lt; nsims; n++) {</div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;        printf(<span class="stringliteral">&quot;    domain %3d - &quot;</span>, n);</div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;sim[n].<a class="code" href="a00208.html#a523947ce4fa7128c4c767163953253b9">solver</a>.<a class="code" href="a00194.html#a484873c74138512e41bc50d17b7d955a">ndims</a>; i++) printf (<span class="stringliteral">&quot;%d &quot;</span>,sim[n].solver.dim_global_ex[i]);</div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;        printf(<span class="stringliteral">&quot;\n&quot;</span>);</div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;      }</div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;        printf(<span class="stringliteral">&quot;  Domain size                                : &quot;</span>);</div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;sim[0].<a class="code" href="a00208.html#a523947ce4fa7128c4c767163953253b9">solver</a>.<a class="code" href="a00194.html#a484873c74138512e41bc50d17b7d955a">ndims</a>; i++) printf (<span class="stringliteral">&quot;%d &quot;</span>,sim[0].solver.dim_global[i]);</div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;      printf(<span class="stringliteral">&quot;\n&quot;</span>);</div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;<span class="preprocessor">#ifndef serial</span></div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;<span class="preprocessor"></span>        printf(<span class="stringliteral">&quot;  Processes along each dimension             : &quot;</span>);</div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;sim[0].<a class="code" href="a00208.html#a523947ce4fa7128c4c767163953253b9">solver</a>.<a class="code" href="a00194.html#a484873c74138512e41bc50d17b7d955a">ndims</a>; i++) printf (<span class="stringliteral">&quot;%d &quot;</span>,sim[0].mpi.iproc[i]);</div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;      printf(<span class="stringliteral">&quot;\n&quot;</span>);</div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;<span class="preprocessor"></span>        printf(<span class="stringliteral">&quot;  Exact solution domain size                 : &quot;</span>);</div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;sim[0].<a class="code" href="a00208.html#a523947ce4fa7128c4c767163953253b9">solver</a>.<a class="code" href="a00194.html#a484873c74138512e41bc50d17b7d955a">ndims</a>; i++) printf (<span class="stringliteral">&quot;%d &quot;</span>,sim[0].solver.dim_global_ex[i]);</div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;      printf(<span class="stringliteral">&quot;\n&quot;</span>);</div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;    }</div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;      printf(<span class="stringliteral">&quot;  No. of ghosts pts                          : %d\n&quot;</span>     ,sim[0].solver.ghosts              );</div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;      printf(<span class="stringliteral">&quot;  No. of iter.                               : %d\n&quot;</span>     ,sim[0].solver.n_iter              );</div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;      printf(<span class="stringliteral">&quot;  Restart iteration                          : %d\n&quot;</span>     ,sim[0].solver.restart_iter        );</div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;<span class="preprocessor">#ifdef with_petsc</span></div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;<span class="preprocessor"></span>    <span class="keywordflow">if</span> (sim[0].solver.use_petscTS)</div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;      printf(<span class="stringliteral">&quot;  Time integration scheme                    : PETSc \n&quot;</span>                            );</div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;    <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;      printf(<span class="stringliteral">&quot;  Time integration scheme                    : %s &quot;</span>,sim[0].solver.time_scheme             );</div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;      <span class="keywordflow">if</span> (strcmp(sim[0].solver.time_scheme,<a class="code" href="a00189.html#af9b1e641532cff8859c5c5a8377f5feb">_FORWARD_EULER_</a>)) {</div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;        printf(<span class="stringliteral">&quot;(%s)&quot;</span>,sim[0].solver.time_scheme_type                                                    );</div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;      }</div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;      printf(<span class="stringliteral">&quot;\n&quot;</span>);</div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;    }</div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;<span class="preprocessor">#else</span></div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;<span class="preprocessor"></span>    printf(<span class="stringliteral">&quot;  Time integration scheme                    : %s &quot;</span>,sim[0].solver.time_scheme               );</div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;    <span class="keywordflow">if</span> (strcmp(sim[0].solver.time_scheme,<a class="code" href="a00189.html#af9b1e641532cff8859c5c5a8377f5feb">_FORWARD_EULER_</a>)) {</div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;      printf(<span class="stringliteral">&quot;(%s)&quot;</span>,sim[0].solver.time_scheme_type                                                      );</div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;    }</div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;    printf(<span class="stringliteral">&quot;\n&quot;</span>);</div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;<span class="preprocessor"></span>    printf(<span class="stringliteral">&quot;  Spatial discretization scheme (hyperbolic) : %s\n&quot;</span>     ,sim[0].solver.spatial_scheme_hyp  );</div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;    printf(<span class="stringliteral">&quot;  Split hyperbolic flux term?                : %s\n&quot;</span>     ,sim[0].solver.SplitHyperbolicFlux );</div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;    printf(<span class="stringliteral">&quot;  Interpolation type for hyperbolic term     : %s\n&quot;</span>     ,sim[0].solver.interp_type         );</div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;    printf(<span class="stringliteral">&quot;  Spatial discretization type   (parabolic ) : %s\n&quot;</span>     ,sim[0].solver.spatial_type_par    );</div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;    printf(<span class="stringliteral">&quot;  Spatial discretization scheme (parabolic ) : %s\n&quot;</span>     ,sim[0].solver.spatial_scheme_par  );</div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;    printf(<span class="stringliteral">&quot;  Time Step                                  : %E\n&quot;</span>     ,sim[0].solver.dt                  );</div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;    printf(<span class="stringliteral">&quot;  Check for conservation                     : %s\n&quot;</span>     ,sim[0].solver.ConservationCheck   );</div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;    printf(<span class="stringliteral">&quot;  Screen output iterations                   : %d\n&quot;</span>     ,sim[0].solver.screen_op_iter      );</div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;    printf(<span class="stringliteral">&quot;  File output iterations                     : %d\n&quot;</span>     ,sim[0].solver.file_op_iter        );</div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;    printf(<span class="stringliteral">&quot;  Initial solution file type                 : %s\n&quot;</span>     ,sim[0].solver.ip_file_type        );</div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;    printf(<span class="stringliteral">&quot;  Initial solution read mode                 : %s&quot;</span>       ,sim[0].solver.input_mode          );</div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;    <span class="keywordflow">if</span> (strcmp(sim[0].solver.input_mode,<span class="stringliteral">&quot;serial&quot;</span>))    printf(<span class="stringliteral">&quot;  [%d file IO rank(s)]\n&quot;</span>,sim[0].mpi.N_IORanks  );</div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;    <span class="keywordflow">else</span>                                        printf(<span class="stringliteral">&quot;\n&quot;</span>);</div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;    printf(<span class="stringliteral">&quot;  Solution file write mode                   : %s&quot;</span>       ,sim[0].solver.output_mode         );</div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;    <span class="keywordflow">if</span> (strcmp(sim[0].solver.output_mode,<span class="stringliteral">&quot;serial&quot;</span>))   printf(<span class="stringliteral">&quot;  [%d file IO rank(s)]\n&quot;</span>,sim[0].mpi.N_IORanks  );</div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;    <span class="keywordflow">else</span>                                        printf(<span class="stringliteral">&quot;\n&quot;</span>);</div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;    printf(<span class="stringliteral">&quot;  Solution file format                       : %s\n&quot;</span>     ,sim[0].solver.op_file_format      );</div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;    printf(<span class="stringliteral">&quot;  Overwrite solution file                    : %s\n&quot;</span>     ,sim[0].solver.op_overwrite        );</div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;    printf(<span class="stringliteral">&quot;  Physical model                             : %s\n&quot;</span>     ,sim[0].solver.model               );</div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;    <span class="keywordflow">if</span> (sim[0].solver.flag_ib) {</div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;      printf(<span class="stringliteral">&quot;  Immersed Body                              : %s\n&quot;</span>     ,sim[0].solver.ib_filename         );</div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;    }</div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;    </div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;  }</div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;</div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;  <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;}</div>
<div class="ttc" id="a00208_html_a00626"><div class="ttname"><a href="a00208.html#a00626">SimulationObject</a></div><div class="ttdoc">Structure defining a simulation. </div><div class="ttdef"><b>Definition:</b> <a href="a00208_source.html#l00023">simulation_object.h:23</a></div></div>
<div class="ttc" id="a00189_html_af9b1e641532cff8859c5c5a8377f5feb"><div class="ttname"><a href="a00189.html#af9b1e641532cff8859c5c5a8377f5feb">_FORWARD_EULER_</a></div><div class="ttdeci">#define _FORWARD_EULER_</div><div class="ttdef"><b>Definition:</b> <a href="a00189_source.html#l00014">timeintegration_struct.h:14</a></div></div>
<div class="ttc" id="a00208_html_a523947ce4fa7128c4c767163953253b9"><div class="ttname"><a href="a00208.html#a523947ce4fa7128c4c767163953253b9">SimulationObject::solver</a></div><div class="ttdeci">HyPar solver</div><div class="ttdef"><b>Definition:</b> <a href="a00208_source.html#l00026">simulation_object.h:26</a></div></div>
<div class="ttc" id="a00194_html_a484873c74138512e41bc50d17b7d955a"><div class="ttname"><a href="a00194.html#a484873c74138512e41bc50d17b7d955a">HyPar::ndims</a></div><div class="ttdeci">int ndims</div><div class="ttdef"><b>Definition:</b> <a href="a00224_source.html#l00026">hypar.h:26</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a74087f11196b3689b296e53eb14b69f3"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int Initialize </td>
          <td>(</td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>s</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>nsims</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Initialize the solver</p>
<p>Initialization function called at the beginning of a simulation. This function does the following:</p>
<ul>
<li>allocates memory for MPI related arrays</li>
<li>initializes the values for MPI variables</li>
<li>creates sub-communicators and communication groups</li>
<li>allocates memory for arrays to store solution, right-hand-side, flux, and other working vectors.</li>
<li>initializes function counters to zero </li>
</ul>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">s</td><td>Array of simulation objects of type <a class="el" href="a00208.html#a00626" title="Structure defining a simulation. ">SimulationObject</a> </td></tr>
    <tr><td class="paramname">nsims</td><td>Number of simulation objects </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="a00552_source.html#l00022">22</a> of file <a class="el" href="a00552_source.html">Initialize.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;{</div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;  <a class="code" href="a00208.html#a00626">SimulationObject</a>* simobj = (<a class="code" href="a00208.html#a00626">SimulationObject</a>*) s;</div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;  <span class="keywordtype">int</span> i,d,n;</div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;</div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;  <span class="keywordflow">if</span> (nsims == 0) {</div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;    <span class="keywordflow">return</span> 1;</div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;  }</div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;</div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;  <span class="keywordflow">if</span> (!simobj[0].mpi.rank)  printf(<span class="stringliteral">&quot;Partitioning domain and allocating data arrays.\n&quot;</span>);</div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;</div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;  <span class="keywordflow">for</span> (n = 0; n &lt; nsims; n++) {</div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;</div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;    <span class="comment">/* this is a full initialization, not a barebones one */</span></div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;    simobj[n].<a class="code" href="a00208.html#a23988a34071e1a0f0de820a4043a1fc8">is_barebones</a> = 0;</div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;</div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;    <span class="comment">/* allocations */</span></div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;    simobj[n].<a class="code" href="a00208.html#a4afd2c7b3eb8fda452474ebdbe71c8c0">mpi</a>.<a class="code" href="a00197.html#aa3c28612a64b8a97bde66b720e15c700">ip</a>           = (<span class="keywordtype">int</span>*) calloc (simobj[n].solver.ndims,<span class="keyword">sizeof</span>(<span class="keywordtype">int</span>));</div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;    simobj[n].<a class="code" href="a00208.html#a4afd2c7b3eb8fda452474ebdbe71c8c0">mpi</a>.<a class="code" href="a00197.html#a481013ba007a99a4237cde5eeb3c9a29">is</a>           = (<span class="keywordtype">int</span>*) calloc (simobj[n].solver.ndims,<span class="keyword">sizeof</span>(<span class="keywordtype">int</span>));</div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;    simobj[n].<a class="code" href="a00208.html#a4afd2c7b3eb8fda452474ebdbe71c8c0">mpi</a>.<a class="code" href="a00197.html#a7602de5ebb1b59ec35217e78a35a531e">ie</a>           = (<span class="keywordtype">int</span>*) calloc (simobj[n].solver.ndims,<span class="keyword">sizeof</span>(<span class="keywordtype">int</span>));</div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;    simobj[n].<a class="code" href="a00208.html#a4afd2c7b3eb8fda452474ebdbe71c8c0">mpi</a>.<a class="code" href="a00197.html#af40a5a3066fdb53a47e4627071abc2bc">bcperiodic</a>   = (<span class="keywordtype">int</span>*) calloc (simobj[n].solver.ndims,<span class="keyword">sizeof</span>(<span class="keywordtype">int</span>));</div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;    simobj[n].<a class="code" href="a00208.html#a523947ce4fa7128c4c767163953253b9">solver</a>.<a class="code" href="a00194.html#a38e0371f331cecbe63a77fa03e202afe">dim_local</a> = (<span class="keywordtype">int</span>*) calloc (simobj[n].solver.ndims,<span class="keyword">sizeof</span>(<span class="keywordtype">int</span>));</div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;    simobj[n].<a class="code" href="a00208.html#a523947ce4fa7128c4c767163953253b9">solver</a>.<a class="code" href="a00194.html#a40e3f67b1530d5ea4e913fc60b594802">isPeriodic</a>= (<span class="keywordtype">int</span>*) calloc (simobj[n].solver.ndims,<span class="keyword">sizeof</span>(<span class="keywordtype">int</span>));</div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;</div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;<span class="preprocessor">#ifndef serial</span></div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;<span class="preprocessor"></span>    <a class="code" href="a00218.html#a68f50121fb9a7daeaf60e50cdef82ef3">_DECLARE_IERR_</a>;</div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;  </div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;    <span class="comment">/* Domain partitioning */</span></div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;    <span class="keywordtype">int</span> total_proc = 1;</div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;    <span class="keywordflow">for</span> (i=0; i&lt;simobj[n].<a class="code" href="a00208.html#a523947ce4fa7128c4c767163953253b9">solver</a>.<a class="code" href="a00194.html#a484873c74138512e41bc50d17b7d955a">ndims</a>; i++) total_proc *= simobj[n].mpi.iproc[i];</div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;    if (simobj[n].mpi.nproc != total_proc) {</div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;      fprintf(stderr,<span class="stringliteral">&quot;Error on rank %d: total number of processes is not consistent &quot;</span>, simobj[n].mpi.rank);</div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;      fprintf(stderr,<span class="stringliteral">&quot;with number of processes along each dimension.\n&quot;</span>);</div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;      <span class="keywordflow">if</span> (nsims &gt; 1) fprintf(stderr,<span class="stringliteral">&quot;for domain %d.\n&quot;</span>, n);</div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;      fprintf(stderr,<span class="stringliteral">&quot;mpiexec was called with %d processes, &quot;</span>,simobj[n].mpi.nproc);</div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;      fprintf(stderr,<span class="stringliteral">&quot;total number of processes from \&quot;solver.inp\&quot; is %d.\n&quot;</span>, total_proc);</div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;      <span class="keywordflow">return</span>(1);</div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;    }</div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;  </div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;    <span class="comment">/* calculate ndims-D rank of each process (ip[]) from rank in MPI_COMM_WORLD */</span></div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;    <a class="code" href="a00218.html#ad6ab74942c9de13cf0b4c12eb0d91780">IERR</a> <a class="code" href="a00234.html#afe59a0480bb81cc0d7877ba547b3e28c">MPIRanknD</a>( simobj[n].solver.ndims,</div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;                    simobj[n].<a class="code" href="a00208.html#a4afd2c7b3eb8fda452474ebdbe71c8c0">mpi</a>.<a class="code" href="a00197.html#a6cfd95afd0afebd625b889fb6e58371c">rank</a>,</div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;                    simobj[n].<a class="code" href="a00208.html#a4afd2c7b3eb8fda452474ebdbe71c8c0">mpi</a>.<a class="code" href="a00197.html#a0be0f30a83bc3f3d9f6ee3a36bbf2716">iproc</a>,</div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;                    simobj[n].<a class="code" href="a00208.html#a4afd2c7b3eb8fda452474ebdbe71c8c0">mpi</a>.<a class="code" href="a00197.html#aa3c28612a64b8a97bde66b720e15c700">ip</a>); <a class="code" href="a00218.html#add9cf96ae374934d245a1dc1ab697a42">CHECKERR</a>(ierr);</div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;  </div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;    <span class="comment">/* calculate local domain sizes along each dimension */</span></div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;    <span class="keywordflow">for</span> (i=0; i&lt;simobj[n].<a class="code" href="a00208.html#a523947ce4fa7128c4c767163953253b9">solver</a>.<a class="code" href="a00194.html#a484873c74138512e41bc50d17b7d955a">ndims</a>; i++) {</div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;      simobj[n].<a class="code" href="a00208.html#a523947ce4fa7128c4c767163953253b9">solver</a>.<a class="code" href="a00194.html#a38e0371f331cecbe63a77fa03e202afe">dim_local</a>[i] = <a class="code" href="a00234.html#af8194ca5a460534fdbe391035a95c69d">MPIPartition1D</a>( simobj[n].solver.dim_global[i],</div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;                                                      simobj[n].<a class="code" href="a00208.html#a4afd2c7b3eb8fda452474ebdbe71c8c0">mpi</a>.<a class="code" href="a00197.html#a0be0f30a83bc3f3d9f6ee3a36bbf2716">iproc</a>[i],</div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;                                                      simobj[n].<a class="code" href="a00208.html#a4afd2c7b3eb8fda452474ebdbe71c8c0">mpi</a>.<a class="code" href="a00197.html#aa3c28612a64b8a97bde66b720e15c700">ip</a>[i] );</div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;    }</div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;  </div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;    <span class="comment">/* calculate local domain limits in terms of global domain */</span></div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;    <a class="code" href="a00218.html#ad6ab74942c9de13cf0b4c12eb0d91780">IERR</a> <a class="code" href="a00234.html#a9a3fc32b7d4bea6a1dac44ab21c9202e">MPILocalDomainLimits</a>(  simobj[n].solver.ndims,</div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;                                simobj[n].<a class="code" href="a00208.html#a4afd2c7b3eb8fda452474ebdbe71c8c0">mpi</a>.<a class="code" href="a00197.html#a6cfd95afd0afebd625b889fb6e58371c">rank</a>,</div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;                                &amp;(simobj[n].<a class="code" href="a00208.html#a4afd2c7b3eb8fda452474ebdbe71c8c0">mpi</a>),</div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;                                simobj[n].<a class="code" href="a00208.html#a523947ce4fa7128c4c767163953253b9">solver</a>.<a class="code" href="a00194.html#aa989ebb755986852177779cdf7bd8c85">dim_global</a>,</div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;                                simobj[n].<a class="code" href="a00208.html#a4afd2c7b3eb8fda452474ebdbe71c8c0">mpi</a>.<a class="code" href="a00197.html#a481013ba007a99a4237cde5eeb3c9a29">is</a>,</div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;                                simobj[n].<a class="code" href="a00208.html#a4afd2c7b3eb8fda452474ebdbe71c8c0">mpi</a>.<a class="code" href="a00197.html#a7602de5ebb1b59ec35217e78a35a531e">ie</a>  );</div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;    <a class="code" href="a00218.html#add9cf96ae374934d245a1dc1ab697a42">CHECKERR</a>(ierr);</div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;  </div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;    <span class="comment">/* create sub-communicators for parallel computations along grid lines in each dimension */</span></div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;    <a class="code" href="a00218.html#ad6ab74942c9de13cf0b4c12eb0d91780">IERR</a> <a class="code" href="a00234.html#ade449de8860c4b1060ca15bf7a80476f">MPICreateCommunicators</a>(simobj[n].solver.ndims,&amp;(simobj[n].<a class="code" href="a00208.html#a4afd2c7b3eb8fda452474ebdbe71c8c0">mpi</a>)); <a class="code" href="a00218.html#add9cf96ae374934d245a1dc1ab697a42">CHECKERR</a>(ierr);</div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;  </div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;    <span class="comment">/* initialize periodic BC flags to zero */</span></div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;    <span class="keywordflow">for</span> (i=0; i&lt;simobj[n].<a class="code" href="a00208.html#a523947ce4fa7128c4c767163953253b9">solver</a>.<a class="code" href="a00194.html#a484873c74138512e41bc50d17b7d955a">ndims</a>; i++) simobj[n].mpi.bcperiodic[i] = 0;</div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;  </div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;    <span class="comment">/* create communication groups */</span></div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;    <a class="code" href="a00218.html#ad6ab74942c9de13cf0b4c12eb0d91780">IERR</a> <a class="code" href="a00234.html#a87419c70e96bbafe1e63821ba1d2e975">MPICreateIOGroups</a>(&amp;(simobj[n].mpi)); <a class="code" href="a00218.html#add9cf96ae374934d245a1dc1ab697a42">CHECKERR</a>(ierr);</div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;</div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;<span class="preprocessor">#else</span></div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;<span class="preprocessor"></span></div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;    <span class="keywordflow">for</span> (i=0; i&lt;simobj[n].<a class="code" href="a00208.html#a523947ce4fa7128c4c767163953253b9">solver</a>.<a class="code" href="a00194.html#a484873c74138512e41bc50d17b7d955a">ndims</a>; i++) {</div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;      simobj[n].<a class="code" href="a00208.html#a4afd2c7b3eb8fda452474ebdbe71c8c0">mpi</a>.<a class="code" href="a00197.html#aa3c28612a64b8a97bde66b720e15c700">ip</a>[i]            = 0;</div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;      simobj[n].<a class="code" href="a00208.html#a523947ce4fa7128c4c767163953253b9">solver</a>.<a class="code" href="a00194.html#a38e0371f331cecbe63a77fa03e202afe">dim_local</a>[i]  = simobj[n].<a class="code" href="a00208.html#a523947ce4fa7128c4c767163953253b9">solver</a>.<a class="code" href="a00194.html#aa989ebb755986852177779cdf7bd8c85">dim_global</a>[i];</div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;      simobj[n].<a class="code" href="a00208.html#a4afd2c7b3eb8fda452474ebdbe71c8c0">mpi</a>.<a class="code" href="a00197.html#a0be0f30a83bc3f3d9f6ee3a36bbf2716">iproc</a>[i]         = 1;</div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;      simobj[n].<a class="code" href="a00208.html#a4afd2c7b3eb8fda452474ebdbe71c8c0">mpi</a>.<a class="code" href="a00197.html#a481013ba007a99a4237cde5eeb3c9a29">is</a>[i]            = 0;</div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;      simobj[n].<a class="code" href="a00208.html#a4afd2c7b3eb8fda452474ebdbe71c8c0">mpi</a>.<a class="code" href="a00197.html#a7602de5ebb1b59ec35217e78a35a531e">ie</a>[i]            = simobj[n].<a class="code" href="a00208.html#a523947ce4fa7128c4c767163953253b9">solver</a>.<a class="code" href="a00194.html#a38e0371f331cecbe63a77fa03e202afe">dim_local</a>[i];</div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;      simobj[n].<a class="code" href="a00208.html#a4afd2c7b3eb8fda452474ebdbe71c8c0">mpi</a>.<a class="code" href="a00197.html#af40a5a3066fdb53a47e4627071abc2bc">bcperiodic</a>[i]    = 0;</div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;    }</div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;</div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;<span class="preprocessor"></span></div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;    simobj[n].<a class="code" href="a00208.html#a523947ce4fa7128c4c767163953253b9">solver</a>.<a class="code" href="a00194.html#a4e67f54563a3c4ff005dfaf0130f957c">npoints_global</a> </div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;      = simobj[n].<a class="code" href="a00208.html#a523947ce4fa7128c4c767163953253b9">solver</a>.<a class="code" href="a00194.html#afae6319baba315ac1f0c56505610ed85">npoints_local</a> </div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;      = simobj[n].<a class="code" href="a00208.html#a523947ce4fa7128c4c767163953253b9">solver</a>.<a class="code" href="a00194.html#a20ee1fd00a220b98513127884a5558cf">npoints_local_wghosts</a> </div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;      = 1;</div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;    <span class="keywordflow">for</span> (i=0; i&lt;simobj[n].<a class="code" href="a00208.html#a523947ce4fa7128c4c767163953253b9">solver</a>.<a class="code" href="a00194.html#a484873c74138512e41bc50d17b7d955a">ndims</a>; i++) {</div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;      simobj[n].<a class="code" href="a00208.html#a523947ce4fa7128c4c767163953253b9">solver</a>.<a class="code" href="a00194.html#a4e67f54563a3c4ff005dfaf0130f957c">npoints_global</a> *= simobj[n].<a class="code" href="a00208.html#a523947ce4fa7128c4c767163953253b9">solver</a>.<a class="code" href="a00194.html#aa989ebb755986852177779cdf7bd8c85">dim_global</a>[i];</div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;      simobj[n].<a class="code" href="a00208.html#a523947ce4fa7128c4c767163953253b9">solver</a>.<a class="code" href="a00194.html#afae6319baba315ac1f0c56505610ed85">npoints_local</a> *= simobj[n].<a class="code" href="a00208.html#a523947ce4fa7128c4c767163953253b9">solver</a>.<a class="code" href="a00194.html#a38e0371f331cecbe63a77fa03e202afe">dim_local</a> [i];</div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;      simobj[n].<a class="code" href="a00208.html#a523947ce4fa7128c4c767163953253b9">solver</a>.<a class="code" href="a00194.html#a20ee1fd00a220b98513127884a5558cf">npoints_local_wghosts</a> *= (simobj[n].<a class="code" href="a00208.html#a523947ce4fa7128c4c767163953253b9">solver</a>.<a class="code" href="a00194.html#a38e0371f331cecbe63a77fa03e202afe">dim_local</a>[i]+2*simobj[n].<a class="code" href="a00208.html#a523947ce4fa7128c4c767163953253b9">solver</a>.<a class="code" href="a00194.html#aafc992b5fa79d5a4036024615d03bce6">ghosts</a>);</div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;    }</div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;  </div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;    <span class="comment">/* Allocations */</span></div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;    simobj[n].<a class="code" href="a00208.html#a523947ce4fa7128c4c767163953253b9">solver</a>.<a class="code" href="a00194.html#a95e9e0f8a692321b83a2e0ce2789c485">index</a> = (<span class="keywordtype">int</span>*) calloc (simobj[n].solver.ndims,<span class="keyword">sizeof</span>(<span class="keywordtype">int</span>));</div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;    simobj[n].<a class="code" href="a00208.html#a523947ce4fa7128c4c767163953253b9">solver</a>.<a class="code" href="a00194.html#a39dc7def53a36bdc722aa90f52e04561">stride_with_ghosts</a> = (<span class="keywordtype">int</span>*) calloc (simobj[n].solver.ndims,<span class="keyword">sizeof</span>(<span class="keywordtype">int</span>));</div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;    simobj[n].<a class="code" href="a00208.html#a523947ce4fa7128c4c767163953253b9">solver</a>.<a class="code" href="a00194.html#a98bbff775d127bdd2451b55ce3d06e06">stride_without_ghosts</a> = (<span class="keywordtype">int</span>*) calloc (simobj[n].solver.ndims,<span class="keyword">sizeof</span>(<span class="keywordtype">int</span>));</div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;    <span class="keywordtype">int</span> accu1 = 1, accu2 = 1;</div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;    <span class="keywordflow">for</span> (i=0; i&lt;simobj[n].<a class="code" href="a00208.html#a523947ce4fa7128c4c767163953253b9">solver</a>.<a class="code" href="a00194.html#a484873c74138512e41bc50d17b7d955a">ndims</a>; i++) {</div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;      simobj[n].<a class="code" href="a00208.html#a523947ce4fa7128c4c767163953253b9">solver</a>.<a class="code" href="a00194.html#a39dc7def53a36bdc722aa90f52e04561">stride_with_ghosts</a>[i]    = accu1;</div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;      simobj[n].<a class="code" href="a00208.html#a523947ce4fa7128c4c767163953253b9">solver</a>.<a class="code" href="a00194.html#a98bbff775d127bdd2451b55ce3d06e06">stride_without_ghosts</a>[i] = accu2;</div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;      accu1 *= (simobj[n].<a class="code" href="a00208.html#a523947ce4fa7128c4c767163953253b9">solver</a>.<a class="code" href="a00194.html#a38e0371f331cecbe63a77fa03e202afe">dim_local</a>[i]+2*simobj[n].<a class="code" href="a00208.html#a523947ce4fa7128c4c767163953253b9">solver</a>.<a class="code" href="a00194.html#aafc992b5fa79d5a4036024615d03bce6">ghosts</a>);</div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;      accu2 *=  simobj[n].<a class="code" href="a00208.html#a523947ce4fa7128c4c767163953253b9">solver</a>.<a class="code" href="a00194.html#a38e0371f331cecbe63a77fa03e202afe">dim_local</a>[i];</div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;    }</div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;</div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;    <span class="keywordtype">int</span> size;</div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;</div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;    <span class="comment">/* state variables */</span></div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;    size = 1;</div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;    <span class="keywordflow">for</span> (i=0; i&lt;simobj[n].<a class="code" href="a00208.html#a523947ce4fa7128c4c767163953253b9">solver</a>.<a class="code" href="a00194.html#a484873c74138512e41bc50d17b7d955a">ndims</a>; i++) {</div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;      size *= (simobj[n].<a class="code" href="a00208.html#a523947ce4fa7128c4c767163953253b9">solver</a>.<a class="code" href="a00194.html#a38e0371f331cecbe63a77fa03e202afe">dim_local</a>[i]+2*simobj[n].<a class="code" href="a00208.html#a523947ce4fa7128c4c767163953253b9">solver</a>.<a class="code" href="a00194.html#aafc992b5fa79d5a4036024615d03bce6">ghosts</a>);</div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;    }</div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;    simobj[n].<a class="code" href="a00208.html#a523947ce4fa7128c4c767163953253b9">solver</a>.<a class="code" href="a00194.html#a3b6b999a764f1e2ea94bb5f28c7a558c">u</a> = (<span class="keywordtype">double</span>*) calloc (simobj[n].solver.nvars*size,<span class="keyword">sizeof</span>(<span class="keywordtype">double</span>));</div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;<span class="preprocessor">#ifdef with_petsc</span></div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;<span class="preprocessor"></span>    <span class="keywordflow">if</span> (simobj[n].solver.use_petscTS) {</div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;      simobj[n].<a class="code" href="a00208.html#a523947ce4fa7128c4c767163953253b9">solver</a>.<a class="code" href="a00194.html#acab4b9b417d6c3745ad789099d3731c6">u0</a>      = (<span class="keywordtype">double</span>*) calloc (simobj[n].solver.nvars*size,<span class="keyword">sizeof</span>(<span class="keywordtype">double</span>));</div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;      simobj[n].<a class="code" href="a00208.html#a523947ce4fa7128c4c767163953253b9">solver</a>.<a class="code" href="a00194.html#a3ccc9ddb96600c40dcc41bb1ded11160">uref</a>    = (<span class="keywordtype">double</span>*) calloc (simobj[n].solver.nvars*size,<span class="keyword">sizeof</span>(<span class="keywordtype">double</span>));</div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;      simobj[n].<a class="code" href="a00208.html#a523947ce4fa7128c4c767163953253b9">solver</a>.<a class="code" href="a00194.html#ad587a58397d439c443ae325450a01a13">rhsref</a>  = (<span class="keywordtype">double</span>*) calloc (simobj[n].solver.nvars*size,<span class="keyword">sizeof</span>(<span class="keywordtype">double</span>));</div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;      simobj[n].<a class="code" href="a00208.html#a523947ce4fa7128c4c767163953253b9">solver</a>.<a class="code" href="a00194.html#ade4650485fe35fd3e12fea272fc80209">rhs</a>     = (<span class="keywordtype">double</span>*) calloc (simobj[n].solver.nvars*size,<span class="keyword">sizeof</span>(<span class="keywordtype">double</span>));</div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;    } <span class="keywordflow">else</span> simobj[n].<a class="code" href="a00208.html#a523947ce4fa7128c4c767163953253b9">solver</a>.<a class="code" href="a00194.html#acab4b9b417d6c3745ad789099d3731c6">u0</a> = simobj[n].<a class="code" href="a00208.html#a523947ce4fa7128c4c767163953253b9">solver</a>.<a class="code" href="a00194.html#a3ccc9ddb96600c40dcc41bb1ded11160">uref</a> = simobj[n].<a class="code" href="a00208.html#a523947ce4fa7128c4c767163953253b9">solver</a>.<a class="code" href="a00194.html#ad587a58397d439c443ae325450a01a13">rhsref</a> = simobj[n].<a class="code" href="a00208.html#a523947ce4fa7128c4c767163953253b9">solver</a>.<a class="code" href="a00194.html#ade4650485fe35fd3e12fea272fc80209">rhs</a> = NULL;</div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;<span class="preprocessor"></span><span class="preprocessor">#ifdef with_librom</span></div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;<span class="preprocessor"></span>    simobj[n].<a class="code" href="a00208.html#a523947ce4fa7128c4c767163953253b9">solver</a>.<a class="code" href="a00194.html#aac11b2a653ffaeac4b35057431f1b981">u_rom_predicted</a> = (<span class="keywordtype">double</span>*) calloc (simobj[n].solver.nvars*size,<span class="keyword">sizeof</span>(<span class="keywordtype">double</span>));</div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;<span class="preprocessor"></span>    simobj[n].<a class="code" href="a00208.html#a523947ce4fa7128c4c767163953253b9">solver</a>.<a class="code" href="a00194.html#aeadfdde0fbc3058bace813055212dcc3">hyp</a>     = (<span class="keywordtype">double</span>*) calloc (simobj[n].solver.nvars*size,<span class="keyword">sizeof</span>(<span class="keywordtype">double</span>));</div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;    simobj[n].<a class="code" href="a00208.html#a523947ce4fa7128c4c767163953253b9">solver</a>.<a class="code" href="a00194.html#ae53517ad7a202762d7b79eaf681701f3">par</a>     = (<span class="keywordtype">double</span>*) calloc (simobj[n].solver.nvars*size,<span class="keyword">sizeof</span>(<span class="keywordtype">double</span>));</div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;    simobj[n].<a class="code" href="a00208.html#a523947ce4fa7128c4c767163953253b9">solver</a>.<a class="code" href="a00194.html#a6b4951ffdbd82f3a3848b82352d389d6">source</a>  = (<span class="keywordtype">double</span>*) calloc (simobj[n].solver.nvars*size,<span class="keyword">sizeof</span>(<span class="keywordtype">double</span>));</div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;    simobj[n].<a class="code" href="a00208.html#a523947ce4fa7128c4c767163953253b9">solver</a>.<a class="code" href="a00194.html#a267ef7e03dbe9dd4440dee2fdf48619a">iblank</a>  = (<span class="keywordtype">double</span>*) calloc (size              ,<span class="keyword">sizeof</span>(<span class="keywordtype">double</span>));</div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;    <span class="comment">/* grid */</span></div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;    size = 0;</div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;    <span class="keywordflow">for</span> (i=0; i&lt;simobj[n].<a class="code" href="a00208.html#a523947ce4fa7128c4c767163953253b9">solver</a>.<a class="code" href="a00194.html#a484873c74138512e41bc50d17b7d955a">ndims</a>; i++) size += (simobj[n].solver.dim_local[i]+2*simobj[n].<a class="code" href="a00208.html#a523947ce4fa7128c4c767163953253b9">solver</a>.<a class="code" href="a00194.html#aafc992b5fa79d5a4036024615d03bce6">ghosts</a>);</div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;    simobj[n].<a class="code" href="a00208.html#a523947ce4fa7128c4c767163953253b9">solver</a>.<a class="code" href="a00194.html#a711aad4cbe735871dd9e91ab575c878b">x</a>     = (<span class="keywordtype">double</span>*) calloc (size,<span class="keyword">sizeof</span>(<span class="keywordtype">double</span>));</div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;    simobj[n].<a class="code" href="a00208.html#a523947ce4fa7128c4c767163953253b9">solver</a>.<a class="code" href="a00194.html#aa24a4f5e29bd70cbe5a2413be1ea9682">dxinv</a> = (<span class="keywordtype">double</span>*) calloc (size,<span class="keyword">sizeof</span>(<span class="keywordtype">double</span>));</div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;    <span class="comment">/* arrays needed to compute fluxes */</span></div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;    size = 1;  <span class="keywordflow">for</span> (i=0; i&lt;simobj[n].<a class="code" href="a00208.html#a523947ce4fa7128c4c767163953253b9">solver</a>.<a class="code" href="a00194.html#a484873c74138512e41bc50d17b7d955a">ndims</a>; i++) size *= (simobj[n].solver.dim_local[i]+2*simobj[n].<a class="code" href="a00208.html#a523947ce4fa7128c4c767163953253b9">solver</a>.<a class="code" href="a00194.html#aafc992b5fa79d5a4036024615d03bce6">ghosts</a>);</div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;    simobj[n].<a class="code" href="a00208.html#a523947ce4fa7128c4c767163953253b9">solver</a>.<a class="code" href="a00194.html#a86221feda74097db9eb6c900ca1e6cbc">uC</a>     = (<span class="keywordtype">double</span>*) calloc (simobj[n].solver.nvars*size,<span class="keyword">sizeof</span>(<span class="keywordtype">double</span>));</div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;    simobj[n].<a class="code" href="a00208.html#a523947ce4fa7128c4c767163953253b9">solver</a>.<a class="code" href="a00194.html#aee7ff3b51db01ee6ed4038ff5311ed24">fluxC</a>  = (<span class="keywordtype">double</span>*) calloc (simobj[n].solver.nvars*size,<span class="keyword">sizeof</span>(<span class="keywordtype">double</span>));</div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;    simobj[n].<a class="code" href="a00208.html#a523947ce4fa7128c4c767163953253b9">solver</a>.<a class="code" href="a00194.html#af163100a3e0533dbf1868decd5c8201c">Deriv1</a> = (<span class="keywordtype">double</span>*) calloc (simobj[n].solver.nvars*size,<span class="keyword">sizeof</span>(<span class="keywordtype">double</span>));</div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;    simobj[n].<a class="code" href="a00208.html#a523947ce4fa7128c4c767163953253b9">solver</a>.<a class="code" href="a00194.html#a31bc6f5b337e72aa281a1ea5ad5d6832">Deriv2</a> = (<span class="keywordtype">double</span>*) calloc (simobj[n].solver.nvars*size,<span class="keyword">sizeof</span>(<span class="keywordtype">double</span>));</div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;    size = 1;  <span class="keywordflow">for</span> (i=0; i&lt;simobj[n].<a class="code" href="a00208.html#a523947ce4fa7128c4c767163953253b9">solver</a>.<a class="code" href="a00194.html#a484873c74138512e41bc50d17b7d955a">ndims</a>; i++) size *= (simobj[n].solver.dim_local[i]+1);</div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;    simobj[n].<a class="code" href="a00208.html#a523947ce4fa7128c4c767163953253b9">solver</a>.<a class="code" href="a00194.html#a983929b7b1511ff3e7800597adef6a91">fluxI</a> = (<span class="keywordtype">double</span>*) calloc (simobj[n].solver.nvars*size,<span class="keyword">sizeof</span>(<span class="keywordtype">double</span>));</div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;    simobj[n].<a class="code" href="a00208.html#a523947ce4fa7128c4c767163953253b9">solver</a>.<a class="code" href="a00194.html#a8452297a324a34268a6565583901347d">uL</a>    = (<span class="keywordtype">double</span>*) calloc (simobj[n].solver.nvars*size,<span class="keyword">sizeof</span>(<span class="keywordtype">double</span>));</div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;    simobj[n].<a class="code" href="a00208.html#a523947ce4fa7128c4c767163953253b9">solver</a>.<a class="code" href="a00194.html#a3c811b25c11d2c98bfff02ddeadeb3d9">uR</a>    = (<span class="keywordtype">double</span>*) calloc (simobj[n].solver.nvars*size,<span class="keyword">sizeof</span>(<span class="keywordtype">double</span>));</div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;    simobj[n].<a class="code" href="a00208.html#a523947ce4fa7128c4c767163953253b9">solver</a>.<a class="code" href="a00194.html#a99f72a44e29089b75fd11155bfcc1ff8">fL</a>    = (<span class="keywordtype">double</span>*) calloc (simobj[n].solver.nvars*size,<span class="keyword">sizeof</span>(<span class="keywordtype">double</span>));</div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;    simobj[n].<a class="code" href="a00208.html#a523947ce4fa7128c4c767163953253b9">solver</a>.<a class="code" href="a00194.html#abb50b7a404febaf647f7bd89f873b96e">fR</a>    = (<span class="keywordtype">double</span>*) calloc (simobj[n].solver.nvars*size,<span class="keyword">sizeof</span>(<span class="keywordtype">double</span>));</div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;    <span class="comment">/* allocate MPI send/receive buffer arrays */</span></div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;    <span class="keywordtype">int</span> bufdim[simobj[n].<a class="code" href="a00208.html#a523947ce4fa7128c4c767163953253b9">solver</a>.<a class="code" href="a00194.html#a484873c74138512e41bc50d17b7d955a">ndims</a>], maxbuf = 0;</div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;    <span class="keywordflow">for</span> (d = 0; d &lt; simobj[n].solver.ndims; d++) {</div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;      bufdim[d] = 1;</div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;      <span class="keywordflow">for</span> (i = 0; i &lt; simobj[n].solver.ndims; i++) {</div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;        <span class="keywordflow">if</span> (i == d) bufdim[d] *= simobj[n].solver.ghosts;</div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;        <span class="keywordflow">else</span>        bufdim[d] *= simobj[n].solver.dim_local[i];</div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;      }</div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;      <span class="keywordflow">if</span> (bufdim[d] &gt; maxbuf) maxbuf = bufdim[d];</div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;    }</div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;    maxbuf *= (simobj[n].solver.nvars*simobj[n].solver.ndims);</div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;    simobj[n].mpi.maxbuf  = maxbuf;</div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;    simobj[n].mpi.sendbuf = (<span class="keywordtype">double</span>*) calloc (2*simobj[n].solver.ndims*maxbuf,<span class="keyword">sizeof</span>(<span class="keywordtype">double</span>));</div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;    simobj[n].mpi.recvbuf = (<span class="keywordtype">double</span>*) calloc (2*simobj[n].solver.ndims*maxbuf,<span class="keyword">sizeof</span>(<span class="keywordtype">double</span>));</div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;    <span class="comment">/* allocate the volume and boundary integral arrays */</span></div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;    simobj[n].solver.VolumeIntegral        = (<span class="keywordtype">double</span>*) calloc (simobj[n].solver.nvars  ,<span class="keyword">sizeof</span>(<span class="keywordtype">double</span>));</div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;    simobj[n].solver.VolumeIntegralInitial = (<span class="keywordtype">double</span>*) calloc (simobj[n].solver.nvars  ,<span class="keyword">sizeof</span>(<span class="keywordtype">double</span>));</div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;    simobj[n].solver.StageBoundaryIntegral = (<span class="keywordtype">double</span>*) calloc (2*simobj[n].solver.ndims*simobj[n].solver.nvars,<span class="keyword">sizeof</span>(<span class="keywordtype">double</span>));</div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;    simobj[n].solver.StepBoundaryIntegral  = (<span class="keywordtype">double</span>*) calloc (2*simobj[n].solver.ndims*simobj[n].solver.nvars,<span class="keyword">sizeof</span>(<span class="keywordtype">double</span>));</div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;    simobj[n].solver.TotalBoundaryIntegral = (<span class="keywordtype">double</span>*) calloc (simobj[n].solver.nvars,<span class="keyword">sizeof</span>(<span class="keywordtype">double</span>));</div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;    simobj[n].solver.ConservationError     = (<span class="keywordtype">double</span>*) calloc (simobj[n].solver.nvars,<span class="keyword">sizeof</span>(<span class="keywordtype">double</span>));</div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;    <span class="keywordflow">for</span> (i=0; i&lt;simobj[n].solver.nvars; i++) simobj[n].solver.ConservationError[i] = -1;</div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;</div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;    <span class="comment">/* initialize function call counts to zero */</span></div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;    simobj[n].solver.count_hyp </div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;      = simobj[n].solver.count_par </div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;      = simobj[n].solver.count_sou </div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;      = 0;</div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;#ifdef with_petsc</div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;    simobj[n].solver.count_RHSFunction </div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;      = simobj[n].solver.count_IFunction</div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;      = simobj[n].solver.count_IJacobian </div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;      = simobj[n].solver.count_IJacFunction </div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;      = 0;</div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;#endif</div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;</div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;    <span class="comment">/* Initialize iblank to 1*/</span></div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;    <a class="code" href="a00217.html#a2b2826031c0cd92495ab351d3e599fc5">_ArraySetValue_</a>(simobj[n].solver.iblank,simobj[n].solver.npoints_local_wghosts,1);</div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;</div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;  }</div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;</div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;  <span class="keywordflow">return</span>(0);</div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;}</div>
<div class="ttc" id="a00194_html_ae53517ad7a202762d7b79eaf681701f3"><div class="ttname"><a href="a00194.html#ae53517ad7a202762d7b79eaf681701f3">HyPar::par</a></div><div class="ttdeci">double * par</div><div class="ttdef"><b>Definition:</b> <a href="a00224_source.html#l00114">hypar.h:114</a></div></div>
<div class="ttc" id="a00194_html_af163100a3e0533dbf1868decd5c8201c"><div class="ttname"><a href="a00194.html#af163100a3e0533dbf1868decd5c8201c">HyPar::Deriv1</a></div><div class="ttdeci">double * Deriv1</div><div class="ttdef"><b>Definition:</b> <a href="a00224_source.html#l00143">hypar.h:143</a></div></div>
<div class="ttc" id="a00197_html_a6cfd95afd0afebd625b889fb6e58371c"><div class="ttname"><a href="a00197.html#a6cfd95afd0afebd625b889fb6e58371c">MPIVariables::rank</a></div><div class="ttdeci">int rank</div><div class="ttdef"><b>Definition:</b> <a href="a00197_source.html#l00025">mpivars_struct.h:25</a></div></div>
<div class="ttc" id="a00194_html_a267ef7e03dbe9dd4440dee2fdf48619a"><div class="ttname"><a href="a00194.html#a267ef7e03dbe9dd4440dee2fdf48619a">HyPar::iblank</a></div><div class="ttdeci">double * iblank</div><div class="ttdef"><b>Definition:</b> <a href="a00224_source.html#l00412">hypar.h:412</a></div></div>
<div class="ttc" id="a00208_html_a4afd2c7b3eb8fda452474ebdbe71c8c0"><div class="ttname"><a href="a00208.html#a4afd2c7b3eb8fda452474ebdbe71c8c0">SimulationObject::mpi</a></div><div class="ttdeci">MPIVariables mpi</div><div class="ttdef"><b>Definition:</b> <a href="a00208_source.html#l00025">simulation_object.h:25</a></div></div>
<div class="ttc" id="a00194_html_aa24a4f5e29bd70cbe5a2413be1ea9682"><div class="ttname"><a href="a00194.html#aa24a4f5e29bd70cbe5a2413be1ea9682">HyPar::dxinv</a></div><div class="ttdeci">double * dxinv</div><div class="ttdef"><b>Definition:</b> <a href="a00224_source.html#l00102">hypar.h:102</a></div></div>
<div class="ttc" id="a00234_html_af8194ca5a460534fdbe391035a95c69d"><div class="ttname"><a href="a00234.html#af8194ca5a460534fdbe391035a95c69d">MPIPartition1D</a></div><div class="ttdeci">int MPIPartition1D(int, int, int)</div><div class="ttdef"><b>Definition:</b> <a href="a00368_source.html#l00014">MPIPartition1D.c:14</a></div></div>
<div class="ttc" id="a00194_html_aac11b2a653ffaeac4b35057431f1b981"><div class="ttname"><a href="a00194.html#aac11b2a653ffaeac4b35057431f1b981">HyPar::u_rom_predicted</a></div><div class="ttdeci">double * u_rom_predicted</div><div class="ttdef"><b>Definition:</b> <a href="a00224_source.html#l00379">hypar.h:379</a></div></div>
<div class="ttc" id="a00197_html_aa3c28612a64b8a97bde66b720e15c700"><div class="ttname"><a href="a00197.html#aa3c28612a64b8a97bde66b720e15c700">MPIVariables::ip</a></div><div class="ttdeci">int * ip</div><div class="ttdef"><b>Definition:</b> <a href="a00197_source.html#l00028">mpivars_struct.h:28</a></div></div>
<div class="ttc" id="a00218_html_ad6ab74942c9de13cf0b4c12eb0d91780"><div class="ttname"><a href="a00218.html#ad6ab74942c9de13cf0b4c12eb0d91780">IERR</a></div><div class="ttdeci">#define IERR</div><div class="ttdef"><b>Definition:</b> <a href="a00218_source.html#l00012">basic.h:12</a></div></div>
<div class="ttc" id="a00194_html_ade4650485fe35fd3e12fea272fc80209"><div class="ttname"><a href="a00194.html#ade4650485fe35fd3e12fea272fc80209">HyPar::rhs</a></div><div class="ttdeci">double * rhs</div><div class="ttdef"><b>Definition:</b> <a href="a00224_source.html#l00375">hypar.h:375</a></div></div>
<div class="ttc" id="a00194_html_aa989ebb755986852177779cdf7bd8c85"><div class="ttname"><a href="a00194.html#aa989ebb755986852177779cdf7bd8c85">HyPar::dim_global</a></div><div class="ttdeci">int * dim_global</div><div class="ttdef"><b>Definition:</b> <a href="a00224_source.html#l00032">hypar.h:32</a></div></div>
<div class="ttc" id="a00208_html_a00626"><div class="ttname"><a href="a00208.html#a00626">SimulationObject</a></div><div class="ttdoc">Structure defining a simulation. </div><div class="ttdef"><b>Definition:</b> <a href="a00208_source.html#l00023">simulation_object.h:23</a></div></div>
<div class="ttc" id="a00234_html_ade449de8860c4b1060ca15bf7a80476f"><div class="ttname"><a href="a00234.html#ade449de8860c4b1060ca15bf7a80476f">MPICreateCommunicators</a></div><div class="ttdeci">int MPICreateCommunicators(int, void *)</div><div class="ttdef"><b>Definition:</b> <a href="a00357_source.html#l00035">MPICommunicators.c:35</a></div></div>
<div class="ttc" id="a00194_html_a8452297a324a34268a6565583901347d"><div class="ttname"><a href="a00194.html#a8452297a324a34268a6565583901347d">HyPar::uL</a></div><div class="ttdeci">double * uL</div><div class="ttdef"><b>Definition:</b> <a href="a00224_source.html#l00131">hypar.h:131</a></div></div>
<div class="ttc" id="a00194_html_afae6319baba315ac1f0c56505610ed85"><div class="ttname"><a href="a00194.html#afae6319baba315ac1f0c56505610ed85">HyPar::npoints_local</a></div><div class="ttdeci">int npoints_local</div><div class="ttdef"><b>Definition:</b> <a href="a00224_source.html#l00040">hypar.h:40</a></div></div>
<div class="ttc" id="a00194_html_a86221feda74097db9eb6c900ca1e6cbc"><div class="ttname"><a href="a00194.html#a86221feda74097db9eb6c900ca1e6cbc">HyPar::uC</a></div><div class="ttdeci">double * uC</div><div class="ttdef"><b>Definition:</b> <a href="a00224_source.html#l00123">hypar.h:123</a></div></div>
<div class="ttc" id="a00194_html_a983929b7b1511ff3e7800597adef6a91"><div class="ttname"><a href="a00194.html#a983929b7b1511ff3e7800597adef6a91">HyPar::fluxI</a></div><div class="ttdeci">double * fluxI</div><div class="ttdef"><b>Definition:</b> <a href="a00224_source.html#l00128">hypar.h:128</a></div></div>
<div class="ttc" id="a00194_html_a3c811b25c11d2c98bfff02ddeadeb3d9"><div class="ttname"><a href="a00194.html#a3c811b25c11d2c98bfff02ddeadeb3d9">HyPar::uR</a></div><div class="ttdeci">double * uR</div><div class="ttdef"><b>Definition:</b> <a href="a00224_source.html#l00131">hypar.h:131</a></div></div>
<div class="ttc" id="a00218_html_a68f50121fb9a7daeaf60e50cdef82ef3"><div class="ttname"><a href="a00218.html#a68f50121fb9a7daeaf60e50cdef82ef3">_DECLARE_IERR_</a></div><div class="ttdeci">#define _DECLARE_IERR_</div><div class="ttdef"><b>Definition:</b> <a href="a00218_source.html#l00013">basic.h:13</a></div></div>
<div class="ttc" id="a00194_html_a3ccc9ddb96600c40dcc41bb1ded11160"><div class="ttname"><a href="a00194.html#a3ccc9ddb96600c40dcc41bb1ded11160">HyPar::uref</a></div><div class="ttdeci">double * uref</div><div class="ttdef"><b>Definition:</b> <a href="a00224_source.html#l00373">hypar.h:373</a></div></div>
<div class="ttc" id="a00194_html_a20ee1fd00a220b98513127884a5558cf"><div class="ttname"><a href="a00194.html#a20ee1fd00a220b98513127884a5558cf">HyPar::npoints_local_wghosts</a></div><div class="ttdeci">int npoints_local_wghosts</div><div class="ttdef"><b>Definition:</b> <a href="a00224_source.html#l00040">hypar.h:40</a></div></div>
<div class="ttc" id="a00194_html_a95e9e0f8a692321b83a2e0ce2789c485"><div class="ttname"><a href="a00194.html#a95e9e0f8a692321b83a2e0ce2789c485">HyPar::index</a></div><div class="ttdeci">int * index</div><div class="ttdef"><b>Definition:</b> <a href="a00224_source.html#l00094">hypar.h:94</a></div></div>
<div class="ttc" id="a00194_html_a4e67f54563a3c4ff005dfaf0130f957c"><div class="ttname"><a href="a00194.html#a4e67f54563a3c4ff005dfaf0130f957c">HyPar::npoints_global</a></div><div class="ttdeci">int npoints_global</div><div class="ttdef"><b>Definition:</b> <a href="a00224_source.html#l00038">hypar.h:38</a></div></div>
<div class="ttc" id="a00194_html_aeadfdde0fbc3058bace813055212dcc3"><div class="ttname"><a href="a00194.html#aeadfdde0fbc3058bace813055212dcc3">HyPar::hyp</a></div><div class="ttdeci">double * hyp</div><div class="ttdef"><b>Definition:</b> <a href="a00224_source.html#l00111">hypar.h:111</a></div></div>
<div class="ttc" id="a00194_html_a3b6b999a764f1e2ea94bb5f28c7a558c"><div class="ttname"><a href="a00194.html#a3b6b999a764f1e2ea94bb5f28c7a558c">HyPar::u</a></div><div class="ttdeci">double * u</div><div class="ttdef"><b>Definition:</b> <a href="a00224_source.html#l00108">hypar.h:108</a></div></div>
<div class="ttc" id="a00194_html_aee7ff3b51db01ee6ed4038ff5311ed24"><div class="ttname"><a href="a00194.html#aee7ff3b51db01ee6ed4038ff5311ed24">HyPar::fluxC</a></div><div class="ttdeci">double * fluxC</div><div class="ttdef"><b>Definition:</b> <a href="a00224_source.html#l00120">hypar.h:120</a></div></div>
<div class="ttc" id="a00194_html_aafc992b5fa79d5a4036024615d03bce6"><div class="ttname"><a href="a00194.html#aafc992b5fa79d5a4036024615d03bce6">HyPar::ghosts</a></div><div class="ttdeci">int ghosts</div><div class="ttdef"><b>Definition:</b> <a href="a00224_source.html#l00044">hypar.h:44</a></div></div>
<div class="ttc" id="a00208_html_a23988a34071e1a0f0de820a4043a1fc8"><div class="ttname"><a href="a00208.html#a23988a34071e1a0f0de820a4043a1fc8">SimulationObject::is_barebones</a></div><div class="ttdeci">int is_barebones</div><div class="ttdef"><b>Definition:</b> <a href="a00208_source.html#l00027">simulation_object.h:27</a></div></div>
<div class="ttc" id="a00194_html_a40e3f67b1530d5ea4e913fc60b594802"><div class="ttname"><a href="a00194.html#a40e3f67b1530d5ea4e913fc60b594802">HyPar::isPeriodic</a></div><div class="ttdeci">int * isPeriodic</div><div class="ttdef"><b>Definition:</b> <a href="a00224_source.html#l00154">hypar.h:154</a></div></div>
<div class="ttc" id="a00234_html_a9a3fc32b7d4bea6a1dac44ab21c9202e"><div class="ttname"><a href="a00234.html#a9a3fc32b7d4bea6a1dac44ab21c9202e">MPILocalDomainLimits</a></div><div class="ttdeci">int MPILocalDomainLimits(int, int, void *, int *, int *, int *)</div><div class="ttdef"><b>Definition:</b> <a href="a00365_source.html#l00018">MPILocalDomainLimits.c:18</a></div></div>
<div class="ttc" id="a00194_html_acab4b9b417d6c3745ad789099d3731c6"><div class="ttname"><a href="a00194.html#acab4b9b417d6c3745ad789099d3731c6">HyPar::u0</a></div><div class="ttdeci">double * u0</div><div class="ttdef"><b>Definition:</b> <a href="a00224_source.html#l00372">hypar.h:372</a></div></div>
<div class="ttc" id="a00218_html_add9cf96ae374934d245a1dc1ab697a42"><div class="ttname"><a href="a00218.html#add9cf96ae374934d245a1dc1ab697a42">CHECKERR</a></div><div class="ttdeci">#define CHECKERR(ierr)</div><div class="ttdef"><b>Definition:</b> <a href="a00218_source.html#l00014">basic.h:14</a></div></div>
<div class="ttc" id="a00234_html_afe59a0480bb81cc0d7877ba547b3e28c"><div class="ttname"><a href="a00234.html#afe59a0480bb81cc0d7877ba547b3e28c">MPIRanknD</a></div><div class="ttdeci">int MPIRanknD(int, int, int *, int *)</div><div class="ttdef"><b>Definition:</b> <a href="a00372_source.html#l00027">MPIRanknD.c:27</a></div></div>
<div class="ttc" id="a00217_html_a2b2826031c0cd92495ab351d3e599fc5"><div class="ttname"><a href="a00217.html#a2b2826031c0cd92495ab351d3e599fc5">_ArraySetValue_</a></div><div class="ttdeci">#define _ArraySetValue_(x, size, value)</div><div class="ttdef"><b>Definition:</b> <a href="a00217_source.html#l00168">arrayfunctions.h:168</a></div></div>
<div class="ttc" id="a00208_html_a523947ce4fa7128c4c767163953253b9"><div class="ttname"><a href="a00208.html#a523947ce4fa7128c4c767163953253b9">SimulationObject::solver</a></div><div class="ttdeci">HyPar solver</div><div class="ttdef"><b>Definition:</b> <a href="a00208_source.html#l00026">simulation_object.h:26</a></div></div>
<div class="ttc" id="a00194_html_a6b4951ffdbd82f3a3848b82352d389d6"><div class="ttname"><a href="a00194.html#a6b4951ffdbd82f3a3848b82352d389d6">HyPar::source</a></div><div class="ttdeci">double * source</div><div class="ttdef"><b>Definition:</b> <a href="a00224_source.html#l00117">hypar.h:117</a></div></div>
<div class="ttc" id="a00234_html_a87419c70e96bbafe1e63821ba1d2e975"><div class="ttname"><a href="a00234.html#a87419c70e96bbafe1e63821ba1d2e975">MPICreateIOGroups</a></div><div class="ttdeci">int MPICreateIOGroups(void *)</div><div class="ttdef"><b>Definition:</b> <a href="a00364_source.html#l00037">MPIIOGroups.c:37</a></div></div>
<div class="ttc" id="a00194_html_a39dc7def53a36bdc722aa90f52e04561"><div class="ttname"><a href="a00194.html#a39dc7def53a36bdc722aa90f52e04561">HyPar::stride_with_ghosts</a></div><div class="ttdeci">int * stride_with_ghosts</div><div class="ttdef"><b>Definition:</b> <a href="a00224_source.html#l00390">hypar.h:390</a></div></div>
<div class="ttc" id="a00197_html_af40a5a3066fdb53a47e4627071abc2bc"><div class="ttname"><a href="a00197.html#af40a5a3066fdb53a47e4627071abc2bc">MPIVariables::bcperiodic</a></div><div class="ttdeci">int * bcperiodic</div><div class="ttdef"><b>Definition:</b> <a href="a00197_source.html#l00031">mpivars_struct.h:31</a></div></div>
<div class="ttc" id="a00197_html_a7602de5ebb1b59ec35217e78a35a531e"><div class="ttname"><a href="a00197.html#a7602de5ebb1b59ec35217e78a35a531e">MPIVariables::ie</a></div><div class="ttdeci">int * ie</div><div class="ttdef"><b>Definition:</b> <a href="a00197_source.html#l00029">mpivars_struct.h:29</a></div></div>
<div class="ttc" id="a00194_html_a711aad4cbe735871dd9e91ab575c878b"><div class="ttname"><a href="a00194.html#a711aad4cbe735871dd9e91ab575c878b">HyPar::x</a></div><div class="ttdeci">double * x</div><div class="ttdef"><b>Definition:</b> <a href="a00224_source.html#l00099">hypar.h:99</a></div></div>
<div class="ttc" id="a00194_html_ad587a58397d439c443ae325450a01a13"><div class="ttname"><a href="a00194.html#ad587a58397d439c443ae325450a01a13">HyPar::rhsref</a></div><div class="ttdeci">double * rhsref</div><div class="ttdef"><b>Definition:</b> <a href="a00224_source.html#l00374">hypar.h:374</a></div></div>
<div class="ttc" id="a00197_html_a0be0f30a83bc3f3d9f6ee3a36bbf2716"><div class="ttname"><a href="a00197.html#a0be0f30a83bc3f3d9f6ee3a36bbf2716">MPIVariables::iproc</a></div><div class="ttdeci">int * iproc</div><div class="ttdef"><b>Definition:</b> <a href="a00197_source.html#l00027">mpivars_struct.h:27</a></div></div>
<div class="ttc" id="a00194_html_a31bc6f5b337e72aa281a1ea5ad5d6832"><div class="ttname"><a href="a00194.html#a31bc6f5b337e72aa281a1ea5ad5d6832">HyPar::Deriv2</a></div><div class="ttdeci">double * Deriv2</div><div class="ttdef"><b>Definition:</b> <a href="a00224_source.html#l00143">hypar.h:143</a></div></div>
<div class="ttc" id="a00197_html_a481013ba007a99a4237cde5eeb3c9a29"><div class="ttname"><a href="a00197.html#a481013ba007a99a4237cde5eeb3c9a29">MPIVariables::is</a></div><div class="ttdeci">int * is</div><div class="ttdef"><b>Definition:</b> <a href="a00197_source.html#l00029">mpivars_struct.h:29</a></div></div>
<div class="ttc" id="a00194_html_a484873c74138512e41bc50d17b7d955a"><div class="ttname"><a href="a00194.html#a484873c74138512e41bc50d17b7d955a">HyPar::ndims</a></div><div class="ttdeci">int ndims</div><div class="ttdef"><b>Definition:</b> <a href="a00224_source.html#l00026">hypar.h:26</a></div></div>
<div class="ttc" id="a00194_html_abb50b7a404febaf647f7bd89f873b96e"><div class="ttname"><a href="a00194.html#abb50b7a404febaf647f7bd89f873b96e">HyPar::fR</a></div><div class="ttdeci">double * fR</div><div class="ttdef"><b>Definition:</b> <a href="a00224_source.html#l00131">hypar.h:131</a></div></div>
<div class="ttc" id="a00194_html_a38e0371f331cecbe63a77fa03e202afe"><div class="ttname"><a href="a00194.html#a38e0371f331cecbe63a77fa03e202afe">HyPar::dim_local</a></div><div class="ttdeci">int * dim_local</div><div class="ttdef"><b>Definition:</b> <a href="a00224_source.html#l00035">hypar.h:35</a></div></div>
<div class="ttc" id="a00194_html_a99f72a44e29089b75fd11155bfcc1ff8"><div class="ttname"><a href="a00194.html#a99f72a44e29089b75fd11155bfcc1ff8">HyPar::fL</a></div><div class="ttdeci">double * fL</div><div class="ttdef"><b>Definition:</b> <a href="a00224_source.html#l00131">hypar.h:131</a></div></div>
<div class="ttc" id="a00194_html_a98bbff775d127bdd2451b55ce3d06e06"><div class="ttname"><a href="a00194.html#a98bbff775d127bdd2451b55ce3d06e06">HyPar::stride_without_ghosts</a></div><div class="ttdeci">int * stride_without_ghosts</div><div class="ttdef"><b>Definition:</b> <a href="a00224_source.html#l00392">hypar.h:392</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a23523232e5e6dd7cdec11754be4c21aa"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int InitialSolution </td>
          <td>(</td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>s</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>nsims</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Read the initial solution</p>
<p>Read in initial solution from file, and compute grid spacing and volume integral of the initial solution </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">s</td><td>Array of simulation objects of type <a class="el" href="a00208.html#a00626" title="Structure defining a simulation. ">SimulationObject</a> </td></tr>
    <tr><td class="paramname">nsims</td><td>Number of simulation objects </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="a00558_source.html#l00021">21</a> of file <a class="el" href="a00558_source.html">InitialSolution.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;{</div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;  <a class="code" href="a00208.html#a00626">SimulationObject</a>* simobj = (<a class="code" href="a00208.html#a00626">SimulationObject</a>*) s;</div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;  <span class="keywordtype">int</span> n, flag, d, i, offset, ierr;</div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;</div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;  <span class="keywordflow">for</span> (n = 0; n &lt; nsims; n++) {</div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;</div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;    <span class="keywordtype">int</span> ghosts = simobj[n].<a class="code" href="a00208.html#a523947ce4fa7128c4c767163953253b9">solver</a>.<a class="code" href="a00194.html#aafc992b5fa79d5a4036024615d03bce6">ghosts</a>;</div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;</div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;    <span class="keywordtype">char</span> fname_root[<a class="code" href="a00218.html#a51efea86a4d76d1259893f606b776573">_MAX_STRING_SIZE_</a>] = <span class="stringliteral">&quot;initial&quot;</span>;</div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;    <span class="keywordflow">if</span> (nsims &gt; 1) {</div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;      <span class="keywordtype">char</span> index[<a class="code" href="a00218.html#a51efea86a4d76d1259893f606b776573">_MAX_STRING_SIZE_</a>];</div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;      <a class="code" href="a00220.html#a3e3ad5aed581d9ae563190c365dadc41">GetStringFromInteger</a>(n, index, (<span class="keywordtype">int</span>)log10(nsims)+1);</div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;      strcat(fname_root, <span class="stringliteral">&quot;_&quot;</span>);</div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;      strcat(fname_root, index);</div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;    }</div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;</div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;    ierr = <a class="code" href="a00225.html#afaf5b0d6e79b1e8674b397aebcb219dc">ReadArray</a>( simobj[n].solver.ndims,</div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;                      simobj[n].<a class="code" href="a00208.html#a523947ce4fa7128c4c767163953253b9">solver</a>.<a class="code" href="a00194.html#ae8f6d2fd6490d3153cb4133bf183a404">nvars</a>,</div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;                      simobj[n].<a class="code" href="a00208.html#a523947ce4fa7128c4c767163953253b9">solver</a>.<a class="code" href="a00194.html#aa989ebb755986852177779cdf7bd8c85">dim_global</a>,</div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;                      simobj[n].<a class="code" href="a00208.html#a523947ce4fa7128c4c767163953253b9">solver</a>.<a class="code" href="a00194.html#a38e0371f331cecbe63a77fa03e202afe">dim_local</a>,</div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;                      simobj[n].<a class="code" href="a00208.html#a523947ce4fa7128c4c767163953253b9">solver</a>.<a class="code" href="a00194.html#aafc992b5fa79d5a4036024615d03bce6">ghosts</a>,</div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;                      &amp;(simobj[n].<a class="code" href="a00208.html#a523947ce4fa7128c4c767163953253b9">solver</a>),</div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;                      &amp;(simobj[n].<a class="code" href="a00208.html#a4afd2c7b3eb8fda452474ebdbe71c8c0">mpi</a>),</div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;                      simobj[n].<a class="code" href="a00208.html#a523947ce4fa7128c4c767163953253b9">solver</a>.<a class="code" href="a00194.html#a711aad4cbe735871dd9e91ab575c878b">x</a>,</div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;                      simobj[n].<a class="code" href="a00208.html#a523947ce4fa7128c4c767163953253b9">solver</a>.<a class="code" href="a00194.html#a3b6b999a764f1e2ea94bb5f28c7a558c">u</a>,</div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;                      fname_root,</div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;                      &amp;flag );</div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;    <span class="keywordflow">if</span> (ierr) {</div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;      fprintf(stderr, <span class="stringliteral">&quot;Error in InitialSolution() on rank %d.\n&quot;</span>,</div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;              simobj[n].mpi.rank);</div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;      <span class="keywordflow">return</span> ierr;</div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;    }</div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;    <span class="keywordflow">if</span> (!flag) {</div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;      fprintf(stderr,<span class="stringliteral">&quot;Error: initial solution file not found.\n&quot;</span>);</div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;      <span class="keywordflow">return</span>(1);</div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;    }</div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;    <a class="code" href="a00218.html#add9cf96ae374934d245a1dc1ab697a42">CHECKERR</a>(ierr);</div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;</div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;    <span class="comment">/* exchange MPI-boundary values of u between processors */</span></div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;    <a class="code" href="a00234.html#a60ace5964c051fa481e6a1e6f1ef75d7">MPIExchangeBoundariesnD</a>(  simobj[n].solver.ndims,</div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;                              simobj[n].<a class="code" href="a00208.html#a523947ce4fa7128c4c767163953253b9">solver</a>.<a class="code" href="a00194.html#ae8f6d2fd6490d3153cb4133bf183a404">nvars</a>,</div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;                              simobj[n].<a class="code" href="a00208.html#a523947ce4fa7128c4c767163953253b9">solver</a>.<a class="code" href="a00194.html#a38e0371f331cecbe63a77fa03e202afe">dim_local</a>,</div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;                              simobj[n].<a class="code" href="a00208.html#a523947ce4fa7128c4c767163953253b9">solver</a>.<a class="code" href="a00194.html#aafc992b5fa79d5a4036024615d03bce6">ghosts</a>,</div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;                              &amp;(simobj[n].<a class="code" href="a00208.html#a4afd2c7b3eb8fda452474ebdbe71c8c0">mpi</a>),</div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;                              simobj[n].<a class="code" href="a00208.html#a523947ce4fa7128c4c767163953253b9">solver</a>.<a class="code" href="a00194.html#a3b6b999a764f1e2ea94bb5f28c7a558c">u</a>  );</div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;</div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;    <span class="comment">/* calculate dxinv */</span></div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;    offset = 0;</div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;    <span class="keywordflow">for</span> (d = 0; d &lt; simobj[n].<a class="code" href="a00208.html#a523947ce4fa7128c4c767163953253b9">solver</a>.<a class="code" href="a00194.html#a484873c74138512e41bc50d17b7d955a">ndims</a>; d++) {</div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;      <span class="keywordflow">for</span> (i = 0; i &lt; simobj[n].<a class="code" href="a00208.html#a523947ce4fa7128c4c767163953253b9">solver</a>.<a class="code" href="a00194.html#a38e0371f331cecbe63a77fa03e202afe">dim_local</a>[d]; i++) {</div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;        simobj[n].<a class="code" href="a00208.html#a523947ce4fa7128c4c767163953253b9">solver</a>.<a class="code" href="a00194.html#aa24a4f5e29bd70cbe5a2413be1ea9682">dxinv</a>[i+offset+ghosts] </div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;          = 2.0 / (simobj[n].<a class="code" href="a00208.html#a523947ce4fa7128c4c767163953253b9">solver</a>.<a class="code" href="a00194.html#a711aad4cbe735871dd9e91ab575c878b">x</a>[i+1+offset+ghosts]-simobj[n].<a class="code" href="a00208.html#a523947ce4fa7128c4c767163953253b9">solver</a>.<a class="code" href="a00194.html#a711aad4cbe735871dd9e91ab575c878b">x</a>[i-1+offset+ghosts]);</div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;      }</div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;      offset += (simobj[n].<a class="code" href="a00208.html#a523947ce4fa7128c4c767163953253b9">solver</a>.<a class="code" href="a00194.html#a38e0371f331cecbe63a77fa03e202afe">dim_local</a>[d] + 2*ghosts);</div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;    }</div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;</div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;    <span class="comment">/* exchange MPI-boundary values of dxinv between processors */</span></div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;    offset = 0;</div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;    <span class="keywordflow">for</span> (d = 0; d &lt; simobj[n].<a class="code" href="a00208.html#a523947ce4fa7128c4c767163953253b9">solver</a>.<a class="code" href="a00194.html#a484873c74138512e41bc50d17b7d955a">ndims</a>; d++) {</div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;      ierr = <a class="code" href="a00234.html#ac2f0cce702a9ce439753286ce227c7a2">MPIExchangeBoundaries1D</a>( &amp;(simobj[n].mpi),</div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;                                      &amp;(simobj[n].solver.dxinv[offset]),</div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;                                      simobj[n].<a class="code" href="a00208.html#a523947ce4fa7128c4c767163953253b9">solver</a>.<a class="code" href="a00194.html#a38e0371f331cecbe63a77fa03e202afe">dim_local</a>[d],</div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;                                      ghosts,</div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;                                      d,</div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;                                      simobj[n].<a class="code" href="a00208.html#a523947ce4fa7128c4c767163953253b9">solver</a>.<a class="code" href="a00194.html#a484873c74138512e41bc50d17b7d955a">ndims</a> ); <a class="code" href="a00218.html#add9cf96ae374934d245a1dc1ab697a42">CHECKERR</a>(ierr);</div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;      <span class="keywordflow">if</span> (ierr) {</div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;        fprintf(stderr, <span class="stringliteral">&quot;Error in InitialSolution() on rank %d.\n&quot;</span>,</div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;                simobj[n].mpi.rank);</div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;        <span class="keywordflow">return</span> ierr;</div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;      }</div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;      offset += (simobj[n].<a class="code" href="a00208.html#a523947ce4fa7128c4c767163953253b9">solver</a>.<a class="code" href="a00194.html#a38e0371f331cecbe63a77fa03e202afe">dim_local</a>[d] + 2*ghosts);</div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;    }</div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;</div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;    <span class="comment">/* fill in ghost values of dxinv at physical boundaries by extrapolation */</span></div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;    offset = 0;</div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;    <span class="keywordflow">for</span> (d = 0; d &lt; simobj[n].<a class="code" href="a00208.html#a523947ce4fa7128c4c767163953253b9">solver</a>.<a class="code" href="a00194.html#a484873c74138512e41bc50d17b7d955a">ndims</a>; d++) {</div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;      <span class="keywordtype">double</span> *dxinv = &amp;(simobj[n].<a class="code" href="a00208.html#a523947ce4fa7128c4c767163953253b9">solver</a>.<a class="code" href="a00194.html#aa24a4f5e29bd70cbe5a2413be1ea9682">dxinv</a>[offset]);</div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;      <span class="keywordtype">int</span>    *dim = simobj[n].<a class="code" href="a00208.html#a523947ce4fa7128c4c767163953253b9">solver</a>.<a class="code" href="a00194.html#a38e0371f331cecbe63a77fa03e202afe">dim_local</a>;</div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;      <span class="keywordflow">if</span> (simobj[n].mpi.ip[d] == 0) {</div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;        <span class="comment">/* fill left boundary along this dimension */</span></div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;        <span class="keywordflow">for</span> (i = 0; i &lt; ghosts; i++) dxinv[i] = dxinv[ghosts];</div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;      }</div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;      <span class="keywordflow">if</span> (simobj[n].mpi.ip[d] == simobj[n].<a class="code" href="a00208.html#a4afd2c7b3eb8fda452474ebdbe71c8c0">mpi</a>.<a class="code" href="a00197.html#a0be0f30a83bc3f3d9f6ee3a36bbf2716">iproc</a>[d]-1) {</div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;        <span class="comment">/* fill right boundary along this dimension */</span></div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;        <span class="keywordflow">for</span> (i = dim[d]+ghosts; i &lt; dim[d]+2*ghosts; i++) dxinv[i] = dxinv[dim[d]+ghosts-1];</div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;      }</div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;      offset  += (dim[d] + 2*ghosts);</div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;    }</div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;</div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;    <span class="comment">/* calculate volume integral of the initial solution */</span></div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;    ierr = <a class="code" href="a00298.html#a74a4527b7a6060acc1808d9c945b117f">VolumeIntegral</a>(  simobj[n].solver.VolumeIntegralInitial,</div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;                            simobj[n].<a class="code" href="a00208.html#a523947ce4fa7128c4c767163953253b9">solver</a>.<a class="code" href="a00194.html#a3b6b999a764f1e2ea94bb5f28c7a558c">u</a>,</div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;                            &amp;(simobj[n].<a class="code" href="a00208.html#a523947ce4fa7128c4c767163953253b9">solver</a>),</div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;                            &amp;(simobj[n].<a class="code" href="a00208.html#a4afd2c7b3eb8fda452474ebdbe71c8c0">mpi</a>) ); <a class="code" href="a00218.html#add9cf96ae374934d245a1dc1ab697a42">CHECKERR</a>(ierr);</div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;    <span class="keywordflow">if</span> (ierr) {</div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;      fprintf(stderr, <span class="stringliteral">&quot;Error in InitialSolution() on rank %d.\n&quot;</span>,</div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;              simobj[n].mpi.rank);</div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;      <span class="keywordflow">return</span> ierr;</div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;    }</div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;    <span class="keywordflow">if</span> (!simobj[n].mpi.rank) {</div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;      <span class="keywordflow">if</span> (nsims &gt; 1) printf(<span class="stringliteral">&quot;Volume integral of the initial solution on domain %d:\n&quot;</span>, n);</div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;      <span class="keywordflow">else</span>           printf(<span class="stringliteral">&quot;Volume integral of the initial solution:\n&quot;</span>);</div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;      <span class="keywordflow">for</span> (d=0; d&lt;simobj[n].<a class="code" href="a00208.html#a523947ce4fa7128c4c767163953253b9">solver</a>.<a class="code" href="a00194.html#ae8f6d2fd6490d3153cb4133bf183a404">nvars</a>; d++) {</div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;        printf(<span class="stringliteral">&quot;%2d:  %1.16E\n&quot;</span>,d,simobj[n].solver.VolumeIntegralInitial[d]);</div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;      }</div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;    }</div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;    <span class="comment">/* Set initial total boundary flux integral to zero */</span></div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;    <a class="code" href="a00217.html#a2b2826031c0cd92495ab351d3e599fc5">_ArraySetValue_</a>(simobj[n].solver.TotalBoundaryIntegral,simobj[n].<a class="code" href="a00208.html#a523947ce4fa7128c4c767163953253b9">solver</a>.<a class="code" href="a00194.html#ae8f6d2fd6490d3153cb4133bf183a404">nvars</a>,0);</div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;</div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;  }</div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;</div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;  <span class="keywordflow">return</span>(0); </div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;}</div>
<div class="ttc" id="a00208_html_a4afd2c7b3eb8fda452474ebdbe71c8c0"><div class="ttname"><a href="a00208.html#a4afd2c7b3eb8fda452474ebdbe71c8c0">SimulationObject::mpi</a></div><div class="ttdeci">MPIVariables mpi</div><div class="ttdef"><b>Definition:</b> <a href="a00208_source.html#l00025">simulation_object.h:25</a></div></div>
<div class="ttc" id="a00194_html_aa24a4f5e29bd70cbe5a2413be1ea9682"><div class="ttname"><a href="a00194.html#aa24a4f5e29bd70cbe5a2413be1ea9682">HyPar::dxinv</a></div><div class="ttdeci">double * dxinv</div><div class="ttdef"><b>Definition:</b> <a href="a00224_source.html#l00102">hypar.h:102</a></div></div>
<div class="ttc" id="a00194_html_aa989ebb755986852177779cdf7bd8c85"><div class="ttname"><a href="a00194.html#aa989ebb755986852177779cdf7bd8c85">HyPar::dim_global</a></div><div class="ttdeci">int * dim_global</div><div class="ttdef"><b>Definition:</b> <a href="a00224_source.html#l00032">hypar.h:32</a></div></div>
<div class="ttc" id="a00208_html_a00626"><div class="ttname"><a href="a00208.html#a00626">SimulationObject</a></div><div class="ttdoc">Structure defining a simulation. </div><div class="ttdef"><b>Definition:</b> <a href="a00208_source.html#l00023">simulation_object.h:23</a></div></div>
<div class="ttc" id="a00194_html_a3b6b999a764f1e2ea94bb5f28c7a558c"><div class="ttname"><a href="a00194.html#a3b6b999a764f1e2ea94bb5f28c7a558c">HyPar::u</a></div><div class="ttdeci">double * u</div><div class="ttdef"><b>Definition:</b> <a href="a00224_source.html#l00108">hypar.h:108</a></div></div>
<div class="ttc" id="a00194_html_aafc992b5fa79d5a4036024615d03bce6"><div class="ttname"><a href="a00194.html#aafc992b5fa79d5a4036024615d03bce6">HyPar::ghosts</a></div><div class="ttdeci">int ghosts</div><div class="ttdef"><b>Definition:</b> <a href="a00224_source.html#l00044">hypar.h:44</a></div></div>
<div class="ttc" id="a00234_html_a60ace5964c051fa481e6a1e6f1ef75d7"><div class="ttname"><a href="a00234.html#a60ace5964c051fa481e6a1e6f1ef75d7">MPIExchangeBoundariesnD</a></div><div class="ttdeci">int MPIExchangeBoundariesnD(int, int, int *, int, void *, double *)</div><div class="ttdef"><b>Definition:</b> <a href="a00359_source.html#l00042">MPIExchangeBoundariesnD.c:42</a></div></div>
<div class="ttc" id="a00234_html_ac2f0cce702a9ce439753286ce227c7a2"><div class="ttname"><a href="a00234.html#ac2f0cce702a9ce439753286ce227c7a2">MPIExchangeBoundaries1D</a></div><div class="ttdeci">int MPIExchangeBoundaries1D(void *, double *, int, int, int, int)</div><div class="ttdef"><b>Definition:</b> <a href="a00358_source.html#l00032">MPIExchangeBoundaries1D.c:32</a></div></div>
<div class="ttc" id="a00218_html_add9cf96ae374934d245a1dc1ab697a42"><div class="ttname"><a href="a00218.html#add9cf96ae374934d245a1dc1ab697a42">CHECKERR</a></div><div class="ttdeci">#define CHECKERR(ierr)</div><div class="ttdef"><b>Definition:</b> <a href="a00218_source.html#l00014">basic.h:14</a></div></div>
<div class="ttc" id="a00220_html_a3e3ad5aed581d9ae563190c365dadc41"><div class="ttname"><a href="a00220.html#a3e3ad5aed581d9ae563190c365dadc41">GetStringFromInteger</a></div><div class="ttdeci">void GetStringFromInteger(int, char *, int)</div><div class="ttdef"><b>Definition:</b> <a href="a00278_source.html#l00015">CommonFunctions.c:15</a></div></div>
<div class="ttc" id="a00217_html_a2b2826031c0cd92495ab351d3e599fc5"><div class="ttname"><a href="a00217.html#a2b2826031c0cd92495ab351d3e599fc5">_ArraySetValue_</a></div><div class="ttdeci">#define _ArraySetValue_(x, size, value)</div><div class="ttdef"><b>Definition:</b> <a href="a00217_source.html#l00168">arrayfunctions.h:168</a></div></div>
<div class="ttc" id="a00208_html_a523947ce4fa7128c4c767163953253b9"><div class="ttname"><a href="a00208.html#a523947ce4fa7128c4c767163953253b9">SimulationObject::solver</a></div><div class="ttdeci">HyPar solver</div><div class="ttdef"><b>Definition:</b> <a href="a00208_source.html#l00026">simulation_object.h:26</a></div></div>
<div class="ttc" id="a00194_html_ae8f6d2fd6490d3153cb4133bf183a404"><div class="ttname"><a href="a00194.html#ae8f6d2fd6490d3153cb4133bf183a404">HyPar::nvars</a></div><div class="ttdeci">int nvars</div><div class="ttdef"><b>Definition:</b> <a href="a00224_source.html#l00029">hypar.h:29</a></div></div>
<div class="ttc" id="a00298_html_a74a4527b7a6060acc1808d9c945b117f"><div class="ttname"><a href="a00298.html#a74a4527b7a6060acc1808d9c945b117f">VolumeIntegral</a></div><div class="ttdeci">int VolumeIntegral(double *VolumeIntegral, double *u, void *s, void *m)</div><div class="ttdef"><b>Definition:</b> <a href="a00298_source.html#l00014">VolumeIntegral.c:14</a></div></div>
<div class="ttc" id="a00194_html_a711aad4cbe735871dd9e91ab575c878b"><div class="ttname"><a href="a00194.html#a711aad4cbe735871dd9e91ab575c878b">HyPar::x</a></div><div class="ttdeci">double * x</div><div class="ttdef"><b>Definition:</b> <a href="a00224_source.html#l00099">hypar.h:99</a></div></div>
<div class="ttc" id="a00197_html_a0be0f30a83bc3f3d9f6ee3a36bbf2716"><div class="ttname"><a href="a00197.html#a0be0f30a83bc3f3d9f6ee3a36bbf2716">MPIVariables::iproc</a></div><div class="ttdeci">int * iproc</div><div class="ttdef"><b>Definition:</b> <a href="a00197_source.html#l00027">mpivars_struct.h:27</a></div></div>
<div class="ttc" id="a00194_html_a484873c74138512e41bc50d17b7d955a"><div class="ttname"><a href="a00194.html#a484873c74138512e41bc50d17b7d955a">HyPar::ndims</a></div><div class="ttdeci">int ndims</div><div class="ttdef"><b>Definition:</b> <a href="a00224_source.html#l00026">hypar.h:26</a></div></div>
<div class="ttc" id="a00218_html_a51efea86a4d76d1259893f606b776573"><div class="ttname"><a href="a00218.html#a51efea86a4d76d1259893f606b776573">_MAX_STRING_SIZE_</a></div><div class="ttdeci">#define _MAX_STRING_SIZE_</div><div class="ttdef"><b>Definition:</b> <a href="a00218_source.html#l00010">basic.h:10</a></div></div>
<div class="ttc" id="a00194_html_a38e0371f331cecbe63a77fa03e202afe"><div class="ttname"><a href="a00194.html#a38e0371f331cecbe63a77fa03e202afe">HyPar::dim_local</a></div><div class="ttdeci">int * dim_local</div><div class="ttdef"><b>Definition:</b> <a href="a00224_source.html#l00035">hypar.h:35</a></div></div>
<div class="ttc" id="a00225_html_afaf5b0d6e79b1e8674b397aebcb219dc"><div class="ttname"><a href="a00225.html#afaf5b0d6e79b1e8674b397aebcb219dc">ReadArray</a></div><div class="ttdeci">int ReadArray(int, int, int *, int *, int, void *, void *, double *, double *, char *, int *)</div><div class="ttdef"><b>Definition:</b> <a href="a00340_source.html#l00025">ReadArray.c:25</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a3a27bf10eed2122900356dd89b66731b"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int InitializeBoundaries </td>
          <td>(</td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>s</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>nsims</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Initialize the boundary conditions</p>
<p>This function initializes the variables and functions related to implementing the boundary conditions.</p>
<ul>
<li>Rank 0 reads in the boundary conditions file and broadcasts the information to all processors.</li>
<li>Depending on the type of boundary, additional information is read in. For example, for Dirichlet boundary, the Dirichlet value is read in.</li>
<li>Allocate and initialize arrays and variables related to implementing the boundary conditions.</li>
<li>Each rank finds out if the subdomain it owns abuts any of the boundaries specified.</li>
</ul>
<p>Note that boundary conditions are implemented as boundary objects of the type <a class="el" href="a00185.html" title="Structure containing the variables and function pointers defining a boundary. ">DomainBoundary</a>. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">s</td><td>Array of simulation objects of type <a class="el" href="a00208.html#a00626" title="Structure defining a simulation. ">SimulationObject</a> </td></tr>
    <tr><td class="paramname">nsims</td><td>number of simulation objects </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="a00553_source.html#l00032">32</a> of file <a class="el" href="a00553_source.html">InitializeBoundaries.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;{</div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;  <a class="code" href="a00208.html#a00626">SimulationObject</a> *sim = (<a class="code" href="a00208.html#a00626">SimulationObject</a>*) s;</div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;  <span class="keywordtype">int</span> ns;</div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;  <a class="code" href="a00218.html#a68f50121fb9a7daeaf60e50cdef82ef3">_DECLARE_IERR_</a>;</div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;</div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;  <span class="keywordflow">for</span> (ns = 0; ns &lt; nsims; ns++) {</div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;</div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;    <a class="code" href="a00185.html">DomainBoundary</a>  *boundary = NULL;</div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;    <a class="code" href="a00194.html">HyPar</a>           *solver   = &amp;(sim[ns].<a class="code" href="a00208.html#a523947ce4fa7128c4c767163953253b9">solver</a>);</div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;    <a class="code" href="a00197.html#a00622">MPIVariables</a>    *mpi      = &amp;(sim[ns].<a class="code" href="a00208.html#a4afd2c7b3eb8fda452474ebdbe71c8c0">mpi</a>);</div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;    <span class="keywordtype">int</span> nb, ferr;</div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;</div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;    <span class="comment">/* root process reads boundary condition file */</span></div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;    <span class="keywordflow">if</span> (!mpi-&gt;<a class="code" href="a00197.html#a6cfd95afd0afebd625b889fb6e58371c">rank</a>) {</div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;</div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;      <span class="keywordtype">char</span> filename[<a class="code" href="a00218.html#a51efea86a4d76d1259893f606b776573">_MAX_STRING_SIZE_</a>] = <span class="stringliteral">&quot;boundary&quot;</span>;</div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;      <span class="keywordtype">char</span> filename_backup[<a class="code" href="a00218.html#a51efea86a4d76d1259893f606b776573">_MAX_STRING_SIZE_</a>] = <span class="stringliteral">&quot;boundary&quot;</span>;</div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;      <span class="keywordflow">if</span> (nsims &gt; 1) {</div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;        <span class="keywordtype">char</span> index[<a class="code" href="a00218.html#a51efea86a4d76d1259893f606b776573">_MAX_STRING_SIZE_</a>];</div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;        <a class="code" href="a00220.html#a3e3ad5aed581d9ae563190c365dadc41">GetStringFromInteger</a>(ns, index, (<span class="keywordtype">int</span>)log10(nsims)+1);</div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;        strcat(filename, <span class="stringliteral">&quot;_&quot;</span>);</div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;        strcat(filename, index);</div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;      }</div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;      strcat(filename, <span class="stringliteral">&quot;.inp&quot;</span>);</div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;      strcat(filename_backup, <span class="stringliteral">&quot;.inp&quot;</span>);</div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;</div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;      FILE *in;</div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;      in = fopen(filename,<span class="stringliteral">&quot;r&quot;</span>);</div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;      <span class="keywordflow">if</span> (!in) {</div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;        in = fopen(filename_backup, <span class="stringliteral">&quot;r&quot;</span>);</div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;        <span class="keywordflow">if</span> (!in) {</div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;          fprintf(stderr,<span class="stringliteral">&quot;Error: boundary condition file %s or %s not found.\n&quot;</span>,</div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;                  filename, filename_backup );</div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;          <span class="keywordflow">return</span>(1);</div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;          <span class="keywordflow">if</span> (nsims &gt; 1) printf(<span class="stringliteral">&quot;Domain %d: &quot;</span>, ns);</div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;          printf(<span class="stringliteral">&quot;Reading boundary conditions from %s.\n&quot;</span>, filename_backup);</div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;        }</div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;      } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;        <span class="keywordflow">if</span> (nsims &gt; 1) printf(<span class="stringliteral">&quot;Domain %d: &quot;</span>, ns);</div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;        printf(<span class="stringliteral">&quot;Reading boundary conditions from %s.\n&quot;</span>, filename);</div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;      }</div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;</div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;      <span class="comment">/* read number of boundary conditions and allocate */</span></div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;      ferr = fscanf(in,<span class="stringliteral">&quot;%d&quot;</span>,&amp;solver-&gt;<a class="code" href="a00194.html#a3f9a55664d1c8f058828ae9f4de11906">nBoundaryZones</a>); <span class="keywordflow">if</span> (ferr != 1) <span class="keywordflow">return</span>(1);</div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;      boundary = (<a class="code" href="a00185.html">DomainBoundary</a>*) calloc (solver-&gt;<a class="code" href="a00194.html#a3f9a55664d1c8f058828ae9f4de11906">nBoundaryZones</a>,<span class="keyword">sizeof</span>(<a class="code" href="a00185.html">DomainBoundary</a>));</div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;      <span class="keywordflow">for</span> (nb = 0; nb &lt; solver-&gt;<a class="code" href="a00194.html#a3f9a55664d1c8f058828ae9f4de11906">nBoundaryZones</a>; nb++) {</div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;        boundary[nb].<a class="code" href="a00185.html#a6aa65431c39a8d8177f35c338ddb7a0e">DirichletValue</a> = boundary[nb].<a class="code" href="a00185.html#af7eeb4ff3f7c8bc22e0786ddbe62f16d">SpongeValue</a> </div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;                                   = boundary[nb].<a class="code" href="a00185.html#a0d0d92fab642e1d02a9de254e73a3f21">FlowVelocity</a> </div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;                                   = boundary[nb].<a class="code" href="a00185.html#a48f59fc59e6a86d0b4aad842daea9106">UnsteadyDirichletData</a></div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;                                   = NULL;</div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;        boundary[nb].<a class="code" href="a00185.html#ac3b478217419275ad063182f69cb543d">UnsteadyDirichletSize</a> = NULL;</div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;      }</div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;</div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;      <span class="comment">/* read each boundary condition */</span></div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;      <span class="keywordflow">for</span> (nb = 0; nb &lt; solver-&gt;<a class="code" href="a00194.html#a3f9a55664d1c8f058828ae9f4de11906">nBoundaryZones</a>; nb++) {</div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;        <span class="keywordtype">int</span> d, v;</div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;        boundary[nb].<a class="code" href="a00185.html#a1e51e79041d5a3dddffb503277703568">xmin</a> = (<span class="keywordtype">double</span>*) calloc (solver-&gt;<a class="code" href="a00194.html#a484873c74138512e41bc50d17b7d955a">ndims</a>,<span class="keyword">sizeof</span>(<span class="keywordtype">double</span>)); <span class="comment">/* deallocated in BCCleanup.c */</span></div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;        boundary[nb].<a class="code" href="a00185.html#a7ea24a733beddff902459a07bf91ca67">xmax</a> = (<span class="keywordtype">double</span>*) calloc (solver-&gt;<a class="code" href="a00194.html#a484873c74138512e41bc50d17b7d955a">ndims</a>,<span class="keyword">sizeof</span>(<span class="keywordtype">double</span>)); <span class="comment">/* deallocated in BCCleanup.c */</span></div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;  </div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;        ferr = fscanf(in,<span class="stringliteral">&quot;%s&quot;</span>,boundary[nb].bctype); <span class="keywordflow">if</span> (ferr != 1) <span class="keywordflow">return</span>(1);</div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;        ferr = fscanf(in,<span class="stringliteral">&quot;%d&quot;</span>,&amp;boundary[nb].dim  ); <span class="keywordflow">if</span> (ferr != 1) <span class="keywordflow">return</span>(1);</div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;        ferr = fscanf(in,<span class="stringliteral">&quot;%d&quot;</span>,&amp;boundary[nb].face ); <span class="keywordflow">if</span> (ferr != 1) <span class="keywordflow">return</span>(1);</div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;        <span class="keywordflow">for</span> (d=0; d &lt; solver-&gt;<a class="code" href="a00194.html#a484873c74138512e41bc50d17b7d955a">ndims</a>; d++) {</div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;          ferr = fscanf(in,<span class="stringliteral">&quot;%lf %lf&quot;</span>, &amp;boundary[nb].xmin[d], &amp;boundary[nb].xmax[d]);</div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;          <span class="keywordflow">if</span> (ferr != 2) <span class="keywordflow">return</span>(1);</div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;        }</div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;  </div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;        <span class="comment">/* read in boundary type-specific additional data if required */</span></div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;  </div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;        <span class="keywordflow">if</span> (!strcmp(boundary[nb].bctype,<a class="code" href="a00219.html#a7b8553c8fd765568f7355cf32b93b20d">_DIRICHLET_</a>)) {</div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;          boundary[nb].<a class="code" href="a00185.html#a6aa65431c39a8d8177f35c338ddb7a0e">DirichletValue</a> = (<span class="keywordtype">double</span>*) calloc (solver-&gt;<a class="code" href="a00194.html#ae8f6d2fd6490d3153cb4133bf183a404">nvars</a>,<span class="keyword">sizeof</span>(<span class="keywordtype">double</span>)); </div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;                                       <span class="comment">/* deallocated in BCCleanup.c */</span></div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;          <span class="comment">/* read the Dirichlet value for each variable on this boundary */</span></div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;          <span class="keywordflow">for</span> (v = 0; v &lt; solver-&gt;<a class="code" href="a00194.html#ae8f6d2fd6490d3153cb4133bf183a404">nvars</a>; v++) ferr = fscanf(in,<span class="stringliteral">&quot;%lf&quot;</span>,&amp;boundary[nb].DirichletValue[v]);</div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;        }</div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;  </div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;        <span class="keywordflow">if</span> (!strcmp(boundary[nb].bctype,<a class="code" href="a00219.html#ab02c004c9707df0589311375014dc666">_SPONGE_</a>)) {</div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;          boundary[nb].<a class="code" href="a00185.html#af7eeb4ff3f7c8bc22e0786ddbe62f16d">SpongeValue</a> = (<span class="keywordtype">double</span>*) calloc (solver-&gt;<a class="code" href="a00194.html#ae8f6d2fd6490d3153cb4133bf183a404">nvars</a>,<span class="keyword">sizeof</span>(<span class="keywordtype">double</span>)); </div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;                                       <span class="comment">/* deallocated in BCCleanup.c */</span></div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;          <span class="comment">/* read the sponge value for each variable on this boundary */</span></div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;          <span class="keywordflow">for</span> (v = 0; v &lt; solver-&gt;<a class="code" href="a00194.html#ae8f6d2fd6490d3153cb4133bf183a404">nvars</a>; v++) ferr = fscanf(in,<span class="stringliteral">&quot;%lf&quot;</span>,&amp;boundary[nb].SpongeValue[v]);</div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;        }</div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;  </div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;        <span class="keywordflow">if</span> (    (!strcmp(boundary[nb].bctype,<a class="code" href="a00219.html#af3a9f3ba15bc914ed0a88295aee147e8">_SLIP_WALL_</a>)) </div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;            ||  (!strcmp(boundary[nb].bctype,<a class="code" href="a00219.html#affb6a9c452f92435e738bd59b9c98935">_NOSLIP_WALL_</a>)) ) {</div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;          boundary[nb].<a class="code" href="a00185.html#a0d0d92fab642e1d02a9de254e73a3f21">FlowVelocity</a> = (<span class="keywordtype">double</span>*) calloc (solver-&gt;<a class="code" href="a00194.html#a484873c74138512e41bc50d17b7d955a">ndims</a>,<span class="keyword">sizeof</span>(<span class="keywordtype">double</span>));</div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;                                       <span class="comment">/* deallocated in BCCleanup.c */</span></div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;          <span class="comment">/* read the wall velocity */</span></div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;          <span class="keywordflow">for</span> (v = 0; v &lt; solver-&gt;<a class="code" href="a00194.html#a484873c74138512e41bc50d17b7d955a">ndims</a>; v++) ferr = fscanf(in,<span class="stringliteral">&quot;%lf&quot;</span>,&amp;boundary[nb].FlowVelocity[v]);</div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;        }</div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;  </div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;        <span class="keywordflow">if</span> (    (!strcmp(boundary[nb].bctype,<a class="code" href="a00219.html#a6cd5a586de4ae1a3b73884d62f76bdee">_SW_SLIP_WALL_</a>)) </div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;            ||  (!strcmp(boundary[nb].bctype,<a class="code" href="a00219.html#ab8248be9e215df26dfce851b1acc54ec">_SW_NOSLIP_WALL_</a>)) ) {</div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;          boundary[nb].<a class="code" href="a00185.html#a0d0d92fab642e1d02a9de254e73a3f21">FlowVelocity</a> = (<span class="keywordtype">double</span>*) calloc (solver-&gt;<a class="code" href="a00194.html#a484873c74138512e41bc50d17b7d955a">ndims</a>,<span class="keyword">sizeof</span>(<span class="keywordtype">double</span>));</div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;                                       <span class="comment">/* deallocated in BCCleanup.c */</span></div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;          <span class="comment">/* read the wall velocity */</span></div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;          <span class="keywordflow">for</span> (v = 0; v &lt; solver-&gt;<a class="code" href="a00194.html#a484873c74138512e41bc50d17b7d955a">ndims</a>; v++) ferr = fscanf(in,<span class="stringliteral">&quot;%lf&quot;</span>,&amp;boundary[nb].FlowVelocity[v]);</div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;        }</div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;  </div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;        <span class="keywordflow">if</span> (!strcmp(boundary[nb].bctype,<a class="code" href="a00219.html#adba2024137894c96339af50efabe3771">_SUBSONIC_INFLOW_</a>)) {</div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;          boundary[nb].<a class="code" href="a00185.html#a0d0d92fab642e1d02a9de254e73a3f21">FlowVelocity</a> = (<span class="keywordtype">double</span>*) calloc (solver-&gt;<a class="code" href="a00194.html#a484873c74138512e41bc50d17b7d955a">ndims</a>,<span class="keyword">sizeof</span>(<span class="keywordtype">double</span>));</div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;                                       <span class="comment">/* deallocated in BCCleanup.c */</span></div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;          <span class="comment">/* read in the inflow density and velocity */</span></div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;          ferr = fscanf(in,<span class="stringliteral">&quot;%lf&quot;</span>,&amp;boundary[nb].FlowDensity);</div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;          <span class="keywordflow">for</span> (v = 0; v &lt; solver-&gt;<a class="code" href="a00194.html#a484873c74138512e41bc50d17b7d955a">ndims</a>; v++) ferr = fscanf(in,<span class="stringliteral">&quot;%lf&quot;</span>,&amp;boundary[nb].FlowVelocity[v]);</div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;        }</div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;  </div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;        <span class="keywordflow">if</span> (!strcmp(boundary[nb].bctype,<a class="code" href="a00219.html#adeb38801d1b832ce3eee3ebc1eed6263">_SUBSONIC_OUTFLOW_</a>)) {</div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;          <span class="comment">/* read in the outflow pressure */</span></div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;          ferr = fscanf(in,<span class="stringliteral">&quot;%lf&quot;</span>,&amp;boundary[nb].FlowPressure);</div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;        }</div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;  </div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;        <span class="keywordflow">if</span> (!strcmp(boundary[nb].bctype,<a class="code" href="a00219.html#aac7250bf34e60e7df688d3cf7355855c">_SUBSONIC_AMBIVALENT_</a>)) {</div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;          boundary[nb].<a class="code" href="a00185.html#a0d0d92fab642e1d02a9de254e73a3f21">FlowVelocity</a> = (<span class="keywordtype">double</span>*) calloc (solver-&gt;<a class="code" href="a00194.html#a484873c74138512e41bc50d17b7d955a">ndims</a>,<span class="keyword">sizeof</span>(<span class="keywordtype">double</span>));</div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;                                       <span class="comment">/* deallocated in BCCleanup.c */</span></div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;          <span class="comment">/* read in the inflow density, velocity, and pressure */</span></div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;          ferr = fscanf(in,<span class="stringliteral">&quot;%lf&quot;</span>,&amp;boundary[nb].FlowDensity);</div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;          <span class="keywordflow">for</span> (v = 0; v &lt; solver-&gt;<a class="code" href="a00194.html#a484873c74138512e41bc50d17b7d955a">ndims</a>; v++) ferr = fscanf(in,<span class="stringliteral">&quot;%lf&quot;</span>,&amp;boundary[nb].FlowVelocity[v]);</div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;          ferr = fscanf(in,<span class="stringliteral">&quot;%lf&quot;</span>,&amp;boundary[nb].FlowPressure);</div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;        }</div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;  </div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;        <span class="keywordflow">if</span> (!strcmp(boundary[nb].bctype,<a class="code" href="a00219.html#a5c9f9f3c97682664b0fe253e10863b57">_SUPERSONIC_INFLOW_</a>)) {</div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;          boundary[nb].<a class="code" href="a00185.html#a0d0d92fab642e1d02a9de254e73a3f21">FlowVelocity</a> = (<span class="keywordtype">double</span>*) calloc (solver-&gt;<a class="code" href="a00194.html#a484873c74138512e41bc50d17b7d955a">ndims</a>,<span class="keyword">sizeof</span>(<span class="keywordtype">double</span>));</div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;                                       <span class="comment">/* deallocated in BCCleanup.c */</span></div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;          <span class="comment">/* read in the inflow density, velocity and pressure */</span></div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;          ferr = fscanf(in,<span class="stringliteral">&quot;%lf&quot;</span>,&amp;boundary[nb].FlowDensity);</div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;          <span class="keywordflow">for</span> (v = 0; v &lt; solver-&gt;<a class="code" href="a00194.html#a484873c74138512e41bc50d17b7d955a">ndims</a>; v++) ferr = fscanf(in,<span class="stringliteral">&quot;%lf&quot;</span>,&amp;boundary[nb].FlowVelocity[v]);</div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;          ferr = fscanf(in,<span class="stringliteral">&quot;%lf&quot;</span>,&amp;boundary[nb].FlowPressure);</div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;        }</div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;  </div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;        <span class="keywordflow">if</span> (!strcmp(boundary[nb].bctype,<a class="code" href="a00219.html#a9b20b4f17d0f550f5da42946cc8a5b4a">_TURBULENT_SUPERSONIC_INFLOW_</a>)) {</div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;          boundary[nb].<a class="code" href="a00185.html#a0d0d92fab642e1d02a9de254e73a3f21">FlowVelocity</a> = (<span class="keywordtype">double</span>*) calloc (solver-&gt;<a class="code" href="a00194.html#a484873c74138512e41bc50d17b7d955a">ndims</a>,<span class="keyword">sizeof</span>(<span class="keywordtype">double</span>));</div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;                                       <span class="comment">/* deallocated in BCCleanup.c */</span></div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;          <span class="comment">/* read in the inflow density, velocity and pressure */</span></div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;          ferr = fscanf(in,<span class="stringliteral">&quot;%lf&quot;</span>,&amp;boundary[nb].FlowDensity);</div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;          <span class="keywordflow">for</span> (v = 0; v &lt; solver-&gt;<a class="code" href="a00194.html#a484873c74138512e41bc50d17b7d955a">ndims</a>; v++) ferr = fscanf(in,<span class="stringliteral">&quot;%lf&quot;</span>,&amp;boundary[nb].FlowVelocity[v]);</div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;          ferr = fscanf(in,<span class="stringliteral">&quot;%lf&quot;</span>,&amp;boundary[nb].FlowPressure);</div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;          ferr = fscanf(in,<span class="stringliteral">&quot;%s&quot;</span> , boundary[nb].UnsteadyDirichletFilename);</div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;        }</div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;  </div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;        <span class="keywordflow">if</span> (    (!strcmp(boundary[nb].bctype,<a class="code" href="a00219.html#a1fb5767ea5e8c4f48969ff25eae1ddaf">_THERMAL_SLIP_WALL_</a>))</div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;            ||  (!strcmp(boundary[nb].bctype,<a class="code" href="a00219.html#a8e1e1ee6a2a121618e124cad69c8739c">_THERMAL_NOSLIP_WALL_</a>)) ){</div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;          boundary[nb].<a class="code" href="a00185.html#a0d0d92fab642e1d02a9de254e73a3f21">FlowVelocity</a> = (<span class="keywordtype">double</span>*) calloc (solver-&gt;<a class="code" href="a00194.html#a484873c74138512e41bc50d17b7d955a">ndims</a>,<span class="keyword">sizeof</span>(<span class="keywordtype">double</span>));</div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;                                       <span class="comment">/* deallocated in BCCleanup.c */</span></div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;          <span class="comment">/* read the wall velocity */</span></div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;          <span class="keywordflow">for</span> (v = 0; v &lt; solver-&gt;<a class="code" href="a00194.html#a484873c74138512e41bc50d17b7d955a">ndims</a>; v++) ferr = fscanf(in,<span class="stringliteral">&quot;%lf&quot;</span>,&amp;boundary[nb].FlowVelocity[v]);</div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;          <span class="comment">/* read in the filename where temperature data is available */</span></div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;          ferr = fscanf(in,<span class="stringliteral">&quot;%s&quot;</span> , boundary[nb].UnsteadyTemperatureFilename);</div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;        }</div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;  </div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;        <span class="comment">/* if boundary is periodic, let the MPI and HyPar know */</span></div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;        <span class="keywordflow">if</span> (!strcmp(boundary[nb].bctype,<a class="code" href="a00219.html#a65ffa4253dee762c65092abcf04ecdee">_PERIODIC_</a>)) {</div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;          solver-&gt;<a class="code" href="a00194.html#a40e3f67b1530d5ea4e913fc60b594802">isPeriodic</a>[boundary[nb].<a class="code" href="a00185.html#a70b5e28b5bc3d1b63a7435c5fe50b837">dim</a>] = 1;</div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;        }</div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;        <span class="comment">/* </span></div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;<span class="comment">          The MPI function to exchange internal (MPI) boundary information will handle</span></div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;<span class="comment">          periodic boundaries ONLY IF number of process along that dimension is more </span></div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;<span class="comment">          than 1.</span></div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;<span class="comment">        */</span></div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;        <span class="keywordflow">if</span> ((!strcmp(boundary[nb].bctype,<a class="code" href="a00219.html#a65ffa4253dee762c65092abcf04ecdee">_PERIODIC_</a>)) &amp;&amp; (mpi-&gt;<a class="code" href="a00197.html#a0be0f30a83bc3f3d9f6ee3a36bbf2716">iproc</a>[boundary[nb].<a class="code" href="a00185.html#a70b5e28b5bc3d1b63a7435c5fe50b837">dim</a>] &gt; 1)) {</div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;          mpi-&gt;<a class="code" href="a00197.html#af40a5a3066fdb53a47e4627071abc2bc">bcperiodic</a>[boundary[nb].<a class="code" href="a00185.html#a70b5e28b5bc3d1b63a7435c5fe50b837">dim</a>] = 1;</div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;        }</div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;  </div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;        <span class="comment">/* some checks */</span></div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;        <span class="keywordflow">if</span> (boundary[nb].dim &gt;= solver-&gt;<a class="code" href="a00194.html#a484873c74138512e41bc50d17b7d955a">ndims</a>) {</div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;          fprintf(stderr,<span class="stringliteral">&quot;Error in reading boundary condition %d: dim %d is invalid (ndims = %d).\n&quot;</span>,</div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;                  nb,boundary[nb].dim,solver-&gt;<a class="code" href="a00194.html#a484873c74138512e41bc50d17b7d955a">ndims</a>);</div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;          <span class="keywordflow">return</span>(1);</div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;        }</div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;        printf(<span class="stringliteral">&quot;  Boundary %30s:  Along dimension %2d and face %+1d\n&quot;</span>,</div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;                  boundary[nb].bctype,boundary[nb].dim,boundary[nb].face);</div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;      }</div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;  </div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;      fclose(in);</div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;      printf(<span class="stringliteral">&quot;%d boundary condition(s) read.\n&quot;</span>,solver-&gt;<a class="code" href="a00194.html#a3f9a55664d1c8f058828ae9f4de11906">nBoundaryZones</a>);</div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;    }</div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;</div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;    <span class="comment">/* tell other processes how many BCs are there and let them allocate */</span></div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;    <a class="code" href="a00218.html#ad6ab74942c9de13cf0b4c12eb0d91780">IERR</a> <a class="code" href="a00234.html#acd7957559b9206224c7da3cab4f22b27">MPIBroadcast_integer</a>(&amp;solver-&gt;<a class="code" href="a00194.html#a3f9a55664d1c8f058828ae9f4de11906">nBoundaryZones</a>,1,0,&amp;mpi-&gt;<a class="code" href="a00197.html#adad7a6f85831f3ac84d854b6c80aef43">world</a>); <a class="code" href="a00218.html#add9cf96ae374934d245a1dc1ab697a42">CHECKERR</a>(ierr);</div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;    <span class="keywordflow">if</span> (mpi-&gt;<a class="code" href="a00197.html#a6cfd95afd0afebd625b889fb6e58371c">rank</a>) {</div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;      boundary = (<a class="code" href="a00185.html">DomainBoundary</a>*) calloc (solver-&gt;<a class="code" href="a00194.html#a3f9a55664d1c8f058828ae9f4de11906">nBoundaryZones</a>,<span class="keyword">sizeof</span>(<a class="code" href="a00185.html">DomainBoundary</a>));</div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;      <span class="keywordflow">for</span> (nb = 0; nb &lt; solver-&gt;<a class="code" href="a00194.html#a3f9a55664d1c8f058828ae9f4de11906">nBoundaryZones</a>; nb++) {</div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;        boundary[nb].<a class="code" href="a00185.html#a1e51e79041d5a3dddffb503277703568">xmin</a> = (<span class="keywordtype">double</span>*) calloc (solver-&gt;<a class="code" href="a00194.html#a484873c74138512e41bc50d17b7d955a">ndims</a>,<span class="keyword">sizeof</span>(<span class="keywordtype">double</span>)); <span class="comment">/* deallocated in BCCleanup.c */</span></div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;        boundary[nb].<a class="code" href="a00185.html#a7ea24a733beddff902459a07bf91ca67">xmax</a> = (<span class="keywordtype">double</span>*) calloc (solver-&gt;<a class="code" href="a00194.html#a484873c74138512e41bc50d17b7d955a">ndims</a>,<span class="keyword">sizeof</span>(<span class="keywordtype">double</span>)); <span class="comment">/* deallocated in BCCleanup.c */</span></div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;        boundary[nb].<a class="code" href="a00185.html#a6aa65431c39a8d8177f35c338ddb7a0e">DirichletValue</a> = boundary[nb].<a class="code" href="a00185.html#af7eeb4ff3f7c8bc22e0786ddbe62f16d">SpongeValue</a> </div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;                                   = boundary[nb].<a class="code" href="a00185.html#a0d0d92fab642e1d02a9de254e73a3f21">FlowVelocity</a> </div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;                                   = boundary[nb].<a class="code" href="a00185.html#a48f59fc59e6a86d0b4aad842daea9106">UnsteadyDirichletData</a></div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;                                   = NULL;</div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;        boundary[nb].<a class="code" href="a00185.html#ac3b478217419275ad063182f69cb543d">UnsteadyDirichletSize</a> = NULL;</div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;      }</div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;    }</div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;</div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;    <span class="comment">/* communicate BC data to other processes */</span></div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;    <span class="keywordflow">for</span> (nb = 0; nb &lt; solver-&gt;<a class="code" href="a00194.html#a3f9a55664d1c8f058828ae9f4de11906">nBoundaryZones</a>; nb++) {</div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;      <a class="code" href="a00218.html#ad6ab74942c9de13cf0b4c12eb0d91780">IERR</a> <a class="code" href="a00234.html#ad408e5a44e863cca50112d1e2f728597">MPIBroadcast_character</a>(boundary[nb].bctype,<a class="code" href="a00218.html#a51efea86a4d76d1259893f606b776573">_MAX_STRING_SIZE_</a>,0,&amp;mpi-&gt;<a class="code" href="a00197.html#adad7a6f85831f3ac84d854b6c80aef43">world</a>); <a class="code" href="a00218.html#add9cf96ae374934d245a1dc1ab697a42">CHECKERR</a>(ierr);</div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;      <a class="code" href="a00218.html#ad6ab74942c9de13cf0b4c12eb0d91780">IERR</a> <a class="code" href="a00234.html#acd7957559b9206224c7da3cab4f22b27">MPIBroadcast_integer</a>  (&amp;boundary[nb].dim  ,1                ,0,&amp;mpi-&gt;<a class="code" href="a00197.html#adad7a6f85831f3ac84d854b6c80aef43">world</a>); <a class="code" href="a00218.html#add9cf96ae374934d245a1dc1ab697a42">CHECKERR</a>(ierr);</div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;      <a class="code" href="a00218.html#ad6ab74942c9de13cf0b4c12eb0d91780">IERR</a> <a class="code" href="a00234.html#acd7957559b9206224c7da3cab4f22b27">MPIBroadcast_integer</a>  (&amp;boundary[nb].face ,1                ,0,&amp;mpi-&gt;<a class="code" href="a00197.html#adad7a6f85831f3ac84d854b6c80aef43">world</a>); <a class="code" href="a00218.html#add9cf96ae374934d245a1dc1ab697a42">CHECKERR</a>(ierr);</div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;      <a class="code" href="a00218.html#ad6ab74942c9de13cf0b4c12eb0d91780">IERR</a> <a class="code" href="a00234.html#a45dcb265863a65d862bb16222e7e623c">MPIBroadcast_double</a>   (boundary[nb].xmin  ,solver-&gt;<a class="code" href="a00194.html#a484873c74138512e41bc50d17b7d955a">ndims</a>    ,0,&amp;mpi-&gt;<a class="code" href="a00197.html#adad7a6f85831f3ac84d854b6c80aef43">world</a>); <a class="code" href="a00218.html#add9cf96ae374934d245a1dc1ab697a42">CHECKERR</a>(ierr);</div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;      <a class="code" href="a00218.html#ad6ab74942c9de13cf0b4c12eb0d91780">IERR</a> <a class="code" href="a00234.html#a45dcb265863a65d862bb16222e7e623c">MPIBroadcast_double</a>   (boundary[nb].xmax  ,solver-&gt;<a class="code" href="a00194.html#a484873c74138512e41bc50d17b7d955a">ndims</a>    ,0,&amp;mpi-&gt;<a class="code" href="a00197.html#adad7a6f85831f3ac84d854b6c80aef43">world</a>); <a class="code" href="a00218.html#add9cf96ae374934d245a1dc1ab697a42">CHECKERR</a>(ierr);</div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;    }</div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;    <a class="code" href="a00218.html#ad6ab74942c9de13cf0b4c12eb0d91780">IERR</a> <a class="code" href="a00234.html#acd7957559b9206224c7da3cab4f22b27">MPIBroadcast_integer</a>(solver-&gt;<a class="code" href="a00194.html#a40e3f67b1530d5ea4e913fc60b594802">isPeriodic</a>,solver-&gt;<a class="code" href="a00194.html#a484873c74138512e41bc50d17b7d955a">ndims</a>,0,&amp;mpi-&gt;<a class="code" href="a00197.html#adad7a6f85831f3ac84d854b6c80aef43">world</a>);<a class="code" href="a00218.html#add9cf96ae374934d245a1dc1ab697a42">CHECKERR</a>(ierr);</div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;  </div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;    <span class="comment">/* broadcast periodic boundary info for MPI to all processes */</span></div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;    <a class="code" href="a00218.html#ad6ab74942c9de13cf0b4c12eb0d91780">IERR</a> <a class="code" href="a00234.html#acd7957559b9206224c7da3cab4f22b27">MPIBroadcast_integer</a>(mpi-&gt;<a class="code" href="a00197.html#af40a5a3066fdb53a47e4627071abc2bc">bcperiodic</a>,solver-&gt;<a class="code" href="a00194.html#a484873c74138512e41bc50d17b7d955a">ndims</a>,0,&amp;mpi-&gt;<a class="code" href="a00197.html#adad7a6f85831f3ac84d854b6c80aef43">world</a>);<a class="code" href="a00218.html#add9cf96ae374934d245a1dc1ab697a42">CHECKERR</a>(ierr);</div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;</div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;    <span class="comment">/* On other processes, if necessary, allocate and receive boundary-type-specific data */</span></div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;    <span class="keywordflow">for</span> (nb = 0; nb &lt; solver-&gt;<a class="code" href="a00194.html#a3f9a55664d1c8f058828ae9f4de11906">nBoundaryZones</a>; nb++) {</div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;      <span class="keywordflow">if</span> (!strcmp(boundary[nb].bctype,<a class="code" href="a00219.html#a7b8553c8fd765568f7355cf32b93b20d">_DIRICHLET_</a>)) {</div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;        <span class="keywordflow">if</span> (mpi-&gt;<a class="code" href="a00197.html#a6cfd95afd0afebd625b889fb6e58371c">rank</a>)  boundary[nb].<a class="code" href="a00185.html#a6aa65431c39a8d8177f35c338ddb7a0e">DirichletValue</a> = (<span class="keywordtype">double</span>*) calloc (solver-&gt;<a class="code" href="a00194.html#ae8f6d2fd6490d3153cb4133bf183a404">nvars</a>,<span class="keyword">sizeof</span>(<span class="keywordtype">double</span>));</div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;        <a class="code" href="a00218.html#ad6ab74942c9de13cf0b4c12eb0d91780">IERR</a> <a class="code" href="a00234.html#a45dcb265863a65d862bb16222e7e623c">MPIBroadcast_double</a>(boundary[nb].DirichletValue,solver-&gt;<a class="code" href="a00194.html#ae8f6d2fd6490d3153cb4133bf183a404">nvars</a>,0,&amp;mpi-&gt;<a class="code" href="a00197.html#adad7a6f85831f3ac84d854b6c80aef43">world</a>); <a class="code" href="a00218.html#add9cf96ae374934d245a1dc1ab697a42">CHECKERR</a>(ierr);</div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;      }</div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;  </div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;      <span class="keywordflow">if</span> (!strcmp(boundary[nb].bctype,<a class="code" href="a00219.html#ab02c004c9707df0589311375014dc666">_SPONGE_</a>)) {</div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;        <span class="keywordflow">if</span> (mpi-&gt;<a class="code" href="a00197.html#a6cfd95afd0afebd625b889fb6e58371c">rank</a>)  boundary[nb].<a class="code" href="a00185.html#af7eeb4ff3f7c8bc22e0786ddbe62f16d">SpongeValue</a> = (<span class="keywordtype">double</span>*) calloc (solver-&gt;<a class="code" href="a00194.html#ae8f6d2fd6490d3153cb4133bf183a404">nvars</a>,<span class="keyword">sizeof</span>(<span class="keywordtype">double</span>));</div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;        <a class="code" href="a00218.html#ad6ab74942c9de13cf0b4c12eb0d91780">IERR</a> <a class="code" href="a00234.html#a45dcb265863a65d862bb16222e7e623c">MPIBroadcast_double</a>(boundary[nb].SpongeValue,solver-&gt;<a class="code" href="a00194.html#ae8f6d2fd6490d3153cb4133bf183a404">nvars</a>,0,&amp;mpi-&gt;<a class="code" href="a00197.html#adad7a6f85831f3ac84d854b6c80aef43">world</a>); <a class="code" href="a00218.html#add9cf96ae374934d245a1dc1ab697a42">CHECKERR</a>(ierr);</div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;      }</div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;  </div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;      <span class="keywordflow">if</span> (    (!strcmp(boundary[nb].bctype,<a class="code" href="a00219.html#af3a9f3ba15bc914ed0a88295aee147e8">_SLIP_WALL_</a>)) </div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;          ||  (!strcmp(boundary[nb].bctype,<a class="code" href="a00219.html#affb6a9c452f92435e738bd59b9c98935">_NOSLIP_WALL_</a>)) ) {</div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;        <span class="keywordflow">if</span> (mpi-&gt;<a class="code" href="a00197.html#a6cfd95afd0afebd625b889fb6e58371c">rank</a>) boundary[nb].<a class="code" href="a00185.html#a0d0d92fab642e1d02a9de254e73a3f21">FlowVelocity</a> = (<span class="keywordtype">double</span>*) calloc (solver-&gt;<a class="code" href="a00194.html#a484873c74138512e41bc50d17b7d955a">ndims</a>,<span class="keyword">sizeof</span>(<span class="keywordtype">double</span>));</div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;        <a class="code" href="a00218.html#ad6ab74942c9de13cf0b4c12eb0d91780">IERR</a> <a class="code" href="a00234.html#a45dcb265863a65d862bb16222e7e623c">MPIBroadcast_double</a>(boundary[nb].FlowVelocity,solver-&gt;<a class="code" href="a00194.html#a484873c74138512e41bc50d17b7d955a">ndims</a>,0,&amp;mpi-&gt;<a class="code" href="a00197.html#adad7a6f85831f3ac84d854b6c80aef43">world</a>); <a class="code" href="a00218.html#add9cf96ae374934d245a1dc1ab697a42">CHECKERR</a>(ierr);</div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;      }</div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;  </div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;      <span class="keywordflow">if</span> (    (!strcmp(boundary[nb].bctype,<a class="code" href="a00219.html#a6cd5a586de4ae1a3b73884d62f76bdee">_SW_SLIP_WALL_</a>)) </div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;          ||  (!strcmp(boundary[nb].bctype,<a class="code" href="a00219.html#ab8248be9e215df26dfce851b1acc54ec">_SW_NOSLIP_WALL_</a>)) ) {</div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;        <span class="keywordflow">if</span> (mpi-&gt;<a class="code" href="a00197.html#a6cfd95afd0afebd625b889fb6e58371c">rank</a>) boundary[nb].<a class="code" href="a00185.html#a0d0d92fab642e1d02a9de254e73a3f21">FlowVelocity</a> = (<span class="keywordtype">double</span>*) calloc (solver-&gt;<a class="code" href="a00194.html#a484873c74138512e41bc50d17b7d955a">ndims</a>,<span class="keyword">sizeof</span>(<span class="keywordtype">double</span>));</div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;        <a class="code" href="a00218.html#ad6ab74942c9de13cf0b4c12eb0d91780">IERR</a> <a class="code" href="a00234.html#a45dcb265863a65d862bb16222e7e623c">MPIBroadcast_double</a>(boundary[nb].FlowVelocity,solver-&gt;<a class="code" href="a00194.html#a484873c74138512e41bc50d17b7d955a">ndims</a>,0,&amp;mpi-&gt;<a class="code" href="a00197.html#adad7a6f85831f3ac84d854b6c80aef43">world</a>); <a class="code" href="a00218.html#add9cf96ae374934d245a1dc1ab697a42">CHECKERR</a>(ierr);</div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;      }</div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;  </div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;      <span class="keywordflow">if</span> (!strcmp(boundary[nb].bctype,<a class="code" href="a00219.html#adba2024137894c96339af50efabe3771">_SUBSONIC_INFLOW_</a>)) {</div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;        <span class="keywordflow">if</span> (mpi-&gt;<a class="code" href="a00197.html#a6cfd95afd0afebd625b889fb6e58371c">rank</a>) boundary[nb].<a class="code" href="a00185.html#a0d0d92fab642e1d02a9de254e73a3f21">FlowVelocity</a> = (<span class="keywordtype">double</span>*) calloc (solver-&gt;<a class="code" href="a00194.html#a484873c74138512e41bc50d17b7d955a">ndims</a>,<span class="keyword">sizeof</span>(<span class="keywordtype">double</span>));</div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;        <a class="code" href="a00218.html#ad6ab74942c9de13cf0b4c12eb0d91780">IERR</a> <a class="code" href="a00234.html#a45dcb265863a65d862bb16222e7e623c">MPIBroadcast_double</a>(&amp;boundary[nb].FlowDensity,1            ,0,&amp;mpi-&gt;<a class="code" href="a00197.html#adad7a6f85831f3ac84d854b6c80aef43">world</a>); <a class="code" href="a00218.html#add9cf96ae374934d245a1dc1ab697a42">CHECKERR</a>(ierr);</div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;        <a class="code" href="a00218.html#ad6ab74942c9de13cf0b4c12eb0d91780">IERR</a> <a class="code" href="a00234.html#a45dcb265863a65d862bb16222e7e623c">MPIBroadcast_double</a>(boundary[nb].FlowVelocity,solver-&gt;<a class="code" href="a00194.html#a484873c74138512e41bc50d17b7d955a">ndims</a>,0,&amp;mpi-&gt;<a class="code" href="a00197.html#adad7a6f85831f3ac84d854b6c80aef43">world</a>); <a class="code" href="a00218.html#add9cf96ae374934d245a1dc1ab697a42">CHECKERR</a>(ierr);</div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;      }</div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;  </div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;      <span class="keywordflow">if</span> (!strcmp(boundary[nb].bctype,<a class="code" href="a00219.html#adeb38801d1b832ce3eee3ebc1eed6263">_SUBSONIC_OUTFLOW_</a>)) {</div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;        <a class="code" href="a00218.html#ad6ab74942c9de13cf0b4c12eb0d91780">IERR</a> <a class="code" href="a00234.html#a45dcb265863a65d862bb16222e7e623c">MPIBroadcast_double</a>(&amp;boundary[nb].FlowPressure,1,0,&amp;mpi-&gt;<a class="code" href="a00197.html#adad7a6f85831f3ac84d854b6c80aef43">world</a>); <a class="code" href="a00218.html#add9cf96ae374934d245a1dc1ab697a42">CHECKERR</a>(ierr);</div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;      }</div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;  </div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;      <span class="keywordflow">if</span> (!strcmp(boundary[nb].bctype,<a class="code" href="a00219.html#aac7250bf34e60e7df688d3cf7355855c">_SUBSONIC_AMBIVALENT_</a>)) {</div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;        <span class="keywordflow">if</span> (mpi-&gt;<a class="code" href="a00197.html#a6cfd95afd0afebd625b889fb6e58371c">rank</a>) boundary[nb].<a class="code" href="a00185.html#a0d0d92fab642e1d02a9de254e73a3f21">FlowVelocity</a> = (<span class="keywordtype">double</span>*) calloc (solver-&gt;<a class="code" href="a00194.html#a484873c74138512e41bc50d17b7d955a">ndims</a>,<span class="keyword">sizeof</span>(<span class="keywordtype">double</span>));</div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;        <a class="code" href="a00218.html#ad6ab74942c9de13cf0b4c12eb0d91780">IERR</a> <a class="code" href="a00234.html#a45dcb265863a65d862bb16222e7e623c">MPIBroadcast_double</a>(&amp;boundary[nb].FlowDensity,1            ,0,&amp;mpi-&gt;<a class="code" href="a00197.html#adad7a6f85831f3ac84d854b6c80aef43">world</a>); <a class="code" href="a00218.html#add9cf96ae374934d245a1dc1ab697a42">CHECKERR</a>(ierr);</div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;        <a class="code" href="a00218.html#ad6ab74942c9de13cf0b4c12eb0d91780">IERR</a> <a class="code" href="a00234.html#a45dcb265863a65d862bb16222e7e623c">MPIBroadcast_double</a>(boundary[nb].FlowVelocity,solver-&gt;<a class="code" href="a00194.html#a484873c74138512e41bc50d17b7d955a">ndims</a>,0,&amp;mpi-&gt;<a class="code" href="a00197.html#adad7a6f85831f3ac84d854b6c80aef43">world</a>); <a class="code" href="a00218.html#add9cf96ae374934d245a1dc1ab697a42">CHECKERR</a>(ierr);</div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;        <a class="code" href="a00218.html#ad6ab74942c9de13cf0b4c12eb0d91780">IERR</a> <a class="code" href="a00234.html#a45dcb265863a65d862bb16222e7e623c">MPIBroadcast_double</a>(&amp;boundary[nb].FlowPressure,1,0,&amp;mpi-&gt;<a class="code" href="a00197.html#adad7a6f85831f3ac84d854b6c80aef43">world</a>); <a class="code" href="a00218.html#add9cf96ae374934d245a1dc1ab697a42">CHECKERR</a>(ierr);</div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;      }</div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;  </div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;      <span class="keywordflow">if</span> (!strcmp(boundary[nb].bctype,<a class="code" href="a00219.html#a5c9f9f3c97682664b0fe253e10863b57">_SUPERSONIC_INFLOW_</a>)) {</div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;        <span class="keywordflow">if</span> (mpi-&gt;<a class="code" href="a00197.html#a6cfd95afd0afebd625b889fb6e58371c">rank</a>) boundary[nb].<a class="code" href="a00185.html#a0d0d92fab642e1d02a9de254e73a3f21">FlowVelocity</a> = (<span class="keywordtype">double</span>*) calloc (solver-&gt;<a class="code" href="a00194.html#a484873c74138512e41bc50d17b7d955a">ndims</a>,<span class="keyword">sizeof</span>(<span class="keywordtype">double</span>));</div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;        <a class="code" href="a00218.html#ad6ab74942c9de13cf0b4c12eb0d91780">IERR</a> <a class="code" href="a00234.html#a45dcb265863a65d862bb16222e7e623c">MPIBroadcast_double</a>(&amp;boundary[nb].FlowDensity ,1            ,0,&amp;mpi-&gt;<a class="code" href="a00197.html#adad7a6f85831f3ac84d854b6c80aef43">world</a>); <a class="code" href="a00218.html#add9cf96ae374934d245a1dc1ab697a42">CHECKERR</a>(ierr);</div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;        <a class="code" href="a00218.html#ad6ab74942c9de13cf0b4c12eb0d91780">IERR</a> <a class="code" href="a00234.html#a45dcb265863a65d862bb16222e7e623c">MPIBroadcast_double</a>(boundary[nb].FlowVelocity ,solver-&gt;<a class="code" href="a00194.html#a484873c74138512e41bc50d17b7d955a">ndims</a>,0,&amp;mpi-&gt;<a class="code" href="a00197.html#adad7a6f85831f3ac84d854b6c80aef43">world</a>); <a class="code" href="a00218.html#add9cf96ae374934d245a1dc1ab697a42">CHECKERR</a>(ierr);</div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;        <a class="code" href="a00218.html#ad6ab74942c9de13cf0b4c12eb0d91780">IERR</a> <a class="code" href="a00234.html#a45dcb265863a65d862bb16222e7e623c">MPIBroadcast_double</a>(&amp;boundary[nb].FlowPressure,1            ,0,&amp;mpi-&gt;<a class="code" href="a00197.html#adad7a6f85831f3ac84d854b6c80aef43">world</a>); <a class="code" href="a00218.html#add9cf96ae374934d245a1dc1ab697a42">CHECKERR</a>(ierr);</div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;      }</div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;  </div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;      <span class="keywordflow">if</span> (!strcmp(boundary[nb].bctype,<a class="code" href="a00219.html#a9b20b4f17d0f550f5da42946cc8a5b4a">_TURBULENT_SUPERSONIC_INFLOW_</a>)) {</div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;        <span class="keywordflow">if</span> (mpi-&gt;<a class="code" href="a00197.html#a6cfd95afd0afebd625b889fb6e58371c">rank</a>) boundary[nb].<a class="code" href="a00185.html#a0d0d92fab642e1d02a9de254e73a3f21">FlowVelocity</a> = (<span class="keywordtype">double</span>*) calloc (solver-&gt;<a class="code" href="a00194.html#a484873c74138512e41bc50d17b7d955a">ndims</a>,<span class="keyword">sizeof</span>(<span class="keywordtype">double</span>));</div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;        <a class="code" href="a00218.html#ad6ab74942c9de13cf0b4c12eb0d91780">IERR</a> <a class="code" href="a00234.html#a45dcb265863a65d862bb16222e7e623c">MPIBroadcast_double</a>(&amp;boundary[nb].FlowDensity ,1            ,0,&amp;mpi-&gt;<a class="code" href="a00197.html#adad7a6f85831f3ac84d854b6c80aef43">world</a>); <a class="code" href="a00218.html#add9cf96ae374934d245a1dc1ab697a42">CHECKERR</a>(ierr);</div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;        <a class="code" href="a00218.html#ad6ab74942c9de13cf0b4c12eb0d91780">IERR</a> <a class="code" href="a00234.html#a45dcb265863a65d862bb16222e7e623c">MPIBroadcast_double</a>(boundary[nb].FlowVelocity ,solver-&gt;<a class="code" href="a00194.html#a484873c74138512e41bc50d17b7d955a">ndims</a>,0,&amp;mpi-&gt;<a class="code" href="a00197.html#adad7a6f85831f3ac84d854b6c80aef43">world</a>); <a class="code" href="a00218.html#add9cf96ae374934d245a1dc1ab697a42">CHECKERR</a>(ierr);</div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;        <a class="code" href="a00218.html#ad6ab74942c9de13cf0b4c12eb0d91780">IERR</a> <a class="code" href="a00234.html#a45dcb265863a65d862bb16222e7e623c">MPIBroadcast_double</a>(&amp;boundary[nb].FlowPressure,1            ,0,&amp;mpi-&gt;<a class="code" href="a00197.html#adad7a6f85831f3ac84d854b6c80aef43">world</a>); <a class="code" href="a00218.html#add9cf96ae374934d245a1dc1ab697a42">CHECKERR</a>(ierr);</div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;        <span class="comment">/* allocate arrays and read in unsteady boundary data */</span></div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;        <a class="code" href="a00218.html#ad6ab74942c9de13cf0b4c12eb0d91780">IERR</a> <a class="code" href="a00219.html#a6cc369236fbfe94bff52c55175cfaba7">BCReadTurbulentInflowData</a>(&amp;boundary[nb],mpi,solver-&gt;<a class="code" href="a00194.html#a484873c74138512e41bc50d17b7d955a">ndims</a>,solver-&gt;<a class="code" href="a00194.html#ae8f6d2fd6490d3153cb4133bf183a404">nvars</a>,solver-&gt;<a class="code" href="a00194.html#a38e0371f331cecbe63a77fa03e202afe">dim_local</a>); <a class="code" href="a00218.html#add9cf96ae374934d245a1dc1ab697a42">CHECKERR</a>(ierr);</div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;      }</div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;  </div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;      <span class="keywordflow">if</span> (    (!strcmp(boundary[nb].bctype,<a class="code" href="a00219.html#a1fb5767ea5e8c4f48969ff25eae1ddaf">_THERMAL_SLIP_WALL_</a>)) </div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;          ||  (!strcmp(boundary[nb].bctype,<a class="code" href="a00219.html#a8e1e1ee6a2a121618e124cad69c8739c">_THERMAL_NOSLIP_WALL_</a>)) ) {</div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;        <span class="keywordflow">if</span> (mpi-&gt;<a class="code" href="a00197.html#a6cfd95afd0afebd625b889fb6e58371c">rank</a>) boundary[nb].<a class="code" href="a00185.html#a0d0d92fab642e1d02a9de254e73a3f21">FlowVelocity</a> = (<span class="keywordtype">double</span>*) calloc (solver-&gt;<a class="code" href="a00194.html#a484873c74138512e41bc50d17b7d955a">ndims</a>,<span class="keyword">sizeof</span>(<span class="keywordtype">double</span>));</div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;        <a class="code" href="a00218.html#ad6ab74942c9de13cf0b4c12eb0d91780">IERR</a> <a class="code" href="a00234.html#a45dcb265863a65d862bb16222e7e623c">MPIBroadcast_double</a>(boundary[nb].FlowVelocity,solver-&gt;<a class="code" href="a00194.html#a484873c74138512e41bc50d17b7d955a">ndims</a>,0,&amp;mpi-&gt;<a class="code" href="a00197.html#adad7a6f85831f3ac84d854b6c80aef43">world</a>); <a class="code" href="a00218.html#add9cf96ae374934d245a1dc1ab697a42">CHECKERR</a>(ierr);</div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;        <span class="comment">/* allocate arrays and read in boundary temperature data */</span></div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;        <a class="code" href="a00218.html#ad6ab74942c9de13cf0b4c12eb0d91780">IERR</a> <a class="code" href="a00219.html#a0feed0764d1dafc0d4313a9b12cadd9d">BCReadTemperatureData</a>(&amp;boundary[nb],mpi,solver-&gt;<a class="code" href="a00194.html#a484873c74138512e41bc50d17b7d955a">ndims</a>,solver-&gt;<a class="code" href="a00194.html#ae8f6d2fd6490d3153cb4133bf183a404">nvars</a>,solver-&gt;<a class="code" href="a00194.html#a38e0371f331cecbe63a77fa03e202afe">dim_local</a>); <a class="code" href="a00218.html#add9cf96ae374934d245a1dc1ab697a42">CHECKERR</a>(ierr);</div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;      }</div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;  </div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;    }</div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;  </div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;    solver-&gt;<a class="code" href="a00194.html#a6b5109ac1048aa203b8969b91e72c3af">boundary</a> = boundary;</div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;  </div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;    <span class="comment">/* each process calculates its own part of these boundaries */</span></div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;    <a class="code" href="a00218.html#ad6ab74942c9de13cf0b4c12eb0d91780">IERR</a> <a class="code" href="a00553.html#a33293e35159e6411e3574409bf7d90db">CalculateLocalExtent</a>(solver,mpi); <a class="code" href="a00218.html#add9cf96ae374934d245a1dc1ab697a42">CHECKERR</a>(ierr);</div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;  </div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;    <span class="comment">/* initialize function pointers for each boundary condition */</span></div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;    <span class="keywordflow">for</span> (nb = 0; nb &lt; solver-&gt;<a class="code" href="a00194.html#a3f9a55664d1c8f058828ae9f4de11906">nBoundaryZones</a>; nb++) {</div>
<div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;      <a class="code" href="a00218.html#ad6ab74942c9de13cf0b4c12eb0d91780">IERR</a> <a class="code" href="a00219.html#ac12085fd970427feca33543fd1257b15">BCInitialize</a>(&amp;boundary[nb]); <a class="code" href="a00218.html#add9cf96ae374934d245a1dc1ab697a42">CHECKERR</a>(ierr);</div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;    }</div>
<div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;</div>
<div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;  }</div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;</div>
<div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;  <span class="keywordflow">return</span>(0);</div>
<div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;}</div>
<div class="ttc" id="a00197_html_a6cfd95afd0afebd625b889fb6e58371c"><div class="ttname"><a href="a00197.html#a6cfd95afd0afebd625b889fb6e58371c">MPIVariables::rank</a></div><div class="ttdeci">int rank</div><div class="ttdef"><b>Definition:</b> <a href="a00197_source.html#l00025">mpivars_struct.h:25</a></div></div>
<div class="ttc" id="a00208_html_a4afd2c7b3eb8fda452474ebdbe71c8c0"><div class="ttname"><a href="a00208.html#a4afd2c7b3eb8fda452474ebdbe71c8c0">SimulationObject::mpi</a></div><div class="ttdeci">MPIVariables mpi</div><div class="ttdef"><b>Definition:</b> <a href="a00208_source.html#l00025">simulation_object.h:25</a></div></div>
<div class="ttc" id="a00553_html_a33293e35159e6411e3574409bf7d90db"><div class="ttname"><a href="a00553.html#a33293e35159e6411e3574409bf7d90db">CalculateLocalExtent</a></div><div class="ttdeci">static int CalculateLocalExtent(void *, void *)</div><div class="ttdef"><b>Definition:</b> <a href="a00553_source.html#l00327">InitializeBoundaries.c:327</a></div></div>
<div class="ttc" id="a00219_html_a6cd5a586de4ae1a3b73884d62f76bdee"><div class="ttname"><a href="a00219.html#a6cd5a586de4ae1a3b73884d62f76bdee">_SW_SLIP_WALL_</a></div><div class="ttdeci">#define _SW_SLIP_WALL_</div><div class="ttdef"><b>Definition:</b> <a href="a00219_source.html#l00053">boundaryconditions.h:53</a></div></div>
<div class="ttc" id="a00218_html_ad6ab74942c9de13cf0b4c12eb0d91780"><div class="ttname"><a href="a00218.html#ad6ab74942c9de13cf0b4c12eb0d91780">IERR</a></div><div class="ttdeci">#define IERR</div><div class="ttdef"><b>Definition:</b> <a href="a00218_source.html#l00012">basic.h:12</a></div></div>
<div class="ttc" id="a00208_html_a00626"><div class="ttname"><a href="a00208.html#a00626">SimulationObject</a></div><div class="ttdoc">Structure defining a simulation. </div><div class="ttdef"><b>Definition:</b> <a href="a00208_source.html#l00023">simulation_object.h:23</a></div></div>
<div class="ttc" id="a00185_html_a6aa65431c39a8d8177f35c338ddb7a0e"><div class="ttname"><a href="a00185.html#a6aa65431c39a8d8177f35c338ddb7a0e">DomainBoundary::DirichletValue</a></div><div class="ttdeci">double * DirichletValue</div><div class="ttdef"><b>Definition:</b> <a href="a00219_source.html#l00087">boundaryconditions.h:87</a></div></div>
<div class="ttc" id="a00219_html_adeb38801d1b832ce3eee3ebc1eed6263"><div class="ttname"><a href="a00219.html#adeb38801d1b832ce3eee3ebc1eed6263">_SUBSONIC_OUTFLOW_</a></div><div class="ttdeci">#define _SUBSONIC_OUTFLOW_</div><div class="ttdef"><b>Definition:</b> <a href="a00219_source.html#l00034">boundaryconditions.h:34</a></div></div>
<div class="ttc" id="a00218_html_a68f50121fb9a7daeaf60e50cdef82ef3"><div class="ttname"><a href="a00218.html#a68f50121fb9a7daeaf60e50cdef82ef3">_DECLARE_IERR_</a></div><div class="ttdeci">#define _DECLARE_IERR_</div><div class="ttdef"><b>Definition:</b> <a href="a00218_source.html#l00013">basic.h:13</a></div></div>
<div class="ttc" id="a00219_html_ab8248be9e215df26dfce851b1acc54ec"><div class="ttname"><a href="a00219.html#ab8248be9e215df26dfce851b1acc54ec">_SW_NOSLIP_WALL_</a></div><div class="ttdeci">#define _SW_NOSLIP_WALL_</div><div class="ttdef"><b>Definition:</b> <a href="a00219_source.html#l00055">boundaryconditions.h:55</a></div></div>
<div class="ttc" id="a00219_html_adba2024137894c96339af50efabe3771"><div class="ttname"><a href="a00219.html#adba2024137894c96339af50efabe3771">_SUBSONIC_INFLOW_</a></div><div class="ttdeci">#define _SUBSONIC_INFLOW_</div><div class="ttdef"><b>Definition:</b> <a href="a00219_source.html#l00032">boundaryconditions.h:32</a></div></div>
<div class="ttc" id="a00185_html_a0d0d92fab642e1d02a9de254e73a3f21"><div class="ttname"><a href="a00185.html#a0d0d92fab642e1d02a9de254e73a3f21">DomainBoundary::FlowVelocity</a></div><div class="ttdeci">double * FlowVelocity</div><div class="ttdef"><b>Definition:</b> <a href="a00219_source.html#l00096">boundaryconditions.h:96</a></div></div>
<div class="ttc" id="a00194_html_a3f9a55664d1c8f058828ae9f4de11906"><div class="ttname"><a href="a00194.html#a3f9a55664d1c8f058828ae9f4de11906">HyPar::nBoundaryZones</a></div><div class="ttdeci">int nBoundaryZones</div><div class="ttdef"><b>Definition:</b> <a href="a00224_source.html#l00149">hypar.h:149</a></div></div>
<div class="ttc" id="a00185_html_a48f59fc59e6a86d0b4aad842daea9106"><div class="ttname"><a href="a00185.html#a48f59fc59e6a86d0b4aad842daea9106">DomainBoundary::UnsteadyDirichletData</a></div><div class="ttdeci">double * UnsteadyDirichletData</div><div class="ttdef"><b>Definition:</b> <a href="a00219_source.html#l00091">boundaryconditions.h:91</a></div></div>
<div class="ttc" id="a00219_html_a9b20b4f17d0f550f5da42946cc8a5b4a"><div class="ttname"><a href="a00219.html#a9b20b4f17d0f550f5da42946cc8a5b4a">_TURBULENT_SUPERSONIC_INFLOW_</a></div><div class="ttdeci">#define _TURBULENT_SUPERSONIC_INFLOW_</div><div class="ttdef"><b>Definition:</b> <a href="a00219_source.html#l00045">boundaryconditions.h:45</a></div></div>
<div class="ttc" id="a00185_html_af7eeb4ff3f7c8bc22e0786ddbe62f16d"><div class="ttname"><a href="a00185.html#af7eeb4ff3f7c8bc22e0786ddbe62f16d">DomainBoundary::SpongeValue</a></div><div class="ttdeci">double * SpongeValue</div><div class="ttdef"><b>Definition:</b> <a href="a00219_source.html#l00088">boundaryconditions.h:88</a></div></div>
<div class="ttc" id="a00185_html_a7ea24a733beddff902459a07bf91ca67"><div class="ttname"><a href="a00185.html#a7ea24a733beddff902459a07bf91ca67">DomainBoundary::xmax</a></div><div class="ttdeci">double * xmax</div><div class="ttdef"><b>Definition:</b> <a href="a00219_source.html#l00079">boundaryconditions.h:79</a></div></div>
<div class="ttc" id="a00219_html_a0feed0764d1dafc0d4313a9b12cadd9d"><div class="ttname"><a href="a00219.html#a0feed0764d1dafc0d4313a9b12cadd9d">BCReadTemperatureData</a></div><div class="ttdeci">int BCReadTemperatureData(void *, void *, int, int, int *)</div><div class="ttdef"><b>Definition:</b> <a href="a00262_source.html#l00146">BCIO.c:146</a></div></div>
<div class="ttc" id="a00194_html_a40e3f67b1530d5ea4e913fc60b594802"><div class="ttname"><a href="a00194.html#a40e3f67b1530d5ea4e913fc60b594802">HyPar::isPeriodic</a></div><div class="ttdeci">int * isPeriodic</div><div class="ttdef"><b>Definition:</b> <a href="a00224_source.html#l00154">hypar.h:154</a></div></div>
<div class="ttc" id="a00234_html_ad408e5a44e863cca50112d1e2f728597"><div class="ttname"><a href="a00234.html#ad408e5a44e863cca50112d1e2f728597">MPIBroadcast_character</a></div><div class="ttdeci">int MPIBroadcast_character(char *, int, int, void *)</div><div class="ttdef"><b>Definition:</b> <a href="a00356_source.html#l00037">MPIBroadcast.c:37</a></div></div>
<div class="ttc" id="a00219_html_a6cc369236fbfe94bff52c55175cfaba7"><div class="ttname"><a href="a00219.html#a6cc369236fbfe94bff52c55175cfaba7">BCReadTurbulentInflowData</a></div><div class="ttdeci">int BCReadTurbulentInflowData(void *, void *, int, int, int *)</div><div class="ttdef"><b>Definition:</b> <a href="a00262_source.html#l00019">BCIO.c:19</a></div></div>
<div class="ttc" id="a00219_html_a65ffa4253dee762c65092abcf04ecdee"><div class="ttname"><a href="a00219.html#a65ffa4253dee762c65092abcf04ecdee">_PERIODIC_</a></div><div class="ttdeci">#define _PERIODIC_</div><div class="ttdef"><b>Definition:</b> <a href="a00219_source.html#l00012">boundaryconditions.h:12</a></div></div>
<div class="ttc" id="a00218_html_add9cf96ae374934d245a1dc1ab697a42"><div class="ttname"><a href="a00218.html#add9cf96ae374934d245a1dc1ab697a42">CHECKERR</a></div><div class="ttdeci">#define CHECKERR(ierr)</div><div class="ttdef"><b>Definition:</b> <a href="a00218_source.html#l00014">basic.h:14</a></div></div>
<div class="ttc" id="a00197_html_a00622"><div class="ttname"><a href="a00197.html#a00622">MPIVariables</a></div><div class="ttdoc">Structure of MPI-related variables. </div><div class="ttdef"><b>Definition:</b> <a href="a00197_source.html#l00024">mpivars_struct.h:24</a></div></div>
<div class="ttc" id="a00220_html_a3e3ad5aed581d9ae563190c365dadc41"><div class="ttname"><a href="a00220.html#a3e3ad5aed581d9ae563190c365dadc41">GetStringFromInteger</a></div><div class="ttdeci">void GetStringFromInteger(int, char *, int)</div><div class="ttdef"><b>Definition:</b> <a href="a00278_source.html#l00015">CommonFunctions.c:15</a></div></div>
<div class="ttc" id="a00197_html_adad7a6f85831f3ac84d854b6c80aef43"><div class="ttname"><a href="a00197.html#adad7a6f85831f3ac84d854b6c80aef43">MPIVariables::world</a></div><div class="ttdeci">MPI_Comm world</div><div class="ttdef"><b>Definition:</b> <a href="a00197_source.html#l00037">mpivars_struct.h:37</a></div></div>
<div class="ttc" id="a00219_html_ab02c004c9707df0589311375014dc666"><div class="ttname"><a href="a00219.html#ab02c004c9707df0589311375014dc666">_SPONGE_</a></div><div class="ttdeci">#define _SPONGE_</div><div class="ttdef"><b>Definition:</b> <a href="a00219_source.html#l00020">boundaryconditions.h:20</a></div></div>
<div class="ttc" id="a00185_html_a70b5e28b5bc3d1b63a7435c5fe50b837"><div class="ttname"><a href="a00185.html#a70b5e28b5bc3d1b63a7435c5fe50b837">DomainBoundary::dim</a></div><div class="ttdeci">int dim</div><div class="ttdef"><b>Definition:</b> <a href="a00219_source.html#l00073">boundaryconditions.h:73</a></div></div>
<div class="ttc" id="a00208_html_a523947ce4fa7128c4c767163953253b9"><div class="ttname"><a href="a00208.html#a523947ce4fa7128c4c767163953253b9">SimulationObject::solver</a></div><div class="ttdeci">HyPar solver</div><div class="ttdef"><b>Definition:</b> <a href="a00208_source.html#l00026">simulation_object.h:26</a></div></div>
<div class="ttc" id="a00185_html_a1e51e79041d5a3dddffb503277703568"><div class="ttname"><a href="a00185.html#a1e51e79041d5a3dddffb503277703568">DomainBoundary::xmin</a></div><div class="ttdeci">double * xmin</div><div class="ttdef"><b>Definition:</b> <a href="a00219_source.html#l00077">boundaryconditions.h:77</a></div></div>
<div class="ttc" id="a00194_html_ae8f6d2fd6490d3153cb4133bf183a404"><div class="ttname"><a href="a00194.html#ae8f6d2fd6490d3153cb4133bf183a404">HyPar::nvars</a></div><div class="ttdeci">int nvars</div><div class="ttdef"><b>Definition:</b> <a href="a00224_source.html#l00029">hypar.h:29</a></div></div>
<div class="ttc" id="a00219_html_af3a9f3ba15bc914ed0a88295aee147e8"><div class="ttname"><a href="a00219.html#af3a9f3ba15bc914ed0a88295aee147e8">_SLIP_WALL_</a></div><div class="ttdeci">#define _SLIP_WALL_</div><div class="ttdef"><b>Definition:</b> <a href="a00219_source.html#l00028">boundaryconditions.h:28</a></div></div>
<div class="ttc" id="a00234_html_acd7957559b9206224c7da3cab4f22b27"><div class="ttname"><a href="a00234.html#acd7957559b9206224c7da3cab4f22b27">MPIBroadcast_integer</a></div><div class="ttdeci">int MPIBroadcast_integer(int *, int, int, void *)</div><div class="ttdef"><b>Definition:</b> <a href="a00356_source.html#l00023">MPIBroadcast.c:23</a></div></div>
<div class="ttc" id="a00197_html_af40a5a3066fdb53a47e4627071abc2bc"><div class="ttname"><a href="a00197.html#af40a5a3066fdb53a47e4627071abc2bc">MPIVariables::bcperiodic</a></div><div class="ttdeci">int * bcperiodic</div><div class="ttdef"><b>Definition:</b> <a href="a00197_source.html#l00031">mpivars_struct.h:31</a></div></div>
<div class="ttc" id="a00219_html_a8e1e1ee6a2a121618e124cad69c8739c"><div class="ttname"><a href="a00219.html#a8e1e1ee6a2a121618e124cad69c8739c">_THERMAL_NOSLIP_WALL_</a></div><div class="ttdeci">#define _THERMAL_NOSLIP_WALL_</div><div class="ttdef"><b>Definition:</b> <a href="a00219_source.html#l00026">boundaryconditions.h:26</a></div></div>
<div class="ttc" id="a00185_html_ac3b478217419275ad063182f69cb543d"><div class="ttname"><a href="a00185.html#ac3b478217419275ad063182f69cb543d">DomainBoundary::UnsteadyDirichletSize</a></div><div class="ttdeci">int * UnsteadyDirichletSize</div><div class="ttdef"><b>Definition:</b> <a href="a00219_source.html#l00090">boundaryconditions.h:90</a></div></div>
<div class="ttc" id="a00194_html_a6b5109ac1048aa203b8969b91e72c3af"><div class="ttname"><a href="a00194.html#a6b5109ac1048aa203b8969b91e72c3af">HyPar::boundary</a></div><div class="ttdeci">void * boundary</div><div class="ttdef"><b>Definition:</b> <a href="a00224_source.html#l00151">hypar.h:151</a></div></div>
<div class="ttc" id="a00219_html_aac7250bf34e60e7df688d3cf7355855c"><div class="ttname"><a href="a00219.html#aac7250bf34e60e7df688d3cf7355855c">_SUBSONIC_AMBIVALENT_</a></div><div class="ttdeci">#define _SUBSONIC_AMBIVALENT_</div><div class="ttdef"><b>Definition:</b> <a href="a00219_source.html#l00039">boundaryconditions.h:39</a></div></div>
<div class="ttc" id="a00219_html_a7b8553c8fd765568f7355cf32b93b20d"><div class="ttname"><a href="a00219.html#a7b8553c8fd765568f7355cf32b93b20d">_DIRICHLET_</a></div><div class="ttdeci">#define _DIRICHLET_</div><div class="ttdef"><b>Definition:</b> <a href="a00219_source.html#l00016">boundaryconditions.h:16</a></div></div>
<div class="ttc" id="a00197_html_a0be0f30a83bc3f3d9f6ee3a36bbf2716"><div class="ttname"><a href="a00197.html#a0be0f30a83bc3f3d9f6ee3a36bbf2716">MPIVariables::iproc</a></div><div class="ttdeci">int * iproc</div><div class="ttdef"><b>Definition:</b> <a href="a00197_source.html#l00027">mpivars_struct.h:27</a></div></div>
<div class="ttc" id="a00194_html"><div class="ttname"><a href="a00194.html">HyPar</a></div><div class="ttdoc">Structure containing all solver-specific variables and functions. </div><div class="ttdef"><b>Definition:</b> <a href="a00224_source.html#l00023">hypar.h:23</a></div></div>
<div class="ttc" id="a00234_html_a45dcb265863a65d862bb16222e7e623c"><div class="ttname"><a href="a00234.html#a45dcb265863a65d862bb16222e7e623c">MPIBroadcast_double</a></div><div class="ttdeci">int MPIBroadcast_double(double *, int, int, void *)</div><div class="ttdef"><b>Definition:</b> <a href="a00356_source.html#l00009">MPIBroadcast.c:9</a></div></div>
<div class="ttc" id="a00219_html_a5c9f9f3c97682664b0fe253e10863b57"><div class="ttname"><a href="a00219.html#a5c9f9f3c97682664b0fe253e10863b57">_SUPERSONIC_INFLOW_</a></div><div class="ttdeci">#define _SUPERSONIC_INFLOW_</div><div class="ttdef"><b>Definition:</b> <a href="a00219_source.html#l00041">boundaryconditions.h:41</a></div></div>
<div class="ttc" id="a00194_html_a484873c74138512e41bc50d17b7d955a"><div class="ttname"><a href="a00194.html#a484873c74138512e41bc50d17b7d955a">HyPar::ndims</a></div><div class="ttdeci">int ndims</div><div class="ttdef"><b>Definition:</b> <a href="a00224_source.html#l00026">hypar.h:26</a></div></div>
<div class="ttc" id="a00219_html_affb6a9c452f92435e738bd59b9c98935"><div class="ttname"><a href="a00219.html#affb6a9c452f92435e738bd59b9c98935">_NOSLIP_WALL_</a></div><div class="ttdeci">#define _NOSLIP_WALL_</div><div class="ttdef"><b>Definition:</b> <a href="a00219_source.html#l00024">boundaryconditions.h:24</a></div></div>
<div class="ttc" id="a00219_html_a1fb5767ea5e8c4f48969ff25eae1ddaf"><div class="ttname"><a href="a00219.html#a1fb5767ea5e8c4f48969ff25eae1ddaf">_THERMAL_SLIP_WALL_</a></div><div class="ttdeci">#define _THERMAL_SLIP_WALL_</div><div class="ttdef"><b>Definition:</b> <a href="a00219_source.html#l00030">boundaryconditions.h:30</a></div></div>
<div class="ttc" id="a00218_html_a51efea86a4d76d1259893f606b776573"><div class="ttname"><a href="a00218.html#a51efea86a4d76d1259893f606b776573">_MAX_STRING_SIZE_</a></div><div class="ttdeci">#define _MAX_STRING_SIZE_</div><div class="ttdef"><b>Definition:</b> <a href="a00218_source.html#l00010">basic.h:10</a></div></div>
<div class="ttc" id="a00194_html_a38e0371f331cecbe63a77fa03e202afe"><div class="ttname"><a href="a00194.html#a38e0371f331cecbe63a77fa03e202afe">HyPar::dim_local</a></div><div class="ttdeci">int * dim_local</div><div class="ttdef"><b>Definition:</b> <a href="a00224_source.html#l00035">hypar.h:35</a></div></div>
<div class="ttc" id="a00185_html"><div class="ttname"><a href="a00185.html">DomainBoundary</a></div><div class="ttdoc">Structure containing the variables and function pointers defining a boundary. </div><div class="ttdef"><b>Definition:</b> <a href="a00219_source.html#l00068">boundaryconditions.h:68</a></div></div>
<div class="ttc" id="a00219_html_ac12085fd970427feca33543fd1257b15"><div class="ttname"><a href="a00219.html#ac12085fd970427feca33543fd1257b15">BCInitialize</a></div><div class="ttdeci">int BCInitialize(void *)</div><div class="ttdef"><b>Definition:</b> <a href="a00261_source.html#l00012">BCInitialize.c:12</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a6ac8578eb0216a84307bfb3b2fba816f"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int InitializeImmersedBoundaries </td>
          <td>(</td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>s</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>nsims</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Initialize the immersed boundary conditions</p>
<p>Initialize the immersed boundaries, if present.</p>
<ul>
<li>Read in immersed body from STL file.</li>
<li>Allocate and set up <a class="el" href="a00181.html#a00620" title="Structure containing variables for immersed boundary implementation. ">ImmersedBoundary</a> object.</li>
<li>Identify blanked-out grid points based on immersed body geometry.</li>
<li>Identify and make a list of immersed boundary points on each rank.</li>
<li>For each immersed boundary point, find the "nearest" facet. </li>
</ul>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">s</td><td>Array of simulation objects of type <a class="el" href="a00208.html#a00626" title="Structure defining a simulation. ">SimulationObject</a> </td></tr>
    <tr><td class="paramname">nsims</td><td>Number of simulation objects </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="a00554_source.html#l00022">22</a> of file <a class="el" href="a00554_source.html">InitializeImmersedBoundaries.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;{</div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;  <a class="code" href="a00208.html#a00626">SimulationObject</a>* simobj = (<a class="code" href="a00208.html#a00626">SimulationObject</a>*) s;</div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;  <span class="keywordtype">int</span> n;</div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;</div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;  <span class="keywordflow">for</span> (n = 0; n &lt; nsims; n++) {</div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;</div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;    <a class="code" href="a00194.html">HyPar</a>        *solver = &amp;(simobj[n].<a class="code" href="a00208.html#a523947ce4fa7128c4c767163953253b9">solver</a>);</div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;    <a class="code" href="a00197.html#a00622">MPIVariables</a> *mpi    = &amp;(simobj[n].<a class="code" href="a00208.html#a4afd2c7b3eb8fda452474ebdbe71c8c0">mpi</a>);</div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;</div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;    <a class="code" href="a00181.html#a00620">ImmersedBoundary</a> *ib       = NULL;</div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;    <a class="code" href="a00181.html#a00607">Body3D</a>           *body     = NULL;</div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;</div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;    <span class="keywordtype">int</span> stat, d, ndims = solver-&gt;<a class="code" href="a00194.html#a484873c74138512e41bc50d17b7d955a">ndims</a>;</div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;</div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;    <span class="keywordflow">if</span> ((!solver-&gt;<a class="code" href="a00194.html#ae83b1b0117b6a805ead2e4728945814c">flag_ib</a>) || (ndims != <a class="code" href="a00181.html#a0f59ba2c552bae2f35a03ce3964a2b4a">_IB_NDIMS_</a>)) {</div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;      solver-&gt;<a class="code" href="a00194.html#a8419c1760256467c117ef5932b943259">ib</a> = NULL;</div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;      <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;    }</div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;</div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;    <span class="comment">/* Read in immersed body from file */</span></div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;    <a class="code" href="a00181.html#a4246de81fa9366c4e377b927c9cfd2ed">IBReadBodySTL</a>(&amp;body,solver-&gt;<a class="code" href="a00194.html#a43ee3672350b4fd385871b6512e5d47b">ib_filename</a>,mpi,&amp;stat);</div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;    <span class="keywordflow">if</span> (stat) {</div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;      <span class="keywordflow">if</span> (!mpi-&gt;<a class="code" href="a00197.html#a6cfd95afd0afebd625b889fb6e58371c">rank</a>) {</div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;        fprintf(stderr,<span class="stringliteral">&quot;Error in InitializeImmersedBoundaries(): Unable to &quot;</span>);</div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;        fprintf(stderr,<span class="stringliteral">&quot;read immersed body from file %s.\n&quot;</span>,solver-&gt;<a class="code" href="a00194.html#a43ee3672350b4fd385871b6512e5d47b">ib_filename</a>);</div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;      }</div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;      solver-&gt;<a class="code" href="a00194.html#ae83b1b0117b6a805ead2e4728945814c">flag_ib</a> = 0;</div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;      solver-&gt;<a class="code" href="a00194.html#a8419c1760256467c117ef5932b943259">ib</a> = NULL;</div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;      <span class="keywordflow">return</span>(1);</div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;    }</div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;    <a class="code" href="a00181.html#a59296c4f43deabbc6a9b511ba559a4b4">IBComputeBoundingBox</a>(body);</div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;</div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;    <span class="comment">/* allocate immersed boundary object and set it up */</span></div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;    ib = (<a class="code" href="a00181.html#a00620">ImmersedBoundary</a>*) calloc (1, <span class="keyword">sizeof</span>(<a class="code" href="a00181.html#a00620">ImmersedBoundary</a>));</div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;    ib-&gt;<a class="code" href="a00181.html#a97eab6d709b80585fe9e8a54b1e3da27">tolerance</a> = 1e-12;</div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;    ib-&gt;<a class="code" href="a00181.html#a9ea1a8f5ef3e6d20b362385e1288c72c">delta</a>     = 1e-6;</div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;    ib-&gt;<a class="code" href="a00181.html#a5a34c6ed89d3769fb1200fdfbdc8ae33">itr_max</a>   = 500;</div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;    ib-&gt;<a class="code" href="a00181.html#af858f0e9bc4a6cb1c16ad2931cf4b43d">body</a>      = body;</div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;    solver-&gt;<a class="code" href="a00194.html#a8419c1760256467c117ef5932b943259">ib</a>    = ib;</div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;</div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;    <span class="keywordtype">int</span>     offset_global, offset_local,</div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;            *dim_local  = solver-&gt;<a class="code" href="a00194.html#a38e0371f331cecbe63a77fa03e202afe">dim_local</a>,</div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;            *dim_global = solver-&gt;<a class="code" href="a00194.html#aa989ebb755986852177779cdf7bd8c85">dim_global</a>,</div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;            ghosts      = solver-&gt;<a class="code" href="a00194.html#aafc992b5fa79d5a4036024615d03bce6">ghosts</a>,</div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;            size        = dim_global[0] + dim_global[1] + dim_global[2],</div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;            count       = 0;</div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;    <span class="keywordtype">double</span>  *Xg         = (<span class="keywordtype">double</span>*) calloc(size,<span class="keyword">sizeof</span>(<span class="keywordtype">double</span>));</div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;</div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;    <span class="comment">/* assemble the global grid on rank 0 */</span></div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;    offset_global = offset_local = 0;</div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;    <span class="keywordflow">for</span> (d=0; d&lt;ndims; d++) {</div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;      <a class="code" href="a00218.html#ad6ab74942c9de13cf0b4c12eb0d91780">IERR</a> <a class="code" href="a00234.html#ac4c9e0736d7419f96307c6e6298d3f45">MPIGatherArray1D</a>(mpi,(mpi-&gt;<a class="code" href="a00197.html#a6cfd95afd0afebd625b889fb6e58371c">rank</a>?NULL:&amp;Xg[offset_global]),</div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;                            &amp;solver-&gt;<a class="code" href="a00194.html#a711aad4cbe735871dd9e91ab575c878b">x</a>[offset_local+ghosts],</div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;                            mpi-&gt;<a class="code" href="a00197.html#a481013ba007a99a4237cde5eeb3c9a29">is</a>[d],mpi-&gt;<a class="code" href="a00197.html#a7602de5ebb1b59ec35217e78a35a531e">ie</a>[d],dim_local[d],0); <a class="code" href="a00218.html#add9cf96ae374934d245a1dc1ab697a42">CHECKERR</a>(ierr);</div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;      offset_global += dim_global[d];</div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;      offset_local  += dim_local [d] + 2*ghosts;</div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;    }</div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;    <span class="comment">/* send the global grid to other ranks */</span></div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;    <a class="code" href="a00234.html#a45dcb265863a65d862bb16222e7e623c">MPIBroadcast_double</a>(Xg,size,0,&amp;mpi-&gt;<a class="code" href="a00197.html#adad7a6f85831f3ac84d854b6c80aef43">world</a>);</div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;  </div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;    <span class="comment">/* identify whether this is a 3D or &quot;pseudo-2D&quot; simulation */</span></div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;    <a class="code" href="a00181.html#aafa48e01069cbd264052995cffeb6ea0">IBIdentifyMode</a>(Xg,dim_global,solver-&gt;<a class="code" href="a00194.html#a8419c1760256467c117ef5932b943259">ib</a>);</div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;  </div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;    <span class="comment">/* identify grid points inside the immersed body */</span></div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;    <span class="keywordtype">int</span> count_inside_body = 0;</div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;    count = <a class="code" href="a00181.html#a9b7a52f65913c3f33f902400fa18239d">IBIdentifyBody</a>(solver-&gt;<a class="code" href="a00194.html#a8419c1760256467c117ef5932b943259">ib</a>,dim_global,dim_local,ghosts,mpi,Xg,solver-&gt;<a class="code" href="a00194.html#a267ef7e03dbe9dd4440dee2fdf48619a">iblank</a>);</div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;    <a class="code" href="a00234.html#a25c7df0ff2e4f81a64368ea72894a4f8">MPISum_integer</a>(&amp;count_inside_body,&amp;count,1,&amp;mpi-&gt;<a class="code" href="a00197.html#adad7a6f85831f3ac84d854b6c80aef43">world</a>);</div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;    free(Xg);</div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;</div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;    <span class="comment">/* At ghost points corresponding to the physical boundary, extrapolate from the interior </span></div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;<span class="comment">       (this should also work for bodies that are adjacent to physical boundaries). At interior</span></div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;<span class="comment">       (MPI) boundaries, exchange iblank across MPI ranks.</span></div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;<span class="comment">    */</span></div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;    <span class="keywordtype">int</span> indexb[ndims], indexi[ndims], bounds[ndims], offset[ndims];</div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;    <span class="keywordflow">for</span> (d = 0; d &lt; ndims; d++) {</div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;      <span class="comment">/* left boundary */</span></div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;      <span class="keywordflow">if</span> (!mpi-&gt;<a class="code" href="a00197.html#aa3c28612a64b8a97bde66b720e15c700">ip</a>[d]) {</div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;        <a class="code" href="a00217.html#a89e8330d9e06dd0666c50833628a125c">_ArrayCopy1D_</a>(dim_local,bounds,ndims); bounds[d] = ghosts;</div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;        <a class="code" href="a00217.html#a2b2826031c0cd92495ab351d3e599fc5">_ArraySetValue_</a>(offset,ndims,0); offset[d] = -ghosts;</div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;        <span class="keywordtype">int</span> done = 0; <a class="code" href="a00217.html#a2b2826031c0cd92495ab351d3e599fc5">_ArraySetValue_</a>(indexb,ndims,0);</div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;        <span class="keywordflow">while</span> (!done) {</div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;          <a class="code" href="a00217.html#a89e8330d9e06dd0666c50833628a125c">_ArrayCopy1D_</a>(indexb,indexi,ndims); indexi[d] = ghosts-1-indexb[d];</div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;          <span class="keywordtype">int</span> p1; <a class="code" href="a00217.html#a0739cb538f4d301fad3b45059ddd0738">_ArrayIndex1DWO_</a>(ndims,dim_local,indexb,offset,ghosts,p1);</div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;          <span class="keywordtype">int</span> p2; <a class="code" href="a00217.html#afbb862a2fdf5b72b1f9ace42f64b556f">_ArrayIndex1D_</a>  (ndims,dim_local,indexi,ghosts,p2);</div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;          solver-&gt;<a class="code" href="a00194.html#a267ef7e03dbe9dd4440dee2fdf48619a">iblank</a>[p1] = solver-&gt;<a class="code" href="a00194.html#a267ef7e03dbe9dd4440dee2fdf48619a">iblank</a>[p2];</div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;          <a class="code" href="a00217.html#ac5ec1371623f11d03b0f42adaa24acbc">_ArrayIncrementIndex_</a>(ndims,bounds,indexb,done);</div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;        }</div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;      }</div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;      <span class="comment">/* right boundary */</span></div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;      <span class="keywordflow">if</span> (mpi-&gt;<a class="code" href="a00197.html#aa3c28612a64b8a97bde66b720e15c700">ip</a>[d] == mpi-&gt;<a class="code" href="a00197.html#a0be0f30a83bc3f3d9f6ee3a36bbf2716">iproc</a>[d]-1) {</div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;        <a class="code" href="a00217.html#a89e8330d9e06dd0666c50833628a125c">_ArrayCopy1D_</a>(dim_local,bounds,ndims); bounds[d] = ghosts;</div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;        <a class="code" href="a00217.html#a2b2826031c0cd92495ab351d3e599fc5">_ArraySetValue_</a>(offset,ndims,0); offset[d] = dim_local[d];</div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;        <span class="keywordtype">int</span> done = 0; <a class="code" href="a00217.html#a2b2826031c0cd92495ab351d3e599fc5">_ArraySetValue_</a>(indexb,ndims,0);</div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;        <span class="keywordflow">while</span> (!done) {</div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;          <a class="code" href="a00217.html#a89e8330d9e06dd0666c50833628a125c">_ArrayCopy1D_</a>(indexb,indexi,ndims); indexi[d] = dim_local[d]-1-indexb[d];</div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;          <span class="keywordtype">int</span> p1; <a class="code" href="a00217.html#a0739cb538f4d301fad3b45059ddd0738">_ArrayIndex1DWO_</a>(ndims,dim_local,indexb,offset,ghosts,p1);</div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;          <span class="keywordtype">int</span> p2; <a class="code" href="a00217.html#afbb862a2fdf5b72b1f9ace42f64b556f">_ArrayIndex1D_</a>  (ndims,dim_local,indexi,ghosts,p2);</div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;          solver-&gt;<a class="code" href="a00194.html#a267ef7e03dbe9dd4440dee2fdf48619a">iblank</a>[p1] = solver-&gt;<a class="code" href="a00194.html#a267ef7e03dbe9dd4440dee2fdf48619a">iblank</a>[p2];</div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;          <a class="code" href="a00217.html#ac5ec1371623f11d03b0f42adaa24acbc">_ArrayIncrementIndex_</a>(ndims,bounds,indexb,done);</div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;        }</div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;      }</div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;    }</div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;    <a class="code" href="a00234.html#a60ace5964c051fa481e6a1e6f1ef75d7">MPIExchangeBoundariesnD</a>(ndims,1,dim_local,ghosts,mpi,solver-&gt;<a class="code" href="a00194.html#a267ef7e03dbe9dd4440dee2fdf48619a">iblank</a>);</div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;  </div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;    <span class="comment">/* identify and create a list of immersed boundary points on each rank */</span></div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;    <span class="keywordtype">int</span> count_boundary_points = 0;</div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;    count = <a class="code" href="a00181.html#af70e331f0896000fe1b0edf69676296c">IBIdentifyBoundary</a>(solver-&gt;<a class="code" href="a00194.html#a8419c1760256467c117ef5932b943259">ib</a>,mpi,dim_local,ghosts,solver-&gt;<a class="code" href="a00194.html#a267ef7e03dbe9dd4440dee2fdf48619a">iblank</a>);</div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;    <a class="code" href="a00234.html#a25c7df0ff2e4f81a64368ea72894a4f8">MPISum_integer</a>(&amp;count_boundary_points,&amp;count,1,&amp;mpi-&gt;<a class="code" href="a00197.html#adad7a6f85831f3ac84d854b6c80aef43">world</a>);</div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;  </div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;    <span class="comment">/* find the nearest facet for each immersed boundary point */</span></div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;    <span class="keywordtype">double</span> ld = 0, xmin, xmax, ymin, ymax, zmin, zmax;</div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;    <a class="code" href="a00218.html#a9aa9bad8531d6733731a850ccc471a42">_GetCoordinate_</a>(0,0             ,dim_local,ghosts,solver-&gt;<a class="code" href="a00194.html#a711aad4cbe735871dd9e91ab575c878b">x</a>,xmin);</div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;    <a class="code" href="a00218.html#a9aa9bad8531d6733731a850ccc471a42">_GetCoordinate_</a>(0,dim_local[0]-1,dim_local,ghosts,solver-&gt;<a class="code" href="a00194.html#a711aad4cbe735871dd9e91ab575c878b">x</a>,xmax);</div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;    <a class="code" href="a00218.html#a9aa9bad8531d6733731a850ccc471a42">_GetCoordinate_</a>(1,0             ,dim_local,ghosts,solver-&gt;<a class="code" href="a00194.html#a711aad4cbe735871dd9e91ab575c878b">x</a>,ymin);</div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;    <a class="code" href="a00218.html#a9aa9bad8531d6733731a850ccc471a42">_GetCoordinate_</a>(1,dim_local[1]-1,dim_local,ghosts,solver-&gt;<a class="code" href="a00194.html#a711aad4cbe735871dd9e91ab575c878b">x</a>,ymax);</div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;    <a class="code" href="a00218.html#a9aa9bad8531d6733731a850ccc471a42">_GetCoordinate_</a>(2,0             ,dim_local,ghosts,solver-&gt;<a class="code" href="a00194.html#a711aad4cbe735871dd9e91ab575c878b">x</a>,zmin);</div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;    <a class="code" href="a00218.html#a9aa9bad8531d6733731a850ccc471a42">_GetCoordinate_</a>(2,dim_local[2]-1,dim_local,ghosts,solver-&gt;<a class="code" href="a00194.html#a711aad4cbe735871dd9e91ab575c878b">x</a>,zmax);</div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;    <span class="keywordtype">double</span> xlen = xmax - xmin;</div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;    <span class="keywordtype">double</span> ylen = ymax - ymin;</div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;    <span class="keywordtype">double</span> zlen = zmax - zmin;</div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;    ld = <a class="code" href="a00229.html#aa0d45e1e67c5cacf5c9251fcd90a971b">max3</a>(xlen,ylen,zlen);</div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;    count = <a class="code" href="a00181.html#ac877ecf361b72916a491e4759f8af040">IBNearestFacetNormal</a>(solver-&gt;<a class="code" href="a00194.html#a8419c1760256467c117ef5932b943259">ib</a>,mpi,solver-&gt;<a class="code" href="a00194.html#a711aad4cbe735871dd9e91ab575c878b">x</a>,ld,dim_local,ghosts);</div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;    <span class="keywordflow">if</span> (count) {</div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;      fprintf(stderr, <span class="stringliteral">&quot;Error in InitializeImmersedBoundaries():\n&quot;</span>);</div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;      fprintf(stderr, <span class="stringliteral">&quot;  IBNearestFacetNormal() returned with error code %d on rank %d.\n&quot;</span>,</div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;              count, mpi-&gt;<a class="code" href="a00197.html#a6cfd95afd0afebd625b889fb6e58371c">rank</a>);</div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;      <span class="keywordflow">return</span>(count);</div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;    }</div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;</div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;    <span class="comment">/* For the immersed boundary points, find the interior points for extrapolation,</span></div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;<span class="comment">       and compute their interpolation coefficients */</span></div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;    count = <a class="code" href="a00181.html#a0175a349146a94c667dc90f2bffdb7ef">IBInterpCoeffs</a>(solver-&gt;<a class="code" href="a00194.html#a8419c1760256467c117ef5932b943259">ib</a>,mpi,solver-&gt;<a class="code" href="a00194.html#a711aad4cbe735871dd9e91ab575c878b">x</a>,dim_local,ghosts,solver-&gt;<a class="code" href="a00194.html#a267ef7e03dbe9dd4440dee2fdf48619a">iblank</a>);</div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;    <span class="keywordflow">if</span> (count) {</div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;      fprintf(stderr, <span class="stringliteral">&quot;Error in InitializeImmersedBoundaries():\n&quot;</span>);</div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;      fprintf(stderr, <span class="stringliteral">&quot;  IBInterpCoeffs() returned with error code %d on rank %d.\n&quot;</span>,</div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;              count, mpi-&gt;<a class="code" href="a00197.html#a6cfd95afd0afebd625b889fb6e58371c">rank</a>);</div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;      <span class="keywordflow">return</span>(count);</div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;    }</div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;  </div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;    <span class="comment">/* Create facet mapping */</span>;</div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;    count = <a class="code" href="a00181.html#a0575b5233bc22af6797e2c7b0d95f469">IBCreateFacetMapping</a>(ib,mpi,solver-&gt;<a class="code" href="a00194.html#a711aad4cbe735871dd9e91ab575c878b">x</a>,dim_local,ghosts);</div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;    <span class="keywordflow">if</span> (count) {</div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;      fprintf(stderr, <span class="stringliteral">&quot;Error in InitializeImmersedBoundaries():\n&quot;</span>);</div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;      fprintf(stderr, <span class="stringliteral">&quot;  IBCreateFacetMapping() returned with error code %d on rank %d.\n&quot;</span>,</div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;              count, mpi-&gt;<a class="code" href="a00197.html#a6cfd95afd0afebd625b889fb6e58371c">rank</a>);</div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;      <span class="keywordflow">return</span>(count);</div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;    }</div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;    </div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;    <span class="comment">/* Done */</span></div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;    <span class="keywordflow">if</span> (!mpi-&gt;<a class="code" href="a00197.html#a6cfd95afd0afebd625b889fb6e58371c">rank</a>) {</div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;      <span class="keywordtype">double</span> percentage;</div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;      printf(<span class="stringliteral">&quot;Immersed body read from %s:\n&quot;</span>,solver-&gt;<a class="code" href="a00194.html#a43ee3672350b4fd385871b6512e5d47b">ib_filename</a>);</div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;      <span class="keywordflow">if</span> (nsims &gt; 1) printf(<span class="stringliteral">&quot;For domain %d,\n&quot;</span>, n);</div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;      printf(<span class="stringliteral">&quot;    Number of facets: %d\n    Bounding box: [%3.1f,%3.1lf] X [%3.1f,%3.1lf] X [%3.1f,%3.1lf]\n&quot;</span>,</div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;             body-&gt;<a class="code" href="a00181.html#afd755b081f4d9ca3558ef9ca9f3c35d0">nfacets</a>,body-&gt;<a class="code" href="a00181.html#ab5bbe897a0c25c58341c216a1b31fbbf">xmin</a>,body-&gt;<a class="code" href="a00181.html#a30554afc6599846bcd01cbf986d0998a">xmax</a>,body-&gt;<a class="code" href="a00181.html#a8c17b15efd6e0337c596d98616e9b9da">ymin</a>,body-&gt;<a class="code" href="a00181.html#afc6ae6b11b9521d908c52e4fb3ea09ce">ymax</a>,body-&gt;<a class="code" href="a00181.html#aaea53ab3c236de8e4f167c3807d35b47">zmin</a>,body-&gt;<a class="code" href="a00181.html#ade09ae0d27b0b7a2d1e886efc6d1a500">zmax</a>);</div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;      percentage = ((double)count_inside_body)/((double)solver-&gt;<a class="code" href="a00194.html#a4e67f54563a3c4ff005dfaf0130f957c">npoints_global</a>)*100.0;</div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;      printf(<span class="stringliteral">&quot;    Number of grid points inside immersed body: %d (%4.1f%%).\n&quot;</span>,count_inside_body,percentage);</div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;      percentage = ((double)count_boundary_points)/((double)solver-&gt;<a class="code" href="a00194.html#a4e67f54563a3c4ff005dfaf0130f957c">npoints_global</a>)*100.0;</div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;      printf(<span class="stringliteral">&quot;    Number of immersed boundary points        : %d (%4.1f%%).\n&quot;</span>,count_boundary_points,percentage);</div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;      printf(<span class="stringliteral">&quot;    Immersed body simulation mode             : %s.\n&quot;</span>, ib-&gt;<a class="code" href="a00181.html#a935394e510d17282c5697cd76a6e2667">mode</a>);</div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;    }</div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;</div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;  }</div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;</div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;  <span class="keywordflow">return</span>(0);</div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;}</div>
<div class="ttc" id="a00234_html_a25c7df0ff2e4f81a64368ea72894a4f8"><div class="ttname"><a href="a00234.html#a25c7df0ff2e4f81a64368ea72894a4f8">MPISum_integer</a></div><div class="ttdeci">int MPISum_integer(int *, int *, int, void *)</div><div class="ttdef"><b>Definition:</b> <a href="a00373_source.html#l00016">MPISum.c:16</a></div></div>
<div class="ttc" id="a00197_html_a6cfd95afd0afebd625b889fb6e58371c"><div class="ttname"><a href="a00197.html#a6cfd95afd0afebd625b889fb6e58371c">MPIVariables::rank</a></div><div class="ttdeci">int rank</div><div class="ttdef"><b>Definition:</b> <a href="a00197_source.html#l00025">mpivars_struct.h:25</a></div></div>
<div class="ttc" id="a00181_html_aaea53ab3c236de8e4f167c3807d35b47"><div class="ttname"><a href="a00181.html#aaea53ab3c236de8e4f167c3807d35b47">Body3D::zmin</a></div><div class="ttdeci">double zmin</div><div class="ttdef"><b>Definition:</b> <a href="a00181_source.html#l00104">immersedboundaries.h:104</a></div></div>
<div class="ttc" id="a00217_html_a89e8330d9e06dd0666c50833628a125c"><div class="ttname"><a href="a00217.html#a89e8330d9e06dd0666c50833628a125c">_ArrayCopy1D_</a></div><div class="ttdeci">#define _ArrayCopy1D_(x, y, size)</div><div class="ttdef"><b>Definition:</b> <a href="a00217_source.html#l00318">arrayfunctions.h:318</a></div></div>
<div class="ttc" id="a00194_html_a267ef7e03dbe9dd4440dee2fdf48619a"><div class="ttname"><a href="a00194.html#a267ef7e03dbe9dd4440dee2fdf48619a">HyPar::iblank</a></div><div class="ttdeci">double * iblank</div><div class="ttdef"><b>Definition:</b> <a href="a00224_source.html#l00412">hypar.h:412</a></div></div>
<div class="ttc" id="a00208_html_a4afd2c7b3eb8fda452474ebdbe71c8c0"><div class="ttname"><a href="a00208.html#a4afd2c7b3eb8fda452474ebdbe71c8c0">SimulationObject::mpi</a></div><div class="ttdeci">MPIVariables mpi</div><div class="ttdef"><b>Definition:</b> <a href="a00208_source.html#l00025">simulation_object.h:25</a></div></div>
<div class="ttc" id="a00181_html_a00607"><div class="ttname"><a href="a00181.html#a00607">Body3D</a></div><div class="ttdoc">Structure defining a body. </div><div class="ttdef"><b>Definition:</b> <a href="a00181_source.html#l00100">immersedboundaries.h:100</a></div></div>
<div class="ttc" id="a00181_html_a8c17b15efd6e0337c596d98616e9b9da"><div class="ttname"><a href="a00181.html#a8c17b15efd6e0337c596d98616e9b9da">Body3D::ymin</a></div><div class="ttdeci">double ymin</div><div class="ttdef"><b>Definition:</b> <a href="a00181_source.html#l00104">immersedboundaries.h:104</a></div></div>
<div class="ttc" id="a00181_html_a00620"><div class="ttname"><a href="a00181.html#a00620">ImmersedBoundary</a></div><div class="ttdoc">Structure containing variables for immersed boundary implementation. </div><div class="ttdef"><b>Definition:</b> <a href="a00181_source.html#l00153">immersedboundaries.h:153</a></div></div>
<div class="ttc" id="a00197_html_aa3c28612a64b8a97bde66b720e15c700"><div class="ttname"><a href="a00197.html#aa3c28612a64b8a97bde66b720e15c700">MPIVariables::ip</a></div><div class="ttdeci">int * ip</div><div class="ttdef"><b>Definition:</b> <a href="a00197_source.html#l00028">mpivars_struct.h:28</a></div></div>
<div class="ttc" id="a00218_html_ad6ab74942c9de13cf0b4c12eb0d91780"><div class="ttname"><a href="a00218.html#ad6ab74942c9de13cf0b4c12eb0d91780">IERR</a></div><div class="ttdeci">#define IERR</div><div class="ttdef"><b>Definition:</b> <a href="a00218_source.html#l00012">basic.h:12</a></div></div>
<div class="ttc" id="a00194_html_aa989ebb755986852177779cdf7bd8c85"><div class="ttname"><a href="a00194.html#aa989ebb755986852177779cdf7bd8c85">HyPar::dim_global</a></div><div class="ttdeci">int * dim_global</div><div class="ttdef"><b>Definition:</b> <a href="a00224_source.html#l00032">hypar.h:32</a></div></div>
<div class="ttc" id="a00208_html_a00626"><div class="ttname"><a href="a00208.html#a00626">SimulationObject</a></div><div class="ttdoc">Structure defining a simulation. </div><div class="ttdef"><b>Definition:</b> <a href="a00208_source.html#l00023">simulation_object.h:23</a></div></div>
<div class="ttc" id="a00218_html_a9aa9bad8531d6733731a850ccc471a42"><div class="ttname"><a href="a00218.html#a9aa9bad8531d6733731a850ccc471a42">_GetCoordinate_</a></div><div class="ttdeci">#define _GetCoordinate_(dir, i, dim, ghosts, x, coord)</div><div class="ttdef"><b>Definition:</b> <a href="a00218_source.html#l00027">basic.h:27</a></div></div>
<div class="ttc" id="a00217_html_a0739cb538f4d301fad3b45059ddd0738"><div class="ttname"><a href="a00217.html#a0739cb538f4d301fad3b45059ddd0738">_ArrayIndex1DWO_</a></div><div class="ttdeci">#define _ArrayIndex1DWO_(N, imax, i, offset, ghost, index)</div><div class="ttdef"><b>Definition:</b> <a href="a00217_source.html#l00082">arrayfunctions.h:82</a></div></div>
<div class="ttc" id="a00194_html_a8419c1760256467c117ef5932b943259"><div class="ttname"><a href="a00194.html#a8419c1760256467c117ef5932b943259">HyPar::ib</a></div><div class="ttdeci">void * ib</div><div class="ttdef"><b>Definition:</b> <a href="a00224_source.html#l00419">hypar.h:419</a></div></div>
<div class="ttc" id="a00181_html_a0175a349146a94c667dc90f2bffdb7ef"><div class="ttname"><a href="a00181.html#a0175a349146a94c667dc90f2bffdb7ef">IBInterpCoeffs</a></div><div class="ttdeci">int IBInterpCoeffs(void *, void *, double *, int *, int, double *)</div><div class="ttdef"><b>Definition:</b> <a href="a00308_source.html#l00022">IBInterpCoeffs.c:22</a></div></div>
<div class="ttc" id="a00194_html_a4e67f54563a3c4ff005dfaf0130f957c"><div class="ttname"><a href="a00194.html#a4e67f54563a3c4ff005dfaf0130f957c">HyPar::npoints_global</a></div><div class="ttdeci">int npoints_global</div><div class="ttdef"><b>Definition:</b> <a href="a00224_source.html#l00038">hypar.h:38</a></div></div>
<div class="ttc" id="a00229_html_aa0d45e1e67c5cacf5c9251fcd90a971b"><div class="ttname"><a href="a00229.html#aa0d45e1e67c5cacf5c9251fcd90a971b">max3</a></div><div class="ttdeci">#define max3(a, b, c)</div><div class="ttdef"><b>Definition:</b> <a href="a00229_source.html#l00027">math_ops.h:27</a></div></div>
<div class="ttc" id="a00194_html_aafc992b5fa79d5a4036024615d03bce6"><div class="ttname"><a href="a00194.html#aafc992b5fa79d5a4036024615d03bce6">HyPar::ghosts</a></div><div class="ttdeci">int ghosts</div><div class="ttdef"><b>Definition:</b> <a href="a00224_source.html#l00044">hypar.h:44</a></div></div>
<div class="ttc" id="a00181_html_a59296c4f43deabbc6a9b511ba559a4b4"><div class="ttname"><a href="a00181.html#a59296c4f43deabbc6a9b511ba559a4b4">IBComputeBoundingBox</a></div><div class="ttdeci">int IBComputeBoundingBox(Body3D *)</div><div class="ttdef"><b>Definition:</b> <a href="a00301_source.html#l00009">IBComputeBoundingBox.c:9</a></div></div>
<div class="ttc" id="a00234_html_a60ace5964c051fa481e6a1e6f1ef75d7"><div class="ttname"><a href="a00234.html#a60ace5964c051fa481e6a1e6f1ef75d7">MPIExchangeBoundariesnD</a></div><div class="ttdeci">int MPIExchangeBoundariesnD(int, int, int *, int, void *, double *)</div><div class="ttdef"><b>Definition:</b> <a href="a00359_source.html#l00042">MPIExchangeBoundariesnD.c:42</a></div></div>
<div class="ttc" id="a00181_html_a0f59ba2c552bae2f35a03ce3964a2b4a"><div class="ttname"><a href="a00181.html#a0f59ba2c552bae2f35a03ce3964a2b4a">_IB_NDIMS_</a></div><div class="ttdeci">#define _IB_NDIMS_</div><div class="ttdef"><b>Definition:</b> <a href="a00181_source.html#l00010">immersedboundaries.h:10</a></div></div>
<div class="ttc" id="a00234_html_ac4c9e0736d7419f96307c6e6298d3f45"><div class="ttname"><a href="a00234.html#ac4c9e0736d7419f96307c6e6298d3f45">MPIGatherArray1D</a></div><div class="ttdeci">int MPIGatherArray1D(void *, double *, double *, int, int, int, int)</div><div class="ttdef"><b>Definition:</b> <a href="a00360_source.html#l00026">MPIGatherArray1D.c:26</a></div></div>
<div class="ttc" id="a00181_html_ade09ae0d27b0b7a2d1e886efc6d1a500"><div class="ttname"><a href="a00181.html#ade09ae0d27b0b7a2d1e886efc6d1a500">Body3D::zmax</a></div><div class="ttdeci">double zmax</div><div class="ttdef"><b>Definition:</b> <a href="a00181_source.html#l00104">immersedboundaries.h:104</a></div></div>
<div class="ttc" id="a00181_html_a9b7a52f65913c3f33f902400fa18239d"><div class="ttname"><a href="a00181.html#a9b7a52f65913c3f33f902400fa18239d">IBIdentifyBody</a></div><div class="ttdeci">int IBIdentifyBody(void *, int *, int *, int, void *, double *, double *)</div><div class="ttdef"><b>Definition:</b> <a href="a00305_source.html#l00020">IBIdentifyBody.c:20</a></div></div>
<div class="ttc" id="a00181_html_ac877ecf361b72916a491e4759f8af040"><div class="ttname"><a href="a00181.html#ac877ecf361b72916a491e4759f8af040">IBNearestFacetNormal</a></div><div class="ttdeci">int IBNearestFacetNormal(void *, void *, double *, double, int *, int)</div><div class="ttdef"><b>Definition:</b> <a href="a00309_source.html#l00025">IBNearestFacetNormal.c:25</a></div></div>
<div class="ttc" id="a00181_html_a5a34c6ed89d3769fb1200fdfbdc8ae33"><div class="ttname"><a href="a00181.html#a5a34c6ed89d3769fb1200fdfbdc8ae33">ImmersedBoundary::itr_max</a></div><div class="ttdeci">int itr_max</div><div class="ttdef"><b>Definition:</b> <a href="a00181_source.html#l00160">immersedboundaries.h:160</a></div></div>
<div class="ttc" id="a00181_html_a935394e510d17282c5697cd76a6e2667"><div class="ttname"><a href="a00181.html#a935394e510d17282c5697cd76a6e2667">ImmersedBoundary::mode</a></div><div class="ttdeci">char mode[_MAX_STRING_SIZE_]</div><div class="ttdef"><b>Definition:</b> <a href="a00181_source.html#l00164">immersedboundaries.h:164</a></div></div>
<div class="ttc" id="a00218_html_add9cf96ae374934d245a1dc1ab697a42"><div class="ttname"><a href="a00218.html#add9cf96ae374934d245a1dc1ab697a42">CHECKERR</a></div><div class="ttdeci">#define CHECKERR(ierr)</div><div class="ttdef"><b>Definition:</b> <a href="a00218_source.html#l00014">basic.h:14</a></div></div>
<div class="ttc" id="a00197_html_a00622"><div class="ttname"><a href="a00197.html#a00622">MPIVariables</a></div><div class="ttdoc">Structure of MPI-related variables. </div><div class="ttdef"><b>Definition:</b> <a href="a00197_source.html#l00024">mpivars_struct.h:24</a></div></div>
<div class="ttc" id="a00181_html_afd755b081f4d9ca3558ef9ca9f3c35d0"><div class="ttname"><a href="a00181.html#afd755b081f4d9ca3558ef9ca9f3c35d0">Body3D::nfacets</a></div><div class="ttdeci">int nfacets</div><div class="ttdef"><b>Definition:</b> <a href="a00181_source.html#l00101">immersedboundaries.h:101</a></div></div>
<div class="ttc" id="a00217_html_a2b2826031c0cd92495ab351d3e599fc5"><div class="ttname"><a href="a00217.html#a2b2826031c0cd92495ab351d3e599fc5">_ArraySetValue_</a></div><div class="ttdeci">#define _ArraySetValue_(x, size, value)</div><div class="ttdef"><b>Definition:</b> <a href="a00217_source.html#l00168">arrayfunctions.h:168</a></div></div>
<div class="ttc" id="a00197_html_adad7a6f85831f3ac84d854b6c80aef43"><div class="ttname"><a href="a00197.html#adad7a6f85831f3ac84d854b6c80aef43">MPIVariables::world</a></div><div class="ttdeci">MPI_Comm world</div><div class="ttdef"><b>Definition:</b> <a href="a00197_source.html#l00037">mpivars_struct.h:37</a></div></div>
<div class="ttc" id="a00181_html_afc6ae6b11b9521d908c52e4fb3ea09ce"><div class="ttname"><a href="a00181.html#afc6ae6b11b9521d908c52e4fb3ea09ce">Body3D::ymax</a></div><div class="ttdeci">double ymax</div><div class="ttdef"><b>Definition:</b> <a href="a00181_source.html#l00104">immersedboundaries.h:104</a></div></div>
<div class="ttc" id="a00208_html_a523947ce4fa7128c4c767163953253b9"><div class="ttname"><a href="a00208.html#a523947ce4fa7128c4c767163953253b9">SimulationObject::solver</a></div><div class="ttdeci">HyPar solver</div><div class="ttdef"><b>Definition:</b> <a href="a00208_source.html#l00026">simulation_object.h:26</a></div></div>
<div class="ttc" id="a00217_html_afbb862a2fdf5b72b1f9ace42f64b556f"><div class="ttname"><a href="a00217.html#afbb862a2fdf5b72b1f9ace42f64b556f">_ArrayIndex1D_</a></div><div class="ttdeci">#define _ArrayIndex1D_(N, imax, i, ghost, index)</div><div class="ttdef"><b>Definition:</b> <a href="a00217_source.html#l00039">arrayfunctions.h:39</a></div></div>
<div class="ttc" id="a00181_html_af858f0e9bc4a6cb1c16ad2931cf4b43d"><div class="ttname"><a href="a00181.html#af858f0e9bc4a6cb1c16ad2931cf4b43d">ImmersedBoundary::body</a></div><div class="ttdeci">Body3D * body</div><div class="ttdef"><b>Definition:</b> <a href="a00181_source.html#l00154">immersedboundaries.h:154</a></div></div>
<div class="ttc" id="a00181_html_a97eab6d709b80585fe9e8a54b1e3da27"><div class="ttname"><a href="a00181.html#a97eab6d709b80585fe9e8a54b1e3da27">ImmersedBoundary::tolerance</a></div><div class="ttdeci">double tolerance</div><div class="ttdef"><b>Definition:</b> <a href="a00181_source.html#l00158">immersedboundaries.h:158</a></div></div>
<div class="ttc" id="a00181_html_a30554afc6599846bcd01cbf986d0998a"><div class="ttname"><a href="a00181.html#a30554afc6599846bcd01cbf986d0998a">Body3D::xmax</a></div><div class="ttdeci">double xmax</div><div class="ttdef"><b>Definition:</b> <a href="a00181_source.html#l00104">immersedboundaries.h:104</a></div></div>
<div class="ttc" id="a00194_html_ae83b1b0117b6a805ead2e4728945814c"><div class="ttname"><a href="a00194.html#ae83b1b0117b6a805ead2e4728945814c">HyPar::flag_ib</a></div><div class="ttdeci">int flag_ib</div><div class="ttdef"><b>Definition:</b> <a href="a00224_source.html#l00417">hypar.h:417</a></div></div>
<div class="ttc" id="a00194_html_a43ee3672350b4fd385871b6512e5d47b"><div class="ttname"><a href="a00194.html#a43ee3672350b4fd385871b6512e5d47b">HyPar::ib_filename</a></div><div class="ttdeci">char ib_filename[_MAX_STRING_SIZE_]</div><div class="ttdef"><b>Definition:</b> <a href="a00224_source.html#l00415">hypar.h:415</a></div></div>
<div class="ttc" id="a00181_html_a0575b5233bc22af6797e2c7b0d95f469"><div class="ttname"><a href="a00181.html#a0575b5233bc22af6797e2c7b0d95f469">IBCreateFacetMapping</a></div><div class="ttdeci">int IBCreateFacetMapping(void *, void *, double *, int *, int)</div><div class="ttdef"><b>Definition:</b> <a href="a00304_source.html#l00143">IBCreateFacetMapping.c:143</a></div></div>
<div class="ttc" id="a00181_html_aafa48e01069cbd264052995cffeb6ea0"><div class="ttname"><a href="a00181.html#aafa48e01069cbd264052995cffeb6ea0">IBIdentifyMode</a></div><div class="ttdeci">int IBIdentifyMode(double *, int *, void *)</div><div class="ttdef"><b>Definition:</b> <a href="a00307_source.html#l00024">IBIdentifyMode.c:24</a></div></div>
<div class="ttc" id="a00197_html_a7602de5ebb1b59ec35217e78a35a531e"><div class="ttname"><a href="a00197.html#a7602de5ebb1b59ec35217e78a35a531e">MPIVariables::ie</a></div><div class="ttdeci">int * ie</div><div class="ttdef"><b>Definition:</b> <a href="a00197_source.html#l00029">mpivars_struct.h:29</a></div></div>
<div class="ttc" id="a00194_html_a711aad4cbe735871dd9e91ab575c878b"><div class="ttname"><a href="a00194.html#a711aad4cbe735871dd9e91ab575c878b">HyPar::x</a></div><div class="ttdeci">double * x</div><div class="ttdef"><b>Definition:</b> <a href="a00224_source.html#l00099">hypar.h:99</a></div></div>
<div class="ttc" id="a00181_html_a9ea1a8f5ef3e6d20b362385e1288c72c"><div class="ttname"><a href="a00181.html#a9ea1a8f5ef3e6d20b362385e1288c72c">ImmersedBoundary::delta</a></div><div class="ttdeci">double delta</div><div class="ttdef"><b>Definition:</b> <a href="a00181_source.html#l00159">immersedboundaries.h:159</a></div></div>
<div class="ttc" id="a00181_html_a4246de81fa9366c4e377b927c9cfd2ed"><div class="ttname"><a href="a00181.html#a4246de81fa9366c4e377b927c9cfd2ed">IBReadBodySTL</a></div><div class="ttdeci">int IBReadBodySTL(Body3D **, char *, void *, int *)</div><div class="ttdef"><b>Definition:</b> <a href="a00310_source.html#l00021">IBReadBodySTL.c:21</a></div></div>
<div class="ttc" id="a00181_html_af70e331f0896000fe1b0edf69676296c"><div class="ttname"><a href="a00181.html#af70e331f0896000fe1b0edf69676296c">IBIdentifyBoundary</a></div><div class="ttdeci">int IBIdentifyBoundary(void *, void *, int *, int, double *)</div><div class="ttdef"><b>Definition:</b> <a href="a00306_source.html#l00158">IBIdentifyBoundary.c:158</a></div></div>
<div class="ttc" id="a00181_html_ab5bbe897a0c25c58341c216a1b31fbbf"><div class="ttname"><a href="a00181.html#ab5bbe897a0c25c58341c216a1b31fbbf">Body3D::xmin</a></div><div class="ttdeci">double xmin</div><div class="ttdef"><b>Definition:</b> <a href="a00181_source.html#l00104">immersedboundaries.h:104</a></div></div>
<div class="ttc" id="a00197_html_a0be0f30a83bc3f3d9f6ee3a36bbf2716"><div class="ttname"><a href="a00197.html#a0be0f30a83bc3f3d9f6ee3a36bbf2716">MPIVariables::iproc</a></div><div class="ttdeci">int * iproc</div><div class="ttdef"><b>Definition:</b> <a href="a00197_source.html#l00027">mpivars_struct.h:27</a></div></div>
<div class="ttc" id="a00194_html"><div class="ttname"><a href="a00194.html">HyPar</a></div><div class="ttdoc">Structure containing all solver-specific variables and functions. </div><div class="ttdef"><b>Definition:</b> <a href="a00224_source.html#l00023">hypar.h:23</a></div></div>
<div class="ttc" id="a00234_html_a45dcb265863a65d862bb16222e7e623c"><div class="ttname"><a href="a00234.html#a45dcb265863a65d862bb16222e7e623c">MPIBroadcast_double</a></div><div class="ttdeci">int MPIBroadcast_double(double *, int, int, void *)</div><div class="ttdef"><b>Definition:</b> <a href="a00356_source.html#l00009">MPIBroadcast.c:9</a></div></div>
<div class="ttc" id="a00197_html_a481013ba007a99a4237cde5eeb3c9a29"><div class="ttname"><a href="a00197.html#a481013ba007a99a4237cde5eeb3c9a29">MPIVariables::is</a></div><div class="ttdeci">int * is</div><div class="ttdef"><b>Definition:</b> <a href="a00197_source.html#l00029">mpivars_struct.h:29</a></div></div>
<div class="ttc" id="a00194_html_a484873c74138512e41bc50d17b7d955a"><div class="ttname"><a href="a00194.html#a484873c74138512e41bc50d17b7d955a">HyPar::ndims</a></div><div class="ttdeci">int ndims</div><div class="ttdef"><b>Definition:</b> <a href="a00224_source.html#l00026">hypar.h:26</a></div></div>
<div class="ttc" id="a00217_html_ac5ec1371623f11d03b0f42adaa24acbc"><div class="ttname"><a href="a00217.html#ac5ec1371623f11d03b0f42adaa24acbc">_ArrayIncrementIndex_</a></div><div class="ttdeci">#define _ArrayIncrementIndex_(N, imax, i, done)</div><div class="ttdef"><b>Definition:</b> <a href="a00217_source.html#l00125">arrayfunctions.h:125</a></div></div>
<div class="ttc" id="a00194_html_a38e0371f331cecbe63a77fa03e202afe"><div class="ttname"><a href="a00194.html#a38e0371f331cecbe63a77fa03e202afe">HyPar::dim_local</a></div><div class="ttdeci">int * dim_local</div><div class="ttdef"><b>Definition:</b> <a href="a00224_source.html#l00035">hypar.h:35</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a5dc056a75d14ab6ba9292bcad6928a72"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int InitializePhysics </td>
          <td>(</td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>s</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>nsims</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Initialize the physics</p>
<p>Initialize the physical model for a simulation: Depending on the physical model specified, this function calls the initialization function for that physical model. The latter is responsible for setting all the physics-specific functions that are required by the model. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">s</td><td>Array of simulation objects of type <a class="el" href="a00208.html#a00626" title="Structure defining a simulation. ">SimulationObject</a> </td></tr>
    <tr><td class="paramname">nsims</td><td>number of simulation objects </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="a00555_source.html#l00038">38</a> of file <a class="el" href="a00555_source.html">InitializePhysics.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;{</div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;  <a class="code" href="a00208.html#a00626">SimulationObject</a> *sim = (<a class="code" href="a00208.html#a00626">SimulationObject</a>*) s;</div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;  <span class="keywordtype">int</span> ns;</div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;  <a class="code" href="a00218.html#a68f50121fb9a7daeaf60e50cdef82ef3">_DECLARE_IERR_</a>;</div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;</div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;  <span class="keywordflow">if</span> (nsims == 0) <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;</div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;  <span class="keywordflow">if</span> (!sim[0].mpi.rank) {</div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;    printf(<span class="stringliteral">&quot;Initializing physics. Model = \&quot;%s\&quot;\n&quot;</span>,sim[0].solver.model);</div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;  }</div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;</div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;  <span class="keywordflow">for</span> (ns = 0; ns &lt; nsims; ns++) {</div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;</div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;    <a class="code" href="a00194.html">HyPar</a>        *solver   = &amp;(sim[ns].<a class="code" href="a00208.html#a523947ce4fa7128c4c767163953253b9">solver</a>);</div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;    <a class="code" href="a00197.html#a00622">MPIVariables</a> *mpi      = &amp;(sim[ns].<a class="code" href="a00208.html#a4afd2c7b3eb8fda452474ebdbe71c8c0">mpi</a>);</div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;</div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;    <span class="comment">/* Initialize physics-specific functions to NULL */</span></div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;    solver-&gt;<a class="code" href="a00194.html#a73ad2e9dae43bf438ab8bfc4cd2e1bdd">ComputeCFL</a>            = NULL;</div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;    solver-&gt;<a class="code" href="a00194.html#a49e17e5889baddd411c028afc3b91335">ComputeDiffNumber</a>     = NULL;</div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;    solver-&gt;<a class="code" href="a00194.html#a0d895f9bb0c8a3e79a64dd2379e1f2dd">FFunction</a>             = NULL;</div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;    solver-&gt;<a class="code" href="a00194.html#aa1dd38befc4bb4adda9d456146436b14">dFFunction</a>            = NULL;</div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;    solver-&gt;<a class="code" href="a00194.html#adcc5e677515d0952ce3ff702c9d85b86">FdFFunction</a>           = NULL;</div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;    solver-&gt;<a class="code" href="a00194.html#ad8f03ca8c9fd6e1e235203495e8f2173">GFunction</a>             = NULL;</div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;    solver-&gt;<a class="code" href="a00194.html#a122bcc1ec2e20b3bc69d169580529021">HFunction</a>             = NULL;</div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;    solver-&gt;<a class="code" href="a00194.html#a1685cd0c6b8c413bdbbe86d8f4475c58">SFunction</a>             = NULL;</div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;    solver-&gt;<a class="code" href="a00194.html#af1dc5a4ba2bdc46dfd226e35772b4130">UFunction</a>             = NULL;</div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;    solver-&gt;<a class="code" href="a00194.html#a15eea1647344c503deb1d9f89cead631">JFunction</a>             = NULL;</div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;    solver-&gt;<a class="code" href="a00194.html#a7eb68b9643feb74bd49f3a171b66eef1">Upwind</a>                = NULL;</div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;    solver-&gt;<a class="code" href="a00194.html#a73a85f83072e02bf979234486265b6d3">UpwinddF</a>              = NULL;</div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;    solver-&gt;<a class="code" href="a00194.html#ab06746933e859e829d694505c18258b3">UpwindFdF</a>             = NULL;</div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;    solver-&gt;<a class="code" href="a00194.html#ad00c58573b5bcfe8c8bb72eed3dc7ad8">PreStage</a>              = NULL;</div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;    solver-&gt;<a class="code" href="a00194.html#a356e3534ee0048e05c5ea3ca091c33d8">PostStage</a>             = NULL;</div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;    solver-&gt;<a class="code" href="a00194.html#a6a34ae8a3044f521e57180a7260f3b42">PreStep</a>               = NULL;</div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;    solver-&gt;<a class="code" href="a00194.html#a85a6422b0b08263704165a2a14719033">PostStep</a>              = NULL;</div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;    solver-&gt;<a class="code" href="a00194.html#aa4ef2f3e9fcc13ef7b8885b8a7145967">PrintStep</a>             = NULL;</div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;    solver-&gt;<a class="code" href="a00194.html#ab4c55736e92f7d72f04b8a957d82b054">PhysicsOutput</a>         = NULL;</div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;    solver-&gt;<a class="code" href="a00194.html#a4ac8912d5ab1bdedff4546d24910ae71">PhysicsInput</a>          = NULL;</div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;    solver-&gt;<a class="code" href="a00194.html#a7331366d789b2995436accbc35e1cc80">AveragingFunction</a>     = NULL;</div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;    solver-&gt;<a class="code" href="a00194.html#a8c603c73be1f08e408a1de94a088da7b">GetLeftEigenvectors</a>   = NULL;</div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;    solver-&gt;<a class="code" href="a00194.html#a22eef349f191a1aa267e14b08140c823">GetRightEigenvectors</a>  = NULL;</div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;    solver-&gt;<a class="code" href="a00194.html#a0d9d4a968c52356bd63f45ad76112245">IBFunction</a>            = NULL;</div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;</div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;    <span class="keywordflow">if</span> (!strcmp(solver-&gt;<a class="code" href="a00194.html#ad3fe4b266b398f3a7567ac1b241d99a2">model</a>,<a class="code" href="a00196.html#a44c745170d88218420752d150856b01c">_LINEAR_ADVECTION_DIFFUSION_REACTION_</a>)) {</div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;  </div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;      solver-&gt;<a class="code" href="a00194.html#a48e81a1806b5774943fd9a26e9a190f2">physics</a> = (<a class="code" href="a00196.html#a00621">LinearADR</a>*) calloc (1,<span class="keyword">sizeof</span>(<a class="code" href="a00196.html#a00621">LinearADR</a>));</div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;      <a class="code" href="a00218.html#ad6ab74942c9de13cf0b4c12eb0d91780">IERR</a> <a class="code" href="a00196.html#a78c1fbb2ddae048ddb9d2863ad4f65b3">LinearADRInitialize</a>(solver,mpi); <a class="code" href="a00218.html#add9cf96ae374934d245a1dc1ab697a42">CHECKERR</a>(ierr);</div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;</div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcmp(solver-&gt;<a class="code" href="a00194.html#ad3fe4b266b398f3a7567ac1b241d99a2">model</a>,<a class="code" href="a00182.html#a0496194e6f2d5608086a3020f3f7ccb5">_BURGERS_</a>)) {</div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;</div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;    solver-&gt;<a class="code" href="a00194.html#a48e81a1806b5774943fd9a26e9a190f2">physics</a> = (<a class="code" href="a00182.html#a00608">Burgers</a>*) calloc (1,<span class="keyword">sizeof</span>(<a class="code" href="a00182.html#a00608">Burgers</a>));</div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;    <a class="code" href="a00218.html#ad6ab74942c9de13cf0b4c12eb0d91780">IERR</a> <a class="code" href="a00182.html#a28344a004f73d2e3391ef01f4419bd9a">BurgersInitialize</a>(solver,mpi); <a class="code" href="a00218.html#add9cf96ae374934d245a1dc1ab697a42">CHECKERR</a>(ierr);</div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;</div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcmp(solver-&gt;<a class="code" href="a00194.html#ad3fe4b266b398f3a7567ac1b241d99a2">model</a>,<a class="code" href="a00190.html#a801cd9499779d35febbce73603aa70a6">_FP_DOUBLE_WELL_</a>)) {</div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;  </div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;      solver-&gt;<a class="code" href="a00194.html#a48e81a1806b5774943fd9a26e9a190f2">physics</a> = (<a class="code" href="a00190.html#a00614">FPDoubleWell</a>*) calloc (1,<span class="keyword">sizeof</span>(<a class="code" href="a00190.html#a00614">FPDoubleWell</a>));</div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;      <a class="code" href="a00218.html#ad6ab74942c9de13cf0b4c12eb0d91780">IERR</a> <a class="code" href="a00190.html#af48e8eb8a81020a97b3b7b039bb94626">FPDoubleWellInitialize</a>(solver,mpi); <a class="code" href="a00218.html#add9cf96ae374934d245a1dc1ab697a42">CHECKERR</a>(ierr);</div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;  </div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcmp(solver-&gt;<a class="code" href="a00194.html#ad3fe4b266b398f3a7567ac1b241d99a2">model</a>,<a class="code" href="a00191.html#aaeb0de68ad20c63864e1a6cdf819e836">_FP_POWER_SYSTEM_</a>)) {</div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;  </div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;      solver-&gt;<a class="code" href="a00194.html#a48e81a1806b5774943fd9a26e9a190f2">physics</a> = (<a class="code" href="a00191.html#a00615">FPPowerSystem</a>*) calloc (1,<span class="keyword">sizeof</span>(<a class="code" href="a00191.html#a00615">FPPowerSystem</a>));</div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;      <a class="code" href="a00218.html#ad6ab74942c9de13cf0b4c12eb0d91780">IERR</a> <a class="code" href="a00191.html#abe8191ce0b15220b854bbcda4446b170">FPPowerSystemInitialize</a>(solver,mpi); <a class="code" href="a00218.html#add9cf96ae374934d245a1dc1ab697a42">CHECKERR</a>(ierr);</div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;  </div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcmp(solver-&gt;<a class="code" href="a00194.html#ad3fe4b266b398f3a7567ac1b241d99a2">model</a>,<a class="code" href="a00192.html#a104fb063ee608b39fdab8d5e1e752ca3">_FP_POWER_SYSTEM_1BUS_</a>)) {</div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;  </div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;      solver-&gt;<a class="code" href="a00194.html#a48e81a1806b5774943fd9a26e9a190f2">physics</a> = (<a class="code" href="a00192.html#a00616">FPPowerSystem1Bus</a>*) calloc (1,<span class="keyword">sizeof</span>(<a class="code" href="a00192.html#a00616">FPPowerSystem1Bus</a>));</div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;      <a class="code" href="a00218.html#ad6ab74942c9de13cf0b4c12eb0d91780">IERR</a> <a class="code" href="a00192.html#aa498ad8f4fd87b8a18d2d81e327d7013">FPPowerSystem1BusInitialize</a>(solver,mpi); <a class="code" href="a00218.html#add9cf96ae374934d245a1dc1ab697a42">CHECKERR</a>(ierr);</div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;  </div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcmp(solver-&gt;<a class="code" href="a00194.html#ad3fe4b266b398f3a7567ac1b241d99a2">model</a>,<a class="code" href="a00193.html#a5c8fe736dacda1a087bf1fb514761d6e">_FP_POWER_SYSTEM_3BUS_</a>)) {</div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;  </div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;      solver-&gt;<a class="code" href="a00194.html#a48e81a1806b5774943fd9a26e9a190f2">physics</a> = (<a class="code" href="a00193.html#a00617">FPPowerSystem3Bus</a>*) calloc (1,<span class="keyword">sizeof</span>(<a class="code" href="a00193.html#a00617">FPPowerSystem3Bus</a>));</div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;      <a class="code" href="a00218.html#ad6ab74942c9de13cf0b4c12eb0d91780">IERR</a> <a class="code" href="a00193.html#ac493c18d35f80f5207a03d0be4778617">FPPowerSystem3BusInitialize</a>(solver,mpi); <a class="code" href="a00218.html#add9cf96ae374934d245a1dc1ab697a42">CHECKERR</a>(ierr);</div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;  </div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcmp(solver-&gt;<a class="code" href="a00194.html#ad3fe4b266b398f3a7567ac1b241d99a2">model</a>,<a class="code" href="a00237.html#a076991b7fbc2b9c6330f792bbba182c2">_EULER_1D_</a>)) {</div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;  </div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;      solver-&gt;<a class="code" href="a00194.html#a48e81a1806b5774943fd9a26e9a190f2">physics</a> = (<a class="code" href="a00187.html">Euler1D</a>*) calloc (1,<span class="keyword">sizeof</span>(<a class="code" href="a00187.html">Euler1D</a>));</div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;      <a class="code" href="a00218.html#ad6ab74942c9de13cf0b4c12eb0d91780">IERR</a> <a class="code" href="a00237.html#a2143f7f3c03f53cf752a344a613fe429">Euler1DInitialize</a>(solver,mpi); <a class="code" href="a00218.html#add9cf96ae374934d245a1dc1ab697a42">CHECKERR</a>(ierr);</div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;  </div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcmp(solver-&gt;<a class="code" href="a00194.html#ad3fe4b266b398f3a7567ac1b241d99a2">model</a>,<a class="code" href="a00188.html#ae205e355df87a13c8b47c958828bce2f">_EULER_2D_</a>)) {</div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;  </div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;      solver-&gt;<a class="code" href="a00194.html#a48e81a1806b5774943fd9a26e9a190f2">physics</a> = (<a class="code" href="a00188.html#a00610">Euler2D</a>*) calloc (1,<span class="keyword">sizeof</span>(<a class="code" href="a00188.html#a00610">Euler2D</a>));</div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;      <a class="code" href="a00218.html#ad6ab74942c9de13cf0b4c12eb0d91780">IERR</a> <a class="code" href="a00188.html#a7c85bdac3c8b5f3bb3bd83fdae2e52e8">Euler2DInitialize</a>(solver,mpi); <a class="code" href="a00218.html#add9cf96ae374934d245a1dc1ab697a42">CHECKERR</a>(ierr);</div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;  </div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcmp(solver-&gt;<a class="code" href="a00194.html#ad3fe4b266b398f3a7567ac1b241d99a2">model</a>,<a class="code" href="a00199.html#a04e16b3f2a882826e604b6353d9e5bcb">_NAVIER_STOKES_2D_</a>)) {</div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;  </div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;      solver-&gt;<a class="code" href="a00194.html#a48e81a1806b5774943fd9a26e9a190f2">physics</a> = (<a class="code" href="a00199.html#a00623">NavierStokes2D</a>*) calloc (1,<span class="keyword">sizeof</span>(<a class="code" href="a00199.html#a00623">NavierStokes2D</a>));</div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;      <a class="code" href="a00218.html#ad6ab74942c9de13cf0b4c12eb0d91780">IERR</a> <a class="code" href="a00199.html#abdd7dcd1ec7c37af027441f521dbe844">NavierStokes2DInitialize</a>(solver,mpi); <a class="code" href="a00218.html#add9cf96ae374934d245a1dc1ab697a42">CHECKERR</a>(ierr);</div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;  </div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcmp(solver-&gt;<a class="code" href="a00194.html#ad3fe4b266b398f3a7567ac1b241d99a2">model</a>,<a class="code" href="a00200.html#a34099431ed2606bd884d36cea1d0448e">_NAVIER_STOKES_3D_</a>)) {</div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;  </div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;      solver-&gt;<a class="code" href="a00194.html#a48e81a1806b5774943fd9a26e9a190f2">physics</a> = (<a class="code" href="a00200.html#a00624">NavierStokes3D</a>*) calloc (1,<span class="keyword">sizeof</span>(<a class="code" href="a00200.html#a00624">NavierStokes3D</a>));</div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;      <a class="code" href="a00218.html#ad6ab74942c9de13cf0b4c12eb0d91780">IERR</a> <a class="code" href="a00200.html#a0385acf3caf014aa7491ad2fc6a9572a">NavierStokes3DInitialize</a>(solver,mpi); <a class="code" href="a00218.html#add9cf96ae374934d245a1dc1ab697a42">CHECKERR</a>(ierr);</div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;  </div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcmp(solver-&gt;<a class="code" href="a00194.html#ad3fe4b266b398f3a7567ac1b241d99a2">model</a>,<a class="code" href="a00238.html#a82b3f90650895890211635171d649355">_NUMA2D_</a>)) {</div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;  </div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;      solver-&gt;<a class="code" href="a00194.html#a48e81a1806b5774943fd9a26e9a190f2">physics</a> = (<a class="code" href="a00201.html">Numa2D</a>*) calloc (1,<span class="keyword">sizeof</span>(<a class="code" href="a00201.html">Numa2D</a>));</div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;      <a class="code" href="a00218.html#ad6ab74942c9de13cf0b4c12eb0d91780">IERR</a> <a class="code" href="a00238.html#afe3cd0a9dcef80c2cdb1e8928cef9887">Numa2DInitialize</a>(solver,mpi); <a class="code" href="a00218.html#add9cf96ae374934d245a1dc1ab697a42">CHECKERR</a>(ierr);</div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;  </div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcmp(solver-&gt;<a class="code" href="a00194.html#ad3fe4b266b398f3a7567ac1b241d99a2">model</a>,<a class="code" href="a00239.html#a8bccae14dde8eaba7663344939367e96">_NUMA3D_</a>)) {</div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;  </div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;      solver-&gt;<a class="code" href="a00194.html#a48e81a1806b5774943fd9a26e9a190f2">physics</a> = (<a class="code" href="a00202.html">Numa3D</a>*) calloc (1,<span class="keyword">sizeof</span>(<a class="code" href="a00202.html">Numa3D</a>));</div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;      <a class="code" href="a00218.html#ad6ab74942c9de13cf0b4c12eb0d91780">IERR</a> <a class="code" href="a00239.html#aad8263a96673a7500502bc9d88c9fd41">Numa3DInitialize</a>(solver,mpi); <a class="code" href="a00218.html#add9cf96ae374934d245a1dc1ab697a42">CHECKERR</a>(ierr);</div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;  </div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcmp(solver-&gt;<a class="code" href="a00194.html#ad3fe4b266b398f3a7567ac1b241d99a2">model</a>,<a class="code" href="a00240.html#ac280c6ead138670f1f518fad3ea94737">_SHALLOW_WATER_1D_</a>)) {</div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;  </div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;      solver-&gt;<a class="code" href="a00194.html#a48e81a1806b5774943fd9a26e9a190f2">physics</a> = (<a class="code" href="a00205.html">ShallowWater1D</a>*) calloc (1,<span class="keyword">sizeof</span>(<a class="code" href="a00205.html">ShallowWater1D</a>));</div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;      <a class="code" href="a00218.html#ad6ab74942c9de13cf0b4c12eb0d91780">IERR</a> <a class="code" href="a00240.html#a66b9f9e2ed58d68a910cbd5522381fa2">ShallowWater1DInitialize</a>(solver,mpi); <a class="code" href="a00218.html#add9cf96ae374934d245a1dc1ab697a42">CHECKERR</a>(ierr);</div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;  </div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcmp(solver-&gt;<a class="code" href="a00194.html#ad3fe4b266b398f3a7567ac1b241d99a2">model</a>,<a class="code" href="a00241.html#aebe5d4a29761b0784c3d3e67e325105b">_SHALLOW_WATER_2D_</a>)) {</div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;  </div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;      solver-&gt;<a class="code" href="a00194.html#a48e81a1806b5774943fd9a26e9a190f2">physics</a> = (<a class="code" href="a00206.html">ShallowWater2D</a>*) calloc (1,<span class="keyword">sizeof</span>(<a class="code" href="a00206.html">ShallowWater2D</a>));</div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;      <a class="code" href="a00218.html#ad6ab74942c9de13cf0b4c12eb0d91780">IERR</a> <a class="code" href="a00241.html#a9182e40f0c923b05a4280c768bb5a1f6">ShallowWater2DInitialize</a>(solver,mpi); <a class="code" href="a00218.html#add9cf96ae374934d245a1dc1ab697a42">CHECKERR</a>(ierr);</div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;  </div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcmp(solver-&gt;<a class="code" href="a00194.html#ad3fe4b266b398f3a7567ac1b241d99a2">model</a>,<a class="code" href="a00213.html#a83dc099011b8d965235f462a935f4830">_VLASOV_</a>)) {</div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;  </div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;      solver-&gt;<a class="code" href="a00194.html#a48e81a1806b5774943fd9a26e9a190f2">physics</a> = (<a class="code" href="a00213.html#a00628">Vlasov</a>*) calloc (1,<span class="keyword">sizeof</span>(<a class="code" href="a00213.html#a00628">Vlasov</a>));</div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;      <a class="code" href="a00218.html#ad6ab74942c9de13cf0b4c12eb0d91780">IERR</a> <a class="code" href="a00213.html#a527a443cc8715a3e4dfc554046d0bb3d">VlasovInitialize</a>(solver,mpi); <a class="code" href="a00218.html#add9cf96ae374934d245a1dc1ab697a42">CHECKERR</a>(ierr);</div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;  </div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;    }<span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;  </div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;      fprintf(stderr,<span class="stringliteral">&quot;Error (domain %d): %s is not a supported physical model.\n&quot;</span>,</div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;              ns, solver-&gt;<a class="code" href="a00194.html#ad3fe4b266b398f3a7567ac1b241d99a2">model</a>);</div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;      <span class="keywordflow">return</span>(1);</div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;  </div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;    }</div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;  </div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;    <span class="comment">/* some checks */</span></div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;    <span class="keywordflow">if</span> ( ( (solver-&gt;<a class="code" href="a00194.html#a8c603c73be1f08e408a1de94a088da7b">GetLeftEigenvectors</a> == NULL) || (solver-&gt;<a class="code" href="a00194.html#a22eef349f191a1aa267e14b08140c823">GetRightEigenvectors</a> == NULL) )</div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;        &amp;&amp; (!strcmp(solver-&gt;<a class="code" href="a00194.html#a9591ba0fadb863561474e2ba251d2594">interp_type</a>,<a class="code" href="a00183.html#aa7752b40155314f9f2c063d4d9d8339d">_CHARACTERISTIC_</a>)) &amp;&amp; (solver-&gt;<a class="code" href="a00194.html#ae8f6d2fd6490d3153cb4133bf183a404">nvars</a> &gt; 1) ) {</div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;      <span class="keywordflow">if</span> (!mpi-&gt;<a class="code" href="a00197.html#a6cfd95afd0afebd625b889fb6e58371c">rank</a>) {</div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;        fprintf(stderr,<span class="stringliteral">&quot;Error (domain %d): Interpolation type is defined as characteristic &quot;</span>, ns);</div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;        fprintf(stderr,<span class="stringliteral">&quot;but physics initializations returned NULL pointers for &quot;</span>);</div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;        fprintf(stderr,<span class="stringliteral">&quot;Get(Left,Right)Eigenvectors needed for characteristic-based &quot;</span>);</div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;        fprintf(stderr,<span class="stringliteral">&quot;reconstruction.\n&quot;</span>);</div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;      }</div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;      <span class="keywordflow">return</span>(1);</div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;    }</div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;  </div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;    <span class="keywordflow">if</span> (!strcmp(solver-&gt;<a class="code" href="a00194.html#a5bed0cb9665daad89f4377c4f7609df4">SplitHyperbolicFlux</a>,<span class="stringliteral">&quot;yes&quot;</span>)) {</div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;      <span class="keywordflow">if</span> ((!solver-&gt;<a class="code" href="a00194.html#aa1dd38befc4bb4adda9d456146436b14">dFFunction</a>) || (!solver-&gt;<a class="code" href="a00194.html#a73a85f83072e02bf979234486265b6d3">UpwinddF</a>)) {</div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;        <span class="keywordflow">if</span> (!mpi-&gt;<a class="code" href="a00197.html#a6cfd95afd0afebd625b889fb6e58371c">rank</a>) {</div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;          fprintf(stderr,<span class="stringliteral">&quot;Error (domain %d): Splitting of hyperbolic flux requires a dFFunction &quot;</span>, ns);</div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;          fprintf(stderr,<span class="stringliteral">&quot;and its upwinding function UpwinddF.\n&quot;</span>);</div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;          fprintf(stderr,<span class="stringliteral">&quot;Error: f(u) = [f(u) - df(u)] + df(u).\n&quot;</span>);</div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;          fprintf(stderr,<span class="stringliteral">&quot;Error: dFFunction or UpwinddF (or both) is (are) NULL.\n&quot;</span>);</div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;        }</div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;        <span class="keywordflow">return</span>(1);</div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;      }</div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;      <span class="keywordflow">if</span> (solver-&gt;<a class="code" href="a00194.html#adcc5e677515d0952ce3ff702c9d85b86">FdFFunction</a> &amp;&amp; solver-&gt;<a class="code" href="a00194.html#ab06746933e859e829d694505c18258b3">UpwindFdF</a>) solver-&gt;<a class="code" href="a00194.html#ad607f82c4bfde055613e05272f9afd81">flag_fdf_specified</a> = 1;</div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;      <span class="keywordflow">else</span>                                          solver-&gt;<a class="code" href="a00194.html#ad607f82c4bfde055613e05272f9afd81">flag_fdf_specified</a> = 0;</div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;    }</div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;  </div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;    <span class="keywordflow">if</span> ((solver-&gt;<a class="code" href="a00194.html#a0d9d4a968c52356bd63f45ad76112245">IBFunction</a> == NULL) &amp;&amp; (solver-&gt;<a class="code" href="a00194.html#ae83b1b0117b6a805ead2e4728945814c">flag_ib</a>)) {</div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;      <span class="keywordflow">if</span> (!mpi-&gt;<a class="code" href="a00197.html#a6cfd95afd0afebd625b889fb6e58371c">rank</a>) {</div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;        fprintf(stderr,<span class="stringliteral">&quot;Error in InitializePhysics() (domain %d): Physical model %s does not yet have an immersed boundary treatment.\n&quot;</span>,</div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;                ns, solver-&gt;<a class="code" href="a00194.html#ad3fe4b266b398f3a7567ac1b241d99a2">model</a>);</div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;      }</div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;      <span class="keywordflow">return</span>(1);</div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;    }</div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;</div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;  }</div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;</div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;  <span class="keywordflow">return</span>(0);</div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;}</div>
<div class="ttc" id="a00194_html_a356e3534ee0048e05c5ea3ca091c33d8"><div class="ttname"><a href="a00194.html#a356e3534ee0048e05c5ea3ca091c33d8">HyPar::PostStage</a></div><div class="ttdeci">int(* PostStage)(double *, void *, void *, double)</div><div class="ttdef"><b>Definition:</b> <a href="a00224_source.html#l00313">hypar.h:313</a></div></div>
<div class="ttc" id="a00194_html_a4ac8912d5ab1bdedff4546d24910ae71"><div class="ttname"><a href="a00194.html#a4ac8912d5ab1bdedff4546d24910ae71">HyPar::PhysicsInput</a></div><div class="ttdeci">int(* PhysicsInput)(void *, void *, int, int, int *)</div><div class="ttdef"><b>Definition:</b> <a href="a00224_source.html#l00327">hypar.h:327</a></div></div>
<div class="ttc" id="a00197_html_a6cfd95afd0afebd625b889fb6e58371c"><div class="ttname"><a href="a00197.html#a6cfd95afd0afebd625b889fb6e58371c">MPIVariables::rank</a></div><div class="ttdeci">int rank</div><div class="ttdef"><b>Definition:</b> <a href="a00197_source.html#l00025">mpivars_struct.h:25</a></div></div>
<div class="ttc" id="a00191_html_aaeb0de68ad20c63864e1a6cdf819e836"><div class="ttname"><a href="a00191.html#aaeb0de68ad20c63864e1a6cdf819e836">_FP_POWER_SYSTEM_</a></div><div class="ttdeci">#define _FP_POWER_SYSTEM_</div><div class="ttdef"><b>Definition:</b> <a href="a00191_source.html#l00044">fppowersystem.h:44</a></div></div>
<div class="ttc" id="a00208_html_a4afd2c7b3eb8fda452474ebdbe71c8c0"><div class="ttname"><a href="a00208.html#a4afd2c7b3eb8fda452474ebdbe71c8c0">SimulationObject::mpi</a></div><div class="ttdeci">MPIVariables mpi</div><div class="ttdef"><b>Definition:</b> <a href="a00208_source.html#l00025">simulation_object.h:25</a></div></div>
<div class="ttc" id="a00194_html_a8c603c73be1f08e408a1de94a088da7b"><div class="ttname"><a href="a00194.html#a8c603c73be1f08e408a1de94a088da7b">HyPar::GetLeftEigenvectors</a></div><div class="ttdeci">int(* GetLeftEigenvectors)(double *, double *, void *, int)</div><div class="ttdef"><b>Definition:</b> <a href="a00224_source.html#l00333">hypar.h:333</a></div></div>
<div class="ttc" id="a00191_html_a00615"><div class="ttname"><a href="a00191.html#a00615">FPPowerSystem</a></div><div class="ttdef"><b>Definition:</b> <a href="a00191_source.html#l00052">fppowersystem.h:52</a></div></div>
<div class="ttc" id="a00194_html_ad3fe4b266b398f3a7567ac1b241d99a2"><div class="ttname"><a href="a00194.html#ad3fe4b266b398f3a7567ac1b241d99a2">HyPar::model</a></div><div class="ttdeci">char model[_MAX_STRING_SIZE_]</div><div class="ttdef"><b>Definition:</b> <a href="a00224_source.html#l00250">hypar.h:250</a></div></div>
<div class="ttc" id="a00241_html_a9182e40f0c923b05a4280c768bb5a1f6"><div class="ttname"><a href="a00241.html#a9182e40f0c923b05a4280c768bb5a1f6">ShallowWater2DInitialize</a></div><div class="ttdeci">int ShallowWater2DInitialize(void *, void *)</div><div class="ttdef"><b>Definition:</b> <a href="a00528_source.html#l00037">ShallowWater2DInitialize.c:37</a></div></div>
<div class="ttc" id="a00213_html_a83dc099011b8d965235f462a935f4830"><div class="ttname"><a href="a00213.html#a83dc099011b8d965235f462a935f4830">_VLASOV_</a></div><div class="ttdeci">#define _VLASOV_</div><div class="ttdef"><b>Definition:</b> <a href="a00213_source.html#l00033">vlasov.h:33</a></div></div>
<div class="ttc" id="a00218_html_ad6ab74942c9de13cf0b4c12eb0d91780"><div class="ttname"><a href="a00218.html#ad6ab74942c9de13cf0b4c12eb0d91780">IERR</a></div><div class="ttdeci">#define IERR</div><div class="ttdef"><b>Definition:</b> <a href="a00218_source.html#l00012">basic.h:12</a></div></div>
<div class="ttc" id="a00194_html_a5bed0cb9665daad89f4377c4f7609df4"><div class="ttname"><a href="a00194.html#a5bed0cb9665daad89f4377c4f7609df4">HyPar::SplitHyperbolicFlux</a></div><div class="ttdeci">char SplitHyperbolicFlux[_MAX_STRING_SIZE_]</div><div class="ttdef"><b>Definition:</b> <a href="a00224_source.html#l00084">hypar.h:84</a></div></div>
<div class="ttc" id="a00194_html_a48e81a1806b5774943fd9a26e9a190f2"><div class="ttname"><a href="a00194.html#a48e81a1806b5774943fd9a26e9a190f2">HyPar::physics</a></div><div class="ttdeci">void * physics</div><div class="ttdef"><b>Definition:</b> <a href="a00224_source.html#l00253">hypar.h:253</a></div></div>
<div class="ttc" id="a00199_html_a04e16b3f2a882826e604b6353d9e5bcb"><div class="ttname"><a href="a00199.html#a04e16b3f2a882826e604b6353d9e5bcb">_NAVIER_STOKES_2D_</a></div><div class="ttdeci">#define _NAVIER_STOKES_2D_</div><div class="ttdef"><b>Definition:</b> <a href="a00199_source.html#l00047">navierstokes2d.h:47</a></div></div>
<div class="ttc" id="a00208_html_a00626"><div class="ttname"><a href="a00208.html#a00626">SimulationObject</a></div><div class="ttdoc">Structure defining a simulation. </div><div class="ttdef"><b>Definition:</b> <a href="a00208_source.html#l00023">simulation_object.h:23</a></div></div>
<div class="ttc" id="a00194_html_a15eea1647344c503deb1d9f89cead631"><div class="ttname"><a href="a00194.html#a15eea1647344c503deb1d9f89cead631">HyPar::JFunction</a></div><div class="ttdeci">int(* JFunction)(double *, double *, void *, int, int)</div><div class="ttdef"><b>Definition:</b> <a href="a00224_source.html#l00308">hypar.h:308</a></div></div>
<div class="ttc" id="a00194_html_aa1dd38befc4bb4adda9d456146436b14"><div class="ttname"><a href="a00194.html#aa1dd38befc4bb4adda9d456146436b14">HyPar::dFFunction</a></div><div class="ttdeci">int(* dFFunction)(double *, double *, int, void *, double)</div><div class="ttdef"><b>Definition:</b> <a href="a00224_source.html#l00266">hypar.h:266</a></div></div>
<div class="ttc" id="a00196_html_a78c1fbb2ddae048ddb9d2863ad4f65b3"><div class="ttname"><a href="a00196.html#a78c1fbb2ddae048ddb9d2863ad4f65b3">LinearADRInitialize</a></div><div class="ttdeci">int LinearADRInitialize(void *, void *)</div><div class="ttdef"><b>Definition:</b> <a href="a00462_source.html#l00057">LinearADRInitialize.c:57</a></div></div>
<div class="ttc" id="a00201_html"><div class="ttname"><a href="a00201.html">Numa2D</a></div><div class="ttdef"><b>Definition:</b> <a href="a00238_source.html#l00109">numa2d.h:109</a></div></div>
<div class="ttc" id="a00199_html_abdd7dcd1ec7c37af027441f521dbe844"><div class="ttname"><a href="a00199.html#abdd7dcd1ec7c37af027441f521dbe844">NavierStokes2DInitialize</a></div><div class="ttdeci">int NavierStokes2DInitialize(void *, void *)</div><div class="ttdef"><b>Definition:</b> <a href="a00473_source.html#l00093">NavierStokes2DInitialize.c:93</a></div></div>
<div class="ttc" id="a00194_html_a0d895f9bb0c8a3e79a64dd2379e1f2dd"><div class="ttname"><a href="a00194.html#a0d895f9bb0c8a3e79a64dd2379e1f2dd">HyPar::FFunction</a></div><div class="ttdeci">int(* FFunction)(double *, double *, int, void *, double)</div><div class="ttdef"><b>Definition:</b> <a href="a00224_source.html#l00262">hypar.h:262</a></div></div>
<div class="ttc" id="a00241_html_aebe5d4a29761b0784c3d3e67e325105b"><div class="ttname"><a href="a00241.html#aebe5d4a29761b0784c3d3e67e325105b">_SHALLOW_WATER_2D_</a></div><div class="ttdeci">#define _SHALLOW_WATER_2D_</div><div class="ttdef"><b>Definition:</b> <a href="a00241_source.html#l00043">shallowwater2d.h:43</a></div></div>
<div class="ttc" id="a00238_html_a82b3f90650895890211635171d649355"><div class="ttname"><a href="a00238.html#a82b3f90650895890211635171d649355">_NUMA2D_</a></div><div class="ttdeci">#define _NUMA2D_</div><div class="ttdef"><b>Definition:</b> <a href="a00238_source.html#l00021">numa2d.h:21</a></div></div>
<div class="ttc" id="a00218_html_a68f50121fb9a7daeaf60e50cdef82ef3"><div class="ttname"><a href="a00218.html#a68f50121fb9a7daeaf60e50cdef82ef3">_DECLARE_IERR_</a></div><div class="ttdeci">#define _DECLARE_IERR_</div><div class="ttdef"><b>Definition:</b> <a href="a00218_source.html#l00013">basic.h:13</a></div></div>
<div class="ttc" id="a00194_html_ab06746933e859e829d694505c18258b3"><div class="ttname"><a href="a00194.html#ab06746933e859e829d694505c18258b3">HyPar::UpwindFdF</a></div><div class="ttdeci">int(* UpwindFdF)(double *, double *, double *, double *, double *, double *, int, void *, double)</div><div class="ttdef"><b>Definition:</b> <a href="a00224_source.html#l00291">hypar.h:291</a></div></div>
<div class="ttc" id="a00240_html_a66b9f9e2ed58d68a910cbd5522381fa2"><div class="ttname"><a href="a00240.html#a66b9f9e2ed58d68a910cbd5522381fa2">ShallowWater1DInitialize</a></div><div class="ttdeci">int ShallowWater1DInitialize(void *, void *)</div><div class="ttdef"><b>Definition:</b> <a href="a00515_source.html#l00037">ShallowWater1DInitialize.c:37</a></div></div>
<div class="ttc" id="a00182_html_a0496194e6f2d5608086a3020f3f7ccb5"><div class="ttname"><a href="a00182.html#a0496194e6f2d5608086a3020f3f7ccb5">_BURGERS_</a></div><div class="ttdeci">#define _BURGERS_</div><div class="ttdef"><b>Definition:</b> <a href="a00182_source.html#l00014">burgers.h:14</a></div></div>
<div class="ttc" id="a00194_html_a7eb68b9643feb74bd49f3a171b66eef1"><div class="ttname"><a href="a00194.html#a7eb68b9643feb74bd49f3a171b66eef1">HyPar::Upwind</a></div><div class="ttdeci">int(* Upwind)(double *, double *, double *, double *, double *, double *, int, void *, double)</div><div class="ttdef"><b>Definition:</b> <a href="a00224_source.html#l00279">hypar.h:279</a></div></div>
<div class="ttc" id="a00182_html_a28344a004f73d2e3391ef01f4419bd9a"><div class="ttname"><a href="a00182.html#a28344a004f73d2e3391ef01f4419bd9a">BurgersInitialize</a></div><div class="ttdeci">int BurgersInitialize(void *, void *)</div><div class="ttdef"><b>Definition:</b> <a href="a00397_source.html#l00025">BurgersInitialize.c:25</a></div></div>
<div class="ttc" id="a00196_html_a44c745170d88218420752d150856b01c"><div class="ttname"><a href="a00196.html#a44c745170d88218420752d150856b01c">_LINEAR_ADVECTION_DIFFUSION_REACTION_</a></div><div class="ttdeci">#define _LINEAR_ADVECTION_DIFFUSION_REACTION_</div><div class="ttdef"><b>Definition:</b> <a href="a00196_source.html#l00021">linearadr.h:21</a></div></div>
<div class="ttc" id="a00239_html_a8bccae14dde8eaba7663344939367e96"><div class="ttname"><a href="a00239.html#a8bccae14dde8eaba7663344939367e96">_NUMA3D_</a></div><div class="ttdeci">#define _NUMA3D_</div><div class="ttdef"><b>Definition:</b> <a href="a00239_source.html#l00026">numa3d.h:26</a></div></div>
<div class="ttc" id="a00206_html"><div class="ttname"><a href="a00206.html">ShallowWater2D</a></div><div class="ttdoc">Structure containing variables and parameters specific to the 2D Shallow Water equations. This structure contains the physical parameters, variables, and function pointers specific to the 2D ShallowWater equations. </div><div class="ttdef"><b>Definition:</b> <a href="a00241_source.html#l00240">shallowwater2d.h:240</a></div></div>
<div class="ttc" id="a00237_html_a076991b7fbc2b9c6330f792bbba182c2"><div class="ttname"><a href="a00237.html#a076991b7fbc2b9c6330f792bbba182c2">_EULER_1D_</a></div><div class="ttdeci">#define _EULER_1D_</div><div class="ttdef"><b>Definition:</b> <a href="a00237_source.html#l00050">euler1d.h:50</a></div></div>
<div class="ttc" id="a00194_html_ad607f82c4bfde055613e05272f9afd81"><div class="ttname"><a href="a00194.html#ad607f82c4bfde055613e05272f9afd81">HyPar::flag_fdf_specified</a></div><div class="ttdeci">int flag_fdf_specified</div><div class="ttdef"><b>Definition:</b> <a href="a00224_source.html#l00276">hypar.h:276</a></div></div>
<div class="ttc" id="a00194_html_a22eef349f191a1aa267e14b08140c823"><div class="ttname"><a href="a00194.html#a22eef349f191a1aa267e14b08140c823">HyPar::GetRightEigenvectors</a></div><div class="ttdeci">int(* GetRightEigenvectors)(double *, double *, void *, int)</div><div class="ttdef"><b>Definition:</b> <a href="a00224_source.html#l00335">hypar.h:335</a></div></div>
<div class="ttc" id="a00193_html_a00617"><div class="ttname"><a href="a00193.html#a00617">FPPowerSystem3Bus</a></div><div class="ttdoc">Structure containing variable and parameters specific to the 3-bus power system model. This structure contains the physical parameters and variables for the Fokker-Planck model for a 3-bus power system. </div><div class="ttdef"><b>Definition:</b> <a href="a00193_source.html#l00049">fppowersystem3bus.h:49</a></div></div>
<div class="ttc" id="a00194_html_a9591ba0fadb863561474e2ba251d2594"><div class="ttname"><a href="a00194.html#a9591ba0fadb863561474e2ba251d2594">HyPar::interp_type</a></div><div class="ttdeci">char interp_type[_MAX_STRING_SIZE_]</div><div class="ttdef"><b>Definition:</b> <a href="a00224_source.html#l00080">hypar.h:80</a></div></div>
<div class="ttc" id="a00200_html_a0385acf3caf014aa7491ad2fc6a9572a"><div class="ttname"><a href="a00200.html#a0385acf3caf014aa7491ad2fc6a9572a">NavierStokes3DInitialize</a></div><div class="ttdeci">int NavierStokes3DInitialize(void *, void *)</div><div class="ttdef"><b>Definition:</b> <a href="a00488_source.html#l00104">NavierStokes3DInitialize.c:104</a></div></div>
<div class="ttc" id="a00187_html"><div class="ttname"><a href="a00187.html">Euler1D</a></div><div class="ttdoc">Structure containing variables and parameters specific to the 1D Euler equations. This structure cont...</div><div class="ttdef"><b>Definition:</b> <a href="a00237_source.html#l00273">euler1d.h:273</a></div></div>
<div class="ttc" id="a00194_html_a1685cd0c6b8c413bdbbe86d8f4475c58"><div class="ttname"><a href="a00194.html#a1685cd0c6b8c413bdbbe86d8f4475c58">HyPar::SFunction</a></div><div class="ttdeci">int(* SFunction)(double *, double *, void *, void *, double)</div><div class="ttdef"><b>Definition:</b> <a href="a00224_source.html#l00300">hypar.h:300</a></div></div>
<div class="ttc" id="a00237_html_a2143f7f3c03f53cf752a344a613fe429"><div class="ttname"><a href="a00237.html#a2143f7f3c03f53cf752a344a613fe429">Euler1DInitialize</a></div><div class="ttdeci">int Euler1DInitialize(void *, void *)</div><div class="ttdef"><b>Definition:</b> <a href="a00405_source.html#l00071">Euler1DInitialize.c:71</a></div></div>
<div class="ttc" id="a00194_html_aa4ef2f3e9fcc13ef7b8885b8a7145967"><div class="ttname"><a href="a00194.html#aa4ef2f3e9fcc13ef7b8885b8a7145967">HyPar::PrintStep</a></div><div class="ttdeci">int(* PrintStep)(void *, void *, double)</div><div class="ttdef"><b>Definition:</b> <a href="a00224_source.html#l00320">hypar.h:320</a></div></div>
<div class="ttc" id="a00190_html_a00614"><div class="ttname"><a href="a00190.html#a00614">FPDoubleWell</a></div><div class="ttdef"><b>Definition:</b> <a href="a00190_source.html#l00026">fpdoublewell.h:26</a></div></div>
<div class="ttc" id="a00199_html_a00623"><div class="ttname"><a href="a00199.html#a00623">NavierStokes2D</a></div><div class="ttdoc">Structure containing variables and parameters specific to the 2D Navier Stokes equations. This structure contains the physical parameters, variables, and function pointers specific to the 2D Navier-Stokes equations. </div><div class="ttdef"><b>Definition:</b> <a href="a00199_source.html#l00376">navierstokes2d.h:376</a></div></div>
<div class="ttc" id="a00193_html_a5c8fe736dacda1a087bf1fb514761d6e"><div class="ttname"><a href="a00193.html#a5c8fe736dacda1a087bf1fb514761d6e">_FP_POWER_SYSTEM_3BUS_</a></div><div class="ttdeci">#define _FP_POWER_SYSTEM_3BUS_</div><div class="ttdef"><b>Definition:</b> <a href="a00193_source.html#l00030">fppowersystem3bus.h:30</a></div></div>
<div class="ttc" id="a00192_html_a104fb063ee608b39fdab8d5e1e752ca3"><div class="ttname"><a href="a00192.html#a104fb063ee608b39fdab8d5e1e752ca3">_FP_POWER_SYSTEM_1BUS_</a></div><div class="ttdeci">#define _FP_POWER_SYSTEM_1BUS_</div><div class="ttdef"><b>Definition:</b> <a href="a00192_source.html#l00068">fppowersystem1bus.h:68</a></div></div>
<div class="ttc" id="a00194_html_ab4c55736e92f7d72f04b8a957d82b054"><div class="ttname"><a href="a00194.html#ab4c55736e92f7d72f04b8a957d82b054">HyPar::PhysicsOutput</a></div><div class="ttdeci">int(* PhysicsOutput)(void *, void *)</div><div class="ttdef"><b>Definition:</b> <a href="a00224_source.html#l00323">hypar.h:323</a></div></div>
<div class="ttc" id="a00194_html_a0d9d4a968c52356bd63f45ad76112245"><div class="ttname"><a href="a00194.html#a0d9d4a968c52356bd63f45ad76112245">HyPar::IBFunction</a></div><div class="ttdeci">int(* IBFunction)(void *, void *, double *, double)</div><div class="ttdef"><b>Definition:</b> <a href="a00224_source.html#l00422">hypar.h:422</a></div></div>
<div class="ttc" id="a00218_html_add9cf96ae374934d245a1dc1ab697a42"><div class="ttname"><a href="a00218.html#add9cf96ae374934d245a1dc1ab697a42">CHECKERR</a></div><div class="ttdeci">#define CHECKERR(ierr)</div><div class="ttdef"><b>Definition:</b> <a href="a00218_source.html#l00014">basic.h:14</a></div></div>
<div class="ttc" id="a00213_html_a527a443cc8715a3e4dfc554046d0bb3d"><div class="ttname"><a href="a00213.html#a527a443cc8715a3e4dfc554046d0bb3d">VlasovInitialize</a></div><div class="ttdeci">int VlasovInitialize(void *, void *)</div><div class="ttdef"><b>Definition:</b> <a href="a00542_source.html#l00039">VlasovInitialize.c:39</a></div></div>
<div class="ttc" id="a00194_html_adcc5e677515d0952ce3ff702c9d85b86"><div class="ttname"><a href="a00194.html#adcc5e677515d0952ce3ff702c9d85b86">HyPar::FdFFunction</a></div><div class="ttdeci">int(* FdFFunction)(double *, double *, int, void *, double)</div><div class="ttdef"><b>Definition:</b> <a href="a00224_source.html#l00272">hypar.h:272</a></div></div>
<div class="ttc" id="a00197_html_a00622"><div class="ttname"><a href="a00197.html#a00622">MPIVariables</a></div><div class="ttdoc">Structure of MPI-related variables. </div><div class="ttdef"><b>Definition:</b> <a href="a00197_source.html#l00024">mpivars_struct.h:24</a></div></div>
<div class="ttc" id="a00205_html"><div class="ttname"><a href="a00205.html">ShallowWater1D</a></div><div class="ttdoc">Structure containing variables and parameters specific to the 1D Shallow Water equations. This structure contains the physical parameters, variables, and function pointers specific to the 1D ShallowWater equations. </div><div class="ttdef"><b>Definition:</b> <a href="a00240_source.html#l00137">shallowwater1d.h:137</a></div></div>
<div class="ttc" id="a00188_html_a7c85bdac3c8b5f3bb3bd83fdae2e52e8"><div class="ttname"><a href="a00188.html#a7c85bdac3c8b5f3bb3bd83fdae2e52e8">Euler2DInitialize</a></div><div class="ttdeci">int Euler2DInitialize(void *, void *)</div><div class="ttdef"><b>Definition:</b> <a href="a00417_source.html#l00021">Euler2DInitialize.c:21</a></div></div>
<div class="ttc" id="a00208_html_a523947ce4fa7128c4c767163953253b9"><div class="ttname"><a href="a00208.html#a523947ce4fa7128c4c767163953253b9">SimulationObject::solver</a></div><div class="ttdeci">HyPar solver</div><div class="ttdef"><b>Definition:</b> <a href="a00208_source.html#l00026">simulation_object.h:26</a></div></div>
<div class="ttc" id="a00194_html_a85a6422b0b08263704165a2a14719033"><div class="ttname"><a href="a00194.html#a85a6422b0b08263704165a2a14719033">HyPar::PostStep</a></div><div class="ttdeci">int(* PostStep)(double *, void *, void *, double, int)</div><div class="ttdef"><b>Definition:</b> <a href="a00224_source.html#l00317">hypar.h:317</a></div></div>
<div class="ttc" id="a00194_html_ae8f6d2fd6490d3153cb4133bf183a404"><div class="ttname"><a href="a00194.html#ae8f6d2fd6490d3153cb4133bf183a404">HyPar::nvars</a></div><div class="ttdeci">int nvars</div><div class="ttdef"><b>Definition:</b> <a href="a00224_source.html#l00029">hypar.h:29</a></div></div>
<div class="ttc" id="a00200_html_a34099431ed2606bd884d36cea1d0448e"><div class="ttname"><a href="a00200.html#a34099431ed2606bd884d36cea1d0448e">_NAVIER_STOKES_3D_</a></div><div class="ttdeci">#define _NAVIER_STOKES_3D_</div><div class="ttdef"><b>Definition:</b> <a href="a00200_source.html#l00050">navierstokes3d.h:50</a></div></div>
<div class="ttc" id="a00194_html_ae83b1b0117b6a805ead2e4728945814c"><div class="ttname"><a href="a00194.html#ae83b1b0117b6a805ead2e4728945814c">HyPar::flag_ib</a></div><div class="ttdeci">int flag_ib</div><div class="ttdef"><b>Definition:</b> <a href="a00224_source.html#l00417">hypar.h:417</a></div></div>
<div class="ttc" id="a00239_html_aad8263a96673a7500502bc9d88c9fd41"><div class="ttname"><a href="a00239.html#aad8263a96673a7500502bc9d88c9fd41">Numa3DInitialize</a></div><div class="ttdeci">int Numa3DInitialize(void *, void *)</div><div class="ttdef"><b>Definition:</b> <a href="a00507_source.html#l00024">Numa3DInitialize.c:24</a></div></div>
<div class="ttc" id="a00183_html_aa7752b40155314f9f2c063d4d9d8339d"><div class="ttname"><a href="a00183.html#aa7752b40155314f9f2c063d4d9d8339d">_CHARACTERISTIC_</a></div><div class="ttdeci">#define _CHARACTERISTIC_</div><div class="ttdef"><b>Definition:</b> <a href="a00183_source.html#l00033">interpolation.h:33</a></div></div>
<div class="ttc" id="a00213_html_a00628"><div class="ttname"><a href="a00213.html#a00628">Vlasov</a></div><div class="ttdef"><b>Definition:</b> <a href="a00213_source.html#l00053">vlasov.h:53</a></div></div>
<div class="ttc" id="a00190_html_af48e8eb8a81020a97b3b7b039bb94626"><div class="ttname"><a href="a00190.html#af48e8eb8a81020a97b3b7b039bb94626">FPDoubleWellInitialize</a></div><div class="ttdeci">int FPDoubleWellInitialize(void *, void *)</div><div class="ttdef"><b>Definition:</b> <a href="a00424_source.html#l00019">FPDoubleWellInitialize.c:19</a></div></div>
<div class="ttc" id="a00182_html_a00608"><div class="ttname"><a href="a00182.html#a00608">Burgers</a></div><div class="ttdef"><b>Definition:</b> <a href="a00182_source.html#l00016">burgers.h:16</a></div></div>
<div class="ttc" id="a00192_html_a00616"><div class="ttname"><a href="a00192.html#a00616">FPPowerSystem1Bus</a></div><div class="ttdef"><b>Definition:</b> <a href="a00192_source.html#l00080">fppowersystem1bus.h:80</a></div></div>
<div class="ttc" id="a00194_html_ad00c58573b5bcfe8c8bb72eed3dc7ad8"><div class="ttname"><a href="a00194.html#ad00c58573b5bcfe8c8bb72eed3dc7ad8">HyPar::PreStage</a></div><div class="ttdeci">int(* PreStage)(int, double **, void *, void *, double)</div><div class="ttdef"><b>Definition:</b> <a href="a00224_source.html#l00311">hypar.h:311</a></div></div>
<div class="ttc" id="a00193_html_ac493c18d35f80f5207a03d0be4778617"><div class="ttname"><a href="a00193.html#ac493c18d35f80f5207a03d0be4778617">FPPowerSystem3BusInitialize</a></div><div class="ttdeci">int FPPowerSystem3BusInitialize(void *, void *)</div><div class="ttdef"><b>Definition:</b> <a href="a00454_source.html#l00027">FPPowerSystem3BusInitialize.c:27</a></div></div>
<div class="ttc" id="a00194_html_ad8f03ca8c9fd6e1e235203495e8f2173"><div class="ttname"><a href="a00194.html#ad8f03ca8c9fd6e1e235203495e8f2173">HyPar::GFunction</a></div><div class="ttdeci">int(* GFunction)(double *, double *, int, void *, double)</div><div class="ttdef"><b>Definition:</b> <a href="a00224_source.html#l00294">hypar.h:294</a></div></div>
<div class="ttc" id="a00192_html_aa498ad8f4fd87b8a18d2d81e327d7013"><div class="ttname"><a href="a00192.html#aa498ad8f4fd87b8a18d2d81e327d7013">FPPowerSystem1BusInitialize</a></div><div class="ttdeci">int FPPowerSystem1BusInitialize(void *, void *)</div><div class="ttdef"><b>Definition:</b> <a href="a00444_source.html#l00021">FPPowerSystem1BusInitialize.c:21</a></div></div>
<div class="ttc" id="a00200_html_a00624"><div class="ttname"><a href="a00200.html#a00624">NavierStokes3D</a></div><div class="ttdoc">Structure containing variables and parameters specific to the 3D Navier Stokes equations. This structure contains the physical parameters, variables, and function pointers specific to the 3D Navier-Stokes equations. </div><div class="ttdef"><b>Definition:</b> <a href="a00200_source.html#l00484">navierstokes3d.h:484</a></div></div>
<div class="ttc" id="a00188_html_ae205e355df87a13c8b47c958828bce2f"><div class="ttname"><a href="a00188.html#ae205e355df87a13c8b47c958828bce2f">_EULER_2D_</a></div><div class="ttdeci">#define _EULER_2D_</div><div class="ttdef"><b>Definition:</b> <a href="a00188_source.html#l00025">euler2d.h:25</a></div></div>
<div class="ttc" id="a00194_html_a73ad2e9dae43bf438ab8bfc4cd2e1bdd"><div class="ttname"><a href="a00194.html#a73ad2e9dae43bf438ab8bfc4cd2e1bdd">HyPar::ComputeCFL</a></div><div class="ttdeci">double(* ComputeCFL)(void *, void *, double, double)</div><div class="ttdef"><b>Definition:</b> <a href="a00224_source.html#l00256">hypar.h:256</a></div></div>
<div class="ttc" id="a00194_html_a7331366d789b2995436accbc35e1cc80"><div class="ttname"><a href="a00194.html#a7331366d789b2995436accbc35e1cc80">HyPar::AveragingFunction</a></div><div class="ttdeci">int(* AveragingFunction)(double *, double *, double *, void *)</div><div class="ttdef"><b>Definition:</b> <a href="a00224_source.html#l00330">hypar.h:330</a></div></div>
<div class="ttc" id="a00194_html_a49e17e5889baddd411c028afc3b91335"><div class="ttname"><a href="a00194.html#a49e17e5889baddd411c028afc3b91335">HyPar::ComputeDiffNumber</a></div><div class="ttdeci">double(* ComputeDiffNumber)(void *, void *, double, double)</div><div class="ttdef"><b>Definition:</b> <a href="a00224_source.html#l00259">hypar.h:259</a></div></div>
<div class="ttc" id="a00240_html_ac280c6ead138670f1f518fad3ea94737"><div class="ttname"><a href="a00240.html#ac280c6ead138670f1f518fad3ea94737">_SHALLOW_WATER_1D_</a></div><div class="ttdeci">#define _SHALLOW_WATER_1D_</div><div class="ttdef"><b>Definition:</b> <a href="a00240_source.html#l00029">shallowwater1d.h:29</a></div></div>
<div class="ttc" id="a00188_html_a00610"><div class="ttname"><a href="a00188.html#a00610">Euler2D</a></div><div class="ttdef"><b>Definition:</b> <a href="a00188_source.html#l00244">euler2d.h:244</a></div></div>
<div class="ttc" id="a00194_html_a6a34ae8a3044f521e57180a7260f3b42"><div class="ttname"><a href="a00194.html#a6a34ae8a3044f521e57180a7260f3b42">HyPar::PreStep</a></div><div class="ttdeci">int(* PreStep)(double *, void *, void *, double)</div><div class="ttdef"><b>Definition:</b> <a href="a00224_source.html#l00315">hypar.h:315</a></div></div>
<div class="ttc" id="a00194_html"><div class="ttname"><a href="a00194.html">HyPar</a></div><div class="ttdoc">Structure containing all solver-specific variables and functions. </div><div class="ttdef"><b>Definition:</b> <a href="a00224_source.html#l00023">hypar.h:23</a></div></div>
<div class="ttc" id="a00194_html_a73a85f83072e02bf979234486265b6d3"><div class="ttname"><a href="a00194.html#a73a85f83072e02bf979234486265b6d3">HyPar::UpwinddF</a></div><div class="ttdeci">int(* UpwinddF)(double *, double *, double *, double *, double *, double *, int, void *, double)</div><div class="ttdef"><b>Definition:</b> <a href="a00224_source.html#l00284">hypar.h:284</a></div></div>
<div class="ttc" id="a00194_html_af1dc5a4ba2bdc46dfd226e35772b4130"><div class="ttname"><a href="a00194.html#af1dc5a4ba2bdc46dfd226e35772b4130">HyPar::UFunction</a></div><div class="ttdeci">int(* UFunction)(double *, double *, int, void *, void *, double)</div><div class="ttdef"><b>Definition:</b> <a href="a00224_source.html#l00303">hypar.h:303</a></div></div>
<div class="ttc" id="a00238_html_afe3cd0a9dcef80c2cdb1e8928cef9887"><div class="ttname"><a href="a00238.html#afe3cd0a9dcef80c2cdb1e8928cef9887">Numa2DInitialize</a></div><div class="ttdeci">int Numa2DInitialize(void *, void *)</div><div class="ttdef"><b>Definition:</b> <a href="a00499_source.html#l00025">Numa2DInitialize.c:25</a></div></div>
<div class="ttc" id="a00190_html_a801cd9499779d35febbce73603aa70a6"><div class="ttname"><a href="a00190.html#a801cd9499779d35febbce73603aa70a6">_FP_DOUBLE_WELL_</a></div><div class="ttdeci">#define _FP_DOUBLE_WELL_</div><div class="ttdef"><b>Definition:</b> <a href="a00190_source.html#l00018">fpdoublewell.h:18</a></div></div>
<div class="ttc" id="a00196_html_a00621"><div class="ttname"><a href="a00196.html#a00621">LinearADR</a></div><div class="ttdoc">Structure containing variables and parameters specific to the linear advection-diffusion-reaction mod...</div><div class="ttdef"><b>Definition:</b> <a href="a00196_source.html#l00037">linearadr.h:37</a></div></div>
<div class="ttc" id="a00202_html"><div class="ttname"><a href="a00202.html">Numa3D</a></div><div class="ttdef"><b>Definition:</b> <a href="a00239_source.html#l00128">numa3d.h:128</a></div></div>
<div class="ttc" id="a00194_html_a122bcc1ec2e20b3bc69d169580529021"><div class="ttname"><a href="a00194.html#a122bcc1ec2e20b3bc69d169580529021">HyPar::HFunction</a></div><div class="ttdeci">int(* HFunction)(double *, double *, int, int, void *, double)</div><div class="ttdef"><b>Definition:</b> <a href="a00224_source.html#l00297">hypar.h:297</a></div></div>
<div class="ttc" id="a00191_html_abe8191ce0b15220b854bbcda4446b170"><div class="ttname"><a href="a00191.html#abe8191ce0b15220b854bbcda4446b170">FPPowerSystemInitialize</a></div><div class="ttdeci">int FPPowerSystemInitialize(void *, void *)</div><div class="ttdef"><b>Definition:</b> <a href="a00434_source.html#l00020">FPPowerSystemInitialize.c:20</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a71b1a72469ef2aa60521dcfb2fda2f1a"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int InitializePhysicsData </td>
          <td>(</td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>s</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>idx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>nsims</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>dim_data</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Initialize the physics data</p>
<p>For each simulation object, call the physics-specific function to read in any physics data that is not a part of the solution vector. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">s</td><td><a class="el" href="a00207.html" title="Base class for a simulation. ">Simulation</a> object of type <a class="el" href="a00208.html#a00626" title="Structure defining a simulation. ">SimulationObject</a> </td></tr>
    <tr><td class="paramname">idx</td><td>Index of this simulation object </td></tr>
    <tr><td class="paramname">nsims</td><td>Total number of simuations </td></tr>
    <tr><td class="paramname">dim_data</td><td>Dimenions of physics-specific data </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="a00556_source.html#l00012">12</a> of file <a class="el" href="a00556_source.html">InitializePhysicsData.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;{</div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;  <a class="code" href="a00208.html#a00626">SimulationObject</a> *sim     = (<a class="code" href="a00208.html#a00626">SimulationObject</a>*) s;</div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;  <a class="code" href="a00194.html">HyPar</a>            *solver  = &amp;(sim-&gt;<a class="code" href="a00208.html#a523947ce4fa7128c4c767163953253b9">solver</a>);</div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;  <a class="code" href="a00197.html#a00622">MPIVariables</a>     *mpi     = &amp;(sim-&gt;<a class="code" href="a00208.html#a4afd2c7b3eb8fda452474ebdbe71c8c0">mpi</a>);</div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;</div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;  <span class="keywordflow">if</span> (solver-&gt;<a class="code" href="a00194.html#a4ac8912d5ab1bdedff4546d24910ae71">PhysicsInput</a>) {</div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;    <span class="keywordtype">int</span> ierr = solver-&gt;<a class="code" href="a00194.html#a4ac8912d5ab1bdedff4546d24910ae71">PhysicsInput</a>(solver, mpi, idx, nsims, dim_data);</div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;    <span class="keywordflow">if</span> (ierr) {</div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;      fprintf(stderr, <span class="stringliteral">&quot;Error in InitializePhysicsData():\n&quot;</span>);</div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;      fprintf(stderr, <span class="stringliteral">&quot;  solver-&gt;PhysicsInput() returned error %d on rank %d\n&quot;</span>, </div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;              ierr, mpi-&gt;<a class="code" href="a00197.html#a6cfd95afd0afebd625b889fb6e58371c">rank</a>);</div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;      <span class="keywordflow">return</span> ierr;</div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;    }</div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;  }</div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;</div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;  <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;}</div>
<div class="ttc" id="a00194_html_a4ac8912d5ab1bdedff4546d24910ae71"><div class="ttname"><a href="a00194.html#a4ac8912d5ab1bdedff4546d24910ae71">HyPar::PhysicsInput</a></div><div class="ttdeci">int(* PhysicsInput)(void *, void *, int, int, int *)</div><div class="ttdef"><b>Definition:</b> <a href="a00224_source.html#l00327">hypar.h:327</a></div></div>
<div class="ttc" id="a00197_html_a6cfd95afd0afebd625b889fb6e58371c"><div class="ttname"><a href="a00197.html#a6cfd95afd0afebd625b889fb6e58371c">MPIVariables::rank</a></div><div class="ttdeci">int rank</div><div class="ttdef"><b>Definition:</b> <a href="a00197_source.html#l00025">mpivars_struct.h:25</a></div></div>
<div class="ttc" id="a00208_html_a4afd2c7b3eb8fda452474ebdbe71c8c0"><div class="ttname"><a href="a00208.html#a4afd2c7b3eb8fda452474ebdbe71c8c0">SimulationObject::mpi</a></div><div class="ttdeci">MPIVariables mpi</div><div class="ttdef"><b>Definition:</b> <a href="a00208_source.html#l00025">simulation_object.h:25</a></div></div>
<div class="ttc" id="a00208_html_a00626"><div class="ttname"><a href="a00208.html#a00626">SimulationObject</a></div><div class="ttdoc">Structure defining a simulation. </div><div class="ttdef"><b>Definition:</b> <a href="a00208_source.html#l00023">simulation_object.h:23</a></div></div>
<div class="ttc" id="a00197_html_a00622"><div class="ttname"><a href="a00197.html#a00622">MPIVariables</a></div><div class="ttdoc">Structure of MPI-related variables. </div><div class="ttdef"><b>Definition:</b> <a href="a00197_source.html#l00024">mpivars_struct.h:24</a></div></div>
<div class="ttc" id="a00208_html_a523947ce4fa7128c4c767163953253b9"><div class="ttname"><a href="a00208.html#a523947ce4fa7128c4c767163953253b9">SimulationObject::solver</a></div><div class="ttdeci">HyPar solver</div><div class="ttdef"><b>Definition:</b> <a href="a00208_source.html#l00026">simulation_object.h:26</a></div></div>
<div class="ttc" id="a00194_html"><div class="ttname"><a href="a00194.html">HyPar</a></div><div class="ttdoc">Structure containing all solver-specific variables and functions. </div><div class="ttdef"><b>Definition:</b> <a href="a00224_source.html#l00023">hypar.h:23</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ad3f393b89ecd5a544c52e1099722337a"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int InitializeSolvers </td>
          <td>(</td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>s</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>nsims</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Initialize the solvers</p>
<p>This function initializes all solvers-specific function pointers depending on user input. The specific functions used for spatial discretization, time integration, and solution output are set here. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">s</td><td>Array of simulation objects of type <a class="el" href="a00208.html#a00626" title="Structure defining a simulation. ">SimulationObject</a> </td></tr>
    <tr><td class="paramname">nsims</td><td>number of simulation objects </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="a00557_source.html#l00041">41</a> of file <a class="el" href="a00557_source.html">InitializeSolvers.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;{</div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;  <a class="code" href="a00208.html#a00626">SimulationObject</a> *sim = (<a class="code" href="a00208.html#a00626">SimulationObject</a>*) s;</div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;  <span class="keywordtype">int</span> ns;</div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;  <a class="code" href="a00218.html#a68f50121fb9a7daeaf60e50cdef82ef3">_DECLARE_IERR_</a>;</div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;</div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;  <span class="keywordflow">if</span> (nsims == 0) <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;</div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;  <span class="keywordflow">if</span> (!sim[0].mpi.rank) {</div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;    printf(<span class="stringliteral">&quot;Initializing solvers.\n&quot;</span>);</div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;  }</div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;</div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;  <span class="keywordflow">for</span> (ns = 0; ns &lt; nsims; ns++) {</div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;</div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;    <a class="code" href="a00194.html">HyPar</a>           *solver   = &amp;(sim[ns].<a class="code" href="a00208.html#a523947ce4fa7128c4c767163953253b9">solver</a>);</div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;    <a class="code" href="a00197.html#a00622">MPIVariables</a>    *mpi      = &amp;(sim[ns].<a class="code" href="a00208.html#a4afd2c7b3eb8fda452474ebdbe71c8c0">mpi</a>);</div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;</div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;    solver-&gt;<a class="code" href="a00194.html#aa4de7bdc1e62417caf51b9c45184268d">ApplyBoundaryConditions</a>     = <a class="code" href="a00282.html#ab68722a270954b6816a785ad4923ba45">ApplyBoundaryConditions</a>;</div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;    solver-&gt;<a class="code" href="a00194.html#a83d97dfc50e6bfefd0db6503d365d5bd">ApplyIBConditions</a>           = <a class="code" href="a00283.html#a63bad563b5163bdada0672cec6d535c0">ApplyIBConditions</a>;</div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;    solver-&gt;<a class="code" href="a00194.html#aa245f8c9e6af37e47c5867dccbbc208b">HyperbolicFunction</a>          = <a class="code" href="a00290.html#a0096c47175c007dbe805b34129835b84">HyperbolicFunction</a>;</div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;    solver-&gt;<a class="code" href="a00194.html#a662e256e081a2b74f971d02c747892b8">SourceFunction</a>              = <a class="code" href="a00297.html#a930d3b66826111c93dc222f5f6382744">SourceFunction</a>;</div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;    solver-&gt;<a class="code" href="a00194.html#a0fda913c8c0424880302e9296cc0e813">VolumeIntegralFunction</a>      = <a class="code" href="a00298.html#a74a4527b7a6060acc1808d9c945b117f">VolumeIntegral</a>;</div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;    solver-&gt;<a class="code" href="a00194.html#a479abc98a0ca73359a33089ba5d37863">BoundaryIntegralFunction</a>    = <a class="code" href="a00284.html#abf698222199fe88976002228400c428d">BoundaryIntegral</a>;</div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;    solver-&gt;<a class="code" href="a00194.html#a2108550c80e1666f11c684fcb4f1ca89">CalculateConservationError</a>  = <a class="code" href="a00285.html#aef9a903e2e2870dbadbae56ab1b62eb7">CalculateConservationError</a>;</div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;    solver-&gt;<a class="code" href="a00194.html#a228697ae6a0f0fe7a928a9ddad45da54">NonlinearInterp</a>             = <a class="code" href="a00292.html#af2e57e55724c44c535903d432a9d6193">NonLinearInterpolation</a>;</div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;  </div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;    <span class="comment">/* choose the type of parabolic discretization */</span></div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;    solver-&gt;<a class="code" href="a00194.html#a75e8be4ea8c1ae2e99fc1e802e69a573">ParabolicFunction</a>         = NULL;</div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;    solver-&gt;<a class="code" href="a00194.html#a4b350316573a1d93caf01c5f1d43a45f">SecondDerivativePar</a>       = NULL;</div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;    solver-&gt;<a class="code" href="a00194.html#add4554e1a8a541607b867db7ec38d7a9">FirstDerivativePar</a>        = NULL;</div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;    solver-&gt;<a class="code" href="a00194.html#a13a0f9420009a55a3689f407a2c8efea">InterpolateInterfacesPar</a>  = NULL;</div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;    <span class="keywordflow">if</span> (!strcmp(solver-&gt;<a class="code" href="a00194.html#ad45d57b33d578bf602574a221bf53d93">spatial_type_par</a>,<a class="code" href="a00224.html#a18ee8cd9b4297a259b08aa4cdfe30aa1">_NC_1STAGE_</a>)) {</div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;      solver-&gt;<a class="code" href="a00194.html#a75e8be4ea8c1ae2e99fc1e802e69a573">ParabolicFunction</a> = <a class="code" href="a00295.html#a2faa78314e07ca739b7652ceb22ef083">ParabolicFunctionNC1Stage</a>;</div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;      <span class="keywordflow">if</span> (!strcmp(solver-&gt;<a class="code" href="a00194.html#a170f2f6cc8ac86b78fcb376c2392e290">spatial_scheme_par</a>,<a class="code" href="a00223.html#a89694dcc7c48314c98b9636759bb8bee">_SECOND_ORDER_CENTRAL_</a>)) {</div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;        solver-&gt;<a class="code" href="a00194.html#a4b350316573a1d93caf01c5f1d43a45f">SecondDerivativePar</a>      = <a class="code" href="a00244.html#a36b168a9f6846e2b4bc027989c8f3e65">SecondDerivativeSecondOrderCentral</a>; </div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;      } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcmp(solver-&gt;<a class="code" href="a00194.html#a170f2f6cc8ac86b78fcb376c2392e290">spatial_scheme_par</a>,<a class="code" href="a00223.html#aac4d00dd8bef7592948a7e563021c02a">_FOURTH_ORDER_CENTRAL_</a>)) {</div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;        solver-&gt;<a class="code" href="a00194.html#a4b350316573a1d93caf01c5f1d43a45f">SecondDerivativePar</a>      = <a class="code" href="a00244.html#a7fa2be45147cb91831760e66b631e15c">SecondDerivativeFourthOrderCentral</a>; </div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;      } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;        fprintf(stderr,<span class="stringliteral">&quot;Error (domain %d): %s is not a supported &quot;</span>,</div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;                ns, solver-&gt;<a class="code" href="a00194.html#a170f2f6cc8ac86b78fcb376c2392e290">spatial_scheme_par</a>);</div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;        fprintf(stderr,<span class="stringliteral">&quot;spatial scheme of type %s for the parabolic terms.\n&quot;</span>,</div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;                solver-&gt;<a class="code" href="a00194.html#ad45d57b33d578bf602574a221bf53d93">spatial_type_par</a>);</div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;      }</div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcmp(solver-&gt;<a class="code" href="a00194.html#ad45d57b33d578bf602574a221bf53d93">spatial_type_par</a>,<a class="code" href="a00224.html#a9f4de86b900c9aa5f097c2746e17612a">_NC_2STAGE_</a>)) {</div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;      solver-&gt;<a class="code" href="a00194.html#a75e8be4ea8c1ae2e99fc1e802e69a573">ParabolicFunction</a> = <a class="code" href="a00296.html#a153eb91ec9b118a7b8c971facbc8d920">ParabolicFunctionNC2Stage</a>;</div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;      <span class="keywordflow">if</span> (!strcmp(solver-&gt;<a class="code" href="a00194.html#a170f2f6cc8ac86b78fcb376c2392e290">spatial_scheme_par</a>,<a class="code" href="a00223.html#a89694dcc7c48314c98b9636759bb8bee">_SECOND_ORDER_CENTRAL_</a>)) {</div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;        solver-&gt;<a class="code" href="a00194.html#add4554e1a8a541607b867db7ec38d7a9">FirstDerivativePar</a>       = <a class="code" href="a00223.html#ad06a8db0245d2502016fb6c7b77ef37f">FirstDerivativeFirstOrder</a>; </div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;        <span class="comment">/* why first order? see ParabolicFunctionNC2Stage.c. 2nd order central</span></div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;<span class="comment">           approximation to the 2nd derivative can be expressed as a conjugation</span></div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;<span class="comment">           of 1st order approximations to the 1st derivative (one forward and </span></div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;<span class="comment">           one backward) -- this prevents odd-even decoupling */</span> </div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;      } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcmp(solver-&gt;<a class="code" href="a00194.html#a170f2f6cc8ac86b78fcb376c2392e290">spatial_scheme_par</a>,<a class="code" href="a00223.html#aac4d00dd8bef7592948a7e563021c02a">_FOURTH_ORDER_CENTRAL_</a>)) {</div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;        solver-&gt;<a class="code" href="a00194.html#add4554e1a8a541607b867db7ec38d7a9">FirstDerivativePar</a>       = <a class="code" href="a00223.html#a08c28e6bc4493172df7b7867e1f3d815">FirstDerivativeFourthOrderCentral</a>; </div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;        <span class="comment">/* why 4th order? I could not derive the decomposition of the </span></div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;<span class="comment">           4th order central approximation to the 2nd derivative! Some problems</span></div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;<span class="comment">           may show odd-even decoupling */</span> </div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;      } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;        fprintf(stderr,<span class="stringliteral">&quot;Error (domain %d): %s is not a supported &quot;</span>,</div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;                ns, solver-&gt;<a class="code" href="a00194.html#a170f2f6cc8ac86b78fcb376c2392e290">spatial_scheme_par</a>);</div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;        fprintf(stderr,<span class="stringliteral">&quot;spatial scheme of type %s for the parabolic terms.\n&quot;</span>,</div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;              solver-&gt;<a class="code" href="a00194.html#ad45d57b33d578bf602574a221bf53d93">spatial_type_par</a>);</div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;      }</div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcmp(solver-&gt;<a class="code" href="a00194.html#ad45d57b33d578bf602574a221bf53d93">spatial_type_par</a>,<a class="code" href="a00224.html#a7bc6f9c42df5610bc5d844ad95c74fb8">_NC_1_5STAGE_</a>)) {</div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;      solver-&gt;<a class="code" href="a00194.html#a75e8be4ea8c1ae2e99fc1e802e69a573">ParabolicFunction</a> = <a class="code" href="a00294.html#af9331a439bf243524c027eba50fdbbfd">ParabolicFunctionNC1_5Stage</a>;</div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;      <span class="keywordflow">if</span> (!strcmp(solver-&gt;<a class="code" href="a00194.html#a170f2f6cc8ac86b78fcb376c2392e290">spatial_scheme_par</a>,<a class="code" href="a00223.html#a89694dcc7c48314c98b9636759bb8bee">_SECOND_ORDER_CENTRAL_</a>)) {</div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;        solver-&gt;<a class="code" href="a00194.html#add4554e1a8a541607b867db7ec38d7a9">FirstDerivativePar</a>       = <a class="code" href="a00223.html#a27d213967bae3d2b969d07a967525541">FirstDerivativeSecondOrderCentral</a>; </div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;        solver-&gt;<a class="code" href="a00194.html#a4b350316573a1d93caf01c5f1d43a45f">SecondDerivativePar</a>      = <a class="code" href="a00244.html#a36b168a9f6846e2b4bc027989c8f3e65">SecondDerivativeSecondOrderCentral</a>; </div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;      } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcmp(solver-&gt;<a class="code" href="a00194.html#a170f2f6cc8ac86b78fcb376c2392e290">spatial_scheme_par</a>,<a class="code" href="a00223.html#aac4d00dd8bef7592948a7e563021c02a">_FOURTH_ORDER_CENTRAL_</a>)) {</div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;        solver-&gt;<a class="code" href="a00194.html#add4554e1a8a541607b867db7ec38d7a9">FirstDerivativePar</a>       = <a class="code" href="a00223.html#a08c28e6bc4493172df7b7867e1f3d815">FirstDerivativeFourthOrderCentral</a>; </div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;        solver-&gt;<a class="code" href="a00194.html#a4b350316573a1d93caf01c5f1d43a45f">SecondDerivativePar</a>      = <a class="code" href="a00244.html#a7fa2be45147cb91831760e66b631e15c">SecondDerivativeFourthOrderCentral</a>; </div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;      } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;        fprintf(stderr,<span class="stringliteral">&quot;Error (domain %d): %s is not a supported &quot;</span>,</div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;                ns, solver-&gt;<a class="code" href="a00194.html#a170f2f6cc8ac86b78fcb376c2392e290">spatial_scheme_par</a>);</div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;        fprintf(stderr,<span class="stringliteral">&quot;spatial scheme of type %s for the parabolic terms.\n&quot;</span>,</div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;              solver-&gt;<a class="code" href="a00194.html#ad45d57b33d578bf602574a221bf53d93">spatial_type_par</a>);</div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;      }</div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcmp(solver-&gt;<a class="code" href="a00194.html#ad45d57b33d578bf602574a221bf53d93">spatial_type_par</a>,<a class="code" href="a00224.html#aabd653aa5d489ae2d0d8140290f6f026">_CONS_1STAGE_</a>)) {</div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;      solver-&gt;<a class="code" href="a00194.html#a75e8be4ea8c1ae2e99fc1e802e69a573">ParabolicFunction</a> = <a class="code" href="a00293.html#a5e79cc5efd6d3e4c93717a67e0fbf918">ParabolicFunctionCons1Stage</a>;</div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;      <span class="keywordflow">if</span> (!strcmp(solver-&gt;<a class="code" href="a00194.html#a170f2f6cc8ac86b78fcb376c2392e290">spatial_scheme_par</a>,<a class="code" href="a00223.html#a89694dcc7c48314c98b9636759bb8bee">_SECOND_ORDER_CENTRAL_</a>)) {</div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;        solver-&gt;<a class="code" href="a00194.html#a13a0f9420009a55a3689f407a2c8efea">InterpolateInterfacesPar</a> = <a class="code" href="a00183.html#ae8bfe856abd743f5af925dc03e708ee3">Interp2PrimSecondOrder</a>; </div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;      } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;        fprintf(stderr,<span class="stringliteral">&quot;Error (domain %d): %s is not a supported &quot;</span>,</div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;                ns, solver-&gt;<a class="code" href="a00194.html#a170f2f6cc8ac86b78fcb376c2392e290">spatial_scheme_par</a>);</div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;        fprintf(stderr,<span class="stringliteral">&quot;spatial scheme of type %s for the parabolic terms.\n&quot;</span>,</div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;              solver-&gt;<a class="code" href="a00194.html#ad45d57b33d578bf602574a221bf53d93">spatial_type_par</a>);</div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;      }</div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;      fprintf(stderr,<span class="stringliteral">&quot;Error (domain %d): %s is not a supported &quot;</span>,</div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;              ns, solver-&gt;<a class="code" href="a00194.html#ad45d57b33d578bf602574a221bf53d93">spatial_type_par</a>);</div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;      fprintf(stderr,<span class="stringliteral">&quot;spatial discretization type for the parabolic terms.\n&quot;</span>);</div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;      <span class="keywordflow">return</span>(1);</div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;    }</div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;  </div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;    <span class="comment">/* Spatial interpolation for hyperbolic term */</span></div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;    solver-&gt;<a class="code" href="a00194.html#a29c46b81ad574e4dfbad5a7211487dcb">interp</a>                = NULL;</div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;    solver-&gt;<a class="code" href="a00194.html#a56318721d534e74a96b440f8542a0232">compact</a>               = NULL;</div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;    solver-&gt;<a class="code" href="a00194.html#a1dbfa1e479a373073b6ebf72401a7f0f">lusolver</a>              = NULL;</div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;    solver-&gt;<a class="code" href="a00194.html#afeeb150a9699ade5eccc7589fcae3fe0">SetInterpLimiterVar</a>   = NULL;</div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;    solver-&gt;<a class="code" href="a00194.html#a9a61d44b50cc9043a19bdc3c0f591d99">flag_nonlinearinterp</a>  = 1;</div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;    <span class="keywordflow">if</span> (strcmp(solver-&gt;<a class="code" href="a00194.html#a9591ba0fadb863561474e2ba251d2594">interp_type</a>,<a class="code" href="a00183.html#aa7752b40155314f9f2c063d4d9d8339d">_CHARACTERISTIC_</a>) &amp;&amp; strcmp(solver-&gt;<a class="code" href="a00194.html#a9591ba0fadb863561474e2ba251d2594">interp_type</a>,<a class="code" href="a00183.html#ac1f614645aa891fde12c0ce4354de45d">_COMPONENTS_</a>)) {</div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;      fprintf(stderr,<span class="stringliteral">&quot;Error in InitializeSolvers() (domain %d): %s is not a &quot;</span>, </div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;              ns, solver-&gt;<a class="code" href="a00194.html#a9591ba0fadb863561474e2ba251d2594">interp_type</a>);</div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;      fprintf(stderr,<span class="stringliteral">&quot;supported interpolation type.\n&quot;</span>);</div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;      <span class="keywordflow">return</span>(1);</div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;    }</div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;    <span class="keywordflow">if</span> (!strcmp(solver-&gt;<a class="code" href="a00194.html#ad29846eeb9c83b329a8d7c1fe69d46b2">spatial_scheme_hyp</a>,<a class="code" href="a00183.html#a19cc54d502757bfed14b373b443f144c">_FIRST_ORDER_UPWIND_</a>)) {</div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;  </div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;      <span class="comment">/* First order upwind scheme */</span></div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;      <span class="keywordflow">if</span> ((solver-&gt;<a class="code" href="a00194.html#ae8f6d2fd6490d3153cb4133bf183a404">nvars</a> &gt; 1) &amp;&amp; (!strcmp(solver-&gt;<a class="code" href="a00194.html#a9591ba0fadb863561474e2ba251d2594">interp_type</a>,<a class="code" href="a00183.html#aa7752b40155314f9f2c063d4d9d8339d">_CHARACTERISTIC_</a>))) {</div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;        solver-&gt;<a class="code" href="a00194.html#a17e1cfc7de4fe33c6ee88f2cc42883e7">InterpolateInterfacesHyp</a> = <a class="code" href="a00183.html#a759e07ba8a484c2c6971fc7c6a81a95a">Interp1PrimFirstOrderUpwindChar</a>;</div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;      } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;        solver-&gt;<a class="code" href="a00194.html#a17e1cfc7de4fe33c6ee88f2cc42883e7">InterpolateInterfacesHyp</a> = <a class="code" href="a00183.html#a0a067c9c4745556845b9bcb7f049b59b">Interp1PrimFirstOrderUpwind</a>;</div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;      }</div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;  </div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcmp(solver-&gt;<a class="code" href="a00194.html#ad29846eeb9c83b329a8d7c1fe69d46b2">spatial_scheme_hyp</a>,<a class="code" href="a00223.html#a89694dcc7c48314c98b9636759bb8bee">_SECOND_ORDER_CENTRAL_</a>)) {</div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;  </div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;      <span class="comment">/* Second order central scheme */</span></div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;      <span class="keywordflow">if</span> ((solver-&gt;<a class="code" href="a00194.html#ae8f6d2fd6490d3153cb4133bf183a404">nvars</a> &gt; 1) &amp;&amp; (!strcmp(solver-&gt;<a class="code" href="a00194.html#a9591ba0fadb863561474e2ba251d2594">interp_type</a>,<a class="code" href="a00183.html#aa7752b40155314f9f2c063d4d9d8339d">_CHARACTERISTIC_</a>))) {</div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;        solver-&gt;<a class="code" href="a00194.html#a17e1cfc7de4fe33c6ee88f2cc42883e7">InterpolateInterfacesHyp</a> = <a class="code" href="a00183.html#a963c82116a2a1d6084af3d519b61b896">Interp1PrimSecondOrderCentralChar</a>;</div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;      } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;        solver-&gt;<a class="code" href="a00194.html#a17e1cfc7de4fe33c6ee88f2cc42883e7">InterpolateInterfacesHyp</a> = <a class="code" href="a00183.html#a697d5c94aa331054c5286492e7fa39c7">Interp1PrimSecondOrderCentral</a>;</div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;      }</div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;  </div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcmp(solver-&gt;<a class="code" href="a00194.html#ad29846eeb9c83b329a8d7c1fe69d46b2">spatial_scheme_hyp</a>,<a class="code" href="a00183.html#a32a14b9aa17be670a383e3d539da2afa">_SECOND_ORDER_MUSCL_</a>)) {</div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;  </div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;      <span class="comment">/* Second order MUSCL scheme */</span></div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;      <span class="keywordflow">if</span> ((solver-&gt;<a class="code" href="a00194.html#ae8f6d2fd6490d3153cb4133bf183a404">nvars</a> &gt; 1) &amp;&amp; (!strcmp(solver-&gt;<a class="code" href="a00194.html#a9591ba0fadb863561474e2ba251d2594">interp_type</a>,<a class="code" href="a00183.html#aa7752b40155314f9f2c063d4d9d8339d">_CHARACTERISTIC_</a>))) {</div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;        solver-&gt;<a class="code" href="a00194.html#a17e1cfc7de4fe33c6ee88f2cc42883e7">InterpolateInterfacesHyp</a> = <a class="code" href="a00183.html#a9cde00a0c916f0cda162b1c03d3f7b6b">Interp1PrimSecondOrderMUSCLChar</a>;</div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;      } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;        solver-&gt;<a class="code" href="a00194.html#a17e1cfc7de4fe33c6ee88f2cc42883e7">InterpolateInterfacesHyp</a> = <a class="code" href="a00183.html#a25df96c0eccca13167d28045d187db36">Interp1PrimSecondOrderMUSCL</a>;</div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;      }</div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;      solver-&gt;<a class="code" href="a00194.html#a29c46b81ad574e4dfbad5a7211487dcb">interp</a> = (<a class="code" href="a00198.html">MUSCLParameters</a>*) calloc(1,<span class="keyword">sizeof</span>(<a class="code" href="a00198.html">MUSCLParameters</a>));</div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;      <a class="code" href="a00218.html#ad6ab74942c9de13cf0b4c12eb0d91780">IERR</a> <a class="code" href="a00183.html#a22e0ae19117192cae9978a7a741d15a5">MUSCLInitialize</a>(solver,mpi); <a class="code" href="a00218.html#add9cf96ae374934d245a1dc1ab697a42">CHECKERR</a>(ierr);</div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;  </div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcmp(solver-&gt;<a class="code" href="a00194.html#ad29846eeb9c83b329a8d7c1fe69d46b2">spatial_scheme_hyp</a>,<a class="code" href="a00183.html#a21f7f383e497570fcb71c43f243539d3">_THIRD_ORDER_MUSCL_</a>)) {</div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;  </div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;      <span class="comment">/* Third order MUSCL scheme */</span></div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;      <span class="keywordflow">if</span> ((solver-&gt;<a class="code" href="a00194.html#ae8f6d2fd6490d3153cb4133bf183a404">nvars</a> &gt; 1) &amp;&amp; (!strcmp(solver-&gt;<a class="code" href="a00194.html#a9591ba0fadb863561474e2ba251d2594">interp_type</a>,<a class="code" href="a00183.html#aa7752b40155314f9f2c063d4d9d8339d">_CHARACTERISTIC_</a>))) {</div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;        solver-&gt;<a class="code" href="a00194.html#a17e1cfc7de4fe33c6ee88f2cc42883e7">InterpolateInterfacesHyp</a> = <a class="code" href="a00183.html#a985d08c4fb9bcb71875c697f9e00d6eb">Interp1PrimThirdOrderMUSCLChar</a>;</div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;      } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;        solver-&gt;<a class="code" href="a00194.html#a17e1cfc7de4fe33c6ee88f2cc42883e7">InterpolateInterfacesHyp</a> = <a class="code" href="a00183.html#ae7eb6a81a164ca0fa2ace3cab2697847">Interp1PrimThirdOrderMUSCL</a>;</div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;      }</div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;      solver-&gt;<a class="code" href="a00194.html#a29c46b81ad574e4dfbad5a7211487dcb">interp</a> = (<a class="code" href="a00198.html">MUSCLParameters</a>*) calloc(1,<span class="keyword">sizeof</span>(<a class="code" href="a00198.html">MUSCLParameters</a>));</div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;      <a class="code" href="a00218.html#ad6ab74942c9de13cf0b4c12eb0d91780">IERR</a> <a class="code" href="a00183.html#a22e0ae19117192cae9978a7a741d15a5">MUSCLInitialize</a>(solver,mpi); <a class="code" href="a00218.html#add9cf96ae374934d245a1dc1ab697a42">CHECKERR</a>(ierr);</div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;  </div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcmp(solver-&gt;<a class="code" href="a00194.html#ad29846eeb9c83b329a8d7c1fe69d46b2">spatial_scheme_hyp</a>,<a class="code" href="a00223.html#aac4d00dd8bef7592948a7e563021c02a">_FOURTH_ORDER_CENTRAL_</a>)) {</div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;  </div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;      <span class="comment">/* Fourth order central scheme */</span></div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;      <span class="keywordflow">if</span> ((solver-&gt;<a class="code" href="a00194.html#ae8f6d2fd6490d3153cb4133bf183a404">nvars</a> &gt; 1) &amp;&amp; (!strcmp(solver-&gt;<a class="code" href="a00194.html#a9591ba0fadb863561474e2ba251d2594">interp_type</a>,<a class="code" href="a00183.html#aa7752b40155314f9f2c063d4d9d8339d">_CHARACTERISTIC_</a>))) {</div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;        solver-&gt;<a class="code" href="a00194.html#a17e1cfc7de4fe33c6ee88f2cc42883e7">InterpolateInterfacesHyp</a> = <a class="code" href="a00183.html#aa59d0f26584fa405034c2eac2e338c94">Interp1PrimFourthOrderCentralChar</a>;</div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;      } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;        solver-&gt;<a class="code" href="a00194.html#a17e1cfc7de4fe33c6ee88f2cc42883e7">InterpolateInterfacesHyp</a> = <a class="code" href="a00183.html#a98098e68334c1a9cabe5b721aa8fbe59">Interp1PrimFourthOrderCentral</a>;</div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;      }</div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;  </div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcmp(solver-&gt;<a class="code" href="a00194.html#ad29846eeb9c83b329a8d7c1fe69d46b2">spatial_scheme_hyp</a>,<a class="code" href="a00183.html#a7bc4a755992e5f68efe365591b7a2c02">_FIFTH_ORDER_UPWIND_</a>)) {</div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;  </div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;      <span class="comment">/* Fifth order upwind scheme */</span></div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;      <span class="keywordflow">if</span> ((solver-&gt;<a class="code" href="a00194.html#ae8f6d2fd6490d3153cb4133bf183a404">nvars</a> &gt; 1) &amp;&amp; (!strcmp(solver-&gt;<a class="code" href="a00194.html#a9591ba0fadb863561474e2ba251d2594">interp_type</a>,<a class="code" href="a00183.html#aa7752b40155314f9f2c063d4d9d8339d">_CHARACTERISTIC_</a>))) {</div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;        solver-&gt;<a class="code" href="a00194.html#a17e1cfc7de4fe33c6ee88f2cc42883e7">InterpolateInterfacesHyp</a> = <a class="code" href="a00183.html#ade9ece6e934d70cdf29090494440f505">Interp1PrimFifthOrderUpwindChar</a>;</div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;      } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;        solver-&gt;<a class="code" href="a00194.html#a17e1cfc7de4fe33c6ee88f2cc42883e7">InterpolateInterfacesHyp</a> = <a class="code" href="a00183.html#aea7c973ffe0c37bca0703c1bf6175aaa">Interp1PrimFifthOrderUpwind</a>;</div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;      }</div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;  </div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcmp(solver-&gt;<a class="code" href="a00194.html#ad29846eeb9c83b329a8d7c1fe69d46b2">spatial_scheme_hyp</a>,<a class="code" href="a00183.html#ae832e2314ee85139cec9df4ea82aafa2">_FIFTH_ORDER_COMPACT_UPWIND_</a>)) {</div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;  </div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;      <span class="comment">/* Fifth order compact upwind scheme */</span></div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;      <span class="keywordflow">if</span> ((solver-&gt;<a class="code" href="a00194.html#ae8f6d2fd6490d3153cb4133bf183a404">nvars</a> &gt; 1) &amp;&amp; (!strcmp(solver-&gt;<a class="code" href="a00194.html#a9591ba0fadb863561474e2ba251d2594">interp_type</a>,<a class="code" href="a00183.html#aa7752b40155314f9f2c063d4d9d8339d">_CHARACTERISTIC_</a>))) {</div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;        solver-&gt;<a class="code" href="a00194.html#a17e1cfc7de4fe33c6ee88f2cc42883e7">InterpolateInterfacesHyp</a> = <a class="code" href="a00183.html#a28b8d3ce17676cec19de4f91f989042d">Interp1PrimFifthOrderCompactUpwindChar</a>;</div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;      } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;        solver-&gt;<a class="code" href="a00194.html#a17e1cfc7de4fe33c6ee88f2cc42883e7">InterpolateInterfacesHyp</a> = <a class="code" href="a00183.html#a3ac2a77b9fa5a50499c285e49cf91344">Interp1PrimFifthOrderCompactUpwind</a>;</div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;      }</div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;      solver-&gt;<a class="code" href="a00194.html#a56318721d534e74a96b440f8542a0232">compact</a> = (<a class="code" href="a00183.html#a00609">CompactScheme</a>*) calloc(1,<span class="keyword">sizeof</span>(<a class="code" href="a00183.html#a00609">CompactScheme</a>));</div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;      <a class="code" href="a00218.html#ad6ab74942c9de13cf0b4c12eb0d91780">IERR</a> <a class="code" href="a00183.html#af255a582e14c5820cf12f9f95b4e28fd">CompactSchemeInitialize</a>(solver,mpi,solver-&gt;<a class="code" href="a00194.html#a9591ba0fadb863561474e2ba251d2594">interp_type</a>);</div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;      solver-&gt;<a class="code" href="a00194.html#a1dbfa1e479a373073b6ebf72401a7f0f">lusolver</a> = (<a class="code" href="a00212.html#a00627">TridiagLU</a>*) calloc (1,<span class="keyword">sizeof</span>(<a class="code" href="a00212.html#a00627">TridiagLU</a>));</div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;      <a class="code" href="a00218.html#ad6ab74942c9de13cf0b4c12eb0d91780">IERR</a> <a class="code" href="a00212.html#a52d21dfe1d76916811879bf0d7a29d72">tridiagLUInit</a>(solver-&gt;<a class="code" href="a00194.html#a1dbfa1e479a373073b6ebf72401a7f0f">lusolver</a>,&amp;mpi-&gt;<a class="code" href="a00197.html#adad7a6f85831f3ac84d854b6c80aef43">world</a>);<a class="code" href="a00218.html#add9cf96ae374934d245a1dc1ab697a42">CHECKERR</a>(ierr);</div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;  </div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcmp(solver-&gt;<a class="code" href="a00194.html#ad29846eeb9c83b329a8d7c1fe69d46b2">spatial_scheme_hyp</a>,<a class="code" href="a00183.html#acfeff1b158131390b7129f4a857b15ff">_FIFTH_ORDER_WENO_</a>)) {</div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;  </div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;      <span class="comment">/* Fifth order WENO scheme */</span></div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;      <span class="keywordflow">if</span> ((solver-&gt;<a class="code" href="a00194.html#ae8f6d2fd6490d3153cb4133bf183a404">nvars</a> &gt; 1) &amp;&amp; (!strcmp(solver-&gt;<a class="code" href="a00194.html#a9591ba0fadb863561474e2ba251d2594">interp_type</a>,<a class="code" href="a00183.html#aa7752b40155314f9f2c063d4d9d8339d">_CHARACTERISTIC_</a>))) {</div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;        solver-&gt;<a class="code" href="a00194.html#a17e1cfc7de4fe33c6ee88f2cc42883e7">InterpolateInterfacesHyp</a> = <a class="code" href="a00183.html#abf3b032fdc8c0e84b86909db9e0b93c3">Interp1PrimFifthOrderWENOChar</a>;</div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;      } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;        solver-&gt;<a class="code" href="a00194.html#a17e1cfc7de4fe33c6ee88f2cc42883e7">InterpolateInterfacesHyp</a> = <a class="code" href="a00183.html#af2195885ad055989a1b2b11655843343">Interp1PrimFifthOrderWENO</a>;</div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;      }</div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;      solver-&gt;<a class="code" href="a00194.html#a29c46b81ad574e4dfbad5a7211487dcb">interp</a> = (<a class="code" href="a00183.html#a00629">WENOParameters</a>*) calloc(1,<span class="keyword">sizeof</span>(<a class="code" href="a00183.html#a00629">WENOParameters</a>));</div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;      <a class="code" href="a00218.html#ad6ab74942c9de13cf0b4c12eb0d91780">IERR</a> <a class="code" href="a00183.html#aecbe557b2ccc254cdbbd312fc91717be">WENOInitialize</a>(solver,mpi,solver-&gt;<a class="code" href="a00194.html#ad29846eeb9c83b329a8d7c1fe69d46b2">spatial_scheme_hyp</a>,solver-&gt;<a class="code" href="a00194.html#a9591ba0fadb863561474e2ba251d2594">interp_type</a>); <a class="code" href="a00218.html#add9cf96ae374934d245a1dc1ab697a42">CHECKERR</a>(ierr);</div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;      solver-&gt;<a class="code" href="a00194.html#a9a61d44b50cc9043a19bdc3c0f591d99">flag_nonlinearinterp</a> = !(((<a class="code" href="a00183.html#a00629">WENOParameters</a>*)solver-&gt;<a class="code" href="a00194.html#a29c46b81ad574e4dfbad5a7211487dcb">interp</a>)-&gt;no_limiting);</div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;  </div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcmp(solver-&gt;<a class="code" href="a00194.html#ad29846eeb9c83b329a8d7c1fe69d46b2">spatial_scheme_hyp</a>,<a class="code" href="a00183.html#a175a82b8ae2b24c0ba51e1b1dd68c0e5">_FIFTH_ORDER_CRWENO_</a>)) {</div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;  </div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;      <span class="comment">/* Fifth order CRWENO scheme */</span></div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;      <span class="keywordflow">if</span> ((solver-&gt;<a class="code" href="a00194.html#ae8f6d2fd6490d3153cb4133bf183a404">nvars</a> &gt; 1) &amp;&amp; (!strcmp(solver-&gt;<a class="code" href="a00194.html#a9591ba0fadb863561474e2ba251d2594">interp_type</a>,<a class="code" href="a00183.html#aa7752b40155314f9f2c063d4d9d8339d">_CHARACTERISTIC_</a>))) {</div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;        solver-&gt;<a class="code" href="a00194.html#a17e1cfc7de4fe33c6ee88f2cc42883e7">InterpolateInterfacesHyp</a> = <a class="code" href="a00183.html#ae2b27971cc952cf3b4959128bef6174b">Interp1PrimFifthOrderCRWENOChar</a>;</div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;      } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;        solver-&gt;<a class="code" href="a00194.html#a17e1cfc7de4fe33c6ee88f2cc42883e7">InterpolateInterfacesHyp</a> = <a class="code" href="a00183.html#a33b1e24c12129941b0027a83c543a654">Interp1PrimFifthOrderCRWENO</a>;</div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;      }</div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;      solver-&gt;<a class="code" href="a00194.html#a29c46b81ad574e4dfbad5a7211487dcb">interp</a> = (<a class="code" href="a00183.html#a00629">WENOParameters</a>*) calloc(1,<span class="keyword">sizeof</span>(<a class="code" href="a00183.html#a00629">WENOParameters</a>));</div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;      <a class="code" href="a00218.html#ad6ab74942c9de13cf0b4c12eb0d91780">IERR</a> <a class="code" href="a00183.html#aecbe557b2ccc254cdbbd312fc91717be">WENOInitialize</a>(solver,mpi,solver-&gt;<a class="code" href="a00194.html#ad29846eeb9c83b329a8d7c1fe69d46b2">spatial_scheme_hyp</a>,solver-&gt;<a class="code" href="a00194.html#a9591ba0fadb863561474e2ba251d2594">interp_type</a>); <a class="code" href="a00218.html#add9cf96ae374934d245a1dc1ab697a42">CHECKERR</a>(ierr);</div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;      solver-&gt;<a class="code" href="a00194.html#a9a61d44b50cc9043a19bdc3c0f591d99">flag_nonlinearinterp</a> = !(((<a class="code" href="a00183.html#a00629">WENOParameters</a>*)solver-&gt;<a class="code" href="a00194.html#a29c46b81ad574e4dfbad5a7211487dcb">interp</a>)-&gt;no_limiting);</div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;      solver-&gt;<a class="code" href="a00194.html#a56318721d534e74a96b440f8542a0232">compact</a> = (<a class="code" href="a00183.html#a00609">CompactScheme</a>*) calloc(1,<span class="keyword">sizeof</span>(<a class="code" href="a00183.html#a00609">CompactScheme</a>));</div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;      <a class="code" href="a00218.html#ad6ab74942c9de13cf0b4c12eb0d91780">IERR</a> <a class="code" href="a00183.html#af255a582e14c5820cf12f9f95b4e28fd">CompactSchemeInitialize</a>(solver,mpi,solver-&gt;<a class="code" href="a00194.html#a9591ba0fadb863561474e2ba251d2594">interp_type</a>);</div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;      solver-&gt;<a class="code" href="a00194.html#a1dbfa1e479a373073b6ebf72401a7f0f">lusolver</a> = (<a class="code" href="a00212.html#a00627">TridiagLU</a>*) calloc (1,<span class="keyword">sizeof</span>(<a class="code" href="a00212.html#a00627">TridiagLU</a>));</div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;      <a class="code" href="a00218.html#ad6ab74942c9de13cf0b4c12eb0d91780">IERR</a> <a class="code" href="a00212.html#a52d21dfe1d76916811879bf0d7a29d72">tridiagLUInit</a>(solver-&gt;<a class="code" href="a00194.html#a1dbfa1e479a373073b6ebf72401a7f0f">lusolver</a>,&amp;mpi-&gt;<a class="code" href="a00197.html#adad7a6f85831f3ac84d854b6c80aef43">world</a>);<a class="code" href="a00218.html#add9cf96ae374934d245a1dc1ab697a42">CHECKERR</a>(ierr);</div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;  </div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcmp(solver-&gt;<a class="code" href="a00194.html#ad29846eeb9c83b329a8d7c1fe69d46b2">spatial_scheme_hyp</a>,<a class="code" href="a00183.html#a6d34f5e8aae80a0d2a27ea20368dfef1">_FIFTH_ORDER_HCWENO_</a>)) {</div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;  </div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;      <span class="comment">/* Fifth order HCWENO scheme */</span></div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;      <span class="keywordflow">if</span> ((solver-&gt;<a class="code" href="a00194.html#ae8f6d2fd6490d3153cb4133bf183a404">nvars</a> &gt; 1) &amp;&amp; (!strcmp(solver-&gt;<a class="code" href="a00194.html#a9591ba0fadb863561474e2ba251d2594">interp_type</a>,<a class="code" href="a00183.html#aa7752b40155314f9f2c063d4d9d8339d">_CHARACTERISTIC_</a>))) {</div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;        solver-&gt;<a class="code" href="a00194.html#a17e1cfc7de4fe33c6ee88f2cc42883e7">InterpolateInterfacesHyp</a> = <a class="code" href="a00183.html#a91fbe118c8c01fe1d5efa3cea4930589">Interp1PrimFifthOrderHCWENOChar</a>;</div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;      } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;        solver-&gt;<a class="code" href="a00194.html#a17e1cfc7de4fe33c6ee88f2cc42883e7">InterpolateInterfacesHyp</a> = <a class="code" href="a00183.html#ad9c611137cfce1c622c2e9838fb523c8">Interp1PrimFifthOrderHCWENO</a>;</div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;      }</div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;      solver-&gt;<a class="code" href="a00194.html#a29c46b81ad574e4dfbad5a7211487dcb">interp</a> = (<a class="code" href="a00183.html#a00629">WENOParameters</a>*) calloc(1,<span class="keyword">sizeof</span>(<a class="code" href="a00183.html#a00629">WENOParameters</a>));</div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;      <a class="code" href="a00218.html#ad6ab74942c9de13cf0b4c12eb0d91780">IERR</a> <a class="code" href="a00183.html#aecbe557b2ccc254cdbbd312fc91717be">WENOInitialize</a>(solver,mpi,solver-&gt;<a class="code" href="a00194.html#ad29846eeb9c83b329a8d7c1fe69d46b2">spatial_scheme_hyp</a>,solver-&gt;<a class="code" href="a00194.html#a9591ba0fadb863561474e2ba251d2594">interp_type</a>); <a class="code" href="a00218.html#add9cf96ae374934d245a1dc1ab697a42">CHECKERR</a>(ierr);</div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;      solver-&gt;<a class="code" href="a00194.html#a9a61d44b50cc9043a19bdc3c0f591d99">flag_nonlinearinterp</a> = !(((<a class="code" href="a00183.html#a00629">WENOParameters</a>*)solver-&gt;<a class="code" href="a00194.html#a29c46b81ad574e4dfbad5a7211487dcb">interp</a>)-&gt;no_limiting);</div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;      solver-&gt;<a class="code" href="a00194.html#a56318721d534e74a96b440f8542a0232">compact</a> = (<a class="code" href="a00183.html#a00609">CompactScheme</a>*) calloc(1,<span class="keyword">sizeof</span>(<a class="code" href="a00183.html#a00609">CompactScheme</a>));</div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;      <a class="code" href="a00218.html#ad6ab74942c9de13cf0b4c12eb0d91780">IERR</a> <a class="code" href="a00183.html#af255a582e14c5820cf12f9f95b4e28fd">CompactSchemeInitialize</a>(solver,mpi,solver-&gt;<a class="code" href="a00194.html#a9591ba0fadb863561474e2ba251d2594">interp_type</a>);</div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;      solver-&gt;<a class="code" href="a00194.html#a1dbfa1e479a373073b6ebf72401a7f0f">lusolver</a> = (<a class="code" href="a00212.html#a00627">TridiagLU</a>*) calloc (1,<span class="keyword">sizeof</span>(<a class="code" href="a00212.html#a00627">TridiagLU</a>));</div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;      <a class="code" href="a00218.html#ad6ab74942c9de13cf0b4c12eb0d91780">IERR</a> <a class="code" href="a00212.html#a52d21dfe1d76916811879bf0d7a29d72">tridiagLUInit</a>(solver-&gt;<a class="code" href="a00194.html#a1dbfa1e479a373073b6ebf72401a7f0f">lusolver</a>,&amp;mpi-&gt;<a class="code" href="a00197.html#adad7a6f85831f3ac84d854b6c80aef43">world</a>);<a class="code" href="a00218.html#add9cf96ae374934d245a1dc1ab697a42">CHECKERR</a>(ierr);</div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;  </div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;      fprintf(stderr,<span class="stringliteral">&quot;Error (domain %d): %s is a not a supported spatial interpolation scheme.\n&quot;</span>,</div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;              ns, solver-&gt;<a class="code" href="a00194.html#ad29846eeb9c83b329a8d7c1fe69d46b2">spatial_scheme_hyp</a>);</div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;      <span class="keywordflow">return</span>(1);</div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;    }</div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;</div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;    <span class="comment">/* Time integration */</span></div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;    solver-&gt;<a class="code" href="a00194.html#a1d36fea92472416e32e039b86dea0b18">time_integrator</a> = NULL;</div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;<span class="preprocessor">#ifdef with_petsc</span></div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;<span class="preprocessor"></span>    <span class="keywordflow">if</span> (solver-&gt;<a class="code" href="a00194.html#ad195de8c64c407718e42cda9246be0d2">use_petscTS</a>) {</div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;      <span class="comment">/* dummy -- not used */</span></div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;      solver-&gt;<a class="code" href="a00194.html#a7de550a63022232e0039dc46a08114b0">TimeIntegrate</a> = <a class="code" href="a00250.html#a5fe3d9828c6afcbc00cf6fdd940ebe4b">TimeForwardEuler</a>;</div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;      solver-&gt;<a class="code" href="a00194.html#adec095311615891040de11341c01a77f">msti</a> = NULL;</div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;      <span class="keywordflow">if</span> (!strcmp(solver-&gt;<a class="code" href="a00194.html#a138e751362d14724df8e6ab27c4a5e55">time_scheme</a>,<a class="code" href="a00189.html#af9b1e641532cff8859c5c5a8377f5feb">_FORWARD_EULER_</a>)) { </div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;        solver-&gt;<a class="code" href="a00194.html#a7de550a63022232e0039dc46a08114b0">TimeIntegrate</a> = <a class="code" href="a00250.html#a5fe3d9828c6afcbc00cf6fdd940ebe4b">TimeForwardEuler</a>;</div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;        solver-&gt;<a class="code" href="a00194.html#adec095311615891040de11341c01a77f">msti</a> = NULL;</div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;      } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcmp(solver-&gt;<a class="code" href="a00194.html#a138e751362d14724df8e6ab27c4a5e55">time_scheme</a>,<a class="code" href="a00189.html#a50d4bf1e7e4825cc062fca99a770e5ce">_RK_</a>)) {</div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;        solver-&gt;<a class="code" href="a00194.html#a7de550a63022232e0039dc46a08114b0">TimeIntegrate</a> = <a class="code" href="a00250.html#aca6ebec6e6998f0c509bb38fa91f3321">TimeRK</a>;</div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;        solver-&gt;<a class="code" href="a00194.html#adec095311615891040de11341c01a77f">msti</a> = (<a class="code" href="a00189.html#a00611">ExplicitRKParameters</a>*) calloc (1,<span class="keyword">sizeof</span>(<a class="code" href="a00189.html#a00611">ExplicitRKParameters</a>));</div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;        <a class="code" href="a00218.html#ad6ab74942c9de13cf0b4c12eb0d91780">IERR</a> <a class="code" href="a00250.html#a966855c31cad0395c350b9a77add7ab8">TimeExplicitRKInitialize</a>(solver-&gt;<a class="code" href="a00194.html#a138e751362d14724df8e6ab27c4a5e55">time_scheme</a>,solver-&gt;<a class="code" href="a00194.html#a61750696383420ba8bcc7d9e44a538e2">time_scheme_type</a>,</div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;                                      solver-&gt;<a class="code" href="a00194.html#adec095311615891040de11341c01a77f">msti</a>,mpi); <a class="code" href="a00218.html#add9cf96ae374934d245a1dc1ab697a42">CHECKERR</a>(ierr);</div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;      } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcmp(solver-&gt;<a class="code" href="a00194.html#a138e751362d14724df8e6ab27c4a5e55">time_scheme</a>,<a class="code" href="a00189.html#aad9619c099daeb3e6b1b7ef9e03e38d8">_GLM_GEE_</a>)) {</div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;        solver-&gt;<a class="code" href="a00194.html#a7de550a63022232e0039dc46a08114b0">TimeIntegrate</a> = <a class="code" href="a00250.html#a7b76988ab950d39d505042dc1f09b875">TimeGLMGEE</a>;</div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;        solver-&gt;<a class="code" href="a00194.html#adec095311615891040de11341c01a77f">msti</a> = (<a class="code" href="a00189.html#a00618">GLMGEEParameters</a>*) calloc (1,<span class="keyword">sizeof</span>(<a class="code" href="a00189.html#a00618">GLMGEEParameters</a>));</div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;        <a class="code" href="a00218.html#ad6ab74942c9de13cf0b4c12eb0d91780">IERR</a> <a class="code" href="a00250.html#ad7d778f0d388a120492e4901c3319d51">TimeGLMGEEInitialize</a>(solver-&gt;<a class="code" href="a00194.html#a138e751362d14724df8e6ab27c4a5e55">time_scheme</a>,solver-&gt;<a class="code" href="a00194.html#a61750696383420ba8bcc7d9e44a538e2">time_scheme_type</a>,</div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;                                  solver-&gt;<a class="code" href="a00194.html#adec095311615891040de11341c01a77f">msti</a>,mpi); <a class="code" href="a00218.html#add9cf96ae374934d245a1dc1ab697a42">CHECKERR</a>(ierr);</div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;      } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;        fprintf(stderr,<span class="stringliteral">&quot;Error (domain %d): %s is a not a supported time-integration scheme.\n&quot;</span>,</div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;                ns, solver-&gt;<a class="code" href="a00194.html#a138e751362d14724df8e6ab27c4a5e55">time_scheme</a>);</div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;        <span class="keywordflow">return</span>(1);</div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;      }</div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;    }</div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;<span class="preprocessor">#else</span></div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;<span class="preprocessor"></span>    <span class="keywordflow">if</span> (!strcmp(solver-&gt;<a class="code" href="a00194.html#a138e751362d14724df8e6ab27c4a5e55">time_scheme</a>,<a class="code" href="a00189.html#af9b1e641532cff8859c5c5a8377f5feb">_FORWARD_EULER_</a>)) { </div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;      solver-&gt;<a class="code" href="a00194.html#a7de550a63022232e0039dc46a08114b0">TimeIntegrate</a> = <a class="code" href="a00250.html#a5fe3d9828c6afcbc00cf6fdd940ebe4b">TimeForwardEuler</a>;</div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;      solver-&gt;<a class="code" href="a00194.html#adec095311615891040de11341c01a77f">msti</a> = NULL;</div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcmp(solver-&gt;<a class="code" href="a00194.html#a138e751362d14724df8e6ab27c4a5e55">time_scheme</a>,<a class="code" href="a00189.html#a50d4bf1e7e4825cc062fca99a770e5ce">_RK_</a>)) {</div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;      solver-&gt;<a class="code" href="a00194.html#a7de550a63022232e0039dc46a08114b0">TimeIntegrate</a> = <a class="code" href="a00250.html#aca6ebec6e6998f0c509bb38fa91f3321">TimeRK</a>;</div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;      solver-&gt;<a class="code" href="a00194.html#adec095311615891040de11341c01a77f">msti</a> = (<a class="code" href="a00189.html#a00611">ExplicitRKParameters</a>*) calloc (1,<span class="keyword">sizeof</span>(<a class="code" href="a00189.html#a00611">ExplicitRKParameters</a>));</div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;      <a class="code" href="a00218.html#ad6ab74942c9de13cf0b4c12eb0d91780">IERR</a> <a class="code" href="a00250.html#a966855c31cad0395c350b9a77add7ab8">TimeExplicitRKInitialize</a>(solver-&gt;<a class="code" href="a00194.html#a138e751362d14724df8e6ab27c4a5e55">time_scheme</a>,solver-&gt;<a class="code" href="a00194.html#a61750696383420ba8bcc7d9e44a538e2">time_scheme_type</a>,</div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;                                    solver-&gt;<a class="code" href="a00194.html#adec095311615891040de11341c01a77f">msti</a>,mpi); <a class="code" href="a00218.html#add9cf96ae374934d245a1dc1ab697a42">CHECKERR</a>(ierr);</div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcmp(solver-&gt;<a class="code" href="a00194.html#a138e751362d14724df8e6ab27c4a5e55">time_scheme</a>,<a class="code" href="a00189.html#aad9619c099daeb3e6b1b7ef9e03e38d8">_GLM_GEE_</a>)) {</div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;      solver-&gt;<a class="code" href="a00194.html#a7de550a63022232e0039dc46a08114b0">TimeIntegrate</a> = <a class="code" href="a00250.html#a7b76988ab950d39d505042dc1f09b875">TimeGLMGEE</a>;</div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;      solver-&gt;<a class="code" href="a00194.html#adec095311615891040de11341c01a77f">msti</a> = (<a class="code" href="a00189.html#a00618">GLMGEEParameters</a>*) calloc (1,<span class="keyword">sizeof</span>(<a class="code" href="a00189.html#a00618">GLMGEEParameters</a>));</div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;      <a class="code" href="a00218.html#ad6ab74942c9de13cf0b4c12eb0d91780">IERR</a> <a class="code" href="a00250.html#ad7d778f0d388a120492e4901c3319d51">TimeGLMGEEInitialize</a>(solver-&gt;<a class="code" href="a00194.html#a138e751362d14724df8e6ab27c4a5e55">time_scheme</a>,solver-&gt;<a class="code" href="a00194.html#a61750696383420ba8bcc7d9e44a538e2">time_scheme_type</a>,</div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;                                solver-&gt;<a class="code" href="a00194.html#adec095311615891040de11341c01a77f">msti</a>,mpi); <a class="code" href="a00218.html#add9cf96ae374934d245a1dc1ab697a42">CHECKERR</a>(ierr);</div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;      fprintf(stderr,<span class="stringliteral">&quot;Error (domain %d): %s is a not a supported time-integration scheme.\n&quot;</span>,</div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;              ns, solver-&gt;<a class="code" href="a00194.html#a138e751362d14724df8e6ab27c4a5e55">time_scheme</a>);</div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;      <span class="keywordflow">return</span>(1);</div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;    }</div>
<div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;<span class="preprocessor"></span>  </div>
<div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;    <span class="comment">/* Solution output function */</span></div>
<div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;    solver-&gt;<a class="code" href="a00194.html#a9018a1befab4079332620f40375a9661">WriteOutput</a>    = NULL; <span class="comment">/* default - no output */</span></div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;    solver-&gt;<a class="code" href="a00194.html#a0805db42e429173752189696c3c96909">filename_index</a> = NULL;</div>
<div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;    strcpy(solver-&gt;<a class="code" href="a00194.html#a2f63f9a875bb76e6107cb2e7c725d935">op_fname_root</a>, <span class="stringliteral">&quot;op&quot;</span>);</div>
<div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;<span class="preprocessor">#ifdef with_librom</span></div>
<div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;<span class="preprocessor"></span>    strcpy(solver-&gt;<a class="code" href="a00194.html#af5db0aad0268af0ba82e1281d44bb73a">op_rom_fname_root</a>, <span class="stringliteral">&quot;op_rom&quot;</span>);</div>
<div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;<span class="preprocessor"></span>    strcpy(solver-&gt;<a class="code" href="a00194.html#a5d741833915983fdcb695f262a73ae7e">aux_op_fname_root</a>, <span class="stringliteral">&quot;ts0&quot;</span>);</div>
<div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;    <span class="keywordflow">if</span> (!strcmp(solver-&gt;<a class="code" href="a00194.html#a5f89e286a9eaffdb66d966fa6a290d3f">output_mode</a>,<span class="stringliteral">&quot;serial&quot;</span>)) {</div>
<div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;      solver-&gt;<a class="code" href="a00194.html#af474ca4577de91b658e4399ad0a6d7b3">index_length</a> = 5;</div>
<div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;      solver-&gt;<a class="code" href="a00194.html#a0805db42e429173752189696c3c96909">filename_index</a> = (<span class="keywordtype">char</span>*) calloc (solver-&gt;<a class="code" href="a00194.html#af474ca4577de91b658e4399ad0a6d7b3">index_length</a>+1,<span class="keyword">sizeof</span>(<span class="keywordtype">char</span>));</div>
<div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;      <span class="keywordtype">int</span> i; <span class="keywordflow">for</span> (i=0; i&lt;solver-&gt;<a class="code" href="a00194.html#af474ca4577de91b658e4399ad0a6d7b3">index_length</a>; i++) solver-&gt;<a class="code" href="a00194.html#a0805db42e429173752189696c3c96909">filename_index</a>[i] = <span class="charliteral">&#39;0&#39;</span>;</div>
<div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;      solver-&gt;<a class="code" href="a00194.html#a0805db42e429173752189696c3c96909">filename_index</a>[solver-&gt;<a class="code" href="a00194.html#af474ca4577de91b658e4399ad0a6d7b3">index_length</a>] = (<span class="keywordtype">char</span>) 0;</div>
<div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;      <span class="keywordflow">if</span> (!strcmp(solver-&gt;<a class="code" href="a00194.html#a51a3b8c19b86e9e1df5be02b05a6613c">op_file_format</a>,<span class="stringliteral">&quot;text&quot;</span>)) {</div>
<div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;        solver-&gt;<a class="code" href="a00194.html#a9018a1befab4079332620f40375a9661">WriteOutput</a> = <a class="code" href="a00225.html#a3355a71faf3d87f6715ad627db08ac9e">WriteText</a>;</div>
<div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;        strcpy(solver-&gt;<a class="code" href="a00194.html#a25f6a0c8fded2ee6bd9593c737bc3a51">solnfilename_extn</a>,<span class="stringliteral">&quot;.dat&quot;</span>);</div>
<div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;      } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcmp(solver-&gt;<a class="code" href="a00194.html#a51a3b8c19b86e9e1df5be02b05a6613c">op_file_format</a>,<span class="stringliteral">&quot;tecplot2d&quot;</span>)) {</div>
<div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;        solver-&gt;<a class="code" href="a00194.html#a9018a1befab4079332620f40375a9661">WriteOutput</a> = <a class="code" href="a00225.html#a265b0583afb79edd2f2f5d5087e5c3bf">WriteTecplot2D</a>;</div>
<div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;        strcpy(solver-&gt;<a class="code" href="a00194.html#a25f6a0c8fded2ee6bd9593c737bc3a51">solnfilename_extn</a>,<span class="stringliteral">&quot;.dat&quot;</span>);</div>
<div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;      } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcmp(solver-&gt;<a class="code" href="a00194.html#a51a3b8c19b86e9e1df5be02b05a6613c">op_file_format</a>,<span class="stringliteral">&quot;tecplot3d&quot;</span>)) {</div>
<div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;        solver-&gt;<a class="code" href="a00194.html#a9018a1befab4079332620f40375a9661">WriteOutput</a> = <a class="code" href="a00225.html#a5bdb048ecc5ae7ab61622e4764f3133e">WriteTecplot3D</a>;</div>
<div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;        strcpy(solver-&gt;<a class="code" href="a00194.html#a25f6a0c8fded2ee6bd9593c737bc3a51">solnfilename_extn</a>,<span class="stringliteral">&quot;.dat&quot;</span>);</div>
<div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;      } <span class="keywordflow">else</span> <span class="keywordflow">if</span> ((!strcmp(solver-&gt;<a class="code" href="a00194.html#a51a3b8c19b86e9e1df5be02b05a6613c">op_file_format</a>,<span class="stringliteral">&quot;binary&quot;</span>)) || (!strcmp(solver-&gt;<a class="code" href="a00194.html#a51a3b8c19b86e9e1df5be02b05a6613c">op_file_format</a>,<span class="stringliteral">&quot;bin&quot;</span>))) {</div>
<div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;        solver-&gt;<a class="code" href="a00194.html#a9018a1befab4079332620f40375a9661">WriteOutput</a> = <a class="code" href="a00225.html#a067f454c26d85d6cfb4d7d878b3783c9">WriteBinary</a>;</div>
<div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;        strcpy(solver-&gt;<a class="code" href="a00194.html#a25f6a0c8fded2ee6bd9593c737bc3a51">solnfilename_extn</a>,<span class="stringliteral">&quot;.bin&quot;</span>);</div>
<div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;      } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcmp(solver-&gt;<a class="code" href="a00194.html#a51a3b8c19b86e9e1df5be02b05a6613c">op_file_format</a>,<span class="stringliteral">&quot;none&quot;</span>)) {</div>
<div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;        solver-&gt;<a class="code" href="a00194.html#a9018a1befab4079332620f40375a9661">WriteOutput</a> = NULL;</div>
<div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;      } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;        fprintf(stderr,<span class="stringliteral">&quot;Error (domain %d): %s is not a supported file format.\n&quot;</span>,</div>
<div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;                ns, solver-&gt;<a class="code" href="a00194.html#a51a3b8c19b86e9e1df5be02b05a6613c">op_file_format</a>);</div>
<div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;        <span class="keywordflow">return</span>(1);</div>
<div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;      }</div>
<div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;      <span class="keywordflow">if</span> ((!strcmp(solver-&gt;<a class="code" href="a00194.html#a4e93cb107e180ef982b74cef7726b70f">op_overwrite</a>,<span class="stringliteral">&quot;no&quot;</span>)) &amp;&amp; solver-&gt;<a class="code" href="a00194.html#aafb41b96563d9966e8e9f458751f2960">restart_iter</a>) {</div>
<div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;        <span class="comment">/* if it&#39;s a restart run, fast-forward the filename */</span></div>
<div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;        <span class="keywordtype">int</span> t;</div>
<div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;        <span class="keywordflow">for</span> (t=0; t&lt;solver-&gt;<a class="code" href="a00194.html#aafb41b96563d9966e8e9f458751f2960">restart_iter</a>; t++) </div>
<div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;          <span class="keywordflow">if</span> ((t+1)%solver-&gt;<a class="code" href="a00194.html#a6ff746b30ee55a3bbb9f3306c145f27a">file_op_iter</a> == 0) <a class="code" href="a00291.html#a9fda82ed752188f3af821e2c30f63c21">IncrementFilenameIndex</a>(solver-&gt;<a class="code" href="a00194.html#a0805db42e429173752189696c3c96909">filename_index</a>,solver-&gt;<a class="code" href="a00194.html#af474ca4577de91b658e4399ad0a6d7b3">index_length</a>);</div>
<div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;      }</div>
<div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcmp(solver-&gt;<a class="code" href="a00194.html#a5f89e286a9eaffdb66d966fa6a290d3f">output_mode</a>,<span class="stringliteral">&quot;parallel&quot;</span>)) {</div>
<div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;      <span class="keywordflow">if</span> (!strcmp(solver-&gt;<a class="code" href="a00194.html#a51a3b8c19b86e9e1df5be02b05a6613c">op_file_format</a>,<span class="stringliteral">&quot;none&quot;</span>)) solver-&gt;<a class="code" href="a00194.html#a9018a1befab4079332620f40375a9661">WriteOutput</a> = NULL;</div>
<div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;      <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;        <span class="comment">/* only binary file writing supported in parallel mode */</span></div>
<div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;        <span class="comment">/* use post-processing scripts to convert              */</span></div>
<div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;        solver-&gt;<a class="code" href="a00194.html#a9018a1befab4079332620f40375a9661">WriteOutput</a> = <a class="code" href="a00225.html#a067f454c26d85d6cfb4d7d878b3783c9">WriteBinary</a>;</div>
<div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;        strcpy(solver-&gt;<a class="code" href="a00194.html#a25f6a0c8fded2ee6bd9593c737bc3a51">solnfilename_extn</a>,<span class="stringliteral">&quot;.bin&quot;</span>);</div>
<div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;      }</div>
<div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;      fprintf(stderr,<span class="stringliteral">&quot;Error (domain %d): %s is not a supported output mode.\n&quot;</span>,</div>
<div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;              ns, solver-&gt;<a class="code" href="a00194.html#a5f89e286a9eaffdb66d966fa6a290d3f">output_mode</a>);</div>
<div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;      fprintf(stderr,<span class="stringliteral">&quot;Should be \&quot;serial\&quot; or \&quot;parallel\&quot;.    \n&quot;</span>);</div>
<div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;      <span class="keywordflow">return</span>(1);</div>
<div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;    }</div>
<div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;</div>
<div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;  }</div>
<div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;</div>
<div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;  <span class="keywordflow">return</span>(0);</div>
<div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;}</div>
<div class="ttc" id="a00194_html_a2108550c80e1666f11c684fcb4f1ca89"><div class="ttname"><a href="a00194.html#a2108550c80e1666f11c684fcb4f1ca89">HyPar::CalculateConservationError</a></div><div class="ttdeci">int(* CalculateConservationError)(void *, void *)</div><div class="ttdef"><b>Definition:</b> <a href="a00224_source.html#l00368">hypar.h:368</a></div></div>
<div class="ttc" id="a00183_html_a25df96c0eccca13167d28045d187db36"><div class="ttname"><a href="a00183.html#a25df96c0eccca13167d28045d187db36">Interp1PrimSecondOrderMUSCL</a></div><div class="ttdeci">int Interp1PrimSecondOrderMUSCL(double *, double *, double *, double *, int, int, void *, void *, int)</div><div class="ttdoc">2nd order MUSCL scheme (component-wise) on a uniform grid </div><div class="ttdef"><b>Definition:</b> <a href="a00330_source.html#l00076">Interp1PrimSecondOrderMUSCL.c:76</a></div></div>
<div class="ttc" id="a00194_html_a5d741833915983fdcb695f262a73ae7e"><div class="ttname"><a href="a00194.html#a5d741833915983fdcb695f262a73ae7e">HyPar::aux_op_fname_root</a></div><div class="ttdeci">char aux_op_fname_root[_MAX_STRING_SIZE_]</div><div class="ttdef"><b>Definition:</b> <a href="a00224_source.html#l00195">hypar.h:195</a></div></div>
<div class="ttc" id="a00183_html_a697d5c94aa331054c5286492e7fa39c7"><div class="ttname"><a href="a00183.html#a697d5c94aa331054c5286492e7fa39c7">Interp1PrimSecondOrderCentral</a></div><div class="ttdeci">int Interp1PrimSecondOrderCentral(double *, double *, double *, double *, int, int, void *, void *, int)</div><div class="ttdoc">2nd order central reconstruction (component-wise) on a uniform grid </div><div class="ttdef"><b>Definition:</b> <a href="a00328_source.html#l00062">Interp1PrimSecondOrderCentral.c:62</a></div></div>
<div class="ttc" id="a00194_html_a9a61d44b50cc9043a19bdc3c0f591d99"><div class="ttname"><a href="a00194.html#a9a61d44b50cc9043a19bdc3c0f591d99">HyPar::flag_nonlinearinterp</a></div><div class="ttdeci">int flag_nonlinearinterp</div><div class="ttdef"><b>Definition:</b> <a href="a00224_source.html#l00387">hypar.h:387</a></div></div>
<div class="ttc" id="a00183_html_a22e0ae19117192cae9978a7a741d15a5"><div class="ttname"><a href="a00183.html#a22e0ae19117192cae9978a7a741d15a5">MUSCLInitialize</a></div><div class="ttdeci">int MUSCLInitialize(void *, void *)</div><div class="ttdef"><b>Definition:</b> <a href="a00335_source.html#l00017">MUSCLInitialize.c:17</a></div></div>
<div class="ttc" id="a00194_html_a170f2f6cc8ac86b78fcb376c2392e290"><div class="ttname"><a href="a00194.html#a170f2f6cc8ac86b78fcb376c2392e290">HyPar::spatial_scheme_par</a></div><div class="ttdeci">char spatial_scheme_par[_MAX_STRING_SIZE_]</div><div class="ttdef"><b>Definition:</b> <a href="a00224_source.html#l00091">hypar.h:91</a></div></div>
<div class="ttc" id="a00189_html_aad9619c099daeb3e6b1b7ef9e03e38d8"><div class="ttname"><a href="a00189.html#aad9619c099daeb3e6b1b7ef9e03e38d8">_GLM_GEE_</a></div><div class="ttdeci">#define _GLM_GEE_</div><div class="ttdef"><b>Definition:</b> <a href="a00189_source.html#l00018">timeintegration_struct.h:18</a></div></div>
<div class="ttc" id="a00212_html_a00627"><div class="ttname"><a href="a00212.html#a00627">TridiagLU</a></div><div class="ttdef"><b>Definition:</b> <a href="a00212_source.html#l00084">tridiagLU.h:84</a></div></div>
<div class="ttc" id="a00183_html_a33b1e24c12129941b0027a83c543a654"><div class="ttname"><a href="a00183.html#a33b1e24c12129941b0027a83c543a654">Interp1PrimFifthOrderCRWENO</a></div><div class="ttdeci">int Interp1PrimFifthOrderCRWENO(double *, double *, double *, double *, int, int, void *, void *, int)</div><div class="ttdoc">5th order CRWENO reconstruction (component-wise) on a uniform grid </div><div class="ttdef"><b>Definition:</b> <a href="a00316_source.html#l00078">Interp1PrimFifthOrderCRWENO.c:78</a></div></div>
<div class="ttc" id="a00208_html_a4afd2c7b3eb8fda452474ebdbe71c8c0"><div class="ttname"><a href="a00208.html#a4afd2c7b3eb8fda452474ebdbe71c8c0">SimulationObject::mpi</a></div><div class="ttdeci">MPIVariables mpi</div><div class="ttdef"><b>Definition:</b> <a href="a00208_source.html#l00025">simulation_object.h:25</a></div></div>
<div class="ttc" id="a00183_html_a6d34f5e8aae80a0d2a27ea20368dfef1"><div class="ttname"><a href="a00183.html#a6d34f5e8aae80a0d2a27ea20368dfef1">_FIFTH_ORDER_HCWENO_</a></div><div class="ttdeci">#define _FIFTH_ORDER_HCWENO_</div><div class="ttdef"><b>Definition:</b> <a href="a00183_source.html#l00030">interpolation.h:30</a></div></div>
<div class="ttc" id="a00224_html_a9f4de86b900c9aa5f097c2746e17612a"><div class="ttname"><a href="a00224.html#a9f4de86b900c9aa5f097c2746e17612a">_NC_2STAGE_</a></div><div class="ttdeci">#define _NC_2STAGE_</div><div class="ttdef"><b>Definition:</b> <a href="a00224_source.html#l00431">hypar.h:431</a></div></div>
<div class="ttc" id="a00244_html_a7fa2be45147cb91831760e66b631e15c"><div class="ttname"><a href="a00244.html#a7fa2be45147cb91831760e66b631e15c">SecondDerivativeFourthOrderCentral</a></div><div class="ttdeci">int SecondDerivativeFourthOrderCentral(double *, double *, int, void *, void *)</div><div class="ttdef"><b>Definition:</b> <a href="a00547_source.html#l00034">SecondDerivativeFourthOrder.c:34</a></div></div>
<div class="ttc" id="a00183_html_a175a82b8ae2b24c0ba51e1b1dd68c0e5"><div class="ttname"><a href="a00183.html#a175a82b8ae2b24c0ba51e1b1dd68c0e5">_FIFTH_ORDER_CRWENO_</a></div><div class="ttdeci">#define _FIFTH_ORDER_CRWENO_</div><div class="ttdef"><b>Definition:</b> <a href="a00183_source.html#l00028">interpolation.h:28</a></div></div>
<div class="ttc" id="a00194_html_a13a0f9420009a55a3689f407a2c8efea"><div class="ttname"><a href="a00194.html#a13a0f9420009a55a3689f407a2c8efea">HyPar::InterpolateInterfacesPar</a></div><div class="ttdeci">int(* InterpolateInterfacesPar)(double *, double *, int, void *, void *)</div><div class="ttdef"><b>Definition:</b> <a href="a00224_source.html#l00226">hypar.h:226</a></div></div>
<div class="ttc" id="a00194_html_a0805db42e429173752189696c3c96909"><div class="ttname"><a href="a00194.html#a0805db42e429173752189696c3c96909">HyPar::filename_index</a></div><div class="ttdeci">char * filename_index</div><div class="ttdef"><b>Definition:</b> <a href="a00224_source.html#l00186">hypar.h:186</a></div></div>
<div class="ttc" id="a00183_html_acfeff1b158131390b7129f4a857b15ff"><div class="ttname"><a href="a00183.html#acfeff1b158131390b7129f4a857b15ff">_FIFTH_ORDER_WENO_</a></div><div class="ttdeci">#define _FIFTH_ORDER_WENO_</div><div class="ttdef"><b>Definition:</b> <a href="a00183_source.html#l00026">interpolation.h:26</a></div></div>
<div class="ttc" id="a00218_html_ad6ab74942c9de13cf0b4c12eb0d91780"><div class="ttname"><a href="a00218.html#ad6ab74942c9de13cf0b4c12eb0d91780">IERR</a></div><div class="ttdeci">#define IERR</div><div class="ttdef"><b>Definition:</b> <a href="a00218_source.html#l00012">basic.h:12</a></div></div>
<div class="ttc" id="a00292_html_af2e57e55724c44c535903d432a9d6193"><div class="ttname"><a href="a00292.html#af2e57e55724c44c535903d432a9d6193">NonLinearInterpolation</a></div><div class="ttdeci">int NonLinearInterpolation(double *u, void *s, void *m, double t, int(*FluxFunction)(double *, double *, int, void *, double))</div><div class="ttdef"><b>Definition:</b> <a href="a00292_source.html#l00028">NonLinearInterpolation.c:28</a></div></div>
<div class="ttc" id="a00225_html_a067f454c26d85d6cfb4d7d878b3783c9"><div class="ttname"><a href="a00225.html#a067f454c26d85d6cfb4d7d878b3783c9">WriteBinary</a></div><div class="ttdeci">int WriteBinary(int, int, int *, double *, double *, char *, int *)</div><div class="ttdef"><b>Definition:</b> <a href="a00343_source.html#l00034">WriteBinary.c:34</a></div></div>
<div class="ttc" id="a00284_html_abf698222199fe88976002228400c428d"><div class="ttname"><a href="a00284.html#abf698222199fe88976002228400c428d">BoundaryIntegral</a></div><div class="ttdeci">int BoundaryIntegral(void *s, void *m)</div><div class="ttdef"><b>Definition:</b> <a href="a00284_source.html#l00017">BoundaryIntegral.c:17</a></div></div>
<div class="ttc" id="a00208_html_a00626"><div class="ttname"><a href="a00208.html#a00626">SimulationObject</a></div><div class="ttdoc">Structure defining a simulation. </div><div class="ttdef"><b>Definition:</b> <a href="a00208_source.html#l00023">simulation_object.h:23</a></div></div>
<div class="ttc" id="a00183_html_a3ac2a77b9fa5a50499c285e49cf91344"><div class="ttname"><a href="a00183.html#a3ac2a77b9fa5a50499c285e49cf91344">Interp1PrimFifthOrderCompactUpwind</a></div><div class="ttdeci">int Interp1PrimFifthOrderCompactUpwind(double *, double *, double *, double *, int, int, void *, void *, int)</div><div class="ttdoc">5th order compact upwind reconstruction (component-wise) on a uniform grid </div><div class="ttdef"><b>Definition:</b> <a href="a00314_source.html#l00072">Interp1PrimFifthOrderCompactUpwind.c:72</a></div></div>
<div class="ttc" id="a00183_html_af2195885ad055989a1b2b11655843343"><div class="ttname"><a href="a00183.html#af2195885ad055989a1b2b11655843343">Interp1PrimFifthOrderWENO</a></div><div class="ttdeci">int Interp1PrimFifthOrderWENO(double *, double *, double *, double *, int, int, void *, void *, int)</div><div class="ttdoc">5th order WENO reconstruction (component-wise) on a uniform grid </div><div class="ttdef"><b>Definition:</b> <a href="a00322_source.html#l00072">Interp1PrimFifthOrderWENO.c:72</a></div></div>
<div class="ttc" id="a00225_html_a5bdb048ecc5ae7ab61622e4764f3133e"><div class="ttname"><a href="a00225.html#a5bdb048ecc5ae7ab61622e4764f3133e">WriteTecplot3D</a></div><div class="ttdeci">int WriteTecplot3D(int, int, int *, double *, double *, char *, int *)</div><div class="ttdef"><b>Definition:</b> <a href="a00345_source.html#l00019">WriteTecplot3D.c:19</a></div></div>
<div class="ttc" id="a00183_html_a0a067c9c4745556845b9bcb7f049b59b"><div class="ttname"><a href="a00183.html#a0a067c9c4745556845b9bcb7f049b59b">Interp1PrimFirstOrderUpwind</a></div><div class="ttdeci">int Interp1PrimFirstOrderUpwind(double *, double *, double *, double *, int, int, void *, void *, int)</div><div class="ttdoc">1st order upwind reconstruction (component-wise) on a uniform grid </div><div class="ttdef"><b>Definition:</b> <a href="a00324_source.html#l00061">Interp1PrimFirstOrderUpwind.c:61</a></div></div>
<div class="ttc" id="a00194_html_ad45d57b33d578bf602574a221bf53d93"><div class="ttname"><a href="a00194.html#ad45d57b33d578bf602574a221bf53d93">HyPar::spatial_type_par</a></div><div class="ttdeci">char spatial_type_par[_MAX_STRING_SIZE_]</div><div class="ttdef"><b>Definition:</b> <a href="a00224_source.html#l00088">hypar.h:88</a></div></div>
<div class="ttc" id="a00194_html_a479abc98a0ca73359a33089ba5d37863"><div class="ttname"><a href="a00194.html#a479abc98a0ca73359a33089ba5d37863">HyPar::BoundaryIntegralFunction</a></div><div class="ttdeci">int(* BoundaryIntegralFunction)(void *, void *)</div><div class="ttdef"><b>Definition:</b> <a href="a00224_source.html#l00366">hypar.h:366</a></div></div>
<div class="ttc" id="a00194_html_aa4de7bdc1e62417caf51b9c45184268d"><div class="ttname"><a href="a00194.html#aa4de7bdc1e62417caf51b9c45184268d">HyPar::ApplyBoundaryConditions</a></div><div class="ttdeci">int(* ApplyBoundaryConditions)(void *, void *, double *, double *, double)</div><div class="ttdef"><b>Definition:</b> <a href="a00224_source.html#l00201">hypar.h:201</a></div></div>
<div class="ttc" id="a00194_html_a51a3b8c19b86e9e1df5be02b05a6613c"><div class="ttname"><a href="a00194.html#a51a3b8c19b86e9e1df5be02b05a6613c">HyPar::op_file_format</a></div><div class="ttdeci">char op_file_format[_MAX_STRING_SIZE_]</div><div class="ttdef"><b>Definition:</b> <a href="a00224_source.html#l00178">hypar.h:178</a></div></div>
<div class="ttc" id="a00183_html_a759e07ba8a484c2c6971fc7c6a81a95a"><div class="ttname"><a href="a00183.html#a759e07ba8a484c2c6971fc7c6a81a95a">Interp1PrimFirstOrderUpwindChar</a></div><div class="ttdeci">int Interp1PrimFirstOrderUpwindChar(double *, double *, double *, double *, int, int, void *, void *, int)</div><div class="ttdoc">1st order upwind reconstruction (characteristic-based) on a uniform grid </div><div class="ttdef"><b>Definition:</b> <a href="a00325_source.html#l00077">Interp1PrimFirstOrderUpwindChar.c:77</a></div></div>
<div class="ttc" id="a00183_html_aecbe557b2ccc254cdbbd312fc91717be"><div class="ttname"><a href="a00183.html#aecbe557b2ccc254cdbbd312fc91717be">WENOInitialize</a></div><div class="ttdeci">int WENOInitialize(void *, void *, char *, char *)</div><div class="ttdef"><b>Definition:</b> <a href="a00339_source.html#l00024">WENOInitialize.c:24</a></div></div>
<div class="ttc" id="a00224_html_a18ee8cd9b4297a259b08aa4cdfe30aa1"><div class="ttname"><a href="a00224.html#a18ee8cd9b4297a259b08aa4cdfe30aa1">_NC_1STAGE_</a></div><div class="ttdeci">#define _NC_1STAGE_</div><div class="ttdef"><b>Definition:</b> <a href="a00224_source.html#l00429">hypar.h:429</a></div></div>
<div class="ttc" id="a00189_html_a50d4bf1e7e4825cc062fca99a770e5ce"><div class="ttname"><a href="a00189.html#a50d4bf1e7e4825cc062fca99a770e5ce">_RK_</a></div><div class="ttdeci">#define _RK_</div><div class="ttdef"><b>Definition:</b> <a href="a00189_source.html#l00016">timeintegration_struct.h:16</a></div></div>
<div class="ttc" id="a00183_html_a98098e68334c1a9cabe5b721aa8fbe59"><div class="ttname"><a href="a00183.html#a98098e68334c1a9cabe5b721aa8fbe59">Interp1PrimFourthOrderCentral</a></div><div class="ttdeci">int Interp1PrimFourthOrderCentral(double *, double *, double *, double *, int, int, void *, void *, int)</div><div class="ttdoc">4th order central reconstruction (component-wise) on a uniform grid </div><div class="ttdef"><b>Definition:</b> <a href="a00326_source.html#l00062">Interp1PrimFourthOrderCentral.c:62</a></div></div>
<div class="ttc" id="a00218_html_a68f50121fb9a7daeaf60e50cdef82ef3"><div class="ttname"><a href="a00218.html#a68f50121fb9a7daeaf60e50cdef82ef3">_DECLARE_IERR_</a></div><div class="ttdeci">#define _DECLARE_IERR_</div><div class="ttdef"><b>Definition:</b> <a href="a00218_source.html#l00013">basic.h:13</a></div></div>
<div class="ttc" id="a00194_html_a6ff746b30ee55a3bbb9f3306c145f27a"><div class="ttname"><a href="a00194.html#a6ff746b30ee55a3bbb9f3306c145f27a">HyPar::file_op_iter</a></div><div class="ttdeci">int file_op_iter</div><div class="ttdef"><b>Definition:</b> <a href="a00224_source.html#l00163">hypar.h:163</a></div></div>
<div class="ttc" id="a00183_html_ac1f614645aa891fde12c0ce4354de45d"><div class="ttname"><a href="a00183.html#ac1f614645aa891fde12c0ce4354de45d">_COMPONENTS_</a></div><div class="ttdeci">#define _COMPONENTS_</div><div class="ttdef"><b>Definition:</b> <a href="a00183_source.html#l00034">interpolation.h:34</a></div></div>
<div class="ttc" id="a00194_html_afeeb150a9699ade5eccc7589fcae3fe0"><div class="ttname"><a href="a00194.html#afeeb150a9699ade5eccc7589fcae3fe0">HyPar::SetInterpLimiterVar</a></div><div class="ttdeci">int(* SetInterpLimiterVar)(double *, double *, double *, int, void *, void *)</div><div class="ttdef"><b>Definition:</b> <a href="a00224_source.html#l00221">hypar.h:221</a></div></div>
<div class="ttc" id="a00250_html_ad7d778f0d388a120492e4901c3319d51"><div class="ttname"><a href="a00250.html#ad7d778f0d388a120492e4901c3319d51">TimeGLMGEEInitialize</a></div><div class="ttdeci">int TimeGLMGEEInitialize(char *, char *, void *, void *)</div><div class="ttdef"><b>Definition:</b> <a href="a00590_source.html#l00024">TimeGLMGEEInitialize.c:24</a></div></div>
<div class="ttc" id="a00224_html_aabd653aa5d489ae2d0d8140290f6f026"><div class="ttname"><a href="a00224.html#aabd653aa5d489ae2d0d8140290f6f026">_CONS_1STAGE_</a></div><div class="ttdeci">#define _CONS_1STAGE_</div><div class="ttdef"><b>Definition:</b> <a href="a00224_source.html#l00437">hypar.h:437</a></div></div>
<div class="ttc" id="a00212_html_a52d21dfe1d76916811879bf0d7a29d72"><div class="ttname"><a href="a00212.html#a52d21dfe1d76916811879bf0d7a29d72">tridiagLUInit</a></div><div class="ttdeci">int tridiagLUInit(void *, void *)</div><div class="ttdef"><b>Definition:</b> <a href="a00603_source.html#l00039">tridiagLUInit.c:39</a></div></div>
<div class="ttc" id="a00194_html_a4e93cb107e180ef982b74cef7726b70f"><div class="ttname"><a href="a00194.html#a4e93cb107e180ef982b74cef7726b70f">HyPar::op_overwrite</a></div><div class="ttdeci">char op_overwrite[_MAX_STRING_SIZE_]</div><div class="ttdef"><b>Definition:</b> <a href="a00224_source.html#l00183">hypar.h:183</a></div></div>
<div class="ttc" id="a00183_html_ade9ece6e934d70cdf29090494440f505"><div class="ttname"><a href="a00183.html#ade9ece6e934d70cdf29090494440f505">Interp1PrimFifthOrderUpwindChar</a></div><div class="ttdeci">int Interp1PrimFifthOrderUpwindChar(double *, double *, double *, double *, int, int, void *, void *, int)</div><div class="ttdoc">5th order upwind reconstruction (characteristic-based) on a uniform grid </div><div class="ttdef"><b>Definition:</b> <a href="a00321_source.html#l00084">Interp1PrimFifthOrderUpwindChar.c:84</a></div></div>
<div class="ttc" id="a00285_html_aef9a903e2e2870dbadbae56ab1b62eb7"><div class="ttname"><a href="a00285.html#aef9a903e2e2870dbadbae56ab1b62eb7">CalculateConservationError</a></div><div class="ttdeci">int CalculateConservationError(void *s, void *m)</div><div class="ttdef"><b>Definition:</b> <a href="a00285_source.html#l00016">CalculateConservationError.c:16</a></div></div>
<div class="ttc" id="a00194_html_a7de550a63022232e0039dc46a08114b0"><div class="ttname"><a href="a00194.html#a7de550a63022232e0039dc46a08114b0">HyPar::TimeIntegrate</a></div><div class="ttdeci">int(* TimeIntegrate)(void *)</div><div class="ttdef"><b>Definition:</b> <a href="a00224_source.html#l00207">hypar.h:207</a></div></div>
<div class="ttc" id="a00183_html_a00609"><div class="ttname"><a href="a00183.html#a00609">CompactScheme</a></div><div class="ttdoc">Structure of variables/parameters needed by the compact schemes. </div><div class="ttdef"><b>Definition:</b> <a href="a00183_source.html#l00443">interpolation.h:443</a></div></div>
<div class="ttc" id="a00194_html_adec095311615891040de11341c01a77f"><div class="ttname"><a href="a00194.html#adec095311615891040de11341c01a77f">HyPar::msti</a></div><div class="ttdeci">void * msti</div><div class="ttdef"><b>Definition:</b> <a href="a00224_source.html#l00342">hypar.h:342</a></div></div>
<div class="ttc" id="a00194_html_a9591ba0fadb863561474e2ba251d2594"><div class="ttname"><a href="a00194.html#a9591ba0fadb863561474e2ba251d2594">HyPar::interp_type</a></div><div class="ttdeci">char interp_type[_MAX_STRING_SIZE_]</div><div class="ttdef"><b>Definition:</b> <a href="a00224_source.html#l00080">hypar.h:80</a></div></div>
<div class="ttc" id="a00183_html_a7bc4a755992e5f68efe365591b7a2c02"><div class="ttname"><a href="a00183.html#a7bc4a755992e5f68efe365591b7a2c02">_FIFTH_ORDER_UPWIND_</a></div><div class="ttdeci">#define _FIFTH_ORDER_UPWIND_</div><div class="ttdef"><b>Definition:</b> <a href="a00183_source.html#l00022">interpolation.h:22</a></div></div>
<div class="ttc" id="a00189_html_af9b1e641532cff8859c5c5a8377f5feb"><div class="ttname"><a href="a00189.html#af9b1e641532cff8859c5c5a8377f5feb">_FORWARD_EULER_</a></div><div class="ttdeci">#define _FORWARD_EULER_</div><div class="ttdef"><b>Definition:</b> <a href="a00189_source.html#l00014">timeintegration_struct.h:14</a></div></div>
<div class="ttc" id="a00183_html_a00629"><div class="ttname"><a href="a00183.html#a00629">WENOParameters</a></div><div class="ttdoc">Structure of variables/parameters needed by the WENO-type scheme. </div><div class="ttdef"><b>Definition:</b> <a href="a00183_source.html#l00181">interpolation.h:181</a></div></div>
<div class="ttc" id="a00194_html_aafb41b96563d9966e8e9f458751f2960"><div class="ttname"><a href="a00194.html#aafb41b96563d9966e8e9f458751f2960">HyPar::restart_iter</a></div><div class="ttdeci">int restart_iter</div><div class="ttdef"><b>Definition:</b> <a href="a00224_source.html#l00050">hypar.h:50</a></div></div>
<div class="ttc" id="a00183_html_a963c82116a2a1d6084af3d519b61b896"><div class="ttname"><a href="a00183.html#a963c82116a2a1d6084af3d519b61b896">Interp1PrimSecondOrderCentralChar</a></div><div class="ttdeci">int Interp1PrimSecondOrderCentralChar(double *, double *, double *, double *, int, int, void *, void *, int)</div><div class="ttdoc">2nd order central reconstruction (characteristic-based) on a uniform grid </div><div class="ttdef"><b>Definition:</b> <a href="a00329_source.html#l00079">Interp1PrimSecondOrderCentralChar.c:79</a></div></div>
<div class="ttc" id="a00293_html_a5e79cc5efd6d3e4c93717a67e0fbf918"><div class="ttname"><a href="a00293.html#a5e79cc5efd6d3e4c93717a67e0fbf918">ParabolicFunctionCons1Stage</a></div><div class="ttdeci">int ParabolicFunctionCons1Stage(double *par, double *u, void *s, void *m, double t)</div><div class="ttdef"><b>Definition:</b> <a href="a00293_source.html#l00034">ParabolicFunctionCons1Stage.c:34</a></div></div>
<div class="ttc" id="a00194_html_a25f6a0c8fded2ee6bd9593c737bc3a51"><div class="ttname"><a href="a00194.html#a25f6a0c8fded2ee6bd9593c737bc3a51">HyPar::solnfilename_extn</a></div><div class="ttdeci">char solnfilename_extn[_MAX_STRING_SIZE_]</div><div class="ttdef"><b>Definition:</b> <a href="a00224_source.html#l00190">hypar.h:190</a></div></div>
<div class="ttc" id="a00183_html_ae2b27971cc952cf3b4959128bef6174b"><div class="ttname"><a href="a00183.html#ae2b27971cc952cf3b4959128bef6174b">Interp1PrimFifthOrderCRWENOChar</a></div><div class="ttdeci">int Interp1PrimFifthOrderCRWENOChar(double *, double *, double *, double *, int, int, void *, void *, int)</div><div class="ttdoc">5th order CRWENO reconstruction (characteristic-based) on a uniform grid </div><div class="ttdef"><b>Definition:</b> <a href="a00317_source.html#l00093">Interp1PrimFifthOrderCRWENOChar.c:93</a></div></div>
<div class="ttc" id="a00194_html_a2f63f9a875bb76e6107cb2e7c725d935"><div class="ttname"><a href="a00194.html#a2f63f9a875bb76e6107cb2e7c725d935">HyPar::op_fname_root</a></div><div class="ttdeci">char op_fname_root[_MAX_STRING_SIZE_]</div><div class="ttdef"><b>Definition:</b> <a href="a00224_source.html#l00193">hypar.h:193</a></div></div>
<div class="ttc" id="a00194_html_a1dbfa1e479a373073b6ebf72401a7f0f"><div class="ttname"><a href="a00194.html#a1dbfa1e479a373073b6ebf72401a7f0f">HyPar::lusolver</a></div><div class="ttdeci">void * lusolver</div><div class="ttdef"><b>Definition:</b> <a href="a00224_source.html#l00344">hypar.h:344</a></div></div>
<div class="ttc" id="a00295_html_a2faa78314e07ca739b7652ceb22ef083"><div class="ttname"><a href="a00295.html#a2faa78314e07ca739b7652ceb22ef083">ParabolicFunctionNC1Stage</a></div><div class="ttdeci">int ParabolicFunctionNC1Stage(double *par, double *u, void *s, void *m, double t)</div><div class="ttdef"><b>Definition:</b> <a href="a00295_source.html#l00031">ParabolicFunctionNC1Stage.c:31</a></div></div>
<div class="ttc" id="a00250_html_a5fe3d9828c6afcbc00cf6fdd940ebe4b"><div class="ttname"><a href="a00250.html#a5fe3d9828c6afcbc00cf6fdd940ebe4b">TimeForwardEuler</a></div><div class="ttdeci">int TimeForwardEuler(void *)</div><div class="ttdef"><b>Definition:</b> <a href="a00586_source.html#l00025">TimeForwardEuler.c:25</a></div></div>
<div class="ttc" id="a00250_html_a966855c31cad0395c350b9a77add7ab8"><div class="ttname"><a href="a00250.html#a966855c31cad0395c350b9a77add7ab8">TimeExplicitRKInitialize</a></div><div class="ttdeci">int TimeExplicitRKInitialize(char *, char *, void *, void *)</div><div class="ttdef"><b>Definition:</b> <a href="a00585_source.html#l00017">TimeExplicitRKInitialize.c:17</a></div></div>
<div class="ttc" id="a00183_html_a91fbe118c8c01fe1d5efa3cea4930589"><div class="ttname"><a href="a00183.html#a91fbe118c8c01fe1d5efa3cea4930589">Interp1PrimFifthOrderHCWENOChar</a></div><div class="ttdeci">int Interp1PrimFifthOrderHCWENOChar(double *, double *, double *, double *, int, int, void *, void *, int)</div><div class="ttdoc">5th order hybrid compact-WENO reconstruction (characteristic-based) on a uniform grid ...</div><div class="ttdef"><b>Definition:</b> <a href="a00319_source.html#l00079">Interp1PrimFifthOrderHCWENOChar.c:79</a></div></div>
<div class="ttc" id="a00194_html_a5f89e286a9eaffdb66d966fa6a290d3f"><div class="ttname"><a href="a00194.html#a5f89e286a9eaffdb66d966fa6a290d3f">HyPar::output_mode</a></div><div class="ttdeci">char output_mode[_MAX_STRING_SIZE_]</div><div class="ttdef"><b>Definition:</b> <a href="a00224_source.html#l00175">hypar.h:175</a></div></div>
<div class="ttc" id="a00189_html_a00611"><div class="ttname"><a href="a00189.html#a00611">ExplicitRKParameters</a></div><div class="ttdoc">Structure containing the parameters for an explicit Runge-Kutta method. </div><div class="ttdef"><b>Definition:</b> <a href="a00189_source.html#l00166">timeintegration_struct.h:166</a></div></div>
<div class="ttc" id="a00189_html_a00618"><div class="ttname"><a href="a00189.html#a00618">GLMGEEParameters</a></div><div class="ttdoc">Structure containing the parameters for the General Linear Methods with Global Error Estimators (GLM-...</div><div class="ttdef"><b>Definition:</b> <a href="a00189_source.html#l00256">timeintegration_struct.h:256</a></div></div>
<div class="ttc" id="a00244_html_a36b168a9f6846e2b4bc027989c8f3e65"><div class="ttname"><a href="a00244.html#a36b168a9f6846e2b4bc027989c8f3e65">SecondDerivativeSecondOrderCentral</a></div><div class="ttdeci">int SecondDerivativeSecondOrderCentral(double *, double *, int, void *, void *)</div><div class="ttdef"><b>Definition:</b> <a href="a00548_source.html#l00034">SecondDerivativeSecondOrder.c:34</a></div></div>
<div class="ttc" id="a00183_html_a19cc54d502757bfed14b373b443f144c"><div class="ttname"><a href="a00183.html#a19cc54d502757bfed14b373b443f144c">_FIRST_ORDER_UPWIND_</a></div><div class="ttdeci">#define _FIRST_ORDER_UPWIND_</div><div class="ttdef"><b>Definition:</b> <a href="a00183_source.html#l00012">interpolation.h:12</a></div></div>
<div class="ttc" id="a00183_html_a21f7f383e497570fcb71c43f243539d3"><div class="ttname"><a href="a00183.html#a21f7f383e497570fcb71c43f243539d3">_THIRD_ORDER_MUSCL_</a></div><div class="ttdeci">#define _THIRD_ORDER_MUSCL_</div><div class="ttdef"><b>Definition:</b> <a href="a00183_source.html#l00018">interpolation.h:18</a></div></div>
<div class="ttc" id="a00250_html_aca6ebec6e6998f0c509bb38fa91f3321"><div class="ttname"><a href="a00250.html#aca6ebec6e6998f0c509bb38fa91f3321">TimeRK</a></div><div class="ttdeci">int TimeRK(void *)</div><div class="ttdef"><b>Definition:</b> <a href="a00596_source.html#l00029">TimeRK.c:29</a></div></div>
<div class="ttc" id="a00194_html_a29c46b81ad574e4dfbad5a7211487dcb"><div class="ttname"><a href="a00194.html#a29c46b81ad574e4dfbad5a7211487dcb">HyPar::interp</a></div><div class="ttdeci">void * interp</div><div class="ttdef"><b>Definition:</b> <a href="a00224_source.html#l00338">hypar.h:338</a></div></div>
<div class="ttc" id="a00194_html_a138e751362d14724df8e6ab27c4a5e55"><div class="ttname"><a href="a00194.html#a138e751362d14724df8e6ab27c4a5e55">HyPar::time_scheme</a></div><div class="ttdeci">char time_scheme[_MAX_STRING_SIZE_]</div><div class="ttdef"><b>Definition:</b> <a href="a00224_source.html#l00070">hypar.h:70</a></div></div>
<div class="ttc" id="a00183_html_ae832e2314ee85139cec9df4ea82aafa2"><div class="ttname"><a href="a00183.html#ae832e2314ee85139cec9df4ea82aafa2">_FIFTH_ORDER_COMPACT_UPWIND_</a></div><div class="ttdeci">#define _FIFTH_ORDER_COMPACT_UPWIND_</div><div class="ttdef"><b>Definition:</b> <a href="a00183_source.html#l00024">interpolation.h:24</a></div></div>
<div class="ttc" id="a00225_html_a265b0583afb79edd2f2f5d5087e5c3bf"><div class="ttname"><a href="a00225.html#a265b0583afb79edd2f2f5d5087e5c3bf">WriteTecplot2D</a></div><div class="ttdeci">int WriteTecplot2D(int, int, int *, double *, double *, char *, int *)</div><div class="ttdef"><b>Definition:</b> <a href="a00344_source.html#l00019">WriteTecplot2D.c:19</a></div></div>
<div class="ttc" id="a00218_html_add9cf96ae374934d245a1dc1ab697a42"><div class="ttname"><a href="a00218.html#add9cf96ae374934d245a1dc1ab697a42">CHECKERR</a></div><div class="ttdeci">#define CHECKERR(ierr)</div><div class="ttdef"><b>Definition:</b> <a href="a00218_source.html#l00014">basic.h:14</a></div></div>
<div class="ttc" id="a00183_html_a9cde00a0c916f0cda162b1c03d3f7b6b"><div class="ttname"><a href="a00183.html#a9cde00a0c916f0cda162b1c03d3f7b6b">Interp1PrimSecondOrderMUSCLChar</a></div><div class="ttdeci">int Interp1PrimSecondOrderMUSCLChar(double *, double *, double *, double *, int, int, void *, void *, int)</div><div class="ttdoc">2nd order MUSCL scheme (characteristic-based) on a uniform grid </div><div class="ttdef"><b>Definition:</b> <a href="a00331_source.html#l00092">Interp1PrimSecondOrderMUSCLChar.c:92</a></div></div>
<div class="ttc" id="a00197_html_a00622"><div class="ttname"><a href="a00197.html#a00622">MPIVariables</a></div><div class="ttdoc">Structure of MPI-related variables. </div><div class="ttdef"><b>Definition:</b> <a href="a00197_source.html#l00024">mpivars_struct.h:24</a></div></div>
<div class="ttc" id="a00194_html_a4b350316573a1d93caf01c5f1d43a45f"><div class="ttname"><a href="a00194.html#a4b350316573a1d93caf01c5f1d43a45f">HyPar::SecondDerivativePar</a></div><div class="ttdeci">int(* SecondDerivativePar)(double *, double *, int, void *, void *)</div><div class="ttdef"><b>Definition:</b> <a href="a00224_source.html#l00234">hypar.h:234</a></div></div>
<div class="ttc" id="a00183_html_ad9c611137cfce1c622c2e9838fb523c8"><div class="ttname"><a href="a00183.html#ad9c611137cfce1c622c2e9838fb523c8">Interp1PrimFifthOrderHCWENO</a></div><div class="ttdeci">int Interp1PrimFifthOrderHCWENO(double *, double *, double *, double *, int, int, void *, void *, int)</div><div class="ttdoc">5th order hybrid compact-WENO reconstruction (component-wise) on a uniform grid </div><div class="ttdef"><b>Definition:</b> <a href="a00318_source.html#l00063">Interp1PrimFifthOrderHCWENO.c:63</a></div></div>
<div class="ttc" id="a00197_html_adad7a6f85831f3ac84d854b6c80aef43"><div class="ttname"><a href="a00197.html#adad7a6f85831f3ac84d854b6c80aef43">MPIVariables::world</a></div><div class="ttdeci">MPI_Comm world</div><div class="ttdef"><b>Definition:</b> <a href="a00197_source.html#l00037">mpivars_struct.h:37</a></div></div>
<div class="ttc" id="a00296_html_a153eb91ec9b118a7b8c971facbc8d920"><div class="ttname"><a href="a00296.html#a153eb91ec9b118a7b8c971facbc8d920">ParabolicFunctionNC2Stage</a></div><div class="ttdeci">int ParabolicFunctionNC2Stage(double *par, double *u, void *s, void *m, double t)</div><div class="ttdef"><b>Definition:</b> <a href="a00296_source.html#l00040">ParabolicFunctionNC2Stage.c:40</a></div></div>
<div class="ttc" id="a00225_html_a3355a71faf3d87f6715ad627db08ac9e"><div class="ttname"><a href="a00225.html#a3355a71faf3d87f6715ad627db08ac9e">WriteText</a></div><div class="ttdeci">int WriteText(int, int, int *, double *, double *, char *, int *)</div><div class="ttdef"><b>Definition:</b> <a href="a00346_source.html#l00027">WriteText.c:27</a></div></div>
<div class="ttc" id="a00183_html_aea7c973ffe0c37bca0703c1bf6175aaa"><div class="ttname"><a href="a00183.html#aea7c973ffe0c37bca0703c1bf6175aaa">Interp1PrimFifthOrderUpwind</a></div><div class="ttdeci">int Interp1PrimFifthOrderUpwind(double *, double *, double *, double *, int, int, void *, void *, int)</div><div class="ttdoc">5th order upwind reconstruction (component-wise) on a uniform grid </div><div class="ttdef"><b>Definition:</b> <a href="a00320_source.html#l00068">Interp1PrimFifthOrderUpwind.c:68</a></div></div>
<div class="ttc" id="a00283_html_a63bad563b5163bdada0672cec6d535c0"><div class="ttname"><a href="a00283.html#a63bad563b5163bdada0672cec6d535c0">ApplyIBConditions</a></div><div class="ttdeci">int ApplyIBConditions(void *s, void *m, double *x, double waqt)</div><div class="ttdef"><b>Definition:</b> <a href="a00283_source.html#l00013">ApplyIBConditions.c:13</a></div></div>
<div class="ttc" id="a00224_html_a7bc6f9c42df5610bc5d844ad95c74fb8"><div class="ttname"><a href="a00224.html#a7bc6f9c42df5610bc5d844ad95c74fb8">_NC_1_5STAGE_</a></div><div class="ttdeci">#define _NC_1_5STAGE_</div><div class="ttdef"><b>Definition:</b> <a href="a00224_source.html#l00435">hypar.h:435</a></div></div>
<div class="ttc" id="a00208_html_a523947ce4fa7128c4c767163953253b9"><div class="ttname"><a href="a00208.html#a523947ce4fa7128c4c767163953253b9">SimulationObject::solver</a></div><div class="ttdeci">HyPar solver</div><div class="ttdef"><b>Definition:</b> <a href="a00208_source.html#l00026">simulation_object.h:26</a></div></div>
<div class="ttc" id="a00194_html_a17e1cfc7de4fe33c6ee88f2cc42883e7"><div class="ttname"><a href="a00194.html#a17e1cfc7de4fe33c6ee88f2cc42883e7">HyPar::InterpolateInterfacesHyp</a></div><div class="ttdeci">int(* InterpolateInterfacesHyp)(double *, double *, double *, double *, int, int, void *, void *, int)</div><div class="ttdef"><b>Definition:</b> <a href="a00224_source.html#l00211">hypar.h:211</a></div></div>
<div class="ttc" id="a00183_html_ae7eb6a81a164ca0fa2ace3cab2697847"><div class="ttname"><a href="a00183.html#ae7eb6a81a164ca0fa2ace3cab2697847">Interp1PrimThirdOrderMUSCL</a></div><div class="ttdeci">int Interp1PrimThirdOrderMUSCL(double *, double *, double *, double *, int, int, void *, void *, int)</div><div class="ttdoc">3rd order MUSCL scheme with Koren&amp;#39;s limiter (component-wise) on a uniform grid </div><div class="ttdef"><b>Definition:</b> <a href="a00332_source.html#l00075">Interp1PrimThirdOrderMUSCL.c:75</a></div></div>
<div class="ttc" id="a00183_html_abf3b032fdc8c0e84b86909db9e0b93c3"><div class="ttname"><a href="a00183.html#abf3b032fdc8c0e84b86909db9e0b93c3">Interp1PrimFifthOrderWENOChar</a></div><div class="ttdeci">int Interp1PrimFifthOrderWENOChar(double *, double *, double *, double *, int, int, void *, void *, int)</div><div class="ttdoc">5th order WENO reconstruction (characteristic-based) on a uniform grid </div><div class="ttdef"><b>Definition:</b> <a href="a00323_source.html#l00086">Interp1PrimFifthOrderWENOChar.c:86</a></div></div>
<div class="ttc" id="a00194_html_ae8f6d2fd6490d3153cb4133bf183a404"><div class="ttname"><a href="a00194.html#ae8f6d2fd6490d3153cb4133bf183a404">HyPar::nvars</a></div><div class="ttdeci">int nvars</div><div class="ttdef"><b>Definition:</b> <a href="a00224_source.html#l00029">hypar.h:29</a></div></div>
<div class="ttc" id="a00290_html_a0096c47175c007dbe805b34129835b84"><div class="ttname"><a href="a00290.html#a0096c47175c007dbe805b34129835b84">HyperbolicFunction</a></div><div class="ttdeci">int HyperbolicFunction(double *hyp, double *u, void *s, void *m, double t, int LimFlag, int(*FluxFunction)(double *, double *, int, void *, double), int(*UpwindFunction)(double *, double *, double *, double *, double *, double *, int, void *, double))</div><div class="ttdef"><b>Definition:</b> <a href="a00290_source.html#l00029">HyperbolicFunction.c:29</a></div></div>
<div class="ttc" id="a00223_html_ad06a8db0245d2502016fb6c7b77ef37f"><div class="ttname"><a href="a00223.html#ad06a8db0245d2502016fb6c7b77ef37f">FirstDerivativeFirstOrder</a></div><div class="ttdeci">int FirstDerivativeFirstOrder(double *, double *, int, int, void *, void *)</div><div class="ttdef"><b>Definition:</b> <a href="a00279_source.html#l00037">FirstDerivativeFirstOrder.c:37</a></div></div>
<div class="ttc" id="a00183_html_aa7752b40155314f9f2c063d4d9d8339d"><div class="ttname"><a href="a00183.html#aa7752b40155314f9f2c063d4d9d8339d">_CHARACTERISTIC_</a></div><div class="ttdeci">#define _CHARACTERISTIC_</div><div class="ttdef"><b>Definition:</b> <a href="a00183_source.html#l00033">interpolation.h:33</a></div></div>
<div class="ttc" id="a00194_html_af5db0aad0268af0ba82e1281d44bb73a"><div class="ttname"><a href="a00194.html#af5db0aad0268af0ba82e1281d44bb73a">HyPar::op_rom_fname_root</a></div><div class="ttdeci">char op_rom_fname_root[_MAX_STRING_SIZE_]</div><div class="ttdef"><b>Definition:</b> <a href="a00224_source.html#l00383">hypar.h:383</a></div></div>
<div class="ttc" id="a00194_html_add4554e1a8a541607b867db7ec38d7a9"><div class="ttname"><a href="a00194.html#add4554e1a8a541607b867db7ec38d7a9">HyPar::FirstDerivativePar</a></div><div class="ttdeci">int(* FirstDerivativePar)(double *, double *, int, int, void *, void *)</div><div class="ttdef"><b>Definition:</b> <a href="a00224_source.html#l00230">hypar.h:230</a></div></div>
<div class="ttc" id="a00194_html_a83d97dfc50e6bfefd0db6503d365d5bd"><div class="ttname"><a href="a00194.html#a83d97dfc50e6bfefd0db6503d365d5bd">HyPar::ApplyIBConditions</a></div><div class="ttdeci">int(* ApplyIBConditions)(void *, void *, double *, double)</div><div class="ttdef"><b>Definition:</b> <a href="a00224_source.html#l00204">hypar.h:204</a></div></div>
<div class="ttc" id="a00198_html"><div class="ttname"><a href="a00198.html">MUSCLParameters</a></div><div class="ttdoc">Structure of variables/parameters needed by the MUSCL scheme. </div><div class="ttdef"><b>Definition:</b> <a href="a00183_source.html#l00162">interpolation.h:162</a></div></div>
<div class="ttc" id="a00298_html_a74a4527b7a6060acc1808d9c945b117f"><div class="ttname"><a href="a00298.html#a74a4527b7a6060acc1808d9c945b117f">VolumeIntegral</a></div><div class="ttdeci">int VolumeIntegral(double *VolumeIntegral, double *u, void *s, void *m)</div><div class="ttdef"><b>Definition:</b> <a href="a00298_source.html#l00014">VolumeIntegral.c:14</a></div></div>
<div class="ttc" id="a00183_html_ae8bfe856abd743f5af925dc03e708ee3"><div class="ttname"><a href="a00183.html#ae8bfe856abd743f5af925dc03e708ee3">Interp2PrimSecondOrder</a></div><div class="ttdeci">int Interp2PrimSecondOrder(double *, double *, int, void *, void *)</div><div class="ttdoc">2nd order component-wise interpolation of the 2nd primitive on a uniform grid </div><div class="ttdef"><b>Definition:</b> <a href="a00334_source.html#l00056">Interp2PrimSecondOrder.c:56</a></div></div>
<div class="ttc" id="a00223_html_a89694dcc7c48314c98b9636759bb8bee"><div class="ttname"><a href="a00223.html#a89694dcc7c48314c98b9636759bb8bee">_SECOND_ORDER_CENTRAL_</a></div><div class="ttdeci">#define _SECOND_ORDER_CENTRAL_</div><div class="ttdef"><b>Definition:</b> <a href="a00223_source.html#l00012">firstderivative.h:12</a></div></div>
<div class="ttc" id="a00194_html_a228697ae6a0f0fe7a928a9ddad45da54"><div class="ttname"><a href="a00194.html#a228697ae6a0f0fe7a928a9ddad45da54">HyPar::NonlinearInterp</a></div><div class="ttdeci">int(* NonlinearInterp)(double *, void *, void *, double, int(*)(double *, double *, int, void *, double))</div><div class="ttdef"><b>Definition:</b> <a href="a00224_source.html#l00215">hypar.h:215</a></div></div>
<div class="ttc" id="a00183_html_af255a582e14c5820cf12f9f95b4e28fd"><div class="ttname"><a href="a00183.html#af255a582e14c5820cf12f9f95b4e28fd">CompactSchemeInitialize</a></div><div class="ttdeci">int CompactSchemeInitialize(void *, void *, char *)</div><div class="ttdef"><b>Definition:</b> <a href="a00313_source.html#l00017">CompactSchemeInitialize.c:17</a></div></div>
<div class="ttc" id="a00250_html_a7b76988ab950d39d505042dc1f09b875"><div class="ttname"><a href="a00250.html#a7b76988ab950d39d505042dc1f09b875">TimeGLMGEE</a></div><div class="ttdeci">int TimeGLMGEE(void *)</div><div class="ttdef"><b>Definition:</b> <a href="a00588_source.html#l00045">TimeGLMGEE.c:45</a></div></div>
<div class="ttc" id="a00223_html_a27d213967bae3d2b969d07a967525541"><div class="ttname"><a href="a00223.html#a27d213967bae3d2b969d07a967525541">FirstDerivativeSecondOrderCentral</a></div><div class="ttdeci">int FirstDerivativeSecondOrderCentral(double *, double *, int, int, void *, void *)</div><div class="ttdef"><b>Definition:</b> <a href="a00281_source.html#l00036">FirstDerivativeSecondOrder.c:36</a></div></div>
<div class="ttc" id="a00194_html_a662e256e081a2b74f971d02c747892b8"><div class="ttname"><a href="a00194.html#a662e256e081a2b74f971d02c747892b8">HyPar::SourceFunction</a></div><div class="ttdeci">int(* SourceFunction)(double *, double *, void *, void *, double)</div><div class="ttdef"><b>Definition:</b> <a href="a00224_source.html#l00246">hypar.h:246</a></div></div>
<div class="ttc" id="a00183_html_a985d08c4fb9bcb71875c697f9e00d6eb"><div class="ttname"><a href="a00183.html#a985d08c4fb9bcb71875c697f9e00d6eb">Interp1PrimThirdOrderMUSCLChar</a></div><div class="ttdeci">int Interp1PrimThirdOrderMUSCLChar(double *, double *, double *, double *, int, int, void *, void *, int)</div><div class="ttdoc">3rd order MUSCL scheme with Koren&amp;#39;s limiter (characteristic-based) on a uniform grid ...</div><div class="ttdef"><b>Definition:</b> <a href="a00333_source.html#l00091">Interp1PrimThirdOrderMUSCLChar.c:91</a></div></div>
<div class="ttc" id="a00194_html_a61750696383420ba8bcc7d9e44a538e2"><div class="ttname"><a href="a00194.html#a61750696383420ba8bcc7d9e44a538e2">HyPar::time_scheme_type</a></div><div class="ttdeci">char time_scheme_type[_MAX_STRING_SIZE_]</div><div class="ttdef"><b>Definition:</b> <a href="a00224_source.html#l00073">hypar.h:73</a></div></div>
<div class="ttc" id="a00223_html_aac4d00dd8bef7592948a7e563021c02a"><div class="ttname"><a href="a00223.html#aac4d00dd8bef7592948a7e563021c02a">_FOURTH_ORDER_CENTRAL_</a></div><div class="ttdeci">#define _FOURTH_ORDER_CENTRAL_</div><div class="ttdef"><b>Definition:</b> <a href="a00223_source.html#l00014">firstderivative.h:14</a></div></div>
<div class="ttc" id="a00183_html_aa59d0f26584fa405034c2eac2e338c94"><div class="ttname"><a href="a00183.html#aa59d0f26584fa405034c2eac2e338c94">Interp1PrimFourthOrderCentralChar</a></div><div class="ttdeci">int Interp1PrimFourthOrderCentralChar(double *, double *, double *, double *, int, int, void *, void *, int)</div><div class="ttdoc">4th order central reconstruction (characteristic-based) on a uniform grid </div><div class="ttdef"><b>Definition:</b> <a href="a00327_source.html#l00079">Interp1PrimFourthOrderCentralChar.c:79</a></div></div>
<div class="ttc" id="a00194_html_a9018a1befab4079332620f40375a9661"><div class="ttname"><a href="a00194.html#a9018a1befab4079332620f40375a9661">HyPar::WriteOutput</a></div><div class="ttdeci">int(* WriteOutput)(int, int, int *, double *, double *, char *, int *)</div><div class="ttdef"><b>Definition:</b> <a href="a00224_source.html#l00198">hypar.h:198</a></div></div>
<div class="ttc" id="a00294_html_af9331a439bf243524c027eba50fdbbfd"><div class="ttname"><a href="a00294.html#af9331a439bf243524c027eba50fdbbfd">ParabolicFunctionNC1_5Stage</a></div><div class="ttdeci">int ParabolicFunctionNC1_5Stage(double *par, double *u, void *s, void *m, double t)</div><div class="ttdef"><b>Definition:</b> <a href="a00294_source.html#l00035">ParabolicFunctionNC1.5Stage.c:35</a></div></div>
<div class="ttc" id="a00223_html_a08c28e6bc4493172df7b7867e1f3d815"><div class="ttname"><a href="a00223.html#a08c28e6bc4493172df7b7867e1f3d815">FirstDerivativeFourthOrderCentral</a></div><div class="ttdeci">int FirstDerivativeFourthOrderCentral(double *, double *, int, int, void *, void *)</div><div class="ttdef"><b>Definition:</b> <a href="a00280_source.html#l00036">FirstDerivativeFourthOrder.c:36</a></div></div>
<div class="ttc" id="a00194_html_a56318721d534e74a96b440f8542a0232"><div class="ttname"><a href="a00194.html#a56318721d534e74a96b440f8542a0232">HyPar::compact</a></div><div class="ttdeci">void * compact</div><div class="ttdef"><b>Definition:</b> <a href="a00224_source.html#l00340">hypar.h:340</a></div></div>
<div class="ttc" id="a00282_html_ab68722a270954b6816a785ad4923ba45"><div class="ttname"><a href="a00282.html#ab68722a270954b6816a785ad4923ba45">ApplyBoundaryConditions</a></div><div class="ttdeci">int ApplyBoundaryConditions(void *s, void *m, double *x, double *xref, double waqt)</div><div class="ttdoc">Applies the boundary conditions specified for each boundary zone. </div><div class="ttdef"><b>Definition:</b> <a href="a00282_source.html#l00027">ApplyBoundaryConditions.c:27</a></div></div>
<div class="ttc" id="a00194_html"><div class="ttname"><a href="a00194.html">HyPar</a></div><div class="ttdoc">Structure containing all solver-specific variables and functions. </div><div class="ttdef"><b>Definition:</b> <a href="a00224_source.html#l00023">hypar.h:23</a></div></div>
<div class="ttc" id="a00194_html_a0fda913c8c0424880302e9296cc0e813"><div class="ttname"><a href="a00194.html#a0fda913c8c0424880302e9296cc0e813">HyPar::VolumeIntegralFunction</a></div><div class="ttdeci">int(* VolumeIntegralFunction)(double *, double *, void *, void *)</div><div class="ttdef"><b>Definition:</b> <a href="a00224_source.html#l00364">hypar.h:364</a></div></div>
<div class="ttc" id="a00183_html_a28b8d3ce17676cec19de4f91f989042d"><div class="ttname"><a href="a00183.html#a28b8d3ce17676cec19de4f91f989042d">Interp1PrimFifthOrderCompactUpwindChar</a></div><div class="ttdeci">int Interp1PrimFifthOrderCompactUpwindChar(double *, double *, double *, double *, int, int, void *, void *, int)</div><div class="ttdoc">5th order compact upwind reconstruction (characteristic-based) on a uniform grid </div><div class="ttdef"><b>Definition:</b> <a href="a00315_source.html#l00090">Interp1PrimFifthOrderCompactUpwindChar.c:90</a></div></div>
<div class="ttc" id="a00194_html_af474ca4577de91b658e4399ad0a6d7b3"><div class="ttname"><a href="a00194.html#af474ca4577de91b658e4399ad0a6d7b3">HyPar::index_length</a></div><div class="ttdeci">int index_length</div><div class="ttdef"><b>Definition:</b> <a href="a00224_source.html#l00188">hypar.h:188</a></div></div>
<div class="ttc" id="a00194_html_a75e8be4ea8c1ae2e99fc1e802e69a573"><div class="ttname"><a href="a00194.html#a75e8be4ea8c1ae2e99fc1e802e69a573">HyPar::ParabolicFunction</a></div><div class="ttdeci">int(* ParabolicFunction)(double *, double *, void *, void *, double)</div><div class="ttdef"><b>Definition:</b> <a href="a00224_source.html#l00243">hypar.h:243</a></div></div>
<div class="ttc" id="a00194_html_ad29846eeb9c83b329a8d7c1fe69d46b2"><div class="ttname"><a href="a00194.html#ad29846eeb9c83b329a8d7c1fe69d46b2">HyPar::spatial_scheme_hyp</a></div><div class="ttdeci">char spatial_scheme_hyp[_MAX_STRING_SIZE_]</div><div class="ttdef"><b>Definition:</b> <a href="a00224_source.html#l00076">hypar.h:76</a></div></div>
<div class="ttc" id="a00194_html_a1d36fea92472416e32e039b86dea0b18"><div class="ttname"><a href="a00194.html#a1d36fea92472416e32e039b86dea0b18">HyPar::time_integrator</a></div><div class="ttdeci">void * time_integrator</div><div class="ttdef"><b>Definition:</b> <a href="a00224_source.html#l00157">hypar.h:157</a></div></div>
<div class="ttc" id="a00194_html_ad195de8c64c407718e42cda9246be0d2"><div class="ttname"><a href="a00194.html#ad195de8c64c407718e42cda9246be0d2">HyPar::use_petscTS</a></div><div class="ttdeci">int use_petscTS</div><div class="ttdef"><b>Definition:</b> <a href="a00224_source.html#l00371">hypar.h:371</a></div></div>
<div class="ttc" id="a00194_html_aa245f8c9e6af37e47c5867dccbbc208b"><div class="ttname"><a href="a00194.html#aa245f8c9e6af37e47c5867dccbbc208b">HyPar::HyperbolicFunction</a></div><div class="ttdeci">int(* HyperbolicFunction)(double *, double *, void *, void *, double, int, int(*)(double *, double *, int, void *, double), int(*)(double *, double *, double *, double *, double *, double *, int, void *, double))</div><div class="ttdef"><b>Definition:</b> <a href="a00224_source.html#l00237">hypar.h:237</a></div></div>
<div class="ttc" id="a00297_html_a930d3b66826111c93dc222f5f6382744"><div class="ttname"><a href="a00297.html#a930d3b66826111c93dc222f5f6382744">SourceFunction</a></div><div class="ttdeci">int SourceFunction(double *source, double *u, void *s, void *m, double t)</div><div class="ttdef"><b>Definition:</b> <a href="a00297_source.html#l00018">SourceFunction.c:18</a></div></div>
<div class="ttc" id="a00183_html_a32a14b9aa17be670a383e3d539da2afa"><div class="ttname"><a href="a00183.html#a32a14b9aa17be670a383e3d539da2afa">_SECOND_ORDER_MUSCL_</a></div><div class="ttdeci">#define _SECOND_ORDER_MUSCL_</div><div class="ttdef"><b>Definition:</b> <a href="a00183_source.html#l00016">interpolation.h:16</a></div></div>
<div class="ttc" id="a00291_html_a9fda82ed752188f3af821e2c30f63c21"><div class="ttname"><a href="a00291.html#a9fda82ed752188f3af821e2c30f63c21">IncrementFilenameIndex</a></div><div class="ttdeci">void IncrementFilenameIndex(char *f, int len)</div><div class="ttdef"><b>Definition:</b> <a href="a00291_source.html#l00046">IncrementFilename.c:46</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a315baa877650032461e4cc97eef45b6f"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int Cleanup </td>
          <td>(</td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>s</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>nsims</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Clean up: deallocate all arrays and objects</p>
<p>Cleans up and frees the memory after the completion of the simulation. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">s</td><td>Array of simulation objects of type <a class="el" href="a00208.html#a00626" title="Structure defining a simulation. ">SimulationObject</a> </td></tr>
    <tr><td class="paramname">nsims</td><td>number of simulation objects </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="a00549_source.html#l00035">35</a> of file <a class="el" href="a00549_source.html">Cleanup.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;{</div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;  <a class="code" href="a00208.html#a00626">SimulationObject</a>* sim = (<a class="code" href="a00208.html#a00626">SimulationObject</a>*) s;</div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;  <span class="keywordtype">int</span> ns;</div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;  <a class="code" href="a00218.html#a68f50121fb9a7daeaf60e50cdef82ef3">_DECLARE_IERR_</a>;</div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;</div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;  <span class="keywordflow">if</span> (nsims == 0) <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;</div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;  <span class="keywordflow">if</span> (!sim[0].mpi.rank) {</div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;    printf(<span class="stringliteral">&quot;Deallocating arrays.\n&quot;</span>);</div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;  }</div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;</div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;  <span class="keywordflow">for</span> (ns = 0; ns &lt; nsims; ns++) {</div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;</div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;    <span class="keywordflow">if</span> (sim[ns].is_barebones == 1) {</div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;      fprintf(stderr, <span class="stringliteral">&quot;Error in Cleanup(): object is barebones type.\n&quot;</span>);</div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;      <span class="keywordflow">return</span> 1;</div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;    }</div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;</div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;    <a class="code" href="a00194.html">HyPar</a>* solver = &amp;(sim[ns].<a class="code" href="a00208.html#a523947ce4fa7128c4c767163953253b9">solver</a>);</div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;    <a class="code" href="a00197.html#a00622">MPIVariables</a>* mpi = &amp;(sim[ns].<a class="code" href="a00208.html#a4afd2c7b3eb8fda452474ebdbe71c8c0">mpi</a>);</div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;    <a class="code" href="a00185.html">DomainBoundary</a>* boundary = (<a class="code" href="a00185.html">DomainBoundary</a>*) solver-&gt;<a class="code" href="a00194.html#a6b5109ac1048aa203b8969b91e72c3af">boundary</a>;</div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;    <span class="keywordtype">int</span> i;</div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;</div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;    <span class="comment">/* Clean up boundary zones */</span></div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;    for (i = 0; i &lt; solver-&gt;<a class="code" href="a00194.html#a3f9a55664d1c8f058828ae9f4de11906">nBoundaryZones</a>; i++) {</div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;      <a class="code" href="a00218.html#ad6ab74942c9de13cf0b4c12eb0d91780">IERR</a> <a class="code" href="a00219.html#af38bba62aa7b0f51ee9123ced0c46f24">BCCleanup</a>(&amp;boundary[i]); <a class="code" href="a00218.html#add9cf96ae374934d245a1dc1ab697a42">CHECKERR</a>(ierr);</div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;    }</div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;    free(solver-&gt;<a class="code" href="a00194.html#a6b5109ac1048aa203b8969b91e72c3af">boundary</a>);</div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;  </div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;    <span class="comment">/* Clean up immersed boundaries */</span></div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;    <span class="keywordflow">if</span> (solver-&gt;<a class="code" href="a00194.html#ae83b1b0117b6a805ead2e4728945814c">flag_ib</a>) {</div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;      <a class="code" href="a00218.html#ad6ab74942c9de13cf0b4c12eb0d91780">IERR</a> <a class="code" href="a00181.html#a783bf18458c856297374e733c1d503ff">IBCleanup</a>(solver-&gt;<a class="code" href="a00194.html#a8419c1760256467c117ef5932b943259">ib</a>);</div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;      free(solver-&gt;<a class="code" href="a00194.html#a8419c1760256467c117ef5932b943259">ib</a>);</div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;    }</div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;  </div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;    <span class="comment">/* Clean up any allocations in physical model */</span></div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;    <span class="keywordflow">if</span> (!strcmp(solver-&gt;<a class="code" href="a00194.html#ad3fe4b266b398f3a7567ac1b241d99a2">model</a>,<a class="code" href="a00196.html#a44c745170d88218420752d150856b01c">_LINEAR_ADVECTION_DIFFUSION_REACTION_</a>)) {</div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;      <a class="code" href="a00218.html#ad6ab74942c9de13cf0b4c12eb0d91780">IERR</a> <a class="code" href="a00196.html#a114e6f1e977ae4220d29e8097e017f19">LinearADRCleanup</a>(solver-&gt;<a class="code" href="a00194.html#a48e81a1806b5774943fd9a26e9a190f2">physics</a>); <a class="code" href="a00218.html#add9cf96ae374934d245a1dc1ab697a42">CHECKERR</a>(ierr);</div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcmp(solver-&gt;<a class="code" href="a00194.html#ad3fe4b266b398f3a7567ac1b241d99a2">model</a>,<a class="code" href="a00190.html#a801cd9499779d35febbce73603aa70a6">_FP_DOUBLE_WELL_</a>)) {</div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;      <a class="code" href="a00218.html#ad6ab74942c9de13cf0b4c12eb0d91780">IERR</a> <a class="code" href="a00190.html#ad512be0d21fc4b769fcc735ec3482203">FPDoubleWellCleanup</a>(solver-&gt;<a class="code" href="a00194.html#a48e81a1806b5774943fd9a26e9a190f2">physics</a>); <a class="code" href="a00218.html#add9cf96ae374934d245a1dc1ab697a42">CHECKERR</a>(ierr);</div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcmp(solver-&gt;<a class="code" href="a00194.html#ad3fe4b266b398f3a7567ac1b241d99a2">model</a>,<a class="code" href="a00191.html#aaeb0de68ad20c63864e1a6cdf819e836">_FP_POWER_SYSTEM_</a>)) {</div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;      <a class="code" href="a00218.html#ad6ab74942c9de13cf0b4c12eb0d91780">IERR</a> <a class="code" href="a00191.html#ac613cf54a15aaed79e93bd3b12d81f44">FPPowerSystemCleanup</a>(solver-&gt;<a class="code" href="a00194.html#a48e81a1806b5774943fd9a26e9a190f2">physics</a>); <a class="code" href="a00218.html#add9cf96ae374934d245a1dc1ab697a42">CHECKERR</a>(ierr);</div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcmp(solver-&gt;<a class="code" href="a00194.html#ad3fe4b266b398f3a7567ac1b241d99a2">model</a>,<a class="code" href="a00192.html#a104fb063ee608b39fdab8d5e1e752ca3">_FP_POWER_SYSTEM_1BUS_</a>)) {</div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;      <a class="code" href="a00218.html#ad6ab74942c9de13cf0b4c12eb0d91780">IERR</a> <a class="code" href="a00192.html#aa1df50611026cfcfb6c36f53a7620fef">FPPowerSystem1BusCleanup</a>(solver-&gt;<a class="code" href="a00194.html#a48e81a1806b5774943fd9a26e9a190f2">physics</a>); <a class="code" href="a00218.html#add9cf96ae374934d245a1dc1ab697a42">CHECKERR</a>(ierr);</div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcmp(solver-&gt;<a class="code" href="a00194.html#ad3fe4b266b398f3a7567ac1b241d99a2">model</a>,<a class="code" href="a00193.html#a5c8fe736dacda1a087bf1fb514761d6e">_FP_POWER_SYSTEM_3BUS_</a>)) {</div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;      <a class="code" href="a00218.html#ad6ab74942c9de13cf0b4c12eb0d91780">IERR</a> <a class="code" href="a00193.html#a4fc9b84262e14bb803d7469cee294b30">FPPowerSystem3BusCleanup</a>(solver-&gt;<a class="code" href="a00194.html#a48e81a1806b5774943fd9a26e9a190f2">physics</a>); <a class="code" href="a00218.html#add9cf96ae374934d245a1dc1ab697a42">CHECKERR</a>(ierr);</div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcmp(solver-&gt;<a class="code" href="a00194.html#ad3fe4b266b398f3a7567ac1b241d99a2">model</a>,<a class="code" href="a00237.html#a076991b7fbc2b9c6330f792bbba182c2">_EULER_1D_</a>)) {</div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;      <a class="code" href="a00218.html#ad6ab74942c9de13cf0b4c12eb0d91780">IERR</a> <a class="code" href="a00237.html#a8e310ddd9664225aef72a59b99baaaef">Euler1DCleanup</a>(solver-&gt;<a class="code" href="a00194.html#a48e81a1806b5774943fd9a26e9a190f2">physics</a>); <a class="code" href="a00218.html#add9cf96ae374934d245a1dc1ab697a42">CHECKERR</a>(ierr);</div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcmp(solver-&gt;<a class="code" href="a00194.html#ad3fe4b266b398f3a7567ac1b241d99a2">model</a>,<a class="code" href="a00188.html#ae205e355df87a13c8b47c958828bce2f">_EULER_2D_</a>)) {</div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;      <a class="code" href="a00218.html#ad6ab74942c9de13cf0b4c12eb0d91780">IERR</a> <a class="code" href="a00188.html#ae2bd18386ee9184c66bb7e7b78f1b73b">Euler2DCleanup</a>(solver-&gt;<a class="code" href="a00194.html#a48e81a1806b5774943fd9a26e9a190f2">physics</a>); <a class="code" href="a00218.html#add9cf96ae374934d245a1dc1ab697a42">CHECKERR</a>(ierr);</div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcmp(solver-&gt;<a class="code" href="a00194.html#ad3fe4b266b398f3a7567ac1b241d99a2">model</a>,<a class="code" href="a00199.html#a04e16b3f2a882826e604b6353d9e5bcb">_NAVIER_STOKES_2D_</a>)) {</div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;      <a class="code" href="a00218.html#ad6ab74942c9de13cf0b4c12eb0d91780">IERR</a> <a class="code" href="a00199.html#a6906f847d1d73981dfcfcebdb6cb70d4">NavierStokes2DCleanup</a>(solver-&gt;<a class="code" href="a00194.html#a48e81a1806b5774943fd9a26e9a190f2">physics</a>); <a class="code" href="a00218.html#add9cf96ae374934d245a1dc1ab697a42">CHECKERR</a>(ierr);</div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcmp(solver-&gt;<a class="code" href="a00194.html#ad3fe4b266b398f3a7567ac1b241d99a2">model</a>,<a class="code" href="a00200.html#a34099431ed2606bd884d36cea1d0448e">_NAVIER_STOKES_3D_</a>)) {</div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;      <a class="code" href="a00218.html#ad6ab74942c9de13cf0b4c12eb0d91780">IERR</a> <a class="code" href="a00200.html#a5467b4e62f223583e901763082eb0d57">NavierStokes3DCleanup</a>(solver-&gt;<a class="code" href="a00194.html#a48e81a1806b5774943fd9a26e9a190f2">physics</a>); <a class="code" href="a00218.html#add9cf96ae374934d245a1dc1ab697a42">CHECKERR</a>(ierr);</div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcmp(solver-&gt;<a class="code" href="a00194.html#ad3fe4b266b398f3a7567ac1b241d99a2">model</a>,<a class="code" href="a00238.html#a82b3f90650895890211635171d649355">_NUMA2D_</a>)) {</div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;      <a class="code" href="a00218.html#ad6ab74942c9de13cf0b4c12eb0d91780">IERR</a> <a class="code" href="a00238.html#a064e0d5fee20148d9337dadf871edda3">Numa2DCleanup</a>(solver-&gt;<a class="code" href="a00194.html#a48e81a1806b5774943fd9a26e9a190f2">physics</a>); <a class="code" href="a00218.html#add9cf96ae374934d245a1dc1ab697a42">CHECKERR</a>(ierr);</div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcmp(solver-&gt;<a class="code" href="a00194.html#ad3fe4b266b398f3a7567ac1b241d99a2">model</a>,<a class="code" href="a00239.html#a8bccae14dde8eaba7663344939367e96">_NUMA3D_</a>)) {</div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;      <a class="code" href="a00218.html#ad6ab74942c9de13cf0b4c12eb0d91780">IERR</a> <a class="code" href="a00239.html#a4f6671875e6da5b2480003e749cc35f0">Numa3DCleanup</a>(solver-&gt;<a class="code" href="a00194.html#a48e81a1806b5774943fd9a26e9a190f2">physics</a>); <a class="code" href="a00218.html#add9cf96ae374934d245a1dc1ab697a42">CHECKERR</a>(ierr);</div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcmp(solver-&gt;<a class="code" href="a00194.html#ad3fe4b266b398f3a7567ac1b241d99a2">model</a>,<a class="code" href="a00240.html#ac280c6ead138670f1f518fad3ea94737">_SHALLOW_WATER_1D_</a>)) {</div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;      <a class="code" href="a00218.html#ad6ab74942c9de13cf0b4c12eb0d91780">IERR</a> <a class="code" href="a00240.html#ab1bdb73df74d06f2e2aeb940b87fcdcf">ShallowWater1DCleanup</a>(solver-&gt;<a class="code" href="a00194.html#a48e81a1806b5774943fd9a26e9a190f2">physics</a>); <a class="code" href="a00218.html#add9cf96ae374934d245a1dc1ab697a42">CHECKERR</a>(ierr);</div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcmp(solver-&gt;<a class="code" href="a00194.html#ad3fe4b266b398f3a7567ac1b241d99a2">model</a>,<a class="code" href="a00241.html#aebe5d4a29761b0784c3d3e67e325105b">_SHALLOW_WATER_2D_</a>)) {</div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;      <a class="code" href="a00218.html#ad6ab74942c9de13cf0b4c12eb0d91780">IERR</a> <a class="code" href="a00241.html#a5cfeeae3a3729d15543d8954060a48d4">ShallowWater2DCleanup</a>(solver-&gt;<a class="code" href="a00194.html#a48e81a1806b5774943fd9a26e9a190f2">physics</a>); <a class="code" href="a00218.html#add9cf96ae374934d245a1dc1ab697a42">CHECKERR</a>(ierr);</div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcmp(solver-&gt;<a class="code" href="a00194.html#ad3fe4b266b398f3a7567ac1b241d99a2">model</a>,<a class="code" href="a00213.html#a83dc099011b8d965235f462a935f4830">_VLASOV_</a>)) {</div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;      <a class="code" href="a00218.html#ad6ab74942c9de13cf0b4c12eb0d91780">IERR</a> <a class="code" href="a00213.html#a86cecceaf67a26041189c560ea5a176c">VlasovCleanup</a>(solver-&gt;<a class="code" href="a00194.html#a48e81a1806b5774943fd9a26e9a190f2">physics</a>); <a class="code" href="a00218.html#add9cf96ae374934d245a1dc1ab697a42">CHECKERR</a>(ierr);</div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;    }</div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;    free(solver-&gt;<a class="code" href="a00194.html#a48e81a1806b5774943fd9a26e9a190f2">physics</a>);</div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;  </div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;    <span class="comment">/* Clean up any allocations from time-integration */</span></div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;<span class="preprocessor">#ifdef with_petsc</span></div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;<span class="preprocessor"></span>    <span class="keywordflow">if</span> (!solver-&gt;<a class="code" href="a00194.html#ad195de8c64c407718e42cda9246be0d2">use_petscTS</a>) {</div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;      <span class="keywordflow">if</span> (!strcmp(solver-&gt;<a class="code" href="a00194.html#a138e751362d14724df8e6ab27c4a5e55">time_scheme</a>,<a class="code" href="a00189.html#a50d4bf1e7e4825cc062fca99a770e5ce">_RK_</a>)) {</div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;        <a class="code" href="a00218.html#ad6ab74942c9de13cf0b4c12eb0d91780">IERR</a> <a class="code" href="a00250.html#a9da14408e0e1ce563553ac6638c48456">TimeExplicitRKCleanup</a>(solver-&gt;<a class="code" href="a00194.html#adec095311615891040de11341c01a77f">msti</a>); <a class="code" href="a00218.html#add9cf96ae374934d245a1dc1ab697a42">CHECKERR</a>(ierr);</div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;        free(solver-&gt;<a class="code" href="a00194.html#adec095311615891040de11341c01a77f">msti</a>);</div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;      } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcmp(solver-&gt;<a class="code" href="a00194.html#a138e751362d14724df8e6ab27c4a5e55">time_scheme</a>,<a class="code" href="a00189.html#aad9619c099daeb3e6b1b7ef9e03e38d8">_GLM_GEE_</a>)) {</div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;        <a class="code" href="a00218.html#ad6ab74942c9de13cf0b4c12eb0d91780">IERR</a> <a class="code" href="a00250.html#a600e683b5282f669c7128044f55b2ec4">TimeGLMGEECleanup</a>(solver-&gt;<a class="code" href="a00194.html#adec095311615891040de11341c01a77f">msti</a>); <a class="code" href="a00218.html#add9cf96ae374934d245a1dc1ab697a42">CHECKERR</a>(ierr);</div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;        free(solver-&gt;<a class="code" href="a00194.html#adec095311615891040de11341c01a77f">msti</a>);</div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;      }</div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;    }</div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;<span class="preprocessor">#else</span></div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;<span class="preprocessor"></span>    <span class="keywordflow">if</span> (!strcmp(solver-&gt;<a class="code" href="a00194.html#a138e751362d14724df8e6ab27c4a5e55">time_scheme</a>,<a class="code" href="a00189.html#a50d4bf1e7e4825cc062fca99a770e5ce">_RK_</a>)) {</div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;      <a class="code" href="a00218.html#ad6ab74942c9de13cf0b4c12eb0d91780">IERR</a> <a class="code" href="a00250.html#a9da14408e0e1ce563553ac6638c48456">TimeExplicitRKCleanup</a>(solver-&gt;<a class="code" href="a00194.html#adec095311615891040de11341c01a77f">msti</a>); <a class="code" href="a00218.html#add9cf96ae374934d245a1dc1ab697a42">CHECKERR</a>(ierr);</div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;      free(solver-&gt;<a class="code" href="a00194.html#adec095311615891040de11341c01a77f">msti</a>);</div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcmp(solver-&gt;<a class="code" href="a00194.html#a138e751362d14724df8e6ab27c4a5e55">time_scheme</a>,<a class="code" href="a00189.html#aad9619c099daeb3e6b1b7ef9e03e38d8">_GLM_GEE_</a>)) {</div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;      <a class="code" href="a00218.html#ad6ab74942c9de13cf0b4c12eb0d91780">IERR</a> <a class="code" href="a00250.html#a600e683b5282f669c7128044f55b2ec4">TimeGLMGEECleanup</a>(solver-&gt;<a class="code" href="a00194.html#adec095311615891040de11341c01a77f">msti</a>); <a class="code" href="a00218.html#add9cf96ae374934d245a1dc1ab697a42">CHECKERR</a>(ierr);</div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;      free(solver-&gt;<a class="code" href="a00194.html#adec095311615891040de11341c01a77f">msti</a>);</div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;    }</div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;<span class="preprocessor"></span>  </div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;    <span class="comment">/* Clean up any spatial reconstruction related allocations */</span></div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;    <span class="keywordflow">if</span> (   (!strcmp(solver-&gt;<a class="code" href="a00194.html#ad29846eeb9c83b329a8d7c1fe69d46b2">spatial_scheme_hyp</a>,<a class="code" href="a00183.html#acfeff1b158131390b7129f4a857b15ff">_FIFTH_ORDER_WENO_</a>  )) </div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;        || (!strcmp(solver-&gt;<a class="code" href="a00194.html#ad29846eeb9c83b329a8d7c1fe69d46b2">spatial_scheme_hyp</a>,<a class="code" href="a00183.html#a175a82b8ae2b24c0ba51e1b1dd68c0e5">_FIFTH_ORDER_CRWENO_</a>))</div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;        || (!strcmp(solver-&gt;<a class="code" href="a00194.html#ad29846eeb9c83b329a8d7c1fe69d46b2">spatial_scheme_hyp</a>,<a class="code" href="a00183.html#a6d34f5e8aae80a0d2a27ea20368dfef1">_FIFTH_ORDER_HCWENO_</a>)) ) {</div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;      <a class="code" href="a00218.html#ad6ab74942c9de13cf0b4c12eb0d91780">IERR</a> <a class="code" href="a00183.html#a37dd034f5e9eb221bd3fd51cc8d1b0f4">WENOCleanup</a>(solver-&gt;<a class="code" href="a00194.html#a29c46b81ad574e4dfbad5a7211487dcb">interp</a>); <a class="code" href="a00218.html#add9cf96ae374934d245a1dc1ab697a42">CHECKERR</a>(ierr);</div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;    }</div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;    <span class="keywordflow">if</span> (solver-&gt;<a class="code" href="a00194.html#a29c46b81ad574e4dfbad5a7211487dcb">interp</a>)   free(solver-&gt;<a class="code" href="a00194.html#a29c46b81ad574e4dfbad5a7211487dcb">interp</a>);</div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;    <span class="keywordflow">if</span> (   (!strcmp(solver-&gt;<a class="code" href="a00194.html#ad29846eeb9c83b329a8d7c1fe69d46b2">spatial_scheme_hyp</a>,<a class="code" href="a00183.html#ae832e2314ee85139cec9df4ea82aafa2">_FIFTH_ORDER_COMPACT_UPWIND_</a> )) </div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;        || (!strcmp(solver-&gt;<a class="code" href="a00194.html#ad29846eeb9c83b329a8d7c1fe69d46b2">spatial_scheme_hyp</a>,<a class="code" href="a00183.html#a175a82b8ae2b24c0ba51e1b1dd68c0e5">_FIFTH_ORDER_CRWENO_</a>         ))</div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;        || (!strcmp(solver-&gt;<a class="code" href="a00194.html#ad29846eeb9c83b329a8d7c1fe69d46b2">spatial_scheme_hyp</a>,<a class="code" href="a00183.html#a6d34f5e8aae80a0d2a27ea20368dfef1">_FIFTH_ORDER_HCWENO_</a>         )) ) {</div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;      <a class="code" href="a00218.html#ad6ab74942c9de13cf0b4c12eb0d91780">IERR</a> <a class="code" href="a00183.html#acfaa225472f09e2ade88945e909d5893">CompactSchemeCleanup</a>(solver-&gt;<a class="code" href="a00194.html#a56318721d534e74a96b440f8542a0232">compact</a>); <a class="code" href="a00218.html#add9cf96ae374934d245a1dc1ab697a42">CHECKERR</a>(ierr);</div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;    }</div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;    <span class="keywordflow">if</span> (solver-&gt;<a class="code" href="a00194.html#a56318721d534e74a96b440f8542a0232">compact</a>)  free(solver-&gt;<a class="code" href="a00194.html#a56318721d534e74a96b440f8542a0232">compact</a>);</div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;    <span class="keywordflow">if</span> (solver-&gt;<a class="code" href="a00194.html#a1dbfa1e479a373073b6ebf72401a7f0f">lusolver</a>) free(solver-&gt;<a class="code" href="a00194.html#a1dbfa1e479a373073b6ebf72401a7f0f">lusolver</a>);</div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;  </div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;    <span class="comment">/* Free the communicators created */</span></div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;    <a class="code" href="a00218.html#ad6ab74942c9de13cf0b4c12eb0d91780">IERR</a> <a class="code" href="a00234.html#af59eb9eb78e6e99df5630429e5383617">MPIFreeCommunicators</a>(solver-&gt;<a class="code" href="a00194.html#a484873c74138512e41bc50d17b7d955a">ndims</a>,mpi); <a class="code" href="a00218.html#add9cf96ae374934d245a1dc1ab697a42">CHECKERR</a>(ierr);</div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;  </div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;    <span class="comment">/* These variables are allocated in Initialize.c */</span></div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;    free(solver-&gt;<a class="code" href="a00194.html#aa989ebb755986852177779cdf7bd8c85">dim_global</a>);</div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;    free(solver-&gt;<a class="code" href="a00194.html#a9a4a95bad0d4f4769e5e3cd8798a158a">dim_global_ex</a>);</div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;    free(solver-&gt;<a class="code" href="a00194.html#a38e0371f331cecbe63a77fa03e202afe">dim_local</a>);</div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;    free(solver-&gt;<a class="code" href="a00194.html#a95e9e0f8a692321b83a2e0ce2789c485">index</a>);</div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;    free(solver-&gt;<a class="code" href="a00194.html#a3b6b999a764f1e2ea94bb5f28c7a558c">u</a>);</div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;<span class="preprocessor">#ifdef with_petsc</span></div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;<span class="preprocessor"></span>    <span class="keywordflow">if</span> (solver-&gt;<a class="code" href="a00194.html#acab4b9b417d6c3745ad789099d3731c6">u0</a>)     free(solver-&gt;<a class="code" href="a00194.html#acab4b9b417d6c3745ad789099d3731c6">u0</a>);</div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;    <span class="keywordflow">if</span> (solver-&gt;<a class="code" href="a00194.html#a3ccc9ddb96600c40dcc41bb1ded11160">uref</a>)   free(solver-&gt;<a class="code" href="a00194.html#a3ccc9ddb96600c40dcc41bb1ded11160">uref</a>);</div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;    <span class="keywordflow">if</span> (solver-&gt;<a class="code" href="a00194.html#ad587a58397d439c443ae325450a01a13">rhsref</a>) free(solver-&gt;<a class="code" href="a00194.html#ad587a58397d439c443ae325450a01a13">rhsref</a>);</div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;    <span class="keywordflow">if</span> (solver-&gt;<a class="code" href="a00194.html#ade4650485fe35fd3e12fea272fc80209">rhs</a>)    free(solver-&gt;<a class="code" href="a00194.html#ade4650485fe35fd3e12fea272fc80209">rhs</a>);   </div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;<span class="preprocessor"></span><span class="preprocessor">#ifdef with_librom</span></div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;<span class="preprocessor"></span>    free(solver-&gt;<a class="code" href="a00194.html#aac11b2a653ffaeac4b35057431f1b981">u_rom_predicted</a>);</div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;<span class="preprocessor"></span>    free(solver-&gt;<a class="code" href="a00194.html#a267ef7e03dbe9dd4440dee2fdf48619a">iblank</a>);</div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;    free(solver-&gt;<a class="code" href="a00194.html#aeadfdde0fbc3058bace813055212dcc3">hyp</a>);</div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;    free(solver-&gt;<a class="code" href="a00194.html#ae53517ad7a202762d7b79eaf681701f3">par</a>);</div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;    free(solver-&gt;<a class="code" href="a00194.html#a6b4951ffdbd82f3a3848b82352d389d6">source</a>);</div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;    free(solver-&gt;<a class="code" href="a00194.html#aee7ff3b51db01ee6ed4038ff5311ed24">fluxC</a>);</div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;    free(solver-&gt;<a class="code" href="a00194.html#a86221feda74097db9eb6c900ca1e6cbc">uC</a>);</div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;    free(solver-&gt;<a class="code" href="a00194.html#af163100a3e0533dbf1868decd5c8201c">Deriv1</a>);</div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;    free(solver-&gt;<a class="code" href="a00194.html#a31bc6f5b337e72aa281a1ea5ad5d6832">Deriv2</a>);</div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;    free(solver-&gt;<a class="code" href="a00194.html#a983929b7b1511ff3e7800597adef6a91">fluxI</a>);</div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;    free(solver-&gt;<a class="code" href="a00194.html#a8452297a324a34268a6565583901347d">uL</a>);</div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;    free(solver-&gt;<a class="code" href="a00194.html#a3c811b25c11d2c98bfff02ddeadeb3d9">uR</a>);</div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;    free(solver-&gt;<a class="code" href="a00194.html#a99f72a44e29089b75fd11155bfcc1ff8">fL</a>);</div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;    free(solver-&gt;<a class="code" href="a00194.html#abb50b7a404febaf647f7bd89f873b96e">fR</a>);</div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;    free(solver-&gt;<a class="code" href="a00194.html#a711aad4cbe735871dd9e91ab575c878b">x</a>);</div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;    free(solver-&gt;<a class="code" href="a00194.html#aa24a4f5e29bd70cbe5a2413be1ea9682">dxinv</a>);</div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;    free(solver-&gt;<a class="code" href="a00194.html#a40e3f67b1530d5ea4e913fc60b594802">isPeriodic</a>);</div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;    free(mpi-&gt;<a class="code" href="a00197.html#a0be0f30a83bc3f3d9f6ee3a36bbf2716">iproc</a>);</div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;    free(mpi-&gt;<a class="code" href="a00197.html#aa3c28612a64b8a97bde66b720e15c700">ip</a>);</div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;    free(mpi-&gt;<a class="code" href="a00197.html#a481013ba007a99a4237cde5eeb3c9a29">is</a>);</div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;    free(mpi-&gt;<a class="code" href="a00197.html#a7602de5ebb1b59ec35217e78a35a531e">ie</a>);</div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;    free(mpi-&gt;<a class="code" href="a00197.html#af40a5a3066fdb53a47e4627071abc2bc">bcperiodic</a>);</div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;    free(mpi-&gt;<a class="code" href="a00197.html#aba3b15034da676474db917f9f5533085">sendbuf</a>);</div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;    free(mpi-&gt;<a class="code" href="a00197.html#afc23e46e08649e112e8d64d780cea5cb">recvbuf</a>);</div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;    free(solver-&gt;<a class="code" href="a00194.html#a57f7bff1d8bf27f2ca5c00270da00d05">VolumeIntegral</a>);</div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;    free(solver-&gt;<a class="code" href="a00194.html#a3aec36aeb5caac1e87f5b4f5f75d5a23">VolumeIntegralInitial</a>);</div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;    free(solver-&gt;<a class="code" href="a00194.html#ac3326fc53477d445133072e3f1fe6b59">StageBoundaryIntegral</a>);</div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;    free(solver-&gt;<a class="code" href="a00194.html#a6dfeed442d18083b68fd0f28d5f63fa7">StepBoundaryIntegral</a>);</div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;    free(solver-&gt;<a class="code" href="a00194.html#a644ed0ed36ed4af1c396c0af6aca043d">TotalBoundaryIntegral</a>);</div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;    free(solver-&gt;<a class="code" href="a00194.html#a965363cd64ce50ae17705dfb285dd0ab">ConservationError</a>);</div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;    free(solver-&gt;<a class="code" href="a00194.html#a39dc7def53a36bdc722aa90f52e04561">stride_with_ghosts</a>);</div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;    free(solver-&gt;<a class="code" href="a00194.html#a98bbff775d127bdd2451b55ce3d06e06">stride_without_ghosts</a>);</div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;  </div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;    <span class="keywordflow">if</span> (solver-&gt;<a class="code" href="a00194.html#a0805db42e429173752189696c3c96909">filename_index</a>) free(solver-&gt;<a class="code" href="a00194.html#a0805db42e429173752189696c3c96909">filename_index</a>);</div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;</div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;  }</div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;</div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;  <span class="keywordflow">return</span>(0);</div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;}</div>
<div class="ttc" id="a00194_html_ae53517ad7a202762d7b79eaf681701f3"><div class="ttname"><a href="a00194.html#ae53517ad7a202762d7b79eaf681701f3">HyPar::par</a></div><div class="ttdeci">double * par</div><div class="ttdef"><b>Definition:</b> <a href="a00224_source.html#l00114">hypar.h:114</a></div></div>
<div class="ttc" id="a00194_html_a9a4a95bad0d4f4769e5e3cd8798a158a"><div class="ttname"><a href="a00194.html#a9a4a95bad0d4f4769e5e3cd8798a158a">HyPar::dim_global_ex</a></div><div class="ttdeci">int * dim_global_ex</div><div class="ttdef"><b>Definition:</b> <a href="a00224_source.html#l00067">hypar.h:67</a></div></div>
<div class="ttc" id="a00194_html_af163100a3e0533dbf1868decd5c8201c"><div class="ttname"><a href="a00194.html#af163100a3e0533dbf1868decd5c8201c">HyPar::Deriv1</a></div><div class="ttdeci">double * Deriv1</div><div class="ttdef"><b>Definition:</b> <a href="a00224_source.html#l00143">hypar.h:143</a></div></div>
<div class="ttc" id="a00189_html_aad9619c099daeb3e6b1b7ef9e03e38d8"><div class="ttname"><a href="a00189.html#aad9619c099daeb3e6b1b7ef9e03e38d8">_GLM_GEE_</a></div><div class="ttdeci">#define _GLM_GEE_</div><div class="ttdef"><b>Definition:</b> <a href="a00189_source.html#l00018">timeintegration_struct.h:18</a></div></div>
<div class="ttc" id="a00194_html_a267ef7e03dbe9dd4440dee2fdf48619a"><div class="ttname"><a href="a00194.html#a267ef7e03dbe9dd4440dee2fdf48619a">HyPar::iblank</a></div><div class="ttdeci">double * iblank</div><div class="ttdef"><b>Definition:</b> <a href="a00224_source.html#l00412">hypar.h:412</a></div></div>
<div class="ttc" id="a00191_html_aaeb0de68ad20c63864e1a6cdf819e836"><div class="ttname"><a href="a00191.html#aaeb0de68ad20c63864e1a6cdf819e836">_FP_POWER_SYSTEM_</a></div><div class="ttdeci">#define _FP_POWER_SYSTEM_</div><div class="ttdef"><b>Definition:</b> <a href="a00191_source.html#l00044">fppowersystem.h:44</a></div></div>
<div class="ttc" id="a00181_html_a783bf18458c856297374e733c1d503ff"><div class="ttname"><a href="a00181.html#a783bf18458c856297374e733c1d503ff">IBCleanup</a></div><div class="ttdeci">int IBCleanup(void *)</div><div class="ttdef"><b>Definition:</b> <a href="a00300_source.html#l00011">IBCleanup.c:11</a></div></div>
<div class="ttc" id="a00208_html_a4afd2c7b3eb8fda452474ebdbe71c8c0"><div class="ttname"><a href="a00208.html#a4afd2c7b3eb8fda452474ebdbe71c8c0">SimulationObject::mpi</a></div><div class="ttdeci">MPIVariables mpi</div><div class="ttdef"><b>Definition:</b> <a href="a00208_source.html#l00025">simulation_object.h:25</a></div></div>
<div class="ttc" id="a00183_html_a6d34f5e8aae80a0d2a27ea20368dfef1"><div class="ttname"><a href="a00183.html#a6d34f5e8aae80a0d2a27ea20368dfef1">_FIFTH_ORDER_HCWENO_</a></div><div class="ttdeci">#define _FIFTH_ORDER_HCWENO_</div><div class="ttdef"><b>Definition:</b> <a href="a00183_source.html#l00030">interpolation.h:30</a></div></div>
<div class="ttc" id="a00194_html_aa24a4f5e29bd70cbe5a2413be1ea9682"><div class="ttname"><a href="a00194.html#aa24a4f5e29bd70cbe5a2413be1ea9682">HyPar::dxinv</a></div><div class="ttdeci">double * dxinv</div><div class="ttdef"><b>Definition:</b> <a href="a00224_source.html#l00102">hypar.h:102</a></div></div>
<div class="ttc" id="a00194_html_ad3fe4b266b398f3a7567ac1b241d99a2"><div class="ttname"><a href="a00194.html#ad3fe4b266b398f3a7567ac1b241d99a2">HyPar::model</a></div><div class="ttdeci">char model[_MAX_STRING_SIZE_]</div><div class="ttdef"><b>Definition:</b> <a href="a00224_source.html#l00250">hypar.h:250</a></div></div>
<div class="ttc" id="a00183_html_a175a82b8ae2b24c0ba51e1b1dd68c0e5"><div class="ttname"><a href="a00183.html#a175a82b8ae2b24c0ba51e1b1dd68c0e5">_FIFTH_ORDER_CRWENO_</a></div><div class="ttdeci">#define _FIFTH_ORDER_CRWENO_</div><div class="ttdef"><b>Definition:</b> <a href="a00183_source.html#l00028">interpolation.h:28</a></div></div>
<div class="ttc" id="a00194_html_aac11b2a653ffaeac4b35057431f1b981"><div class="ttname"><a href="a00194.html#aac11b2a653ffaeac4b35057431f1b981">HyPar::u_rom_predicted</a></div><div class="ttdeci">double * u_rom_predicted</div><div class="ttdef"><b>Definition:</b> <a href="a00224_source.html#l00379">hypar.h:379</a></div></div>
<div class="ttc" id="a00197_html_aa3c28612a64b8a97bde66b720e15c700"><div class="ttname"><a href="a00197.html#aa3c28612a64b8a97bde66b720e15c700">MPIVariables::ip</a></div><div class="ttdeci">int * ip</div><div class="ttdef"><b>Definition:</b> <a href="a00197_source.html#l00028">mpivars_struct.h:28</a></div></div>
<div class="ttc" id="a00194_html_a0805db42e429173752189696c3c96909"><div class="ttname"><a href="a00194.html#a0805db42e429173752189696c3c96909">HyPar::filename_index</a></div><div class="ttdeci">char * filename_index</div><div class="ttdef"><b>Definition:</b> <a href="a00224_source.html#l00186">hypar.h:186</a></div></div>
<div class="ttc" id="a00183_html_acfeff1b158131390b7129f4a857b15ff"><div class="ttname"><a href="a00183.html#acfeff1b158131390b7129f4a857b15ff">_FIFTH_ORDER_WENO_</a></div><div class="ttdeci">#define _FIFTH_ORDER_WENO_</div><div class="ttdef"><b>Definition:</b> <a href="a00183_source.html#l00026">interpolation.h:26</a></div></div>
<div class="ttc" id="a00213_html_a83dc099011b8d965235f462a935f4830"><div class="ttname"><a href="a00213.html#a83dc099011b8d965235f462a935f4830">_VLASOV_</a></div><div class="ttdeci">#define _VLASOV_</div><div class="ttdef"><b>Definition:</b> <a href="a00213_source.html#l00033">vlasov.h:33</a></div></div>
<div class="ttc" id="a00218_html_ad6ab74942c9de13cf0b4c12eb0d91780"><div class="ttname"><a href="a00218.html#ad6ab74942c9de13cf0b4c12eb0d91780">IERR</a></div><div class="ttdeci">#define IERR</div><div class="ttdef"><b>Definition:</b> <a href="a00218_source.html#l00012">basic.h:12</a></div></div>
<div class="ttc" id="a00194_html_ade4650485fe35fd3e12fea272fc80209"><div class="ttname"><a href="a00194.html#ade4650485fe35fd3e12fea272fc80209">HyPar::rhs</a></div><div class="ttdeci">double * rhs</div><div class="ttdef"><b>Definition:</b> <a href="a00224_source.html#l00375">hypar.h:375</a></div></div>
<div class="ttc" id="a00194_html_aa989ebb755986852177779cdf7bd8c85"><div class="ttname"><a href="a00194.html#aa989ebb755986852177779cdf7bd8c85">HyPar::dim_global</a></div><div class="ttdeci">int * dim_global</div><div class="ttdef"><b>Definition:</b> <a href="a00224_source.html#l00032">hypar.h:32</a></div></div>
<div class="ttc" id="a00199_html_a6906f847d1d73981dfcfcebdb6cb70d4"><div class="ttname"><a href="a00199.html#a6906f847d1d73981dfcfcebdb6cb70d4">NavierStokes2DCleanup</a></div><div class="ttdeci">int NavierStokes2DCleanup(void *)</div><div class="ttdef"><b>Definition:</b> <a href="a00467_source.html#l00011">NavierStokes2DCleanup.c:11</a></div></div>
<div class="ttc" id="a00194_html_a48e81a1806b5774943fd9a26e9a190f2"><div class="ttname"><a href="a00194.html#a48e81a1806b5774943fd9a26e9a190f2">HyPar::physics</a></div><div class="ttdeci">void * physics</div><div class="ttdef"><b>Definition:</b> <a href="a00224_source.html#l00253">hypar.h:253</a></div></div>
<div class="ttc" id="a00199_html_a04e16b3f2a882826e604b6353d9e5bcb"><div class="ttname"><a href="a00199.html#a04e16b3f2a882826e604b6353d9e5bcb">_NAVIER_STOKES_2D_</a></div><div class="ttdeci">#define _NAVIER_STOKES_2D_</div><div class="ttdef"><b>Definition:</b> <a href="a00199_source.html#l00047">navierstokes2d.h:47</a></div></div>
<div class="ttc" id="a00208_html_a00626"><div class="ttname"><a href="a00208.html#a00626">SimulationObject</a></div><div class="ttdoc">Structure defining a simulation. </div><div class="ttdef"><b>Definition:</b> <a href="a00208_source.html#l00023">simulation_object.h:23</a></div></div>
<div class="ttc" id="a00194_html_a8452297a324a34268a6565583901347d"><div class="ttname"><a href="a00194.html#a8452297a324a34268a6565583901347d">HyPar::uL</a></div><div class="ttdeci">double * uL</div><div class="ttdef"><b>Definition:</b> <a href="a00224_source.html#l00131">hypar.h:131</a></div></div>
<div class="ttc" id="a00194_html_a86221feda74097db9eb6c900ca1e6cbc"><div class="ttname"><a href="a00194.html#a86221feda74097db9eb6c900ca1e6cbc">HyPar::uC</a></div><div class="ttdeci">double * uC</div><div class="ttdef"><b>Definition:</b> <a href="a00224_source.html#l00123">hypar.h:123</a></div></div>
<div class="ttc" id="a00241_html_aebe5d4a29761b0784c3d3e67e325105b"><div class="ttname"><a href="a00241.html#aebe5d4a29761b0784c3d3e67e325105b">_SHALLOW_WATER_2D_</a></div><div class="ttdeci">#define _SHALLOW_WATER_2D_</div><div class="ttdef"><b>Definition:</b> <a href="a00241_source.html#l00043">shallowwater2d.h:43</a></div></div>
<div class="ttc" id="a00238_html_a82b3f90650895890211635171d649355"><div class="ttname"><a href="a00238.html#a82b3f90650895890211635171d649355">_NUMA2D_</a></div><div class="ttdeci">#define _NUMA2D_</div><div class="ttdef"><b>Definition:</b> <a href="a00238_source.html#l00021">numa2d.h:21</a></div></div>
<div class="ttc" id="a00189_html_a50d4bf1e7e4825cc062fca99a770e5ce"><div class="ttname"><a href="a00189.html#a50d4bf1e7e4825cc062fca99a770e5ce">_RK_</a></div><div class="ttdeci">#define _RK_</div><div class="ttdef"><b>Definition:</b> <a href="a00189_source.html#l00016">timeintegration_struct.h:16</a></div></div>
<div class="ttc" id="a00194_html_a983929b7b1511ff3e7800597adef6a91"><div class="ttname"><a href="a00194.html#a983929b7b1511ff3e7800597adef6a91">HyPar::fluxI</a></div><div class="ttdeci">double * fluxI</div><div class="ttdef"><b>Definition:</b> <a href="a00224_source.html#l00128">hypar.h:128</a></div></div>
<div class="ttc" id="a00194_html_a3c811b25c11d2c98bfff02ddeadeb3d9"><div class="ttname"><a href="a00194.html#a3c811b25c11d2c98bfff02ddeadeb3d9">HyPar::uR</a></div><div class="ttdeci">double * uR</div><div class="ttdef"><b>Definition:</b> <a href="a00224_source.html#l00131">hypar.h:131</a></div></div>
<div class="ttc" id="a00218_html_a68f50121fb9a7daeaf60e50cdef82ef3"><div class="ttname"><a href="a00218.html#a68f50121fb9a7daeaf60e50cdef82ef3">_DECLARE_IERR_</a></div><div class="ttdeci">#define _DECLARE_IERR_</div><div class="ttdef"><b>Definition:</b> <a href="a00218_source.html#l00013">basic.h:13</a></div></div>
<div class="ttc" id="a00194_html_a3ccc9ddb96600c40dcc41bb1ded11160"><div class="ttname"><a href="a00194.html#a3ccc9ddb96600c40dcc41bb1ded11160">HyPar::uref</a></div><div class="ttdeci">double * uref</div><div class="ttdef"><b>Definition:</b> <a href="a00224_source.html#l00373">hypar.h:373</a></div></div>
<div class="ttc" id="a00200_html_a5467b4e62f223583e901763082eb0d57"><div class="ttname"><a href="a00200.html#a5467b4e62f223583e901763082eb0d57">NavierStokes3DCleanup</a></div><div class="ttdeci">int NavierStokes3DCleanup(void *)</div><div class="ttdef"><b>Definition:</b> <a href="a00480_source.html#l00011">NavierStokes3DCleanup.c:11</a></div></div>
<div class="ttc" id="a00194_html_a8419c1760256467c117ef5932b943259"><div class="ttname"><a href="a00194.html#a8419c1760256467c117ef5932b943259">HyPar::ib</a></div><div class="ttdeci">void * ib</div><div class="ttdef"><b>Definition:</b> <a href="a00224_source.html#l00419">hypar.h:419</a></div></div>
<div class="ttc" id="a00194_html_a95e9e0f8a692321b83a2e0ce2789c485"><div class="ttname"><a href="a00194.html#a95e9e0f8a692321b83a2e0ce2789c485">HyPar::index</a></div><div class="ttdeci">int * index</div><div class="ttdef"><b>Definition:</b> <a href="a00224_source.html#l00094">hypar.h:94</a></div></div>
<div class="ttc" id="a00197_html_aba3b15034da676474db917f9f5533085"><div class="ttname"><a href="a00197.html#aba3b15034da676474db917f9f5533085">MPIVariables::sendbuf</a></div><div class="ttdeci">double * sendbuf</div><div class="ttdef"><b>Definition:</b> <a href="a00197_source.html#l00051">mpivars_struct.h:51</a></div></div>
<div class="ttc" id="a00194_html_aeadfdde0fbc3058bace813055212dcc3"><div class="ttname"><a href="a00194.html#aeadfdde0fbc3058bace813055212dcc3">HyPar::hyp</a></div><div class="ttdeci">double * hyp</div><div class="ttdef"><b>Definition:</b> <a href="a00224_source.html#l00111">hypar.h:111</a></div></div>
<div class="ttc" id="a00196_html_a44c745170d88218420752d150856b01c"><div class="ttname"><a href="a00196.html#a44c745170d88218420752d150856b01c">_LINEAR_ADVECTION_DIFFUSION_REACTION_</a></div><div class="ttdeci">#define _LINEAR_ADVECTION_DIFFUSION_REACTION_</div><div class="ttdef"><b>Definition:</b> <a href="a00196_source.html#l00021">linearadr.h:21</a></div></div>
<div class="ttc" id="a00239_html_a8bccae14dde8eaba7663344939367e96"><div class="ttname"><a href="a00239.html#a8bccae14dde8eaba7663344939367e96">_NUMA3D_</a></div><div class="ttdeci">#define _NUMA3D_</div><div class="ttdef"><b>Definition:</b> <a href="a00239_source.html#l00026">numa3d.h:26</a></div></div>
<div class="ttc" id="a00250_html_a9da14408e0e1ce563553ac6638c48456"><div class="ttname"><a href="a00250.html#a9da14408e0e1ce563553ac6638c48456">TimeExplicitRKCleanup</a></div><div class="ttdeci">int TimeExplicitRKCleanup(void *)</div><div class="ttdef"><b>Definition:</b> <a href="a00584_source.html#l00012">TimeExplicitRKCleanup.c:12</a></div></div>
<div class="ttc" id="a00234_html_af59eb9eb78e6e99df5630429e5383617"><div class="ttname"><a href="a00234.html#af59eb9eb78e6e99df5630429e5383617">MPIFreeCommunicators</a></div><div class="ttdeci">int MPIFreeCommunicators(int, void *)</div><div class="ttdef"><b>Definition:</b> <a href="a00357_source.html#l00075">MPICommunicators.c:75</a></div></div>
<div class="ttc" id="a00194_html_ac3326fc53477d445133072e3f1fe6b59"><div class="ttname"><a href="a00194.html#ac3326fc53477d445133072e3f1fe6b59">HyPar::StageBoundaryIntegral</a></div><div class="ttdeci">double * StageBoundaryIntegral</div><div class="ttdef"><b>Definition:</b> <a href="a00224_source.html#l00358">hypar.h:358</a></div></div>
<div class="ttc" id="a00194_html_a6dfeed442d18083b68fd0f28d5f63fa7"><div class="ttname"><a href="a00194.html#a6dfeed442d18083b68fd0f28d5f63fa7">HyPar::StepBoundaryIntegral</a></div><div class="ttdeci">double * StepBoundaryIntegral</div><div class="ttdef"><b>Definition:</b> <a href="a00224_source.html#l00360">hypar.h:360</a></div></div>
<div class="ttc" id="a00194_html_a3b6b999a764f1e2ea94bb5f28c7a558c"><div class="ttname"><a href="a00194.html#a3b6b999a764f1e2ea94bb5f28c7a558c">HyPar::u</a></div><div class="ttdeci">double * u</div><div class="ttdef"><b>Definition:</b> <a href="a00224_source.html#l00108">hypar.h:108</a></div></div>
<div class="ttc" id="a00194_html_aee7ff3b51db01ee6ed4038ff5311ed24"><div class="ttname"><a href="a00194.html#aee7ff3b51db01ee6ed4038ff5311ed24">HyPar::fluxC</a></div><div class="ttdeci">double * fluxC</div><div class="ttdef"><b>Definition:</b> <a href="a00224_source.html#l00120">hypar.h:120</a></div></div>
<div class="ttc" id="a00237_html_a076991b7fbc2b9c6330f792bbba182c2"><div class="ttname"><a href="a00237.html#a076991b7fbc2b9c6330f792bbba182c2">_EULER_1D_</a></div><div class="ttdeci">#define _EULER_1D_</div><div class="ttdef"><b>Definition:</b> <a href="a00237_source.html#l00050">euler1d.h:50</a></div></div>
<div class="ttc" id="a00194_html_a3f9a55664d1c8f058828ae9f4de11906"><div class="ttname"><a href="a00194.html#a3f9a55664d1c8f058828ae9f4de11906">HyPar::nBoundaryZones</a></div><div class="ttdeci">int nBoundaryZones</div><div class="ttdef"><b>Definition:</b> <a href="a00224_source.html#l00149">hypar.h:149</a></div></div>
<div class="ttc" id="a00238_html_a064e0d5fee20148d9337dadf871edda3"><div class="ttname"><a href="a00238.html#a064e0d5fee20148d9337dadf871edda3">Numa2DCleanup</a></div><div class="ttdeci">int Numa2DCleanup(void *)</div><div class="ttdef"><b>Definition:</b> <a href="a00495_source.html#l00005">Numa2DCleanup.c:5</a></div></div>
<div class="ttc" id="a00194_html_adec095311615891040de11341c01a77f"><div class="ttname"><a href="a00194.html#adec095311615891040de11341c01a77f">HyPar::msti</a></div><div class="ttdeci">void * msti</div><div class="ttdef"><b>Definition:</b> <a href="a00224_source.html#l00342">hypar.h:342</a></div></div>
<div class="ttc" id="a00192_html_aa1df50611026cfcfb6c36f53a7620fef"><div class="ttname"><a href="a00192.html#aa1df50611026cfcfb6c36f53a7620fef">FPPowerSystem1BusCleanup</a></div><div class="ttdeci">int FPPowerSystem1BusCleanup(void *)</div><div class="ttdef"><b>Definition:</b> <a href="a00439_source.html#l00004">FPPowerSystem1BusCleanup.c:4</a></div></div>
<div class="ttc" id="a00194_html_a1dbfa1e479a373073b6ebf72401a7f0f"><div class="ttname"><a href="a00194.html#a1dbfa1e479a373073b6ebf72401a7f0f">HyPar::lusolver</a></div><div class="ttdeci">void * lusolver</div><div class="ttdef"><b>Definition:</b> <a href="a00224_source.html#l00344">hypar.h:344</a></div></div>
<div class="ttc" id="a00239_html_a4f6671875e6da5b2480003e749cc35f0"><div class="ttname"><a href="a00239.html#a4f6671875e6da5b2480003e749cc35f0">Numa3DCleanup</a></div><div class="ttdeci">int Numa3DCleanup(void *)</div><div class="ttdef"><b>Definition:</b> <a href="a00503_source.html#l00005">Numa3DCleanup.c:5</a></div></div>
<div class="ttc" id="a00240_html_ab1bdb73df74d06f2e2aeb940b87fcdcf"><div class="ttname"><a href="a00240.html#ab1bdb73df74d06f2e2aeb940b87fcdcf">ShallowWater1DCleanup</a></div><div class="ttdeci">int ShallowWater1DCleanup(void *)</div><div class="ttdef"><b>Definition:</b> <a href="a00510_source.html#l00010">ShallowWater1DCleanup.c:10</a></div></div>
<div class="ttc" id="a00194_html_a40e3f67b1530d5ea4e913fc60b594802"><div class="ttname"><a href="a00194.html#a40e3f67b1530d5ea4e913fc60b594802">HyPar::isPeriodic</a></div><div class="ttdeci">int * isPeriodic</div><div class="ttdef"><b>Definition:</b> <a href="a00224_source.html#l00154">hypar.h:154</a></div></div>
<div class="ttc" id="a00194_html_acab4b9b417d6c3745ad789099d3731c6"><div class="ttname"><a href="a00194.html#acab4b9b417d6c3745ad789099d3731c6">HyPar::u0</a></div><div class="ttdeci">double * u0</div><div class="ttdef"><b>Definition:</b> <a href="a00224_source.html#l00372">hypar.h:372</a></div></div>
<div class="ttc" id="a00194_html_a57f7bff1d8bf27f2ca5c00270da00d05"><div class="ttname"><a href="a00194.html#a57f7bff1d8bf27f2ca5c00270da00d05">HyPar::VolumeIntegral</a></div><div class="ttdeci">double * VolumeIntegral</div><div class="ttdef"><b>Definition:</b> <a href="a00224_source.html#l00354">hypar.h:354</a></div></div>
<div class="ttc" id="a00193_html_a5c8fe736dacda1a087bf1fb514761d6e"><div class="ttname"><a href="a00193.html#a5c8fe736dacda1a087bf1fb514761d6e">_FP_POWER_SYSTEM_3BUS_</a></div><div class="ttdeci">#define _FP_POWER_SYSTEM_3BUS_</div><div class="ttdef"><b>Definition:</b> <a href="a00193_source.html#l00030">fppowersystem3bus.h:30</a></div></div>
<div class="ttc" id="a00192_html_a104fb063ee608b39fdab8d5e1e752ca3"><div class="ttname"><a href="a00192.html#a104fb063ee608b39fdab8d5e1e752ca3">_FP_POWER_SYSTEM_1BUS_</a></div><div class="ttdeci">#define _FP_POWER_SYSTEM_1BUS_</div><div class="ttdef"><b>Definition:</b> <a href="a00192_source.html#l00068">fppowersystem1bus.h:68</a></div></div>
<div class="ttc" id="a00194_html_a29c46b81ad574e4dfbad5a7211487dcb"><div class="ttname"><a href="a00194.html#a29c46b81ad574e4dfbad5a7211487dcb">HyPar::interp</a></div><div class="ttdeci">void * interp</div><div class="ttdef"><b>Definition:</b> <a href="a00224_source.html#l00338">hypar.h:338</a></div></div>
<div class="ttc" id="a00250_html_a600e683b5282f669c7128044f55b2ec4"><div class="ttname"><a href="a00250.html#a600e683b5282f669c7128044f55b2ec4">TimeGLMGEECleanup</a></div><div class="ttdeci">int TimeGLMGEECleanup(void *)</div><div class="ttdef"><b>Definition:</b> <a href="a00589_source.html#l00014">TimeGLMGEECleanup.c:14</a></div></div>
<div class="ttc" id="a00194_html_a138e751362d14724df8e6ab27c4a5e55"><div class="ttname"><a href="a00194.html#a138e751362d14724df8e6ab27c4a5e55">HyPar::time_scheme</a></div><div class="ttdeci">char time_scheme[_MAX_STRING_SIZE_]</div><div class="ttdef"><b>Definition:</b> <a href="a00224_source.html#l00070">hypar.h:70</a></div></div>
<div class="ttc" id="a00183_html_ae832e2314ee85139cec9df4ea82aafa2"><div class="ttname"><a href="a00183.html#ae832e2314ee85139cec9df4ea82aafa2">_FIFTH_ORDER_COMPACT_UPWIND_</a></div><div class="ttdeci">#define _FIFTH_ORDER_COMPACT_UPWIND_</div><div class="ttdef"><b>Definition:</b> <a href="a00183_source.html#l00024">interpolation.h:24</a></div></div>
<div class="ttc" id="a00218_html_add9cf96ae374934d245a1dc1ab697a42"><div class="ttname"><a href="a00218.html#add9cf96ae374934d245a1dc1ab697a42">CHECKERR</a></div><div class="ttdeci">#define CHECKERR(ierr)</div><div class="ttdef"><b>Definition:</b> <a href="a00218_source.html#l00014">basic.h:14</a></div></div>
<div class="ttc" id="a00197_html_a00622"><div class="ttname"><a href="a00197.html#a00622">MPIVariables</a></div><div class="ttdoc">Structure of MPI-related variables. </div><div class="ttdef"><b>Definition:</b> <a href="a00197_source.html#l00024">mpivars_struct.h:24</a></div></div>
<div class="ttc" id="a00193_html_a4fc9b84262e14bb803d7469cee294b30"><div class="ttname"><a href="a00193.html#a4fc9b84262e14bb803d7469cee294b30">FPPowerSystem3BusCleanup</a></div><div class="ttdeci">int FPPowerSystem3BusCleanup(void *)</div><div class="ttdef"><b>Definition:</b> <a href="a00449_source.html#l00010">FPPowerSystem3BusCleanup.c:10</a></div></div>
<div class="ttc" id="a00191_html_ac613cf54a15aaed79e93bd3b12d81f44"><div class="ttname"><a href="a00191.html#ac613cf54a15aaed79e93bd3b12d81f44">FPPowerSystemCleanup</a></div><div class="ttdeci">int FPPowerSystemCleanup(void *)</div><div class="ttdef"><b>Definition:</b> <a href="a00429_source.html#l00004">FPPowerSystemCleanup.c:4</a></div></div>
<div class="ttc" id="a00194_html_a3aec36aeb5caac1e87f5b4f5f75d5a23"><div class="ttname"><a href="a00194.html#a3aec36aeb5caac1e87f5b4f5f75d5a23">HyPar::VolumeIntegralInitial</a></div><div class="ttdeci">double * VolumeIntegralInitial</div><div class="ttdef"><b>Definition:</b> <a href="a00224_source.html#l00356">hypar.h:356</a></div></div>
<div class="ttc" id="a00208_html_a523947ce4fa7128c4c767163953253b9"><div class="ttname"><a href="a00208.html#a523947ce4fa7128c4c767163953253b9">SimulationObject::solver</a></div><div class="ttdeci">HyPar solver</div><div class="ttdef"><b>Definition:</b> <a href="a00208_source.html#l00026">simulation_object.h:26</a></div></div>
<div class="ttc" id="a00190_html_ad512be0d21fc4b769fcc735ec3482203"><div class="ttname"><a href="a00190.html#ad512be0d21fc4b769fcc735ec3482203">FPDoubleWellCleanup</a></div><div class="ttdeci">int FPDoubleWellCleanup(void *)</div><div class="ttdef"><b>Definition:</b> <a href="a00420_source.html#l00004">FPDoubleWellCleanup.c:4</a></div></div>
<div class="ttc" id="a00200_html_a34099431ed2606bd884d36cea1d0448e"><div class="ttname"><a href="a00200.html#a34099431ed2606bd884d36cea1d0448e">_NAVIER_STOKES_3D_</a></div><div class="ttdeci">#define _NAVIER_STOKES_3D_</div><div class="ttdef"><b>Definition:</b> <a href="a00200_source.html#l00050">navierstokes3d.h:50</a></div></div>
<div class="ttc" id="a00194_html_ae83b1b0117b6a805ead2e4728945814c"><div class="ttname"><a href="a00194.html#ae83b1b0117b6a805ead2e4728945814c">HyPar::flag_ib</a></div><div class="ttdeci">int flag_ib</div><div class="ttdef"><b>Definition:</b> <a href="a00224_source.html#l00417">hypar.h:417</a></div></div>
<div class="ttc" id="a00196_html_a114e6f1e977ae4220d29e8097e017f19"><div class="ttname"><a href="a00196.html#a114e6f1e977ae4220d29e8097e017f19">LinearADRCleanup</a></div><div class="ttdeci">int LinearADRCleanup(void *)</div><div class="ttdef"><b>Definition:</b> <a href="a00458_source.html#l00010">LinearADRCleanup.c:10</a></div></div>
<div class="ttc" id="a00194_html_a6b4951ffdbd82f3a3848b82352d389d6"><div class="ttname"><a href="a00194.html#a6b4951ffdbd82f3a3848b82352d389d6">HyPar::source</a></div><div class="ttdeci">double * source</div><div class="ttdef"><b>Definition:</b> <a href="a00224_source.html#l00117">hypar.h:117</a></div></div>
<div class="ttc" id="a00194_html_a39dc7def53a36bdc722aa90f52e04561"><div class="ttname"><a href="a00194.html#a39dc7def53a36bdc722aa90f52e04561">HyPar::stride_with_ghosts</a></div><div class="ttdeci">int * stride_with_ghosts</div><div class="ttdef"><b>Definition:</b> <a href="a00224_source.html#l00390">hypar.h:390</a></div></div>
<div class="ttc" id="a00237_html_a8e310ddd9664225aef72a59b99baaaef"><div class="ttname"><a href="a00237.html#a8e310ddd9664225aef72a59b99baaaef">Euler1DCleanup</a></div><div class="ttdeci">int Euler1DCleanup(void *)</div><div class="ttdef"><b>Definition:</b> <a href="a00399_source.html#l00010">Euler1DCleanup.c:10</a></div></div>
<div class="ttc" id="a00197_html_af40a5a3066fdb53a47e4627071abc2bc"><div class="ttname"><a href="a00197.html#af40a5a3066fdb53a47e4627071abc2bc">MPIVariables::bcperiodic</a></div><div class="ttdeci">int * bcperiodic</div><div class="ttdef"><b>Definition:</b> <a href="a00197_source.html#l00031">mpivars_struct.h:31</a></div></div>
<div class="ttc" id="a00197_html_a7602de5ebb1b59ec35217e78a35a531e"><div class="ttname"><a href="a00197.html#a7602de5ebb1b59ec35217e78a35a531e">MPIVariables::ie</a></div><div class="ttdeci">int * ie</div><div class="ttdef"><b>Definition:</b> <a href="a00197_source.html#l00029">mpivars_struct.h:29</a></div></div>
<div class="ttc" id="a00194_html_a711aad4cbe735871dd9e91ab575c878b"><div class="ttname"><a href="a00194.html#a711aad4cbe735871dd9e91ab575c878b">HyPar::x</a></div><div class="ttdeci">double * x</div><div class="ttdef"><b>Definition:</b> <a href="a00224_source.html#l00099">hypar.h:99</a></div></div>
<div class="ttc" id="a00188_html_ae205e355df87a13c8b47c958828bce2f"><div class="ttname"><a href="a00188.html#ae205e355df87a13c8b47c958828bce2f">_EULER_2D_</a></div><div class="ttdeci">#define _EULER_2D_</div><div class="ttdef"><b>Definition:</b> <a href="a00188_source.html#l00025">euler2d.h:25</a></div></div>
<div class="ttc" id="a00194_html_ad587a58397d439c443ae325450a01a13"><div class="ttname"><a href="a00194.html#ad587a58397d439c443ae325450a01a13">HyPar::rhsref</a></div><div class="ttdeci">double * rhsref</div><div class="ttdef"><b>Definition:</b> <a href="a00224_source.html#l00374">hypar.h:374</a></div></div>
<div class="ttc" id="a00194_html_a6b5109ac1048aa203b8969b91e72c3af"><div class="ttname"><a href="a00194.html#a6b5109ac1048aa203b8969b91e72c3af">HyPar::boundary</a></div><div class="ttdeci">void * boundary</div><div class="ttdef"><b>Definition:</b> <a href="a00224_source.html#l00151">hypar.h:151</a></div></div>
<div class="ttc" id="a00240_html_ac280c6ead138670f1f518fad3ea94737"><div class="ttname"><a href="a00240.html#ac280c6ead138670f1f518fad3ea94737">_SHALLOW_WATER_1D_</a></div><div class="ttdeci">#define _SHALLOW_WATER_1D_</div><div class="ttdef"><b>Definition:</b> <a href="a00240_source.html#l00029">shallowwater1d.h:29</a></div></div>
<div class="ttc" id="a00213_html_a86cecceaf67a26041189c560ea5a176c"><div class="ttname"><a href="a00213.html#a86cecceaf67a26041189c560ea5a176c">VlasovCleanup</a></div><div class="ttdeci">int VlasovCleanup(void *)</div><div class="ttdef"><b>Definition:</b> <a href="a00538_source.html#l00010">VlasovCleanup.c:10</a></div></div>
<div class="ttc" id="a00194_html_a56318721d534e74a96b440f8542a0232"><div class="ttname"><a href="a00194.html#a56318721d534e74a96b440f8542a0232">HyPar::compact</a></div><div class="ttdeci">void * compact</div><div class="ttdef"><b>Definition:</b> <a href="a00224_source.html#l00340">hypar.h:340</a></div></div>
<div class="ttc" id="a00194_html_a965363cd64ce50ae17705dfb285dd0ab"><div class="ttname"><a href="a00194.html#a965363cd64ce50ae17705dfb285dd0ab">HyPar::ConservationError</a></div><div class="ttdeci">double * ConservationError</div><div class="ttdef"><b>Definition:</b> <a href="a00224_source.html#l00350">hypar.h:350</a></div></div>
<div class="ttc" id="a00183_html_a37dd034f5e9eb221bd3fd51cc8d1b0f4"><div class="ttname"><a href="a00183.html#a37dd034f5e9eb221bd3fd51cc8d1b0f4">WENOCleanup</a></div><div class="ttdeci">int WENOCleanup(void *)</div><div class="ttdef"><b>Definition:</b> <a href="a00336_source.html#l00014">WENOCleanup.c:14</a></div></div>
<div class="ttc" id="a00197_html_a0be0f30a83bc3f3d9f6ee3a36bbf2716"><div class="ttname"><a href="a00197.html#a0be0f30a83bc3f3d9f6ee3a36bbf2716">MPIVariables::iproc</a></div><div class="ttdeci">int * iproc</div><div class="ttdef"><b>Definition:</b> <a href="a00197_source.html#l00027">mpivars_struct.h:27</a></div></div>
<div class="ttc" id="a00194_html"><div class="ttname"><a href="a00194.html">HyPar</a></div><div class="ttdoc">Structure containing all solver-specific variables and functions. </div><div class="ttdef"><b>Definition:</b> <a href="a00224_source.html#l00023">hypar.h:23</a></div></div>
<div class="ttc" id="a00188_html_ae2bd18386ee9184c66bb7e7b78f1b73b"><div class="ttname"><a href="a00188.html#ae2bd18386ee9184c66bb7e7b78f1b73b">Euler2DCleanup</a></div><div class="ttdeci">int Euler2DCleanup(void *)</div><div class="ttdef"><b>Definition:</b> <a href="a00412_source.html#l00004">Euler2DCleanup.c:4</a></div></div>
<div class="ttc" id="a00194_html_a31bc6f5b337e72aa281a1ea5ad5d6832"><div class="ttname"><a href="a00194.html#a31bc6f5b337e72aa281a1ea5ad5d6832">HyPar::Deriv2</a></div><div class="ttdeci">double * Deriv2</div><div class="ttdef"><b>Definition:</b> <a href="a00224_source.html#l00143">hypar.h:143</a></div></div>
<div class="ttc" id="a00197_html_a481013ba007a99a4237cde5eeb3c9a29"><div class="ttname"><a href="a00197.html#a481013ba007a99a4237cde5eeb3c9a29">MPIVariables::is</a></div><div class="ttdeci">int * is</div><div class="ttdef"><b>Definition:</b> <a href="a00197_source.html#l00029">mpivars_struct.h:29</a></div></div>
<div class="ttc" id="a00194_html_a484873c74138512e41bc50d17b7d955a"><div class="ttname"><a href="a00194.html#a484873c74138512e41bc50d17b7d955a">HyPar::ndims</a></div><div class="ttdeci">int ndims</div><div class="ttdef"><b>Definition:</b> <a href="a00224_source.html#l00026">hypar.h:26</a></div></div>
<div class="ttc" id="a00241_html_a5cfeeae3a3729d15543d8954060a48d4"><div class="ttname"><a href="a00241.html#a5cfeeae3a3729d15543d8954060a48d4">ShallowWater2DCleanup</a></div><div class="ttdeci">int ShallowWater2DCleanup(void *)</div><div class="ttdef"><b>Definition:</b> <a href="a00523_source.html#l00010">ShallowWater2DCleanup.c:10</a></div></div>
<div class="ttc" id="a00190_html_a801cd9499779d35febbce73603aa70a6"><div class="ttname"><a href="a00190.html#a801cd9499779d35febbce73603aa70a6">_FP_DOUBLE_WELL_</a></div><div class="ttdeci">#define _FP_DOUBLE_WELL_</div><div class="ttdef"><b>Definition:</b> <a href="a00190_source.html#l00018">fpdoublewell.h:18</a></div></div>
<div class="ttc" id="a00194_html_abb50b7a404febaf647f7bd89f873b96e"><div class="ttname"><a href="a00194.html#abb50b7a404febaf647f7bd89f873b96e">HyPar::fR</a></div><div class="ttdeci">double * fR</div><div class="ttdef"><b>Definition:</b> <a href="a00224_source.html#l00131">hypar.h:131</a></div></div>
<div class="ttc" id="a00194_html_a644ed0ed36ed4af1c396c0af6aca043d"><div class="ttname"><a href="a00194.html#a644ed0ed36ed4af1c396c0af6aca043d">HyPar::TotalBoundaryIntegral</a></div><div class="ttdeci">double * TotalBoundaryIntegral</div><div class="ttdef"><b>Definition:</b> <a href="a00224_source.html#l00362">hypar.h:362</a></div></div>
<div class="ttc" id="a00194_html_ad29846eeb9c83b329a8d7c1fe69d46b2"><div class="ttname"><a href="a00194.html#ad29846eeb9c83b329a8d7c1fe69d46b2">HyPar::spatial_scheme_hyp</a></div><div class="ttdeci">char spatial_scheme_hyp[_MAX_STRING_SIZE_]</div><div class="ttdef"><b>Definition:</b> <a href="a00224_source.html#l00076">hypar.h:76</a></div></div>
<div class="ttc" id="a00194_html_a38e0371f331cecbe63a77fa03e202afe"><div class="ttname"><a href="a00194.html#a38e0371f331cecbe63a77fa03e202afe">HyPar::dim_local</a></div><div class="ttdeci">int * dim_local</div><div class="ttdef"><b>Definition:</b> <a href="a00224_source.html#l00035">hypar.h:35</a></div></div>
<div class="ttc" id="a00194_html_a99f72a44e29089b75fd11155bfcc1ff8"><div class="ttname"><a href="a00194.html#a99f72a44e29089b75fd11155bfcc1ff8">HyPar::fL</a></div><div class="ttdeci">double * fL</div><div class="ttdef"><b>Definition:</b> <a href="a00224_source.html#l00131">hypar.h:131</a></div></div>
<div class="ttc" id="a00185_html"><div class="ttname"><a href="a00185.html">DomainBoundary</a></div><div class="ttdoc">Structure containing the variables and function pointers defining a boundary. </div><div class="ttdef"><b>Definition:</b> <a href="a00219_source.html#l00068">boundaryconditions.h:68</a></div></div>
<div class="ttc" id="a00197_html_afc23e46e08649e112e8d64d780cea5cb"><div class="ttname"><a href="a00197.html#afc23e46e08649e112e8d64d780cea5cb">MPIVariables::recvbuf</a></div><div class="ttdeci">double * recvbuf</div><div class="ttdef"><b>Definition:</b> <a href="a00197_source.html#l00051">mpivars_struct.h:51</a></div></div>
<div class="ttc" id="a00194_html_a98bbff775d127bdd2451b55ce3d06e06"><div class="ttname"><a href="a00194.html#a98bbff775d127bdd2451b55ce3d06e06">HyPar::stride_without_ghosts</a></div><div class="ttdeci">int * stride_without_ghosts</div><div class="ttdef"><b>Definition:</b> <a href="a00224_source.html#l00392">hypar.h:392</a></div></div>
<div class="ttc" id="a00183_html_acfaa225472f09e2ade88945e909d5893"><div class="ttname"><a href="a00183.html#acfaa225472f09e2ade88945e909d5893">CompactSchemeCleanup</a></div><div class="ttdeci">int CompactSchemeCleanup(void *)</div><div class="ttdef"><b>Definition:</b> <a href="a00312_source.html#l00014">CompactSchemeCleanup.c:14</a></div></div>
<div class="ttc" id="a00194_html_ad195de8c64c407718e42cda9246be0d2"><div class="ttname"><a href="a00194.html#ad195de8c64c407718e42cda9246be0d2">HyPar::use_petscTS</a></div><div class="ttdeci">int use_petscTS</div><div class="ttdef"><b>Definition:</b> <a href="a00224_source.html#l00371">hypar.h:371</a></div></div>
<div class="ttc" id="a00219_html_af38bba62aa7b0f51ee9123ced0c46f24"><div class="ttname"><a href="a00219.html#af38bba62aa7b0f51ee9123ced0c46f24">BCCleanup</a></div><div class="ttdeci">int BCCleanup(void *)</div><div class="ttdef"><b>Definition:</b> <a href="a00258_source.html#l00010">BCCleanup.c:10</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ad7007f198eeb61eb9f73f7ab0df71900"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void SimWriteErrors </td>
          <td>(</td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>s</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>nsims</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>rank</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>solver_runtime</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>main_runtime</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Write errors for each simulation</p>
<p>Writes out the errors and other data for each simulation. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">s</td><td>Array of simulations of type <a class="el" href="a00208.html#a00626" title="Structure defining a simulation. ">SimulationObject</a> </td></tr>
    <tr><td class="paramname">nsims</td><td>Number of simulations </td></tr>
    <tr><td class="paramname">rank</td><td>MPI rank of this process </td></tr>
    <tr><td class="paramname">solver_runtime</td><td>Measured runtime of solver </td></tr>
    <tr><td class="paramname">main_runtime</td><td>Measured total runtime </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="a00562_source.html#l00018">18</a> of file <a class="el" href="a00562_source.html">SimulationWriteErrors.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;{</div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;  <a class="code" href="a00208.html#a00626">SimulationObject</a>* sim = (<a class="code" href="a00208.html#a00626">SimulationObject</a>*) s;</div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;  <span class="keywordtype">int</span> n;</div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;</div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;  <span class="keywordflow">if</span> (!rank) {</div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;</div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;    <span class="keywordflow">if</span> (nsims &gt; 1) printf(<span class="stringliteral">&quot;\n&quot;</span>);</div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;</div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;    <span class="keywordflow">for</span> (n = 0; n &lt; nsims; n++) {</div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;</div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;      <span class="keywordtype">char</span> err_fname[<a class="code" href="a00218.html#a51efea86a4d76d1259893f606b776573">_MAX_STRING_SIZE_</a>],</div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;           cons_fname[<a class="code" href="a00218.html#a51efea86a4d76d1259893f606b776573">_MAX_STRING_SIZE_</a>],</div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;           fc_fname[<a class="code" href="a00218.html#a51efea86a4d76d1259893f606b776573">_MAX_STRING_SIZE_</a>];</div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;      strcpy(err_fname,<span class="stringliteral">&quot;errors&quot;</span>);</div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;      strcpy(cons_fname,<span class="stringliteral">&quot;conservation&quot;</span>);</div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;      strcpy(fc_fname,<span class="stringliteral">&quot;function_counts&quot;</span>);</div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;<span class="preprocessor">#ifdef with_librom</span></div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;<span class="preprocessor"></span>      <span class="keywordtype">char</span> rom_diff_fname[<a class="code" href="a00218.html#a51efea86a4d76d1259893f606b776573">_MAX_STRING_SIZE_</a>]; </div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;      strcpy(rom_diff_fname,<span class="stringliteral">&quot;pde_rom_diff&quot;</span>);</div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;<span class="preprocessor"></span></div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;</div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;      <span class="keywordflow">if</span> (nsims &gt; 1) {</div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;</div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;        strcat(err_fname,<span class="stringliteral">&quot;_&quot;</span>);</div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;        strcat(cons_fname,<span class="stringliteral">&quot;_&quot;</span>);</div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;        strcat(fc_fname,<span class="stringliteral">&quot;_&quot;</span>);</div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;<span class="preprocessor">#ifdef with_librom</span></div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;<span class="preprocessor"></span>        strcat(rom_diff_fname,<span class="stringliteral">&quot;_&quot;</span>);</div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;<span class="preprocessor"></span></div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;        <span class="keywordtype">char</span> index[<a class="code" href="a00218.html#a51efea86a4d76d1259893f606b776573">_MAX_STRING_SIZE_</a>];</div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;        <a class="code" href="a00220.html#a3e3ad5aed581d9ae563190c365dadc41">GetStringFromInteger</a>(n, index, (<span class="keywordtype">int</span>)log10(nsims)+1);</div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;</div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;        strcat(err_fname,index);</div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;        strcat(cons_fname,index);</div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;        strcat(fc_fname,index);</div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;<span class="preprocessor">#ifdef with_librom</span></div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;<span class="preprocessor"></span>        strcat(rom_diff_fname,index);</div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;<span class="preprocessor"></span>      }</div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;</div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;      strcat(err_fname,<span class="stringliteral">&quot;.dat&quot;</span>);</div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;      strcat(cons_fname,<span class="stringliteral">&quot;.dat&quot;</span>);</div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;      strcat(fc_fname,<span class="stringliteral">&quot;.dat&quot;</span>);</div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;<span class="preprocessor">#ifdef with_librom</span></div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;<span class="preprocessor"></span>      strcat(rom_diff_fname,<span class="stringliteral">&quot;.dat&quot;</span>);</div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;<span class="preprocessor"></span></div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;      FILE *out; </div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;      <span class="comment">/* write out solution errors and wall times to file */</span></div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;      out = fopen(err_fname,<span class="stringliteral">&quot;w&quot;</span>);</div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> d=0; d&lt;sim[n].<a class="code" href="a00208.html#a523947ce4fa7128c4c767163953253b9">solver</a>.<a class="code" href="a00194.html#a484873c74138512e41bc50d17b7d955a">ndims</a>; d++) fprintf(out,<span class="stringliteral">&quot;%4d &quot;</span>,sim[n].solver.dim_global[d]);</div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> d=0; d&lt;sim[n].<a class="code" href="a00208.html#a523947ce4fa7128c4c767163953253b9">solver</a>.<a class="code" href="a00194.html#a484873c74138512e41bc50d17b7d955a">ndims</a>; d++) fprintf(out,<span class="stringliteral">&quot;%4d &quot;</span>,sim[n].mpi.iproc[d]);</div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;      fprintf(out,<span class="stringliteral">&quot;%1.16E  &quot;</span>,sim[n].solver.dt);</div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;      fprintf(out,<span class="stringliteral">&quot;%1.16E %1.16E %1.16E   &quot;</span>,sim[n].solver.error[0],sim[n].<a class="code" href="a00208.html#a523947ce4fa7128c4c767163953253b9">solver</a>.<a class="code" href="a00194.html#aa40f27cb2afa2db0f0468962be8b3679">error</a>[1],sim[n].<a class="code" href="a00208.html#a523947ce4fa7128c4c767163953253b9">solver</a>.<a class="code" href="a00194.html#aa40f27cb2afa2db0f0468962be8b3679">error</a>[2]);</div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;      fprintf(out,<span class="stringliteral">&quot;%1.16E %1.16E\n&quot;</span>,solver_runtime,main_runtime);</div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;      fclose(out);</div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;      <span class="comment">/* write out conservation errors to file */</span></div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;      out = fopen(cons_fname,<span class="stringliteral">&quot;w&quot;</span>);</div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> d=0; d&lt;sim[n].<a class="code" href="a00208.html#a523947ce4fa7128c4c767163953253b9">solver</a>.<a class="code" href="a00194.html#a484873c74138512e41bc50d17b7d955a">ndims</a>; d++) fprintf(out,<span class="stringliteral">&quot;%4d &quot;</span>,sim[n].solver.dim_global[d]);</div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> d=0; d&lt;sim[n].<a class="code" href="a00208.html#a523947ce4fa7128c4c767163953253b9">solver</a>.<a class="code" href="a00194.html#a484873c74138512e41bc50d17b7d955a">ndims</a>; d++) fprintf(out,<span class="stringliteral">&quot;%4d &quot;</span>,sim[n].mpi.iproc[d]);</div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;      fprintf(out,<span class="stringliteral">&quot;%1.16E  &quot;</span>,sim[n].solver.dt);</div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> d=0; d&lt;sim[n].<a class="code" href="a00208.html#a523947ce4fa7128c4c767163953253b9">solver</a>.<a class="code" href="a00194.html#ae8f6d2fd6490d3153cb4133bf183a404">nvars</a>; d++) fprintf(out,<span class="stringliteral">&quot;%1.16E &quot;</span>,sim[n].solver.ConservationError[d]);</div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;      fprintf(out,<span class="stringliteral">&quot;\n&quot;</span>);</div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;      fclose(out);</div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;      <span class="comment">/* write out function call counts to file */</span></div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;      out = fopen(fc_fname,<span class="stringliteral">&quot;w&quot;</span>);</div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;      fprintf(out,<span class="stringliteral">&quot;%d\n&quot;</span>,sim[n].solver.n_iter);</div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;      fprintf(out,<span class="stringliteral">&quot;%d\n&quot;</span>,sim[n].solver.count_hyp);</div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;      fprintf(out,<span class="stringliteral">&quot;%d\n&quot;</span>,sim[n].solver.count_par);</div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;      fprintf(out,<span class="stringliteral">&quot;%d\n&quot;</span>,sim[n].solver.count_sou);</div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;<span class="preprocessor">#ifdef with_petsc</span></div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;<span class="preprocessor"></span>      fprintf(out,<span class="stringliteral">&quot;%d\n&quot;</span>,sim[n].solver.count_RHSFunction);</div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;      fprintf(out,<span class="stringliteral">&quot;%d\n&quot;</span>,sim[n].solver.count_IFunction);</div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;      fprintf(out,<span class="stringliteral">&quot;%d\n&quot;</span>,sim[n].solver.count_IJacobian);</div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;      fprintf(out,<span class="stringliteral">&quot;%d\n&quot;</span>,sim[n].solver.count_IJacFunction);</div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;<span class="preprocessor"></span>      fclose(out);</div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;<span class="preprocessor">#ifdef with_librom</span></div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;<span class="preprocessor"></span>      <span class="comment">/* write out solution errors and wall times to file */</span></div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;      <span class="keywordflow">if</span> (sim[n].solver.rom_diff_norms[0] &gt;= 0) {</div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;        out = fopen(rom_diff_fname,<span class="stringliteral">&quot;w&quot;</span>);</div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> d=0; d&lt;sim[n].<a class="code" href="a00208.html#a523947ce4fa7128c4c767163953253b9">solver</a>.<a class="code" href="a00194.html#a484873c74138512e41bc50d17b7d955a">ndims</a>; d++) fprintf(out,<span class="stringliteral">&quot;%4d &quot;</span>,sim[n].solver.dim_global[d]);</div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> d=0; d&lt;sim[n].<a class="code" href="a00208.html#a523947ce4fa7128c4c767163953253b9">solver</a>.<a class="code" href="a00194.html#a484873c74138512e41bc50d17b7d955a">ndims</a>; d++) fprintf(out,<span class="stringliteral">&quot;%4d &quot;</span>,sim[n].mpi.iproc[d]);</div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;        fprintf(out,<span class="stringliteral">&quot;%1.16E  &quot;</span>,sim[n].solver.dt);</div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;        fprintf(out,<span class="stringliteral">&quot;%1.16E %1.16E %1.16E   &quot;</span>,sim[n].solver.rom_diff_norms[0],sim[n].<a class="code" href="a00208.html#a523947ce4fa7128c4c767163953253b9">solver</a>.<a class="code" href="a00194.html#aaacee284a041d53cf335ae299d5eb929">rom_diff_norms</a>[1],sim[n].<a class="code" href="a00208.html#a523947ce4fa7128c4c767163953253b9">solver</a>.<a class="code" href="a00194.html#aaacee284a041d53cf335ae299d5eb929">rom_diff_norms</a>[2]);</div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;        fprintf(out,<span class="stringliteral">&quot;%1.16E %1.16E\n&quot;</span>,solver_runtime,main_runtime);</div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;        fclose(out);</div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;      }</div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;<span class="preprocessor"></span></div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;      <span class="comment">/* print solution errors, conservation errors, and wall times to screen */</span></div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;      <span class="keywordflow">if</span> (sim[n].solver.error[0] &gt;= 0) {</div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;        printf(<span class="stringliteral">&quot;Computed errors for domain %d:\n&quot;</span>, n);</div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;        printf(<span class="stringliteral">&quot;  L1         Error           : %1.16E\n&quot;</span>,sim[n].solver.error[0]);</div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;        printf(<span class="stringliteral">&quot;  L2         Error           : %1.16E\n&quot;</span>,sim[n].solver.error[1]);</div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;        printf(<span class="stringliteral">&quot;  Linfinity  Error           : %1.16E\n&quot;</span>,sim[n].solver.error[2]);</div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;      }</div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;      <span class="keywordflow">if</span> (!strcmp(sim[n].solver.ConservationCheck,<span class="stringliteral">&quot;yes&quot;</span>)) {</div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;        printf(<span class="stringliteral">&quot;Conservation Errors:\n&quot;</span>);</div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> d=0; d&lt;sim[n].<a class="code" href="a00208.html#a523947ce4fa7128c4c767163953253b9">solver</a>.<a class="code" href="a00194.html#ae8f6d2fd6490d3153cb4133bf183a404">nvars</a>; d++) printf(<span class="stringliteral">&quot;\t%1.16E\n&quot;</span>,sim[n].solver.ConservationError[d]);</div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;      }</div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;<span class="preprocessor">#ifdef with_librom</span></div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;<span class="preprocessor"></span>      <span class="keywordflow">if</span> (sim[n].solver.rom_diff_norms[0] &gt;= 0) {</div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;        printf(<span class="stringliteral">&quot;Norms of the diff between ROM and PDE solutions for domain %d:\n&quot;</span>, n);</div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;        printf(<span class="stringliteral">&quot;  L1         Norm            : %1.16E\n&quot;</span>,sim[n].solver.rom_diff_norms[0]);</div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;        printf(<span class="stringliteral">&quot;  L2         Norm            : %1.16E\n&quot;</span>,sim[n].solver.rom_diff_norms[1]);</div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;        printf(<span class="stringliteral">&quot;  Linfinity  Norm            : %1.16E\n&quot;</span>,sim[n].solver.rom_diff_norms[2]);</div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;      }</div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;<span class="preprocessor"></span></div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;    }</div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;</div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;    printf(<span class="stringliteral">&quot;Solver runtime (in seconds): %1.16E\n&quot;</span>,solver_runtime);</div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;    printf(<span class="stringliteral">&quot;Total  runtime (in seconds): %1.16E\n&quot;</span>,main_runtime);</div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;    <span class="keywordflow">if</span> (nsims &gt; 1) printf(<span class="stringliteral">&quot;\n&quot;</span>);</div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;</div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;  }</div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;</div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;  <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;}</div>
<div class="ttc" id="a00208_html_a00626"><div class="ttname"><a href="a00208.html#a00626">SimulationObject</a></div><div class="ttdoc">Structure defining a simulation. </div><div class="ttdef"><b>Definition:</b> <a href="a00208_source.html#l00023">simulation_object.h:23</a></div></div>
<div class="ttc" id="a00194_html_aaacee284a041d53cf335ae299d5eb929"><div class="ttname"><a href="a00194.html#aaacee284a041d53cf335ae299d5eb929">HyPar::rom_diff_norms</a></div><div class="ttdeci">double rom_diff_norms[3]</div><div class="ttdef"><b>Definition:</b> <a href="a00224_source.html#l00381">hypar.h:381</a></div></div>
<div class="ttc" id="a00194_html_aa40f27cb2afa2db0f0468962be8b3679"><div class="ttname"><a href="a00194.html#aa40f27cb2afa2db0f0468962be8b3679">HyPar::error</a></div><div class="ttdeci">double error[3]</div><div class="ttdef"><b>Definition:</b> <a href="a00224_source.html#l00347">hypar.h:347</a></div></div>
<div class="ttc" id="a00220_html_a3e3ad5aed581d9ae563190c365dadc41"><div class="ttname"><a href="a00220.html#a3e3ad5aed581d9ae563190c365dadc41">GetStringFromInteger</a></div><div class="ttdeci">void GetStringFromInteger(int, char *, int)</div><div class="ttdef"><b>Definition:</b> <a href="a00278_source.html#l00015">CommonFunctions.c:15</a></div></div>
<div class="ttc" id="a00208_html_a523947ce4fa7128c4c767163953253b9"><div class="ttname"><a href="a00208.html#a523947ce4fa7128c4c767163953253b9">SimulationObject::solver</a></div><div class="ttdeci">HyPar solver</div><div class="ttdef"><b>Definition:</b> <a href="a00208_source.html#l00026">simulation_object.h:26</a></div></div>
<div class="ttc" id="a00194_html_ae8f6d2fd6490d3153cb4133bf183a404"><div class="ttname"><a href="a00194.html#ae8f6d2fd6490d3153cb4133bf183a404">HyPar::nvars</a></div><div class="ttdeci">int nvars</div><div class="ttdef"><b>Definition:</b> <a href="a00224_source.html#l00029">hypar.h:29</a></div></div>
<div class="ttc" id="a00194_html_a484873c74138512e41bc50d17b7d955a"><div class="ttname"><a href="a00194.html#a484873c74138512e41bc50d17b7d955a">HyPar::ndims</a></div><div class="ttdeci">int ndims</div><div class="ttdef"><b>Definition:</b> <a href="a00224_source.html#l00026">hypar.h:26</a></div></div>
<div class="ttc" id="a00218_html_a51efea86a4d76d1259893f606b776573"><div class="ttname"><a href="a00218.html#a51efea86a4d76d1259893f606b776573">_MAX_STRING_SIZE_</a></div><div class="ttdeci">#define _MAX_STRING_SIZE_</div><div class="ttdef"><b>Definition:</b> <a href="a00218_source.html#l00010">basic.h:10</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a1a054e1b92ee41a9e38926d18c6628bf"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int SolvePETSc </td>
          <td>(</td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>s</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>nsims</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>rank</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>nproc</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Integrate in time with PETSc. </p>
<p>Solve the PDE using PETSc TS</p>
<p>This function integrates the semi-discrete ODE (obtained from discretizing the PDE in space) using the time-integration module of PETSc (<a href="https://petsc.org/release/docs/manualpages/TS/index.html">https://petsc.org/release/docs/manualpages/TS/index.html</a>). The time-integration context is set up using the parameters specified in the input file. However, they can also be specified using PETSc's command line inputs.<br/>
<br/>
See PETSc's documentation and examples for more details on how to use its TS module. All functions and data types whose names start with Vec, Mat, PC, KSP, SNES, and TS are PETSc functions - refer to the PETSc documentation (usually googling with the function name shows the man page for that function on PETSc's website). </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">s</td><td>Array of simulation objects of type <a class="el" href="a00208.html#a00626" title="Structure defining a simulation. ">SimulationObject</a> </td></tr>
    <tr><td class="paramname">nsims</td><td>number of simulation objects </td></tr>
    <tr><td class="paramname">rank</td><td>MPI rank of this process </td></tr>
    <tr><td class="paramname">nproc</td><td>Number of MPI processes </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="a00565_source.html#l00050">50</a> of file <a class="el" href="a00565_source.html">SolvePETSc.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;{</div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;  <a class="code" href="a00208.html#a00626">SimulationObject</a>* sim = (<a class="code" href="a00208.html#a00626">SimulationObject</a>*) s;</div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;</div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;  TS              ts;     <span class="comment">/* time integration object               */</span></div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;  Vec             Y,Z;    <span class="comment">/* PETSc solution vectors                */</span></div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;  Mat             A, B;   <span class="comment">/* Jacobian and preconditioning matrices */</span></div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;  TSType          time_scheme;  <span class="comment">/* time integration method         */</span></div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;  TSProblemType   ptype;  <span class="comment">/* problem type - nonlinear or linear    */</span></div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;  <span class="keywordtype">int</span>             flag_mat_a = 0, flag_mat_b = 0, iAuxSize = 0, i;</div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;</div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;  PetscFunctionBegin;</div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;</div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;  <span class="comment">/* Register custom time-integration methods, if specified */</span></div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;  <a class="code" href="a00236.html#a005fac516715e5fb65baa1540a79c82c">PetscRegisterTIMethods</a>(rank);</div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;  <span class="keywordflow">if</span>(!rank) printf(<span class="stringliteral">&quot;Setting up PETSc time integration... \n&quot;</span>);</div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;</div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;  <span class="comment">/* create and set a PETSc context */</span></div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;  <a class="code" href="a00203.html#a00625">PETScContext</a> context;</div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;</div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;  context.<a class="code" href="a00203.html#a6cfd95afd0afebd625b889fb6e58371c">rank</a> = rank;</div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;  context.<a class="code" href="a00203.html#ae68326adc3b3862f1162832f70727b06">nproc</a> = nproc;</div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;</div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;  context.<a class="code" href="a00203.html#a4e2f35037563217c8dc84c095af9e35f">simobj</a> = sim;</div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;  context.<a class="code" href="a00203.html#a9a0e87291e0e8b9c1445e5482e814c92">nsims</a> = nsims;</div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;</div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;  <span class="comment">/* default: everything explicit */</span></div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;  context.<a class="code" href="a00203.html#a376b6b34e162357d201827d01a5aa2a4">flag_hyperbolic</a>     = <a class="code" href="a00203.html#a377d0d14ec878aeb4deed4a0533e213d">_EXPLICIT_</a>; </div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;  context.<a class="code" href="a00203.html#a6a0edd627a2b2cc687d1031e3884dd6a">flag_hyperbolic_f</a>   = <a class="code" href="a00203.html#a377d0d14ec878aeb4deed4a0533e213d">_EXPLICIT_</a>; </div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;  context.<a class="code" href="a00203.html#a21b4785029b7597816341479bc3260b4">flag_hyperbolic_df</a>  = <a class="code" href="a00203.html#a377d0d14ec878aeb4deed4a0533e213d">_EXPLICIT_</a>; </div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;  context.<a class="code" href="a00203.html#ac48ad2561e5e125d2789133e848db1d9">flag_parabolic</a>      = <a class="code" href="a00203.html#a377d0d14ec878aeb4deed4a0533e213d">_EXPLICIT_</a>; </div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;  context.<a class="code" href="a00203.html#a54c0451c4ae9650a54f54246f1f8823b">flag_source</a>         = <a class="code" href="a00203.html#a377d0d14ec878aeb4deed4a0533e213d">_EXPLICIT_</a>; </div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;</div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;  context.<a class="code" href="a00203.html#a34cbd56d5136d5e8b5ea2cbb901c04cd">tic</a> = 0;</div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;  context.<a class="code" href="a00203.html#a200f63fcca813d56a5cf3209546cedb2">flag_is_linear</a> = 0;</div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;  context.<a class="code" href="a00203.html#a15d26af821c0659b0c602303c371405e">globalDOF</a>.clear();</div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;  context.<a class="code" href="a00203.html#a3968caf0290e18143989738dd36f2623">points</a>.clear();</div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;  context.<a class="code" href="a00203.html#afdccc5dc654297cee401e0938ffb7985">ti_runtime</a> = 0.0;</div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;  context.<a class="code" href="a00203.html#a28e4e78c0bf258662bef21d26c51fc0b">waqt</a> = 0.0;</div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;  context.<a class="code" href="a00203.html#a03e28be41881b703c836edbfe9b51b17">dt</a> = sim[0].<a class="code" href="a00208.html#a523947ce4fa7128c4c767163953253b9">solver</a>.<a class="code" href="a00194.html#a03e28be41881b703c836edbfe9b51b17">dt</a>;</div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;  context.<a class="code" href="a00203.html#a22ceb3bed48bc42e41131982f61a839f">stage_times</a>.clear();</div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;  context.<a class="code" href="a00203.html#ad55778d618804ddb359e18c9312c1454">stage_index</a> = 0;</div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;</div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;<span class="preprocessor">#ifdef with_librom</span></div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;<span class="preprocessor"></span>  <span class="keywordflow">if</span> (!rank) printf(<span class="stringliteral">&quot;Setting up libROM interface.\n&quot;</span>);</div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;  context.<a class="code" href="a00203.html#af8049501def09c2e14fbec0a72c8c66c">rom_interface</a> = <span class="keyword">new</span> <a class="code" href="a00195.html">libROMInterface</a>( sim, </div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;                                               nsims, </div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;                                               rank, </div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;                                               nproc, </div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;                                               sim[0].solver.dt );</div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;  context.<a class="code" href="a00203.html#ae1766c1c76f0ef119388c4fa8a6d64f4">rom_mode</a> = ((<a class="code" href="a00195.html">libROMInterface</a>*)context.<a class="code" href="a00203.html#af8049501def09c2e14fbec0a72c8c66c">rom_interface</a>)-&gt;mode();</div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;  context.<a class="code" href="a00203.html#aac65a15cdd8e87c5c788db46e1ca0347">op_times_arr</a>.clear();</div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;<span class="preprocessor"></span></div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;<span class="preprocessor">#ifdef with_librom</span></div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;<span class="preprocessor"></span>  <span class="keywordflow">if</span> (      (context.<a class="code" href="a00203.html#ae1766c1c76f0ef119388c4fa8a6d64f4">rom_mode</a> == <a class="code" href="a00227.html#a8d7f058ce028038a98a49ad28176390e">_ROM_MODE_TRAIN_</a>) </div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;        ||  (context.<a class="code" href="a00203.html#ae1766c1c76f0ef119388c4fa8a6d64f4">rom_mode</a> == <a class="code" href="a00227.html#acc2b61eb7c1bad16328d8f4be63b70f3">_ROM_MODE_INITIAL_GUESS_</a> )</div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;        ||  (context.<a class="code" href="a00203.html#ae1766c1c76f0ef119388c4fa8a6d64f4">rom_mode</a> == <a class="code" href="a00227.html#a28e9ddc4d69c4a09fda0f0f39726ba16">_ROM_MODE_NONE_</a> ) ) {</div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;</div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;    <span class="keywordflow">if</span> (context.<a class="code" href="a00203.html#ae1766c1c76f0ef119388c4fa8a6d64f4">rom_mode</a> == <a class="code" href="a00227.html#acc2b61eb7c1bad16328d8f4be63b70f3">_ROM_MODE_INITIAL_GUESS_</a>) {</div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;      ((<a class="code" href="a00195.html">libROMInterface</a>*)context.<a class="code" href="a00203.html#af8049501def09c2e14fbec0a72c8c66c">rom_interface</a>)-&gt;loadROM();</div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;      ((<a class="code" href="a00195.html">libROMInterface</a>*)context.<a class="code" href="a00203.html#af8049501def09c2e14fbec0a72c8c66c">rom_interface</a>)-&gt;projectInitialSolution(sim);</div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;    }</div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;<span class="preprocessor"></span>    <a class="code" href="a00236.html#ae4a99505d5f322bfc1c590e3d31fcc0b">PetscCreatePointList</a>(&amp;context);</div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;  </div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;    <span class="comment">/* create and initialize PETSc solution vector and other parameters */</span></div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;    <span class="comment">/* PETSc solution vector does not have ghost points */</span></div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;    VecCreate(MPI_COMM_WORLD,&amp;Y);</div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;    VecSetSizes(Y,context.<a class="code" href="a00203.html#a578ef595dcbe28b2bde5c152c50f85e7">ndofs</a>,PETSC_DECIDE);</div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;    VecSetUp(Y);</div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;  </div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;    <span class="comment">/* copy initial solution to PETSc&#39;s vector */</span></div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ns = 0; ns &lt; nsims; ns++) {</div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;      <a class="code" href="a00236.html#a6c64bea980c3a8b0a752113bbeb40cf3">TransferVecToPETSc</a>( sim[ns].solver.u,</div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;                          Y,</div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;                          &amp;context,</div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;                          ns,</div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;                          context.<a class="code" href="a00203.html#ad2182a08b22eed3bb3b0728725841875">offsets</a>[ns] );</div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;    }</div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;  </div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;    <span class="comment">/* Create the global DOF mapping for all the grid points */</span></div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;    <a class="code" href="a00236.html#ae4815491f5992839fdb3949e5dedec8e">PetscGlobalDOF</a>(&amp;context);</div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;  </div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;    <span class="comment">/* Define and initialize the time-integration object */</span></div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;    TSCreate(MPI_COMM_WORLD,&amp;ts);</div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;    TSSetMaxSteps(ts,sim[0].solver.n_iter);</div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;    TSSetMaxTime(ts,sim[0].solver.dt*sim[0].<a class="code" href="a00208.html#a523947ce4fa7128c4c767163953253b9">solver</a>.<a class="code" href="a00194.html#af0d8e0d5d3de3869b941b66b6caaf964">n_iter</a>);</div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;    TSSetTimeStep(ts,sim[0].solver.dt);</div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;    TSSetTime(ts,context.<a class="code" href="a00203.html#a28e4e78c0bf258662bef21d26c51fc0b">waqt</a>);</div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;    TSSetExactFinalTime(ts,TS_EXACTFINALTIME_MATCHSTEP);</div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;    TSSetType(ts,TSBEULER);</div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;  </div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;    <span class="comment">/* set default time step adaptivity to none */</span></div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;    TSAdapt adapt;</div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;    TSAdaptType adapt_type = TSADAPTNONE;</div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;    TSGetAdapt(ts,&amp;adapt);</div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;    TSAdaptSetType(adapt,adapt_type);</div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;  </div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;    <span class="comment">/* set options from input */</span></div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;    TSSetFromOptions(ts);</div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;  </div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;<span class="preprocessor">#ifdef with_librom</span></div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;<span class="preprocessor"></span>    TSAdaptGetType(adapt,&amp;adapt_type);</div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;    <span class="keywordflow">if</span> (strcmp(adapt_type, TSADAPTNONE)) {</div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;      <span class="keywordflow">if</span> (!rank) printf(<span class="stringliteral">&quot;Warning: libROM interface not yet implemented for adaptive timestepping.\n&quot;</span>);</div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;    }</div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;<span class="preprocessor"></span>  </div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;    <span class="comment">/* Define the right and left -hand side functions for each time-integration scheme */</span></div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;    TSGetType(ts,&amp;time_scheme);</div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;    TSGetProblemType(ts,&amp;ptype);</div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;    <span class="keywordflow">if</span> (!strcmp(time_scheme,TSARKIMEX)) {</div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;  </div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;      <span class="comment">/* implicit - explicit time integration */</span></div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;  </div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;      TSSetRHSFunction(ts,PETSC_NULL,<a class="code" href="a00236.html#ac7d9b0a219eb22bfd37482b741bd79c9">PetscRHSFunctionIMEX</a>,&amp;context);</div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;      TSSetIFunction  (ts,PETSC_NULL,<a class="code" href="a00236.html#a9d093c3140369a1178dd5b9589a926b1">PetscIFunctionIMEX</a>,  &amp;context);</div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;  </div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;      SNES     snes;</div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;      KSP      ksp;</div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;      PC       pc;</div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;      SNESType snestype;</div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;      TSGetSNES(ts,&amp;snes);</div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;      SNESGetType(snes,&amp;snestype);</div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;</div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;<span class="preprocessor">#ifdef with_librom</span></div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;<span class="preprocessor"></span>      <span class="keywordflow">if</span> (context.<a class="code" href="a00203.html#ae1766c1c76f0ef119388c4fa8a6d64f4">rom_mode</a> == <a class="code" href="a00227.html#acc2b61eb7c1bad16328d8f4be63b70f3">_ROM_MODE_INITIAL_GUESS_</a>) {</div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;        SNESSetComputeInitialGuess(snes, <a class="code" href="a00236.html#ac08ff8a5b9eaa1841e573df91789801e">PetscSetInitialGuessROM</a>, &amp;context);</div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;      }</div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;<span class="preprocessor"></span>  </div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;      <span class="comment">/* Matrix-free representation of the Jacobian */</span></div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;      flag_mat_a = 1;</div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;      MatCreateShell(MPI_COMM_WORLD,context.<a class="code" href="a00203.html#a578ef595dcbe28b2bde5c152c50f85e7">ndofs</a>,context.<a class="code" href="a00203.html#a578ef595dcbe28b2bde5c152c50f85e7">ndofs</a>,PETSC_DETERMINE,</div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;                     PETSC_DETERMINE,&amp;context,&amp;A);</div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;      <span class="keywordflow">if</span> ((!strcmp(snestype,SNESKSPONLY)) || (ptype == TS_LINEAR)) {</div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;        <span class="comment">/* linear problem */</span></div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;        context.<a class="code" href="a00203.html#a200f63fcca813d56a5cf3209546cedb2">flag_is_linear</a> = 1;</div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;        MatShellSetOperation(A,MATOP_MULT,(<span class="keywordtype">void</span> (*)(<span class="keywordtype">void</span>))<a class="code" href="a00236.html#a8778c346e27f42f0583c63909c2ea544">PetscJacobianFunctionIMEX_Linear</a>);</div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;        SNESSetType(snes,SNESKSPONLY);</div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;      } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;        <span class="comment">/* nonlinear problem */</span></div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;        context.<a class="code" href="a00203.html#a200f63fcca813d56a5cf3209546cedb2">flag_is_linear</a> = 0;</div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;        context.<a class="code" href="a00203.html#ad62e14c19e38497048380c4a7fe10e12">jfnk_eps</a> = 1e-7;</div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;        PetscOptionsGetReal(NULL,NULL,<span class="stringliteral">&quot;-jfnk_epsilon&quot;</span>,&amp;context.<a class="code" href="a00203.html#ad62e14c19e38497048380c4a7fe10e12">jfnk_eps</a>,NULL);</div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;        MatShellSetOperation(A,MATOP_MULT,(<span class="keywordtype">void</span> (*)(<span class="keywordtype">void</span>))<a class="code" href="a00236.html#a4edf057726501be3e8fe54e16fafe07b">PetscJacobianFunctionIMEX_JFNK</a>);</div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;      }</div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;      MatSetUp(A);</div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;  </div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;      context.<a class="code" href="a00203.html#a271fbbfea71118710d4a2fb13eb4c1cc">flag_use_precon</a> = 0;</div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;      PetscOptionsGetBool(  PETSC_NULL,PETSC_NULL,</div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;                            <span class="stringliteral">&quot;-with_pc&quot;</span>,</div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;                            (PetscBool*)(&amp;context.<a class="code" href="a00203.html#a271fbbfea71118710d4a2fb13eb4c1cc">flag_use_precon</a>),</div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;                            PETSC_NULL );</div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;  </div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;      <span class="keywordflow">if</span> (context.<a class="code" href="a00203.html#a271fbbfea71118710d4a2fb13eb4c1cc">flag_use_precon</a>) {</div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;        <span class="comment">/* check if flux Jacobian of the physical model is defined */</span></div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ns = 0; ns &lt; nsims; ns++) {</div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;          <span class="keywordflow">if</span> (!sim[ns].solver.JFunction) {</div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;            <span class="keywordflow">if</span> (!rank) {</div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;              fprintf(stderr,<span class="stringliteral">&quot;Error in SolvePETSc(): solver-&gt;JFunction (point-wise flux Jacobian) must &quot;</span>);</div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;              fprintf(stderr,<span class="stringliteral">&quot;be defined for preconditioning.\n&quot;</span>);</div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;            }</div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;            PetscFunctionReturn(1);</div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;          }</div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;        }</div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;        <span class="comment">/* Set up preconditioner matrix */</span></div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;        flag_mat_b = 1;</div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;        MatCreateAIJ( MPI_COMM_WORLD,</div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;                      context.<a class="code" href="a00203.html#a578ef595dcbe28b2bde5c152c50f85e7">ndofs</a>, context.<a class="code" href="a00203.html#a578ef595dcbe28b2bde5c152c50f85e7">ndofs</a>,</div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;                      PETSC_DETERMINE, PETSC_DETERMINE,</div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;                      (sim[0].<a class="code" href="a00208.html#a523947ce4fa7128c4c767163953253b9">solver</a>.<a class="code" href="a00194.html#a484873c74138512e41bc50d17b7d955a">ndims</a>*2+1)*sim[0].<a class="code" href="a00208.html#a523947ce4fa7128c4c767163953253b9">solver</a>.<a class="code" href="a00194.html#ae8f6d2fd6490d3153cb4133bf183a404">nvars</a>, NULL,</div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;                      2*sim[0].<a class="code" href="a00208.html#a523947ce4fa7128c4c767163953253b9">solver</a>.<a class="code" href="a00194.html#a484873c74138512e41bc50d17b7d955a">ndims</a>*sim[0].<a class="code" href="a00208.html#a523947ce4fa7128c4c767163953253b9">solver</a>.<a class="code" href="a00194.html#ae8f6d2fd6490d3153cb4133bf183a404">nvars</a>, NULL,</div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;                      &amp;B );</div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;        MatSetBlockSize(B,sim[0].solver.nvars);</div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;        <span class="comment">/* Set the IJacobian function for TS */</span></div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;        TSSetIJacobian(ts,A,B,<a class="code" href="a00236.html#a82aacb94c1481144ce3e43d40d1f04d4">PetscIJacobianIMEX</a>,&amp;context);</div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;      } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;        <span class="comment">/* Set the IJacobian function for TS */</span></div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;        TSSetIJacobian(ts,A,A,<a class="code" href="a00236.html#a82aacb94c1481144ce3e43d40d1f04d4">PetscIJacobianIMEX</a>,&amp;context);</div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;        <span class="comment">/* Set PC (preconditioner) to none */</span></div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;        SNESGetKSP(snes,&amp;ksp);</div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;        KSPGetPC(ksp,&amp;pc);</div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;        PCSetType(pc,PCNONE);</div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;      }</div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;  </div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;      <span class="comment">/* read the implicit/explicit flags for each of the terms for IMEX schemes */</span></div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;      <span class="comment">/* default -&gt; hyperbolic - explicit, parabolic and source - implicit       */</span></div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;      PetscBool flag = PETSC_FALSE;</div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;  </div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;      context.<a class="code" href="a00203.html#a376b6b34e162357d201827d01a5aa2a4">flag_hyperbolic</a>     = <a class="code" href="a00203.html#a377d0d14ec878aeb4deed4a0533e213d">_EXPLICIT_</a>; </div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;      context.<a class="code" href="a00203.html#a6a0edd627a2b2cc687d1031e3884dd6a">flag_hyperbolic_f</a>   = <a class="code" href="a00203.html#a377d0d14ec878aeb4deed4a0533e213d">_EXPLICIT_</a>; </div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;      context.<a class="code" href="a00203.html#a21b4785029b7597816341479bc3260b4">flag_hyperbolic_df</a>  = <a class="code" href="a00203.html#aad212f0cfa337a32e39d307f8708eca7">_IMPLICIT_</a>; </div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;      context.<a class="code" href="a00203.html#ac48ad2561e5e125d2789133e848db1d9">flag_parabolic</a>      = <a class="code" href="a00203.html#aad212f0cfa337a32e39d307f8708eca7">_IMPLICIT_</a>; </div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;      context.<a class="code" href="a00203.html#a54c0451c4ae9650a54f54246f1f8823b">flag_source</a>         = <a class="code" href="a00203.html#aad212f0cfa337a32e39d307f8708eca7">_IMPLICIT_</a>; </div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;  </div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;      <span class="keywordflow">if</span> (!strcmp(sim[0].solver.SplitHyperbolicFlux,<span class="stringliteral">&quot;yes&quot;</span>)) {</div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;  </div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;        flag = PETSC_FALSE; </div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;        PetscOptionsGetBool(PETSC_NULL,PETSC_NULL,<span class="stringliteral">&quot;-hyperbolic_f_explicit&quot;</span>,&amp;flag,PETSC_NULL);</div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;        <span class="keywordflow">if</span> (flag == PETSC_TRUE) context.<a class="code" href="a00203.html#a6a0edd627a2b2cc687d1031e3884dd6a">flag_hyperbolic_f</a> = <a class="code" href="a00203.html#a377d0d14ec878aeb4deed4a0533e213d">_EXPLICIT_</a>; </div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;        flag = PETSC_FALSE; </div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;        PetscOptionsGetBool(PETSC_NULL,PETSC_NULL,<span class="stringliteral">&quot;-hyperbolic_f_implicit&quot;</span>,&amp;flag,PETSC_NULL);</div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;        <span class="keywordflow">if</span> (flag == PETSC_TRUE) context.<a class="code" href="a00203.html#a6a0edd627a2b2cc687d1031e3884dd6a">flag_hyperbolic_f</a> = <a class="code" href="a00203.html#aad212f0cfa337a32e39d307f8708eca7">_IMPLICIT_</a>; </div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;  </div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;        flag = PETSC_FALSE; </div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;        PetscOptionsGetBool(PETSC_NULL,PETSC_NULL,<span class="stringliteral">&quot;-hyperbolic_df_explicit&quot;</span>,&amp;flag,PETSC_NULL);</div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;        <span class="keywordflow">if</span> (flag == PETSC_TRUE) context.<a class="code" href="a00203.html#a21b4785029b7597816341479bc3260b4">flag_hyperbolic_df</a> = <a class="code" href="a00203.html#a377d0d14ec878aeb4deed4a0533e213d">_EXPLICIT_</a>; </div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;        flag = PETSC_FALSE; </div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;        PetscOptionsGetBool(PETSC_NULL,PETSC_NULL,<span class="stringliteral">&quot;-hyperbolic_df_implicit&quot;</span>,&amp;flag,PETSC_NULL);</div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;        <span class="keywordflow">if</span> (flag == PETSC_TRUE) context.<a class="code" href="a00203.html#a21b4785029b7597816341479bc3260b4">flag_hyperbolic_df</a> = <a class="code" href="a00203.html#aad212f0cfa337a32e39d307f8708eca7">_IMPLICIT_</a>; </div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;  </div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;      } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;  </div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;        flag = PETSC_FALSE; </div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;        PetscOptionsGetBool(PETSC_NULL,PETSC_NULL,<span class="stringliteral">&quot;-hyperbolic_explicit&quot;</span>,&amp;flag,PETSC_NULL);</div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;        <span class="keywordflow">if</span> (flag == PETSC_TRUE) context.<a class="code" href="a00203.html#a376b6b34e162357d201827d01a5aa2a4">flag_hyperbolic</a> = <a class="code" href="a00203.html#a377d0d14ec878aeb4deed4a0533e213d">_EXPLICIT_</a>; </div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;        flag = PETSC_FALSE; </div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;        PetscOptionsGetBool(PETSC_NULL,PETSC_NULL,<span class="stringliteral">&quot;-hyperbolic_implicit&quot;</span>,&amp;flag,PETSC_NULL);</div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;        <span class="keywordflow">if</span> (flag == PETSC_TRUE) context.<a class="code" href="a00203.html#a376b6b34e162357d201827d01a5aa2a4">flag_hyperbolic</a> = <a class="code" href="a00203.html#aad212f0cfa337a32e39d307f8708eca7">_IMPLICIT_</a>; </div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;  </div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;      }</div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;  </div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;      flag = PETSC_FALSE; </div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;      PetscOptionsGetBool(PETSC_NULL,PETSC_NULL,<span class="stringliteral">&quot;-parabolic_explicit&quot;</span>,&amp;flag,PETSC_NULL);</div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;      <span class="keywordflow">if</span> (flag == PETSC_TRUE) context.<a class="code" href="a00203.html#ac48ad2561e5e125d2789133e848db1d9">flag_parabolic</a> = <a class="code" href="a00203.html#a377d0d14ec878aeb4deed4a0533e213d">_EXPLICIT_</a>; </div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;      flag = PETSC_FALSE; </div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;      PetscOptionsGetBool(PETSC_NULL,PETSC_NULL,<span class="stringliteral">&quot;-parabolic_implicit&quot;</span>,&amp;flag,PETSC_NULL);</div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;      <span class="keywordflow">if</span> (flag == PETSC_TRUE) context.<a class="code" href="a00203.html#ac48ad2561e5e125d2789133e848db1d9">flag_parabolic</a> = <a class="code" href="a00203.html#aad212f0cfa337a32e39d307f8708eca7">_IMPLICIT_</a>; </div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;  </div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;      flag = PETSC_FALSE; </div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;      PetscOptionsGetBool(PETSC_NULL,PETSC_NULL,<span class="stringliteral">&quot;-source_explicit&quot;</span>,&amp;flag,PETSC_NULL);</div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;      <span class="keywordflow">if</span> (flag == PETSC_TRUE) context.<a class="code" href="a00203.html#a54c0451c4ae9650a54f54246f1f8823b">flag_source</a> = <a class="code" href="a00203.html#a377d0d14ec878aeb4deed4a0533e213d">_EXPLICIT_</a>; </div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;      flag = PETSC_FALSE; </div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;      PetscOptionsGetBool(PETSC_NULL,PETSC_NULL,<span class="stringliteral">&quot;-source_implicit&quot;</span>,&amp;flag,PETSC_NULL);</div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;      <span class="keywordflow">if</span> (flag == PETSC_TRUE) context.<a class="code" href="a00203.html#a54c0451c4ae9650a54f54246f1f8823b">flag_source</a> = <a class="code" href="a00203.html#aad212f0cfa337a32e39d307f8708eca7">_IMPLICIT_</a>; </div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;  </div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;      flag = PETSC_FALSE;</div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;      PetscOptionsGetBool(PETSC_NULL,PETSC_NULL,<span class="stringliteral">&quot;-ts_arkimex_fully_implicit&quot;</span>,&amp;flag,PETSC_NULL);</div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;      <span class="keywordflow">if</span> (flag == PETSC_TRUE) {</div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;        context.<a class="code" href="a00203.html#a6a0edd627a2b2cc687d1031e3884dd6a">flag_hyperbolic_f</a>   = <a class="code" href="a00203.html#aad212f0cfa337a32e39d307f8708eca7">_IMPLICIT_</a>;</div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;        context.<a class="code" href="a00203.html#a21b4785029b7597816341479bc3260b4">flag_hyperbolic_df</a>  = <a class="code" href="a00203.html#aad212f0cfa337a32e39d307f8708eca7">_IMPLICIT_</a>;</div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;        context.<a class="code" href="a00203.html#a376b6b34e162357d201827d01a5aa2a4">flag_hyperbolic</a>     = <a class="code" href="a00203.html#aad212f0cfa337a32e39d307f8708eca7">_IMPLICIT_</a>;</div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;        context.<a class="code" href="a00203.html#ac48ad2561e5e125d2789133e848db1d9">flag_parabolic</a>      = <a class="code" href="a00203.html#aad212f0cfa337a32e39d307f8708eca7">_IMPLICIT_</a>;</div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;        context.<a class="code" href="a00203.html#a54c0451c4ae9650a54f54246f1f8823b">flag_source</a>         = <a class="code" href="a00203.html#aad212f0cfa337a32e39d307f8708eca7">_IMPLICIT_</a>;</div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;      }</div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;  </div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;      <span class="comment">/* print out a summary of the treatment of each term */</span></div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;      <span class="keywordflow">if</span> (!rank) {</div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;        printf(<span class="stringliteral">&quot;Implicit-Explicit time-integration:-\n&quot;</span>);</div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;        <span class="keywordflow">if</span> (!strcmp(sim[0].solver.SplitHyperbolicFlux,<span class="stringliteral">&quot;yes&quot;</span>)) {</div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;          <span class="keywordflow">if</span> (context.<a class="code" href="a00203.html#a6a0edd627a2b2cc687d1031e3884dd6a">flag_hyperbolic_f</a> == <a class="code" href="a00203.html#a377d0d14ec878aeb4deed4a0533e213d">_EXPLICIT_</a>)  printf(<span class="stringliteral">&quot;Hyperbolic (f-df) term: Explicit\n&quot;</span>);</div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;          <span class="keywordflow">else</span>                                          printf(<span class="stringliteral">&quot;Hyperbolic (f-df) term: Implicit\n&quot;</span>);</div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;          <span class="keywordflow">if</span> (context.<a class="code" href="a00203.html#a21b4785029b7597816341479bc3260b4">flag_hyperbolic_df</a> == <a class="code" href="a00203.html#a377d0d14ec878aeb4deed4a0533e213d">_EXPLICIT_</a>) printf(<span class="stringliteral">&quot;Hyperbolic (df)   term: Explicit\n&quot;</span>);</div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;          <span class="keywordflow">else</span>                                          printf(<span class="stringliteral">&quot;Hyperbolic (df)   term: Implicit\n&quot;</span>);</div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;          <span class="keywordflow">if</span> (context.<a class="code" href="a00203.html#a376b6b34e162357d201827d01a5aa2a4">flag_hyperbolic</a> == <a class="code" href="a00203.html#a377d0d14ec878aeb4deed4a0533e213d">_EXPLICIT_</a>)    printf(<span class="stringliteral">&quot;Hyperbolic        term: Explicit\n&quot;</span>);</div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;          <span class="keywordflow">else</span>                                          printf(<span class="stringliteral">&quot;Hyperbolic        term: Implicit\n&quot;</span>);</div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;        }</div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;        <span class="keywordflow">if</span> (context.<a class="code" href="a00203.html#ac48ad2561e5e125d2789133e848db1d9">flag_parabolic</a> == <a class="code" href="a00203.html#a377d0d14ec878aeb4deed4a0533e213d">_EXPLICIT_</a>)       printf(<span class="stringliteral">&quot;Parabolic         term: Explicit\n&quot;</span>);</div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;        <span class="keywordflow">else</span>                                            printf(<span class="stringliteral">&quot;Parabolic         term: Implicit\n&quot;</span>);</div>
<div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;        <span class="keywordflow">if</span> (context.<a class="code" href="a00203.html#a54c0451c4ae9650a54f54246f1f8823b">flag_source</a>    == <a class="code" href="a00203.html#a377d0d14ec878aeb4deed4a0533e213d">_EXPLICIT_</a>)       printf(<span class="stringliteral">&quot;Source            term: Explicit\n&quot;</span>);</div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;        <span class="keywordflow">else</span>                                            printf(<span class="stringliteral">&quot;Source            term: Implicit\n&quot;</span>);</div>
<div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;      }</div>
<div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;  </div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (     (!strcmp(time_scheme,TSEULER)) </div>
<div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;                ||  (!strcmp(time_scheme,TSRK   )) </div>
<div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;                ||  (!strcmp(time_scheme,TSSSP  )) ) {</div>
<div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;  </div>
<div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;      <span class="comment">/* Explicit time integration */</span>    </div>
<div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;      TSSetRHSFunction(ts,PETSC_NULL,<a class="code" href="a00236.html#ac67533553372ed2b44b32d095c775f5c">PetscRHSFunctionExpl</a>,&amp;context);</div>
<div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;  </div>
<div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;  </div>
<div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;      <span class="comment">/* Implicit or explicit time integration */</span></div>
<div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;  </div>
<div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;      TSSetRHSFunction(ts,PETSC_NULL,<a class="code" href="a00236.html#a91eb21ee4374b79a74f413d926344d7e">PetscRHSFunctionImpl</a>,&amp;context);</div>
<div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;  </div>
<div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;      SNES     snes;</div>
<div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;      KSP      ksp;</div>
<div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;      PC       pc;</div>
<div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;      SNESType snestype;</div>
<div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;      TSGetSNES(ts,&amp;snes);</div>
<div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;      SNESGetType(snes,&amp;snestype);</div>
<div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;  </div>
<div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;<span class="preprocessor">#ifdef with_librom</span></div>
<div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;<span class="preprocessor"></span>      <span class="keywordflow">if</span> (context.<a class="code" href="a00203.html#ae1766c1c76f0ef119388c4fa8a6d64f4">rom_mode</a> == <a class="code" href="a00227.html#acc2b61eb7c1bad16328d8f4be63b70f3">_ROM_MODE_INITIAL_GUESS_</a>) {</div>
<div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;        SNESSetComputeInitialGuess(snes, <a class="code" href="a00236.html#ac08ff8a5b9eaa1841e573df91789801e">PetscSetInitialGuessROM</a>, &amp;context);</div>
<div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;      }</div>
<div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;<span class="preprocessor"></span>  </div>
<div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;      <span class="comment">/* Matrix-free representation of the Jacobian */</span></div>
<div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;      flag_mat_a = 1;</div>
<div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;      MatCreateShell(MPI_COMM_WORLD,context.<a class="code" href="a00203.html#a578ef595dcbe28b2bde5c152c50f85e7">ndofs</a>,context.<a class="code" href="a00203.html#a578ef595dcbe28b2bde5c152c50f85e7">ndofs</a>,PETSC_DETERMINE,</div>
<div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;                            PETSC_DETERMINE,&amp;context,&amp;A);</div>
<div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;      <span class="keywordflow">if</span> ((!strcmp(snestype,SNESKSPONLY)) || (ptype == TS_LINEAR)) {</div>
<div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;        <span class="comment">/* linear problem */</span></div>
<div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;        context.<a class="code" href="a00203.html#a200f63fcca813d56a5cf3209546cedb2">flag_is_linear</a> = 1;</div>
<div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;        MatShellSetOperation(A,MATOP_MULT,(<span class="keywordtype">void</span> (*)(<span class="keywordtype">void</span>))<a class="code" href="a00236.html#abed41de2efef801be98f8338aa2672f2">PetscJacobianFunction_Linear</a>);</div>
<div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;        SNESSetType(snes,SNESKSPONLY);</div>
<div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;      } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;        <span class="comment">/* nonlinear problem */</span></div>
<div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;        context.<a class="code" href="a00203.html#a200f63fcca813d56a5cf3209546cedb2">flag_is_linear</a> = 0;</div>
<div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;        context.<a class="code" href="a00203.html#ad62e14c19e38497048380c4a7fe10e12">jfnk_eps</a> = 1e-7;</div>
<div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;        PetscOptionsGetReal(NULL,NULL,<span class="stringliteral">&quot;-jfnk_epsilon&quot;</span>,&amp;context.<a class="code" href="a00203.html#ad62e14c19e38497048380c4a7fe10e12">jfnk_eps</a>,NULL);</div>
<div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;        MatShellSetOperation(A,MATOP_MULT,(<span class="keywordtype">void</span> (*)(<span class="keywordtype">void</span>))<a class="code" href="a00236.html#a68f5a93a79d56fcb964224f649af4ac9">PetscJacobianFunction_JFNK</a>);</div>
<div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;      }</div>
<div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;      MatSetUp(A);</div>
<div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;  </div>
<div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;      context.<a class="code" href="a00203.html#a271fbbfea71118710d4a2fb13eb4c1cc">flag_use_precon</a> = 0;</div>
<div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;      PetscOptionsGetBool(  PETSC_NULL,</div>
<div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;                            PETSC_NULL,</div>
<div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;                            <span class="stringliteral">&quot;-with_pc&quot;</span>,</div>
<div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;                            (PetscBool*)(&amp;context.<a class="code" href="a00203.html#a271fbbfea71118710d4a2fb13eb4c1cc">flag_use_precon</a>),</div>
<div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;                            PETSC_NULL );</div>
<div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;  </div>
<div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;      <span class="comment">/* Since we are using a MatShell to represent the action of the Jacobian </span></div>
<div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;<span class="comment">         on a vector (Jacobian-free approach),</span></div>
<div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;<span class="comment">         we need to define the Jacobian through TSSetIJacobian, and not TSSetRHSJacobian, </span></div>
<div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;<span class="comment">         so that we can define the complete operator (the shifted Jacobian aI - J ) */</span></div>
<div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;  </div>
<div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;      <span class="keywordflow">if</span> (context.<a class="code" href="a00203.html#a271fbbfea71118710d4a2fb13eb4c1cc">flag_use_precon</a>) {</div>
<div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;        <span class="comment">/* check if flux Jacobian of the physical model is defined */</span></div>
<div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ns = 0; ns &lt; nsims; ns++) {</div>
<div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;          <span class="keywordflow">if</span> (!sim[ns].solver.JFunction) {</div>
<div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;            <span class="keywordflow">if</span> (!rank) {</div>
<div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;              fprintf(stderr,<span class="stringliteral">&quot;Error in SolvePETSc(): solver-&gt;JFunction (point-wise flux Jacobian) must &quot;</span>);</div>
<div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;              fprintf(stderr,<span class="stringliteral">&quot;be defined for preconditioning.\n&quot;</span>);</div>
<div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;            }</div>
<div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;            PetscFunctionReturn(1);</div>
<div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;          }</div>
<div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;        }</div>
<div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;        <span class="comment">/* Set up preconditioner matrix */</span></div>
<div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;        flag_mat_b = 1;</div>
<div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;        MatCreateAIJ( MPI_COMM_WORLD,</div>
<div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;                      context.<a class="code" href="a00203.html#a578ef595dcbe28b2bde5c152c50f85e7">ndofs</a>, context.<a class="code" href="a00203.html#a578ef595dcbe28b2bde5c152c50f85e7">ndofs</a>,</div>
<div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;                      PETSC_DETERMINE, PETSC_DETERMINE,</div>
<div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;                      (sim[0].<a class="code" href="a00208.html#a523947ce4fa7128c4c767163953253b9">solver</a>.<a class="code" href="a00194.html#a484873c74138512e41bc50d17b7d955a">ndims</a>*2+1)*sim[0].<a class="code" href="a00208.html#a523947ce4fa7128c4c767163953253b9">solver</a>.<a class="code" href="a00194.html#ae8f6d2fd6490d3153cb4133bf183a404">nvars</a>, NULL,</div>
<div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;                      2*sim[0].<a class="code" href="a00208.html#a523947ce4fa7128c4c767163953253b9">solver</a>.<a class="code" href="a00194.html#a484873c74138512e41bc50d17b7d955a">ndims</a>*sim[0].<a class="code" href="a00208.html#a523947ce4fa7128c4c767163953253b9">solver</a>.<a class="code" href="a00194.html#ae8f6d2fd6490d3153cb4133bf183a404">nvars</a>, NULL,</div>
<div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;                      &amp;B );</div>
<div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;        MatSetBlockSize(B,sim[0].solver.nvars);</div>
<div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;        <span class="comment">/* Set the RHSJacobian function for TS */</span></div>
<div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;        TSSetIJacobian(ts,A,B,<a class="code" href="a00236.html#a3d6a695a879ec54937525109ac912355">PetscIJacobian</a>,&amp;context);</div>
<div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;      } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;        <span class="comment">/* Set the RHSJacobian function for TS */</span></div>
<div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;        TSSetIJacobian(ts,A,A,<a class="code" href="a00236.html#a3d6a695a879ec54937525109ac912355">PetscIJacobian</a>,&amp;context);</div>
<div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;        <span class="comment">/* Set PC (preconditioner) to none */</span></div>
<div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;        SNESGetKSP(snes,&amp;ksp);</div>
<div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;        KSPGetPC(ksp,&amp;pc);</div>
<div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;        PCSetType(pc,PCNONE);</div>
<div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;      }</div>
<div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;  </div>
<div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;    }</div>
<div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;  </div>
<div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;    <span class="comment">/* Set pre/post-stage and post-timestep function */</span></div>
<div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;    TSSetPreStep (ts,<a class="code" href="a00236.html#ace222db5eadd0e0bd27229641e43fa9b">PetscPreTimeStep</a> );</div>
<div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;    TSSetPreStage(ts,<a class="code" href="a00236.html#aa52bad03c15488a2119b794d0e70deed">PetscPreStage</a>    );</div>
<div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;    TSSetPostStage(ts,<a class="code" href="a00236.html#ad1f357f94c228ba9ff45275064ca162b">PetscPostStage</a>  );</div>
<div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;    TSSetPostStep(ts,<a class="code" href="a00236.html#a3f7397f8cd5e90306fb7f02edecb3782">PetscPostTimeStep</a>);</div>
<div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;    <span class="comment">/* Set solution vector for TS */</span></div>
<div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;    TSSetSolution(ts,Y);</div>
<div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;    <span class="comment">/* Set it all up */</span></div>
<div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;    TSSetUp(ts);</div>
<div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;    <span class="comment">/* Set application context */</span></div>
<div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;    TSSetApplicationContext(ts,&amp;context);</div>
<div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;  </div>
<div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;    <span class="keywordflow">if</span> (!rank) {</div>
<div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;      <span class="keywordflow">if</span> (context.<a class="code" href="a00203.html#a200f63fcca813d56a5cf3209546cedb2">flag_is_linear</a>) printf(<span class="stringliteral">&quot;SolvePETSc(): Problem type is linear.\n&quot;</span>);</div>
<div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;      <span class="keywordflow">else</span>                        printf(<span class="stringliteral">&quot;SolvePETSc(): Problem type is nonlinear.\n&quot;</span>);</div>
<div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;    }</div>
<div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;  </div>
<div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;    <span class="keywordflow">if</span> (!rank) printf(<span class="stringliteral">&quot;** Starting PETSc time integration **\n&quot;</span>);</div>
<div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;    context.<a class="code" href="a00203.html#afdccc5dc654297cee401e0938ffb7985">ti_runtime</a> = 0.0;</div>
<div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;    TSSolve(ts,Y);</div>
<div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;    <span class="keywordflow">if</span> (!rank) {</div>
<div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;      printf(<span class="stringliteral">&quot;** Completed PETSc time integration (Final time: %f), total wctime: %f (seconds) **\n&quot;</span>,</div>
<div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;              context.<a class="code" href="a00203.html#a28e4e78c0bf258662bef21d26c51fc0b">waqt</a>, context.<a class="code" href="a00203.html#afdccc5dc654297cee401e0938ffb7985">ti_runtime</a> );</div>
<div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;    }</div>
<div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;  </div>
<div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;    <span class="comment">/* Get the number of time steps */</span></div>
<div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ns = 0; ns &lt; nsims; ns++) {</div>
<div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;      TSGetStepNumber(ts,&amp;(sim[ns].solver.n_iter));</div>
<div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;    }</div>
<div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;  </div>
<div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;    <span class="comment">/* get and write to file any auxiliary solutions */</span></div>
<div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;    <span class="keywordtype">char</span> aux_fname_root[4] = <span class="stringliteral">&quot;ts0&quot;</span>;</div>
<div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;    TSGetSolutionComponents(ts,&amp;iAuxSize,NULL);</div>
<div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;    <span class="keywordflow">if</span> (iAuxSize) {</div>
<div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;      <span class="keywordflow">if</span> (iAuxSize &gt; 10) iAuxSize = 10;</div>
<div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;      <span class="keywordflow">if</span> (!rank) printf(<span class="stringliteral">&quot;Number of auxiliary solutions from time integration: %d\n&quot;</span>,iAuxSize);</div>
<div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;      VecDuplicate(Y,&amp;Z);</div>
<div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;      <span class="keywordflow">for</span> (i=0; i&lt;iAuxSize; i++) {</div>
<div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;        TSGetSolutionComponents(ts,&amp;i,&amp;Z);</div>
<div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ns = 0; ns &lt; nsims; ns++) {</div>
<div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;          <a class="code" href="a00236.html#a9f443ff08a9a8852ab1e9cabb793ddaa">TransferVecFromPETSc</a>(sim[ns].solver.u,Z,&amp;context,ns,context.<a class="code" href="a00203.html#ad2182a08b22eed3bb3b0728725841875">offsets</a>[ns]);</div>
<div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;          <a class="code" href="a00225.html#aaf888c739c5200d9c58a7154347069b0">WriteArray</a>( sim[ns].solver.ndims,</div>
<div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;                      sim[ns].<a class="code" href="a00208.html#a523947ce4fa7128c4c767163953253b9">solver</a>.<a class="code" href="a00194.html#ae8f6d2fd6490d3153cb4133bf183a404">nvars</a>,</div>
<div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;                      sim[ns].<a class="code" href="a00208.html#a523947ce4fa7128c4c767163953253b9">solver</a>.<a class="code" href="a00194.html#aa989ebb755986852177779cdf7bd8c85">dim_global</a>,</div>
<div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;                      sim[ns].<a class="code" href="a00208.html#a523947ce4fa7128c4c767163953253b9">solver</a>.<a class="code" href="a00194.html#a38e0371f331cecbe63a77fa03e202afe">dim_local</a>,</div>
<div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;                      sim[ns].<a class="code" href="a00208.html#a523947ce4fa7128c4c767163953253b9">solver</a>.<a class="code" href="a00194.html#aafc992b5fa79d5a4036024615d03bce6">ghosts</a>,</div>
<div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;                      sim[ns].<a class="code" href="a00208.html#a523947ce4fa7128c4c767163953253b9">solver</a>.<a class="code" href="a00194.html#a711aad4cbe735871dd9e91ab575c878b">x</a>,</div>
<div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;                      sim[ns].<a class="code" href="a00208.html#a523947ce4fa7128c4c767163953253b9">solver</a>.<a class="code" href="a00194.html#a3b6b999a764f1e2ea94bb5f28c7a558c">u</a>,</div>
<div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;                      &amp;(sim[ns].<a class="code" href="a00208.html#a523947ce4fa7128c4c767163953253b9">solver</a>),</div>
<div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;                      &amp;(sim[ns].<a class="code" href="a00208.html#a4afd2c7b3eb8fda452474ebdbe71c8c0">mpi</a>),</div>
<div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;                      aux_fname_root );</div>
<div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;        }</div>
<div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;        aux_fname_root[2]++;</div>
<div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;      }</div>
<div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;      VecDestroy(&amp;Z);</div>
<div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;    }</div>
<div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;  </div>
<div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;    <span class="comment">/* if available, get error estimates */</span></div>
<div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;    <a class="code" href="a00236.html#ab501847c597b0c20dff03d95a663b9b4">PetscTimeError</a>(ts);</div>
<div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;  </div>
<div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;    <span class="comment">/* copy final solution from PETSc&#39;s vector */</span></div>
<div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ns = 0; ns &lt; nsims; ns++) {</div>
<div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;      <a class="code" href="a00236.html#a9f443ff08a9a8852ab1e9cabb793ddaa">TransferVecFromPETSc</a>(sim[ns].solver.u,Y,&amp;context,ns,context.<a class="code" href="a00203.html#ad2182a08b22eed3bb3b0728725841875">offsets</a>[ns]);</div>
<div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;    }</div>
<div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;  </div>
<div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;    <span class="comment">/* clean up */</span></div>
<div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;    <span class="keywordflow">if</span> (flag_mat_a) { MatDestroy(&amp;A); }</div>
<div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;    <span class="keywordflow">if</span> (flag_mat_b) { MatDestroy(&amp;B); }</div>
<div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;    TSDestroy(&amp;ts);</div>
<div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;    VecDestroy(&amp;Y);</div>
<div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;  </div>
<div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;    <span class="comment">/* write a final solution file, if last iteration did not write one */</span></div>
<div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;    <span class="keywordflow">if</span> (context.<a class="code" href="a00203.html#a34cbd56d5136d5e8b5ea2cbb901c04cd">tic</a>) { </div>
<div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ns = 0; ns &lt; nsims; ns++) {</div>
<div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;        <a class="code" href="a00194.html">HyPar</a>* solver = &amp;(sim[ns].<a class="code" href="a00208.html#a523947ce4fa7128c4c767163953253b9">solver</a>);</div>
<div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;        <a class="code" href="a00197.html#a00622">MPIVariables</a>* mpi = &amp;(sim[ns].<a class="code" href="a00208.html#a4afd2c7b3eb8fda452474ebdbe71c8c0">mpi</a>);</div>
<div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;        <span class="keywordflow">if</span> (solver-&gt;<a class="code" href="a00194.html#ab4c55736e92f7d72f04b8a957d82b054">PhysicsOutput</a>) {</div>
<div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;          solver-&gt;<a class="code" href="a00194.html#ab4c55736e92f7d72f04b8a957d82b054">PhysicsOutput</a>(solver,mpi);</div>
<div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;        }</div>
<div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;        <a class="code" href="a00286.html#a52e8c83d9dad55f9a6b967e63dc5f4bc">CalculateError</a>(solver,mpi);</div>
<div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;      }</div>
<div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;      <a class="code" href="a00384.html#a5981de613724cb667e98aa872157534e">OutputSolution</a>(sim, nsims); </div>
<div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;    }</div>
<div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;    <span class="comment">/* calculate error if exact solution has been provided */</span></div>
<div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ns = 0; ns &lt; nsims; ns++) {</div>
<div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;      <a class="code" href="a00286.html#a52e8c83d9dad55f9a6b967e63dc5f4bc">CalculateError</a>(&amp;(sim[ns].solver), &amp;(sim[ns].mpi));</div>
<div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;    }</div>
<div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;  </div>
<div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;    <a class="code" href="a00236.html#a52781b615afd6404c69c93dd0aa82924">PetscCleanup</a>(&amp;context);</div>
<div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;</div>
<div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;<span class="preprocessor">#ifdef with_librom</span></div>
<div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;<span class="preprocessor"></span>    context.<a class="code" href="a00203.html#aac65a15cdd8e87c5c788db46e1ca0347">op_times_arr</a>.push_back(context.<a class="code" href="a00203.html#a28e4e78c0bf258662bef21d26c51fc0b">waqt</a>);</div>
<div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;</div>
<div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ns = 0; ns &lt; nsims; ns++) {</div>
<div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;      <a class="code" href="a00291.html#ad22799259c966d7dcc526452eaf7e855">ResetFilenameIndex</a>( sim[ns].solver.<a class="code" href="a00194.html#a0805db42e429173752189696c3c96909">filename_index</a>, </div>
<div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;                          sim[ns].<a class="code" href="a00208.html#a523947ce4fa7128c4c767163953253b9">solver</a>.<a class="code" href="a00194.html#af474ca4577de91b658e4399ad0a6d7b3">index_length</a> );</div>
<div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;    }</div>
<div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;  </div>
<div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;    <span class="keywordflow">if</span> (((<a class="code" href="a00195.html">libROMInterface</a>*)context.<a class="code" href="a00203.html#af8049501def09c2e14fbec0a72c8c66c">rom_interface</a>)-&gt;mode() == <a class="code" href="a00227.html#a8d7f058ce028038a98a49ad28176390e">_ROM_MODE_TRAIN_</a>) {</div>
<div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;  </div>
<div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;      ((<a class="code" href="a00195.html">libROMInterface</a>*)context.<a class="code" href="a00203.html#af8049501def09c2e14fbec0a72c8c66c">rom_interface</a>)-&gt;train();</div>
<div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;      <span class="keywordflow">if</span> (!rank) printf(<span class="stringliteral">&quot;libROM: total training wallclock time: %f (seconds).\n&quot;</span>, </div>
<div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;                        ((<a class="code" href="a00195.html">libROMInterface</a>*)context.<a class="code" href="a00203.html#af8049501def09c2e14fbec0a72c8c66c">rom_interface</a>)-&gt;trainWallclockTime() );</div>
<div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;</div>
<div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;      <span class="keywordtype">double</span> total_rom_predict_time = 0;</div>
<div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> iter = 0; iter &lt; context.<a class="code" href="a00203.html#aac65a15cdd8e87c5c788db46e1ca0347">op_times_arr</a>.size(); iter++) {</div>
<div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;  </div>
<div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;        <span class="keywordtype">double</span> waqt = context.<a class="code" href="a00203.html#aac65a15cdd8e87c5c788db46e1ca0347">op_times_arr</a>[iter];</div>
<div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;  </div>
<div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;        ((<a class="code" href="a00195.html">libROMInterface</a>*)context.<a class="code" href="a00203.html#af8049501def09c2e14fbec0a72c8c66c">rom_interface</a>)-&gt;predict(sim, waqt);</div>
<div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;        <span class="keywordflow">if</span> (!rank) printf(  <span class="stringliteral">&quot;libROM: Predicted solution at time %1.4e using ROM, wallclock time: %f.\n&quot;</span>, </div>
<div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;                            waqt, ((<a class="code" href="a00195.html">libROMInterface</a>*)context.<a class="code" href="a00203.html#af8049501def09c2e14fbec0a72c8c66c">rom_interface</a>)-&gt;predictWallclockTime() );</div>
<div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;        total_rom_predict_time += ((<a class="code" href="a00195.html">libROMInterface</a>*)context.<a class="code" href="a00203.html#af8049501def09c2e14fbec0a72c8c66c">rom_interface</a>)-&gt;predictWallclockTime();</div>
<div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;  </div>
<div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;        <span class="comment">/* calculate diff between ROM and PDE solutions */</span></div>
<div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;        <span class="keywordflow">if</span> (iter == (context.<a class="code" href="a00203.html#aac65a15cdd8e87c5c788db46e1ca0347">op_times_arr</a>.size()-1)) {</div>
<div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;          <span class="keywordflow">if</span> (!rank) printf(<span class="stringliteral">&quot;libROM:   Calculating diff between PDE and ROM solutions.\n&quot;</span>);</div>
<div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;          <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ns = 0; ns &lt; nsims; ns++) {</div>
<div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;            <a class="code" href="a00287.html#accb3d8778a793486e72e06f817ef16fc">CalculateROMDiff</a>(  &amp;(sim[ns].solver),</div>
<div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;                               &amp;(sim[ns].mpi) );</div>
<div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;          }</div>
<div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;        }</div>
<div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;        <span class="comment">/* write the ROM solution to file */</span></div>
<div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;        <a class="code" href="a00559.html#a11343894048fd842093253bbbb407700">OutputROMSolution</a>(sim, nsims); </div>
<div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;  </div>
<div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;      }</div>
<div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;</div>
<div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;      <span class="keywordflow">if</span> (!rank) {</div>
<div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;        printf( <span class="stringliteral">&quot;libROM: total prediction/query wallclock time: %f (seconds).\n&quot;</span>,</div>
<div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;                total_rom_predict_time );</div>
<div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;      }</div>
<div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;</div>
<div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;      ((<a class="code" href="a00195.html">libROMInterface</a>*)context.<a class="code" href="a00203.html#af8049501def09c2e14fbec0a72c8c66c">rom_interface</a>)-&gt;saveROM();</div>
<div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;</div>
<div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;</div>
<div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ns = 0; ns &lt; nsims; ns++) {</div>
<div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;        sim[ns].<a class="code" href="a00208.html#a523947ce4fa7128c4c767163953253b9">solver</a>.<a class="code" href="a00194.html#aaacee284a041d53cf335ae299d5eb929">rom_diff_norms</a>[0]</div>
<div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;          = sim[ns].<a class="code" href="a00208.html#a523947ce4fa7128c4c767163953253b9">solver</a>.<a class="code" href="a00194.html#aaacee284a041d53cf335ae299d5eb929">rom_diff_norms</a>[1]</div>
<div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;          = sim[ns].<a class="code" href="a00208.html#a523947ce4fa7128c4c767163953253b9">solver</a>.<a class="code" href="a00194.html#aaacee284a041d53cf335ae299d5eb929">rom_diff_norms</a>[2]</div>
<div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;          = -1;</div>
<div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;      }</div>
<div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;</div>
<div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;    }</div>
<div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;</div>
<div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;  } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (context.<a class="code" href="a00203.html#ae1766c1c76f0ef119388c4fa8a6d64f4">rom_mode</a> == <a class="code" href="a00227.html#a3035c57e07a432c8274e63259a0d506d">_ROM_MODE_PREDICT_</a>) {</div>
<div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;</div>
<div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ns = 0; ns &lt; nsims; ns++) {</div>
<div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;      sim[ns].<a class="code" href="a00208.html#a523947ce4fa7128c4c767163953253b9">solver</a>.<a class="code" href="a00194.html#aaacee284a041d53cf335ae299d5eb929">rom_diff_norms</a>[0]</div>
<div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;        = sim[ns].<a class="code" href="a00208.html#a523947ce4fa7128c4c767163953253b9">solver</a>.<a class="code" href="a00194.html#aaacee284a041d53cf335ae299d5eb929">rom_diff_norms</a>[1]</div>
<div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;        = sim[ns].<a class="code" href="a00208.html#a523947ce4fa7128c4c767163953253b9">solver</a>.<a class="code" href="a00194.html#aaacee284a041d53cf335ae299d5eb929">rom_diff_norms</a>[2]</div>
<div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;        = -1;</div>
<div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;      strcpy(sim[ns].solver.<a class="code" href="a00194.html#ac92c34fe456d92c694eacd2231f5a7b1">ConservationCheck</a>,<span class="stringliteral">&quot;no&quot;</span>);</div>
<div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;    }</div>
<div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;</div>
<div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;    ((<a class="code" href="a00195.html">libROMInterface</a>*)context.<a class="code" href="a00203.html#af8049501def09c2e14fbec0a72c8c66c">rom_interface</a>)-&gt;loadROM();</div>
<div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;    ((<a class="code" href="a00195.html">libROMInterface</a>*)context.<a class="code" href="a00203.html#af8049501def09c2e14fbec0a72c8c66c">rom_interface</a>)-&gt;projectInitialSolution(sim);</div>
<div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;</div>
<div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;    {</div>
<div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;      <span class="keywordtype">int</span> start_iter = sim[0].<a class="code" href="a00208.html#a523947ce4fa7128c4c767163953253b9">solver</a>.<a class="code" href="a00194.html#aafb41b96563d9966e8e9f458751f2960">restart_iter</a>;</div>
<div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;      <span class="keywordtype">int</span> n_iter = sim[0].<a class="code" href="a00208.html#a523947ce4fa7128c4c767163953253b9">solver</a>.<a class="code" href="a00194.html#af0d8e0d5d3de3869b941b66b6caaf964">n_iter</a>;</div>
<div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;      <span class="keywordtype">double</span> dt = sim[0].<a class="code" href="a00208.html#a523947ce4fa7128c4c767163953253b9">solver</a>.<a class="code" href="a00194.html#a03e28be41881b703c836edbfe9b51b17">dt</a>;</div>
<div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;  </div>
<div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;      <span class="keywordtype">double</span> cur_time = start_iter * dt;</div>
<div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;      context.<a class="code" href="a00203.html#aac65a15cdd8e87c5c788db46e1ca0347">op_times_arr</a>.push_back(cur_time);</div>
<div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;  </div>
<div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> iter = start_iter; iter &lt; n_iter; iter++) {</div>
<div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;        cur_time += dt;</div>
<div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;        <span class="keywordflow">if</span> (    ( (iter+1)%sim[0].solver.<a class="code" href="a00194.html#a6ff746b30ee55a3bbb9f3306c145f27a">file_op_iter</a> == 0)</div>
<div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;            &amp;&amp;  ( (iter+1) &lt; n_iter) ) {</div>
<div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;          context.<a class="code" href="a00203.html#aac65a15cdd8e87c5c788db46e1ca0347">op_times_arr</a>.push_back(cur_time);</div>
<div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;        }</div>
<div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;      }</div>
<div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;  </div>
<div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;      <span class="keywordtype">double</span> t_final = n_iter*dt;</div>
<div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;      context.<a class="code" href="a00203.html#aac65a15cdd8e87c5c788db46e1ca0347">op_times_arr</a>.push_back(t_final);</div>
<div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;    }</div>
<div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;</div>
<div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;    <span class="keywordtype">double</span> total_rom_predict_time = 0;</div>
<div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> iter = 0; iter &lt; context.<a class="code" href="a00203.html#aac65a15cdd8e87c5c788db46e1ca0347">op_times_arr</a>.size(); iter++) {</div>
<div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160;  </div>
<div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;      <span class="keywordtype">double</span> waqt = context.<a class="code" href="a00203.html#aac65a15cdd8e87c5c788db46e1ca0347">op_times_arr</a>[iter];</div>
<div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160;  </div>
<div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160;      ((<a class="code" href="a00195.html">libROMInterface</a>*)context.<a class="code" href="a00203.html#af8049501def09c2e14fbec0a72c8c66c">rom_interface</a>)-&gt;predict(sim, waqt);</div>
<div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160;      <span class="keywordflow">if</span> (!rank) printf(  <span class="stringliteral">&quot;libROM: Predicted solution at time %1.4e using ROM, wallclock time: %f.\n&quot;</span>, </div>
<div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160;                          waqt, ((<a class="code" href="a00195.html">libROMInterface</a>*)context.<a class="code" href="a00203.html#af8049501def09c2e14fbec0a72c8c66c">rom_interface</a>)-&gt;predictWallclockTime() );</div>
<div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160;      total_rom_predict_time += ((<a class="code" href="a00195.html">libROMInterface</a>*)context.<a class="code" href="a00203.html#af8049501def09c2e14fbec0a72c8c66c">rom_interface</a>)-&gt;predictWallclockTime();</div>
<div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160;  </div>
<div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;      <span class="comment">/* write the solution to file */</span></div>
<div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ns = 0; ns &lt; nsims; ns++) {</div>
<div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160;        <span class="keywordflow">if</span> (sim[ns].solver.<a class="code" href="a00194.html#ab4c55736e92f7d72f04b8a957d82b054">PhysicsOutput</a>) {</div>
<div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;          sim[ns].<a class="code" href="a00208.html#a523947ce4fa7128c4c767163953253b9">solver</a>.<a class="code" href="a00194.html#ab4c55736e92f7d72f04b8a957d82b054">PhysicsOutput</a>( &amp;(sim[ns].solver),</div>
<div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160;                                        &amp;(sim[ns].mpi) );</div>
<div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160;        }</div>
<div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160;      }</div>
<div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160;      <a class="code" href="a00384.html#a5981de613724cb667e98aa872157534e">OutputSolution</a>(sim, nsims); </div>
<div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160;  </div>
<div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160;    }</div>
<div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160;</div>
<div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160;    <span class="comment">/* calculate error if exact solution has been provided */</span></div>
<div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ns = 0; ns &lt; nsims; ns++) {</div>
<div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160;      <a class="code" href="a00286.html#a52e8c83d9dad55f9a6b967e63dc5f4bc">CalculateError</a>(&amp;(sim[ns].solver),</div>
<div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160;                     &amp;(sim[ns].mpi) );</div>
<div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;    }</div>
<div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160;</div>
<div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160;    <span class="keywordflow">if</span> (!rank) {</div>
<div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160;      printf( <span class="stringliteral">&quot;libROM: total prediction/query wallclock time: %f (seconds).\n&quot;</span>,</div>
<div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160;              total_rom_predict_time );</div>
<div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160;    }</div>
<div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160;</div>
<div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160;  }</div>
<div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160;</div>
<div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160;  <span class="keyword">delete</span> ((<a class="code" href="a00195.html">libROMInterface</a>*)context.<a class="code" href="a00203.html#af8049501def09c2e14fbec0a72c8c66c">rom_interface</a>);</div>
<div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160;<span class="preprocessor"></span></div>
<div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160;  PetscFunctionReturn(0);</div>
<div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160;}</div>
<div class="ttc" id="a00559_html_a11343894048fd842093253bbbb407700"><div class="ttname"><a href="a00559.html#a11343894048fd842093253bbbb407700">OutputROMSolution</a></div><div class="ttdeci">int OutputROMSolution(void *s, int nsims)</div><div class="ttdef"><b>Definition:</b> <a href="a00559_source.html#l00024">OutputROMSolution.c:24</a></div></div>
<div class="ttc" id="a00203_html_ad62e14c19e38497048380c4a7fe10e12"><div class="ttname"><a href="a00203.html#ad62e14c19e38497048380c4a7fe10e12">PETScContext::jfnk_eps</a></div><div class="ttdeci">double jfnk_eps</div><div class="ttdef"><b>Definition:</b> <a href="a00203_source.html#l00112">petscinterface_struct.h:112</a></div></div>
<div class="ttc" id="a00208_html_a4afd2c7b3eb8fda452474ebdbe71c8c0"><div class="ttname"><a href="a00208.html#a4afd2c7b3eb8fda452474ebdbe71c8c0">SimulationObject::mpi</a></div><div class="ttdeci">MPIVariables mpi</div><div class="ttdef"><b>Definition:</b> <a href="a00208_source.html#l00025">simulation_object.h:25</a></div></div>
<div class="ttc" id="a00203_html_a9a0e87291e0e8b9c1445e5482e814c92"><div class="ttname"><a href="a00203.html#a9a0e87291e0e8b9c1445e5482e814c92">PETScContext::nsims</a></div><div class="ttdeci">int nsims</div><div class="ttdef"><b>Definition:</b> <a href="a00203_source.html#l00053">petscinterface_struct.h:53</a></div></div>
<div class="ttc" id="a00203_html_aad212f0cfa337a32e39d307f8708eca7"><div class="ttname"><a href="a00203.html#aad212f0cfa337a32e39d307f8708eca7">_IMPLICIT_</a></div><div class="ttdeci">#define _IMPLICIT_</div><div class="ttdef"><b>Definition:</b> <a href="a00203_source.html#l00028">petscinterface_struct.h:28</a></div></div>
<div class="ttc" id="a00194_html_a0805db42e429173752189696c3c96909"><div class="ttname"><a href="a00194.html#a0805db42e429173752189696c3c96909">HyPar::filename_index</a></div><div class="ttdeci">char * filename_index</div><div class="ttdef"><b>Definition:</b> <a href="a00224_source.html#l00186">hypar.h:186</a></div></div>
<div class="ttc" id="a00194_html_aa989ebb755986852177779cdf7bd8c85"><div class="ttname"><a href="a00194.html#aa989ebb755986852177779cdf7bd8c85">HyPar::dim_global</a></div><div class="ttdeci">int * dim_global</div><div class="ttdef"><b>Definition:</b> <a href="a00224_source.html#l00032">hypar.h:32</a></div></div>
<div class="ttc" id="a00208_html_a00626"><div class="ttname"><a href="a00208.html#a00626">SimulationObject</a></div><div class="ttdoc">Structure defining a simulation. </div><div class="ttdef"><b>Definition:</b> <a href="a00208_source.html#l00023">simulation_object.h:23</a></div></div>
<div class="ttc" id="a00203_html_ae1766c1c76f0ef119388c4fa8a6d64f4"><div class="ttname"><a href="a00203.html#ae1766c1c76f0ef119388c4fa8a6d64f4">PETScContext::rom_mode</a></div><div class="ttdeci">std::string rom_mode</div><div class="ttdef"><b>Definition:</b> <a href="a00203_source.html#l00135">petscinterface_struct.h:135</a></div></div>
<div class="ttc" id="a00203_html_a22ceb3bed48bc42e41131982f61a839f"><div class="ttname"><a href="a00203.html#a22ceb3bed48bc42e41131982f61a839f">PETScContext::stage_times</a></div><div class="ttdeci">std::vector&lt; double &gt; stage_times</div><div class="ttdef"><b>Definition:</b> <a href="a00203_source.html#l00068">petscinterface_struct.h:68</a></div></div>
<div class="ttc" id="a00203_html_aac65a15cdd8e87c5c788db46e1ca0347"><div class="ttname"><a href="a00203.html#aac65a15cdd8e87c5c788db46e1ca0347">PETScContext::op_times_arr</a></div><div class="ttdeci">std::vector&lt; double &gt; op_times_arr</div><div class="ttdef"><b>Definition:</b> <a href="a00203_source.html#l00137">petscinterface_struct.h:137</a></div></div>
<div class="ttc" id="a00194_html_aaacee284a041d53cf335ae299d5eb929"><div class="ttname"><a href="a00194.html#aaacee284a041d53cf335ae299d5eb929">HyPar::rom_diff_norms</a></div><div class="ttdeci">double rom_diff_norms[3]</div><div class="ttdef"><b>Definition:</b> <a href="a00224_source.html#l00381">hypar.h:381</a></div></div>
<div class="ttc" id="a00236_html_ad1f357f94c228ba9ff45275064ca162b"><div class="ttname"><a href="a00236.html#ad1f357f94c228ba9ff45275064ca162b">PetscPostStage</a></div><div class="ttdeci">PetscErrorCode PetscPostStage(TS, PetscReal, PetscInt, Vec *)</div><div class="ttdef"><b>Definition:</b> <a href="a00383_source.html#l00016">PetscPostStage.cpp:16</a></div></div>
<div class="ttc" id="a00203_html_a28e4e78c0bf258662bef21d26c51fc0b"><div class="ttname"><a href="a00203.html#a28e4e78c0bf258662bef21d26c51fc0b">PETScContext::waqt</a></div><div class="ttdeci">double waqt</div><div class="ttdef"><b>Definition:</b> <a href="a00203_source.html#l00059">petscinterface_struct.h:59</a></div></div>
<div class="ttc" id="a00203_html_a15d26af821c0659b0c602303c371405e"><div class="ttname"><a href="a00203.html#a15d26af821c0659b0c602303c371405e">PETScContext::globalDOF</a></div><div class="ttdeci">std::vector&lt; double * &gt; globalDOF</div><div class="ttdef"><b>Definition:</b> <a href="a00203_source.html#l00120">petscinterface_struct.h:120</a></div></div>
<div class="ttc" id="a00236_html_abed41de2efef801be98f8338aa2672f2"><div class="ttname"><a href="a00236.html#abed41de2efef801be98f8338aa2672f2">PetscJacobianFunction_Linear</a></div><div class="ttdeci">PetscErrorCode PetscJacobianFunction_Linear(Mat, Vec, Vec)</div><div class="ttdef"><b>Definition:</b> <a href="a00381_source.html#l00236">PetscIJacobian.cpp:236</a></div></div>
<div class="ttc" id="a00203_html_a200f63fcca813d56a5cf3209546cedb2"><div class="ttname"><a href="a00203.html#a200f63fcca813d56a5cf3209546cedb2">PETScContext::flag_is_linear</a></div><div class="ttdeci">int flag_is_linear</div><div class="ttdef"><b>Definition:</b> <a href="a00203_source.html#l00109">petscinterface_struct.h:109</a></div></div>
<div class="ttc" id="a00227_html_a3035c57e07a432c8274e63259a0d506d"><div class="ttname"><a href="a00227.html#a3035c57e07a432c8274e63259a0d506d">_ROM_MODE_PREDICT_</a></div><div class="ttdeci">#define _ROM_MODE_PREDICT_</div><div class="ttdef"><b>Definition:</b> <a href="a00227_source.html#l00016">librom_interface.h:16</a></div></div>
<div class="ttc" id="a00384_html_a5981de613724cb667e98aa872157534e"><div class="ttname"><a href="a00384.html#a5981de613724cb667e98aa872157534e">OutputSolution</a></div><div class="ttdeci">int OutputSolution(void *, int)</div><div class="ttdef"><b>Definition:</b> <a href="a00560_source.html#l00022">OutputSolution.c:22</a></div></div>
<div class="ttc" id="a00236_html_ae4a99505d5f322bfc1c590e3d31fcc0b"><div class="ttname"><a href="a00236.html#ae4a99505d5f322bfc1c590e3d31fcc0b">PetscCreatePointList</a></div><div class="ttdeci">int PetscCreatePointList(void *)</div><div class="ttdef"><b>Definition:</b> <a href="a00377_source.html#l00025">PetscCreatePointList.cpp:25</a></div></div>
<div class="ttc" id="a00203_html_afdccc5dc654297cee401e0938ffb7985"><div class="ttname"><a href="a00203.html#afdccc5dc654297cee401e0938ffb7985">PETScContext::ti_runtime</a></div><div class="ttdeci">double ti_runtime</div><div class="ttdef"><b>Definition:</b> <a href="a00203_source.html#l00129">petscinterface_struct.h:129</a></div></div>
<div class="ttc" id="a00194_html_a6ff746b30ee55a3bbb9f3306c145f27a"><div class="ttname"><a href="a00194.html#a6ff746b30ee55a3bbb9f3306c145f27a">HyPar::file_op_iter</a></div><div class="ttdeci">int file_op_iter</div><div class="ttdef"><b>Definition:</b> <a href="a00224_source.html#l00163">hypar.h:163</a></div></div>
<div class="ttc" id="a00236_html_a91eb21ee4374b79a74f413d926344d7e"><div class="ttname"><a href="a00236.html#a91eb21ee4374b79a74f413d926344d7e">PetscRHSFunctionImpl</a></div><div class="ttdeci">PetscErrorCode PetscRHSFunctionImpl(TS, PetscReal, Vec, Vec, void *)</div><div class="ttdef"><b>Definition:</b> <a href="a00390_source.html#l00037">PetscRHSFunctionImpl.cpp:37</a></div></div>
<div class="ttc" id="a00236_html_a3d6a695a879ec54937525109ac912355"><div class="ttname"><a href="a00236.html#a3d6a695a879ec54937525109ac912355">PetscIJacobian</a></div><div class="ttdeci">PetscErrorCode PetscIJacobian(TS, PetscReal, Vec, Vec, PetscReal, Mat, Mat, void *)</div><div class="ttdef"><b>Definition:</b> <a href="a00381_source.html#l00052">PetscIJacobian.cpp:52</a></div></div>
<div class="ttc" id="a00194_html_a3b6b999a764f1e2ea94bb5f28c7a558c"><div class="ttname"><a href="a00194.html#a3b6b999a764f1e2ea94bb5f28c7a558c">HyPar::u</a></div><div class="ttdeci">double * u</div><div class="ttdef"><b>Definition:</b> <a href="a00224_source.html#l00108">hypar.h:108</a></div></div>
<div class="ttc" id="a00194_html_aafc992b5fa79d5a4036024615d03bce6"><div class="ttname"><a href="a00194.html#aafc992b5fa79d5a4036024615d03bce6">HyPar::ghosts</a></div><div class="ttdeci">int ghosts</div><div class="ttdef"><b>Definition:</b> <a href="a00224_source.html#l00044">hypar.h:44</a></div></div>
<div class="ttc" id="a00194_html_aafb41b96563d9966e8e9f458751f2960"><div class="ttname"><a href="a00194.html#aafb41b96563d9966e8e9f458751f2960">HyPar::restart_iter</a></div><div class="ttdeci">int restart_iter</div><div class="ttdef"><b>Definition:</b> <a href="a00224_source.html#l00050">hypar.h:50</a></div></div>
<div class="ttc" id="a00236_html_a6c64bea980c3a8b0a752113bbeb40cf3"><div class="ttname"><a href="a00236.html#a6c64bea980c3a8b0a752113bbeb40cf3">TransferVecToPETSc</a></div><div class="ttdeci">int TransferVecToPETSc(const double *const, Vec, void *, const int, const int)</div><div class="ttdef"><b>Definition:</b> <a href="a00393_source.html#l00024">TransferToPETSc.cpp:24</a></div></div>
<div class="ttc" id="a00236_html_a9d093c3140369a1178dd5b9589a926b1"><div class="ttname"><a href="a00236.html#a9d093c3140369a1178dd5b9589a926b1">PetscIFunctionIMEX</a></div><div class="ttdeci">PetscErrorCode PetscIFunctionIMEX(TS, PetscReal, Vec, Vec, Vec, void *)</div><div class="ttdef"><b>Definition:</b> <a href="a00380_source.html#l00053">PetscIFunctionIMEX.cpp:53</a></div></div>
<div class="ttc" id="a00203_html_a376b6b34e162357d201827d01a5aa2a4"><div class="ttname"><a href="a00203.html#a376b6b34e162357d201827d01a5aa2a4">PETScContext::flag_hyperbolic</a></div><div class="ttdeci">int flag_hyperbolic</div><div class="ttdef"><b>Definition:</b> <a href="a00203_source.html#l00095">petscinterface_struct.h:95</a></div></div>
<div class="ttc" id="a00194_html_ac92c34fe456d92c694eacd2231f5a7b1"><div class="ttname"><a href="a00194.html#ac92c34fe456d92c694eacd2231f5a7b1">HyPar::ConservationCheck</a></div><div class="ttdeci">char ConservationCheck[_MAX_STRING_SIZE_]</div><div class="ttdef"><b>Definition:</b> <a href="a00224_source.html#l00352">hypar.h:352</a></div></div>
<div class="ttc" id="a00203_html_a21b4785029b7597816341479bc3260b4"><div class="ttname"><a href="a00203.html#a21b4785029b7597816341479bc3260b4">PETScContext::flag_hyperbolic_df</a></div><div class="ttdeci">int flag_hyperbolic_df</div><div class="ttdef"><b>Definition:</b> <a href="a00203_source.html#l00099">petscinterface_struct.h:99</a></div></div>
<div class="ttc" id="a00227_html_a8d7f058ce028038a98a49ad28176390e"><div class="ttname"><a href="a00227.html#a8d7f058ce028038a98a49ad28176390e">_ROM_MODE_TRAIN_</a></div><div class="ttdeci">#define _ROM_MODE_TRAIN_</div><div class="ttdef"><b>Definition:</b> <a href="a00227_source.html#l00014">librom_interface.h:14</a></div></div>
<div class="ttc" id="a00236_html_ace222db5eadd0e0bd27229641e43fa9b"><div class="ttname"><a href="a00236.html#ace222db5eadd0e0bd27229641e43fa9b">PetscPreTimeStep</a></div><div class="ttdeci">PetscErrorCode PetscPreTimeStep(TS)</div><div class="ttdef"><b>Definition:</b> <a href="a00386_source.html#l00024">PetscPreTimeStep.cpp:24</a></div></div>
<div class="ttc" id="a00194_html_a03e28be41881b703c836edbfe9b51b17"><div class="ttname"><a href="a00194.html#a03e28be41881b703c836edbfe9b51b17">HyPar::dt</a></div><div class="ttdeci">double dt</div><div class="ttdef"><b>Definition:</b> <a href="a00224_source.html#l00059">hypar.h:59</a></div></div>
<div class="ttc" id="a00195_html"><div class="ttname"><a href="a00195.html">libROMInterface</a></div><div class="ttdoc">Class implementing interface with libROM. </div><div class="ttdef"><b>Definition:</b> <a href="a00227_source.html#l00045">librom_interface.h:45</a></div></div>
<div class="ttc" id="a00203_html_a54c0451c4ae9650a54f54246f1f8823b"><div class="ttname"><a href="a00203.html#a54c0451c4ae9650a54f54246f1f8823b">PETScContext::flag_source</a></div><div class="ttdeci">int flag_source</div><div class="ttdef"><b>Definition:</b> <a href="a00203_source.html#l00103">petscinterface_struct.h:103</a></div></div>
<div class="ttc" id="a00203_html_a6a0edd627a2b2cc687d1031e3884dd6a"><div class="ttname"><a href="a00203.html#a6a0edd627a2b2cc687d1031e3884dd6a">PETScContext::flag_hyperbolic_f</a></div><div class="ttdeci">int flag_hyperbolic_f</div><div class="ttdef"><b>Definition:</b> <a href="a00203_source.html#l00097">petscinterface_struct.h:97</a></div></div>
<div class="ttc" id="a00203_html_a578ef595dcbe28b2bde5c152c50f85e7"><div class="ttname"><a href="a00203.html#a578ef595dcbe28b2bde5c152c50f85e7">PETScContext::ndofs</a></div><div class="ttdeci">int ndofs</div><div class="ttdef"><b>Definition:</b> <a href="a00203_source.html#l00082">petscinterface_struct.h:82</a></div></div>
<div class="ttc" id="a00236_html_ac67533553372ed2b44b32d095c775f5c"><div class="ttname"><a href="a00236.html#ac67533553372ed2b44b32d095c775f5c">PetscRHSFunctionExpl</a></div><div class="ttdeci">PetscErrorCode PetscRHSFunctionExpl(TS, PetscReal, Vec, Vec, void *)</div><div class="ttdef"><b>Definition:</b> <a href="a00388_source.html#l00036">PetscRHSFunctionExpl.cpp:36</a></div></div>
<div class="ttc" id="a00194_html_ab4c55736e92f7d72f04b8a957d82b054"><div class="ttname"><a href="a00194.html#ab4c55736e92f7d72f04b8a957d82b054">HyPar::PhysicsOutput</a></div><div class="ttdeci">int(* PhysicsOutput)(void *, void *)</div><div class="ttdef"><b>Definition:</b> <a href="a00224_source.html#l00323">hypar.h:323</a></div></div>
<div class="ttc" id="a00203_html_ae68326adc3b3862f1162832f70727b06"><div class="ttname"><a href="a00203.html#ae68326adc3b3862f1162832f70727b06">PETScContext::nproc</a></div><div class="ttdeci">int nproc</div><div class="ttdef"><b>Definition:</b> <a href="a00203_source.html#l00047">petscinterface_struct.h:47</a></div></div>
<div class="ttc" id="a00197_html_a00622"><div class="ttname"><a href="a00197.html#a00622">MPIVariables</a></div><div class="ttdoc">Structure of MPI-related variables. </div><div class="ttdef"><b>Definition:</b> <a href="a00197_source.html#l00024">mpivars_struct.h:24</a></div></div>
<div class="ttc" id="a00227_html_a28e9ddc4d69c4a09fda0f0f39726ba16"><div class="ttname"><a href="a00227.html#a28e9ddc4d69c4a09fda0f0f39726ba16">_ROM_MODE_NONE_</a></div><div class="ttdeci">#define _ROM_MODE_NONE_</div><div class="ttdef"><b>Definition:</b> <a href="a00227_source.html#l00012">librom_interface.h:12</a></div></div>
<div class="ttc" id="a00236_html_a68f5a93a79d56fcb964224f649af4ac9"><div class="ttname"><a href="a00236.html#a68f5a93a79d56fcb964224f649af4ac9">PetscJacobianFunction_JFNK</a></div><div class="ttdeci">PetscErrorCode PetscJacobianFunction_JFNK(Mat, Vec, Vec)</div><div class="ttdef"><b>Definition:</b> <a href="a00381_source.html#l00111">PetscIJacobian.cpp:111</a></div></div>
<div class="ttc" id="a00203_html_ac48ad2561e5e125d2789133e848db1d9"><div class="ttname"><a href="a00203.html#ac48ad2561e5e125d2789133e848db1d9">PETScContext::flag_parabolic</a></div><div class="ttdeci">int flag_parabolic</div><div class="ttdef"><b>Definition:</b> <a href="a00203_source.html#l00101">petscinterface_struct.h:101</a></div></div>
<div class="ttc" id="a00203_html_a6cfd95afd0afebd625b889fb6e58371c"><div class="ttname"><a href="a00203.html#a6cfd95afd0afebd625b889fb6e58371c">PETScContext::rank</a></div><div class="ttdeci">int rank</div><div class="ttdef"><b>Definition:</b> <a href="a00203_source.html#l00044">petscinterface_struct.h:44</a></div></div>
<div class="ttc" id="a00208_html_a523947ce4fa7128c4c767163953253b9"><div class="ttname"><a href="a00208.html#a523947ce4fa7128c4c767163953253b9">SimulationObject::solver</a></div><div class="ttdeci">HyPar solver</div><div class="ttdef"><b>Definition:</b> <a href="a00208_source.html#l00026">simulation_object.h:26</a></div></div>
<div class="ttc" id="a00236_html_a3f7397f8cd5e90306fb7f02edecb3782"><div class="ttname"><a href="a00236.html#a3f7397f8cd5e90306fb7f02edecb3782">PetscPostTimeStep</a></div><div class="ttdeci">PetscErrorCode PetscPostTimeStep(TS)</div><div class="ttdef"><b>Definition:</b> <a href="a00384_source.html#l00021">PetscPostTimeStep.cpp:21</a></div></div>
<div class="ttc" id="a00203_html_a3968caf0290e18143989738dd36f2623"><div class="ttname"><a href="a00203.html#a3968caf0290e18143989738dd36f2623">PETScContext::points</a></div><div class="ttdeci">std::vector&lt; int * &gt; points</div><div class="ttdef"><b>Definition:</b> <a href="a00203_source.html#l00088">petscinterface_struct.h:88</a></div></div>
<div class="ttc" id="a00236_html_a82aacb94c1481144ce3e43d40d1f04d4"><div class="ttname"><a href="a00236.html#a82aacb94c1481144ce3e43d40d1f04d4">PetscIJacobianIMEX</a></div><div class="ttdeci">PetscErrorCode PetscIJacobianIMEX(TS, PetscReal, Vec, Vec, PetscReal, Mat, Mat, void *)</div><div class="ttdef"><b>Definition:</b> <a href="a00382_source.html#l00061">PetscIJacobianIMEX.cpp:61</a></div></div>
<div class="ttc" id="a00203_html_af8049501def09c2e14fbec0a72c8c66c"><div class="ttname"><a href="a00203.html#af8049501def09c2e14fbec0a72c8c66c">PETScContext::rom_interface</a></div><div class="ttdeci">void * rom_interface</div><div class="ttdef"><b>Definition:</b> <a href="a00203_source.html#l00133">petscinterface_struct.h:133</a></div></div>
<div class="ttc" id="a00236_html_a9f443ff08a9a8852ab1e9cabb793ddaa"><div class="ttname"><a href="a00236.html#a9f443ff08a9a8852ab1e9cabb793ddaa">TransferVecFromPETSc</a></div><div class="ttdeci">int TransferVecFromPETSc(double *const, const Vec, void *, const int, const int)</div><div class="ttdef"><b>Definition:</b> <a href="a00392_source.html#l00023">TransferFromPETSc.cpp:23</a></div></div>
<div class="ttc" id="a00203_html_a4e2f35037563217c8dc84c095af9e35f"><div class="ttname"><a href="a00203.html#a4e2f35037563217c8dc84c095af9e35f">PETScContext::simobj</a></div><div class="ttdeci">void * simobj</div><div class="ttdef"><b>Definition:</b> <a href="a00203_source.html#l00050">petscinterface_struct.h:50</a></div></div>
<div class="ttc" id="a00194_html_ae8f6d2fd6490d3153cb4133bf183a404"><div class="ttname"><a href="a00194.html#ae8f6d2fd6490d3153cb4133bf183a404">HyPar::nvars</a></div><div class="ttdeci">int nvars</div><div class="ttdef"><b>Definition:</b> <a href="a00224_source.html#l00029">hypar.h:29</a></div></div>
<div class="ttc" id="a00236_html_ae4815491f5992839fdb3949e5dedec8e"><div class="ttname"><a href="a00236.html#ae4815491f5992839fdb3949e5dedec8e">PetscGlobalDOF</a></div><div class="ttdeci">int PetscGlobalDOF(void *)</div><div class="ttdef"><b>Definition:</b> <a href="a00379_source.html#l00069">PetscGlobalDOF.cpp:69</a></div></div>
<div class="ttc" id="a00286_html_a52e8c83d9dad55f9a6b967e63dc5f4bc"><div class="ttname"><a href="a00286.html#a52e8c83d9dad55f9a6b967e63dc5f4bc">CalculateError</a></div><div class="ttdeci">int CalculateError(void *s, void *m)</div><div class="ttdef"><b>Definition:</b> <a href="a00286_source.html#l00025">CalculateError.c:25</a></div></div>
<div class="ttc" id="a00291_html_ad22799259c966d7dcc526452eaf7e855"><div class="ttname"><a href="a00291.html#ad22799259c966d7dcc526452eaf7e855">ResetFilenameIndex</a></div><div class="ttdeci">void ResetFilenameIndex(char *f, int len)</div><div class="ttdef"><b>Definition:</b> <a href="a00291_source.html#l00064">IncrementFilename.c:64</a></div></div>
<div class="ttc" id="a00203_html_a00625"><div class="ttname"><a href="a00203.html#a00625">PETScContext</a></div><div class="ttdoc">Structure containing the variables for time-integration with PETSc. </div><div class="ttdef"><b>Definition:</b> <a href="a00203_source.html#l00041">petscinterface_struct.h:41</a></div></div>
<div class="ttc" id="a00194_html_af0d8e0d5d3de3869b941b66b6caaf964"><div class="ttname"><a href="a00194.html#af0d8e0d5d3de3869b941b66b6caaf964">HyPar::n_iter</a></div><div class="ttdeci">int n_iter</div><div class="ttdef"><b>Definition:</b> <a href="a00224_source.html#l00047">hypar.h:47</a></div></div>
<div class="ttc" id="a00203_html_a34cbd56d5136d5e8b5ea2cbb901c04cd"><div class="ttname"><a href="a00203.html#a34cbd56d5136d5e8b5ea2cbb901c04cd">PETScContext::tic</a></div><div class="ttdeci">int tic</div><div class="ttdef"><b>Definition:</b> <a href="a00203_source.html#l00074">petscinterface_struct.h:74</a></div></div>
<div class="ttc" id="a00236_html_a52781b615afd6404c69c93dd0aa82924"><div class="ttname"><a href="a00236.html#a52781b615afd6404c69c93dd0aa82924">PetscCleanup</a></div><div class="ttdeci">int PetscCleanup(void *)</div><div class="ttdef"><b>Definition:</b> <a href="a00374_source.html#l00012">PetscCleanup.cpp:12</a></div></div>
<div class="ttc" id="a00236_html_ac7d9b0a219eb22bfd37482b741bd79c9"><div class="ttname"><a href="a00236.html#ac7d9b0a219eb22bfd37482b741bd79c9">PetscRHSFunctionIMEX</a></div><div class="ttdeci">PetscErrorCode PetscRHSFunctionIMEX(TS, PetscReal, Vec, Vec, void *)</div><div class="ttdef"><b>Definition:</b> <a href="a00389_source.html#l00049">PetscRHSFunctionIMEX.cpp:49</a></div></div>
<div class="ttc" id="a00236_html_a005fac516715e5fb65baa1540a79c82c"><div class="ttname"><a href="a00236.html#a005fac516715e5fb65baa1540a79c82c">PetscRegisterTIMethods</a></div><div class="ttdeci">int PetscRegisterTIMethods(int)</div><div class="ttdef"><b>Definition:</b> <a href="a00387_source.html#l00046">PetscRegisterTIMethods.cpp:46</a></div></div>
<div class="ttc" id="a00194_html_a711aad4cbe735871dd9e91ab575c878b"><div class="ttname"><a href="a00194.html#a711aad4cbe735871dd9e91ab575c878b">HyPar::x</a></div><div class="ttdeci">double * x</div><div class="ttdef"><b>Definition:</b> <a href="a00224_source.html#l00099">hypar.h:99</a></div></div>
<div class="ttc" id="a00236_html_a8778c346e27f42f0583c63909c2ea544"><div class="ttname"><a href="a00236.html#a8778c346e27f42f0583c63909c2ea544">PetscJacobianFunctionIMEX_Linear</a></div><div class="ttdeci">PetscErrorCode PetscJacobianFunctionIMEX_Linear(Mat, Vec, Vec)</div><div class="ttdef"><b>Definition:</b> <a href="a00382_source.html#l00290">PetscIJacobianIMEX.cpp:290</a></div></div>
<div class="ttc" id="a00203_html_a03e28be41881b703c836edbfe9b51b17"><div class="ttname"><a href="a00203.html#a03e28be41881b703c836edbfe9b51b17">PETScContext::dt</a></div><div class="ttdeci">double dt</div><div class="ttdef"><b>Definition:</b> <a href="a00203_source.html#l00065">petscinterface_struct.h:65</a></div></div>
<div class="ttc" id="a00287_html_accb3d8778a793486e72e06f817ef16fc"><div class="ttname"><a href="a00287.html#accb3d8778a793486e72e06f817ef16fc">CalculateROMDiff</a></div><div class="ttdeci">int CalculateROMDiff(void *s, void *m)</div><div class="ttdef"><b>Definition:</b> <a href="a00287_source.html#l00024">CalculateROMDiff.c:24</a></div></div>
<div class="ttc" id="a00236_html_ac08ff8a5b9eaa1841e573df91789801e"><div class="ttname"><a href="a00236.html#ac08ff8a5b9eaa1841e573df91789801e">PetscSetInitialGuessROM</a></div><div class="ttdeci">PetscErrorCode PetscSetInitialGuessROM(SNES, Vec, void *)</div><div class="ttdef"><b>Definition:</b> <a href="a00391_source.html#l00018">PetscSetInitialGuessROM.cpp:18</a></div></div>
<div class="ttc" id="a00194_html"><div class="ttname"><a href="a00194.html">HyPar</a></div><div class="ttdoc">Structure containing all solver-specific variables and functions. </div><div class="ttdef"><b>Definition:</b> <a href="a00224_source.html#l00023">hypar.h:23</a></div></div>
<div class="ttc" id="a00194_html_af474ca4577de91b658e4399ad0a6d7b3"><div class="ttname"><a href="a00194.html#af474ca4577de91b658e4399ad0a6d7b3">HyPar::index_length</a></div><div class="ttdeci">int index_length</div><div class="ttdef"><b>Definition:</b> <a href="a00224_source.html#l00188">hypar.h:188</a></div></div>
<div class="ttc" id="a00236_html_ab501847c597b0c20dff03d95a663b9b4"><div class="ttname"><a href="a00236.html#ab501847c597b0c20dff03d95a663b9b4">PetscTimeError</a></div><div class="ttdeci">PetscErrorCode PetscTimeError(TS)</div><div class="ttdef"><b>Definition:</b> <a href="a00378_source.html#l00020">PetscError.cpp:20</a></div></div>
<div class="ttc" id="a00236_html_a4edf057726501be3e8fe54e16fafe07b"><div class="ttname"><a href="a00236.html#a4edf057726501be3e8fe54e16fafe07b">PetscJacobianFunctionIMEX_JFNK</a></div><div class="ttdeci">PetscErrorCode PetscJacobianFunctionIMEX_JFNK(Mat, Vec, Vec)</div><div class="ttdef"><b>Definition:</b> <a href="a00382_source.html#l00128">PetscIJacobianIMEX.cpp:128</a></div></div>
<div class="ttc" id="a00194_html_a484873c74138512e41bc50d17b7d955a"><div class="ttname"><a href="a00194.html#a484873c74138512e41bc50d17b7d955a">HyPar::ndims</a></div><div class="ttdeci">int ndims</div><div class="ttdef"><b>Definition:</b> <a href="a00224_source.html#l00026">hypar.h:26</a></div></div>
<div class="ttc" id="a00203_html_ad55778d618804ddb359e18c9312c1454"><div class="ttname"><a href="a00203.html#ad55778d618804ddb359e18c9312c1454">PETScContext::stage_index</a></div><div class="ttdeci">int stage_index</div><div class="ttdef"><b>Definition:</b> <a href="a00203_source.html#l00071">petscinterface_struct.h:71</a></div></div>
<div class="ttc" id="a00194_html_a38e0371f331cecbe63a77fa03e202afe"><div class="ttname"><a href="a00194.html#a38e0371f331cecbe63a77fa03e202afe">HyPar::dim_local</a></div><div class="ttdeci">int * dim_local</div><div class="ttdef"><b>Definition:</b> <a href="a00224_source.html#l00035">hypar.h:35</a></div></div>
<div class="ttc" id="a00203_html_a377d0d14ec878aeb4deed4a0533e213d"><div class="ttname"><a href="a00203.html#a377d0d14ec878aeb4deed4a0533e213d">_EXPLICIT_</a></div><div class="ttdeci">#define _EXPLICIT_</div><div class="ttdef"><b>Definition:</b> <a href="a00203_source.html#l00026">petscinterface_struct.h:26</a></div></div>
<div class="ttc" id="a00227_html_acc2b61eb7c1bad16328d8f4be63b70f3"><div class="ttname"><a href="a00227.html#acc2b61eb7c1bad16328d8f4be63b70f3">_ROM_MODE_INITIAL_GUESS_</a></div><div class="ttdeci">#define _ROM_MODE_INITIAL_GUESS_</div><div class="ttdef"><b>Definition:</b> <a href="a00227_source.html#l00019">librom_interface.h:19</a></div></div>
<div class="ttc" id="a00225_html_aaf888c739c5200d9c58a7154347069b0"><div class="ttname"><a href="a00225.html#aaf888c739c5200d9c58a7154347069b0">WriteArray</a></div><div class="ttdeci">int WriteArray(int, int, int *, int *, int, double *, double *, void *, void *, char *)</div><div class="ttdef"><b>Definition:</b> <a href="a00342_source.html#l00027">WriteArray.c:27</a></div></div>
<div class="ttc" id="a00236_html_aa52bad03c15488a2119b794d0e70deed"><div class="ttname"><a href="a00236.html#aa52bad03c15488a2119b794d0e70deed">PetscPreStage</a></div><div class="ttdeci">PetscErrorCode PetscPreStage(TS, PetscReal)</div><div class="ttdef"><b>Definition:</b> <a href="a00385_source.html#l00014">PetscPreStage.cpp:14</a></div></div>
<div class="ttc" id="a00203_html_ad2182a08b22eed3bb3b0728725841875"><div class="ttname"><a href="a00203.html#ad2182a08b22eed3bb3b0728725841875">PETScContext::offsets</a></div><div class="ttdeci">int * offsets</div><div class="ttdef"><b>Definition:</b> <a href="a00203_source.html#l00091">petscinterface_struct.h:91</a></div></div>
<div class="ttc" id="a00203_html_a271fbbfea71118710d4a2fb13eb4c1cc"><div class="ttname"><a href="a00203.html#a271fbbfea71118710d4a2fb13eb4c1cc">PETScContext::flag_use_precon</a></div><div class="ttdeci">int flag_use_precon</div><div class="ttdef"><b>Definition:</b> <a href="a00203_source.html#l00106">petscinterface_struct.h:106</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a7347183ec04d39b43cf35d1fe68ace4d"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int Solve </td>
          <td>(</td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>s</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>nsims</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>rank</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>nproc</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Solve the PDE - time-integration</p>
<p>This function integrates the semi-discrete ODE (obtained from discretizing the PDE in space) using natively implemented time integration methods. It initializes the time integration object, iterates the simulation for the required number of time steps, and calculates the errors. After the specified number of iterations, it writes out some information to the screen and the solution to a file. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">s</td><td>Array of simulation objects of type <a class="el" href="a00208.html#a00626" title="Structure defining a simulation. ">SimulationObject</a> </td></tr>
    <tr><td class="paramname">nsims</td><td>number of simulation objects </td></tr>
    <tr><td class="paramname">rank</td><td>MPI rank of this process </td></tr>
    <tr><td class="paramname">nproc</td><td>Number of MPI processes </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="a00564_source.html#l00037">37</a> of file <a class="el" href="a00564_source.html">Solve.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;{</div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;  <a class="code" href="a00208.html#a00626">SimulationObject</a>* sim = (<a class="code" href="a00208.html#a00626">SimulationObject</a>*) s;</div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;</div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;  <span class="comment">/* make sure none of the simulation objects sent in the array </span></div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;<span class="comment">   * are &quot;barebones&quot; type */</span></div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ns = 0; ns &lt; nsims; ns++) {</div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;    <span class="keywordflow">if</span> (sim[ns].is_barebones == 1) {</div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;      fprintf(stderr, <span class="stringliteral">&quot;Error in Solve(): simulation object %d on rank %d is barebones!\n&quot;</span>,</div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;              ns, rank );</div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;      <span class="keywordflow">return</span> 1;</div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;    }</div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;  }</div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;</div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;  <span class="comment">/* write out iblank to file for visualization */</span></div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ns = 0; ns &lt; nsims; ns++) {</div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;    <span class="keywordflow">if</span> (sim[ns].solver.flag_ib) {</div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;</div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;      <span class="keywordtype">char</span> fname_root[<a class="code" href="a00218.html#a51efea86a4d76d1259893f606b776573">_MAX_STRING_SIZE_</a>] = <span class="stringliteral">&quot;iblank&quot;</span>;</div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;      <span class="keywordflow">if</span> (nsims &gt; 1) {</div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;        <span class="keywordtype">char</span> index[<a class="code" href="a00218.html#a51efea86a4d76d1259893f606b776573">_MAX_STRING_SIZE_</a>];</div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;        <a class="code" href="a00220.html#a3e3ad5aed581d9ae563190c365dadc41">GetStringFromInteger</a>(ns, index, (<span class="keywordtype">int</span>)log10((nsims)+1));</div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;        strcat(fname_root, <span class="stringliteral">&quot;_&quot;</span>);</div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;        strcat(fname_root, index);</div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;      }</div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;</div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;      <a class="code" href="a00225.html#aaf888c739c5200d9c58a7154347069b0">WriteArray</a>( sim[ns].solver.ndims,</div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;                  1,</div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;                  sim[ns].<a class="code" href="a00208.html#a523947ce4fa7128c4c767163953253b9">solver</a>.<a class="code" href="a00194.html#aa989ebb755986852177779cdf7bd8c85">dim_global</a>,</div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;                  sim[ns].<a class="code" href="a00208.html#a523947ce4fa7128c4c767163953253b9">solver</a>.<a class="code" href="a00194.html#a38e0371f331cecbe63a77fa03e202afe">dim_local</a>,</div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;                  sim[ns].<a class="code" href="a00208.html#a523947ce4fa7128c4c767163953253b9">solver</a>.<a class="code" href="a00194.html#aafc992b5fa79d5a4036024615d03bce6">ghosts</a>,</div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;                  sim[ns].<a class="code" href="a00208.html#a523947ce4fa7128c4c767163953253b9">solver</a>.<a class="code" href="a00194.html#a711aad4cbe735871dd9e91ab575c878b">x</a>,</div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;                  sim[ns].<a class="code" href="a00208.html#a523947ce4fa7128c4c767163953253b9">solver</a>.<a class="code" href="a00194.html#a267ef7e03dbe9dd4440dee2fdf48619a">iblank</a>,</div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;                  &amp;(sim[ns].<a class="code" href="a00208.html#a523947ce4fa7128c4c767163953253b9">solver</a>),</div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;                  &amp;(sim[ns].<a class="code" href="a00208.html#a4afd2c7b3eb8fda452474ebdbe71c8c0">mpi</a>),</div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;                  fname_root );</div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;    }</div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;  }</div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;</div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;<span class="preprocessor">#ifdef with_librom</span></div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;<span class="preprocessor"></span>  <span class="keywordflow">if</span> (!rank) printf(<span class="stringliteral">&quot;Setting up libROM interface.\n&quot;</span>);</div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;  <a class="code" href="a00195.html">libROMInterface</a> rom_interface( sim, nsims, rank, nproc, sim[0].solver.dt );</div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;  <span class="keyword">const</span> std::string&amp; rom_mode( rom_interface.mode() );</div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;  std::vector&lt;double&gt; op_times_arr(0);</div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;<span class="preprocessor"></span></div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;<span class="preprocessor">#ifdef with_librom</span></div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;<span class="preprocessor"></span>  <span class="keywordflow">if</span> ((rom_mode == <a class="code" href="a00227.html#a8d7f058ce028038a98a49ad28176390e">_ROM_MODE_TRAIN_</a>) || (rom_mode == <a class="code" href="a00227.html#a28e9ddc4d69c4a09fda0f0f39726ba16">_ROM_MODE_NONE_</a>)) {</div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;<span class="preprocessor"></span>    <span class="comment">/* Define and initialize the time-integration object */</span></div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;    <a class="code" href="a00211.html">TimeIntegration</a> TS;</div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;    <span class="keywordflow">if</span> (!rank) printf(<span class="stringliteral">&quot;Setting up time integration.\n&quot;</span>);</div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;    <a class="code" href="a00250.html#a2ca35809be0e351ff2ad94532c2c0d68">TimeInitialize</a>(sim, nsims, rank, nproc, &amp;TS);</div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;    <span class="keywordtype">double</span> ti_runtime = 0.0;</div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;</div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;    <span class="keywordflow">if</span> (!rank) printf(<span class="stringliteral">&quot;Solving in time (from %d to %d iterations)\n&quot;</span>,TS.<a class="code" href="a00211.html#aafb41b96563d9966e8e9f458751f2960">restart_iter</a>,TS.<a class="code" href="a00211.html#af0d8e0d5d3de3869b941b66b6caaf964">n_iter</a>);</div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;    <span class="keywordflow">for</span> (TS.<a class="code" href="a00211.html#aab6f168571c2073e01e240524b8a3da0">iter</a> = TS.<a class="code" href="a00211.html#aafb41b96563d9966e8e9f458751f2960">restart_iter</a>; TS.<a class="code" href="a00211.html#aab6f168571c2073e01e240524b8a3da0">iter</a> &lt; TS.<a class="code" href="a00211.html#af0d8e0d5d3de3869b941b66b6caaf964">n_iter</a>; TS.<a class="code" href="a00211.html#aab6f168571c2073e01e240524b8a3da0">iter</a>++) {</div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;  </div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;      <span class="comment">/* Write initial solution to file if this is the first iteration */</span></div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;      <span class="keywordflow">if</span> (!TS.<a class="code" href="a00211.html#aab6f168571c2073e01e240524b8a3da0">iter</a>) { </div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ns = 0; ns &lt; nsims; ns++) {</div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;          <span class="keywordflow">if</span> (sim[ns].solver.PhysicsOutput) {</div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;            sim[ns].<a class="code" href="a00208.html#a523947ce4fa7128c4c767163953253b9">solver</a>.<a class="code" href="a00194.html#ab4c55736e92f7d72f04b8a957d82b054">PhysicsOutput</a>( &amp;(sim[ns].solver),</div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;                                          &amp;(sim[ns].mpi) );</div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;          }</div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;        }</div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;        <a class="code" href="a00384.html#a5981de613724cb667e98aa872157534e">OutputSolution</a>(sim, nsims); </div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;<span class="preprocessor">#ifdef with_librom</span></div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;<span class="preprocessor"></span>        op_times_arr.push_back(TS.<a class="code" href="a00211.html#a28e4e78c0bf258662bef21d26c51fc0b">waqt</a>);</div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;<span class="preprocessor"></span>      }</div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;  </div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;<span class="preprocessor">#ifdef with_librom</span></div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;<span class="preprocessor"></span>      <span class="keywordflow">if</span> ((rom_mode == <a class="code" href="a00227.html#a8d7f058ce028038a98a49ad28176390e">_ROM_MODE_TRAIN_</a>) &amp;&amp; (TS.<a class="code" href="a00211.html#aab6f168571c2073e01e240524b8a3da0">iter</a>%rom_interface.samplingFrequency() == 0)) {</div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;        rom_interface.takeSample( sim, TS.<a class="code" href="a00211.html#a28e4e78c0bf258662bef21d26c51fc0b">waqt</a> );</div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;      }</div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;<span class="preprocessor"></span>  </div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;      <span class="comment">/* Call pre-step function */</span></div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;      <a class="code" href="a00250.html#a2afba6dcdd13eb929ad4cb54a71eb470">TimePreStep</a> (&amp;TS);</div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;<span class="preprocessor">#ifdef compute_rhs_operators</span></div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;<span class="preprocessor"></span>      <span class="comment">/* compute and write (to file) matrix operators representing the right-hand side */</span></div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;<span class="comment">//      if (((TS.iter+1)%solver-&gt;file_op_iter == 0) || (!TS.iter)) </span></div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;<span class="comment">//        { ComputeRHSOperators(solver,mpi,TS.waqt);</span></div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;<span class="preprocessor"></span>  </div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;      <span class="comment">/* Step in time */</span></div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;      <a class="code" href="a00250.html#acb00956b2e195653e3f8107b1ab1dc4d">TimeStep</a> (&amp;TS);</div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;  </div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;      <span class="comment">/* Call post-step function */</span></div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;      <a class="code" href="a00250.html#a25f8d76bc92804608cd299e63e23291c">TimePostStep</a> (&amp;TS);</div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;  </div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;      ti_runtime += TS.<a class="code" href="a00211.html#a92c7025356b89f3eb44829e9cb9f0b91">iter_wctime</a>;</div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;  </div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;      <span class="comment">/* Print information to screen */</span></div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;      <a class="code" href="a00250.html#aa1ffb2050f4788b7c49b4576a9fe52ca">TimePrintStep</a>(&amp;TS);</div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;  </div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;      <span class="comment">/* Write intermediate solution to file */</span></div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;      <span class="keywordflow">if</span> (      ((TS.<a class="code" href="a00211.html#aab6f168571c2073e01e240524b8a3da0">iter</a>+1)%sim[0].<a class="code" href="a00208.html#a523947ce4fa7128c4c767163953253b9">solver</a>.<a class="code" href="a00194.html#a6ff746b30ee55a3bbb9f3306c145f27a">file_op_iter</a> == 0) </div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;            &amp;&amp;  ((TS.<a class="code" href="a00211.html#aab6f168571c2073e01e240524b8a3da0">iter</a>+1) &lt; TS.<a class="code" href="a00211.html#af0d8e0d5d3de3869b941b66b6caaf964">n_iter</a>) ) { </div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ns = 0; ns &lt; nsims; ns++) {</div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;          <span class="keywordflow">if</span> (sim[ns].solver.PhysicsOutput) {</div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;            sim[ns].<a class="code" href="a00208.html#a523947ce4fa7128c4c767163953253b9">solver</a>.<a class="code" href="a00194.html#ab4c55736e92f7d72f04b8a957d82b054">PhysicsOutput</a>( &amp;(sim[ns].solver),</div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;                                          &amp;(sim[ns].mpi) );</div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;          }</div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;        }</div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;        <a class="code" href="a00384.html#a5981de613724cb667e98aa872157534e">OutputSolution</a>(sim, nsims); </div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;<span class="preprocessor">#ifdef with_librom</span></div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;<span class="preprocessor"></span>        op_times_arr.push_back(TS.<a class="code" href="a00211.html#a28e4e78c0bf258662bef21d26c51fc0b">waqt</a>);</div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;<span class="preprocessor"></span>      }</div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;  </div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;    }</div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;  </div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;    <span class="keywordtype">double</span> t_final = TS.<a class="code" href="a00211.html#a28e4e78c0bf258662bef21d26c51fc0b">waqt</a>;</div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;    <a class="code" href="a00250.html#a85984dec08cd43570151a625ab62f8d9">TimeCleanup</a>(&amp;TS);</div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;</div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;    <span class="keywordflow">if</span> (!rank) {</div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;      printf( <span class="stringliteral">&quot;Completed time integration (Final time: %f), total wctime: %f (seconds).\n&quot;</span>,</div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;              t_final, ti_runtime );</div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;      <span class="keywordflow">if</span> (nsims &gt; 1) printf(<span class="stringliteral">&quot;\n&quot;</span>);</div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;    }</div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;</div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;    <span class="comment">/* calculate error if exact solution has been provided */</span></div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ns = 0; ns &lt; nsims; ns++) {</div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;      <a class="code" href="a00286.html#a52e8c83d9dad55f9a6b967e63dc5f4bc">CalculateError</a>(&amp;(sim[ns].solver),</div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;                     &amp;(sim[ns].mpi) );</div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;    }</div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;</div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;    <span class="comment">/* write a final solution file */</span></div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ns = 0; ns &lt; nsims; ns++) {</div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;      <span class="keywordflow">if</span> (sim[ns].solver.PhysicsOutput) {</div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;        sim[ns].<a class="code" href="a00208.html#a523947ce4fa7128c4c767163953253b9">solver</a>.<a class="code" href="a00194.html#ab4c55736e92f7d72f04b8a957d82b054">PhysicsOutput</a>( &amp;(sim[ns].solver),</div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;                                      &amp;(sim[ns].mpi) );</div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;      }</div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;    }</div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;    <a class="code" href="a00384.html#a5981de613724cb667e98aa872157534e">OutputSolution</a>(sim, nsims); </div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;</div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;<span class="preprocessor">#ifdef with_librom</span></div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;<span class="preprocessor"></span>    op_times_arr.push_back(TS.<a class="code" href="a00211.html#a28e4e78c0bf258662bef21d26c51fc0b">waqt</a>);</div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;</div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ns = 0; ns &lt; nsims; ns++) {</div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;      <a class="code" href="a00291.html#ad22799259c966d7dcc526452eaf7e855">ResetFilenameIndex</a>( sim[ns].solver.filename_index, </div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;                          sim[ns].<a class="code" href="a00208.html#a523947ce4fa7128c4c767163953253b9">solver</a>.<a class="code" href="a00194.html#af474ca4577de91b658e4399ad0a6d7b3">index_length</a> );</div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;    }</div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;  </div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;    <span class="keywordflow">if</span> (rom_interface.mode() == <a class="code" href="a00227.html#a8d7f058ce028038a98a49ad28176390e">_ROM_MODE_TRAIN_</a>) {</div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;  </div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;      rom_interface.train();</div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;      <span class="keywordflow">if</span> (!rank) printf(<span class="stringliteral">&quot;libROM: total training wallclock time: %f (seconds).\n&quot;</span>, </div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;                        rom_interface.trainWallclockTime() );</div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;</div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;      <span class="keywordtype">double</span> total_rom_predict_time = 0;</div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> iter = 0; iter &lt; op_times_arr.size(); iter++) {</div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;  </div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;        <span class="keywordtype">double</span> waqt = op_times_arr[iter];</div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;  </div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;        rom_interface.predict(sim, waqt);</div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;        <span class="keywordflow">if</span> (!rank) printf(  <span class="stringliteral">&quot;libROM: Predicted solution at time %1.4e using ROM, wallclock time: %f.\n&quot;</span>, </div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;                            waqt, rom_interface.predictWallclockTime() );</div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;        total_rom_predict_time += rom_interface.predictWallclockTime();</div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;  </div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;        <span class="comment">/* calculate diff between ROM and PDE solutions */</span></div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;        <span class="keywordflow">if</span> (iter == (op_times_arr.size()-1)) {</div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;          <span class="keywordflow">if</span> (!rank) printf(<span class="stringliteral">&quot;libROM:   Calculating diff between PDE and ROM solutions.\n&quot;</span>);</div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;          <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ns = 0; ns &lt; nsims; ns++) {</div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;            <a class="code" href="a00287.html#accb3d8778a793486e72e06f817ef16fc">CalculateROMDiff</a>(  &amp;(sim[ns].solver),</div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;                               &amp;(sim[ns].mpi) );</div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;          }</div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;        }</div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;        <span class="comment">/* write the ROM solution to file */</span></div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;        <a class="code" href="a00559.html#a11343894048fd842093253bbbb407700">OutputROMSolution</a>(sim, nsims); </div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;  </div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;      }</div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;</div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;      <span class="keywordflow">if</span> (!rank) {</div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;        printf( <span class="stringliteral">&quot;libROM: total prediction/query wallclock time: %f (seconds).\n&quot;</span>,</div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;                total_rom_predict_time );</div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;      }</div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;</div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;      rom_interface.saveROM();</div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;</div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;</div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ns = 0; ns &lt; nsims; ns++) {</div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;        sim[ns].<a class="code" href="a00208.html#a523947ce4fa7128c4c767163953253b9">solver</a>.<a class="code" href="a00194.html#aaacee284a041d53cf335ae299d5eb929">rom_diff_norms</a>[0]</div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;          = sim[ns].<a class="code" href="a00208.html#a523947ce4fa7128c4c767163953253b9">solver</a>.<a class="code" href="a00194.html#aaacee284a041d53cf335ae299d5eb929">rom_diff_norms</a>[1]</div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;          = sim[ns].<a class="code" href="a00208.html#a523947ce4fa7128c4c767163953253b9">solver</a>.<a class="code" href="a00194.html#aaacee284a041d53cf335ae299d5eb929">rom_diff_norms</a>[2]</div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;          = -1;</div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;      }</div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;</div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;    }</div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;</div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;  } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (rom_mode == <a class="code" href="a00227.html#a3035c57e07a432c8274e63259a0d506d">_ROM_MODE_PREDICT_</a>) {</div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;</div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ns = 0; ns &lt; nsims; ns++) {</div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;      sim[ns].<a class="code" href="a00208.html#a523947ce4fa7128c4c767163953253b9">solver</a>.<a class="code" href="a00194.html#aaacee284a041d53cf335ae299d5eb929">rom_diff_norms</a>[0]</div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;        = sim[ns].<a class="code" href="a00208.html#a523947ce4fa7128c4c767163953253b9">solver</a>.<a class="code" href="a00194.html#aaacee284a041d53cf335ae299d5eb929">rom_diff_norms</a>[1]</div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;        = sim[ns].<a class="code" href="a00208.html#a523947ce4fa7128c4c767163953253b9">solver</a>.<a class="code" href="a00194.html#aaacee284a041d53cf335ae299d5eb929">rom_diff_norms</a>[2]</div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;        = -1;</div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;      strcpy(sim[ns].solver.ConservationCheck,<span class="stringliteral">&quot;no&quot;</span>);</div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;    }</div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;</div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;    rom_interface.loadROM();</div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;    rom_interface.projectInitialSolution(sim);</div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;</div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;    {</div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;      <span class="keywordtype">int</span> start_iter = sim[0].<a class="code" href="a00208.html#a523947ce4fa7128c4c767163953253b9">solver</a>.<a class="code" href="a00194.html#aafb41b96563d9966e8e9f458751f2960">restart_iter</a>;</div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;      <span class="keywordtype">int</span> n_iter = sim[0].<a class="code" href="a00208.html#a523947ce4fa7128c4c767163953253b9">solver</a>.<a class="code" href="a00194.html#af0d8e0d5d3de3869b941b66b6caaf964">n_iter</a>;</div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;      <span class="keywordtype">double</span> dt = sim[0].<a class="code" href="a00208.html#a523947ce4fa7128c4c767163953253b9">solver</a>.<a class="code" href="a00194.html#a03e28be41881b703c836edbfe9b51b17">dt</a>;</div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;  </div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;      <span class="keywordtype">double</span> cur_time = start_iter * dt;</div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;      op_times_arr.push_back(cur_time);</div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;  </div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> iter = start_iter; iter &lt; n_iter; iter++) {</div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;        cur_time += dt;</div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;        <span class="keywordflow">if</span> (    ( (iter+1)%sim[0].solver.file_op_iter == 0)</div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;            &amp;&amp;  ( (iter+1) &lt; n_iter) ) {</div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;          op_times_arr.push_back(cur_time);</div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;        }</div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;      }</div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;  </div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;      <span class="keywordtype">double</span> t_final = n_iter*dt;</div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;      op_times_arr.push_back(t_final);</div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;    }</div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;</div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;    <span class="keywordtype">double</span> total_rom_predict_time = 0;</div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> iter = 0; iter &lt; op_times_arr.size(); iter++) {</div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;  </div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;      <span class="keywordtype">double</span> waqt = op_times_arr[iter];</div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;  </div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;      rom_interface.predict(sim, waqt);</div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;      <span class="keywordflow">if</span> (!rank) printf(  <span class="stringliteral">&quot;libROM: Predicted solution at time %1.4e using ROM, wallclock time: %f.\n&quot;</span>, </div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;                          waqt, rom_interface.predictWallclockTime() );</div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;      total_rom_predict_time += rom_interface.predictWallclockTime();</div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;  </div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;      <span class="comment">/* write the solution to file */</span></div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ns = 0; ns &lt; nsims; ns++) {</div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;        <span class="keywordflow">if</span> (sim[ns].solver.PhysicsOutput) {</div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;          sim[ns].<a class="code" href="a00208.html#a523947ce4fa7128c4c767163953253b9">solver</a>.<a class="code" href="a00194.html#ab4c55736e92f7d72f04b8a957d82b054">PhysicsOutput</a>( &amp;(sim[ns].solver),</div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;                                        &amp;(sim[ns].mpi) );</div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;        }</div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;      }</div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;      <a class="code" href="a00384.html#a5981de613724cb667e98aa872157534e">OutputSolution</a>(sim, nsims); </div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;  </div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;    }</div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;</div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;    <span class="comment">/* calculate error if exact solution has been provided */</span></div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ns = 0; ns &lt; nsims; ns++) {</div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;      <a class="code" href="a00286.html#a52e8c83d9dad55f9a6b967e63dc5f4bc">CalculateError</a>(&amp;(sim[ns].solver),</div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;                     &amp;(sim[ns].mpi) );</div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;    }</div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;</div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;    <span class="keywordflow">if</span> (!rank) {</div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;      printf( <span class="stringliteral">&quot;libROM: total prediction/query wallclock time: %f (seconds).\n&quot;</span>,</div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;              total_rom_predict_time );</div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;    }</div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;</div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;  }</div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;<span class="preprocessor"></span></div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;  <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;}</div>
<div class="ttc" id="a00559_html_a11343894048fd842093253bbbb407700"><div class="ttname"><a href="a00559.html#a11343894048fd842093253bbbb407700">OutputROMSolution</a></div><div class="ttdeci">int OutputROMSolution(void *s, int nsims)</div><div class="ttdef"><b>Definition:</b> <a href="a00559_source.html#l00024">OutputROMSolution.c:24</a></div></div>
<div class="ttc" id="a00194_html_a267ef7e03dbe9dd4440dee2fdf48619a"><div class="ttname"><a href="a00194.html#a267ef7e03dbe9dd4440dee2fdf48619a">HyPar::iblank</a></div><div class="ttdeci">double * iblank</div><div class="ttdef"><b>Definition:</b> <a href="a00224_source.html#l00412">hypar.h:412</a></div></div>
<div class="ttc" id="a00208_html_a4afd2c7b3eb8fda452474ebdbe71c8c0"><div class="ttname"><a href="a00208.html#a4afd2c7b3eb8fda452474ebdbe71c8c0">SimulationObject::mpi</a></div><div class="ttdeci">MPIVariables mpi</div><div class="ttdef"><b>Definition:</b> <a href="a00208_source.html#l00025">simulation_object.h:25</a></div></div>
<div class="ttc" id="a00250_html_a2afba6dcdd13eb929ad4cb54a71eb470"><div class="ttname"><a href="a00250.html#a2afba6dcdd13eb929ad4cb54a71eb470">TimePreStep</a></div><div class="ttdeci">int TimePreStep(void *)</div><div class="ttdef"><b>Definition:</b> <a href="a00593_source.html#l00018">TimePreStep.c:18</a></div></div>
<div class="ttc" id="a00250_html_aa1ffb2050f4788b7c49b4576a9fe52ca"><div class="ttname"><a href="a00250.html#aa1ffb2050f4788b7c49b4576a9fe52ca">TimePrintStep</a></div><div class="ttdeci">int TimePrintStep(void *)</div><div class="ttdef"><b>Definition:</b> <a href="a00594_source.html#l00016">TimePrintStep.c:16</a></div></div>
<div class="ttc" id="a00211_html_a28e4e78c0bf258662bef21d26c51fc0b"><div class="ttname"><a href="a00211.html#a28e4e78c0bf258662bef21d26c51fc0b">TimeIntegration::waqt</a></div><div class="ttdeci">double waqt</div><div class="ttdef"><b>Definition:</b> <a href="a00189_source.html#l00037">timeintegration_struct.h:37</a></div></div>
<div class="ttc" id="a00194_html_aa989ebb755986852177779cdf7bd8c85"><div class="ttname"><a href="a00194.html#aa989ebb755986852177779cdf7bd8c85">HyPar::dim_global</a></div><div class="ttdeci">int * dim_global</div><div class="ttdef"><b>Definition:</b> <a href="a00224_source.html#l00032">hypar.h:32</a></div></div>
<div class="ttc" id="a00208_html_a00626"><div class="ttname"><a href="a00208.html#a00626">SimulationObject</a></div><div class="ttdoc">Structure defining a simulation. </div><div class="ttdef"><b>Definition:</b> <a href="a00208_source.html#l00023">simulation_object.h:23</a></div></div>
<div class="ttc" id="a00194_html_aaacee284a041d53cf335ae299d5eb929"><div class="ttname"><a href="a00194.html#aaacee284a041d53cf335ae299d5eb929">HyPar::rom_diff_norms</a></div><div class="ttdeci">double rom_diff_norms[3]</div><div class="ttdef"><b>Definition:</b> <a href="a00224_source.html#l00381">hypar.h:381</a></div></div>
<div class="ttc" id="a00227_html_a3035c57e07a432c8274e63259a0d506d"><div class="ttname"><a href="a00227.html#a3035c57e07a432c8274e63259a0d506d">_ROM_MODE_PREDICT_</a></div><div class="ttdeci">#define _ROM_MODE_PREDICT_</div><div class="ttdef"><b>Definition:</b> <a href="a00227_source.html#l00016">librom_interface.h:16</a></div></div>
<div class="ttc" id="a00384_html_a5981de613724cb667e98aa872157534e"><div class="ttname"><a href="a00384.html#a5981de613724cb667e98aa872157534e">OutputSolution</a></div><div class="ttdeci">int OutputSolution(void *, int)</div><div class="ttdef"><b>Definition:</b> <a href="a00560_source.html#l00022">OutputSolution.c:22</a></div></div>
<div class="ttc" id="a00250_html_a25f8d76bc92804608cd299e63e23291c"><div class="ttname"><a href="a00250.html#a25f8d76bc92804608cd299e63e23291c">TimePostStep</a></div><div class="ttdeci">int TimePostStep(void *)</div><div class="ttdef"><b>Definition:</b> <a href="a00592_source.html#l00024">TimePostStep.c:24</a></div></div>
<div class="ttc" id="a00194_html_a6ff746b30ee55a3bbb9f3306c145f27a"><div class="ttname"><a href="a00194.html#a6ff746b30ee55a3bbb9f3306c145f27a">HyPar::file_op_iter</a></div><div class="ttdeci">int file_op_iter</div><div class="ttdef"><b>Definition:</b> <a href="a00224_source.html#l00163">hypar.h:163</a></div></div>
<div class="ttc" id="a00211_html_af0d8e0d5d3de3869b941b66b6caaf964"><div class="ttname"><a href="a00211.html#af0d8e0d5d3de3869b941b66b6caaf964">TimeIntegration::n_iter</a></div><div class="ttdeci">int n_iter</div><div class="ttdef"><b>Definition:</b> <a href="a00189_source.html#l00033">timeintegration_struct.h:33</a></div></div>
<div class="ttc" id="a00211_html_aafb41b96563d9966e8e9f458751f2960"><div class="ttname"><a href="a00211.html#aafb41b96563d9966e8e9f458751f2960">TimeIntegration::restart_iter</a></div><div class="ttdeci">int restart_iter</div><div class="ttdef"><b>Definition:</b> <a href="a00189_source.html#l00035">timeintegration_struct.h:35</a></div></div>
<div class="ttc" id="a00194_html_aafc992b5fa79d5a4036024615d03bce6"><div class="ttname"><a href="a00194.html#aafc992b5fa79d5a4036024615d03bce6">HyPar::ghosts</a></div><div class="ttdeci">int ghosts</div><div class="ttdef"><b>Definition:</b> <a href="a00224_source.html#l00044">hypar.h:44</a></div></div>
<div class="ttc" id="a00194_html_aafb41b96563d9966e8e9f458751f2960"><div class="ttname"><a href="a00194.html#aafb41b96563d9966e8e9f458751f2960">HyPar::restart_iter</a></div><div class="ttdeci">int restart_iter</div><div class="ttdef"><b>Definition:</b> <a href="a00224_source.html#l00050">hypar.h:50</a></div></div>
<div class="ttc" id="a00250_html_acb00956b2e195653e3f8107b1ab1dc4d"><div class="ttname"><a href="a00250.html#acb00956b2e195653e3f8107b1ab1dc4d">TimeStep</a></div><div class="ttdeci">int TimeStep(void *)</div><div class="ttdef"><b>Definition:</b> <a href="a00597_source.html#l00012">TimeStep.c:12</a></div></div>
<div class="ttc" id="a00227_html_a8d7f058ce028038a98a49ad28176390e"><div class="ttname"><a href="a00227.html#a8d7f058ce028038a98a49ad28176390e">_ROM_MODE_TRAIN_</a></div><div class="ttdeci">#define _ROM_MODE_TRAIN_</div><div class="ttdef"><b>Definition:</b> <a href="a00227_source.html#l00014">librom_interface.h:14</a></div></div>
<div class="ttc" id="a00211_html_aab6f168571c2073e01e240524b8a3da0"><div class="ttname"><a href="a00211.html#aab6f168571c2073e01e240524b8a3da0">TimeIntegration::iter</a></div><div class="ttdeci">int iter</div><div class="ttdef"><b>Definition:</b> <a href="a00189_source.html#l00031">timeintegration_struct.h:31</a></div></div>
<div class="ttc" id="a00211_html_a92c7025356b89f3eb44829e9cb9f0b91"><div class="ttname"><a href="a00211.html#a92c7025356b89f3eb44829e9cb9f0b91">TimeIntegration::iter_wctime</a></div><div class="ttdeci">double iter_wctime</div><div class="ttdef"><b>Definition:</b> <a href="a00189_source.html#l00105">timeintegration_struct.h:105</a></div></div>
<div class="ttc" id="a00194_html_a03e28be41881b703c836edbfe9b51b17"><div class="ttname"><a href="a00194.html#a03e28be41881b703c836edbfe9b51b17">HyPar::dt</a></div><div class="ttdeci">double dt</div><div class="ttdef"><b>Definition:</b> <a href="a00224_source.html#l00059">hypar.h:59</a></div></div>
<div class="ttc" id="a00195_html"><div class="ttname"><a href="a00195.html">libROMInterface</a></div><div class="ttdoc">Class implementing interface with libROM. </div><div class="ttdef"><b>Definition:</b> <a href="a00227_source.html#l00045">librom_interface.h:45</a></div></div>
<div class="ttc" id="a00194_html_ab4c55736e92f7d72f04b8a957d82b054"><div class="ttname"><a href="a00194.html#ab4c55736e92f7d72f04b8a957d82b054">HyPar::PhysicsOutput</a></div><div class="ttdeci">int(* PhysicsOutput)(void *, void *)</div><div class="ttdef"><b>Definition:</b> <a href="a00224_source.html#l00323">hypar.h:323</a></div></div>
<div class="ttc" id="a00220_html_a3e3ad5aed581d9ae563190c365dadc41"><div class="ttname"><a href="a00220.html#a3e3ad5aed581d9ae563190c365dadc41">GetStringFromInteger</a></div><div class="ttdeci">void GetStringFromInteger(int, char *, int)</div><div class="ttdef"><b>Definition:</b> <a href="a00278_source.html#l00015">CommonFunctions.c:15</a></div></div>
<div class="ttc" id="a00227_html_a28e9ddc4d69c4a09fda0f0f39726ba16"><div class="ttname"><a href="a00227.html#a28e9ddc4d69c4a09fda0f0f39726ba16">_ROM_MODE_NONE_</a></div><div class="ttdeci">#define _ROM_MODE_NONE_</div><div class="ttdef"><b>Definition:</b> <a href="a00227_source.html#l00012">librom_interface.h:12</a></div></div>
<div class="ttc" id="a00208_html_a523947ce4fa7128c4c767163953253b9"><div class="ttname"><a href="a00208.html#a523947ce4fa7128c4c767163953253b9">SimulationObject::solver</a></div><div class="ttdeci">HyPar solver</div><div class="ttdef"><b>Definition:</b> <a href="a00208_source.html#l00026">simulation_object.h:26</a></div></div>
<div class="ttc" id="a00250_html_a2ca35809be0e351ff2ad94532c2c0d68"><div class="ttname"><a href="a00250.html#a2ca35809be0e351ff2ad94532c2c0d68">TimeInitialize</a></div><div class="ttdeci">int TimeInitialize(void *, int, int, int, void *)</div><div class="ttdef"><b>Definition:</b> <a href="a00591_source.html#l00024">TimeInitialize.c:24</a></div></div>
<div class="ttc" id="a00286_html_a52e8c83d9dad55f9a6b967e63dc5f4bc"><div class="ttname"><a href="a00286.html#a52e8c83d9dad55f9a6b967e63dc5f4bc">CalculateError</a></div><div class="ttdeci">int CalculateError(void *s, void *m)</div><div class="ttdef"><b>Definition:</b> <a href="a00286_source.html#l00025">CalculateError.c:25</a></div></div>
<div class="ttc" id="a00291_html_ad22799259c966d7dcc526452eaf7e855"><div class="ttname"><a href="a00291.html#ad22799259c966d7dcc526452eaf7e855">ResetFilenameIndex</a></div><div class="ttdeci">void ResetFilenameIndex(char *f, int len)</div><div class="ttdef"><b>Definition:</b> <a href="a00291_source.html#l00064">IncrementFilename.c:64</a></div></div>
<div class="ttc" id="a00194_html_af0d8e0d5d3de3869b941b66b6caaf964"><div class="ttname"><a href="a00194.html#af0d8e0d5d3de3869b941b66b6caaf964">HyPar::n_iter</a></div><div class="ttdeci">int n_iter</div><div class="ttdef"><b>Definition:</b> <a href="a00224_source.html#l00047">hypar.h:47</a></div></div>
<div class="ttc" id="a00211_html"><div class="ttname"><a href="a00211.html">TimeIntegration</a></div><div class="ttdoc">Structure of variables/parameters and function pointers for time integration. </div><div class="ttdef"><b>Definition:</b> <a href="a00189_source.html#l00029">timeintegration_struct.h:29</a></div></div>
<div class="ttc" id="a00194_html_a711aad4cbe735871dd9e91ab575c878b"><div class="ttname"><a href="a00194.html#a711aad4cbe735871dd9e91ab575c878b">HyPar::x</a></div><div class="ttdeci">double * x</div><div class="ttdef"><b>Definition:</b> <a href="a00224_source.html#l00099">hypar.h:99</a></div></div>
<div class="ttc" id="a00287_html_accb3d8778a793486e72e06f817ef16fc"><div class="ttname"><a href="a00287.html#accb3d8778a793486e72e06f817ef16fc">CalculateROMDiff</a></div><div class="ttdeci">int CalculateROMDiff(void *s, void *m)</div><div class="ttdef"><b>Definition:</b> <a href="a00287_source.html#l00024">CalculateROMDiff.c:24</a></div></div>
<div class="ttc" id="a00194_html_af474ca4577de91b658e4399ad0a6d7b3"><div class="ttname"><a href="a00194.html#af474ca4577de91b658e4399ad0a6d7b3">HyPar::index_length</a></div><div class="ttdeci">int index_length</div><div class="ttdef"><b>Definition:</b> <a href="a00224_source.html#l00188">hypar.h:188</a></div></div>
<div class="ttc" id="a00218_html_a51efea86a4d76d1259893f606b776573"><div class="ttname"><a href="a00218.html#a51efea86a4d76d1259893f606b776573">_MAX_STRING_SIZE_</a></div><div class="ttdeci">#define _MAX_STRING_SIZE_</div><div class="ttdef"><b>Definition:</b> <a href="a00218_source.html#l00010">basic.h:10</a></div></div>
<div class="ttc" id="a00194_html_a38e0371f331cecbe63a77fa03e202afe"><div class="ttname"><a href="a00194.html#a38e0371f331cecbe63a77fa03e202afe">HyPar::dim_local</a></div><div class="ttdeci">int * dim_local</div><div class="ttdef"><b>Definition:</b> <a href="a00224_source.html#l00035">hypar.h:35</a></div></div>
<div class="ttc" id="a00250_html_a85984dec08cd43570151a625ab62f8d9"><div class="ttname"><a href="a00250.html#a85984dec08cd43570151a625ab62f8d9">TimeCleanup</a></div><div class="ttdeci">int TimeCleanup(void *)</div><div class="ttdef"><b>Definition:</b> <a href="a00582_source.html#l00015">TimeCleanup.c:15</a></div></div>
<div class="ttc" id="a00225_html_aaf888c739c5200d9c58a7154347069b0"><div class="ttname"><a href="a00225.html#aaf888c739c5200d9c58a7154347069b0">WriteArray</a></div><div class="ttdeci">int WriteArray(int, int, int *, int *, int, double *, double *, void *, void *, char *)</div><div class="ttdef"><b>Definition:</b> <a href="a00342_source.html#l00027">WriteArray.c:27</a></div></div>
</div><!-- fragment -->
</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- Start of StatCounter Code for Default Guide -->
<script type="text/javascript">
var sc_project=10897352; 
var sc_invisible=1; 
var sc_security="83042f57"; 
var scJsHost = (("https:" == document.location.protocol) ?
"https://secure." : "http://www.");
document.write("<sc"+"ript type='text/javascript' src='" +
scJsHost+
"statcounter.com/counter/counter.js'></"+"script>");
</script>
<noscript><div class="statcounter"><a title="website
statistics" href="http://statcounter.com/"
target="_blank"><img class="statcounter"
src="//c.statcounter.com/10897352/0/83042f57/1/"
alt="website statistics"></a></div></noscript>
<!-- End of StatCounter Code for Default Guide -->
