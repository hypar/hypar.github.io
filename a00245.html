<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.5"/>
<title>HyPar: include/mathfunctions_cpp.h File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script><script src="http://cdn.mathjax.org/mathjax/latest/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="doxygen_html_style.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">HyPar
   &#160;<span id="projectnumber">1.0</span>
   </div>
   <div id="projectbrief">Finite-Difference Hyperbolic-Parabolic PDE Solver on Cartesian Grids</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.5 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Structures</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>Globals</span></a></li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('a00245.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Data Structures</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Namespaces</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(9)"><span class="SelectionMark">&#160;</span>Macros</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(10)"><span class="SelectionMark">&#160;</span>Pages</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">mathfunctions_cpp.h File Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>Contains function definitions for common mathematical functions for C++ code.  
<a href="#details">More...</a></p>

<p><a href="a00245_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a60dedd021ee26fd0f0040876a81bf723"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00245.html#a60dedd021ee26fd0f0040876a81bf723">FindInterval</a> (double, double, double *, int, int *, int *)</td></tr>
<tr class="separator:a60dedd021ee26fd0f0040876a81bf723"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a64242767d303af0cca9c33d324d4f79c"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00245.html#a64242767d303af0cca9c33d324d4f79c">fillGhostCells</a> (const int *const, const int, double *const, const int, const int, const int *const)</td></tr>
<tr class="separator:a64242767d303af0cca9c33d324d4f79c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a04d4e04f1f9112958dca24fc68c1818a"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00245.html#a04d4e04f1f9112958dca24fc68c1818a">TrilinearInterpCoeffs</a> (double, double, double, double, double, double, double, double, double, double *)</td></tr>
<tr class="separator:a04d4e04f1f9112958dca24fc68c1818a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4293421dad25c62114f4a7453d6376aa"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00245.html#a4293421dad25c62114f4a7453d6376aa">InterpolateGlobalnDVar</a> (const int *const, double **const, const int *const, double *const, const int, const int, const int, const int *const)</td></tr>
<tr class="separator:a4293421dad25c62114f4a7453d6376aa"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Contains function definitions for common mathematical functions for C++ code. </p>
<dl class="section author"><dt>Author</dt><dd>Debojyoti Ghosh </dd></dl>

<p>Definition in file <a class="el" href="a00245_source.html">mathfunctions_cpp.h</a>.</p>
</div><h2 class="groupheader">Function Documentation</h2>
<a class="anchor" id="a60dedd021ee26fd0f0040876a81bf723"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void FindInterval </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>a</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>b</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>N</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>imin</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>imax</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Function to calculate the grid points corresponding to a given interval</p>
<p>Given an interval \(\left[a,b\right], a\leq b\), find grid indices <em>imin</em> and <em>imax</em>, such that </p>
<p class="formulaDsp">
\begin{align} imin &amp;= \min\ i\ {\rm satisfying}\ x_i \geq a\\ imax &amp;= \max\ i\ {\rm satisfying}\ x_i \leq b \end{align}
</p>
<p> where \(\left\{x_i; 0\leq i &lt; N , x_i &lt; x_{i+1} \forall i \right\}\) represents a 1-dimensional grid. <br/>
<br/>
Note: This function handles 1-dimensional intervals and grids only. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">a</td><td>Lower bound of interval </td></tr>
    <tr><td class="paramname">b</td><td>Upper bound of interval </td></tr>
    <tr><td class="paramname">x</td><td>Array of spatial coordinates representing a grid </td></tr>
    <tr><td class="paramname">N</td><td>Number of grid points / size of x </td></tr>
    <tr><td class="paramname">imin</td><td>Lowest grid index within [a,b] </td></tr>
    <tr><td class="paramname">imax</td><td>Highest grid index within [a,b] </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="a00377_source.html#l00019">19</a> of file <a class="el" href="a00377_source.html">FindInterval.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;{</div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;  <span class="keywordtype">int</span> i;</div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;  *imax = -1;</div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;  *imin =  N;</div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;</div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;  <span class="keywordtype">double</span> min_dx = x[1] - x[0];</div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;  <span class="keywordflow">for</span> (i = 2; i &lt; N; i++) {</div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;    <span class="keywordtype">double</span> dx = x[i] - x[i-1];</div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;    <span class="keywordflow">if</span> (dx &lt; min_dx) min_dx = dx;</div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;  }</div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;  <span class="keywordtype">double</span> tol = 1e-10 * min_dx;</div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;</div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;  <span class="keywordflow">for</span> (i = 0; i &lt; N; i++) {</div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;    <span class="keywordflow">if</span> (x[i] &lt;= (b+tol)) *imax = i+1;</div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;  }</div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;  <span class="keywordflow">for</span> (i = N-1; i &gt; -1; i--) {</div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;    <span class="keywordflow">if</span> (x[i] &gt;= (a-tol)) *imin = i;</div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;  }</div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;</div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;  <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a64242767d303af0cca9c33d324d4f79c"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void fillGhostCells </td>
          <td>(</td>
          <td class="paramtype">const int *const&#160;</td>
          <td class="paramname"><em>a_dim</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>a_ngpt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *const&#160;</td>
          <td class="paramname"><em>a_u</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>a_nvars</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>a_ndims</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int *const&#160;</td>
          <td class="paramname"><em>a_periodic</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Fill the ghost cells of a global n-dimensional array</p>
<p>Fill the ghost cells of a solution. Note that the solution array <em>must</em> be a global one (not one that is partitioned among MPI ranks). This is not a parallel operation (it will execute independently on multiple MPI ranks, if called by multiple processes).</p>
<p>For periodicity along any dimension, the ghost cells are filled appropriately from the other side of the domain. Otherwise, the interior data is extrapolated by a 4th order polynomial (assuming uniform grid spacing). </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">a_dim</td><td>grid dimensions of solution </td></tr>
    <tr><td class="paramname">a_ngpt</td><td>number of ghost cells </td></tr>
    <tr><td class="paramname">a_u</td><td>solution array </td></tr>
    <tr><td class="paramname">a_nvars</td><td>number of vector components of the solution </td></tr>
    <tr><td class="paramname">a_ndims</td><td>number of spatial dimensions </td></tr>
    <tr><td class="paramname">a_periodic</td><td>periodic or not along each dimension </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="a00376_source.html#l00017">17</a> of file <a class="el" href="a00376_source.html">FillGhostCells.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;{</div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> d = 0; d &lt; a_ndims; d++) {</div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;</div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;    <span class="keywordtype">int</span> bounds[a_ndims];</div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;    <a class="code" href="a00229.html#a89e8330d9e06dd0666c50833628a125c">_ArrayCopy1D_</a>(a_dim, bounds, a_ndims);</div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;    bounds[d] = a_ngpt;</div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;</div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;    <span class="keywordtype">int</span> index[a_ndims];</div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;    <a class="code" href="a00229.html#a2b2826031c0cd92495ab351d3e599fc5">_ArraySetValue_</a>(index, a_ndims, 0);</div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;</div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;    <span class="keywordflow">if</span> (a_periodic[d]) {</div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;      </div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;      <span class="comment">/* periodic case */</span></div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;</div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;      <span class="keywordtype">int</span> done = 0;</div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;      <span class="keywordflow">while</span> (!done) {</div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;</div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;        {</div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;          <span class="comment">/* low end - face = 1 */</span></div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;</div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;          <span class="keywordtype">int</span> p_gpt = 0, </div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;              p_int = 0;</div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;</div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;          <span class="keywordtype">int</span> index_gpt[a_ndims];</div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;          <a class="code" href="a00229.html#a89e8330d9e06dd0666c50833628a125c">_ArrayCopy1D_</a>(index, index_gpt, a_ndims);</div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;          index_gpt[d] -= a_ngpt;</div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;          <a class="code" href="a00229.html#afbb862a2fdf5b72b1f9ace42f64b556f">_ArrayIndex1D_</a>(a_ndims, a_dim, index_gpt, a_ngpt, p_gpt);</div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;</div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;          <span class="keywordtype">int</span> index_int[a_ndims];</div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;          <a class="code" href="a00229.html#a89e8330d9e06dd0666c50833628a125c">_ArrayCopy1D_</a>(index, index_int, a_ndims);</div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;          index_int[d] += (a_dim[d]-a_ngpt);</div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;          <a class="code" href="a00229.html#afbb862a2fdf5b72b1f9ace42f64b556f">_ArrayIndex1D_</a>(a_ndims, a_dim, index_int, a_ngpt, p_int);</div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;</div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;          <a class="code" href="a00229.html#a89e8330d9e06dd0666c50833628a125c">_ArrayCopy1D_</a>((a_u+a_nvars*p_int), (a_u+a_nvars*p_gpt), a_nvars);</div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;        }</div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;</div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;        {</div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;          <span class="comment">/* high end - face = -1 */</span></div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;</div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;          <span class="keywordtype">int</span> p_gpt = 0, </div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;              p_int = 0;</div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;</div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;          <span class="keywordtype">int</span> index_gpt[a_ndims];</div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;          <a class="code" href="a00229.html#a89e8330d9e06dd0666c50833628a125c">_ArrayCopy1D_</a>(index, index_gpt, a_ndims);</div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;          index_gpt[d] += a_dim[d];</div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;          <a class="code" href="a00229.html#afbb862a2fdf5b72b1f9ace42f64b556f">_ArrayIndex1D_</a>(a_ndims, a_dim, index_gpt, a_ngpt, p_gpt);</div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;</div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;          <span class="keywordtype">int</span> index_int[a_ndims];</div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;          <a class="code" href="a00229.html#a89e8330d9e06dd0666c50833628a125c">_ArrayCopy1D_</a>(index, index_int, a_ndims);</div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;          <a class="code" href="a00229.html#afbb862a2fdf5b72b1f9ace42f64b556f">_ArrayIndex1D_</a>(a_ndims, a_dim, index_int, a_ngpt, p_int);</div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;</div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;          <a class="code" href="a00229.html#a89e8330d9e06dd0666c50833628a125c">_ArrayCopy1D_</a>((a_u+a_nvars*p_int), (a_u+a_nvars*p_gpt), a_nvars);</div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;        }</div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;</div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;        <a class="code" href="a00229.html#ac5ec1371623f11d03b0f42adaa24acbc">_ArrayIncrementIndex_</a>(a_ndims, bounds, index, done);</div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;</div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;      }</div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;</div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;</div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;      <span class="comment">/* not periodic - extrapolate */</span></div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;</div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;      <span class="keywordtype">int</span> done = 0;</div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;      <span class="keywordflow">while</span> (!done) {</div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;</div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;        {</div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;          <span class="comment">/* low end - face = 1 */</span></div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;</div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;          <span class="keywordtype">int</span> p_gpt = 0, </div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;              p_int_0 = 0,</div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;              p_int_1 = 0,</div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;              p_int_2 = 0,</div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;              p_int_3 = 0;</div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;</div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;          <span class="keywordtype">int</span> index_gpt[a_ndims];</div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;          <a class="code" href="a00229.html#a89e8330d9e06dd0666c50833628a125c">_ArrayCopy1D_</a>(index, index_gpt, a_ndims);</div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;          index_gpt[d] -= a_ngpt;</div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;          <a class="code" href="a00229.html#afbb862a2fdf5b72b1f9ace42f64b556f">_ArrayIndex1D_</a>(a_ndims, a_dim, index_gpt, a_ngpt, p_gpt);</div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;</div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;          <span class="keywordtype">int</span> index_int[a_ndims];</div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;          <a class="code" href="a00229.html#a89e8330d9e06dd0666c50833628a125c">_ArrayCopy1D_</a>(index, index_int, a_ndims);</div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;</div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;          index_int[d] = 0;</div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;          <a class="code" href="a00229.html#afbb862a2fdf5b72b1f9ace42f64b556f">_ArrayIndex1D_</a>(a_ndims, a_dim, index_int, a_ngpt, p_int_0);</div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;          index_int[d]++;</div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;          <a class="code" href="a00229.html#afbb862a2fdf5b72b1f9ace42f64b556f">_ArrayIndex1D_</a>(a_ndims, a_dim, index_int, a_ngpt, p_int_1);</div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;          index_int[d]++;</div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;          <a class="code" href="a00229.html#afbb862a2fdf5b72b1f9ace42f64b556f">_ArrayIndex1D_</a>(a_ndims, a_dim, index_int, a_ngpt, p_int_2);</div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;          index_int[d]++;</div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;          <a class="code" href="a00229.html#afbb862a2fdf5b72b1f9ace42f64b556f">_ArrayIndex1D_</a>(a_ndims, a_dim, index_int, a_ngpt, p_int_3);</div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;</div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;          <span class="keywordtype">double</span> alpha = - (double) (a_ngpt - index[d]);</div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;          <span class="keywordtype">double</span> c0 = -((-2.0 + alpha)*(-1.0 + alpha)*alpha)/6.0;</div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;          <span class="keywordtype">double</span> c1 = ((-2.0 + alpha)*(-1.0 + alpha)*(1.0 + alpha))/2.0;</div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;          <span class="keywordtype">double</span> c2 = (alpha*(2.0 + alpha - alpha*alpha))/2.0;</div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;          <span class="keywordtype">double</span> c3 = (alpha*(-1.0 + alpha*alpha))/6.0;</div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;</div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;          <span class="keywordflow">for</span> (<span class="keywordtype">int</span> v = 0; v &lt; a_nvars; v++) {</div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;    </div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;            a_u[p_gpt*a_nvars+v] =    c0 * a_u[p_int_0*a_nvars+v]</div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;                                    + c1 * a_u[p_int_1*a_nvars+v]</div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;                                    + c2 * a_u[p_int_2*a_nvars+v]</div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;                                    + c3 * a_u[p_int_3*a_nvars+v];</div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;    </div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;          }</div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;</div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;        }</div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;</div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;        {</div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;          <span class="comment">/* high end - face = -1 */</span></div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;</div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;          <span class="keywordtype">int</span> p_gpt = 0, </div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;              p_int_0 = 0,</div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;              p_int_1 = 0,</div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;              p_int_2 = 0,</div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;              p_int_3 = 0;</div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;</div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;          <span class="keywordtype">int</span> index_gpt[a_ndims];</div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;          <a class="code" href="a00229.html#a89e8330d9e06dd0666c50833628a125c">_ArrayCopy1D_</a>(index, index_gpt, a_ndims);</div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;          index_gpt[d] += a_dim[d];</div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;          <a class="code" href="a00229.html#afbb862a2fdf5b72b1f9ace42f64b556f">_ArrayIndex1D_</a>(a_ndims, a_dim, index_gpt, a_ngpt, p_gpt);</div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;</div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;          <span class="keywordtype">int</span> index_int[a_ndims];</div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;          <a class="code" href="a00229.html#a89e8330d9e06dd0666c50833628a125c">_ArrayCopy1D_</a>(index, index_int, a_ndims);</div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;</div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;          index_int[d] = a_dim[d]-1;</div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;          <a class="code" href="a00229.html#afbb862a2fdf5b72b1f9ace42f64b556f">_ArrayIndex1D_</a>(a_ndims, a_dim, index, a_ngpt, p_int_0);</div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;          index_int[d]--;</div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;          <a class="code" href="a00229.html#afbb862a2fdf5b72b1f9ace42f64b556f">_ArrayIndex1D_</a>(a_ndims, a_dim, index, a_ngpt, p_int_1);</div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;          index_int[d]--;</div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;          <a class="code" href="a00229.html#afbb862a2fdf5b72b1f9ace42f64b556f">_ArrayIndex1D_</a>(a_ndims, a_dim, index, a_ngpt, p_int_2);</div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;          index_int[d]--;</div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;          <a class="code" href="a00229.html#afbb862a2fdf5b72b1f9ace42f64b556f">_ArrayIndex1D_</a>(a_ndims, a_dim, index, a_ngpt, p_int_3);</div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;</div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;          <span class="keywordtype">double</span> alpha = - (double) (index[d]+1);</div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;          <span class="keywordtype">double</span> c0 = -((-2.0 + alpha)*(-1.0 + alpha)*alpha)/6.0;</div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;          <span class="keywordtype">double</span> c1 = ((-2.0 + alpha)*(-1.0 + alpha)*(1.0 + alpha))/2.0;</div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;          <span class="keywordtype">double</span> c2 = (alpha*(2.0 + alpha - alpha*alpha))/2.0;</div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;          <span class="keywordtype">double</span> c3 = (alpha*(-1.0 + alpha*alpha))/6.0;</div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;</div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;          <span class="keywordflow">for</span> (<span class="keywordtype">int</span> v = 0; v &lt; a_nvars; v++) {</div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;    </div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;            a_u[p_gpt*a_nvars+v] =    c0 * a_u[p_int_0*a_nvars+v]</div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;                                    + c1 * a_u[p_int_1*a_nvars+v]</div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;                                    + c2 * a_u[p_int_2*a_nvars+v]</div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;                                    + c3 * a_u[p_int_3*a_nvars+v];</div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;    </div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;          }</div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;</div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;        }</div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;</div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;        <a class="code" href="a00229.html#ac5ec1371623f11d03b0f42adaa24acbc">_ArrayIncrementIndex_</a>(a_ndims, bounds, index, done);</div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;</div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;      }</div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;</div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;    }</div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;</div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;  }</div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;</div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;  <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;}</div>
<div class="ttc" id="a00229_html_a2b2826031c0cd92495ab351d3e599fc5"><div class="ttname"><a href="a00229.html#a2b2826031c0cd92495ab351d3e599fc5">_ArraySetValue_</a></div><div class="ttdeci">#define _ArraySetValue_(x, size, value)</div><div class="ttdef"><b>Definition:</b> <a href="a00229_source.html#l00169">arrayfunctions.h:169</a></div></div>
<div class="ttc" id="a00229_html_afbb862a2fdf5b72b1f9ace42f64b556f"><div class="ttname"><a href="a00229.html#afbb862a2fdf5b72b1f9ace42f64b556f">_ArrayIndex1D_</a></div><div class="ttdeci">#define _ArrayIndex1D_(N, imax, i, ghost, index)</div><div class="ttdef"><b>Definition:</b> <a href="a00229_source.html#l00040">arrayfunctions.h:40</a></div></div>
<div class="ttc" id="a00229_html_a89e8330d9e06dd0666c50833628a125c"><div class="ttname"><a href="a00229.html#a89e8330d9e06dd0666c50833628a125c">_ArrayCopy1D_</a></div><div class="ttdeci">#define _ArrayCopy1D_(x, y, size)</div><div class="ttdef"><b>Definition:</b> <a href="a00229_source.html#l00319">arrayfunctions.h:319</a></div></div>
<div class="ttc" id="a00229_html_ac5ec1371623f11d03b0f42adaa24acbc"><div class="ttname"><a href="a00229.html#ac5ec1371623f11d03b0f42adaa24acbc">_ArrayIncrementIndex_</a></div><div class="ttdeci">#define _ArrayIncrementIndex_(N, imax, i, done)</div><div class="ttdef"><b>Definition:</b> <a href="a00229_source.html#l00126">arrayfunctions.h:126</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a04d4e04f1f9112958dca24fc68c1818a"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void TrilinearInterpCoeffs </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>xmin</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>xmax</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>ymin</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>ymax</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>zmin</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>zmax</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>y</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>z</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>coeffs</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Function to compute trilinear interpolation coefficients</p>
<p>This function computes the coefficients for a trilinear interpolation at a given point (x,y,z) inside a cube defined by [xmin,xmax] X [ymin,ymax] X [zmin,zmax]. The coefficients are stored in an array of size 8 with each element corresponding to a corner of the cube in the following order:<br/>
coeffs[0] =&gt; xmin,ymin,zmin<br/>
coeffs[1] =&gt; xmax,ymin,zmin<br/>
coeffs[2] =&gt; xmin,ymax,zmin<br/>
coeffs[3] =&gt; xmax,ymax,zmin<br/>
coeffs[4] =&gt; xmin,ymin,zmax<br/>
coeffs[5] =&gt; xmax,ymin,zmax<br/>
coeffs[6] =&gt; xmin,ymax,zmax<br/>
coeffs[7] =&gt; xmax,ymax,zmax </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">xmin</td><td>x-coordinate of the lower-end </td></tr>
    <tr><td class="paramname">xmax</td><td>x-coordinate of the higher-end </td></tr>
    <tr><td class="paramname">ymin</td><td>y-coordinate of the lower-end </td></tr>
    <tr><td class="paramname">ymax</td><td>y-coordinate of the higher-end </td></tr>
    <tr><td class="paramname">zmin</td><td>z-coordinate of the lower-end </td></tr>
    <tr><td class="paramname">zmax</td><td>z-coordinate of the higher-end </td></tr>
    <tr><td class="paramname">x</td><td>x-coordinate of the point to interpolate at </td></tr>
    <tr><td class="paramname">y</td><td>y-coordinate of the point to interpolate at </td></tr>
    <tr><td class="paramname">z</td><td>z-coordinate of the point to interpolate at </td></tr>
    <tr><td class="paramname">coeffs</td><td>array of size 8 (pre-allocated) to store the coefficients in </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="a00379_source.html#l00022">22</a> of file <a class="el" href="a00379_source.html">TrilinearInterpolation.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;{</div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;    <span class="keywordtype">double</span> vol_inv = 1 / ((xmax-xmin)*(ymax-ymin)*(zmax-zmin));</div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;    <span class="keywordtype">double</span> tldx1 = x - xmin;</div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;    <span class="keywordtype">double</span> tldx2 = xmax - x;</div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;    <span class="keywordtype">double</span> tldy1 = y - ymin;</div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;    <span class="keywordtype">double</span> tldy2 = ymax - y;</div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;    <span class="keywordtype">double</span> tldz1 = z - zmin;</div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;    <span class="keywordtype">double</span> tldz2 = zmax - z;</div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;</div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;    coeffs[0] = tldz2 * tldy2 * tldx2 * vol_inv;</div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;    coeffs[1] = tldz2 * tldy2 * tldx1 * vol_inv;</div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;    coeffs[2] = tldz2 * tldy1 * tldx2 * vol_inv;</div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;    coeffs[3] = tldz2 * tldy1 * tldx1 * vol_inv;</div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;    coeffs[4] = tldz1 * tldy2 * tldx2 * vol_inv;</div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;    coeffs[5] = tldz1 * tldy2 * tldx1 * vol_inv;</div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;    coeffs[6] = tldz1 * tldy1 * tldx2 * vol_inv;</div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;    coeffs[7] = tldz1 * tldy1 * tldx1 * vol_inv;</div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;</div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;    <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a4293421dad25c62114f4a7453d6376aa"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int InterpolateGlobalnDVar </td>
          <td>(</td>
          <td class="paramtype">const int *const&#160;</td>
          <td class="paramname"><em>a_dim_dst</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double **const&#160;</td>
          <td class="paramname"><em>a_u_dst</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int *const&#160;</td>
          <td class="paramname"><em>a_dim_src</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *const&#160;</td>
          <td class="paramname"><em>a_u_src</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>a_nvars</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>a_ghosts</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>a_ndims</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int *const&#160;</td>
          <td class="paramname"><em>a_periodic</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Interpolate an n-dimensional grid variable from one grid to another</p>
<p>Interpolate n-dimensional data from one grid to another of a desired resolution. Note that along each dimension, the ratio of the number of grid points in the source grid and that in the destination grid must be an integer power of 2 (negative or positive).</p>
<p>The source data <em>must</em> be global. It will get deallocated at the end of this function. It <em>must</em> have the appropriate number of ghost points.</p>
<p>The incoming pointer for destination data must be NULL. After this function is executed, it will point to a chunk of memory with the interpolated solution. This is the <em>global</em> solution. It will have the specified number of ghost points appropriately filled. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">a_dim_dst</td><td>grid dimensions to interpolate to </td></tr>
    <tr><td class="paramname">a_u_dst</td><td>pointer to array containing interpolated data </td></tr>
    <tr><td class="paramname">a_dim_src</td><td>grid dimensions to interpolate from </td></tr>
    <tr><td class="paramname">a_u_src</td><td>pointer to array containing data to interpolate from </td></tr>
    <tr><td class="paramname">a_nvars</td><td>Number of vector components of the solution </td></tr>
    <tr><td class="paramname">a_ghosts</td><td>Number of ghost points </td></tr>
    <tr><td class="paramname">a_ndims</td><td>Number of spatial dimensions </td></tr>
    <tr><td class="paramname">a_periodic</td><td>Is the domain periodic or not along each dimension </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="a00378_source.html#l00317">317</a> of file <a class="el" href="a00378_source.html">InterpolateGlobalnDVar.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;{</div>
<div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;  <span class="keywordflow">if</span> ((*a_u_dst) != NULL) {</div>
<div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;    fprintf(stderr, <span class="stringliteral">&quot;Error in InterpolateGlobalnDVar() - \n&quot;</span>);</div>
<div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;    fprintf(stderr, <span class="stringliteral">&quot;  a_u_dst is not NULL!\n&quot;</span>);</div>
<div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;    <span class="keywordflow">return</span> 1;</div>
<div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;  }</div>
<div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;</div>
<div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;  <span class="keywordflow">if</span> (a_u_src == NULL) {</div>
<div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;    fprintf(stderr, <span class="stringliteral">&quot;Error in InterpolateGlobalnDVar() - \n&quot;</span>);</div>
<div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;    fprintf(stderr, <span class="stringliteral">&quot;  a_u_src is NULL!\n&quot;</span>);</div>
<div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;    <span class="keywordflow">return</span> 1;</div>
<div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;  }</div>
<div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;</div>
<div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;  <span class="keywordtype">int</span> dim_to[a_ndims], dim_from[a_ndims];</div>
<div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;</div>
<div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;  <span class="keywordtype">double</span> *u_from;</div>
<div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;  <span class="keywordtype">double</span> *u_to;</div>
<div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;</div>
<div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;  <a class="code" href="a00229.html#a89e8330d9e06dd0666c50833628a125c">_ArrayCopy1D_</a>(a_dim_src, dim_to, a_ndims);</div>
<div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;  u_to = a_u_src;</div>
<div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;  u_from = NULL;</div>
<div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;</div>
<div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> dir = 0; dir &lt; a_ndims; dir++) {</div>
<div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;</div>
<div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;    <a class="code" href="a00229.html#a89e8330d9e06dd0666c50833628a125c">_ArrayCopy1D_</a>(dim_to, dim_from, a_ndims);</div>
<div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;    dim_to[dir] = a_dim_dst[dir];</div>
<div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;</div>
<div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;    <span class="keywordflow">if</span> (dim_from[dir] == dim_to[dir]) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;</div>
<div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;    <span class="keywordtype">double</span> fac = (dim_to[dir] &gt; dim_from[dir] ? </div>
<div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;                      (double)dim_to[dir]/(<span class="keywordtype">double</span>)dim_from[dir] </div>
<div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;                    : (<span class="keywordtype">double</span>)dim_from[dir]/(<span class="keywordtype">double</span>)dim_to[dir] );</div>
<div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;</div>
<div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;    if (!<a class="code" href="a00378.html#aafd7ccd78e660e79257b36fc5a9453f2">isPowerOfTwo</a>((<span class="keywordtype">int</span>)fac)) {</div>
<div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;      fprintf(stderr,<span class="stringliteral">&quot;Error in interpolate() - \n&quot;</span>);</div>
<div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;      fprintf(stderr,<span class="stringliteral">&quot;  refinement/coarsening factor not a power of 2!\n&quot;</span>);</div>
<div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;      <span class="keywordflow">return</span> 1;</div>
<div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;    }</div>
<div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;</div>
<div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;    <span class="keywordflow">if</span> (u_from != NULL) free(u_from);</div>
<div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;</div>
<div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;    u_from = u_to;</div>
<div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;</div>
<div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;    {</div>
<div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;      <span class="keywordtype">long</span> size = (long) a_nvars;</div>
<div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> d = 0; d &lt; a_ndims; d++) {</div>
<div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;        size *= (long) (dim_to[d] + 2*a_ghosts);</div>
<div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;      }</div>
<div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;      u_to = (<span class="keywordtype">double</span>*) calloc (size, <span class="keyword">sizeof</span>(<span class="keywordtype">double</span>));</div>
<div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;    }</div>
<div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;</div>
<div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;    <a class="code" href="a00244.html#a64242767d303af0cca9c33d324d4f79c">fillGhostCells</a>( dim_from, </div>
<div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;                    a_ghosts, </div>
<div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;                    u_from, </div>
<div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;                    a_nvars, </div>
<div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;                    a_ndims, </div>
<div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;                    a_periodic );</div>
<div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;</div>
<div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;    <span class="keywordflow">if</span> (dim_to[dir] &lt; dim_from[dir]) {</div>
<div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;      <span class="keywordtype">int</span> retval = <a class="code" href="a00378.html#a9d680d590ea7b1a942b880564d70dfd1">coarsen1D</a>( dim_from, </div>
<div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;                              dim_to, </div>
<div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;                              u_from, </div>
<div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;                              u_to, </div>
<div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;                              dir, </div>
<div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;                              a_nvars, </div>
<div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;                              a_ghosts, </div>
<div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;                              a_ndims );</div>
<div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;      <span class="keywordflow">if</span> (retval) <span class="keywordflow">return</span> retval;</div>
<div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;      <span class="keywordtype">int</span> retval = <a class="code" href="a00378.html#a8fbe3466587deeb3032a24ccfcc3956a">refine1D</a>(  dim_from, </div>
<div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;                              dim_to, </div>
<div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;                              u_from, </div>
<div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;                              u_to, </div>
<div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;                              dir, </div>
<div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;                              a_nvars, </div>
<div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;                              a_ghosts, </div>
<div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;                              a_ndims );</div>
<div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;      <span class="keywordflow">if</span> (retval) <span class="keywordflow">return</span> retval;</div>
<div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;    }</div>
<div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;</div>
<div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;  }</div>
<div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;</div>
<div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;  <span class="comment">/* dim_to should be equal to a_dim_dst now */</span></div>
<div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> d = 0; d &lt; a_ndims; d++) {</div>
<div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;    <span class="keywordflow">if</span> (dim_to[d] != a_dim_dst[d]) {</div>
<div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;      fprintf(stderr,<span class="stringliteral">&quot;Error in InterpolateGlobalnDVar() - \n&quot;</span>);</div>
<div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;      fprintf(stderr,<span class="stringliteral">&quot;  dim_to[%d] (%d) != a_dim_dst[%d] (%d)!\n&quot;</span>, </div>
<div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;              d, dim_to[d], d, a_dim_dst[d]);</div>
<div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;      <span class="keywordflow">return</span> 1;</div>
<div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;    }</div>
<div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;  }</div>
<div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;</div>
<div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;  <span class="keywordflow">if</span> (u_from != NULL) free(u_from);</div>
<div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;  (*a_u_dst) = u_to;</div>
<div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;</div>
<div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;  <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;}</div>
<div class="ttc" id="a00229_html_a89e8330d9e06dd0666c50833628a125c"><div class="ttname"><a href="a00229.html#a89e8330d9e06dd0666c50833628a125c">_ArrayCopy1D_</a></div><div class="ttdeci">#define _ArrayCopy1D_(x, y, size)</div><div class="ttdef"><b>Definition:</b> <a href="a00229_source.html#l00319">arrayfunctions.h:319</a></div></div>
<div class="ttc" id="a00378_html_a9d680d590ea7b1a942b880564d70dfd1"><div class="ttname"><a href="a00378.html#a9d680d590ea7b1a942b880564d70dfd1">coarsen1D</a></div><div class="ttdeci">static int coarsen1D(const int *const a_dim_src, const int *const a_dim_dst, const double *const a_u_src, double *const a_u_dst, const int a_dir, const int a_nvars, const int a_ngpt, const int a_ndims)</div><div class="ttdef"><b>Definition:</b> <a href="a00378_source.html#l00032">InterpolateGlobalnDVar.c:32</a></div></div>
<div class="ttc" id="a00378_html_aafd7ccd78e660e79257b36fc5a9453f2"><div class="ttname"><a href="a00378.html#aafd7ccd78e660e79257b36fc5a9453f2">isPowerOfTwo</a></div><div class="ttdeci">static int isPowerOfTwo(int x)</div><div class="ttdef"><b>Definition:</b> <a href="a00378_source.html#l00013">InterpolateGlobalnDVar.c:13</a></div></div>
<div class="ttc" id="a00378_html_a8fbe3466587deeb3032a24ccfcc3956a"><div class="ttname"><a href="a00378.html#a8fbe3466587deeb3032a24ccfcc3956a">refine1D</a></div><div class="ttdeci">static int refine1D(const int *const a_dim_src, const int *const a_dim_dst, const double *const a_u_src, double *const a_u_dst, const int a_dir, const int a_nvars, const int a_ngpt, const int a_ndims)</div><div class="ttdef"><b>Definition:</b> <a href="a00378_source.html#l00163">InterpolateGlobalnDVar.c:163</a></div></div>
<div class="ttc" id="a00244_html_a64242767d303af0cca9c33d324d4f79c"><div class="ttname"><a href="a00244.html#a64242767d303af0cca9c33d324d4f79c">fillGhostCells</a></div><div class="ttdeci">void fillGhostCells(const int *const, const int, double *const, const int, const int, const int *const)</div><div class="ttdef"><b>Definition:</b> <a href="a00376_source.html#l00017">FillGhostCells.c:17</a></div></div>
</div><!-- fragment -->
</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- Start of StatCounter Code for Default Guide -->
<script type="text/javascript">
var sc_project=10897352; 
var sc_invisible=1; 
var sc_security="83042f57"; 
var scJsHost = (("https:" == document.location.protocol) ?
"https://secure." : "http://www.");
document.write("<sc"+"ript type='text/javascript' src='" +
scJsHost+
"statcounter.com/counter/counter.js'></"+"script>");
</script>
<noscript><div class="statcounter"><a title="website
statistics" href="http://statcounter.com/"
target="_blank"><img class="statcounter"
src="//c.statcounter.com/10897352/0/83042f57/1/"
alt="website statistics"></a></div></noscript>
<!-- End of StatCounter Code for Default Guide -->
