<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.5"/>
<title>HyPar: src/PhysicalModels/NavierStokes3D/NavierStokes3DParabolicFunction_GPU.cu File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script><script src="http://cdn.mathjax.org/mathjax/latest/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="doxygen_html_style.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">HyPar
   &#160;<span id="projectnumber">1.0</span>
   </div>
   <div id="projectbrief">Finite-Difference Hyperbolic-Parabolic PDE Solver on Cartesian Grids</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.5 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Structures</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>Globals</span></a></li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('a00534.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Data Structures</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Namespaces</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(9)"><span class="SelectionMark">&#160;</span>Macros</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(10)"><span class="SelectionMark">&#160;</span>Pages</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">NavierStokes3DParabolicFunction_GPU.cu File Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>Compute the viscous terms for the 3D Navier Stokes equations.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &lt;<a class="el" href="a00234_source.html">basic_gpu.h</a>&gt;</code><br/>
<code>#include &lt;<a class="el" href="a00232_source.html">arrayfunctions_gpu.h</a>&gt;</code><br/>
<code>#include &lt;<a class="el" href="a00246_source.html">mathfunctions.h</a>&gt;</code><br/>
<code>#include &lt;<a class="el" href="a00210_source.html">physicalmodels/navierstokes3d.h</a>&gt;</code><br/>
<code>#include &lt;<a class="el" href="a00250_source.html">mpivars.h</a>&gt;</code><br/>
<code>#include &lt;<a class="el" href="a00240_source.html">hypar.h</a>&gt;</code><br/>
</div>
<p><a href="a00534_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a6d81cafe72b99e9dfedc17ccfa471a58"><td class="memItemLeft" align="right" valign="top">__global__ void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00534.html#a6d81cafe72b99e9dfedc17ccfa471a58">gpuNavierStokes3DParabolicFunction_Q_kernel</a> (int npoints_grid, double gamma, const double *__restrict__ u, double *__restrict__ Q)</td></tr>
<tr class="separator:a6d81cafe72b99e9dfedc17ccfa471a58"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aed011bbf771cb730338214036ca8cfde"><td class="memItemLeft" align="right" valign="top">__global__ void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00534.html#aed011bbf771cb730338214036ca8cfde">gpuNavierStokes3DParabolicFunction_QDeriv_kernel</a> (int npoints_grid, int ghosts, const int *__restrict__ dim, const double *__restrict__ dxinv, double *__restrict__ QDerivX, double *__restrict__ QDerivY, double *__restrict__ QDerivZ)</td></tr>
<tr class="separator:aed011bbf771cb730338214036ca8cfde"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab58cddae812df829602dd187dd66d609"><td class="memItemLeft" align="right" valign="top">__global__ void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00534.html#ab58cddae812df829602dd187dd66d609">gpuNavierStokes3DParabolicFunction_Xdir_kernel</a> (int npoints_grid, double two_third, double inv_gamma_m1, double inv_Re, double inv_Pr, const double *__restrict__ Q, const double *__restrict__ QDerivX, const double *__restrict__ QDerivY, const double *__restrict__ QDerivZ, double *__restrict__ FViscous)</td></tr>
<tr class="separator:ab58cddae812df829602dd187dd66d609"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a883e986e6ec1ec4d2a3f4d9f12ed74bc"><td class="memItemLeft" align="right" valign="top">__global__ void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00534.html#a883e986e6ec1ec4d2a3f4d9f12ed74bc">gpuNavierStokes3DParabolicFunction_Ydir_kernel</a> (int npoints_grid, double two_third, double inv_gamma_m1, double inv_Re, double inv_Pr, const double *__restrict__ Q, const double *__restrict__ QDerivX, const double *__restrict__ QDerivY, const double *__restrict__ QDerivZ, double *__restrict__ FViscous)</td></tr>
<tr class="separator:a883e986e6ec1ec4d2a3f4d9f12ed74bc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7a13759038ad4bfdecc12c9f69e3db65"><td class="memItemLeft" align="right" valign="top">__global__ void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00534.html#a7a13759038ad4bfdecc12c9f69e3db65">gpuNavierStokes3DParabolicFunction_Zdir_kernel</a> (int npoints_grid, double two_third, double inv_gamma_m1, double inv_Re, double inv_Pr, const double *__restrict__ Q, const double *__restrict__ QDerivX, const double *__restrict__ QDerivY, const double *__restrict__ QDerivZ, double *__restrict__ FViscous)</td></tr>
<tr class="separator:a7a13759038ad4bfdecc12c9f69e3db65"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac93d2dd0f138357c465a33a1bbfd7592"><td class="memItemLeft" align="right" valign="top">__global__ void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00534.html#ac93d2dd0f138357c465a33a1bbfd7592">gpuNavierStokes3DParabolicFunction_par_kernel</a> (int npoints_grid, int npoints_local_wghosts, int ghosts, int dir, const int *__restrict__ dim, const double *__restrict__ dxinv, const double *__restrict__ FDeriv, double *__restrict__ par)</td></tr>
<tr class="separator:ac93d2dd0f138357c465a33a1bbfd7592"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8cc7f5c6a830e004704e2bd0c15f247e"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00534.html#a8cc7f5c6a830e004704e2bd0c15f247e">gpuNavierStokes3DParabolicFunction</a> (double *__restrict__ par, double *__restrict__ u, void *__restrict__ s, void *__restrict__ m, double t)</td></tr>
<tr class="separator:a8cc7f5c6a830e004704e2bd0c15f247e"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Compute the viscous terms for the 3D Navier Stokes equations. </p>
<dl class="section author"><dt>Author</dt><dd>Youngdae Kim </dd></dl>

<p>Definition in file <a class="el" href="a00534_source.html">NavierStokes3DParabolicFunction_GPU.cu</a>.</p>
</div><h2 class="groupheader">Function Documentation</h2>
<a class="anchor" id="a6d81cafe72b99e9dfedc17ccfa471a58"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">__global__ void gpuNavierStokes3DParabolicFunction_Q_kernel </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>npoints_grid</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>gamma</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double *__restrict__&#160;</td>
          <td class="paramname"><em>u</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *__restrict__&#160;</td>
          <td class="paramname"><em>Q</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Kernel function </p>

<p>Definition at line <a class="el" href="a00534_source.html#l00506">506</a> of file <a class="el" href="a00534_source.html">NavierStokes3DParabolicFunction_GPU.cu</a>.</p>
<div class="fragment"><div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;{</div>
<div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;    <span class="keywordtype">int</span> p = blockDim.x * blockIdx.x + threadIdx.x;</div>
<div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;</div>
<div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;    <span class="keywordflow">if</span> (p &lt; npoints_grid) {</div>
<div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;        <span class="keywordtype">double</span> energy, pressure;</div>
<div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;        <a class="code" href="a00210.html#afa5cf2c674c540ba8b8a9d69f21b531a">_NavierStokes3DGetFlowVar_</a>(</div>
<div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;            (u+p),</div>
<div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;            npoints_grid,</div>
<div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;            Q[p],</div>
<div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;            Q[p+  npoints_grid],</div>
<div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;            Q[p+2*npoints_grid],</div>
<div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;            Q[p+3*npoints_grid],</div>
<div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;            energy,</div>
<div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;            pressure,</div>
<div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;            gamma</div>
<div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;        );</div>
<div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;        Q[p+4*npoints_grid] = gamma*pressure/Q[p+0]; <span class="comment">/* temperature */</span></div>
<div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;    }</div>
<div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;    <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;}</div>
<div class="ttc" id="a00210_html_afa5cf2c674c540ba8b8a9d69f21b531a"><div class="ttname"><a href="a00210.html#afa5cf2c674c540ba8b8a9d69f21b531a">_NavierStokes3DGetFlowVar_</a></div><div class="ttdeci">#define _NavierStokes3DGetFlowVar_(u, stride, rho, vx, vy, vz, e, P, gamma)</div><div class="ttdef"><b>Definition:</b> <a href="a00210_source.html#l00098">navierstokes3d.h:98</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="aed011bbf771cb730338214036ca8cfde"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">__global__ void gpuNavierStokes3DParabolicFunction_QDeriv_kernel </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>npoints_grid</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>ghosts</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int *__restrict__&#160;</td>
          <td class="paramname"><em>dim</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double *__restrict__&#160;</td>
          <td class="paramname"><em>dxinv</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *__restrict__&#160;</td>
          <td class="paramname"><em>QDerivX</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *__restrict__&#160;</td>
          <td class="paramname"><em>QDerivY</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *__restrict__&#160;</td>
          <td class="paramname"><em>QDerivZ</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Kernel function </p>

<p>Definition at line <a class="el" href="a00534_source.html#l00535">535</a> of file <a class="el" href="a00534_source.html">NavierStokes3DParabolicFunction_GPU.cu</a>.</p>
<div class="fragment"><div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;{</div>
<div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;    <span class="keywordtype">int</span> p = blockDim.x * blockIdx.x + threadIdx.x;</div>
<div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;</div>
<div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;    <span class="keywordflow">if</span> (p &lt; npoints_grid) {</div>
<div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;        <span class="keywordtype">int</span> index[<a class="code" href="a00253.html#a57771c952ec174601addf43e1c0202b2">_MODEL_NDIMS_</a>];</div>
<div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;        <span class="keywordtype">double</span> dxinv_val, dyinv_val, dzinv_val;</div>
<div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;</div>
<div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;        <a class="code" href="a00231.html#a03f49e4d44ae8aca85cb04cfe91e4ce4">_ArrayIndexnD_</a>(<a class="code" href="a00253.html#a57771c952ec174601addf43e1c0202b2">_MODEL_NDIMS_</a>,p,dim,index,ghosts);</div>
<div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;        <a class="code" href="a00233.html#a9aa9bad8531d6733731a850ccc471a42">_GetCoordinate_</a>(<a class="code" href="a00253.html#a6a44057228e5f4b86e1c4d04b2a28977">_XDIR_</a>,index[<a class="code" href="a00253.html#a6a44057228e5f4b86e1c4d04b2a28977">_XDIR_</a>],dim,ghosts,dxinv,dxinv_val);</div>
<div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;        <a class="code" href="a00233.html#a9aa9bad8531d6733731a850ccc471a42">_GetCoordinate_</a>(<a class="code" href="a00198.html#a7fd32e06617f4489079bc50ce9bfc00c">_YDIR_</a>,index[<a class="code" href="a00198.html#a7fd32e06617f4489079bc50ce9bfc00c">_YDIR_</a>],dim,ghosts,dxinv,dyinv_val);</div>
<div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;        <a class="code" href="a00233.html#a9aa9bad8531d6733731a850ccc471a42">_GetCoordinate_</a>(<a class="code" href="a00210.html#a227beecac6bef022707512c15d39e30b">_ZDIR_</a>,index[<a class="code" href="a00210.html#a227beecac6bef022707512c15d39e30b">_ZDIR_</a>],dim,ghosts,dxinv,dzinv_val);</div>
<div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;</div>
<div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;<span class="preprocessor">        #pragma unroll</span></div>
<div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;<span class="preprocessor"></span>        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j=0; j&lt;<a class="code" href="a00253.html#ad3395a55a5fde64d6603c7a82d7bf2c7">_MODEL_NVARS_</a>; j++) {</div>
<div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;          QDerivX[p] *= dxinv_val;</div>
<div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;          QDerivY[p] *= dyinv_val;</div>
<div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;          QDerivZ[p] *= dzinv_val;</div>
<div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;          p += npoints_grid;</div>
<div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;        }</div>
<div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;    }</div>
<div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;    <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;}</div>
<div class="ttc" id="a00198_html_a7fd32e06617f4489079bc50ce9bfc00c"><div class="ttname"><a href="a00198.html#a7fd32e06617f4489079bc50ce9bfc00c">_YDIR_</a></div><div class="ttdeci">#define _YDIR_</div><div class="ttdef"><b>Definition:</b> <a href="a00198_source.html#l00041">euler2d.h:41</a></div></div>
<div class="ttc" id="a00253_html_ad3395a55a5fde64d6603c7a82d7bf2c7"><div class="ttname"><a href="a00253.html#ad3395a55a5fde64d6603c7a82d7bf2c7">_MODEL_NVARS_</a></div><div class="ttdeci">#define _MODEL_NVARS_</div><div class="ttdef"><b>Definition:</b> <a href="a00253_source.html#l00058">euler1d.h:58</a></div></div>
<div class="ttc" id="a00231_html_a03f49e4d44ae8aca85cb04cfe91e4ce4"><div class="ttname"><a href="a00231.html#a03f49e4d44ae8aca85cb04cfe91e4ce4">_ArrayIndexnD_</a></div><div class="ttdeci">#define _ArrayIndexnD_(N, index, imax, i, ghost)</div><div class="ttdef"><b>Definition:</b> <a href="a00231_source.html#l00021">arrayfunctions.h:21</a></div></div>
<div class="ttc" id="a00233_html_a9aa9bad8531d6733731a850ccc471a42"><div class="ttname"><a href="a00233.html#a9aa9bad8531d6733731a850ccc471a42">_GetCoordinate_</a></div><div class="ttdeci">#define _GetCoordinate_(dir, i, dim, ghosts, x, coord)</div><div class="ttdef"><b>Definition:</b> <a href="a00233_source.html#l00031">basic.h:31</a></div></div>
<div class="ttc" id="a00253_html_a57771c952ec174601addf43e1c0202b2"><div class="ttname"><a href="a00253.html#a57771c952ec174601addf43e1c0202b2">_MODEL_NDIMS_</a></div><div class="ttdeci">#define _MODEL_NDIMS_</div><div class="ttdef"><b>Definition:</b> <a href="a00253_source.html#l00056">euler1d.h:56</a></div></div>
<div class="ttc" id="a00210_html_a227beecac6bef022707512c15d39e30b"><div class="ttname"><a href="a00210.html#a227beecac6bef022707512c15d39e30b">_ZDIR_</a></div><div class="ttdeci">#define _ZDIR_</div><div class="ttdef"><b>Definition:</b> <a href="a00210_source.html#l00076">navierstokes3d.h:76</a></div></div>
<div class="ttc" id="a00253_html_a6a44057228e5f4b86e1c4d04b2a28977"><div class="ttname"><a href="a00253.html#a6a44057228e5f4b86e1c4d04b2a28977">_XDIR_</a></div><div class="ttdeci">#define _XDIR_</div><div class="ttdef"><b>Definition:</b> <a href="a00253_source.html#l00075">euler1d.h:75</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ab58cddae812df829602dd187dd66d609"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">__global__ void gpuNavierStokes3DParabolicFunction_Xdir_kernel </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>npoints_grid</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>two_third</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>inv_gamma_m1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>inv_Re</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>inv_Pr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double *__restrict__&#160;</td>
          <td class="paramname"><em>Q</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double *__restrict__&#160;</td>
          <td class="paramname"><em>QDerivX</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double *__restrict__&#160;</td>
          <td class="paramname"><em>QDerivY</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double *__restrict__&#160;</td>
          <td class="paramname"><em>QDerivZ</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *__restrict__&#160;</td>
          <td class="paramname"><em>FViscous</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Kernel function </p>

<p>Definition at line <a class="el" href="a00534_source.html#l00569">569</a> of file <a class="el" href="a00534_source.html">NavierStokes3DParabolicFunction_GPU.cu</a>.</p>
<div class="fragment"><div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;{</div>
<div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;    <span class="keywordtype">int</span> p = blockDim.x * blockIdx.x + threadIdx.x;</div>
<div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;</div>
<div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;    <span class="keywordflow">if</span> (p &lt; npoints_grid) {</div>
<div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;        <span class="keywordtype">double</span> uvel, vvel, wvel, T, Tx,</div>
<div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;               ux, uy, uz, vx, vy, wx, wz;</div>
<div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160;</div>
<div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160;        uvel = (Q+p+  npoints_grid)[0];</div>
<div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;        vvel = (Q+p+2*npoints_grid)[0];</div>
<div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160;        wvel = (Q+p+3*npoints_grid)[0];</div>
<div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160;        T    = (Q+p+4*npoints_grid)[0];</div>
<div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160;        Tx   = (QDerivX+p+4*npoints_grid)[0];</div>
<div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160;        ux   = (QDerivX+p+  npoints_grid)[0];</div>
<div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160;        vx   = (QDerivX+p+2*npoints_grid)[0];</div>
<div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160;        wx   = (QDerivX+p+3*npoints_grid)[0];</div>
<div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;        uy   = (QDerivY+p+  npoints_grid)[0];</div>
<div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160;        vy   = (QDerivY+p+2*npoints_grid)[0];</div>
<div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160;        uz   = (QDerivZ+p+  npoints_grid)[0];</div>
<div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;        wz   = (QDerivZ+p+3*npoints_grid)[0];</div>
<div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160;</div>
<div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160;        <span class="comment">/* calculate viscosity coeff based on Sutherland&#39;s law */</span></div>
<div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160;        <span class="keywordtype">double</span> mu = <a class="code" href="a00245.html#a840eef18a5986381093ff8c176a2153c">raiseto</a>(T, 0.76);</div>
<div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160;        <span class="keywordtype">double</span> tau_xx, tau_xy, tau_xz, qx;</div>
<div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160;        tau_xx = two_third * (mu*inv_Re) * (2*ux - vy - wz);</div>
<div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160;        tau_xy = (mu*inv_Re) * (uy + vx);</div>
<div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160;        tau_xz = (mu*inv_Re) * (uz + wx);</div>
<div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160;        qx     = ( mu*inv_Re * inv_gamma_m1 * inv_Pr ) * Tx;</div>
<div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160;</div>
<div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160;        (FViscous+p)[0] = 0.0;</div>
<div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160;        (FViscous+p+  npoints_grid)[0] = tau_xx;</div>
<div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;        (FViscous+p+2*npoints_grid)[0] = tau_xy;</div>
<div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160;        (FViscous+p+3*npoints_grid)[0] = tau_xz;</div>
<div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160;        (FViscous+p+4*npoints_grid)[0] = uvel*tau_xx + vvel*tau_xy + wvel*tau_xz + qx;</div>
<div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160;    }</div>
<div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160;    <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160;}</div>
<div class="ttc" id="a00245_html_a840eef18a5986381093ff8c176a2153c"><div class="ttname"><a href="a00245.html#a840eef18a5986381093ff8c176a2153c">raiseto</a></div><div class="ttdeci">#define raiseto(x, a)</div><div class="ttdef"><b>Definition:</b> <a href="a00245_source.html#l00037">math_ops.h:37</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a883e986e6ec1ec4d2a3f4d9f12ed74bc"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">__global__ void gpuNavierStokes3DParabolicFunction_Ydir_kernel </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>npoints_grid</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>two_third</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>inv_gamma_m1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>inv_Re</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>inv_Pr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double *__restrict__&#160;</td>
          <td class="paramname"><em>Q</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double *__restrict__&#160;</td>
          <td class="paramname"><em>QDerivX</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double *__restrict__&#160;</td>
          <td class="paramname"><em>QDerivY</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double *__restrict__&#160;</td>
          <td class="paramname"><em>QDerivZ</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *__restrict__&#160;</td>
          <td class="paramname"><em>FViscous</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Kernel function </p>

<p>Definition at line <a class="el" href="a00534_source.html#l00620">620</a> of file <a class="el" href="a00534_source.html">NavierStokes3DParabolicFunction_GPU.cu</a>.</p>
<div class="fragment"><div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160;{</div>
<div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160;    <span class="keywordtype">int</span> p = blockDim.x * blockIdx.x + threadIdx.x;</div>
<div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160;    <span class="keywordflow">if</span> (p &lt; npoints_grid) {</div>
<div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160;        <span class="keywordtype">double</span> uvel, vvel, wvel, T, Ty,</div>
<div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160;               ux, uy, vx, vy, vz, wy, wz;</div>
<div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160;</div>
<div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160;        uvel = (Q+p+  npoints_grid)[0];</div>
<div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160;        vvel = (Q+p+2*npoints_grid)[0];</div>
<div class="line"><a name="l00640"></a><span class="lineno">  640</span>&#160;        wvel = (Q+p+3*npoints_grid)[0];</div>
<div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160;        T    = (Q+p+4*npoints_grid)[0];</div>
<div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160;        Ty   = (QDerivY+p+4*npoints_grid)[0];</div>
<div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160;        ux   = (QDerivX+p+  npoints_grid)[0];</div>
<div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160;        vx   = (QDerivX+p+2*npoints_grid)[0];</div>
<div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160;        uy   = (QDerivY+p+  npoints_grid)[0];</div>
<div class="line"><a name="l00646"></a><span class="lineno">  646</span>&#160;        vy   = (QDerivY+p+2*npoints_grid)[0];</div>
<div class="line"><a name="l00647"></a><span class="lineno">  647</span>&#160;        wy   = (QDerivY+p+3*npoints_grid)[0];</div>
<div class="line"><a name="l00648"></a><span class="lineno">  648</span>&#160;        vz   = (QDerivZ+p+2*npoints_grid)[0];</div>
<div class="line"><a name="l00649"></a><span class="lineno">  649</span>&#160;        wz   = (QDerivZ+p+3*npoints_grid)[0];</div>
<div class="line"><a name="l00650"></a><span class="lineno">  650</span>&#160;</div>
<div class="line"><a name="l00651"></a><span class="lineno">  651</span>&#160;        <span class="comment">/* calculate viscosity coeff based on Sutherland&#39;s law */</span></div>
<div class="line"><a name="l00652"></a><span class="lineno">  652</span>&#160;        <span class="keywordtype">double</span> mu = <a class="code" href="a00245.html#a840eef18a5986381093ff8c176a2153c">raiseto</a>(T, 0.76);</div>
<div class="line"><a name="l00653"></a><span class="lineno">  653</span>&#160;</div>
<div class="line"><a name="l00654"></a><span class="lineno">  654</span>&#160;        <span class="keywordtype">double</span> tau_yx, tau_yy, tau_yz, qy;</div>
<div class="line"><a name="l00655"></a><span class="lineno">  655</span>&#160;        tau_yx = (mu*inv_Re) * (uy + vx);</div>
<div class="line"><a name="l00656"></a><span class="lineno">  656</span>&#160;        tau_yy = two_third * (mu*inv_Re) * (-ux + 2*vy - wz);</div>
<div class="line"><a name="l00657"></a><span class="lineno">  657</span>&#160;        tau_yz = (mu*inv_Re) * (vz + wy);</div>
<div class="line"><a name="l00658"></a><span class="lineno">  658</span>&#160;        qy     = ( mu*inv_Re * inv_gamma_m1 * inv_Pr ) * Ty;</div>
<div class="line"><a name="l00659"></a><span class="lineno">  659</span>&#160;</div>
<div class="line"><a name="l00660"></a><span class="lineno">  660</span>&#160;        (FViscous+p)[0] = 0.0;</div>
<div class="line"><a name="l00661"></a><span class="lineno">  661</span>&#160;        (FViscous+p+  npoints_grid)[0] = tau_yx;</div>
<div class="line"><a name="l00662"></a><span class="lineno">  662</span>&#160;        (FViscous+p+2*npoints_grid)[0] = tau_yy;</div>
<div class="line"><a name="l00663"></a><span class="lineno">  663</span>&#160;        (FViscous+p+3*npoints_grid)[0] = tau_yz;</div>
<div class="line"><a name="l00664"></a><span class="lineno">  664</span>&#160;        (FViscous+p+4*npoints_grid)[0] = uvel*tau_yx + vvel*tau_yy + wvel*tau_yz + qy;</div>
<div class="line"><a name="l00665"></a><span class="lineno">  665</span>&#160;    }</div>
<div class="line"><a name="l00666"></a><span class="lineno">  666</span>&#160;    <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00667"></a><span class="lineno">  667</span>&#160;}</div>
<div class="ttc" id="a00245_html_a840eef18a5986381093ff8c176a2153c"><div class="ttname"><a href="a00245.html#a840eef18a5986381093ff8c176a2153c">raiseto</a></div><div class="ttdeci">#define raiseto(x, a)</div><div class="ttdef"><b>Definition:</b> <a href="a00245_source.html#l00037">math_ops.h:37</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a7a13759038ad4bfdecc12c9f69e3db65"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">__global__ void gpuNavierStokes3DParabolicFunction_Zdir_kernel </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>npoints_grid</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>two_third</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>inv_gamma_m1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>inv_Re</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>inv_Pr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double *__restrict__&#160;</td>
          <td class="paramname"><em>Q</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double *__restrict__&#160;</td>
          <td class="paramname"><em>QDerivX</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double *__restrict__&#160;</td>
          <td class="paramname"><em>QDerivY</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double *__restrict__&#160;</td>
          <td class="paramname"><em>QDerivZ</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *__restrict__&#160;</td>
          <td class="paramname"><em>FViscous</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Kernel function </p>

<p>Definition at line <a class="el" href="a00534_source.html#l00671">671</a> of file <a class="el" href="a00534_source.html">NavierStokes3DParabolicFunction_GPU.cu</a>.</p>
<div class="fragment"><div class="line"><a name="l00683"></a><span class="lineno">  683</span>&#160;{</div>
<div class="line"><a name="l00684"></a><span class="lineno">  684</span>&#160;    <span class="keywordtype">int</span> p = blockDim.x * blockIdx.x + threadIdx.x;</div>
<div class="line"><a name="l00685"></a><span class="lineno">  685</span>&#160;    <span class="keywordflow">if</span> (p &lt; npoints_grid) {</div>
<div class="line"><a name="l00686"></a><span class="lineno">  686</span>&#160;        <span class="keywordtype">double</span> uvel, vvel, wvel, T, Tz,</div>
<div class="line"><a name="l00687"></a><span class="lineno">  687</span>&#160;               ux, uz, vy, vz, wx, wy, wz;</div>
<div class="line"><a name="l00688"></a><span class="lineno">  688</span>&#160;</div>
<div class="line"><a name="l00689"></a><span class="lineno">  689</span>&#160;        uvel = (Q+p+  npoints_grid)[0];</div>
<div class="line"><a name="l00690"></a><span class="lineno">  690</span>&#160;        vvel = (Q+p+2*npoints_grid)[0];</div>
<div class="line"><a name="l00691"></a><span class="lineno">  691</span>&#160;        wvel = (Q+p+3*npoints_grid)[0];</div>
<div class="line"><a name="l00692"></a><span class="lineno">  692</span>&#160;        T    = (Q+p+4*npoints_grid)[0];</div>
<div class="line"><a name="l00693"></a><span class="lineno">  693</span>&#160;        Tz   = (QDerivZ+p+4*npoints_grid)[0];</div>
<div class="line"><a name="l00694"></a><span class="lineno">  694</span>&#160;        ux   = (QDerivX+p+  npoints_grid)[0];</div>
<div class="line"><a name="l00695"></a><span class="lineno">  695</span>&#160;        wx   = (QDerivX+p+3*npoints_grid)[0];</div>
<div class="line"><a name="l00696"></a><span class="lineno">  696</span>&#160;        vy   = (QDerivY+p+2*npoints_grid)[0];</div>
<div class="line"><a name="l00697"></a><span class="lineno">  697</span>&#160;        wy   = (QDerivY+p+3*npoints_grid)[0];</div>
<div class="line"><a name="l00698"></a><span class="lineno">  698</span>&#160;        uz   = (QDerivZ+p+  npoints_grid)[0];</div>
<div class="line"><a name="l00699"></a><span class="lineno">  699</span>&#160;        vz   = (QDerivZ+p+2*npoints_grid)[0];</div>
<div class="line"><a name="l00700"></a><span class="lineno">  700</span>&#160;        wz   = (QDerivZ+p+3*npoints_grid)[0];</div>
<div class="line"><a name="l00701"></a><span class="lineno">  701</span>&#160;</div>
<div class="line"><a name="l00702"></a><span class="lineno">  702</span>&#160;        <span class="comment">/* calculate viscosity coeff based on Sutherland&#39;s law */</span></div>
<div class="line"><a name="l00703"></a><span class="lineno">  703</span>&#160;        <span class="keywordtype">double</span> mu = <a class="code" href="a00245.html#a840eef18a5986381093ff8c176a2153c">raiseto</a>(T,0.76);</div>
<div class="line"><a name="l00704"></a><span class="lineno">  704</span>&#160;</div>
<div class="line"><a name="l00705"></a><span class="lineno">  705</span>&#160;        <span class="keywordtype">double</span> tau_zx, tau_zy, tau_zz, qz;</div>
<div class="line"><a name="l00706"></a><span class="lineno">  706</span>&#160;        tau_zx = (mu*inv_Re) * (uz + wx);</div>
<div class="line"><a name="l00707"></a><span class="lineno">  707</span>&#160;        tau_zy = (mu*inv_Re) * (vz + wy);</div>
<div class="line"><a name="l00708"></a><span class="lineno">  708</span>&#160;        tau_zz = two_third * (mu*inv_Re) * (-ux - vy + 2*wz);</div>
<div class="line"><a name="l00709"></a><span class="lineno">  709</span>&#160;        qz     = ( mu*inv_Re * inv_gamma_m1 * inv_Pr ) * Tz;</div>
<div class="line"><a name="l00710"></a><span class="lineno">  710</span>&#160;</div>
<div class="line"><a name="l00711"></a><span class="lineno">  711</span>&#160;        (FViscous+p)[0] = 0.0;</div>
<div class="line"><a name="l00712"></a><span class="lineno">  712</span>&#160;        (FViscous+p+  npoints_grid)[0] = tau_zx;</div>
<div class="line"><a name="l00713"></a><span class="lineno">  713</span>&#160;        (FViscous+p+2*npoints_grid)[0] = tau_zy;</div>
<div class="line"><a name="l00714"></a><span class="lineno">  714</span>&#160;        (FViscous+p+3*npoints_grid)[0] = tau_zz;</div>
<div class="line"><a name="l00715"></a><span class="lineno">  715</span>&#160;        (FViscous+p+4*npoints_grid)[0] = uvel*tau_zx + vvel*tau_zy + wvel*tau_zz + qz;</div>
<div class="line"><a name="l00716"></a><span class="lineno">  716</span>&#160;    }</div>
<div class="line"><a name="l00717"></a><span class="lineno">  717</span>&#160;    <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00718"></a><span class="lineno">  718</span>&#160;}</div>
<div class="ttc" id="a00245_html_a840eef18a5986381093ff8c176a2153c"><div class="ttname"><a href="a00245.html#a840eef18a5986381093ff8c176a2153c">raiseto</a></div><div class="ttdeci">#define raiseto(x, a)</div><div class="ttdef"><b>Definition:</b> <a href="a00245_source.html#l00037">math_ops.h:37</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ac93d2dd0f138357c465a33a1bbfd7592"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">__global__ void gpuNavierStokes3DParabolicFunction_par_kernel </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>npoints_grid</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>npoints_local_wghosts</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>ghosts</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>dir</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int *__restrict__&#160;</td>
          <td class="paramname"><em>dim</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double *__restrict__&#160;</td>
          <td class="paramname"><em>dxinv</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double *__restrict__&#160;</td>
          <td class="paramname"><em>FDeriv</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *__restrict__&#160;</td>
          <td class="paramname"><em>par</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Kernel function </p>

<p>Definition at line <a class="el" href="a00534_source.html#l00722">722</a> of file <a class="el" href="a00534_source.html">NavierStokes3DParabolicFunction_GPU.cu</a>.</p>
<div class="fragment"><div class="line"><a name="l00732"></a><span class="lineno">  732</span>&#160;{</div>
<div class="line"><a name="l00733"></a><span class="lineno">  733</span>&#160;    <span class="keywordtype">int</span> p = blockDim.x * blockIdx.x + threadIdx.x;</div>
<div class="line"><a name="l00734"></a><span class="lineno">  734</span>&#160;</div>
<div class="line"><a name="l00735"></a><span class="lineno">  735</span>&#160;    <span class="keywordflow">if</span> (p &lt; npoints_grid) {</div>
<div class="line"><a name="l00736"></a><span class="lineno">  736</span>&#160;        <span class="keywordtype">int</span> index[3];</div>
<div class="line"><a name="l00737"></a><span class="lineno">  737</span>&#160;        <span class="keywordtype">double</span> dxinv_val;</div>
<div class="line"><a name="l00738"></a><span class="lineno">  738</span>&#160;</div>
<div class="line"><a name="l00739"></a><span class="lineno">  739</span>&#160;        <a class="code" href="a00231.html#a03f49e4d44ae8aca85cb04cfe91e4ce4">_ArrayIndexnD_</a>(<a class="code" href="a00253.html#a57771c952ec174601addf43e1c0202b2">_MODEL_NDIMS_</a>,p,dim,index,0);</div>
<div class="line"><a name="l00740"></a><span class="lineno">  740</span>&#160;        <a class="code" href="a00231.html#afbb862a2fdf5b72b1f9ace42f64b556f">_ArrayIndex1D_</a>(<a class="code" href="a00253.html#a57771c952ec174601addf43e1c0202b2">_MODEL_NDIMS_</a>,dim,index,ghosts,p);</div>
<div class="line"><a name="l00741"></a><span class="lineno">  741</span>&#160;        <a class="code" href="a00233.html#a9aa9bad8531d6733731a850ccc471a42">_GetCoordinate_</a>(dir,index[dir],dim,ghosts,dxinv,dxinv_val);</div>
<div class="line"><a name="l00742"></a><span class="lineno">  742</span>&#160;</div>
<div class="line"><a name="l00743"></a><span class="lineno">  743</span>&#160;<span class="preprocessor">        #pragma unroll</span></div>
<div class="line"><a name="l00744"></a><span class="lineno">  744</span>&#160;<span class="preprocessor"></span>        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> v=0; v&lt;<a class="code" href="a00253.html#ad3395a55a5fde64d6603c7a82d7bf2c7">_MODEL_NVARS_</a>; v++) {</div>
<div class="line"><a name="l00745"></a><span class="lineno">  745</span>&#160;            (par+p+v*npoints_local_wghosts)[0] += (dxinv_val * (FDeriv+p+v*npoints_local_wghosts)[0]);</div>
<div class="line"><a name="l00746"></a><span class="lineno">  746</span>&#160;        }</div>
<div class="line"><a name="l00747"></a><span class="lineno">  747</span>&#160;    }</div>
<div class="line"><a name="l00748"></a><span class="lineno">  748</span>&#160;    <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00749"></a><span class="lineno">  749</span>&#160;}</div>
<div class="ttc" id="a00253_html_ad3395a55a5fde64d6603c7a82d7bf2c7"><div class="ttname"><a href="a00253.html#ad3395a55a5fde64d6603c7a82d7bf2c7">_MODEL_NVARS_</a></div><div class="ttdeci">#define _MODEL_NVARS_</div><div class="ttdef"><b>Definition:</b> <a href="a00253_source.html#l00058">euler1d.h:58</a></div></div>
<div class="ttc" id="a00231_html_a03f49e4d44ae8aca85cb04cfe91e4ce4"><div class="ttname"><a href="a00231.html#a03f49e4d44ae8aca85cb04cfe91e4ce4">_ArrayIndexnD_</a></div><div class="ttdeci">#define _ArrayIndexnD_(N, index, imax, i, ghost)</div><div class="ttdef"><b>Definition:</b> <a href="a00231_source.html#l00021">arrayfunctions.h:21</a></div></div>
<div class="ttc" id="a00233_html_a9aa9bad8531d6733731a850ccc471a42"><div class="ttname"><a href="a00233.html#a9aa9bad8531d6733731a850ccc471a42">_GetCoordinate_</a></div><div class="ttdeci">#define _GetCoordinate_(dir, i, dim, ghosts, x, coord)</div><div class="ttdef"><b>Definition:</b> <a href="a00233_source.html#l00031">basic.h:31</a></div></div>
<div class="ttc" id="a00253_html_a57771c952ec174601addf43e1c0202b2"><div class="ttname"><a href="a00253.html#a57771c952ec174601addf43e1c0202b2">_MODEL_NDIMS_</a></div><div class="ttdeci">#define _MODEL_NDIMS_</div><div class="ttdef"><b>Definition:</b> <a href="a00253_source.html#l00056">euler1d.h:56</a></div></div>
<div class="ttc" id="a00231_html_afbb862a2fdf5b72b1f9ace42f64b556f"><div class="ttname"><a href="a00231.html#afbb862a2fdf5b72b1f9ace42f64b556f">_ArrayIndex1D_</a></div><div class="ttdeci">#define _ArrayIndex1D_(N, imax, i, ghost, index)</div><div class="ttdef"><b>Definition:</b> <a href="a00231_source.html#l00040">arrayfunctions.h:40</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a8cc7f5c6a830e004704e2bd0c15f247e"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int gpuNavierStokes3DParabolicFunction </td>
          <td>(</td>
          <td class="paramtype">double *__restrict__&#160;</td>
          <td class="paramname"><em>par</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *__restrict__&#160;</td>
          <td class="paramname"><em>u</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *__restrict__&#160;</td>
          <td class="paramname"><em>s</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *__restrict__&#160;</td>
          <td class="paramname"><em>m</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>t</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Compute the viscous terms in the 3D Navier Stokes equations: this function computes the following: </p>
<p class="formulaDsp">
\begin{equation} \frac {\partial} {\partial x} \left[\begin{array}{c} 0 \\ \tau_{xx} \\ \tau_{yx} \\ \tau_{zx} \\ u \tau_{xx} + v \tau_{yx} + w \tau_{zx} - q_x \end{array}\right] + \frac {\partial} {\partial y} \left[\begin{array}{c} 0 \\ \tau_{xy} \\ \tau_{yy} \\ \tau_{zy} \\ u \tau_{xy} + v \tau_{yy} + w \tau_{zy} - q_y \end{array}\right] + \frac {\partial} {\partial z} \left[\begin{array}{c} 0 \\ \tau_{xz} \\ \tau_{yz} \\ \tau_{zz} \\ u \tau_{xz} + v \tau_{yz} + w \tau_{zz} - q_z \end{array}\right] \end{equation}
</p>
<p> where </p>
<p class="formulaDsp">
\begin{align} \tau_{xx} &amp;= \frac{2}{3}\left(\frac{\mu}{Re}\right)\left(2\frac{\partial u}{\partial x} - \frac{\partial v}{\partial y} - \frac{\partial w}{\partial z}\right),\\ \tau_{xy} &amp;= \left(\frac{\mu}{Re}\right)\left(\frac{\partial u}{\partial y} + \frac{\partial v}{\partial x}\right),\\ \tau_{xz} &amp;= \left(\frac{\mu}{Re}\right)\left(\frac{\partial u}{\partial z} + \frac{\partial w}{\partial x}\right),\\ \tau_{yx} &amp;= \left(\frac{\mu}{Re}\right)\left(\frac{\partial u}{\partial y} + \frac{\partial v}{\partial x}\right),\\ \tau_{yy} &amp;= \frac{2}{3}\left(\frac{\mu}{Re}\right)\left(-\frac{\partial u}{\partial x} +2\frac{\partial v}{\partial y} - \frac{\partial w}{\partial z}\right),\\ \tau_{yz} &amp;= \left(\frac{\mu}{Re}\right)\left(\frac{\partial w}{\partial y} + \frac{\partial v}{\partial z}\right),\\ \tau_{zx} &amp;= \left(\frac{\mu}{Re}\right)\left(\frac{\partial u}{\partial z} + \frac{\partial w}{\partial x}\right),\\ \tau_{zy} &amp;= \left(\frac{\mu}{Re}\right)\left(\frac{\partial v}{\partial z} + \frac{\partial w}{\partial y}\right),\\ \tau_{zz} &amp;= \frac{2}{3}\left(\frac{\mu}{Re}\right)\left(-\frac{\partial u}{\partial x} - \frac{\partial v}{\partial y} + 2\frac{\partial v}{\partial y}\right),\\ q_x &amp;= -\frac{mu}{\left(\gamma-1\right)Re Pr}\frac{\partial T}{\partial x}, \\ q_y &amp;= -\frac{mu}{\left(\gamma-1\right)Re Pr}\frac{\partial T}{\partial y}, \\ q_z &amp;= -\frac{mu}{\left(\gamma-1\right)Re Pr}\frac{\partial T}{\partial z} \end{align}
</p>
<p> and the temperature is \(T = \gamma p/\rho\). \(Re\) and \(Pr\) are the Reynolds and Prandtl numbers, respectively. Note that this function computes the entire parabolic term, and thus bypasses <a class="el" href="a00204.html" title="Structure containing all solver-specific variables and functions. ">HyPar</a>'s parabolic function calculation interfaces. <a class="el" href="a00210.html#a0385acf3caf014aa7491ad2fc6a9572a">NavierStokes3DInitialize()</a> assigns this function to <a class="el" href="a00204.html#a75e8be4ea8c1ae2e99fc1e802e69a573">HyPar::ParabolicFunction</a>. <br/>
<br/>
Reference:</p>
<ul>
<li>Tannehill, Anderson and Pletcher, Computational Fluid Mechanics and Heat Transfer, Chapter 5, Section 5.1.7 (However, the non-dimensional velocity and the Reynolds number is based on speed of sound, instead of the freestream velocity). </li>
</ul>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">par</td><td>Array to hold the computed viscous terms </td></tr>
    <tr><td class="paramname">u</td><td>Solution vector array </td></tr>
    <tr><td class="paramname">s</td><td>Solver object of type <a class="el" href="a00204.html" title="Structure containing all solver-specific variables and functions. ">HyPar</a> </td></tr>
    <tr><td class="paramname">m</td><td>MPI object of type <a class="el" href="a00207.html#a00674" title="Structure of MPI-related variables. ">MPIVariables</a> </td></tr>
    <tr><td class="paramname">t</td><td>Current simulation time </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="a00534_source.html#l00783">783</a> of file <a class="el" href="a00534_source.html">NavierStokes3DParabolicFunction_GPU.cu</a>.</p>
<div class="fragment"><div class="line"><a name="l00790"></a><span class="lineno">  790</span>&#160;{</div>
<div class="line"><a name="l00791"></a><span class="lineno">  791</span>&#160;  <a class="code" href="a00204.html">HyPar</a>           *solver   = (<a class="code" href="a00204.html">HyPar</a>*) s;</div>
<div class="line"><a name="l00792"></a><span class="lineno">  792</span>&#160;  <a class="code" href="a00207.html#a00674">MPIVariables</a>    *mpi      = (<a class="code" href="a00207.html#a00674">MPIVariables</a>*) m;</div>
<div class="line"><a name="l00793"></a><span class="lineno">  793</span>&#160;  <a class="code" href="a00210.html#a00676">NavierStokes3D</a>  *physics  = (<a class="code" href="a00210.html#a00676">NavierStokes3D</a>*) solver-&gt;<a class="code" href="a00204.html#a48e81a1806b5774943fd9a26e9a190f2">physics</a>;</div>
<div class="line"><a name="l00794"></a><span class="lineno">  794</span>&#160;</div>
<div class="line"><a name="l00795"></a><span class="lineno">  795</span>&#160;  <span class="keywordtype">int</span> ghosts = solver-&gt;<a class="code" href="a00204.html#aafc992b5fa79d5a4036024615d03bce6">ghosts</a>;</div>
<div class="line"><a name="l00796"></a><span class="lineno">  796</span>&#160;  <span class="keywordtype">int</span> *dim   = solver-&gt;<a class="code" href="a00204.html#aada0460ecc47924f438072324b8806f5">gpu_dim_local</a>;</div>
<div class="line"><a name="l00797"></a><span class="lineno">  797</span>&#160;  <span class="keywordtype">int</span> size   = solver-&gt;<a class="code" href="a00204.html#a20ee1fd00a220b98513127884a5558cf">npoints_local_wghosts</a>;</div>
<div class="line"><a name="l00798"></a><span class="lineno">  798</span>&#160;</div>
<div class="line"><a name="l00799"></a><span class="lineno">  799</span>&#160;  <a class="code" href="a00232.html#a5211607a9910a4d3fd4c7001794c91ee">gpuMemset</a>(par, 0, size*<a class="code" href="a00253.html#ad3395a55a5fde64d6603c7a82d7bf2c7">_MODEL_NVARS_</a>*<span class="keyword">sizeof</span>(<span class="keywordtype">double</span>));</div>
<div class="line"><a name="l00800"></a><span class="lineno">  800</span>&#160;  <span class="keywordflow">if</span> (physics-&gt;<a class="code" href="a00210.html#a3b92a4b98cedf64473b3c13dfa7674b4">Re</a> &lt;= 0) <span class="keywordflow">return</span> (0); <span class="comment">/* inviscid flow */</span></div>
<div class="line"><a name="l00801"></a><span class="lineno">  801</span>&#160;  solver-&gt;<a class="code" href="a00204.html#a6e3288a129bfd334448fbf3089338b69">count_par</a>++;</div>
<div class="line"><a name="l00802"></a><span class="lineno">  802</span>&#160;</div>
<div class="line"><a name="l00803"></a><span class="lineno">  803</span>&#160;  <span class="keyword">static</span> <span class="keywordtype">double</span> two_third    = 2.0/3.0;</div>
<div class="line"><a name="l00804"></a><span class="lineno">  804</span>&#160;  <span class="keywordtype">double</span>        inv_gamma_m1 = 1.0 / (physics-&gt;<a class="code" href="a00210.html#a72f9e01745b3a8203067ab84aefc9aea">gamma</a>-1.0);</div>
<div class="line"><a name="l00805"></a><span class="lineno">  805</span>&#160;  <span class="keywordtype">double</span>        inv_Re       = 1.0 / physics-&gt;<a class="code" href="a00210.html#a3b92a4b98cedf64473b3c13dfa7674b4">Re</a>;</div>
<div class="line"><a name="l00806"></a><span class="lineno">  806</span>&#160;  <span class="keywordtype">double</span>        inv_Pr       = 1.0 / physics-&gt;<a class="code" href="a00210.html#af0f6e03342b9eb912e25f94ce0249a2c">Pr</a>;</div>
<div class="line"><a name="l00807"></a><span class="lineno">  807</span>&#160;</div>
<div class="line"><a name="l00808"></a><span class="lineno">  808</span>&#160;  <span class="keywordtype">double</span> *Q       = physics-&gt;<a class="code" href="a00210.html#ac68c83d8b02659d5b73bf43a21e4e27d">gpu_Q</a>;</div>
<div class="line"><a name="l00809"></a><span class="lineno">  809</span>&#160;  <span class="keywordtype">double</span> *QDerivX = physics-&gt;<a class="code" href="a00210.html#a0872d81dca20500a94be0015c8033eaf">gpu_QDerivX</a>;</div>
<div class="line"><a name="l00810"></a><span class="lineno">  810</span>&#160;  <span class="keywordtype">double</span> *QDerivY = physics-&gt;<a class="code" href="a00210.html#aac34b435c6a77b49a174eefd56abc209">gpu_QDerivY</a>;</div>
<div class="line"><a name="l00811"></a><span class="lineno">  811</span>&#160;  <span class="keywordtype">double</span> *QDerivZ = physics-&gt;<a class="code" href="a00210.html#acd001d1ac51a4fbab8c32ae413d1df7e">gpu_QDerivZ</a>;</div>
<div class="line"><a name="l00812"></a><span class="lineno">  812</span>&#160;  <span class="keywordtype">double</span> *dxinv   = solver-&gt;<a class="code" href="a00204.html#a7a147598c79bd4c442a294cac219ca82">gpu_dxinv</a>;</div>
<div class="line"><a name="l00813"></a><span class="lineno">  813</span>&#160;</div>
<div class="line"><a name="l00814"></a><span class="lineno">  814</span>&#160;  <span class="keywordtype">int</span> nblocks = (size-1)/<a class="code" href="a00234.html#aceca9611b1e048e233f2d9cc02f70796">GPU_THREADS_PER_BLOCK</a> + 1;</div>
<div class="line"><a name="l00815"></a><span class="lineno">  815</span>&#160;  <span class="keywordtype">int</span> nblocks_par = (solver-&gt;<a class="code" href="a00204.html#afae6319baba315ac1f0c56505610ed85">npoints_local</a>-1)/<a class="code" href="a00234.html#aceca9611b1e048e233f2d9cc02f70796">GPU_THREADS_PER_BLOCK</a> + 1;</div>
<div class="line"><a name="l00816"></a><span class="lineno">  816</span>&#160;</div>
<div class="line"><a name="l00817"></a><span class="lineno">  817</span>&#160;<span class="preprocessor">#if defined(GPU_STAT)</span></div>
<div class="line"><a name="l00818"></a><span class="lineno">  818</span>&#160;<span class="preprocessor"></span>  cudaEvent_t startEvent, stopEvent;</div>
<div class="line"><a name="l00819"></a><span class="lineno">  819</span>&#160;  <span class="keywordtype">float</span> milliseconds;</div>
<div class="line"><a name="l00820"></a><span class="lineno">  820</span>&#160;</div>
<div class="line"><a name="l00821"></a><span class="lineno">  821</span>&#160;  checkCuda( cudaEventCreate(&amp;startEvent) );</div>
<div class="line"><a name="l00822"></a><span class="lineno">  822</span>&#160;  checkCuda( cudaEventCreate(&amp;stopEvent) );</div>
<div class="line"><a name="l00823"></a><span class="lineno">  823</span>&#160;</div>
<div class="line"><a name="l00824"></a><span class="lineno">  824</span>&#160;  checkCuda( cudaEventRecord(startEvent, 0) );</div>
<div class="line"><a name="l00825"></a><span class="lineno">  825</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00826"></a><span class="lineno">  826</span>&#160;<span class="preprocessor"></span></div>
<div class="line"><a name="l00827"></a><span class="lineno">  827</span>&#160;  gpuNavierStokes3DParabolicFunction_Q_kernel&lt;&lt;&lt;nblocks, GPU_THREADS_PER_BLOCK&gt;&gt;&gt;(</div>
<div class="line"><a name="l00828"></a><span class="lineno">  828</span>&#160;      size, physics-&gt;<a class="code" href="a00210.html#a72f9e01745b3a8203067ab84aefc9aea">gamma</a>, u, Q</div>
<div class="line"><a name="l00829"></a><span class="lineno">  829</span>&#160;  );</div>
<div class="line"><a name="l00830"></a><span class="lineno">  830</span>&#160;  cudaDeviceSynchronize();</div>
<div class="line"><a name="l00831"></a><span class="lineno">  831</span>&#160;</div>
<div class="line"><a name="l00832"></a><span class="lineno">  832</span>&#160;<span class="preprocessor">#if defined(GPU_STAT)</span></div>
<div class="line"><a name="l00833"></a><span class="lineno">  833</span>&#160;<span class="preprocessor"></span>  checkCuda( cudaEventRecord(stopEvent, 0) );</div>
<div class="line"><a name="l00834"></a><span class="lineno">  834</span>&#160;  checkCuda( cudaEventSynchronize(stopEvent) );</div>
<div class="line"><a name="l00835"></a><span class="lineno">  835</span>&#160;  checkCuda( cudaEventElapsedTime(&amp;milliseconds, startEvent, stopEvent) );</div>
<div class="line"><a name="l00836"></a><span class="lineno">  836</span>&#160;</div>
<div class="line"><a name="l00837"></a><span class="lineno">  837</span>&#160;  <span class="keywordtype">int</span> memory_accessed = size*<a class="code" href="a00253.html#ad3395a55a5fde64d6603c7a82d7bf2c7">_MODEL_NVARS_</a>*<span class="keyword">sizeof</span>(double);</div>
<div class="line"><a name="l00838"></a><span class="lineno">  838</span>&#160;  printf(<span class="stringliteral">&quot;%-50s GPU time (secs) = %.6f bandwidth (GB/s) = %6.2f\n&quot;</span>,</div>
<div class="line"><a name="l00839"></a><span class="lineno">  839</span>&#160;          <span class="stringliteral">&quot;NavierStokes3DParabolicFunction_Q&quot;</span>, milliseconds*1e-3,</div>
<div class="line"><a name="l00840"></a><span class="lineno">  840</span>&#160;          (1e-6*(memory_accessed)/milliseconds));</div>
<div class="line"><a name="l00841"></a><span class="lineno">  841</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00842"></a><span class="lineno">  842</span>&#160;<span class="preprocessor"></span></div>
<div class="line"><a name="l00843"></a><span class="lineno">  843</span>&#160;  solver-&gt;<a class="code" href="a00204.html#add4554e1a8a541607b867db7ec38d7a9">FirstDerivativePar</a>(QDerivX,Q,<a class="code" href="a00253.html#a6a44057228e5f4b86e1c4d04b2a28977">_XDIR_</a>,1,solver,mpi);</div>
<div class="line"><a name="l00844"></a><span class="lineno">  844</span>&#160;  solver-&gt;<a class="code" href="a00204.html#add4554e1a8a541607b867db7ec38d7a9">FirstDerivativePar</a>(QDerivY,Q,<a class="code" href="a00198.html#a7fd32e06617f4489079bc50ce9bfc00c">_YDIR_</a>,1,solver,mpi);</div>
<div class="line"><a name="l00845"></a><span class="lineno">  845</span>&#160;  solver-&gt;<a class="code" href="a00204.html#add4554e1a8a541607b867db7ec38d7a9">FirstDerivativePar</a>(QDerivZ,Q,<a class="code" href="a00210.html#a227beecac6bef022707512c15d39e30b">_ZDIR_</a>,1,solver,mpi);</div>
<div class="line"><a name="l00846"></a><span class="lineno">  846</span>&#160;</div>
<div class="line"><a name="l00847"></a><span class="lineno">  847</span>&#160;  <a class="code" href="a00250.html#aa1ec149b4854b17ec8d09c24f9eb9933">gpuMPIExchangeBoundariesnD</a>(<a class="code" href="a00253.html#a57771c952ec174601addf43e1c0202b2">_MODEL_NDIMS_</a>,<a class="code" href="a00253.html#ad3395a55a5fde64d6603c7a82d7bf2c7">_MODEL_NVARS_</a>,solver-&gt;<a class="code" href="a00204.html#aada0460ecc47924f438072324b8806f5">gpu_dim_local</a>,</div>
<div class="line"><a name="l00848"></a><span class="lineno">  848</span>&#160;                             solver-&gt;<a class="code" href="a00204.html#aafc992b5fa79d5a4036024615d03bce6">ghosts</a>,mpi,QDerivX);</div>
<div class="line"><a name="l00849"></a><span class="lineno">  849</span>&#160;  <a class="code" href="a00250.html#aa1ec149b4854b17ec8d09c24f9eb9933">gpuMPIExchangeBoundariesnD</a>(<a class="code" href="a00253.html#a57771c952ec174601addf43e1c0202b2">_MODEL_NDIMS_</a>,<a class="code" href="a00253.html#ad3395a55a5fde64d6603c7a82d7bf2c7">_MODEL_NVARS_</a>,solver-&gt;<a class="code" href="a00204.html#aada0460ecc47924f438072324b8806f5">gpu_dim_local</a>,</div>
<div class="line"><a name="l00850"></a><span class="lineno">  850</span>&#160;                             solver-&gt;<a class="code" href="a00204.html#aafc992b5fa79d5a4036024615d03bce6">ghosts</a>,mpi,QDerivY);</div>
<div class="line"><a name="l00851"></a><span class="lineno">  851</span>&#160;  <a class="code" href="a00250.html#aa1ec149b4854b17ec8d09c24f9eb9933">gpuMPIExchangeBoundariesnD</a>(<a class="code" href="a00253.html#a57771c952ec174601addf43e1c0202b2">_MODEL_NDIMS_</a>,<a class="code" href="a00253.html#ad3395a55a5fde64d6603c7a82d7bf2c7">_MODEL_NVARS_</a>,solver-&gt;<a class="code" href="a00204.html#aada0460ecc47924f438072324b8806f5">gpu_dim_local</a>,</div>
<div class="line"><a name="l00852"></a><span class="lineno">  852</span>&#160;                              solver-&gt;<a class="code" href="a00204.html#aafc992b5fa79d5a4036024615d03bce6">ghosts</a>,mpi,QDerivY);</div>
<div class="line"><a name="l00853"></a><span class="lineno">  853</span>&#160;</div>
<div class="line"><a name="l00854"></a><span class="lineno">  854</span>&#160;<span class="preprocessor">#if defined(GPU_STAT)</span></div>
<div class="line"><a name="l00855"></a><span class="lineno">  855</span>&#160;<span class="preprocessor"></span>  checkCuda( cudaEventRecord(startEvent, 0) );</div>
<div class="line"><a name="l00856"></a><span class="lineno">  856</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00857"></a><span class="lineno">  857</span>&#160;<span class="preprocessor"></span></div>
<div class="line"><a name="l00858"></a><span class="lineno">  858</span>&#160;  gpuNavierStokes3DParabolicFunction_QDeriv_kernel&lt;&lt;&lt;nblocks, GPU_THREADS_PER_BLOCK&gt;&gt;&gt;(</div>
<div class="line"><a name="l00859"></a><span class="lineno">  859</span>&#160;      size, ghosts, dim, dxinv, QDerivX, QDerivY, QDerivZ</div>
<div class="line"><a name="l00860"></a><span class="lineno">  860</span>&#160;  );</div>
<div class="line"><a name="l00861"></a><span class="lineno">  861</span>&#160;  cudaDeviceSynchronize();</div>
<div class="line"><a name="l00862"></a><span class="lineno">  862</span>&#160;</div>
<div class="line"><a name="l00863"></a><span class="lineno">  863</span>&#160;<span class="preprocessor">#if defined(GPU_STAT)</span></div>
<div class="line"><a name="l00864"></a><span class="lineno">  864</span>&#160;<span class="preprocessor"></span>  checkCuda( cudaEventRecord(stopEvent, 0) );</div>
<div class="line"><a name="l00865"></a><span class="lineno">  865</span>&#160;  checkCuda( cudaEventSynchronize(stopEvent) );</div>
<div class="line"><a name="l00866"></a><span class="lineno">  866</span>&#160;  checkCuda( cudaEventElapsedTime(&amp;milliseconds, startEvent, stopEvent) );</div>
<div class="line"><a name="l00867"></a><span class="lineno">  867</span>&#160;</div>
<div class="line"><a name="l00868"></a><span class="lineno">  868</span>&#160;  memory_accessed = (3*size*<a class="code" href="a00253.html#ad3395a55a5fde64d6603c7a82d7bf2c7">_MODEL_NVARS_</a> + solver-&gt;<a class="code" href="a00204.html#aec1dee03c858e0d3910c40c209890ab0">size_x</a>)*<span class="keyword">sizeof</span>(<span class="keywordtype">double</span>);</div>
<div class="line"><a name="l00869"></a><span class="lineno">  869</span>&#160;  printf(<span class="stringliteral">&quot;%-50s GPU time (secs) = %.6f bandwidth (GB/s) = %6.2f\n&quot;</span>,</div>
<div class="line"><a name="l00870"></a><span class="lineno">  870</span>&#160;          <span class="stringliteral">&quot;NavierStokes3DParabolicFunction_QDeriv&quot;</span>, milliseconds*1e-3,</div>
<div class="line"><a name="l00871"></a><span class="lineno">  871</span>&#160;          (1e-6*(memory_accessed)/milliseconds));</div>
<div class="line"><a name="l00872"></a><span class="lineno">  872</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00873"></a><span class="lineno">  873</span>&#160;<span class="preprocessor"></span></div>
<div class="line"><a name="l00874"></a><span class="lineno">  874</span>&#160;  <span class="keywordtype">double</span> *FViscous = physics-&gt;<a class="code" href="a00210.html#a8cee3f0ef5aebfbc141657057f441c4b">gpu_FViscous</a>;</div>
<div class="line"><a name="l00875"></a><span class="lineno">  875</span>&#160;  <span class="keywordtype">double</span> *FDeriv   = physics-&gt;<a class="code" href="a00210.html#a50d502373d4f9839405d29fe4baca580">gpu_FDeriv</a>;</div>
<div class="line"><a name="l00876"></a><span class="lineno">  876</span>&#160;  <a class="code" href="a00232.html#a5211607a9910a4d3fd4c7001794c91ee">gpuMemset</a>(FViscous, 0, size*<a class="code" href="a00253.html#ad3395a55a5fde64d6603c7a82d7bf2c7">_MODEL_NVARS_</a>*<span class="keyword">sizeof</span>(<span class="keywordtype">double</span>));</div>
<div class="line"><a name="l00877"></a><span class="lineno">  877</span>&#160;  <a class="code" href="a00232.html#a5211607a9910a4d3fd4c7001794c91ee">gpuMemset</a>(FDeriv, 0, size*<a class="code" href="a00253.html#ad3395a55a5fde64d6603c7a82d7bf2c7">_MODEL_NVARS_</a>*<span class="keyword">sizeof</span>(<span class="keywordtype">double</span>));</div>
<div class="line"><a name="l00878"></a><span class="lineno">  878</span>&#160;</div>
<div class="line"><a name="l00879"></a><span class="lineno">  879</span>&#160;  <span class="comment">/* Along X */</span></div>
<div class="line"><a name="l00880"></a><span class="lineno">  880</span>&#160;</div>
<div class="line"><a name="l00881"></a><span class="lineno">  881</span>&#160;<span class="preprocessor">#if defined(GPU_STAT)</span></div>
<div class="line"><a name="l00882"></a><span class="lineno">  882</span>&#160;<span class="preprocessor"></span>  checkCuda( cudaEventRecord(startEvent, 0) );</div>
<div class="line"><a name="l00883"></a><span class="lineno">  883</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00884"></a><span class="lineno">  884</span>&#160;<span class="preprocessor"></span></div>
<div class="line"><a name="l00885"></a><span class="lineno">  885</span>&#160;  gpuNavierStokes3DParabolicFunction_Xdir_kernel&lt;&lt;&lt;nblocks, GPU_THREADS_PER_BLOCK&gt;&gt;&gt;(</div>
<div class="line"><a name="l00886"></a><span class="lineno">  886</span>&#160;      size, two_third, inv_gamma_m1, inv_Re, inv_Pr, Q,</div>
<div class="line"><a name="l00887"></a><span class="lineno">  887</span>&#160;      QDerivX, QDerivY, QDerivZ, FViscous</div>
<div class="line"><a name="l00888"></a><span class="lineno">  888</span>&#160;  );</div>
<div class="line"><a name="l00889"></a><span class="lineno">  889</span>&#160;  cudaDeviceSynchronize();</div>
<div class="line"><a name="l00890"></a><span class="lineno">  890</span>&#160;</div>
<div class="line"><a name="l00891"></a><span class="lineno">  891</span>&#160;<span class="preprocessor">#if defined(GPU_STAT)</span></div>
<div class="line"><a name="l00892"></a><span class="lineno">  892</span>&#160;<span class="preprocessor"></span>  checkCuda( cudaEventRecord(stopEvent, 0) );</div>
<div class="line"><a name="l00893"></a><span class="lineno">  893</span>&#160;  checkCuda( cudaEventSynchronize(stopEvent) );</div>
<div class="line"><a name="l00894"></a><span class="lineno">  894</span>&#160;  checkCuda( cudaEventElapsedTime(&amp;milliseconds, startEvent, stopEvent) );</div>
<div class="line"><a name="l00895"></a><span class="lineno">  895</span>&#160;</div>
<div class="line"><a name="l00896"></a><span class="lineno">  896</span>&#160;  memory_accessed = 17*size*<span class="keyword">sizeof</span>(double);</div>
<div class="line"><a name="l00897"></a><span class="lineno">  897</span>&#160;  printf(<span class="stringliteral">&quot;%-50s GPU time (secs) = %.6f bandwidth (GB/s) = %6.2f\n&quot;</span>,</div>
<div class="line"><a name="l00898"></a><span class="lineno">  898</span>&#160;          <span class="stringliteral">&quot;NavierStokes3DParabolicFunction_Xdir&quot;</span>, milliseconds*1e-3,</div>
<div class="line"><a name="l00899"></a><span class="lineno">  899</span>&#160;          (1e-6*(memory_accessed)/milliseconds));</div>
<div class="line"><a name="l00900"></a><span class="lineno">  900</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00901"></a><span class="lineno">  901</span>&#160;<span class="preprocessor"></span></div>
<div class="line"><a name="l00902"></a><span class="lineno">  902</span>&#160;  solver-&gt;<a class="code" href="a00204.html#add4554e1a8a541607b867db7ec38d7a9">FirstDerivativePar</a>(FDeriv,FViscous,<a class="code" href="a00253.html#a6a44057228e5f4b86e1c4d04b2a28977">_XDIR_</a>,1,solver,mpi);</div>
<div class="line"><a name="l00903"></a><span class="lineno">  903</span>&#160;</div>
<div class="line"><a name="l00904"></a><span class="lineno">  904</span>&#160;<span class="preprocessor">#if defined(GPU_STAT)</span></div>
<div class="line"><a name="l00905"></a><span class="lineno">  905</span>&#160;<span class="preprocessor"></span>  checkCuda( cudaEventRecord(startEvent, 0) );</div>
<div class="line"><a name="l00906"></a><span class="lineno">  906</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00907"></a><span class="lineno">  907</span>&#160;<span class="preprocessor"></span></div>
<div class="line"><a name="l00908"></a><span class="lineno">  908</span>&#160;  gpuNavierStokes3DParabolicFunction_par_kernel&lt;&lt;&lt;nblocks_par, GPU_THREADS_PER_BLOCK&gt;&gt;&gt;(</div>
<div class="line"><a name="l00909"></a><span class="lineno">  909</span>&#160;      solver-&gt;<a class="code" href="a00204.html#afae6319baba315ac1f0c56505610ed85">npoints_local</a>, size, ghosts, <a class="code" href="a00253.html#a6a44057228e5f4b86e1c4d04b2a28977">_XDIR_</a>, dim, dxinv, FDeriv, par</div>
<div class="line"><a name="l00910"></a><span class="lineno">  910</span>&#160;  );</div>
<div class="line"><a name="l00911"></a><span class="lineno">  911</span>&#160;  cudaDeviceSynchronize();</div>
<div class="line"><a name="l00912"></a><span class="lineno">  912</span>&#160;</div>
<div class="line"><a name="l00913"></a><span class="lineno">  913</span>&#160;<span class="preprocessor">#if defined(GPU_STAT)</span></div>
<div class="line"><a name="l00914"></a><span class="lineno">  914</span>&#160;<span class="preprocessor"></span>  checkCuda( cudaEventRecord(stopEvent, 0) );</div>
<div class="line"><a name="l00915"></a><span class="lineno">  915</span>&#160;  checkCuda( cudaEventSynchronize(stopEvent) );</div>
<div class="line"><a name="l00916"></a><span class="lineno">  916</span>&#160;  checkCuda( cudaEventElapsedTime(&amp;milliseconds, startEvent, stopEvent) );</div>
<div class="line"><a name="l00917"></a><span class="lineno">  917</span>&#160;</div>
<div class="line"><a name="l00918"></a><span class="lineno">  918</span>&#160;  memory_accessed = (solver-&gt;<a class="code" href="a00204.html#afae6319baba315ac1f0c56505610ed85">npoints_local</a> + 2*solver-&gt;<a class="code" href="a00204.html#afae6319baba315ac1f0c56505610ed85">npoints_local</a>*<a class="code" href="a00253.html#ad3395a55a5fde64d6603c7a82d7bf2c7">_MODEL_NVARS_</a>)*<span class="keyword">sizeof</span>(<span class="keywordtype">double</span>);</div>
<div class="line"><a name="l00919"></a><span class="lineno">  919</span>&#160;  printf(<span class="stringliteral">&quot;%-50s GPU time (secs) = %.6f bandwidth (GB/s) = %6.2f\n&quot;</span>,</div>
<div class="line"><a name="l00920"></a><span class="lineno">  920</span>&#160;          <span class="stringliteral">&quot;NavierStokes3DParabolicFunction_par&quot;</span>, milliseconds*1e-3,</div>
<div class="line"><a name="l00921"></a><span class="lineno">  921</span>&#160;          (1e-6*(memory_accessed)/milliseconds));</div>
<div class="line"><a name="l00922"></a><span class="lineno">  922</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00923"></a><span class="lineno">  923</span>&#160;<span class="preprocessor"></span></div>
<div class="line"><a name="l00924"></a><span class="lineno">  924</span>&#160;  <span class="comment">/* Along Y */</span></div>
<div class="line"><a name="l00925"></a><span class="lineno">  925</span>&#160;</div>
<div class="line"><a name="l00926"></a><span class="lineno">  926</span>&#160;<span class="preprocessor">#if defined(GPU_STAT)</span></div>
<div class="line"><a name="l00927"></a><span class="lineno">  927</span>&#160;<span class="preprocessor"></span>  checkCuda( cudaEventRecord(startEvent, 0) );</div>
<div class="line"><a name="l00928"></a><span class="lineno">  928</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00929"></a><span class="lineno">  929</span>&#160;<span class="preprocessor"></span></div>
<div class="line"><a name="l00930"></a><span class="lineno">  930</span>&#160;  gpuNavierStokes3DParabolicFunction_Ydir_kernel&lt;&lt;&lt;nblocks, GPU_THREADS_PER_BLOCK&gt;&gt;&gt;(</div>
<div class="line"><a name="l00931"></a><span class="lineno">  931</span>&#160;      size, two_third, inv_gamma_m1, inv_Re, inv_Pr, Q,</div>
<div class="line"><a name="l00932"></a><span class="lineno">  932</span>&#160;      QDerivX, QDerivY, QDerivZ, FViscous</div>
<div class="line"><a name="l00933"></a><span class="lineno">  933</span>&#160;  );</div>
<div class="line"><a name="l00934"></a><span class="lineno">  934</span>&#160;  cudaDeviceSynchronize();</div>
<div class="line"><a name="l00935"></a><span class="lineno">  935</span>&#160;</div>
<div class="line"><a name="l00936"></a><span class="lineno">  936</span>&#160;<span class="preprocessor">#if defined(GPU_STAT)</span></div>
<div class="line"><a name="l00937"></a><span class="lineno">  937</span>&#160;<span class="preprocessor"></span>  checkCuda( cudaEventRecord(stopEvent, 0) );</div>
<div class="line"><a name="l00938"></a><span class="lineno">  938</span>&#160;  checkCuda( cudaEventSynchronize(stopEvent) );</div>
<div class="line"><a name="l00939"></a><span class="lineno">  939</span>&#160;  checkCuda( cudaEventElapsedTime(&amp;milliseconds, startEvent, stopEvent) );</div>
<div class="line"><a name="l00940"></a><span class="lineno">  940</span>&#160;</div>
<div class="line"><a name="l00941"></a><span class="lineno">  941</span>&#160;  memory_accessed = 17*size*<span class="keyword">sizeof</span>(double);</div>
<div class="line"><a name="l00942"></a><span class="lineno">  942</span>&#160;  printf(<span class="stringliteral">&quot;%-50s GPU time (secs) = %.6f bandwidth (GB/s) = %6.2f\n&quot;</span>,</div>
<div class="line"><a name="l00943"></a><span class="lineno">  943</span>&#160;          <span class="stringliteral">&quot;NavierStokes3DParabolicFunction_Ydir&quot;</span>, milliseconds*1e-3,</div>
<div class="line"><a name="l00944"></a><span class="lineno">  944</span>&#160;          (1e-6*(memory_accessed)/milliseconds));</div>
<div class="line"><a name="l00945"></a><span class="lineno">  945</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00946"></a><span class="lineno">  946</span>&#160;<span class="preprocessor"></span></div>
<div class="line"><a name="l00947"></a><span class="lineno">  947</span>&#160;  solver-&gt;<a class="code" href="a00204.html#add4554e1a8a541607b867db7ec38d7a9">FirstDerivativePar</a>(FDeriv,FViscous,<a class="code" href="a00198.html#a7fd32e06617f4489079bc50ce9bfc00c">_YDIR_</a>,1,solver,mpi);</div>
<div class="line"><a name="l00948"></a><span class="lineno">  948</span>&#160;  gpuNavierStokes3DParabolicFunction_par_kernel&lt;&lt;&lt;nblocks_par, GPU_THREADS_PER_BLOCK&gt;&gt;&gt;(</div>
<div class="line"><a name="l00949"></a><span class="lineno">  949</span>&#160;      solver-&gt;<a class="code" href="a00204.html#afae6319baba315ac1f0c56505610ed85">npoints_local</a>, size, ghosts, <a class="code" href="a00198.html#a7fd32e06617f4489079bc50ce9bfc00c">_YDIR_</a>, dim, dxinv, FDeriv, par</div>
<div class="line"><a name="l00950"></a><span class="lineno">  950</span>&#160;  );</div>
<div class="line"><a name="l00951"></a><span class="lineno">  951</span>&#160;  cudaDeviceSynchronize();</div>
<div class="line"><a name="l00952"></a><span class="lineno">  952</span>&#160;</div>
<div class="line"><a name="l00953"></a><span class="lineno">  953</span>&#160;  <span class="comment">/* Along Z */</span></div>
<div class="line"><a name="l00954"></a><span class="lineno">  954</span>&#160;<span class="preprocessor">#if defined(GPU_STAT)</span></div>
<div class="line"><a name="l00955"></a><span class="lineno">  955</span>&#160;<span class="preprocessor"></span>  checkCuda( cudaEventRecord(startEvent, 0) );</div>
<div class="line"><a name="l00956"></a><span class="lineno">  956</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00957"></a><span class="lineno">  957</span>&#160;<span class="preprocessor"></span></div>
<div class="line"><a name="l00958"></a><span class="lineno">  958</span>&#160;  gpuNavierStokes3DParabolicFunction_Zdir_kernel&lt;&lt;&lt;nblocks, GPU_THREADS_PER_BLOCK&gt;&gt;&gt;(</div>
<div class="line"><a name="l00959"></a><span class="lineno">  959</span>&#160;      size, two_third, inv_gamma_m1, inv_Re, inv_Pr, Q,</div>
<div class="line"><a name="l00960"></a><span class="lineno">  960</span>&#160;      QDerivX, QDerivY, QDerivZ, FViscous</div>
<div class="line"><a name="l00961"></a><span class="lineno">  961</span>&#160;  );</div>
<div class="line"><a name="l00962"></a><span class="lineno">  962</span>&#160;  cudaDeviceSynchronize();</div>
<div class="line"><a name="l00963"></a><span class="lineno">  963</span>&#160;</div>
<div class="line"><a name="l00964"></a><span class="lineno">  964</span>&#160;<span class="preprocessor">#if defined(GPU_STAT)</span></div>
<div class="line"><a name="l00965"></a><span class="lineno">  965</span>&#160;<span class="preprocessor"></span>  checkCuda( cudaEventRecord(stopEvent, 0) );</div>
<div class="line"><a name="l00966"></a><span class="lineno">  966</span>&#160;  checkCuda( cudaEventSynchronize(stopEvent) );</div>
<div class="line"><a name="l00967"></a><span class="lineno">  967</span>&#160;  checkCuda( cudaEventElapsedTime(&amp;milliseconds, startEvent, stopEvent) );</div>
<div class="line"><a name="l00968"></a><span class="lineno">  968</span>&#160;</div>
<div class="line"><a name="l00969"></a><span class="lineno">  969</span>&#160;  memory_accessed = 17*size*<span class="keyword">sizeof</span>(double);</div>
<div class="line"><a name="l00970"></a><span class="lineno">  970</span>&#160;  printf(<span class="stringliteral">&quot;%-50s GPU time (secs) = %.6f bandwidth (GB/s) = %6.2f\n&quot;</span>,</div>
<div class="line"><a name="l00971"></a><span class="lineno">  971</span>&#160;          <span class="stringliteral">&quot;NavierStokes3DParabolicFunction_Zdir&quot;</span>, milliseconds*1e-3,</div>
<div class="line"><a name="l00972"></a><span class="lineno">  972</span>&#160;          (1e-6*(memory_accessed)/milliseconds));</div>
<div class="line"><a name="l00973"></a><span class="lineno">  973</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00974"></a><span class="lineno">  974</span>&#160;<span class="preprocessor"></span></div>
<div class="line"><a name="l00975"></a><span class="lineno">  975</span>&#160;  solver-&gt;<a class="code" href="a00204.html#add4554e1a8a541607b867db7ec38d7a9">FirstDerivativePar</a>(FDeriv,FViscous,<a class="code" href="a00210.html#a227beecac6bef022707512c15d39e30b">_ZDIR_</a>,1,solver,mpi);</div>
<div class="line"><a name="l00976"></a><span class="lineno">  976</span>&#160;  gpuNavierStokes3DParabolicFunction_par_kernel&lt;&lt;&lt;nblocks_par, GPU_THREADS_PER_BLOCK&gt;&gt;&gt;(</div>
<div class="line"><a name="l00977"></a><span class="lineno">  977</span>&#160;      solver-&gt;<a class="code" href="a00204.html#afae6319baba315ac1f0c56505610ed85">npoints_local</a>, size, ghosts, <a class="code" href="a00210.html#a227beecac6bef022707512c15d39e30b">_ZDIR_</a>, dim, dxinv, FDeriv, par</div>
<div class="line"><a name="l00978"></a><span class="lineno">  978</span>&#160;  );</div>
<div class="line"><a name="l00979"></a><span class="lineno">  979</span>&#160;  cudaDeviceSynchronize();</div>
<div class="line"><a name="l00980"></a><span class="lineno">  980</span>&#160;</div>
<div class="line"><a name="l00981"></a><span class="lineno">  981</span>&#160;<span class="preprocessor">#if defined(GPU_STAT)</span></div>
<div class="line"><a name="l00982"></a><span class="lineno">  982</span>&#160;<span class="preprocessor"></span>  checkCuda( cudaEventDestroy(startEvent) );</div>
<div class="line"><a name="l00983"></a><span class="lineno">  983</span>&#160;  checkCuda( cudaEventDestroy(stopEvent) );</div>
<div class="line"><a name="l00984"></a><span class="lineno">  984</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00985"></a><span class="lineno">  985</span>&#160;<span class="preprocessor"></span></div>
<div class="line"><a name="l00986"></a><span class="lineno">  986</span>&#160;  <span class="keywordflow">if</span> (solver-&gt;<a class="code" href="a00204.html#ae83b1b0117b6a805ead2e4728945814c">flag_ib</a>) <a class="code" href="a00232.html#afd6620a5112f7aeb8391dc20e0f3b048">gpuArrayBlockMultiply</a>(par,solver-&gt;<a class="code" href="a00204.html#a992b70a21ce15afa8e06a4e3997cab8b">gpu_iblank</a>,size,<a class="code" href="a00253.html#ad3395a55a5fde64d6603c7a82d7bf2c7">_MODEL_NVARS_</a>);</div>
<div class="line"><a name="l00987"></a><span class="lineno">  987</span>&#160;</div>
<div class="line"><a name="l00988"></a><span class="lineno">  988</span>&#160;  <span class="keywordflow">return</span> (0);</div>
<div class="line"><a name="l00989"></a><span class="lineno">  989</span>&#160;}</div>
<div class="ttc" id="a00198_html_a7fd32e06617f4489079bc50ce9bfc00c"><div class="ttname"><a href="a00198.html#a7fd32e06617f4489079bc50ce9bfc00c">_YDIR_</a></div><div class="ttdeci">#define _YDIR_</div><div class="ttdef"><b>Definition:</b> <a href="a00198_source.html#l00041">euler2d.h:41</a></div></div>
<div class="ttc" id="a00204_html_a20ee1fd00a220b98513127884a5558cf"><div class="ttname"><a href="a00204.html#a20ee1fd00a220b98513127884a5558cf">HyPar::npoints_local_wghosts</a></div><div class="ttdeci">int npoints_local_wghosts</div><div class="ttdef"><b>Definition:</b> <a href="a00240_source.html#l00042">hypar.h:42</a></div></div>
<div class="ttc" id="a00210_html_a50d502373d4f9839405d29fe4baca580"><div class="ttname"><a href="a00210.html#a50d502373d4f9839405d29fe4baca580">NavierStokes3D::gpu_FDeriv</a></div><div class="ttdeci">double * gpu_FDeriv</div><div class="ttdef"><b>Definition:</b> <a href="a00210_source.html#l00544">navierstokes3d.h:544</a></div></div>
<div class="ttc" id="a00204_html_afae6319baba315ac1f0c56505610ed85"><div class="ttname"><a href="a00204.html#afae6319baba315ac1f0c56505610ed85">HyPar::npoints_local</a></div><div class="ttdeci">int npoints_local</div><div class="ttdef"><b>Definition:</b> <a href="a00240_source.html#l00042">hypar.h:42</a></div></div>
<div class="ttc" id="a00210_html_a72f9e01745b3a8203067ab84aefc9aea"><div class="ttname"><a href="a00210.html#a72f9e01745b3a8203067ab84aefc9aea">NavierStokes3D::gamma</a></div><div class="ttdeci">double gamma</div><div class="ttdef"><b>Definition:</b> <a href="a00210_source.html#l00483">navierstokes3d.h:483</a></div></div>
<div class="ttc" id="a00253_html_ad3395a55a5fde64d6603c7a82d7bf2c7"><div class="ttname"><a href="a00253.html#ad3395a55a5fde64d6603c7a82d7bf2c7">_MODEL_NVARS_</a></div><div class="ttdeci">#define _MODEL_NVARS_</div><div class="ttdef"><b>Definition:</b> <a href="a00253_source.html#l00058">euler1d.h:58</a></div></div>
<div class="ttc" id="a00232_html_afd6620a5112f7aeb8391dc20e0f3b048"><div class="ttname"><a href="a00232.html#afd6620a5112f7aeb8391dc20e0f3b048">gpuArrayBlockMultiply</a></div><div class="ttdeci">void gpuArrayBlockMultiply(double *, const double *, int, int)</div><div class="ttdef"><b>Definition:</b> <a href="a00274_source.html#l00193">ArrayImplementations_GPU.cu:193</a></div></div>
<div class="ttc" id="a00210_html_a3b92a4b98cedf64473b3c13dfa7674b4"><div class="ttname"><a href="a00210.html#a3b92a4b98cedf64473b3c13dfa7674b4">NavierStokes3D::Re</a></div><div class="ttdeci">double Re</div><div class="ttdef"><b>Definition:</b> <a href="a00210_source.html#l00484">navierstokes3d.h:484</a></div></div>
<div class="ttc" id="a00204_html_a48e81a1806b5774943fd9a26e9a190f2"><div class="ttname"><a href="a00204.html#a48e81a1806b5774943fd9a26e9a190f2">HyPar::physics</a></div><div class="ttdeci">void * physics</div><div class="ttdef"><b>Definition:</b> <a href="a00240_source.html#l00266">hypar.h:266</a></div></div>
<div class="ttc" id="a00204_html_ae83b1b0117b6a805ead2e4728945814c"><div class="ttname"><a href="a00204.html#ae83b1b0117b6a805ead2e4728945814c">HyPar::flag_ib</a></div><div class="ttdeci">int flag_ib</div><div class="ttdef"><b>Definition:</b> <a href="a00240_source.html#l00441">hypar.h:441</a></div></div>
<div class="ttc" id="a00210_html_aac34b435c6a77b49a174eefd56abc209"><div class="ttname"><a href="a00210.html#aac34b435c6a77b49a174eefd56abc209">NavierStokes3D::gpu_QDerivY</a></div><div class="ttdeci">double * gpu_QDerivY</div><div class="ttdef"><b>Definition:</b> <a href="a00210_source.html#l00541">navierstokes3d.h:541</a></div></div>
<div class="ttc" id="a00204_html_a7a147598c79bd4c442a294cac219ca82"><div class="ttname"><a href="a00204.html#a7a147598c79bd4c442a294cac219ca82">HyPar::gpu_dxinv</a></div><div class="ttdeci">double * gpu_dxinv</div><div class="ttdef"><b>Definition:</b> <a href="a00240_source.html#l00458">hypar.h:458</a></div></div>
<div class="ttc" id="a00204_html_a992b70a21ce15afa8e06a4e3997cab8b"><div class="ttname"><a href="a00204.html#a992b70a21ce15afa8e06a4e3997cab8b">HyPar::gpu_iblank</a></div><div class="ttdeci">double * gpu_iblank</div><div class="ttdef"><b>Definition:</b> <a href="a00240_source.html#l00456">hypar.h:456</a></div></div>
<div class="ttc" id="a00253_html_a57771c952ec174601addf43e1c0202b2"><div class="ttname"><a href="a00253.html#a57771c952ec174601addf43e1c0202b2">_MODEL_NDIMS_</a></div><div class="ttdeci">#define _MODEL_NDIMS_</div><div class="ttdef"><b>Definition:</b> <a href="a00253_source.html#l00056">euler1d.h:56</a></div></div>
<div class="ttc" id="a00234_html_aceca9611b1e048e233f2d9cc02f70796"><div class="ttname"><a href="a00234.html#aceca9611b1e048e233f2d9cc02f70796">GPU_THREADS_PER_BLOCK</a></div><div class="ttdeci">#define GPU_THREADS_PER_BLOCK</div><div class="ttdef"><b>Definition:</b> <a href="a00234_source.html#l00007">basic_gpu.h:7</a></div></div>
<div class="ttc" id="a00204_html_aafc992b5fa79d5a4036024615d03bce6"><div class="ttname"><a href="a00204.html#aafc992b5fa79d5a4036024615d03bce6">HyPar::ghosts</a></div><div class="ttdeci">int ghosts</div><div class="ttdef"><b>Definition:</b> <a href="a00240_source.html#l00052">hypar.h:52</a></div></div>
<div class="ttc" id="a00210_html_a227beecac6bef022707512c15d39e30b"><div class="ttname"><a href="a00210.html#a227beecac6bef022707512c15d39e30b">_ZDIR_</a></div><div class="ttdeci">#define _ZDIR_</div><div class="ttdef"><b>Definition:</b> <a href="a00210_source.html#l00076">navierstokes3d.h:76</a></div></div>
<div class="ttc" id="a00204_html_aec1dee03c858e0d3910c40c209890ab0"><div class="ttname"><a href="a00204.html#aec1dee03c858e0d3910c40c209890ab0">HyPar::size_x</a></div><div class="ttdeci">int size_x</div><div class="ttdef"><b>Definition:</b> <a href="a00240_source.html#l00048">hypar.h:48</a></div></div>
<div class="ttc" id="a00204_html_a6e3288a129bfd334448fbf3089338b69"><div class="ttname"><a href="a00204.html#a6e3288a129bfd334448fbf3089338b69">HyPar::count_par</a></div><div class="ttdeci">int count_par</div><div class="ttdef"><b>Definition:</b> <a href="a00240_source.html#l00418">hypar.h:418</a></div></div>
<div class="ttc" id="a00204_html_aada0460ecc47924f438072324b8806f5"><div class="ttname"><a href="a00204.html#aada0460ecc47924f438072324b8806f5">HyPar::gpu_dim_local</a></div><div class="ttdeci">int * gpu_dim_local</div><div class="ttdef"><b>Definition:</b> <a href="a00240_source.html#l00455">hypar.h:455</a></div></div>
<div class="ttc" id="a00210_html_ac68c83d8b02659d5b73bf43a21e4e27d"><div class="ttname"><a href="a00210.html#ac68c83d8b02659d5b73bf43a21e4e27d">NavierStokes3D::gpu_Q</a></div><div class="ttdeci">double * gpu_Q</div><div class="ttdef"><b>Definition:</b> <a href="a00210_source.html#l00539">navierstokes3d.h:539</a></div></div>
<div class="ttc" id="a00204_html_add4554e1a8a541607b867db7ec38d7a9"><div class="ttname"><a href="a00204.html#add4554e1a8a541607b867db7ec38d7a9">HyPar::FirstDerivativePar</a></div><div class="ttdeci">int(* FirstDerivativePar)(double *, double *, int, int, void *, void *)</div><div class="ttdef"><b>Definition:</b> <a href="a00240_source.html#l00243">hypar.h:243</a></div></div>
<div class="ttc" id="a00210_html_a0872d81dca20500a94be0015c8033eaf"><div class="ttname"><a href="a00210.html#a0872d81dca20500a94be0015c8033eaf">NavierStokes3D::gpu_QDerivX</a></div><div class="ttdeci">double * gpu_QDerivX</div><div class="ttdef"><b>Definition:</b> <a href="a00210_source.html#l00540">navierstokes3d.h:540</a></div></div>
<div class="ttc" id="a00232_html_a5211607a9910a4d3fd4c7001794c91ee"><div class="ttname"><a href="a00232.html#a5211607a9910a4d3fd4c7001794c91ee">gpuMemset</a></div><div class="ttdeci">void gpuMemset(void *, int, size_t)</div><div class="ttdef"><b>Definition:</b> <a href="a00274_source.html#l00131">ArrayImplementations_GPU.cu:131</a></div></div>
<div class="ttc" id="a00250_html_aa1ec149b4854b17ec8d09c24f9eb9933"><div class="ttname"><a href="a00250.html#aa1ec149b4854b17ec8d09c24f9eb9933">gpuMPIExchangeBoundariesnD</a></div><div class="ttdeci">int gpuMPIExchangeBoundariesnD(int, int, const int *, int, void *, double *)</div></div>
<div class="ttc" id="a00210_html_a00676"><div class="ttname"><a href="a00210.html#a00676">NavierStokes3D</a></div><div class="ttdoc">Structure containing variables and parameters specific to the 3D Navier Stokes equations. This structure contains the physical parameters, variables, and function pointers specific to the 3D Navier-Stokes equations. </div><div class="ttdef"><b>Definition:</b> <a href="a00210_source.html#l00482">navierstokes3d.h:482</a></div></div>
<div class="ttc" id="a00210_html_af0f6e03342b9eb912e25f94ce0249a2c"><div class="ttname"><a href="a00210.html#af0f6e03342b9eb912e25f94ce0249a2c">NavierStokes3D::Pr</a></div><div class="ttdeci">double Pr</div><div class="ttdef"><b>Definition:</b> <a href="a00210_source.html#l00485">navierstokes3d.h:485</a></div></div>
<div class="ttc" id="a00207_html_a00674"><div class="ttname"><a href="a00207.html#a00674">MPIVariables</a></div><div class="ttdoc">Structure of MPI-related variables. </div><div class="ttdef"><b>Definition:</b> <a href="a00207_source.html#l00024">mpivars_struct.h:24</a></div></div>
<div class="ttc" id="a00204_html"><div class="ttname"><a href="a00204.html">HyPar</a></div><div class="ttdoc">Structure containing all solver-specific variables and functions. </div><div class="ttdef"><b>Definition:</b> <a href="a00240_source.html#l00023">hypar.h:23</a></div></div>
<div class="ttc" id="a00210_html_acd001d1ac51a4fbab8c32ae413d1df7e"><div class="ttname"><a href="a00210.html#acd001d1ac51a4fbab8c32ae413d1df7e">NavierStokes3D::gpu_QDerivZ</a></div><div class="ttdeci">double * gpu_QDerivZ</div><div class="ttdef"><b>Definition:</b> <a href="a00210_source.html#l00542">navierstokes3d.h:542</a></div></div>
<div class="ttc" id="a00253_html_a6a44057228e5f4b86e1c4d04b2a28977"><div class="ttname"><a href="a00253.html#a6a44057228e5f4b86e1c4d04b2a28977">_XDIR_</a></div><div class="ttdeci">#define _XDIR_</div><div class="ttdef"><b>Definition:</b> <a href="a00253_source.html#l00075">euler1d.h:75</a></div></div>
<div class="ttc" id="a00210_html_a8cee3f0ef5aebfbc141657057f441c4b"><div class="ttname"><a href="a00210.html#a8cee3f0ef5aebfbc141657057f441c4b">NavierStokes3D::gpu_FViscous</a></div><div class="ttdeci">double * gpu_FViscous</div><div class="ttdef"><b>Definition:</b> <a href="a00210_source.html#l00543">navierstokes3d.h:543</a></div></div>
</div><!-- fragment -->
</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- Start of StatCounter Code for Default Guide -->
<script type="text/javascript">
var sc_project=10897352; 
var sc_invisible=1; 
var sc_security="83042f57"; 
var scJsHost = (("https:" == document.location.protocol) ?
"https://secure." : "http://www.");
document.write("<sc"+"ript type='text/javascript' src='" +
scJsHost+
"statcounter.com/counter/counter.js'></"+"script>");
</script>
<noscript><div class="statcounter"><a title="website
statistics" href="http://statcounter.com/"
target="_blank"><img class="statcounter"
src="//c.statcounter.com/10897352/0/83042f57/1/"
alt="website statistics"></a></div></noscript>
<!-- End of StatCounter Code for Default Guide -->
