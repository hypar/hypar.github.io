<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.5"/>
<title>HyPar: src/Simulation/InitializeSolvers.c File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script><script src="http://cdn.mathjax.org/mathjax/latest/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="doxygen_html_style.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">HyPar
   &#160;<span id="projectnumber">1.0</span>
   </div>
   <div id="projectbrief">Finite-Difference Hyperbolic-Parabolic PDE Solver on Cartesian Grids</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.5 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Structures</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>Globals</span></a></li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('a00598.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Data Structures</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Namespaces</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(9)"><span class="SelectionMark">&#160;</span>Macros</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(10)"><span class="SelectionMark">&#160;</span>Pages</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">InitializeSolvers.c File Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>Initialize all solvers.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &lt;stdio.h&gt;</code><br/>
<code>#include &lt;stdlib.h&gt;</code><br/>
<code>#include &lt;string.h&gt;</code><br/>
<code>#include &lt;<a class="el" href="a00239_source.html">io.h</a>&gt;</code><br/>
<code>#include &lt;<a class="el" href="a00222_source.html">tridiagLU.h</a>&gt;</code><br/>
<code>#include &lt;<a class="el" href="a00265_source.html">timeintegration.h</a>&gt;</code><br/>
<code>#include &lt;<a class="el" href="a00191_source.html">interpolation.h</a>&gt;</code><br/>
<code>#include &lt;<a class="el" href="a00237_source.html">firstderivative.h</a>&gt;</code><br/>
<code>#include &lt;<a class="el" href="a00259_source.html">secondderivative.h</a>&gt;</code><br/>
<code>#include &lt;<a class="el" href="a00248_source.html">mpivars.h</a>&gt;</code><br/>
<code>#include &lt;<a class="el" href="a00218_source.html">simulation_object.h</a>&gt;</code><br/>
</div>
<p><a href="a00598_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:abc8a1b94623371f08b22ad1e33d007e7"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00598.html#abc8a1b94623371f08b22ad1e33d007e7">ApplyBoundaryConditions</a> (void *, void *, double *, double *, double)</td></tr>
<tr class="memdesc:abc8a1b94623371f08b22ad1e33d007e7"><td class="mdescLeft">&#160;</td><td class="mdescRight">Applies the boundary conditions specified for each boundary zone.  <a href="#abc8a1b94623371f08b22ad1e33d007e7">More...</a><br/></td></tr>
<tr class="separator:abc8a1b94623371f08b22ad1e33d007e7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4cf60474c83d29277a8c9060143113ff"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00598.html#a4cf60474c83d29277a8c9060143113ff">ApplyIBConditions</a> (void *, void *, double *, double)</td></tr>
<tr class="separator:a4cf60474c83d29277a8c9060143113ff"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a742f5c2ef4e49306ef37377a98e0b5ad"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00598.html#a742f5c2ef4e49306ef37377a98e0b5ad">HyperbolicFunction</a> (double *, double *, void *, void *, double, int, int(*)(double *, double *, int, void *, double), int(*)(double *, double *, double *, double *, double *, double *, int, void *, double))</td></tr>
<tr class="separator:a742f5c2ef4e49306ef37377a98e0b5ad"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aeac475b48b3fe25f426e14ff117db7ba"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00598.html#aeac475b48b3fe25f426e14ff117db7ba">ParabolicFunctionNC1Stage</a> (double *, double *, void *, void *, double)</td></tr>
<tr class="separator:aeac475b48b3fe25f426e14ff117db7ba"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9f5c8ed9c587aa71c9f75209222ad67c"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00598.html#a9f5c8ed9c587aa71c9f75209222ad67c">ParabolicFunctionNC2Stage</a> (double *, double *, void *, void *, double)</td></tr>
<tr class="separator:a9f5c8ed9c587aa71c9f75209222ad67c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aedd832fdf4002f675da44a840e132456"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00598.html#aedd832fdf4002f675da44a840e132456">ParabolicFunctionNC1_5Stage</a> (double *, double *, void *, void *, double)</td></tr>
<tr class="separator:aedd832fdf4002f675da44a840e132456"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abcdd5c036af1b80bd99884e9148fa711"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00598.html#abcdd5c036af1b80bd99884e9148fa711">ParabolicFunctionCons1Stage</a> (double *, double *, void *, void *, double)</td></tr>
<tr class="separator:abcdd5c036af1b80bd99884e9148fa711"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6f2b6bacb5d50cb9fce6e3e00d55cc6d"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00598.html#a6f2b6bacb5d50cb9fce6e3e00d55cc6d">SourceFunction</a> (double *, double *, void *, void *, double)</td></tr>
<tr class="separator:a6f2b6bacb5d50cb9fce6e3e00d55cc6d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1f30168f72fce94d12bd0cc8d9322494"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00598.html#a1f30168f72fce94d12bd0cc8d9322494">VolumeIntegral</a> (double *, double *, void *, void *)</td></tr>
<tr class="separator:a1f30168f72fce94d12bd0cc8d9322494"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9c9813ef18605823a1c4da67e43e76c3"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00598.html#a9c9813ef18605823a1c4da67e43e76c3">BoundaryIntegral</a> (void *, void *)</td></tr>
<tr class="separator:a9c9813ef18605823a1c4da67e43e76c3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a59bed56c53d29cca4a7c25a28d38e7b5"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00598.html#a59bed56c53d29cca4a7c25a28d38e7b5">CalculateConservationError</a> (void *, void *)</td></tr>
<tr class="separator:a59bed56c53d29cca4a7c25a28d38e7b5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a55a796b622e90a00d1cb9164ab40c1c3"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00598.html#a55a796b622e90a00d1cb9164ab40c1c3">IncrementFilenameIndex</a> (char *, int)</td></tr>
<tr class="separator:a55a796b622e90a00d1cb9164ab40c1c3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a72a765174f8397b09ea5632b33c2563e"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00598.html#a72a765174f8397b09ea5632b33c2563e">NonLinearInterpolation</a> (double *, void *, void *, double, int(*)(double *, double *, int, void *, double))</td></tr>
<tr class="separator:a72a765174f8397b09ea5632b33c2563e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4b6010d35e9ab1ebfb78602241b7fb0a"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00598.html#a4b6010d35e9ab1ebfb78602241b7fb0a">gpuHyperbolicFunction</a> (double *, double *, void *, void *, double, int, int(*)(double *, double *, int, void *, double), int(*)(double *, double *, double *, double *, double *, double *, int, void *, double))</td></tr>
<tr class="separator:a4b6010d35e9ab1ebfb78602241b7fb0a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa9bbe45f664e0a173a109d10b3614c62"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00598.html#aa9bbe45f664e0a173a109d10b3614c62">InitializeSolvers</a> (void *s, int nsims)</td></tr>
<tr class="separator:aa9bbe45f664e0a173a109d10b3614c62"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Initialize all solvers. </p>
<dl class="section author"><dt>Author</dt><dd>Debojyoti Ghosh </dd></dl>

<p>Definition in file <a class="el" href="a00598_source.html">InitializeSolvers.c</a>.</p>
</div><h2 class="groupheader">Function Documentation</h2>
<a class="anchor" id="abc8a1b94623371f08b22ad1e33d007e7"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ApplyBoundaryConditions </td>
          <td>(</td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>s</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>m</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>xref</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>waqt</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Applies the boundary conditions specified for each boundary zone. </p>
<p>The solver object (of type <a class="el" href="a00202.html" title="Structure containing all solver-specific variables and functions. ">HyPar</a>) contains an oject of type <a class="el" href="a00193.html" title="Structure containing the variables and function pointers defining a boundary. ">DomainBoundary</a> that contains all the boundary information (dimension, extent, face, type, etc). This function iterates through each of the boundary zones (<a class="el" href="a00202.html#a6b5109ac1048aa203b8969b91e72c3af">HyPar::boundary</a>[<a class="el" href="a00202.html#a3f9a55664d1c8f058828ae9f4de11906">HyPar::nBoundaryZones</a>]) and calls the corresponding boundary condition function. <br/>
<br/>
The variable <em>flag</em> indicates if the array <em>x</em> is the solution, or a delta-solution (from implicit time-integration methods). </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">s</td><td>Object of type <a class="el" href="a00202.html" title="Structure containing all solver-specific variables and functions. ">HyPar</a> containing solver-related variables </td></tr>
    <tr><td class="paramname">m</td><td>Object of type <a class="el" href="a00205.html#a00663" title="Structure of MPI-related variables. ">MPIVariables</a> containing MPI-related variables </td></tr>
    <tr><td class="paramname">x</td><td>The solution vector on which the boundary conditions are to be applied </td></tr>
    <tr><td class="paramname">xref</td><td>Reference solution vector, if needed </td></tr>
    <tr><td class="paramname">waqt</td><td>Current simulation time </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="a00302_source.html#l00028">28</a> of file <a class="el" href="a00302_source.html">ApplyBoundaryConditions.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;{</div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;  <a class="code" href="a00202.html">HyPar</a>           *solver   = (<a class="code" href="a00202.html">HyPar</a>*)          s;</div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;  <a class="code" href="a00193.html">DomainBoundary</a>  *boundary = (<a class="code" href="a00193.html">DomainBoundary</a>*) solver-&gt;<a class="code" href="a00202.html#a6b5109ac1048aa203b8969b91e72c3af">boundary</a>;</div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;  <a class="code" href="a00205.html#a00663">MPIVariables</a>    *mpi      = (<a class="code" href="a00205.html#a00663">MPIVariables</a>*)   m;</div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;  <span class="keywordtype">int</span>             nb        = solver-&gt;<a class="code" href="a00202.html#a3f9a55664d1c8f058828ae9f4de11906">nBoundaryZones</a>;</div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;</div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;  <span class="keywordtype">int</span>* dim_local;</div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;<span class="preprocessor">#if defined(HAVE_CUDA)</span></div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;<span class="preprocessor"></span>  <span class="keywordflow">if</span> (solver-&gt;<a class="code" href="a00202.html#ae4ab67b8e83747d09dc53c42e218eb4e">use_gpu</a>) {</div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;    dim_local = solver-&gt;<a class="code" href="a00202.html#aada0460ecc47924f438072324b8806f5">gpu_dim_local</a>;</div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;  } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;<span class="preprocessor"></span>    dim_local = solver-&gt;<a class="code" href="a00202.html#a38e0371f331cecbe63a77fa03e202afe">dim_local</a>;</div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;<span class="preprocessor">#if defined(HAVE_CUDA)</span></div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;<span class="preprocessor"></span>  }</div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;<span class="preprocessor"></span></div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;  <span class="comment">/* Apply domain boundary conditions to x */</span></div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;  <span class="keywordtype">int</span> n;</div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;  <span class="keywordflow">for</span> (n = 0; n &lt; nb; n++) {</div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;    boundary[n].<a class="code" href="a00193.html#ad74c432793b0da4841b50ee718ed556e">BCFunctionU</a>(&amp;boundary[n],mpi,solver-&gt;<a class="code" href="a00202.html#a484873c74138512e41bc50d17b7d955a">ndims</a>,solver-&gt;<a class="code" href="a00202.html#ae8f6d2fd6490d3153cb4133bf183a404">nvars</a>,</div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;                            dim_local,solver-&gt;<a class="code" href="a00202.html#aafc992b5fa79d5a4036024615d03bce6">ghosts</a>,x,waqt);</div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;  }</div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;</div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;  <span class="keywordflow">return</span>(0);</div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;}</div>
<div class="ttc" id="a00202_html_aada0460ecc47924f438072324b8806f5"><div class="ttname"><a href="a00202.html#aada0460ecc47924f438072324b8806f5">HyPar::gpu_dim_local</a></div><div class="ttdeci">int * gpu_dim_local</div><div class="ttdef"><b>Definition:</b> <a href="a00238_source.html#l00450">hypar.h:450</a></div></div>
<div class="ttc" id="a00193_html_ad74c432793b0da4841b50ee718ed556e"><div class="ttname"><a href="a00193.html#ad74c432793b0da4841b50ee718ed556e">DomainBoundary::BCFunctionU</a></div><div class="ttdeci">int(* BCFunctionU)(void *, void *, int, int, int *, int, double *, double)</div><div class="ttdef"><b>Definition:</b> <a href="a00233_source.html#l00085">boundaryconditions.h:85</a></div></div>
<div class="ttc" id="a00193_html"><div class="ttname"><a href="a00193.html">DomainBoundary</a></div><div class="ttdoc">Structure containing the variables and function pointers defining a boundary. </div><div class="ttdef"><b>Definition:</b> <a href="a00233_source.html#l00068">boundaryconditions.h:68</a></div></div>
<div class="ttc" id="a00202_html_ae4ab67b8e83747d09dc53c42e218eb4e"><div class="ttname"><a href="a00202.html#ae4ab67b8e83747d09dc53c42e218eb4e">HyPar::use_gpu</a></div><div class="ttdeci">int use_gpu</div><div class="ttdef"><b>Definition:</b> <a href="a00238_source.html#l00444">hypar.h:444</a></div></div>
<div class="ttc" id="a00202_html_a484873c74138512e41bc50d17b7d955a"><div class="ttname"><a href="a00202.html#a484873c74138512e41bc50d17b7d955a">HyPar::ndims</a></div><div class="ttdeci">int ndims</div><div class="ttdef"><b>Definition:</b> <a href="a00238_source.html#l00026">hypar.h:26</a></div></div>
<div class="ttc" id="a00202_html_a38e0371f331cecbe63a77fa03e202afe"><div class="ttname"><a href="a00202.html#a38e0371f331cecbe63a77fa03e202afe">HyPar::dim_local</a></div><div class="ttdeci">int * dim_local</div><div class="ttdef"><b>Definition:</b> <a href="a00238_source.html#l00037">hypar.h:37</a></div></div>
<div class="ttc" id="a00202_html_a3f9a55664d1c8f058828ae9f4de11906"><div class="ttname"><a href="a00202.html#a3f9a55664d1c8f058828ae9f4de11906">HyPar::nBoundaryZones</a></div><div class="ttdeci">int nBoundaryZones</div><div class="ttdef"><b>Definition:</b> <a href="a00238_source.html#l00157">hypar.h:157</a></div></div>
<div class="ttc" id="a00202_html_aafc992b5fa79d5a4036024615d03bce6"><div class="ttname"><a href="a00202.html#aafc992b5fa79d5a4036024615d03bce6">HyPar::ghosts</a></div><div class="ttdeci">int ghosts</div><div class="ttdef"><b>Definition:</b> <a href="a00238_source.html#l00052">hypar.h:52</a></div></div>
<div class="ttc" id="a00202_html_ae8f6d2fd6490d3153cb4133bf183a404"><div class="ttname"><a href="a00202.html#ae8f6d2fd6490d3153cb4133bf183a404">HyPar::nvars</a></div><div class="ttdeci">int nvars</div><div class="ttdef"><b>Definition:</b> <a href="a00238_source.html#l00029">hypar.h:29</a></div></div>
<div class="ttc" id="a00205_html_a00663"><div class="ttname"><a href="a00205.html#a00663">MPIVariables</a></div><div class="ttdoc">Structure of MPI-related variables. </div><div class="ttdef"><b>Definition:</b> <a href="a00205_source.html#l00024">mpivars_struct.h:24</a></div></div>
<div class="ttc" id="a00202_html_a6b5109ac1048aa203b8969b91e72c3af"><div class="ttname"><a href="a00202.html#a6b5109ac1048aa203b8969b91e72c3af">HyPar::boundary</a></div><div class="ttdeci">void * boundary</div><div class="ttdef"><b>Definition:</b> <a href="a00238_source.html#l00159">hypar.h:159</a></div></div>
<div class="ttc" id="a00202_html"><div class="ttname"><a href="a00202.html">HyPar</a></div><div class="ttdoc">Structure containing all solver-specific variables and functions. </div><div class="ttdef"><b>Definition:</b> <a href="a00238_source.html#l00023">hypar.h:23</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a4cf60474c83d29277a8c9060143113ff"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ApplyIBConditions </td>
          <td>(</td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>s</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>m</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>waqt</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Call the physics-specific function that applies the immersed boundary conditions on the immersed boundary points. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">s</td><td>Object of type <a class="el" href="a00202.html" title="Structure containing all solver-specific variables and functions. ">HyPar</a> containing solver-related variables </td></tr>
    <tr><td class="paramname">m</td><td>Object of type <a class="el" href="a00205.html#a00663" title="Structure of MPI-related variables. ">MPIVariables</a> containing MPI-related variables </td></tr>
    <tr><td class="paramname">x</td><td>The solution vector to apply immersed BCs on </td></tr>
    <tr><td class="paramname">waqt</td><td>Current simulation time </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="a00303_source.html#l00014">14</a> of file <a class="el" href="a00303_source.html">ApplyIBConditions.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;{</div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;  <a class="code" href="a00202.html">HyPar</a>           *solver   = (<a class="code" href="a00202.html">HyPar</a>*)          s;</div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;  <a class="code" href="a00205.html#a00663">MPIVariables</a>    *mpi      = (<a class="code" href="a00205.html#a00663">MPIVariables</a>*)   m;</div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;</div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;  <span class="comment">/* Apply immersed boundary conditions, if applicable */</span></div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;<span class="preprocessor">#if defined(HAVE_CUDA)</span></div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;<span class="preprocessor"></span>  <span class="keywordflow">if</span> (solver-&gt;<a class="code" href="a00202.html#ae4ab67b8e83747d09dc53c42e218eb4e">use_gpu</a>) {</div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;    <span class="keywordflow">if</span> (solver-&gt;<a class="code" href="a00202.html#ae83b1b0117b6a805ead2e4728945814c">flag_ib</a>) {</div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;      fprintf(stderr, <span class="stringliteral">&quot;ERROR: immersed boundaries have not yet been implemented on GPU.\n&quot;</span>);</div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;    }</div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;  } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;<span class="preprocessor"></span>    <span class="keywordflow">if</span> (solver-&gt;<a class="code" href="a00202.html#ae83b1b0117b6a805ead2e4728945814c">flag_ib</a>) solver-&gt;<a class="code" href="a00202.html#a0d9d4a968c52356bd63f45ad76112245">IBFunction</a>(solver,mpi,x,waqt);</div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;<span class="preprocessor">#if defined(HAVE_CUDA)</span></div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;<span class="preprocessor"></span>  }</div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;<span class="preprocessor"></span></div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;  <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;}</div>
<div class="ttc" id="a00202_html_ae4ab67b8e83747d09dc53c42e218eb4e"><div class="ttname"><a href="a00202.html#ae4ab67b8e83747d09dc53c42e218eb4e">HyPar::use_gpu</a></div><div class="ttdeci">int use_gpu</div><div class="ttdef"><b>Definition:</b> <a href="a00238_source.html#l00444">hypar.h:444</a></div></div>
<div class="ttc" id="a00205_html_a00663"><div class="ttname"><a href="a00205.html#a00663">MPIVariables</a></div><div class="ttdoc">Structure of MPI-related variables. </div><div class="ttdef"><b>Definition:</b> <a href="a00205_source.html#l00024">mpivars_struct.h:24</a></div></div>
<div class="ttc" id="a00202_html_a0d9d4a968c52356bd63f45ad76112245"><div class="ttname"><a href="a00202.html#a0d9d4a968c52356bd63f45ad76112245">HyPar::IBFunction</a></div><div class="ttdeci">int(* IBFunction)(void *, void *, double *, double)</div><div class="ttdef"><b>Definition:</b> <a href="a00238_source.html#l00441">hypar.h:441</a></div></div>
<div class="ttc" id="a00202_html_ae83b1b0117b6a805ead2e4728945814c"><div class="ttname"><a href="a00202.html#ae83b1b0117b6a805ead2e4728945814c">HyPar::flag_ib</a></div><div class="ttdeci">int flag_ib</div><div class="ttdef"><b>Definition:</b> <a href="a00238_source.html#l00436">hypar.h:436</a></div></div>
<div class="ttc" id="a00202_html"><div class="ttname"><a href="a00202.html">HyPar</a></div><div class="ttdoc">Structure containing all solver-specific variables and functions. </div><div class="ttdef"><b>Definition:</b> <a href="a00238_source.html#l00023">hypar.h:23</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a742f5c2ef4e49306ef37377a98e0b5ad"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int HyperbolicFunction </td>
          <td>(</td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>hyp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>u</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>s</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>m</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>t</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>LimFlag</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int(*)(double *, double *, int, void *, double)&#160;</td>
          <td class="paramname"><em>FluxFunction</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int(*)(double *, double *, double *, double *, double *, double *, int, void *, double)&#160;</td>
          <td class="paramname"><em>UpwindFunction</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>This function computes the hyperbolic term of the governing equations, expressed as follows:- </p>
<p class="formulaDsp">
\begin{equation} {\bf F} \left({\bf u}\right) = \sum_{d=0}^{D-1} \frac {\partial {\bf f}_d\left({\bf u}\right)} {\partial x_d} \end{equation}
</p>
<p> using a conservative finite-difference discretization is space: </p>
<p class="formulaDsp">
\begin{equation} \hat{\bf F} \left({\bf u}\right) = \sum_{d=0}^{D-1} \frac {1} {\Delta x_d} \left[ \hat{\bf f}_{d,j+1/2} - \hat{\bf f}_{d,j-1/2} \right] \end{equation}
</p>
<p> where \(d\) denotes the spatial dimension, \(D\) denotes the total number of spatial dimensions, the hat denotes the discretized quantity, and \(j\) is the grid coordinate along dimension \(d\). The approximation to the flux function \({\bf f}_d\) at the interfaces \(j\pm1/2\), denoted by \(\hat{\bf f}_{d,j\pm 1/2}\), are computed using the function <a class="el" href="a00310.html#ae6e53860597b32435f6ad086401e11a1">ReconstructHyperbolic()</a>. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">hyp</td><td>Array to hold the computed hyperbolic term (shares the same layout as u </td></tr>
    <tr><td class="paramname">u</td><td>Solution array </td></tr>
    <tr><td class="paramname">s</td><td>Solver object of type <a class="el" href="a00202.html" title="Structure containing all solver-specific variables and functions. ">HyPar</a> </td></tr>
    <tr><td class="paramname">m</td><td>MPI object of type <a class="el" href="a00205.html#a00663" title="Structure of MPI-related variables. ">MPIVariables</a> </td></tr>
    <tr><td class="paramname">t</td><td>Current simulation time </td></tr>
    <tr><td class="paramname">LimFlag</td><td>Flag to indicate if the nonlinear coefficients for solution-dependent interpolation method should be recomputed (see <a class="el" href="a00310.html#ae6e53860597b32435f6ad086401e11a1">ReconstructHyperbolic()</a> for an explanation on why this is needed) </td></tr>
    <tr><td class="paramname">FluxFunction</td><td>Function pointer to the flux function for the hyperbolic term </td></tr>
    <tr><td class="paramname">UpwindFunction</td><td>Function pointer to the upwinding function for the hyperbolic term </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="a00310_source.html#l00031">31</a> of file <a class="el" href="a00310_source.html">HyperbolicFunction.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;{</div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;  <a class="code" href="a00202.html">HyPar</a>         *solver = (<a class="code" href="a00202.html">HyPar</a>*)        s;</div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;  <a class="code" href="a00205.html#a00663">MPIVariables</a>  *mpi    = (<a class="code" href="a00205.html#a00663">MPIVariables</a>*) m;</div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;  <span class="keywordtype">int</span>           d, v, i, done;</div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;  <span class="keywordtype">double</span>        *FluxI  = solver-&gt;<a class="code" href="a00202.html#a983929b7b1511ff3e7800597adef6a91">fluxI</a>; <span class="comment">/* interface flux     */</span></div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;  <span class="keywordtype">double</span>        *FluxC  = solver-&gt;<a class="code" href="a00202.html#aee7ff3b51db01ee6ed4038ff5311ed24">fluxC</a>; <span class="comment">/* cell centered flux */</span></div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;  <a class="code" href="a00231.html#a68f50121fb9a7daeaf60e50cdef82ef3">_DECLARE_IERR_</a>;</div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;</div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;  <span class="keywordtype">int</span>     ndims  = solver-&gt;<a class="code" href="a00202.html#a484873c74138512e41bc50d17b7d955a">ndims</a>;</div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;  <span class="keywordtype">int</span>     nvars  = solver-&gt;<a class="code" href="a00202.html#ae8f6d2fd6490d3153cb4133bf183a404">nvars</a>;</div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;  <span class="keywordtype">int</span>     ghosts = solver-&gt;<a class="code" href="a00202.html#aafc992b5fa79d5a4036024615d03bce6">ghosts</a>;</div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;  <span class="keywordtype">int</span>     *dim   = solver-&gt;<a class="code" href="a00202.html#a38e0371f331cecbe63a77fa03e202afe">dim_local</a>;</div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;  <span class="keywordtype">int</span>     size   = solver-&gt;<a class="code" href="a00202.html#a20ee1fd00a220b98513127884a5558cf">npoints_local_wghosts</a>;</div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;  <span class="keywordtype">double</span>  *x     = solver-&gt;<a class="code" href="a00202.html#a711aad4cbe735871dd9e91ab575c878b">x</a>;</div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;  <span class="keywordtype">double</span>  *dxinv = solver-&gt;<a class="code" href="a00202.html#aa24a4f5e29bd70cbe5a2413be1ea9682">dxinv</a>;</div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;  <span class="keywordtype">int</span>     index[ndims], index1[ndims], index2[ndims], dim_interface[ndims];</div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;</div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;  LimFlag = (LimFlag &amp;&amp; solver-&gt;<a class="code" href="a00202.html#a9a61d44b50cc9043a19bdc3c0f591d99">flag_nonlinearinterp</a> &amp;&amp; solver-&gt;<a class="code" href="a00202.html#afeeb150a9699ade5eccc7589fcae3fe0">SetInterpLimiterVar</a>);</div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;</div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;  <a class="code" href="a00229.html#a2b2826031c0cd92495ab351d3e599fc5">_ArraySetValue_</a>(hyp,size*nvars,0.0);</div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;  <a class="code" href="a00229.html#a2b2826031c0cd92495ab351d3e599fc5">_ArraySetValue_</a>(solver-&gt;<a class="code" href="a00202.html#ac3326fc53477d445133072e3f1fe6b59">StageBoundaryIntegral</a>,2*ndims*nvars,0.0);</div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;  <span class="keywordflow">if</span> (!FluxFunction) <span class="keywordflow">return</span>(0); <span class="comment">/* zero hyperbolic term */</span></div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;  solver-&gt;<a class="code" href="a00202.html#ab6a7eec54a4d412178811cf50241fea0">count_hyp</a>++;</div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;</div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;<span class="preprocessor">#if defined(CPU_STAT)</span></div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;<span class="preprocessor"></span>  <span class="keywordtype">double</span> cpu_time = 0.0;</div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;  clock_t cpu_start, cpu_end;</div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;<span class="preprocessor"></span></div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;  <span class="keywordtype">int</span> offset = 0;</div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;  <span class="keywordflow">for</span> (d = 0; d &lt; ndims; d++) {</div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;    <a class="code" href="a00229.html#a89e8330d9e06dd0666c50833628a125c">_ArrayCopy1D_</a>(dim,dim_interface,ndims); dim_interface[d]++;</div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;    <span class="keywordtype">int</span> size_cellcenter = 1; <span class="keywordflow">for</span> (i = 0; i &lt; ndims; i++) size_cellcenter *= (dim[i] + 2*ghosts);</div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;    <span class="keywordtype">int</span> size_interface = 1; <span class="keywordflow">for</span> (i = 0; i &lt; ndims; i++) size_interface *= dim_interface[i];</div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;</div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;    <span class="comment">/* evaluate cell-centered flux */</span></div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;    <a class="code" href="a00231.html#ad6ab74942c9de13cf0b4c12eb0d91780">IERR</a> FluxFunction(FluxC,u,d,solver,t); <a class="code" href="a00231.html#add9cf96ae374934d245a1dc1ab697a42">CHECKERR</a>(ierr);</div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;    <span class="comment">/* compute interface fluxes */</span></div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;    <a class="code" href="a00231.html#ad6ab74942c9de13cf0b4c12eb0d91780">IERR</a> <a class="code" href="a00310.html#ae6e53860597b32435f6ad086401e11a1">ReconstructHyperbolic</a>(FluxI,FluxC,u,x+offset,d,solver,mpi,t,LimFlag,UpwindFunction);</div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;    <a class="code" href="a00231.html#add9cf96ae374934d245a1dc1ab697a42">CHECKERR</a>(ierr);</div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;</div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;    <span class="comment">/* calculate the first derivative */</span></div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;    done = 0; <a class="code" href="a00229.html#a2b2826031c0cd92495ab351d3e599fc5">_ArraySetValue_</a>(index,ndims,0);</div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;    <span class="keywordtype">int</span> p, p1, p2;</div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;</div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;<span class="preprocessor">#if defined(CPU_STAT)</span></div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;<span class="preprocessor"></span>    cpu_start = clock();</div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;<span class="preprocessor"></span></div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;    <span class="keywordflow">while</span> (!done) {</div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;      <a class="code" href="a00229.html#a89e8330d9e06dd0666c50833628a125c">_ArrayCopy1D_</a>(index,index1,ndims);</div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;      <a class="code" href="a00229.html#a89e8330d9e06dd0666c50833628a125c">_ArrayCopy1D_</a>(index,index2,ndims); index2[d]++;</div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;      <a class="code" href="a00229.html#afbb862a2fdf5b72b1f9ace42f64b556f">_ArrayIndex1D_</a>(ndims,dim          ,index ,ghosts,p);</div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;      <a class="code" href="a00229.html#afbb862a2fdf5b72b1f9ace42f64b556f">_ArrayIndex1D_</a>(ndims,dim_interface,index1,0     ,p1);</div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;      <a class="code" href="a00229.html#afbb862a2fdf5b72b1f9ace42f64b556f">_ArrayIndex1D_</a>(ndims,dim_interface,index2,0     ,p2);</div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;      <span class="keywordflow">for</span> (v=0; v&lt;nvars; v++) hyp[nvars*p+v] += dxinv[offset+ghosts+index[d]]</div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;                                              * (FluxI[nvars*p2+v]-FluxI[nvars*p1+v]);</div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;      <span class="comment">/* boundary flux integral */</span></div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;      <span class="keywordflow">if</span> (index[d] == 0)</div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;        <span class="keywordflow">for</span> (v=0; v&lt;nvars; v++) solver-&gt;<a class="code" href="a00202.html#ac3326fc53477d445133072e3f1fe6b59">StageBoundaryIntegral</a>[(2*d+0)*nvars+v] -= FluxI[nvars*p1+v];</div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;      <span class="keywordflow">if</span> (index[d] == dim[d]-1)</div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;        <span class="keywordflow">for</span> (v=0; v&lt;nvars; v++) solver-&gt;<a class="code" href="a00202.html#ac3326fc53477d445133072e3f1fe6b59">StageBoundaryIntegral</a>[(2*d+1)*nvars+v] += FluxI[nvars*p2+v];</div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;</div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;      <a class="code" href="a00229.html#ac5ec1371623f11d03b0f42adaa24acbc">_ArrayIncrementIndex_</a>(ndims,dim,index,done);</div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;    }</div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;</div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;<span class="preprocessor">#if defined(CPU_STAT)</span></div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;<span class="preprocessor"></span>    cpu_end = clock();</div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;    cpu_time += (double)(cpu_end - cpu_start) / CLOCKS_PER_SEC;</div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;<span class="preprocessor"></span></div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;    offset += dim[d] + 2*ghosts;</div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;  }</div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;</div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;<span class="preprocessor">#if defined(CPU_STAT)</span></div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;<span class="preprocessor"></span>  printf(<span class="stringliteral">&quot;HyperbolicFunction CPU time = %8.6lf\n&quot;</span>, cpu_time);</div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;<span class="preprocessor"></span></div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;  <span class="keywordflow">if</span> (solver-&gt;<a class="code" href="a00202.html#ae83b1b0117b6a805ead2e4728945814c">flag_ib</a>) <a class="code" href="a00229.html#a4208c0f00455cf5113ce470bf641ecdd">_ArrayBlockMultiply_</a>(hyp,solver-&gt;<a class="code" href="a00202.html#a267ef7e03dbe9dd4440dee2fdf48619a">iblank</a>,size,nvars);</div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;</div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;  <span class="keywordflow">return</span>(0);</div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;}</div>
<div class="ttc" id="a00229_html_a2b2826031c0cd92495ab351d3e599fc5"><div class="ttname"><a href="a00229.html#a2b2826031c0cd92495ab351d3e599fc5">_ArraySetValue_</a></div><div class="ttdeci">#define _ArraySetValue_(x, size, value)</div><div class="ttdef"><b>Definition:</b> <a href="a00229_source.html#l00169">arrayfunctions.h:169</a></div></div>
<div class="ttc" id="a00202_html_a9a61d44b50cc9043a19bdc3c0f591d99"><div class="ttname"><a href="a00202.html#a9a61d44b50cc9043a19bdc3c0f591d99">HyPar::flag_nonlinearinterp</a></div><div class="ttdeci">int flag_nonlinearinterp</div><div class="ttdef"><b>Definition:</b> <a href="a00238_source.html#l00406">hypar.h:406</a></div></div>
<div class="ttc" id="a00229_html_afbb862a2fdf5b72b1f9ace42f64b556f"><div class="ttname"><a href="a00229.html#afbb862a2fdf5b72b1f9ace42f64b556f">_ArrayIndex1D_</a></div><div class="ttdeci">#define _ArrayIndex1D_(N, imax, i, ghost, index)</div><div class="ttdef"><b>Definition:</b> <a href="a00229_source.html#l00040">arrayfunctions.h:40</a></div></div>
<div class="ttc" id="a00202_html_ab6a7eec54a4d412178811cf50241fea0"><div class="ttname"><a href="a00202.html#ab6a7eec54a4d412178811cf50241fea0">HyPar::count_hyp</a></div><div class="ttdeci">int count_hyp</div><div class="ttdef"><b>Definition:</b> <a href="a00238_source.html#l00413">hypar.h:413</a></div></div>
<div class="ttc" id="a00202_html_aa24a4f5e29bd70cbe5a2413be1ea9682"><div class="ttname"><a href="a00202.html#aa24a4f5e29bd70cbe5a2413be1ea9682">HyPar::dxinv</a></div><div class="ttdeci">double * dxinv</div><div class="ttdef"><b>Definition:</b> <a href="a00238_source.html#l00110">hypar.h:110</a></div></div>
<div class="ttc" id="a00229_html_a4208c0f00455cf5113ce470bf641ecdd"><div class="ttname"><a href="a00229.html#a4208c0f00455cf5113ce470bf641ecdd">_ArrayBlockMultiply_</a></div><div class="ttdeci">#define _ArrayBlockMultiply_(x, a, n, bs)</div><div class="ttdef"><b>Definition:</b> <a href="a00229_source.html#l00388">arrayfunctions.h:388</a></div></div>
<div class="ttc" id="a00229_html_a89e8330d9e06dd0666c50833628a125c"><div class="ttname"><a href="a00229.html#a89e8330d9e06dd0666c50833628a125c">_ArrayCopy1D_</a></div><div class="ttdeci">#define _ArrayCopy1D_(x, y, size)</div><div class="ttdef"><b>Definition:</b> <a href="a00229_source.html#l00319">arrayfunctions.h:319</a></div></div>
<div class="ttc" id="a00202_html_ac3326fc53477d445133072e3f1fe6b59"><div class="ttname"><a href="a00202.html#ac3326fc53477d445133072e3f1fe6b59">HyPar::StageBoundaryIntegral</a></div><div class="ttdeci">double * StageBoundaryIntegral</div><div class="ttdef"><b>Definition:</b> <a href="a00238_source.html#l00377">hypar.h:377</a></div></div>
<div class="ttc" id="a00231_html_a68f50121fb9a7daeaf60e50cdef82ef3"><div class="ttname"><a href="a00231.html#a68f50121fb9a7daeaf60e50cdef82ef3">_DECLARE_IERR_</a></div><div class="ttdeci">#define _DECLARE_IERR_</div><div class="ttdef"><b>Definition:</b> <a href="a00231_source.html#l00017">basic.h:17</a></div></div>
<div class="ttc" id="a00202_html_a711aad4cbe735871dd9e91ab575c878b"><div class="ttname"><a href="a00202.html#a711aad4cbe735871dd9e91ab575c878b">HyPar::x</a></div><div class="ttdeci">double * x</div><div class="ttdef"><b>Definition:</b> <a href="a00238_source.html#l00107">hypar.h:107</a></div></div>
<div class="ttc" id="a00310_html_ae6e53860597b32435f6ad086401e11a1"><div class="ttname"><a href="a00310.html#ae6e53860597b32435f6ad086401e11a1">ReconstructHyperbolic</a></div><div class="ttdeci">static int ReconstructHyperbolic(double *, double *, double *, double *, int, void *, void *, double, int, int(*)(double *, double *, double *, double *, double *, double *, int, void *, double))</div><div class="ttdef"><b>Definition:</b> <a href="a00310_source.html#l00167">HyperbolicFunction.c:167</a></div></div>
<div class="ttc" id="a00202_html_a484873c74138512e41bc50d17b7d955a"><div class="ttname"><a href="a00202.html#a484873c74138512e41bc50d17b7d955a">HyPar::ndims</a></div><div class="ttdeci">int ndims</div><div class="ttdef"><b>Definition:</b> <a href="a00238_source.html#l00026">hypar.h:26</a></div></div>
<div class="ttc" id="a00231_html_ad6ab74942c9de13cf0b4c12eb0d91780"><div class="ttname"><a href="a00231.html#ad6ab74942c9de13cf0b4c12eb0d91780">IERR</a></div><div class="ttdeci">#define IERR</div><div class="ttdef"><b>Definition:</b> <a href="a00231_source.html#l00016">basic.h:16</a></div></div>
<div class="ttc" id="a00202_html_a38e0371f331cecbe63a77fa03e202afe"><div class="ttname"><a href="a00202.html#a38e0371f331cecbe63a77fa03e202afe">HyPar::dim_local</a></div><div class="ttdeci">int * dim_local</div><div class="ttdef"><b>Definition:</b> <a href="a00238_source.html#l00037">hypar.h:37</a></div></div>
<div class="ttc" id="a00202_html_aafc992b5fa79d5a4036024615d03bce6"><div class="ttname"><a href="a00202.html#aafc992b5fa79d5a4036024615d03bce6">HyPar::ghosts</a></div><div class="ttdeci">int ghosts</div><div class="ttdef"><b>Definition:</b> <a href="a00238_source.html#l00052">hypar.h:52</a></div></div>
<div class="ttc" id="a00202_html_a20ee1fd00a220b98513127884a5558cf"><div class="ttname"><a href="a00202.html#a20ee1fd00a220b98513127884a5558cf">HyPar::npoints_local_wghosts</a></div><div class="ttdeci">int npoints_local_wghosts</div><div class="ttdef"><b>Definition:</b> <a href="a00238_source.html#l00042">hypar.h:42</a></div></div>
<div class="ttc" id="a00231_html_add9cf96ae374934d245a1dc1ab697a42"><div class="ttname"><a href="a00231.html#add9cf96ae374934d245a1dc1ab697a42">CHECKERR</a></div><div class="ttdeci">#define CHECKERR(ierr)</div><div class="ttdef"><b>Definition:</b> <a href="a00231_source.html#l00018">basic.h:18</a></div></div>
<div class="ttc" id="a00202_html_ae8f6d2fd6490d3153cb4133bf183a404"><div class="ttname"><a href="a00202.html#ae8f6d2fd6490d3153cb4133bf183a404">HyPar::nvars</a></div><div class="ttdeci">int nvars</div><div class="ttdef"><b>Definition:</b> <a href="a00238_source.html#l00029">hypar.h:29</a></div></div>
<div class="ttc" id="a00205_html_a00663"><div class="ttname"><a href="a00205.html#a00663">MPIVariables</a></div><div class="ttdoc">Structure of MPI-related variables. </div><div class="ttdef"><b>Definition:</b> <a href="a00205_source.html#l00024">mpivars_struct.h:24</a></div></div>
<div class="ttc" id="a00202_html_a983929b7b1511ff3e7800597adef6a91"><div class="ttname"><a href="a00202.html#a983929b7b1511ff3e7800597adef6a91">HyPar::fluxI</a></div><div class="ttdeci">double * fluxI</div><div class="ttdef"><b>Definition:</b> <a href="a00238_source.html#l00136">hypar.h:136</a></div></div>
<div class="ttc" id="a00202_html_aee7ff3b51db01ee6ed4038ff5311ed24"><div class="ttname"><a href="a00202.html#aee7ff3b51db01ee6ed4038ff5311ed24">HyPar::fluxC</a></div><div class="ttdeci">double * fluxC</div><div class="ttdef"><b>Definition:</b> <a href="a00238_source.html#l00128">hypar.h:128</a></div></div>
<div class="ttc" id="a00229_html_ac5ec1371623f11d03b0f42adaa24acbc"><div class="ttname"><a href="a00229.html#ac5ec1371623f11d03b0f42adaa24acbc">_ArrayIncrementIndex_</a></div><div class="ttdeci">#define _ArrayIncrementIndex_(N, imax, i, done)</div><div class="ttdef"><b>Definition:</b> <a href="a00229_source.html#l00126">arrayfunctions.h:126</a></div></div>
<div class="ttc" id="a00202_html_ae83b1b0117b6a805ead2e4728945814c"><div class="ttname"><a href="a00202.html#ae83b1b0117b6a805ead2e4728945814c">HyPar::flag_ib</a></div><div class="ttdeci">int flag_ib</div><div class="ttdef"><b>Definition:</b> <a href="a00238_source.html#l00436">hypar.h:436</a></div></div>
<div class="ttc" id="a00202_html_afeeb150a9699ade5eccc7589fcae3fe0"><div class="ttname"><a href="a00202.html#afeeb150a9699ade5eccc7589fcae3fe0">HyPar::SetInterpLimiterVar</a></div><div class="ttdeci">int(* SetInterpLimiterVar)(double *, double *, double *, int, void *, void *)</div><div class="ttdef"><b>Definition:</b> <a href="a00238_source.html#l00229">hypar.h:229</a></div></div>
<div class="ttc" id="a00202_html_a267ef7e03dbe9dd4440dee2fdf48619a"><div class="ttname"><a href="a00202.html#a267ef7e03dbe9dd4440dee2fdf48619a">HyPar::iblank</a></div><div class="ttdeci">double * iblank</div><div class="ttdef"><b>Definition:</b> <a href="a00238_source.html#l00431">hypar.h:431</a></div></div>
<div class="ttc" id="a00202_html"><div class="ttname"><a href="a00202.html">HyPar</a></div><div class="ttdoc">Structure containing all solver-specific variables and functions. </div><div class="ttdef"><b>Definition:</b> <a href="a00238_source.html#l00023">hypar.h:23</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="aeac475b48b3fe25f426e14ff117db7ba"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ParabolicFunctionNC1Stage </td>
          <td>(</td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>par</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>u</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>s</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>m</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>t</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Evaluate the parabolic term using a conservative finite-difference spatial discretization: The parabolic term is assumed to be of the form: </p>
<p class="formulaDsp">
\begin{equation} {\bf P}\left({\bf u}\right) = \sum_{d=0}^{D-1} \frac {\partial^2 {\bf g}_d\left(\bf u\right)} {\partial x_d^2}, \end{equation}
</p>
<p> which is discretized at a grid point as: </p>
<p class="formulaDsp">
\begin{equation} \left.{\bf P}\left({\bf u}\right)\right|_j = \sum_{d=0}^{D-1} \frac { \mathcal{L}_d \left[ {\bf g}_d \right] } {\Delta x_d^2}, \end{equation}
</p>
<p> where \(d\) is the spatial dimension index, \(D\) is the total number of spatial dimensions (<a class="el" href="a00202.html#a484873c74138512e41bc50d17b7d955a">HyPar::ndims</a>), and \(j\) is the grid index along \(d\). \(\mathcal{L}_d\) represents the finite-difference approximation to the Laplacian along the \(d\) spatial dimension, computed using <a class="el" href="a00202.html#a4b350316573a1d93caf01c5f1d43a45f">HyPar::SecondDerivativePar</a>.</p>
<p><b>Note:</b> this form of the parabolic term <b>does</b> <b>not</b> allow for cross-derivatives.</p>
<p>To use this form of the parabolic term:</p>
<ul>
<li>specify <b>"par_space_type"</b> in solver.inp as <b>"nonconservative-1stage"</b> (<a class="el" href="a00202.html#ad45d57b33d578bf602574a221bf53d93">HyPar::spatial_type_par</a>).</li>
<li>the physical model must specify \({\bf g}_d\left({\bf u}\right)\) through <a class="el" href="a00202.html#ad8f03ca8c9fd6e1e235203495e8f2173">HyPar::GFunction</a>. </li>
</ul>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">par</td><td>array to hold the computed parabolic term </td></tr>
    <tr><td class="paramname">u</td><td>solution </td></tr>
    <tr><td class="paramname">s</td><td>Solver object of type <a class="el" href="a00202.html" title="Structure containing all solver-specific variables and functions. ">HyPar</a> </td></tr>
    <tr><td class="paramname">m</td><td>MPI object of type <a class="el" href="a00205.html#a00663" title="Structure of MPI-related variables. ">MPIVariables</a> </td></tr>
    <tr><td class="paramname">t</td><td>Current simulation time </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="a00316_source.html#l00031">31</a> of file <a class="el" href="a00316_source.html">ParabolicFunctionNC1Stage.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;{</div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;  <a class="code" href="a00202.html">HyPar</a>         *solver = (<a class="code" href="a00202.html">HyPar</a>*)        s;</div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;  <a class="code" href="a00205.html#a00663">MPIVariables</a>  *mpi    = (<a class="code" href="a00205.html#a00663">MPIVariables</a>*) m;</div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;  <span class="keywordtype">double</span>        *Func   = solver-&gt;<a class="code" href="a00202.html#aee7ff3b51db01ee6ed4038ff5311ed24">fluxC</a>;</div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;  <span class="keywordtype">double</span>        *Deriv2 = solver-&gt;<a class="code" href="a00202.html#a31bc6f5b337e72aa281a1ea5ad5d6832">Deriv2</a>;</div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;  <span class="keywordtype">int</span>           d, v, i, done;</div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;  <a class="code" href="a00231.html#a68f50121fb9a7daeaf60e50cdef82ef3">_DECLARE_IERR_</a>;</div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;</div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;  <span class="keywordtype">int</span>     ndims  = solver-&gt;<a class="code" href="a00202.html#a484873c74138512e41bc50d17b7d955a">ndims</a>;</div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;  <span class="keywordtype">int</span>     nvars  = solver-&gt;<a class="code" href="a00202.html#ae8f6d2fd6490d3153cb4133bf183a404">nvars</a>;</div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;  <span class="keywordtype">int</span>     ghosts = solver-&gt;<a class="code" href="a00202.html#aafc992b5fa79d5a4036024615d03bce6">ghosts</a>;</div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;  <span class="keywordtype">int</span>     *dim   = solver-&gt;<a class="code" href="a00202.html#a38e0371f331cecbe63a77fa03e202afe">dim_local</a>;</div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;  <span class="keywordtype">double</span>  *dxinv = solver-&gt;<a class="code" href="a00202.html#aa24a4f5e29bd70cbe5a2413be1ea9682">dxinv</a>;</div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;  <span class="keywordtype">int</span>     size   = solver-&gt;<a class="code" href="a00202.html#a20ee1fd00a220b98513127884a5558cf">npoints_local_wghosts</a>;</div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;</div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;  <span class="keywordflow">if</span> (!solver-&gt;<a class="code" href="a00202.html#ad8f03ca8c9fd6e1e235203495e8f2173">GFunction</a>) <span class="keywordflow">return</span>(0); <span class="comment">/* zero parabolic terms */</span></div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;  solver-&gt;<a class="code" href="a00202.html#a6e3288a129bfd334448fbf3089338b69">count_par</a>++;</div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;</div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;  <span class="keywordtype">int</span> index[ndims];</div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;  <a class="code" href="a00229.html#a2b2826031c0cd92495ab351d3e599fc5">_ArraySetValue_</a>(par,size*nvars,0.0);</div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;</div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;  <span class="keywordtype">int</span> offset = 0;</div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;  <span class="keywordflow">for</span> (d = 0; d &lt; ndims; d++) {</div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;    <span class="keywordtype">int</span> size_deriv = 1; <span class="keywordflow">for</span> (i=0; i&lt;ndims; i++) size_deriv *= dim[i];</div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;</div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;    <span class="comment">/* calculate the diffusion function */</span></div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;    <a class="code" href="a00231.html#ad6ab74942c9de13cf0b4c12eb0d91780">IERR</a> solver-&gt;<a class="code" href="a00202.html#ad8f03ca8c9fd6e1e235203495e8f2173">GFunction</a>(Func,u,d,solver,t); <a class="code" href="a00231.html#add9cf96ae374934d245a1dc1ab697a42">CHECKERR</a>(ierr);</div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;    <a class="code" href="a00231.html#ad6ab74942c9de13cf0b4c12eb0d91780">IERR</a> solver-&gt;<a class="code" href="a00202.html#a4b350316573a1d93caf01c5f1d43a45f">SecondDerivativePar</a>(Deriv2,Func,d,solver,mpi); <a class="code" href="a00231.html#add9cf96ae374934d245a1dc1ab697a42">CHECKERR</a>(ierr);</div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;</div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;    <span class="comment">/* calculate the final term - second derivative of the diffusion function */</span></div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;    done = 0; <a class="code" href="a00229.html#a2b2826031c0cd92495ab351d3e599fc5">_ArraySetValue_</a>(index,ndims,0);</div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;    <span class="keywordtype">int</span> p;</div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;    <span class="keywordflow">while</span> (!done) {</div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;      <a class="code" href="a00229.html#afbb862a2fdf5b72b1f9ace42f64b556f">_ArrayIndex1D_</a>(ndims,dim,index,ghosts,p);</div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;      <span class="keywordflow">for</span> (v=0; v&lt;nvars; v++)</div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;        par[nvars*p+v] += (   dxinv[offset+ghosts+index[d]]*dxinv[offset+ghosts+index[d]] </div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;                            * Deriv2[nvars*p+v] );</div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;      <a class="code" href="a00229.html#ac5ec1371623f11d03b0f42adaa24acbc">_ArrayIncrementIndex_</a>(ndims,dim,index,done);</div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;    }</div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;</div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;    offset += dim[d] + 2*ghosts;</div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;  }</div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;</div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;  <span class="keywordflow">if</span> (solver-&gt;<a class="code" href="a00202.html#ae83b1b0117b6a805ead2e4728945814c">flag_ib</a>) <a class="code" href="a00229.html#a4208c0f00455cf5113ce470bf641ecdd">_ArrayBlockMultiply_</a>(par,solver-&gt;<a class="code" href="a00202.html#a267ef7e03dbe9dd4440dee2fdf48619a">iblank</a>,size,nvars);</div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;  <span class="keywordflow">return</span>(0);</div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;}</div>
<div class="ttc" id="a00229_html_a2b2826031c0cd92495ab351d3e599fc5"><div class="ttname"><a href="a00229.html#a2b2826031c0cd92495ab351d3e599fc5">_ArraySetValue_</a></div><div class="ttdeci">#define _ArraySetValue_(x, size, value)</div><div class="ttdef"><b>Definition:</b> <a href="a00229_source.html#l00169">arrayfunctions.h:169</a></div></div>
<div class="ttc" id="a00229_html_afbb862a2fdf5b72b1f9ace42f64b556f"><div class="ttname"><a href="a00229.html#afbb862a2fdf5b72b1f9ace42f64b556f">_ArrayIndex1D_</a></div><div class="ttdeci">#define _ArrayIndex1D_(N, imax, i, ghost, index)</div><div class="ttdef"><b>Definition:</b> <a href="a00229_source.html#l00040">arrayfunctions.h:40</a></div></div>
<div class="ttc" id="a00202_html_aa24a4f5e29bd70cbe5a2413be1ea9682"><div class="ttname"><a href="a00202.html#aa24a4f5e29bd70cbe5a2413be1ea9682">HyPar::dxinv</a></div><div class="ttdeci">double * dxinv</div><div class="ttdef"><b>Definition:</b> <a href="a00238_source.html#l00110">hypar.h:110</a></div></div>
<div class="ttc" id="a00229_html_a4208c0f00455cf5113ce470bf641ecdd"><div class="ttname"><a href="a00229.html#a4208c0f00455cf5113ce470bf641ecdd">_ArrayBlockMultiply_</a></div><div class="ttdeci">#define _ArrayBlockMultiply_(x, a, n, bs)</div><div class="ttdef"><b>Definition:</b> <a href="a00229_source.html#l00388">arrayfunctions.h:388</a></div></div>
<div class="ttc" id="a00231_html_a68f50121fb9a7daeaf60e50cdef82ef3"><div class="ttname"><a href="a00231.html#a68f50121fb9a7daeaf60e50cdef82ef3">_DECLARE_IERR_</a></div><div class="ttdeci">#define _DECLARE_IERR_</div><div class="ttdef"><b>Definition:</b> <a href="a00231_source.html#l00017">basic.h:17</a></div></div>
<div class="ttc" id="a00202_html_a484873c74138512e41bc50d17b7d955a"><div class="ttname"><a href="a00202.html#a484873c74138512e41bc50d17b7d955a">HyPar::ndims</a></div><div class="ttdeci">int ndims</div><div class="ttdef"><b>Definition:</b> <a href="a00238_source.html#l00026">hypar.h:26</a></div></div>
<div class="ttc" id="a00202_html_a4b350316573a1d93caf01c5f1d43a45f"><div class="ttname"><a href="a00202.html#a4b350316573a1d93caf01c5f1d43a45f">HyPar::SecondDerivativePar</a></div><div class="ttdeci">int(* SecondDerivativePar)(double *, double *, int, void *, void *)</div><div class="ttdef"><b>Definition:</b> <a href="a00238_source.html#l00242">hypar.h:242</a></div></div>
<div class="ttc" id="a00231_html_ad6ab74942c9de13cf0b4c12eb0d91780"><div class="ttname"><a href="a00231.html#ad6ab74942c9de13cf0b4c12eb0d91780">IERR</a></div><div class="ttdeci">#define IERR</div><div class="ttdef"><b>Definition:</b> <a href="a00231_source.html#l00016">basic.h:16</a></div></div>
<div class="ttc" id="a00202_html_a31bc6f5b337e72aa281a1ea5ad5d6832"><div class="ttname"><a href="a00202.html#a31bc6f5b337e72aa281a1ea5ad5d6832">HyPar::Deriv2</a></div><div class="ttdeci">double * Deriv2</div><div class="ttdef"><b>Definition:</b> <a href="a00238_source.html#l00151">hypar.h:151</a></div></div>
<div class="ttc" id="a00202_html_ad8f03ca8c9fd6e1e235203495e8f2173"><div class="ttname"><a href="a00202.html#ad8f03ca8c9fd6e1e235203495e8f2173">HyPar::GFunction</a></div><div class="ttdeci">int(* GFunction)(double *, double *, int, void *, double)</div><div class="ttdef"><b>Definition:</b> <a href="a00238_source.html#l00305">hypar.h:305</a></div></div>
<div class="ttc" id="a00202_html_a38e0371f331cecbe63a77fa03e202afe"><div class="ttname"><a href="a00202.html#a38e0371f331cecbe63a77fa03e202afe">HyPar::dim_local</a></div><div class="ttdeci">int * dim_local</div><div class="ttdef"><b>Definition:</b> <a href="a00238_source.html#l00037">hypar.h:37</a></div></div>
<div class="ttc" id="a00202_html_aafc992b5fa79d5a4036024615d03bce6"><div class="ttname"><a href="a00202.html#aafc992b5fa79d5a4036024615d03bce6">HyPar::ghosts</a></div><div class="ttdeci">int ghosts</div><div class="ttdef"><b>Definition:</b> <a href="a00238_source.html#l00052">hypar.h:52</a></div></div>
<div class="ttc" id="a00202_html_a20ee1fd00a220b98513127884a5558cf"><div class="ttname"><a href="a00202.html#a20ee1fd00a220b98513127884a5558cf">HyPar::npoints_local_wghosts</a></div><div class="ttdeci">int npoints_local_wghosts</div><div class="ttdef"><b>Definition:</b> <a href="a00238_source.html#l00042">hypar.h:42</a></div></div>
<div class="ttc" id="a00231_html_add9cf96ae374934d245a1dc1ab697a42"><div class="ttname"><a href="a00231.html#add9cf96ae374934d245a1dc1ab697a42">CHECKERR</a></div><div class="ttdeci">#define CHECKERR(ierr)</div><div class="ttdef"><b>Definition:</b> <a href="a00231_source.html#l00018">basic.h:18</a></div></div>
<div class="ttc" id="a00202_html_ae8f6d2fd6490d3153cb4133bf183a404"><div class="ttname"><a href="a00202.html#ae8f6d2fd6490d3153cb4133bf183a404">HyPar::nvars</a></div><div class="ttdeci">int nvars</div><div class="ttdef"><b>Definition:</b> <a href="a00238_source.html#l00029">hypar.h:29</a></div></div>
<div class="ttc" id="a00205_html_a00663"><div class="ttname"><a href="a00205.html#a00663">MPIVariables</a></div><div class="ttdoc">Structure of MPI-related variables. </div><div class="ttdef"><b>Definition:</b> <a href="a00205_source.html#l00024">mpivars_struct.h:24</a></div></div>
<div class="ttc" id="a00202_html_a6e3288a129bfd334448fbf3089338b69"><div class="ttname"><a href="a00202.html#a6e3288a129bfd334448fbf3089338b69">HyPar::count_par</a></div><div class="ttdeci">int count_par</div><div class="ttdef"><b>Definition:</b> <a href="a00238_source.html#l00413">hypar.h:413</a></div></div>
<div class="ttc" id="a00202_html_aee7ff3b51db01ee6ed4038ff5311ed24"><div class="ttname"><a href="a00202.html#aee7ff3b51db01ee6ed4038ff5311ed24">HyPar::fluxC</a></div><div class="ttdeci">double * fluxC</div><div class="ttdef"><b>Definition:</b> <a href="a00238_source.html#l00128">hypar.h:128</a></div></div>
<div class="ttc" id="a00229_html_ac5ec1371623f11d03b0f42adaa24acbc"><div class="ttname"><a href="a00229.html#ac5ec1371623f11d03b0f42adaa24acbc">_ArrayIncrementIndex_</a></div><div class="ttdeci">#define _ArrayIncrementIndex_(N, imax, i, done)</div><div class="ttdef"><b>Definition:</b> <a href="a00229_source.html#l00126">arrayfunctions.h:126</a></div></div>
<div class="ttc" id="a00202_html_ae83b1b0117b6a805ead2e4728945814c"><div class="ttname"><a href="a00202.html#ae83b1b0117b6a805ead2e4728945814c">HyPar::flag_ib</a></div><div class="ttdeci">int flag_ib</div><div class="ttdef"><b>Definition:</b> <a href="a00238_source.html#l00436">hypar.h:436</a></div></div>
<div class="ttc" id="a00202_html_a267ef7e03dbe9dd4440dee2fdf48619a"><div class="ttname"><a href="a00202.html#a267ef7e03dbe9dd4440dee2fdf48619a">HyPar::iblank</a></div><div class="ttdeci">double * iblank</div><div class="ttdef"><b>Definition:</b> <a href="a00238_source.html#l00431">hypar.h:431</a></div></div>
<div class="ttc" id="a00202_html"><div class="ttname"><a href="a00202.html">HyPar</a></div><div class="ttdoc">Structure containing all solver-specific variables and functions. </div><div class="ttdef"><b>Definition:</b> <a href="a00238_source.html#l00023">hypar.h:23</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a9f5c8ed9c587aa71c9f75209222ad67c"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ParabolicFunctionNC2Stage </td>
          <td>(</td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>par</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>u</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>s</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>m</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>t</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Evaluate the parabolic term using a "1.5"-stage finite-difference spatial discretization: The parabolic term is assumed to be of the form: </p>
<p class="formulaDsp">
\begin{equation} {\bf P}\left({\bf u}\right) = \sum_{d1=0}^{D-1}\sum_{d2=0}^{D-1} \frac {\partial^2 h_{d1,d2}\left(\bf u\right)} {\partial x_{d1} \partial x_{d2}}, \end{equation}
</p>
<p> where \(d1\) and \(d2\) are spatial dimension indices, and \(D\) is the total number of spatial dimensions (<a class="el" href="a00202.html#a484873c74138512e41bc50d17b7d955a">HyPar::ndims</a>). This term is discretized at a grid point as: </p>
<p class="formulaDsp">
\begin{equation} \left.{\bf P}\left({\bf u}\right)\right|_j = \sum_{d1=0}^{D-1} \sum_{d2=0}^{D-1} \frac { \mathcal{D}_{d1}\mathcal{D}_{d2} \left[ {\bf h}_{d1,d2} \right] } {\Delta x_{d1} \Delta x_{d2}}, \end{equation}
</p>
<p> where \(\mathcal{D}\) denotes the finite-difference approximation to the first derivative. Each of the first derivative approximations are \(\mathcal{D}_{d1}\) and \(\mathcal{D}_{d2}\) are computed separately, and thus the cross-derivative is evaluated in two steps using <a class="el" href="a00202.html#add4554e1a8a541607b867db7ec38d7a9">HyPar::FirstDerivativePar</a>.</p>
<p><b>Notes:</b> </p>
<ul>
<li>This form of the parabolic term <b>does</b> <b>allow</b> for cross-derivatives ( \( d1 \ne d2 \)).</li>
<li>A \(n\)-th order central approximation to the second derivative can be expressed as a conjugation of two \((n-1)\)-th order approximations to the first derivative, one forward and one backward. Computing it this way avoids odd-even decoupling. Thus, where possible <a class="el" href="a00202.html#add4554e1a8a541607b867db7ec38d7a9">HyPar::FirstDerivativePar</a> should point to the function computing \((n-1)\)-th order first derivative where \(n\) is the desired order. Currently, this is implemented only for \(n=2\). For other values of \(n\), the first derivative is also computed with a \(n\)-th order approximation.</li>
</ul>
<p>To use this form of the parabolic term:</p>
<ul>
<li>specify <b>"par_space_type"</b> in solver.inp as <b>"nonconservative-2stage"</b> (<a class="el" href="a00202.html#ad45d57b33d578bf602574a221bf53d93">HyPar::spatial_type_par</a>).</li>
<li>the physical model must specify \({\bf h}_{d1,d2}\left({\bf u}\right)\) through <a class="el" href="a00202.html#a122bcc1ec2e20b3bc69d169580529021">HyPar::HFunction</a>.</li>
</ul>
<dl class="section see"><dt>See Also</dt><dd><a class="el" href="a00315.html#af9331a439bf243524c027eba50fdbbfd">ParabolicFunctionNC1_5Stage()</a> </dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">par</td><td>array to hold the computed parabolic term </td></tr>
    <tr><td class="paramname">u</td><td>solution </td></tr>
    <tr><td class="paramname">s</td><td>Solver object of type <a class="el" href="a00202.html" title="Structure containing all solver-specific variables and functions. ">HyPar</a> </td></tr>
    <tr><td class="paramname">m</td><td>MPI object of type <a class="el" href="a00205.html#a00663" title="Structure of MPI-related variables. ">MPIVariables</a> </td></tr>
    <tr><td class="paramname">t</td><td>Current simulation time </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="a00317_source.html#l00040">40</a> of file <a class="el" href="a00317_source.html">ParabolicFunctionNC2Stage.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;{</div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;  <a class="code" href="a00202.html">HyPar</a>         *solver = (<a class="code" href="a00202.html">HyPar</a>*)        s;</div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;  <a class="code" href="a00205.html#a00663">MPIVariables</a>  *mpi    = (<a class="code" href="a00205.html#a00663">MPIVariables</a>*) m;</div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;  <span class="keywordtype">double</span>        *Func   = solver-&gt;<a class="code" href="a00202.html#aee7ff3b51db01ee6ed4038ff5311ed24">fluxC</a>;</div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;  <span class="keywordtype">double</span>        *Deriv1 = solver-&gt;<a class="code" href="a00202.html#af163100a3e0533dbf1868decd5c8201c">Deriv1</a>;</div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;  <span class="keywordtype">double</span>        *Deriv2 = solver-&gt;<a class="code" href="a00202.html#a31bc6f5b337e72aa281a1ea5ad5d6832">Deriv2</a>;</div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;  <span class="keywordtype">int</span>           d, d1, d2, v, p, done;</div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;  <span class="keywordtype">double</span>        dxinv1, dxinv2;</div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;  <a class="code" href="a00231.html#a68f50121fb9a7daeaf60e50cdef82ef3">_DECLARE_IERR_</a>;</div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;</div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;  <span class="keywordtype">int</span>     ndims  = solver-&gt;<a class="code" href="a00202.html#a484873c74138512e41bc50d17b7d955a">ndims</a>;</div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;  <span class="keywordtype">int</span>     nvars  = solver-&gt;<a class="code" href="a00202.html#ae8f6d2fd6490d3153cb4133bf183a404">nvars</a>;</div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;  <span class="keywordtype">int</span>     ghosts = solver-&gt;<a class="code" href="a00202.html#aafc992b5fa79d5a4036024615d03bce6">ghosts</a>;</div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;  <span class="keywordtype">int</span>     *dim   = solver-&gt;<a class="code" href="a00202.html#a38e0371f331cecbe63a77fa03e202afe">dim_local</a>;</div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;  <span class="keywordtype">double</span>  *dxinv = solver-&gt;<a class="code" href="a00202.html#aa24a4f5e29bd70cbe5a2413be1ea9682">dxinv</a>;</div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;  <span class="keywordtype">int</span>     size   = solver-&gt;<a class="code" href="a00202.html#a20ee1fd00a220b98513127884a5558cf">npoints_local_wghosts</a>;</div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;</div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;  printf(<span class="stringliteral">&quot;HFunction is defined? = %p\n&quot;</span>, solver-&gt;<a class="code" href="a00202.html#a122bcc1ec2e20b3bc69d169580529021">HFunction</a>);</div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;</div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;  <span class="keywordflow">if</span> (!solver-&gt;<a class="code" href="a00202.html#a122bcc1ec2e20b3bc69d169580529021">HFunction</a>) <span class="keywordflow">return</span>(0); <span class="comment">/* zero parabolic terms */</span></div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;  solver-&gt;<a class="code" href="a00202.html#a6e3288a129bfd334448fbf3089338b69">count_par</a>++;</div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;</div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;  <span class="keywordtype">int</span> index[ndims];</div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;  <a class="code" href="a00229.html#a2b2826031c0cd92495ab351d3e599fc5">_ArraySetValue_</a>(par,size*nvars,0.0);</div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;</div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;  <span class="keywordflow">for</span> (d1 = 0; d1 &lt; ndims; d1++) {</div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;    <span class="keywordflow">for</span> (d2 = 0; d2 &lt; ndims; d2++) {</div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;</div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;      <span class="comment">/* calculate the diffusion function */</span></div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;      <a class="code" href="a00231.html#ad6ab74942c9de13cf0b4c12eb0d91780">IERR</a> solver-&gt;<a class="code" href="a00202.html#a122bcc1ec2e20b3bc69d169580529021">HFunction</a>(Func,u,d1,d2,solver,t);                    <a class="code" href="a00231.html#add9cf96ae374934d245a1dc1ab697a42">CHECKERR</a>(ierr);</div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;      <a class="code" href="a00231.html#ad6ab74942c9de13cf0b4c12eb0d91780">IERR</a> solver-&gt;<a class="code" href="a00202.html#add4554e1a8a541607b867db7ec38d7a9">FirstDerivativePar</a>(Deriv1,Func  ,d1, 1,solver,mpi);  <a class="code" href="a00231.html#add9cf96ae374934d245a1dc1ab697a42">CHECKERR</a>(ierr);</div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;      <a class="code" href="a00231.html#ad6ab74942c9de13cf0b4c12eb0d91780">IERR</a> <a class="code" href="a00248.html#a60ace5964c051fa481e6a1e6f1ef75d7">MPIExchangeBoundariesnD</a>(ndims,nvars,dim,ghosts,mpi,Deriv1);  <a class="code" href="a00231.html#add9cf96ae374934d245a1dc1ab697a42">CHECKERR</a>(ierr);</div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;      <a class="code" href="a00231.html#ad6ab74942c9de13cf0b4c12eb0d91780">IERR</a> solver-&gt;<a class="code" href="a00202.html#add4554e1a8a541607b867db7ec38d7a9">FirstDerivativePar</a>(Deriv2,Deriv1,d2,-1,solver,mpi);  <a class="code" href="a00231.html#add9cf96ae374934d245a1dc1ab697a42">CHECKERR</a>(ierr);</div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;</div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;      <span class="comment">/* calculate the final term - second derivative of the diffusion function */</span></div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;      done = 0; <a class="code" href="a00229.html#a2b2826031c0cd92495ab351d3e599fc5">_ArraySetValue_</a>(index,ndims,0);</div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;      <span class="keywordflow">while</span> (!done) {</div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;        <a class="code" href="a00229.html#afbb862a2fdf5b72b1f9ace42f64b556f">_ArrayIndex1D_</a>(ndims,dim,index,ghosts,p);</div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;        <a class="code" href="a00231.html#a9aa9bad8531d6733731a850ccc471a42">_GetCoordinate_</a>(d1,index[d1],dim,ghosts,dxinv,dxinv1);</div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;        <a class="code" href="a00231.html#a9aa9bad8531d6733731a850ccc471a42">_GetCoordinate_</a>(d2,index[d2],dim,ghosts,dxinv,dxinv2);</div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;        <span class="keywordflow">for</span> (v=0; v&lt;nvars; v++) par[nvars*p+v] += (dxinv1*dxinv2 * Deriv2[nvars*p+v]);</div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;        <a class="code" href="a00229.html#ac5ec1371623f11d03b0f42adaa24acbc">_ArrayIncrementIndex_</a>(ndims,dim,index,done);</div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;      }</div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;</div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;    }</div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;  }</div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;</div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;  <span class="keywordflow">if</span> (solver-&gt;<a class="code" href="a00202.html#ae83b1b0117b6a805ead2e4728945814c">flag_ib</a>) <a class="code" href="a00229.html#a4208c0f00455cf5113ce470bf641ecdd">_ArrayBlockMultiply_</a>(par,solver-&gt;<a class="code" href="a00202.html#a267ef7e03dbe9dd4440dee2fdf48619a">iblank</a>,size,nvars);</div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;  <span class="keywordflow">return</span>(0);</div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;}</div>
<div class="ttc" id="a00202_html_add4554e1a8a541607b867db7ec38d7a9"><div class="ttname"><a href="a00202.html#add4554e1a8a541607b867db7ec38d7a9">HyPar::FirstDerivativePar</a></div><div class="ttdeci">int(* FirstDerivativePar)(double *, double *, int, int, void *, void *)</div><div class="ttdef"><b>Definition:</b> <a href="a00238_source.html#l00238">hypar.h:238</a></div></div>
<div class="ttc" id="a00229_html_a2b2826031c0cd92495ab351d3e599fc5"><div class="ttname"><a href="a00229.html#a2b2826031c0cd92495ab351d3e599fc5">_ArraySetValue_</a></div><div class="ttdeci">#define _ArraySetValue_(x, size, value)</div><div class="ttdef"><b>Definition:</b> <a href="a00229_source.html#l00169">arrayfunctions.h:169</a></div></div>
<div class="ttc" id="a00248_html_a60ace5964c051fa481e6a1e6f1ef75d7"><div class="ttname"><a href="a00248.html#a60ace5964c051fa481e6a1e6f1ef75d7">MPIExchangeBoundariesnD</a></div><div class="ttdeci">int MPIExchangeBoundariesnD(int, int, int *, int, void *, double *)</div><div class="ttdef"><b>Definition:</b> <a href="a00383_source.html#l00042">MPIExchangeBoundariesnD.c:42</a></div></div>
<div class="ttc" id="a00202_html_a122bcc1ec2e20b3bc69d169580529021"><div class="ttname"><a href="a00202.html#a122bcc1ec2e20b3bc69d169580529021">HyPar::HFunction</a></div><div class="ttdeci">int(* HFunction)(double *, double *, int, int, void *, double)</div><div class="ttdef"><b>Definition:</b> <a href="a00238_source.html#l00308">hypar.h:308</a></div></div>
<div class="ttc" id="a00229_html_afbb862a2fdf5b72b1f9ace42f64b556f"><div class="ttname"><a href="a00229.html#afbb862a2fdf5b72b1f9ace42f64b556f">_ArrayIndex1D_</a></div><div class="ttdeci">#define _ArrayIndex1D_(N, imax, i, ghost, index)</div><div class="ttdef"><b>Definition:</b> <a href="a00229_source.html#l00040">arrayfunctions.h:40</a></div></div>
<div class="ttc" id="a00202_html_aa24a4f5e29bd70cbe5a2413be1ea9682"><div class="ttname"><a href="a00202.html#aa24a4f5e29bd70cbe5a2413be1ea9682">HyPar::dxinv</a></div><div class="ttdeci">double * dxinv</div><div class="ttdef"><b>Definition:</b> <a href="a00238_source.html#l00110">hypar.h:110</a></div></div>
<div class="ttc" id="a00229_html_a4208c0f00455cf5113ce470bf641ecdd"><div class="ttname"><a href="a00229.html#a4208c0f00455cf5113ce470bf641ecdd">_ArrayBlockMultiply_</a></div><div class="ttdeci">#define _ArrayBlockMultiply_(x, a, n, bs)</div><div class="ttdef"><b>Definition:</b> <a href="a00229_source.html#l00388">arrayfunctions.h:388</a></div></div>
<div class="ttc" id="a00231_html_a68f50121fb9a7daeaf60e50cdef82ef3"><div class="ttname"><a href="a00231.html#a68f50121fb9a7daeaf60e50cdef82ef3">_DECLARE_IERR_</a></div><div class="ttdeci">#define _DECLARE_IERR_</div><div class="ttdef"><b>Definition:</b> <a href="a00231_source.html#l00017">basic.h:17</a></div></div>
<div class="ttc" id="a00202_html_a484873c74138512e41bc50d17b7d955a"><div class="ttname"><a href="a00202.html#a484873c74138512e41bc50d17b7d955a">HyPar::ndims</a></div><div class="ttdeci">int ndims</div><div class="ttdef"><b>Definition:</b> <a href="a00238_source.html#l00026">hypar.h:26</a></div></div>
<div class="ttc" id="a00231_html_ad6ab74942c9de13cf0b4c12eb0d91780"><div class="ttname"><a href="a00231.html#ad6ab74942c9de13cf0b4c12eb0d91780">IERR</a></div><div class="ttdeci">#define IERR</div><div class="ttdef"><b>Definition:</b> <a href="a00231_source.html#l00016">basic.h:16</a></div></div>
<div class="ttc" id="a00202_html_a31bc6f5b337e72aa281a1ea5ad5d6832"><div class="ttname"><a href="a00202.html#a31bc6f5b337e72aa281a1ea5ad5d6832">HyPar::Deriv2</a></div><div class="ttdeci">double * Deriv2</div><div class="ttdef"><b>Definition:</b> <a href="a00238_source.html#l00151">hypar.h:151</a></div></div>
<div class="ttc" id="a00202_html_a38e0371f331cecbe63a77fa03e202afe"><div class="ttname"><a href="a00202.html#a38e0371f331cecbe63a77fa03e202afe">HyPar::dim_local</a></div><div class="ttdeci">int * dim_local</div><div class="ttdef"><b>Definition:</b> <a href="a00238_source.html#l00037">hypar.h:37</a></div></div>
<div class="ttc" id="a00202_html_aafc992b5fa79d5a4036024615d03bce6"><div class="ttname"><a href="a00202.html#aafc992b5fa79d5a4036024615d03bce6">HyPar::ghosts</a></div><div class="ttdeci">int ghosts</div><div class="ttdef"><b>Definition:</b> <a href="a00238_source.html#l00052">hypar.h:52</a></div></div>
<div class="ttc" id="a00202_html_a20ee1fd00a220b98513127884a5558cf"><div class="ttname"><a href="a00202.html#a20ee1fd00a220b98513127884a5558cf">HyPar::npoints_local_wghosts</a></div><div class="ttdeci">int npoints_local_wghosts</div><div class="ttdef"><b>Definition:</b> <a href="a00238_source.html#l00042">hypar.h:42</a></div></div>
<div class="ttc" id="a00231_html_add9cf96ae374934d245a1dc1ab697a42"><div class="ttname"><a href="a00231.html#add9cf96ae374934d245a1dc1ab697a42">CHECKERR</a></div><div class="ttdeci">#define CHECKERR(ierr)</div><div class="ttdef"><b>Definition:</b> <a href="a00231_source.html#l00018">basic.h:18</a></div></div>
<div class="ttc" id="a00231_html_a9aa9bad8531d6733731a850ccc471a42"><div class="ttname"><a href="a00231.html#a9aa9bad8531d6733731a850ccc471a42">_GetCoordinate_</a></div><div class="ttdeci">#define _GetCoordinate_(dir, i, dim, ghosts, x, coord)</div><div class="ttdef"><b>Definition:</b> <a href="a00231_source.html#l00031">basic.h:31</a></div></div>
<div class="ttc" id="a00202_html_ae8f6d2fd6490d3153cb4133bf183a404"><div class="ttname"><a href="a00202.html#ae8f6d2fd6490d3153cb4133bf183a404">HyPar::nvars</a></div><div class="ttdeci">int nvars</div><div class="ttdef"><b>Definition:</b> <a href="a00238_source.html#l00029">hypar.h:29</a></div></div>
<div class="ttc" id="a00205_html_a00663"><div class="ttname"><a href="a00205.html#a00663">MPIVariables</a></div><div class="ttdoc">Structure of MPI-related variables. </div><div class="ttdef"><b>Definition:</b> <a href="a00205_source.html#l00024">mpivars_struct.h:24</a></div></div>
<div class="ttc" id="a00202_html_af163100a3e0533dbf1868decd5c8201c"><div class="ttname"><a href="a00202.html#af163100a3e0533dbf1868decd5c8201c">HyPar::Deriv1</a></div><div class="ttdeci">double * Deriv1</div><div class="ttdef"><b>Definition:</b> <a href="a00238_source.html#l00151">hypar.h:151</a></div></div>
<div class="ttc" id="a00202_html_a6e3288a129bfd334448fbf3089338b69"><div class="ttname"><a href="a00202.html#a6e3288a129bfd334448fbf3089338b69">HyPar::count_par</a></div><div class="ttdeci">int count_par</div><div class="ttdef"><b>Definition:</b> <a href="a00238_source.html#l00413">hypar.h:413</a></div></div>
<div class="ttc" id="a00202_html_aee7ff3b51db01ee6ed4038ff5311ed24"><div class="ttname"><a href="a00202.html#aee7ff3b51db01ee6ed4038ff5311ed24">HyPar::fluxC</a></div><div class="ttdeci">double * fluxC</div><div class="ttdef"><b>Definition:</b> <a href="a00238_source.html#l00128">hypar.h:128</a></div></div>
<div class="ttc" id="a00229_html_ac5ec1371623f11d03b0f42adaa24acbc"><div class="ttname"><a href="a00229.html#ac5ec1371623f11d03b0f42adaa24acbc">_ArrayIncrementIndex_</a></div><div class="ttdeci">#define _ArrayIncrementIndex_(N, imax, i, done)</div><div class="ttdef"><b>Definition:</b> <a href="a00229_source.html#l00126">arrayfunctions.h:126</a></div></div>
<div class="ttc" id="a00202_html_ae83b1b0117b6a805ead2e4728945814c"><div class="ttname"><a href="a00202.html#ae83b1b0117b6a805ead2e4728945814c">HyPar::flag_ib</a></div><div class="ttdeci">int flag_ib</div><div class="ttdef"><b>Definition:</b> <a href="a00238_source.html#l00436">hypar.h:436</a></div></div>
<div class="ttc" id="a00202_html_a267ef7e03dbe9dd4440dee2fdf48619a"><div class="ttname"><a href="a00202.html#a267ef7e03dbe9dd4440dee2fdf48619a">HyPar::iblank</a></div><div class="ttdeci">double * iblank</div><div class="ttdef"><b>Definition:</b> <a href="a00238_source.html#l00431">hypar.h:431</a></div></div>
<div class="ttc" id="a00202_html"><div class="ttname"><a href="a00202.html">HyPar</a></div><div class="ttdoc">Structure containing all solver-specific variables and functions. </div><div class="ttdef"><b>Definition:</b> <a href="a00238_source.html#l00023">hypar.h:23</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="aedd832fdf4002f675da44a840e132456"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ParabolicFunctionNC1_5Stage </td>
          <td>(</td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>par</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>u</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>s</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>m</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>t</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Evaluate the parabolic term using a "1.5"-stage finite-difference spatial discretization: The parabolic term is assumed to be of the form: </p>
<p class="formulaDsp">
\begin{equation} {\bf P}\left({\bf u}\right) = \sum_{d1=0}^{D-1}\sum_{d2=0}^{D-1} \frac {\partial^2 h_{d1,d2}\left(\bf u\right)} {\partial x_{d1} \partial x_{d2}}, \end{equation}
</p>
<p> where \(d1\) and \(d2\) are spatial dimension indices, and \(D\) is the total number of spatial dimensions (<a class="el" href="a00202.html#a484873c74138512e41bc50d17b7d955a">HyPar::ndims</a>). This term is discretized at a grid point as: </p>
<p class="formulaDsp">
\begin{equation} \left.{\bf P}\left({\bf u}\right)\right|_j = \sum_{d1=0}^{D-1} \sum_{d2=0}^{D-1} \frac { \mathcal{D}_{d1}\mathcal{D}_{d2} \left[ {\bf h}_{d1,d2} \right] } {\Delta x_{d1} \Delta x_{d2}}, \end{equation}
</p>
<p> where \(\mathcal{D}\) denotes the finite-difference approximation to the first derivative.</p>
<ul>
<li>When \(d = d1 = d2\), the operator \(\mathcal{D}^2_d\left[\cdot\right] = \mathcal{D}_{d}\mathcal{D}_{d}\left[\cdot\right]\) is computed in one step as the finite-difference approximation to the second derivative (Laplacian) \(\mathcal{L}_d\left[\cdot\right]\) using <a class="el" href="a00202.html#a4b350316573a1d93caf01c5f1d43a45f">HyPar::SecondDerivativePar</a>.</li>
<li>When \(d1 \ne d2 \), each of the first derivative approximations are \(\mathcal{D}_{d1}\) and \(\mathcal{D}_{d2}\) are computed separately, and thus the cross-derivative is evaluated in two steps using <a class="el" href="a00202.html#add4554e1a8a541607b867db7ec38d7a9">HyPar::FirstDerivativePar</a>.</li>
</ul>
<p><b>Note:</b> this form of the parabolic term <b>does</b> <b>allow</b> for cross-derivatives ( \( d1 \ne d2 \)).</p>
<p>To use this form of the parabolic term:</p>
<ul>
<li>specify <b>"par_space_type"</b> in solver.inp as <b>"nonconservative-1.5stage"</b> (<a class="el" href="a00202.html#ad45d57b33d578bf602574a221bf53d93">HyPar::spatial_type_par</a>).</li>
<li>the physical model must specify \({\bf h}_{d1,d2}\left({\bf u}\right)\) through <a class="el" href="a00202.html#a122bcc1ec2e20b3bc69d169580529021">HyPar::HFunction</a>.</li>
</ul>
<dl class="section see"><dt>See Also</dt><dd><a class="el" href="a00317.html#a153eb91ec9b118a7b8c971facbc8d920">ParabolicFunctionNC2Stage()</a> </dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">par</td><td>array to hold the computed parabolic term </td></tr>
    <tr><td class="paramname">u</td><td>solution </td></tr>
    <tr><td class="paramname">s</td><td>Solver object of type <a class="el" href="a00202.html" title="Structure containing all solver-specific variables and functions. ">HyPar</a> </td></tr>
    <tr><td class="paramname">m</td><td>MPI object of type <a class="el" href="a00205.html#a00663" title="Structure of MPI-related variables. ">MPIVariables</a> </td></tr>
    <tr><td class="paramname">t</td><td>Current simulation time </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="a00315_source.html#l00035">35</a> of file <a class="el" href="a00315_source.html">ParabolicFunctionNC1.5Stage.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;{</div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;  <a class="code" href="a00202.html">HyPar</a>         *solver = (<a class="code" href="a00202.html">HyPar</a>*)        s;</div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;  <a class="code" href="a00205.html#a00663">MPIVariables</a>  *mpi    = (<a class="code" href="a00205.html#a00663">MPIVariables</a>*) m;</div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;  <span class="keywordtype">double</span>        *Func   = solver-&gt;<a class="code" href="a00202.html#aee7ff3b51db01ee6ed4038ff5311ed24">fluxC</a>;</div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;  <span class="keywordtype">double</span>        *Deriv1 = solver-&gt;<a class="code" href="a00202.html#af163100a3e0533dbf1868decd5c8201c">Deriv1</a>;</div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;  <span class="keywordtype">double</span>        *Deriv2 = solver-&gt;<a class="code" href="a00202.html#a31bc6f5b337e72aa281a1ea5ad5d6832">Deriv2</a>;</div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;  <span class="keywordtype">int</span>           d, d1, d2, v, p, done;</div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;  <span class="keywordtype">double</span>        dxinv1, dxinv2;</div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;  <a class="code" href="a00231.html#a68f50121fb9a7daeaf60e50cdef82ef3">_DECLARE_IERR_</a>;</div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;</div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;  <span class="keywordtype">int</span>     ndims   = solver-&gt;<a class="code" href="a00202.html#a484873c74138512e41bc50d17b7d955a">ndims</a>;</div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;  <span class="keywordtype">int</span>     nvars   = solver-&gt;<a class="code" href="a00202.html#ae8f6d2fd6490d3153cb4133bf183a404">nvars</a>;</div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;  <span class="keywordtype">int</span>     ghosts  = solver-&gt;<a class="code" href="a00202.html#aafc992b5fa79d5a4036024615d03bce6">ghosts</a>;</div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;  <span class="keywordtype">int</span>     *dim    = solver-&gt;<a class="code" href="a00202.html#a38e0371f331cecbe63a77fa03e202afe">dim_local</a>;</div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;  <span class="keywordtype">double</span>  *dxinv  = solver-&gt;<a class="code" href="a00202.html#aa24a4f5e29bd70cbe5a2413be1ea9682">dxinv</a>;</div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;  <span class="keywordtype">int</span>     size   = solver-&gt;<a class="code" href="a00202.html#a20ee1fd00a220b98513127884a5558cf">npoints_local_wghosts</a>;</div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;</div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;  <span class="keywordflow">if</span> (!solver-&gt;<a class="code" href="a00202.html#a122bcc1ec2e20b3bc69d169580529021">HFunction</a>) <span class="keywordflow">return</span>(0); <span class="comment">/* zero parabolic terms */</span></div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;  solver-&gt;<a class="code" href="a00202.html#a6e3288a129bfd334448fbf3089338b69">count_par</a>++;</div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;</div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;  <span class="keywordtype">int</span> index[ndims];</div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;  <a class="code" href="a00229.html#a2b2826031c0cd92495ab351d3e599fc5">_ArraySetValue_</a>(par,size*nvars,0.0);</div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;</div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;  <span class="keywordflow">for</span> (d1 = 0; d1 &lt; ndims; d1++) {</div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;    <span class="keywordflow">for</span> (d2 = 0; d2 &lt; ndims; d2++) {</div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;</div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;      <span class="comment">/* calculate the diffusion function */</span></div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;      <a class="code" href="a00231.html#ad6ab74942c9de13cf0b4c12eb0d91780">IERR</a> solver-&gt;<a class="code" href="a00202.html#a122bcc1ec2e20b3bc69d169580529021">HFunction</a>(Func,u,d1,d2,solver,t);                      <a class="code" href="a00231.html#add9cf96ae374934d245a1dc1ab697a42">CHECKERR</a>(ierr);</div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;      <span class="keywordflow">if</span> (d1 == d2) {</div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;        <span class="comment">/* second derivative with respect to the same independent variable */</span></div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;        <a class="code" href="a00231.html#ad6ab74942c9de13cf0b4c12eb0d91780">IERR</a> solver-&gt;<a class="code" href="a00202.html#a4b350316573a1d93caf01c5f1d43a45f">SecondDerivativePar</a>(Deriv2,Func,d1,solver,mpi);      <a class="code" href="a00231.html#add9cf96ae374934d245a1dc1ab697a42">CHECKERR</a>(ierr);</div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;      } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;        <span class="comment">/* cross derivative */</span></div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;        <a class="code" href="a00231.html#ad6ab74942c9de13cf0b4c12eb0d91780">IERR</a> solver-&gt;<a class="code" href="a00202.html#add4554e1a8a541607b867db7ec38d7a9">FirstDerivativePar</a>(Deriv1,Func  ,d1, 1,solver,mpi);  <a class="code" href="a00231.html#add9cf96ae374934d245a1dc1ab697a42">CHECKERR</a>(ierr);</div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;        <a class="code" href="a00231.html#ad6ab74942c9de13cf0b4c12eb0d91780">IERR</a> <a class="code" href="a00248.html#a60ace5964c051fa481e6a1e6f1ef75d7">MPIExchangeBoundariesnD</a>(ndims,nvars,dim,ghosts,mpi,Deriv1);  <a class="code" href="a00231.html#add9cf96ae374934d245a1dc1ab697a42">CHECKERR</a>(ierr);</div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;        <a class="code" href="a00231.html#ad6ab74942c9de13cf0b4c12eb0d91780">IERR</a> solver-&gt;<a class="code" href="a00202.html#add4554e1a8a541607b867db7ec38d7a9">FirstDerivativePar</a>(Deriv2,Deriv1,d2,-1,solver,mpi);  <a class="code" href="a00231.html#add9cf96ae374934d245a1dc1ab697a42">CHECKERR</a>(ierr);</div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;      }</div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;</div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;      <span class="comment">/* calculate the final term - second derivative of the diffusion function */</span></div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;      done = 0; <a class="code" href="a00229.html#a2b2826031c0cd92495ab351d3e599fc5">_ArraySetValue_</a>(index,ndims,0);</div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;      <span class="keywordflow">while</span> (!done) {</div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;        <a class="code" href="a00229.html#afbb862a2fdf5b72b1f9ace42f64b556f">_ArrayIndex1D_</a>(ndims,dim,index,ghosts,p);</div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;        <a class="code" href="a00231.html#a9aa9bad8531d6733731a850ccc471a42">_GetCoordinate_</a>(d1,index[d1],dim,ghosts,dxinv,dxinv1);</div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;        <a class="code" href="a00231.html#a9aa9bad8531d6733731a850ccc471a42">_GetCoordinate_</a>(d2,index[d2],dim,ghosts,dxinv,dxinv2);</div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;        <span class="keywordflow">for</span> (v=0; v&lt;nvars; v++) par[nvars*p+v] += (dxinv1*dxinv2 * Deriv2[nvars*p+v]);</div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;        <a class="code" href="a00229.html#ac5ec1371623f11d03b0f42adaa24acbc">_ArrayIncrementIndex_</a>(ndims,dim,index,done);</div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;      }</div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;</div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;    }</div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;  }</div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;</div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;  <span class="keywordflow">if</span> (solver-&gt;<a class="code" href="a00202.html#ae83b1b0117b6a805ead2e4728945814c">flag_ib</a>) <a class="code" href="a00229.html#a4208c0f00455cf5113ce470bf641ecdd">_ArrayBlockMultiply_</a>(par,solver-&gt;<a class="code" href="a00202.html#a267ef7e03dbe9dd4440dee2fdf48619a">iblank</a>,size,nvars);</div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;  <span class="keywordflow">return</span>(0);</div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;}</div>
<div class="ttc" id="a00202_html_add4554e1a8a541607b867db7ec38d7a9"><div class="ttname"><a href="a00202.html#add4554e1a8a541607b867db7ec38d7a9">HyPar::FirstDerivativePar</a></div><div class="ttdeci">int(* FirstDerivativePar)(double *, double *, int, int, void *, void *)</div><div class="ttdef"><b>Definition:</b> <a href="a00238_source.html#l00238">hypar.h:238</a></div></div>
<div class="ttc" id="a00229_html_a2b2826031c0cd92495ab351d3e599fc5"><div class="ttname"><a href="a00229.html#a2b2826031c0cd92495ab351d3e599fc5">_ArraySetValue_</a></div><div class="ttdeci">#define _ArraySetValue_(x, size, value)</div><div class="ttdef"><b>Definition:</b> <a href="a00229_source.html#l00169">arrayfunctions.h:169</a></div></div>
<div class="ttc" id="a00248_html_a60ace5964c051fa481e6a1e6f1ef75d7"><div class="ttname"><a href="a00248.html#a60ace5964c051fa481e6a1e6f1ef75d7">MPIExchangeBoundariesnD</a></div><div class="ttdeci">int MPIExchangeBoundariesnD(int, int, int *, int, void *, double *)</div><div class="ttdef"><b>Definition:</b> <a href="a00383_source.html#l00042">MPIExchangeBoundariesnD.c:42</a></div></div>
<div class="ttc" id="a00202_html_a122bcc1ec2e20b3bc69d169580529021"><div class="ttname"><a href="a00202.html#a122bcc1ec2e20b3bc69d169580529021">HyPar::HFunction</a></div><div class="ttdeci">int(* HFunction)(double *, double *, int, int, void *, double)</div><div class="ttdef"><b>Definition:</b> <a href="a00238_source.html#l00308">hypar.h:308</a></div></div>
<div class="ttc" id="a00229_html_afbb862a2fdf5b72b1f9ace42f64b556f"><div class="ttname"><a href="a00229.html#afbb862a2fdf5b72b1f9ace42f64b556f">_ArrayIndex1D_</a></div><div class="ttdeci">#define _ArrayIndex1D_(N, imax, i, ghost, index)</div><div class="ttdef"><b>Definition:</b> <a href="a00229_source.html#l00040">arrayfunctions.h:40</a></div></div>
<div class="ttc" id="a00202_html_aa24a4f5e29bd70cbe5a2413be1ea9682"><div class="ttname"><a href="a00202.html#aa24a4f5e29bd70cbe5a2413be1ea9682">HyPar::dxinv</a></div><div class="ttdeci">double * dxinv</div><div class="ttdef"><b>Definition:</b> <a href="a00238_source.html#l00110">hypar.h:110</a></div></div>
<div class="ttc" id="a00229_html_a4208c0f00455cf5113ce470bf641ecdd"><div class="ttname"><a href="a00229.html#a4208c0f00455cf5113ce470bf641ecdd">_ArrayBlockMultiply_</a></div><div class="ttdeci">#define _ArrayBlockMultiply_(x, a, n, bs)</div><div class="ttdef"><b>Definition:</b> <a href="a00229_source.html#l00388">arrayfunctions.h:388</a></div></div>
<div class="ttc" id="a00231_html_a68f50121fb9a7daeaf60e50cdef82ef3"><div class="ttname"><a href="a00231.html#a68f50121fb9a7daeaf60e50cdef82ef3">_DECLARE_IERR_</a></div><div class="ttdeci">#define _DECLARE_IERR_</div><div class="ttdef"><b>Definition:</b> <a href="a00231_source.html#l00017">basic.h:17</a></div></div>
<div class="ttc" id="a00202_html_a484873c74138512e41bc50d17b7d955a"><div class="ttname"><a href="a00202.html#a484873c74138512e41bc50d17b7d955a">HyPar::ndims</a></div><div class="ttdeci">int ndims</div><div class="ttdef"><b>Definition:</b> <a href="a00238_source.html#l00026">hypar.h:26</a></div></div>
<div class="ttc" id="a00202_html_a4b350316573a1d93caf01c5f1d43a45f"><div class="ttname"><a href="a00202.html#a4b350316573a1d93caf01c5f1d43a45f">HyPar::SecondDerivativePar</a></div><div class="ttdeci">int(* SecondDerivativePar)(double *, double *, int, void *, void *)</div><div class="ttdef"><b>Definition:</b> <a href="a00238_source.html#l00242">hypar.h:242</a></div></div>
<div class="ttc" id="a00231_html_ad6ab74942c9de13cf0b4c12eb0d91780"><div class="ttname"><a href="a00231.html#ad6ab74942c9de13cf0b4c12eb0d91780">IERR</a></div><div class="ttdeci">#define IERR</div><div class="ttdef"><b>Definition:</b> <a href="a00231_source.html#l00016">basic.h:16</a></div></div>
<div class="ttc" id="a00202_html_a31bc6f5b337e72aa281a1ea5ad5d6832"><div class="ttname"><a href="a00202.html#a31bc6f5b337e72aa281a1ea5ad5d6832">HyPar::Deriv2</a></div><div class="ttdeci">double * Deriv2</div><div class="ttdef"><b>Definition:</b> <a href="a00238_source.html#l00151">hypar.h:151</a></div></div>
<div class="ttc" id="a00202_html_a38e0371f331cecbe63a77fa03e202afe"><div class="ttname"><a href="a00202.html#a38e0371f331cecbe63a77fa03e202afe">HyPar::dim_local</a></div><div class="ttdeci">int * dim_local</div><div class="ttdef"><b>Definition:</b> <a href="a00238_source.html#l00037">hypar.h:37</a></div></div>
<div class="ttc" id="a00202_html_aafc992b5fa79d5a4036024615d03bce6"><div class="ttname"><a href="a00202.html#aafc992b5fa79d5a4036024615d03bce6">HyPar::ghosts</a></div><div class="ttdeci">int ghosts</div><div class="ttdef"><b>Definition:</b> <a href="a00238_source.html#l00052">hypar.h:52</a></div></div>
<div class="ttc" id="a00202_html_a20ee1fd00a220b98513127884a5558cf"><div class="ttname"><a href="a00202.html#a20ee1fd00a220b98513127884a5558cf">HyPar::npoints_local_wghosts</a></div><div class="ttdeci">int npoints_local_wghosts</div><div class="ttdef"><b>Definition:</b> <a href="a00238_source.html#l00042">hypar.h:42</a></div></div>
<div class="ttc" id="a00231_html_add9cf96ae374934d245a1dc1ab697a42"><div class="ttname"><a href="a00231.html#add9cf96ae374934d245a1dc1ab697a42">CHECKERR</a></div><div class="ttdeci">#define CHECKERR(ierr)</div><div class="ttdef"><b>Definition:</b> <a href="a00231_source.html#l00018">basic.h:18</a></div></div>
<div class="ttc" id="a00231_html_a9aa9bad8531d6733731a850ccc471a42"><div class="ttname"><a href="a00231.html#a9aa9bad8531d6733731a850ccc471a42">_GetCoordinate_</a></div><div class="ttdeci">#define _GetCoordinate_(dir, i, dim, ghosts, x, coord)</div><div class="ttdef"><b>Definition:</b> <a href="a00231_source.html#l00031">basic.h:31</a></div></div>
<div class="ttc" id="a00202_html_ae8f6d2fd6490d3153cb4133bf183a404"><div class="ttname"><a href="a00202.html#ae8f6d2fd6490d3153cb4133bf183a404">HyPar::nvars</a></div><div class="ttdeci">int nvars</div><div class="ttdef"><b>Definition:</b> <a href="a00238_source.html#l00029">hypar.h:29</a></div></div>
<div class="ttc" id="a00205_html_a00663"><div class="ttname"><a href="a00205.html#a00663">MPIVariables</a></div><div class="ttdoc">Structure of MPI-related variables. </div><div class="ttdef"><b>Definition:</b> <a href="a00205_source.html#l00024">mpivars_struct.h:24</a></div></div>
<div class="ttc" id="a00202_html_af163100a3e0533dbf1868decd5c8201c"><div class="ttname"><a href="a00202.html#af163100a3e0533dbf1868decd5c8201c">HyPar::Deriv1</a></div><div class="ttdeci">double * Deriv1</div><div class="ttdef"><b>Definition:</b> <a href="a00238_source.html#l00151">hypar.h:151</a></div></div>
<div class="ttc" id="a00202_html_a6e3288a129bfd334448fbf3089338b69"><div class="ttname"><a href="a00202.html#a6e3288a129bfd334448fbf3089338b69">HyPar::count_par</a></div><div class="ttdeci">int count_par</div><div class="ttdef"><b>Definition:</b> <a href="a00238_source.html#l00413">hypar.h:413</a></div></div>
<div class="ttc" id="a00202_html_aee7ff3b51db01ee6ed4038ff5311ed24"><div class="ttname"><a href="a00202.html#aee7ff3b51db01ee6ed4038ff5311ed24">HyPar::fluxC</a></div><div class="ttdeci">double * fluxC</div><div class="ttdef"><b>Definition:</b> <a href="a00238_source.html#l00128">hypar.h:128</a></div></div>
<div class="ttc" id="a00229_html_ac5ec1371623f11d03b0f42adaa24acbc"><div class="ttname"><a href="a00229.html#ac5ec1371623f11d03b0f42adaa24acbc">_ArrayIncrementIndex_</a></div><div class="ttdeci">#define _ArrayIncrementIndex_(N, imax, i, done)</div><div class="ttdef"><b>Definition:</b> <a href="a00229_source.html#l00126">arrayfunctions.h:126</a></div></div>
<div class="ttc" id="a00202_html_ae83b1b0117b6a805ead2e4728945814c"><div class="ttname"><a href="a00202.html#ae83b1b0117b6a805ead2e4728945814c">HyPar::flag_ib</a></div><div class="ttdeci">int flag_ib</div><div class="ttdef"><b>Definition:</b> <a href="a00238_source.html#l00436">hypar.h:436</a></div></div>
<div class="ttc" id="a00202_html_a267ef7e03dbe9dd4440dee2fdf48619a"><div class="ttname"><a href="a00202.html#a267ef7e03dbe9dd4440dee2fdf48619a">HyPar::iblank</a></div><div class="ttdeci">double * iblank</div><div class="ttdef"><b>Definition:</b> <a href="a00238_source.html#l00431">hypar.h:431</a></div></div>
<div class="ttc" id="a00202_html"><div class="ttname"><a href="a00202.html">HyPar</a></div><div class="ttdoc">Structure containing all solver-specific variables and functions. </div><div class="ttdef"><b>Definition:</b> <a href="a00238_source.html#l00023">hypar.h:23</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="abcdd5c036af1b80bd99884e9148fa711"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ParabolicFunctionCons1Stage </td>
          <td>(</td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>par</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>u</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>s</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>m</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>t</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Evaluate the parabolic term using a conservative finite-difference spatial discretization: The parabolic term is assumed to be of the form: </p>
<p class="formulaDsp">
\begin{equation} {\bf P}\left({\bf u}\right) = \sum_{d=0}^{D-1} \frac {\partial^2 {\bf g}_d\left(\bf u\right)} {\partial x_d^2}, \end{equation}
</p>
<p> which is discretized at a grid point as: </p>
<p class="formulaDsp">
\begin{equation} \left.{\bf P}\left({\bf u}\right)\right|_j = \sum_{d=0}^{D-1} \frac { \hat{\bf g}_{j+1/2} - \hat{\bf g}_{j-1/2} } {\Delta x_d^2}, \end{equation}
</p>
<p> where \(d\) is the spatial dimension index, \(D\) is the total number of spatial dimensions (<a class="el" href="a00202.html#a484873c74138512e41bc50d17b7d955a">HyPar::ndims</a>), and \(j\) is the grid index along \(d\). \(\hat{\bf g}_d\) is the numerical approximation to the second primitive of \({\bf g}_d\left({\bf u}\right)\), computed using <a class="el" href="a00202.html#a13a0f9420009a55a3689f407a2c8efea">HyPar::InterpolateInterfacesPar</a>.</p>
<p><b>Note:</b> this form of the parabolic term <b>does</b> <b>not</b> allow for cross-derivatives.</p>
<p>To use this form of the parabolic term:</p>
<ul>
<li>specify <b>"par_space_type"</b> in solver.inp as <b>"conservative-1stage"</b> (<a class="el" href="a00202.html#ad45d57b33d578bf602574a221bf53d93">HyPar::spatial_type_par</a>).</li>
<li>the physical model must specify \({\bf g}_d\left({\bf u}\right)\) through <a class="el" href="a00202.html#ad8f03ca8c9fd6e1e235203495e8f2173">HyPar::GFunction</a>.</li>
</ul>
<p><b>Reference:</b> Liu, Y., Shu, C.-W., Zhang, M., "High order finite difference WENO schemes for nonlinear degenerate parabolic
              equations", SIAM J. Sci. Comput., 33 (2), 2011, pp. 939-965, <a href="http://dx.doi.org/10.1137/100791002">http://dx.doi.org/10.1137/100791002</a> </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">par</td><td>array to hold the computed parabolic term </td></tr>
    <tr><td class="paramname">u</td><td>solution </td></tr>
    <tr><td class="paramname">s</td><td>Solver object of type <a class="el" href="a00202.html" title="Structure containing all solver-specific variables and functions. ">HyPar</a> </td></tr>
    <tr><td class="paramname">m</td><td>MPI object of type <a class="el" href="a00205.html#a00663" title="Structure of MPI-related variables. ">MPIVariables</a> </td></tr>
    <tr><td class="paramname">t</td><td>Current simulation time </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="a00314_source.html#l00034">34</a> of file <a class="el" href="a00314_source.html">ParabolicFunctionCons1Stage.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;{</div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;  <a class="code" href="a00202.html">HyPar</a>         *solver = (<a class="code" href="a00202.html">HyPar</a>*)        s;</div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;  <a class="code" href="a00205.html#a00663">MPIVariables</a>  *mpi    = (<a class="code" href="a00205.html#a00663">MPIVariables</a>*) m;</div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;  <span class="keywordtype">double</span>        *FluxI  = solver-&gt;<a class="code" href="a00202.html#a983929b7b1511ff3e7800597adef6a91">fluxI</a>; <span class="comment">/* interface flux     array */</span></div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;  <span class="keywordtype">double</span>        *Func   = solver-&gt;<a class="code" href="a00202.html#aee7ff3b51db01ee6ed4038ff5311ed24">fluxC</a>; <span class="comment">/* diffusion function array */</span></div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;  <span class="keywordtype">int</span>           d, v, i, done;</div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;  <a class="code" href="a00231.html#a68f50121fb9a7daeaf60e50cdef82ef3">_DECLARE_IERR_</a>;</div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;</div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;  <span class="keywordtype">int</span>     ndims  = solver-&gt;<a class="code" href="a00202.html#a484873c74138512e41bc50d17b7d955a">ndims</a>;</div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;  <span class="keywordtype">int</span>     nvars  = solver-&gt;<a class="code" href="a00202.html#ae8f6d2fd6490d3153cb4133bf183a404">nvars</a>;</div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;  <span class="keywordtype">int</span>     ghosts = solver-&gt;<a class="code" href="a00202.html#aafc992b5fa79d5a4036024615d03bce6">ghosts</a>;</div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;  <span class="keywordtype">int</span>     *dim   = solver-&gt;<a class="code" href="a00202.html#a38e0371f331cecbe63a77fa03e202afe">dim_local</a>;</div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;  <span class="keywordtype">double</span>  *dxinv = solver-&gt;<a class="code" href="a00202.html#aa24a4f5e29bd70cbe5a2413be1ea9682">dxinv</a>;</div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;  <span class="keywordtype">int</span>     size   = solver-&gt;<a class="code" href="a00202.html#a20ee1fd00a220b98513127884a5558cf">npoints_local_wghosts</a>;</div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;</div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;  <span class="keywordtype">int</span> index[ndims], index1[ndims], index2[ndims], dim_interface[ndims];</div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;</div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;  <a class="code" href="a00229.html#a2b2826031c0cd92495ab351d3e599fc5">_ArraySetValue_</a>(par,size*nvars,0.0);</div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;  <span class="keywordflow">if</span> (!solver-&gt;<a class="code" href="a00202.html#ad8f03ca8c9fd6e1e235203495e8f2173">GFunction</a>) <span class="keywordflow">return</span>(0); <span class="comment">/* zero parabolic term */</span></div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;  solver-&gt;<a class="code" href="a00202.html#a6e3288a129bfd334448fbf3089338b69">count_par</a>++;</div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;</div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;  <span class="keywordtype">int</span> offset = 0;</div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;  <span class="keywordflow">for</span> (d = 0; d &lt; ndims; d++) {</div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;    <a class="code" href="a00229.html#a89e8330d9e06dd0666c50833628a125c">_ArrayCopy1D_</a>(dim,dim_interface,ndims); dim_interface[d]++;</div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;    <span class="keywordtype">int</span> size_cellcenter = 1; <span class="keywordflow">for</span> (i = 0; i &lt; ndims; i++) size_cellcenter *= (dim[i] + 2*ghosts);</div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;    <span class="keywordtype">int</span> size_interface = 1; <span class="keywordflow">for</span> (i = 0; i &lt; ndims; i++) size_interface *= dim_interface[i];</div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;</div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;    <span class="comment">/* evaluate cell-centered flux */</span></div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;    <a class="code" href="a00231.html#ad6ab74942c9de13cf0b4c12eb0d91780">IERR</a> solver-&gt;<a class="code" href="a00202.html#ad8f03ca8c9fd6e1e235203495e8f2173">GFunction</a>(Func,u,d,solver,t); <a class="code" href="a00231.html#add9cf96ae374934d245a1dc1ab697a42">CHECKERR</a>(ierr);</div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;    <span class="comment">/* compute interface fluxes */</span></div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;    <a class="code" href="a00231.html#ad6ab74942c9de13cf0b4c12eb0d91780">IERR</a> solver-&gt;<a class="code" href="a00202.html#a13a0f9420009a55a3689f407a2c8efea">InterpolateInterfacesPar</a>(FluxI,Func,d,solver,mpi); <a class="code" href="a00231.html#add9cf96ae374934d245a1dc1ab697a42">CHECKERR</a>(ierr);</div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;</div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;    <span class="comment">/* calculate the second derivative */</span></div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;    done = 0; <a class="code" href="a00229.html#a2b2826031c0cd92495ab351d3e599fc5">_ArraySetValue_</a>(index,ndims,0);</div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;    <span class="keywordtype">int</span> p, p1, p2;</div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;    <span class="keywordflow">while</span> (!done) {</div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;      <a class="code" href="a00229.html#a89e8330d9e06dd0666c50833628a125c">_ArrayCopy1D_</a>(index,index1,ndims);</div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;      <a class="code" href="a00229.html#a89e8330d9e06dd0666c50833628a125c">_ArrayCopy1D_</a>(index,index2,ndims); index2[d]++;</div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;      <a class="code" href="a00229.html#afbb862a2fdf5b72b1f9ace42f64b556f">_ArrayIndex1D_</a>(ndims,dim          ,index ,ghosts,p);</div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;      <a class="code" href="a00229.html#afbb862a2fdf5b72b1f9ace42f64b556f">_ArrayIndex1D_</a>(ndims,dim_interface,index1,0     ,p1);</div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;      <a class="code" href="a00229.html#afbb862a2fdf5b72b1f9ace42f64b556f">_ArrayIndex1D_</a>(ndims,dim_interface,index2,0     ,p2);</div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;      <span class="keywordflow">for</span> (v=0; v&lt;nvars; v++) </div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;        par[nvars*p+v] +=  ((dxinv[offset+ghosts+index[d]] * dxinv[offset+ghosts+index[d]]) </div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;                          * (FluxI[nvars*p2+v] - FluxI[nvars*p1+v]));</div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;      <a class="code" href="a00229.html#ac5ec1371623f11d03b0f42adaa24acbc">_ArrayIncrementIndex_</a>(ndims,dim,index,done);</div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;    }</div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;</div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;    offset += dim[d] + 2*ghosts;</div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;  }</div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;</div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;  <span class="keywordflow">if</span> (solver-&gt;<a class="code" href="a00202.html#ae83b1b0117b6a805ead2e4728945814c">flag_ib</a>) <a class="code" href="a00229.html#a4208c0f00455cf5113ce470bf641ecdd">_ArrayBlockMultiply_</a>(par,solver-&gt;<a class="code" href="a00202.html#a267ef7e03dbe9dd4440dee2fdf48619a">iblank</a>,size,nvars);</div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;  <span class="keywordflow">return</span>(0);</div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;}</div>
<div class="ttc" id="a00229_html_a2b2826031c0cd92495ab351d3e599fc5"><div class="ttname"><a href="a00229.html#a2b2826031c0cd92495ab351d3e599fc5">_ArraySetValue_</a></div><div class="ttdeci">#define _ArraySetValue_(x, size, value)</div><div class="ttdef"><b>Definition:</b> <a href="a00229_source.html#l00169">arrayfunctions.h:169</a></div></div>
<div class="ttc" id="a00229_html_afbb862a2fdf5b72b1f9ace42f64b556f"><div class="ttname"><a href="a00229.html#afbb862a2fdf5b72b1f9ace42f64b556f">_ArrayIndex1D_</a></div><div class="ttdeci">#define _ArrayIndex1D_(N, imax, i, ghost, index)</div><div class="ttdef"><b>Definition:</b> <a href="a00229_source.html#l00040">arrayfunctions.h:40</a></div></div>
<div class="ttc" id="a00202_html_aa24a4f5e29bd70cbe5a2413be1ea9682"><div class="ttname"><a href="a00202.html#aa24a4f5e29bd70cbe5a2413be1ea9682">HyPar::dxinv</a></div><div class="ttdeci">double * dxinv</div><div class="ttdef"><b>Definition:</b> <a href="a00238_source.html#l00110">hypar.h:110</a></div></div>
<div class="ttc" id="a00229_html_a4208c0f00455cf5113ce470bf641ecdd"><div class="ttname"><a href="a00229.html#a4208c0f00455cf5113ce470bf641ecdd">_ArrayBlockMultiply_</a></div><div class="ttdeci">#define _ArrayBlockMultiply_(x, a, n, bs)</div><div class="ttdef"><b>Definition:</b> <a href="a00229_source.html#l00388">arrayfunctions.h:388</a></div></div>
<div class="ttc" id="a00229_html_a89e8330d9e06dd0666c50833628a125c"><div class="ttname"><a href="a00229.html#a89e8330d9e06dd0666c50833628a125c">_ArrayCopy1D_</a></div><div class="ttdeci">#define _ArrayCopy1D_(x, y, size)</div><div class="ttdef"><b>Definition:</b> <a href="a00229_source.html#l00319">arrayfunctions.h:319</a></div></div>
<div class="ttc" id="a00231_html_a68f50121fb9a7daeaf60e50cdef82ef3"><div class="ttname"><a href="a00231.html#a68f50121fb9a7daeaf60e50cdef82ef3">_DECLARE_IERR_</a></div><div class="ttdeci">#define _DECLARE_IERR_</div><div class="ttdef"><b>Definition:</b> <a href="a00231_source.html#l00017">basic.h:17</a></div></div>
<div class="ttc" id="a00202_html_a484873c74138512e41bc50d17b7d955a"><div class="ttname"><a href="a00202.html#a484873c74138512e41bc50d17b7d955a">HyPar::ndims</a></div><div class="ttdeci">int ndims</div><div class="ttdef"><b>Definition:</b> <a href="a00238_source.html#l00026">hypar.h:26</a></div></div>
<div class="ttc" id="a00231_html_ad6ab74942c9de13cf0b4c12eb0d91780"><div class="ttname"><a href="a00231.html#ad6ab74942c9de13cf0b4c12eb0d91780">IERR</a></div><div class="ttdeci">#define IERR</div><div class="ttdef"><b>Definition:</b> <a href="a00231_source.html#l00016">basic.h:16</a></div></div>
<div class="ttc" id="a00202_html_ad8f03ca8c9fd6e1e235203495e8f2173"><div class="ttname"><a href="a00202.html#ad8f03ca8c9fd6e1e235203495e8f2173">HyPar::GFunction</a></div><div class="ttdeci">int(* GFunction)(double *, double *, int, void *, double)</div><div class="ttdef"><b>Definition:</b> <a href="a00238_source.html#l00305">hypar.h:305</a></div></div>
<div class="ttc" id="a00202_html_a38e0371f331cecbe63a77fa03e202afe"><div class="ttname"><a href="a00202.html#a38e0371f331cecbe63a77fa03e202afe">HyPar::dim_local</a></div><div class="ttdeci">int * dim_local</div><div class="ttdef"><b>Definition:</b> <a href="a00238_source.html#l00037">hypar.h:37</a></div></div>
<div class="ttc" id="a00202_html_aafc992b5fa79d5a4036024615d03bce6"><div class="ttname"><a href="a00202.html#aafc992b5fa79d5a4036024615d03bce6">HyPar::ghosts</a></div><div class="ttdeci">int ghosts</div><div class="ttdef"><b>Definition:</b> <a href="a00238_source.html#l00052">hypar.h:52</a></div></div>
<div class="ttc" id="a00202_html_a20ee1fd00a220b98513127884a5558cf"><div class="ttname"><a href="a00202.html#a20ee1fd00a220b98513127884a5558cf">HyPar::npoints_local_wghosts</a></div><div class="ttdeci">int npoints_local_wghosts</div><div class="ttdef"><b>Definition:</b> <a href="a00238_source.html#l00042">hypar.h:42</a></div></div>
<div class="ttc" id="a00231_html_add9cf96ae374934d245a1dc1ab697a42"><div class="ttname"><a href="a00231.html#add9cf96ae374934d245a1dc1ab697a42">CHECKERR</a></div><div class="ttdeci">#define CHECKERR(ierr)</div><div class="ttdef"><b>Definition:</b> <a href="a00231_source.html#l00018">basic.h:18</a></div></div>
<div class="ttc" id="a00202_html_ae8f6d2fd6490d3153cb4133bf183a404"><div class="ttname"><a href="a00202.html#ae8f6d2fd6490d3153cb4133bf183a404">HyPar::nvars</a></div><div class="ttdeci">int nvars</div><div class="ttdef"><b>Definition:</b> <a href="a00238_source.html#l00029">hypar.h:29</a></div></div>
<div class="ttc" id="a00205_html_a00663"><div class="ttname"><a href="a00205.html#a00663">MPIVariables</a></div><div class="ttdoc">Structure of MPI-related variables. </div><div class="ttdef"><b>Definition:</b> <a href="a00205_source.html#l00024">mpivars_struct.h:24</a></div></div>
<div class="ttc" id="a00202_html_a6e3288a129bfd334448fbf3089338b69"><div class="ttname"><a href="a00202.html#a6e3288a129bfd334448fbf3089338b69">HyPar::count_par</a></div><div class="ttdeci">int count_par</div><div class="ttdef"><b>Definition:</b> <a href="a00238_source.html#l00413">hypar.h:413</a></div></div>
<div class="ttc" id="a00202_html_a983929b7b1511ff3e7800597adef6a91"><div class="ttname"><a href="a00202.html#a983929b7b1511ff3e7800597adef6a91">HyPar::fluxI</a></div><div class="ttdeci">double * fluxI</div><div class="ttdef"><b>Definition:</b> <a href="a00238_source.html#l00136">hypar.h:136</a></div></div>
<div class="ttc" id="a00202_html_aee7ff3b51db01ee6ed4038ff5311ed24"><div class="ttname"><a href="a00202.html#aee7ff3b51db01ee6ed4038ff5311ed24">HyPar::fluxC</a></div><div class="ttdeci">double * fluxC</div><div class="ttdef"><b>Definition:</b> <a href="a00238_source.html#l00128">hypar.h:128</a></div></div>
<div class="ttc" id="a00202_html_a13a0f9420009a55a3689f407a2c8efea"><div class="ttname"><a href="a00202.html#a13a0f9420009a55a3689f407a2c8efea">HyPar::InterpolateInterfacesPar</a></div><div class="ttdeci">int(* InterpolateInterfacesPar)(double *, double *, int, void *, void *)</div><div class="ttdef"><b>Definition:</b> <a href="a00238_source.html#l00234">hypar.h:234</a></div></div>
<div class="ttc" id="a00229_html_ac5ec1371623f11d03b0f42adaa24acbc"><div class="ttname"><a href="a00229.html#ac5ec1371623f11d03b0f42adaa24acbc">_ArrayIncrementIndex_</a></div><div class="ttdeci">#define _ArrayIncrementIndex_(N, imax, i, done)</div><div class="ttdef"><b>Definition:</b> <a href="a00229_source.html#l00126">arrayfunctions.h:126</a></div></div>
<div class="ttc" id="a00202_html_ae83b1b0117b6a805ead2e4728945814c"><div class="ttname"><a href="a00202.html#ae83b1b0117b6a805ead2e4728945814c">HyPar::flag_ib</a></div><div class="ttdeci">int flag_ib</div><div class="ttdef"><b>Definition:</b> <a href="a00238_source.html#l00436">hypar.h:436</a></div></div>
<div class="ttc" id="a00202_html_a267ef7e03dbe9dd4440dee2fdf48619a"><div class="ttname"><a href="a00202.html#a267ef7e03dbe9dd4440dee2fdf48619a">HyPar::iblank</a></div><div class="ttdeci">double * iblank</div><div class="ttdef"><b>Definition:</b> <a href="a00238_source.html#l00431">hypar.h:431</a></div></div>
<div class="ttc" id="a00202_html"><div class="ttname"><a href="a00202.html">HyPar</a></div><div class="ttdoc">Structure containing all solver-specific variables and functions. </div><div class="ttdef"><b>Definition:</b> <a href="a00238_source.html#l00023">hypar.h:23</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a6f2b6bacb5d50cb9fce6e3e00d55cc6d"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int SourceFunction </td>
          <td>(</td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>source</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>u</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>s</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>m</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>t</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Evaluate the source term \({\bf S}\left({\bf u}\right)\) in the governing equation, if the physical model specifies one. In addition, if the simulation requires a sponge boundary treatment, the sponge BC function is called. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">source</td><td>the computed source term </td></tr>
    <tr><td class="paramname">u</td><td>solution </td></tr>
    <tr><td class="paramname">s</td><td>solver object of type <a class="el" href="a00202.html" title="Structure containing all solver-specific variables and functions. ">HyPar</a> </td></tr>
    <tr><td class="paramname">m</td><td>MPI object of type <a class="el" href="a00205.html#a00663" title="Structure of MPI-related variables. ">MPIVariables</a> </td></tr>
    <tr><td class="paramname">t</td><td>Current simulation time </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="a00319_source.html#l00022">22</a> of file <a class="el" href="a00319_source.html">SourceFunction.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;{</div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;  <a class="code" href="a00202.html">HyPar</a>           *solver   = (<a class="code" href="a00202.html">HyPar</a>*)        s;</div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;  <a class="code" href="a00205.html#a00663">MPIVariables</a>    *mpi      = (<a class="code" href="a00205.html#a00663">MPIVariables</a>*) m;</div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;</div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;  <span class="comment">/* initialize to zero */</span></div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;  <span class="keywordtype">int</span> size = solver-&gt;<a class="code" href="a00202.html#a3a6d36520a0a04118dafe25c0f5e70b1">ndof_cells_wghosts</a>;</div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;<span class="preprocessor">#if defined(HAVE_CUDA)</span></div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;<span class="preprocessor"></span>  <span class="keywordflow">if</span> (solver-&gt;<a class="code" href="a00202.html#ae4ab67b8e83747d09dc53c42e218eb4e">use_gpu</a>) {</div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;    <a class="code" href="a00230.html#a87d57be18f4bf913a4d3e8bb9536c0f4">gpuArraySetValue</a>(source,size, 0.0);</div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;  } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;<span class="preprocessor"></span>    <a class="code" href="a00229.html#a2b2826031c0cd92495ab351d3e599fc5">_ArraySetValue_</a>(source,size,0.0);</div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;<span class="preprocessor">#if defined(HAVE_CUDA)</span></div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;<span class="preprocessor"></span>  }</div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;<span class="preprocessor"></span></div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;  <span class="comment">/* call the source function of the physics model, if available */</span></div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;  <span class="keywordflow">if</span> (solver-&gt;<a class="code" href="a00202.html#a1685cd0c6b8c413bdbbe86d8f4475c58">SFunction</a>) {</div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;    solver-&gt;<a class="code" href="a00202.html#a1685cd0c6b8c413bdbbe86d8f4475c58">SFunction</a>(source,u,solver,mpi,t);</div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;    solver-&gt;<a class="code" href="a00202.html#a0522fdf88d4668950f74422ec1e57a9b">count_sou</a>++;</div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;  }</div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;</div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;  <span class="comment">/* Apart from other source terms, implement sponge BC as a source */</span></div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;  <a class="code" href="a00193.html">DomainBoundary</a>* boundary = (<a class="code" href="a00193.html">DomainBoundary</a>*) solver-&gt;<a class="code" href="a00202.html#a6b5109ac1048aa203b8969b91e72c3af">boundary</a>;</div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;  <span class="keywordtype">int</span> n;</div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;  <span class="keywordtype">int</span> nb = solver-&gt;<a class="code" href="a00202.html#a3f9a55664d1c8f058828ae9f4de11906">nBoundaryZones</a>;</div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;#<span class="keywordflow">if</span> defined(HAVE_CUDA)</div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;  <span class="keywordflow">if</span> (solver-&gt;<a class="code" href="a00202.html#ae4ab67b8e83747d09dc53c42e218eb4e">use_gpu</a>) {</div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;    <span class="keywordflow">for</span> (n = 0; n &lt; nb; n++) {</div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;      <span class="keywordflow">if</span> (!strcmp(boundary[n].bctype,<a class="code" href="a00233.html#ab02c004c9707df0589311375014dc666">_SPONGE_</a>)) {</div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;        fprintf(stderr,<span class="stringliteral">&quot;ERROR: Sponge BC not yet implemented on GPU.\n&quot;</span>);</div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;      }</div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;    }</div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;  } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;<span class="preprocessor"></span>    <span class="keywordflow">for</span> (n = 0; n &lt; nb; n++) {</div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;      <span class="keywordflow">if</span> (!strcmp(boundary[n].bctype,<a class="code" href="a00233.html#ab02c004c9707df0589311375014dc666">_SPONGE_</a>)) {</div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;        <a class="code" href="a00233.html#a49368bf44f300143cd9ec18d10b37a23">BCSpongeSource</a>( &amp;boundary[n],</div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;                        solver-&gt;<a class="code" href="a00202.html#a484873c74138512e41bc50d17b7d955a">ndims</a>,</div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;                        solver-&gt;<a class="code" href="a00202.html#ae8f6d2fd6490d3153cb4133bf183a404">nvars</a>,</div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;                        solver-&gt;<a class="code" href="a00202.html#aafc992b5fa79d5a4036024615d03bce6">ghosts</a>,</div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;                        solver-&gt;<a class="code" href="a00202.html#a38e0371f331cecbe63a77fa03e202afe">dim_local</a>,</div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;                        solver-&gt;<a class="code" href="a00202.html#a711aad4cbe735871dd9e91ab575c878b">x</a>,</div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;                        u,</div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;                        source  ); </div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;      }</div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;    }</div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;<span class="preprocessor">#if defined(HAVE_CUDA)</span></div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;<span class="preprocessor"></span>  }</div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;<span class="preprocessor"></span></div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;</div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;  <span class="keywordflow">return</span>(0);</div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;}</div>
<div class="ttc" id="a00229_html_a2b2826031c0cd92495ab351d3e599fc5"><div class="ttname"><a href="a00229.html#a2b2826031c0cd92495ab351d3e599fc5">_ArraySetValue_</a></div><div class="ttdeci">#define _ArraySetValue_(x, size, value)</div><div class="ttdef"><b>Definition:</b> <a href="a00229_source.html#l00169">arrayfunctions.h:169</a></div></div>
<div class="ttc" id="a00202_html_a3a6d36520a0a04118dafe25c0f5e70b1"><div class="ttname"><a href="a00202.html#a3a6d36520a0a04118dafe25c0f5e70b1">HyPar::ndof_cells_wghosts</a></div><div class="ttdeci">int ndof_cells_wghosts</div><div class="ttdef"><b>Definition:</b> <a href="a00238_source.html#l00047">hypar.h:47</a></div></div>
<div class="ttc" id="a00193_html"><div class="ttname"><a href="a00193.html">DomainBoundary</a></div><div class="ttdoc">Structure containing the variables and function pointers defining a boundary. </div><div class="ttdef"><b>Definition:</b> <a href="a00233_source.html#l00068">boundaryconditions.h:68</a></div></div>
<div class="ttc" id="a00230_html_a87d57be18f4bf913a4d3e8bb9536c0f4"><div class="ttname"><a href="a00230.html#a87d57be18f4bf913a4d3e8bb9536c0f4">gpuArraySetValue</a></div><div class="ttdeci">void gpuArraySetValue(double *, int, double)</div><div class="ttdef"><b>Definition:</b> <a href="a00270_source.html#l00161">ArrayImplementations_GPU.cu:161</a></div></div>
<div class="ttc" id="a00202_html_ae4ab67b8e83747d09dc53c42e218eb4e"><div class="ttname"><a href="a00202.html#ae4ab67b8e83747d09dc53c42e218eb4e">HyPar::use_gpu</a></div><div class="ttdeci">int use_gpu</div><div class="ttdef"><b>Definition:</b> <a href="a00238_source.html#l00444">hypar.h:444</a></div></div>
<div class="ttc" id="a00202_html_a711aad4cbe735871dd9e91ab575c878b"><div class="ttname"><a href="a00202.html#a711aad4cbe735871dd9e91ab575c878b">HyPar::x</a></div><div class="ttdeci">double * x</div><div class="ttdef"><b>Definition:</b> <a href="a00238_source.html#l00107">hypar.h:107</a></div></div>
<div class="ttc" id="a00233_html_a49368bf44f300143cd9ec18d10b37a23"><div class="ttname"><a href="a00233.html#a49368bf44f300143cd9ec18d10b37a23">BCSpongeSource</a></div><div class="ttdeci">int BCSpongeSource(void *, int, int, int, int *, double *, double *, double *)</div><div class="ttdef"><b>Definition:</b> <a href="a00286_source.html#l00026">BCSponge.c:26</a></div></div>
<div class="ttc" id="a00202_html_a484873c74138512e41bc50d17b7d955a"><div class="ttname"><a href="a00202.html#a484873c74138512e41bc50d17b7d955a">HyPar::ndims</a></div><div class="ttdeci">int ndims</div><div class="ttdef"><b>Definition:</b> <a href="a00238_source.html#l00026">hypar.h:26</a></div></div>
<div class="ttc" id="a00202_html_a38e0371f331cecbe63a77fa03e202afe"><div class="ttname"><a href="a00202.html#a38e0371f331cecbe63a77fa03e202afe">HyPar::dim_local</a></div><div class="ttdeci">int * dim_local</div><div class="ttdef"><b>Definition:</b> <a href="a00238_source.html#l00037">hypar.h:37</a></div></div>
<div class="ttc" id="a00202_html_a3f9a55664d1c8f058828ae9f4de11906"><div class="ttname"><a href="a00202.html#a3f9a55664d1c8f058828ae9f4de11906">HyPar::nBoundaryZones</a></div><div class="ttdeci">int nBoundaryZones</div><div class="ttdef"><b>Definition:</b> <a href="a00238_source.html#l00157">hypar.h:157</a></div></div>
<div class="ttc" id="a00202_html_aafc992b5fa79d5a4036024615d03bce6"><div class="ttname"><a href="a00202.html#aafc992b5fa79d5a4036024615d03bce6">HyPar::ghosts</a></div><div class="ttdeci">int ghosts</div><div class="ttdef"><b>Definition:</b> <a href="a00238_source.html#l00052">hypar.h:52</a></div></div>
<div class="ttc" id="a00202_html_ae8f6d2fd6490d3153cb4133bf183a404"><div class="ttname"><a href="a00202.html#ae8f6d2fd6490d3153cb4133bf183a404">HyPar::nvars</a></div><div class="ttdeci">int nvars</div><div class="ttdef"><b>Definition:</b> <a href="a00238_source.html#l00029">hypar.h:29</a></div></div>
<div class="ttc" id="a00205_html_a00663"><div class="ttname"><a href="a00205.html#a00663">MPIVariables</a></div><div class="ttdoc">Structure of MPI-related variables. </div><div class="ttdef"><b>Definition:</b> <a href="a00205_source.html#l00024">mpivars_struct.h:24</a></div></div>
<div class="ttc" id="a00233_html_ab02c004c9707df0589311375014dc666"><div class="ttname"><a href="a00233.html#ab02c004c9707df0589311375014dc666">_SPONGE_</a></div><div class="ttdeci">#define _SPONGE_</div><div class="ttdef"><b>Definition:</b> <a href="a00233_source.html#l00020">boundaryconditions.h:20</a></div></div>
<div class="ttc" id="a00202_html_a1685cd0c6b8c413bdbbe86d8f4475c58"><div class="ttname"><a href="a00202.html#a1685cd0c6b8c413bdbbe86d8f4475c58">HyPar::SFunction</a></div><div class="ttdeci">int(* SFunction)(double *, double *, void *, void *, double)</div><div class="ttdef"><b>Definition:</b> <a href="a00238_source.html#l00312">hypar.h:312</a></div></div>
<div class="ttc" id="a00202_html_a6b5109ac1048aa203b8969b91e72c3af"><div class="ttname"><a href="a00202.html#a6b5109ac1048aa203b8969b91e72c3af">HyPar::boundary</a></div><div class="ttdeci">void * boundary</div><div class="ttdef"><b>Definition:</b> <a href="a00238_source.html#l00159">hypar.h:159</a></div></div>
<div class="ttc" id="a00202_html"><div class="ttname"><a href="a00202.html">HyPar</a></div><div class="ttdoc">Structure containing all solver-specific variables and functions. </div><div class="ttdef"><b>Definition:</b> <a href="a00238_source.html#l00023">hypar.h:23</a></div></div>
<div class="ttc" id="a00202_html_a0522fdf88d4668950f74422ec1e57a9b"><div class="ttname"><a href="a00202.html#a0522fdf88d4668950f74422ec1e57a9b">HyPar::count_sou</a></div><div class="ttdeci">int count_sou</div><div class="ttdef"><b>Definition:</b> <a href="a00238_source.html#l00413">hypar.h:413</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a1f30168f72fce94d12bd0cc8d9322494"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int VolumeIntegral </td>
          <td>(</td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>VolumeIntegral</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>u</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>s</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>m</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Compute the volume integral of the solution. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">VolumeIntegral</td><td>The computed volume integral </td></tr>
    <tr><td class="paramname">u</td><td>Solution </td></tr>
    <tr><td class="paramname">s</td><td>Solver object of type <a class="el" href="a00202.html" title="Structure containing all solver-specific variables and functions. ">HyPar</a> </td></tr>
    <tr><td class="paramname">m</td><td>MPI object of type <a class="el" href="a00205.html#a00663" title="Structure of MPI-related variables. ">MPIVariables</a> </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="a00320_source.html#l00014">14</a> of file <a class="el" href="a00320_source.html">VolumeIntegral.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;{</div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;  <a class="code" href="a00202.html">HyPar</a>         *solver = (<a class="code" href="a00202.html">HyPar</a>*)        s;</div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;  <a class="code" href="a00205.html#a00663">MPIVariables</a>  *mpi    = (<a class="code" href="a00205.html#a00663">MPIVariables</a>*) m;</div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;</div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;  <span class="keywordtype">int</span> ndims   = solver-&gt;<a class="code" href="a00202.html#a484873c74138512e41bc50d17b7d955a">ndims</a>;</div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;  <span class="keywordtype">int</span> nvars   = solver-&gt;<a class="code" href="a00202.html#ae8f6d2fd6490d3153cb4133bf183a404">nvars</a>;</div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;  <span class="keywordtype">int</span> *dim    = solver-&gt;<a class="code" href="a00202.html#a38e0371f331cecbe63a77fa03e202afe">dim_local</a>;</div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;  <span class="keywordtype">int</span> ghosts  = solver-&gt;<a class="code" href="a00202.html#aafc992b5fa79d5a4036024615d03bce6">ghosts</a>;</div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;  <span class="keywordtype">int</span> d,v;</div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;</div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;  <span class="comment">/* calculate local volume integral of the solution */</span></div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;  <span class="keywordtype">int</span> index[ndims], done = 0;</div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;  <span class="keywordtype">double</span> *local_integral = (<span class="keywordtype">double</span>*) calloc (nvars,<span class="keyword">sizeof</span>(<span class="keywordtype">double</span>));</div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;  <a class="code" href="a00229.html#a2b2826031c0cd92495ab351d3e599fc5">_ArraySetValue_</a>(local_integral,nvars,0.0);</div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;  <a class="code" href="a00229.html#a2b2826031c0cd92495ab351d3e599fc5">_ArraySetValue_</a>(index,ndims,0);</div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;  <span class="keywordflow">while</span> (!done) {</div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;    <span class="keywordtype">int</span> p; <a class="code" href="a00229.html#afbb862a2fdf5b72b1f9ace42f64b556f">_ArrayIndex1D_</a>(ndims,dim,index,ghosts,p);</div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;    <span class="keywordtype">double</span> dxinv[ndims];</div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;    <span class="keywordflow">for</span> (d=0; d&lt;ndims; d++) { <a class="code" href="a00231.html#a9aa9bad8531d6733731a850ccc471a42">_GetCoordinate_</a>(d,index[d],dim,ghosts,solver-&gt;<a class="code" href="a00202.html#aa24a4f5e29bd70cbe5a2413be1ea9682">dxinv</a>,dxinv[d]); }</div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;    <span class="keywordtype">double</span> dV = 1.0; <span class="keywordflow">for</span> (d=0; d&lt;ndims; d++) dV *= (1.0/dxinv[d]);</div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;    <span class="keywordflow">for</span> (v=0; v&lt;nvars; v++) local_integral[v] += (u[p*nvars+v]*dV);</div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;    <a class="code" href="a00229.html#ac5ec1371623f11d03b0f42adaa24acbc">_ArrayIncrementIndex_</a>(ndims,dim,index,done);</div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;  }</div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;  <span class="comment">/* sum over all processors to get global integral of the solution */</span></div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;  <a class="code" href="a00231.html#ad6ab74942c9de13cf0b4c12eb0d91780">IERR</a> <a class="code" href="a00248.html#abd61f932b070ee84262d9d98b6dd854f">MPISum_double</a>(<a class="code" href="a00320.html#a74a4527b7a6060acc1808d9c945b117f">VolumeIntegral</a>,local_integral,nvars,&amp;mpi-&gt;<a class="code" href="a00205.html#adad7a6f85831f3ac84d854b6c80aef43">world</a>); <a class="code" href="a00231.html#add9cf96ae374934d245a1dc1ab697a42">CHECKERR</a>(ierr);</div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;  free(local_integral);</div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;</div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;  <span class="keywordflow">return</span>(0);</div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;}</div>
<div class="ttc" id="a00229_html_a2b2826031c0cd92495ab351d3e599fc5"><div class="ttname"><a href="a00229.html#a2b2826031c0cd92495ab351d3e599fc5">_ArraySetValue_</a></div><div class="ttdeci">#define _ArraySetValue_(x, size, value)</div><div class="ttdef"><b>Definition:</b> <a href="a00229_source.html#l00169">arrayfunctions.h:169</a></div></div>
<div class="ttc" id="a00229_html_afbb862a2fdf5b72b1f9ace42f64b556f"><div class="ttname"><a href="a00229.html#afbb862a2fdf5b72b1f9ace42f64b556f">_ArrayIndex1D_</a></div><div class="ttdeci">#define _ArrayIndex1D_(N, imax, i, ghost, index)</div><div class="ttdef"><b>Definition:</b> <a href="a00229_source.html#l00040">arrayfunctions.h:40</a></div></div>
<div class="ttc" id="a00202_html_aa24a4f5e29bd70cbe5a2413be1ea9682"><div class="ttname"><a href="a00202.html#aa24a4f5e29bd70cbe5a2413be1ea9682">HyPar::dxinv</a></div><div class="ttdeci">double * dxinv</div><div class="ttdef"><b>Definition:</b> <a href="a00238_source.html#l00110">hypar.h:110</a></div></div>
<div class="ttc" id="a00202_html_a484873c74138512e41bc50d17b7d955a"><div class="ttname"><a href="a00202.html#a484873c74138512e41bc50d17b7d955a">HyPar::ndims</a></div><div class="ttdeci">int ndims</div><div class="ttdef"><b>Definition:</b> <a href="a00238_source.html#l00026">hypar.h:26</a></div></div>
<div class="ttc" id="a00231_html_ad6ab74942c9de13cf0b4c12eb0d91780"><div class="ttname"><a href="a00231.html#ad6ab74942c9de13cf0b4c12eb0d91780">IERR</a></div><div class="ttdeci">#define IERR</div><div class="ttdef"><b>Definition:</b> <a href="a00231_source.html#l00016">basic.h:16</a></div></div>
<div class="ttc" id="a00202_html_a38e0371f331cecbe63a77fa03e202afe"><div class="ttname"><a href="a00202.html#a38e0371f331cecbe63a77fa03e202afe">HyPar::dim_local</a></div><div class="ttdeci">int * dim_local</div><div class="ttdef"><b>Definition:</b> <a href="a00238_source.html#l00037">hypar.h:37</a></div></div>
<div class="ttc" id="a00202_html_aafc992b5fa79d5a4036024615d03bce6"><div class="ttname"><a href="a00202.html#aafc992b5fa79d5a4036024615d03bce6">HyPar::ghosts</a></div><div class="ttdeci">int ghosts</div><div class="ttdef"><b>Definition:</b> <a href="a00238_source.html#l00052">hypar.h:52</a></div></div>
<div class="ttc" id="a00231_html_add9cf96ae374934d245a1dc1ab697a42"><div class="ttname"><a href="a00231.html#add9cf96ae374934d245a1dc1ab697a42">CHECKERR</a></div><div class="ttdeci">#define CHECKERR(ierr)</div><div class="ttdef"><b>Definition:</b> <a href="a00231_source.html#l00018">basic.h:18</a></div></div>
<div class="ttc" id="a00231_html_a9aa9bad8531d6733731a850ccc471a42"><div class="ttname"><a href="a00231.html#a9aa9bad8531d6733731a850ccc471a42">_GetCoordinate_</a></div><div class="ttdeci">#define _GetCoordinate_(dir, i, dim, ghosts, x, coord)</div><div class="ttdef"><b>Definition:</b> <a href="a00231_source.html#l00031">basic.h:31</a></div></div>
<div class="ttc" id="a00202_html_ae8f6d2fd6490d3153cb4133bf183a404"><div class="ttname"><a href="a00202.html#ae8f6d2fd6490d3153cb4133bf183a404">HyPar::nvars</a></div><div class="ttdeci">int nvars</div><div class="ttdef"><b>Definition:</b> <a href="a00238_source.html#l00029">hypar.h:29</a></div></div>
<div class="ttc" id="a00205_html_a00663"><div class="ttname"><a href="a00205.html#a00663">MPIVariables</a></div><div class="ttdoc">Structure of MPI-related variables. </div><div class="ttdef"><b>Definition:</b> <a href="a00205_source.html#l00024">mpivars_struct.h:24</a></div></div>
<div class="ttc" id="a00320_html_a74a4527b7a6060acc1808d9c945b117f"><div class="ttname"><a href="a00320.html#a74a4527b7a6060acc1808d9c945b117f">VolumeIntegral</a></div><div class="ttdeci">int VolumeIntegral(double *VolumeIntegral, double *u, void *s, void *m)</div><div class="ttdef"><b>Definition:</b> <a href="a00320_source.html#l00014">VolumeIntegral.c:14</a></div></div>
<div class="ttc" id="a00229_html_ac5ec1371623f11d03b0f42adaa24acbc"><div class="ttname"><a href="a00229.html#ac5ec1371623f11d03b0f42adaa24acbc">_ArrayIncrementIndex_</a></div><div class="ttdeci">#define _ArrayIncrementIndex_(N, imax, i, done)</div><div class="ttdef"><b>Definition:</b> <a href="a00229_source.html#l00126">arrayfunctions.h:126</a></div></div>
<div class="ttc" id="a00248_html_abd61f932b070ee84262d9d98b6dd854f"><div class="ttname"><a href="a00248.html#abd61f932b070ee84262d9d98b6dd854f">MPISum_double</a></div><div class="ttdeci">int MPISum_double(double *, double *, int, void *)</div><div class="ttdef"><b>Definition:</b> <a href="a00398_source.html#l00039">MPISum.c:39</a></div></div>
<div class="ttc" id="a00205_html_adad7a6f85831f3ac84d854b6c80aef43"><div class="ttname"><a href="a00205.html#adad7a6f85831f3ac84d854b6c80aef43">MPIVariables::world</a></div><div class="ttdeci">MPI_Comm world</div><div class="ttdef"><b>Definition:</b> <a href="a00205_source.html#l00037">mpivars_struct.h:37</a></div></div>
<div class="ttc" id="a00202_html"><div class="ttname"><a href="a00202.html">HyPar</a></div><div class="ttdoc">Structure containing all solver-specific variables and functions. </div><div class="ttdef"><b>Definition:</b> <a href="a00238_source.html#l00023">hypar.h:23</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a9c9813ef18605823a1c4da67e43e76c3"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int BoundaryIntegral </td>
          <td>(</td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>s</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>m</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Computes the flux integral over the boundary. The local flux integral (on this processor) is computed for physical as well as MPI boundaries. The global boundary integral is computed by summing the local integrals over all the processors, since the contributions from the MPI boundaries cancel out. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">s</td><td>Solver object of type <a class="el" href="a00202.html" title="Structure containing all solver-specific variables and functions. ">HyPar</a> </td></tr>
    <tr><td class="paramname">m</td><td>MPI object of type <a class="el" href="a00205.html#a00663" title="Structure of MPI-related variables. ">MPIVariables</a> </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="a00304_source.html#l00017">17</a> of file <a class="el" href="a00304_source.html">BoundaryIntegral.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;{</div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;  <a class="code" href="a00202.html">HyPar</a>         *solver = (<a class="code" href="a00202.html">HyPar</a>*)        s;</div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;  <a class="code" href="a00205.html#a00663">MPIVariables</a>  *mpi    = (<a class="code" href="a00205.html#a00663">MPIVariables</a>*) m;</div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;</div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;  <span class="keywordtype">int</span> ndims   = solver-&gt;<a class="code" href="a00202.html#a484873c74138512e41bc50d17b7d955a">ndims</a>;</div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;  <span class="keywordtype">int</span> nvars   = solver-&gt;<a class="code" href="a00202.html#ae8f6d2fd6490d3153cb4133bf183a404">nvars</a>;</div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;  <span class="keywordtype">int</span> *dim    = solver-&gt;<a class="code" href="a00202.html#a38e0371f331cecbe63a77fa03e202afe">dim_local</a>;</div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;  <span class="keywordtype">int</span> ghosts  = solver-&gt;<a class="code" href="a00202.html#aafc992b5fa79d5a4036024615d03bce6">ghosts</a>;</div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;  <span class="keywordtype">int</span> d,v,k;</div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;</div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;  <span class="keywordtype">double</span> *local_integral  = (<span class="keywordtype">double</span>*) calloc (nvars,<span class="keyword">sizeof</span>(<span class="keywordtype">double</span>));</div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;  <span class="keywordtype">double</span> *global_integral = (<span class="keywordtype">double</span>*) calloc (nvars,<span class="keyword">sizeof</span>(<span class="keywordtype">double</span>));</div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;</div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;  <span class="comment">/* calculate the local boundary integral on each process */</span></div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;  <a class="code" href="a00229.html#a2b2826031c0cd92495ab351d3e599fc5">_ArraySetValue_</a>(local_integral,nvars,0.0);</div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;  <span class="keywordflow">for</span> (d=0; d&lt;ndims; d++) {</div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;    <span class="keywordflow">for</span> (v=0; v&lt;nvars; v++) {</div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;      <span class="keywordtype">double</span> dxinv[ndims], dS = 1.0; </div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;      <span class="keywordflow">for</span> (k=0; k&lt;ndims; k++) { </div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;        <span class="comment">/* uniform grid assumed */</span></div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;        <a class="code" href="a00231.html#a9aa9bad8531d6733731a850ccc471a42">_GetCoordinate_</a>(k,dim[k]/2,dim,ghosts,solver-&gt;<a class="code" href="a00202.html#aa24a4f5e29bd70cbe5a2413be1ea9682">dxinv</a>,dxinv[k]); </div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;      }</div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;      <span class="keywordflow">for</span> (k=0; k&lt;ndims; k++) <span class="keywordflow">if</span> (k!=d) dS *= (1.0/dxinv[k]);</div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;      local_integral[v] += (solver-&gt;<a class="code" href="a00202.html#a6dfeed442d18083b68fd0f28d5f63fa7">StepBoundaryIntegral</a>[(2*d+0)*nvars+v])*dS;</div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;      local_integral[v] += (solver-&gt;<a class="code" href="a00202.html#a6dfeed442d18083b68fd0f28d5f63fa7">StepBoundaryIntegral</a>[(2*d+1)*nvars+v])*dS;</div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;    }</div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;  }</div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;</div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;  <span class="comment">/* add across process to calculate global boundary integral </span></div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;<span class="comment">   * (internal (MPI) boundaries must cancel out)</span></div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;<span class="comment">   */</span></div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;  <a class="code" href="a00231.html#ad6ab74942c9de13cf0b4c12eb0d91780">IERR</a> <a class="code" href="a00248.html#abd61f932b070ee84262d9d98b6dd854f">MPISum_double</a>(global_integral,local_integral,nvars,&amp;mpi-&gt;<a class="code" href="a00205.html#adad7a6f85831f3ac84d854b6c80aef43">world</a>); <a class="code" href="a00231.html#add9cf96ae374934d245a1dc1ab697a42">CHECKERR</a>(ierr);</div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;</div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;  <span class="comment">/* add to the total boundary integral */</span></div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;  <a class="code" href="a00229.html#a4cd66304bc41a7751842230af3063b62">_ArrayAXPY_</a>(global_integral,1.0,solver-&gt;<a class="code" href="a00202.html#a644ed0ed36ed4af1c396c0af6aca043d">TotalBoundaryIntegral</a>,nvars);</div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;</div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;  free(local_integral);</div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;  free(global_integral);</div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;  <span class="keywordflow">return</span>(0);</div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;}</div>
<div class="ttc" id="a00202_html_a644ed0ed36ed4af1c396c0af6aca043d"><div class="ttname"><a href="a00202.html#a644ed0ed36ed4af1c396c0af6aca043d">HyPar::TotalBoundaryIntegral</a></div><div class="ttdeci">double * TotalBoundaryIntegral</div><div class="ttdef"><b>Definition:</b> <a href="a00238_source.html#l00381">hypar.h:381</a></div></div>
<div class="ttc" id="a00229_html_a2b2826031c0cd92495ab351d3e599fc5"><div class="ttname"><a href="a00229.html#a2b2826031c0cd92495ab351d3e599fc5">_ArraySetValue_</a></div><div class="ttdeci">#define _ArraySetValue_(x, size, value)</div><div class="ttdef"><b>Definition:</b> <a href="a00229_source.html#l00169">arrayfunctions.h:169</a></div></div>
<div class="ttc" id="a00202_html_aa24a4f5e29bd70cbe5a2413be1ea9682"><div class="ttname"><a href="a00202.html#aa24a4f5e29bd70cbe5a2413be1ea9682">HyPar::dxinv</a></div><div class="ttdeci">double * dxinv</div><div class="ttdef"><b>Definition:</b> <a href="a00238_source.html#l00110">hypar.h:110</a></div></div>
<div class="ttc" id="a00229_html_a4cd66304bc41a7751842230af3063b62"><div class="ttname"><a href="a00229.html#a4cd66304bc41a7751842230af3063b62">_ArrayAXPY_</a></div><div class="ttdeci">#define _ArrayAXPY_(x, a, y, size)</div><div class="ttdef"><b>Definition:</b> <a href="a00229_source.html#l00271">arrayfunctions.h:271</a></div></div>
<div class="ttc" id="a00202_html_a484873c74138512e41bc50d17b7d955a"><div class="ttname"><a href="a00202.html#a484873c74138512e41bc50d17b7d955a">HyPar::ndims</a></div><div class="ttdeci">int ndims</div><div class="ttdef"><b>Definition:</b> <a href="a00238_source.html#l00026">hypar.h:26</a></div></div>
<div class="ttc" id="a00231_html_ad6ab74942c9de13cf0b4c12eb0d91780"><div class="ttname"><a href="a00231.html#ad6ab74942c9de13cf0b4c12eb0d91780">IERR</a></div><div class="ttdeci">#define IERR</div><div class="ttdef"><b>Definition:</b> <a href="a00231_source.html#l00016">basic.h:16</a></div></div>
<div class="ttc" id="a00202_html_a38e0371f331cecbe63a77fa03e202afe"><div class="ttname"><a href="a00202.html#a38e0371f331cecbe63a77fa03e202afe">HyPar::dim_local</a></div><div class="ttdeci">int * dim_local</div><div class="ttdef"><b>Definition:</b> <a href="a00238_source.html#l00037">hypar.h:37</a></div></div>
<div class="ttc" id="a00202_html_aafc992b5fa79d5a4036024615d03bce6"><div class="ttname"><a href="a00202.html#aafc992b5fa79d5a4036024615d03bce6">HyPar::ghosts</a></div><div class="ttdeci">int ghosts</div><div class="ttdef"><b>Definition:</b> <a href="a00238_source.html#l00052">hypar.h:52</a></div></div>
<div class="ttc" id="a00231_html_add9cf96ae374934d245a1dc1ab697a42"><div class="ttname"><a href="a00231.html#add9cf96ae374934d245a1dc1ab697a42">CHECKERR</a></div><div class="ttdeci">#define CHECKERR(ierr)</div><div class="ttdef"><b>Definition:</b> <a href="a00231_source.html#l00018">basic.h:18</a></div></div>
<div class="ttc" id="a00231_html_a9aa9bad8531d6733731a850ccc471a42"><div class="ttname"><a href="a00231.html#a9aa9bad8531d6733731a850ccc471a42">_GetCoordinate_</a></div><div class="ttdeci">#define _GetCoordinate_(dir, i, dim, ghosts, x, coord)</div><div class="ttdef"><b>Definition:</b> <a href="a00231_source.html#l00031">basic.h:31</a></div></div>
<div class="ttc" id="a00202_html_ae8f6d2fd6490d3153cb4133bf183a404"><div class="ttname"><a href="a00202.html#ae8f6d2fd6490d3153cb4133bf183a404">HyPar::nvars</a></div><div class="ttdeci">int nvars</div><div class="ttdef"><b>Definition:</b> <a href="a00238_source.html#l00029">hypar.h:29</a></div></div>
<div class="ttc" id="a00205_html_a00663"><div class="ttname"><a href="a00205.html#a00663">MPIVariables</a></div><div class="ttdoc">Structure of MPI-related variables. </div><div class="ttdef"><b>Definition:</b> <a href="a00205_source.html#l00024">mpivars_struct.h:24</a></div></div>
<div class="ttc" id="a00248_html_abd61f932b070ee84262d9d98b6dd854f"><div class="ttname"><a href="a00248.html#abd61f932b070ee84262d9d98b6dd854f">MPISum_double</a></div><div class="ttdeci">int MPISum_double(double *, double *, int, void *)</div><div class="ttdef"><b>Definition:</b> <a href="a00398_source.html#l00039">MPISum.c:39</a></div></div>
<div class="ttc" id="a00202_html_a6dfeed442d18083b68fd0f28d5f63fa7"><div class="ttname"><a href="a00202.html#a6dfeed442d18083b68fd0f28d5f63fa7">HyPar::StepBoundaryIntegral</a></div><div class="ttdeci">double * StepBoundaryIntegral</div><div class="ttdef"><b>Definition:</b> <a href="a00238_source.html#l00379">hypar.h:379</a></div></div>
<div class="ttc" id="a00205_html_adad7a6f85831f3ac84d854b6c80aef43"><div class="ttname"><a href="a00205.html#adad7a6f85831f3ac84d854b6c80aef43">MPIVariables::world</a></div><div class="ttdeci">MPI_Comm world</div><div class="ttdef"><b>Definition:</b> <a href="a00205_source.html#l00037">mpivars_struct.h:37</a></div></div>
<div class="ttc" id="a00202_html"><div class="ttname"><a href="a00202.html">HyPar</a></div><div class="ttdoc">Structure containing all solver-specific variables and functions. </div><div class="ttdef"><b>Definition:</b> <a href="a00238_source.html#l00023">hypar.h:23</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a59bed56c53d29cca4a7c25a28d38e7b5"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int CalculateConservationError </td>
          <td>(</td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>s</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>m</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Calculates the error (L2) in conservation by computing the difference between the initial volume integral of the solution, and the sum of the current volume integral and the time integral of the boundary flux from the start of the simulation to the current simulation time. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">s</td><td>Solver object of type <a class="el" href="a00202.html" title="Structure containing all solver-specific variables and functions. ">HyPar</a> </td></tr>
    <tr><td class="paramname">m</td><td>MPI object of type <a class="el" href="a00205.html#a00663" title="Structure of MPI-related variables. ">MPIVariables</a> </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="a00305_source.html#l00016">16</a> of file <a class="el" href="a00305_source.html">CalculateConservationError.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;{</div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;  <a class="code" href="a00202.html">HyPar</a>         *solver = (<a class="code" href="a00202.html">HyPar</a>*) s;</div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;  <span class="keywordtype">int</span>           v,nvars = solver-&gt;<a class="code" href="a00202.html#ae8f6d2fd6490d3153cb4133bf183a404">nvars</a>;</div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;  <span class="keywordtype">double</span>        error;</div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;</div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;  <span class="keywordtype">double</span> base[nvars];</div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;  <span class="keywordflow">for</span> (v=0; v&lt;nvars; v++) {</div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="a00243.html#adf1be5ccbb7a2522b4f3a64043c72880">absolute</a>(solver-&gt;<a class="code" href="a00202.html#a3aec36aeb5caac1e87f5b4f5f75d5a23">VolumeIntegralInitial</a>[v]) &gt; 1.0)</div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;      base[v] = <a class="code" href="a00243.html#adf1be5ccbb7a2522b4f3a64043c72880">absolute</a>(solver-&gt;<a class="code" href="a00202.html#a3aec36aeb5caac1e87f5b4f5f75d5a23">VolumeIntegralInitial</a>[v]);</div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;    <span class="keywordflow">else</span> base[v] = 1.0;</div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;  }</div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;  </div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;  <span class="keywordflow">for</span> (v=0; v&lt;nvars; v++) {</div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;    error =  (solver-&gt;<a class="code" href="a00202.html#a57f7bff1d8bf27f2ca5c00270da00d05">VolumeIntegral</a>[v]+solver-&gt;<a class="code" href="a00202.html#a644ed0ed36ed4af1c396c0af6aca043d">TotalBoundaryIntegral</a>[v]-solver-&gt;<a class="code" href="a00202.html#a3aec36aeb5caac1e87f5b4f5f75d5a23">VolumeIntegralInitial</a>[v]) </div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;           * (solver-&gt;<a class="code" href="a00202.html#a57f7bff1d8bf27f2ca5c00270da00d05">VolumeIntegral</a>[v]+solver-&gt;<a class="code" href="a00202.html#a644ed0ed36ed4af1c396c0af6aca043d">TotalBoundaryIntegral</a>[v]-solver-&gt;<a class="code" href="a00202.html#a3aec36aeb5caac1e87f5b4f5f75d5a23">VolumeIntegralInitial</a>[v]);</div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;    solver-&gt;<a class="code" href="a00202.html#a965363cd64ce50ae17705dfb285dd0ab">ConservationError</a>[v] = sqrt(error)/base[v];</div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;  }</div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;  </div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;  <span class="keywordflow">return</span>(0);</div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;}</div>
<div class="ttc" id="a00202_html_a644ed0ed36ed4af1c396c0af6aca043d"><div class="ttname"><a href="a00202.html#a644ed0ed36ed4af1c396c0af6aca043d">HyPar::TotalBoundaryIntegral</a></div><div class="ttdeci">double * TotalBoundaryIntegral</div><div class="ttdef"><b>Definition:</b> <a href="a00238_source.html#l00381">hypar.h:381</a></div></div>
<div class="ttc" id="a00202_html_a3aec36aeb5caac1e87f5b4f5f75d5a23"><div class="ttname"><a href="a00202.html#a3aec36aeb5caac1e87f5b4f5f75d5a23">HyPar::VolumeIntegralInitial</a></div><div class="ttdeci">double * VolumeIntegralInitial</div><div class="ttdef"><b>Definition:</b> <a href="a00238_source.html#l00375">hypar.h:375</a></div></div>
<div class="ttc" id="a00202_html_ae8f6d2fd6490d3153cb4133bf183a404"><div class="ttname"><a href="a00202.html#ae8f6d2fd6490d3153cb4133bf183a404">HyPar::nvars</a></div><div class="ttdeci">int nvars</div><div class="ttdef"><b>Definition:</b> <a href="a00238_source.html#l00029">hypar.h:29</a></div></div>
<div class="ttc" id="a00202_html_a965363cd64ce50ae17705dfb285dd0ab"><div class="ttname"><a href="a00202.html#a965363cd64ce50ae17705dfb285dd0ab">HyPar::ConservationError</a></div><div class="ttdeci">double * ConservationError</div><div class="ttdef"><b>Definition:</b> <a href="a00238_source.html#l00369">hypar.h:369</a></div></div>
<div class="ttc" id="a00202_html"><div class="ttname"><a href="a00202.html">HyPar</a></div><div class="ttdoc">Structure containing all solver-specific variables and functions. </div><div class="ttdef"><b>Definition:</b> <a href="a00238_source.html#l00023">hypar.h:23</a></div></div>
<div class="ttc" id="a00243_html_adf1be5ccbb7a2522b4f3a64043c72880"><div class="ttname"><a href="a00243.html#adf1be5ccbb7a2522b4f3a64043c72880">absolute</a></div><div class="ttdeci">#define absolute(a)</div><div class="ttdef"><b>Definition:</b> <a href="a00243_source.html#l00032">math_ops.h:32</a></div></div>
<div class="ttc" id="a00202_html_a57f7bff1d8bf27f2ca5c00270da00d05"><div class="ttname"><a href="a00202.html#a57f7bff1d8bf27f2ca5c00270da00d05">HyPar::VolumeIntegral</a></div><div class="ttdeci">double * VolumeIntegral</div><div class="ttdef"><b>Definition:</b> <a href="a00238_source.html#l00373">hypar.h:373</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a55a796b622e90a00d1cb9164ab40c1c3"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void IncrementFilenameIndex </td>
          <td>(</td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>f</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>len</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">  Increment the output filename of the form op_nnnnn.dat by 1,
</pre><p> i.e., the number represented by the string nnnnn is incremented by 1.</p>
<p>Increment a character string representing an integer by 1. For example: "00002" -&gt; "00003"; "3421934" -&gt; "3421935"; "999" -&gt; "000". The string can be of arbitrary length. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">f</td><td>Character string representing the integer </td></tr>
    <tr><td class="paramname">len</td><td>Length of the string </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="a00312_source.html#l00046">46</a> of file <a class="el" href="a00312_source.html">IncrementFilename.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;{</div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;  <span class="keywordtype">int</span> i;</div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;  <span class="keywordflow">for</span> (i=len-1; i&gt;=0; i--) {</div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;    <span class="keywordflow">if</span> (f[i] == <span class="charliteral">&#39;9&#39;</span>) {</div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;      f[i] = <span class="charliteral">&#39;0&#39;</span>;</div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;      <span class="keywordflow">if</span> (!i) fprintf(stderr,<span class="stringliteral">&quot;Warning: file increment hit max limit. Resetting to zero.\n&quot;</span>);</div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;      f[i]++;</div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;      <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;    }</div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;  }</div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a72a765174f8397b09ea5632b33c2563e"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int NonLinearInterpolation </td>
          <td>(</td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>u</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>s</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>m</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>t</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int(*)(double *, double *, int, void *, double)&#160;</td>
          <td class="paramname"><em>FluxFunction</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Compute the interpolation coefficients of a nonlinear interpolation method, based on the smoothness of the flux function of the solution passed as an argument. This function is provided separately so that these coefficients can be pre-computed and stored for future use.</p>
<p>In the implementation of non-linear methods (such as WENO5), the calculation of the non-linear coefficients, and the actual evaluation of the interpolant are separated into different functions. This provides flexibility on when the nonlinear coefficients are evaluated. Some scenarios are as follows:</p>
<ul>
<li>For explicit time integration, it will be computed every time the hyperbolic flux term is being computed.</li>
<li>For implicit time integration, consistency or linearization may require that the coefficients be computed and "frozen" at the beginning of each stage. Thus, this function can be called at the beginning of each time integration stage, while <a class="el" href="a00310.html#a0096c47175c007dbe805b34129835b84">HyperbolicFunction()</a> is called with the argument <b>LimFlag</b> = 0. </li>
</ul>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">u</td><td>Solution array </td></tr>
    <tr><td class="paramname">s</td><td>Solver object of type <a class="el" href="a00202.html" title="Structure containing all solver-specific variables and functions. ">HyPar</a> </td></tr>
    <tr><td class="paramname">m</td><td>MPI object of type <a class="el" href="a00205.html#a00663" title="Structure of MPI-related variables. ">MPIVariables</a> </td></tr>
    <tr><td class="paramname">t</td><td>Current solution time </td></tr>
    <tr><td class="paramname">FluxFunction</td><td>The flux function \({\bf f}_d\left({\bf u}\right)\), whose properties (typically smoothness) is used to evaluate the nonlinear coefficients </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="a00313_source.html#l00028">28</a> of file <a class="el" href="a00313_source.html">NonLinearInterpolation.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;{</div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;  <a class="code" href="a00202.html">HyPar</a>         *solver = (<a class="code" href="a00202.html">HyPar</a>*)        s;</div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;  <a class="code" href="a00205.html#a00663">MPIVariables</a>  *mpi    = (<a class="code" href="a00205.html#a00663">MPIVariables</a>*) m;</div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;  <span class="keywordtype">double</span>        *FluxC  = solver-&gt;<a class="code" href="a00202.html#aee7ff3b51db01ee6ed4038ff5311ed24">fluxC</a>; <span class="comment">/* cell centered flux */</span></div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;  <a class="code" href="a00231.html#a68f50121fb9a7daeaf60e50cdef82ef3">_DECLARE_IERR_</a>;</div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;</div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;  <span class="keywordtype">int</span> flag = (FluxFunction &amp;&amp; solver-&gt;<a class="code" href="a00202.html#a9a61d44b50cc9043a19bdc3c0f591d99">flag_nonlinearinterp</a> &amp;&amp; solver-&gt;<a class="code" href="a00202.html#afeeb150a9699ade5eccc7589fcae3fe0">SetInterpLimiterVar</a>);</div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;  <span class="keywordflow">if</span> (flag) {;</div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;    <span class="keywordtype">int</span>     ndims  = solver-&gt;<a class="code" href="a00202.html#a484873c74138512e41bc50d17b7d955a">ndims</a>;</div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;    <span class="keywordtype">int</span>     nvars  = solver-&gt;<a class="code" href="a00202.html#ae8f6d2fd6490d3153cb4133bf183a404">nvars</a>;</div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;    <span class="keywordtype">int</span>     ghosts = solver-&gt;<a class="code" href="a00202.html#aafc992b5fa79d5a4036024615d03bce6">ghosts</a>;</div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;    <span class="keywordtype">int</span>     *dim   = solver-&gt;<a class="code" href="a00202.html#a38e0371f331cecbe63a77fa03e202afe">dim_local</a>;</div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;    <span class="keywordtype">double</span>  *x     = solver-&gt;<a class="code" href="a00202.html#a711aad4cbe735871dd9e91ab575c878b">x</a>;</div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;</div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;    <span class="keywordtype">int</span> size = 1, d;</div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;    <span class="keywordflow">for</span> (d=0; d&lt;ndims; d++) size *= (dim[d] + 2*ghosts);</div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;</div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;    <span class="comment">/* apply boundary conditions and exchange data over MPI interfaces */</span></div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;    <a class="code" href="a00231.html#ad6ab74942c9de13cf0b4c12eb0d91780">IERR</a> solver-&gt;<a class="code" href="a00202.html#aa4de7bdc1e62417caf51b9c45184268d">ApplyBoundaryConditions</a>(solver,mpi,u,NULL,t);      <a class="code" href="a00231.html#add9cf96ae374934d245a1dc1ab697a42">CHECKERR</a>(ierr);</div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;    <a class="code" href="a00231.html#ad6ab74942c9de13cf0b4c12eb0d91780">IERR</a> solver-&gt;<a class="code" href="a00202.html#a83d97dfc50e6bfefd0db6503d365d5bd">ApplyIBConditions</a>(solver,mpi,u,t);                 <a class="code" href="a00231.html#add9cf96ae374934d245a1dc1ab697a42">CHECKERR</a>(ierr);</div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;    <a class="code" href="a00231.html#ad6ab74942c9de13cf0b4c12eb0d91780">IERR</a> <a class="code" href="a00248.html#a60ace5964c051fa481e6a1e6f1ef75d7">MPIExchangeBoundariesnD</a>(ndims,nvars,dim,ghosts,mpi,u);     <a class="code" href="a00231.html#add9cf96ae374934d245a1dc1ab697a42">CHECKERR</a>(ierr);</div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;</div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;    <span class="keywordtype">int</span> offset = 0;</div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;    <span class="keywordflow">for</span> (d = 0; d &lt; ndims; d++) {</div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;      <span class="comment">/* evaluate cell-centered flux */</span></div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;      <a class="code" href="a00231.html#ad6ab74942c9de13cf0b4c12eb0d91780">IERR</a> FluxFunction(FluxC,u,d,solver,t);                          <a class="code" href="a00231.html#add9cf96ae374934d245a1dc1ab697a42">CHECKERR</a>(ierr);</div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;      <span class="comment">/* calculate non-linear interpolation coefficients */</span></div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;      <a class="code" href="a00231.html#ad6ab74942c9de13cf0b4c12eb0d91780">IERR</a> solver-&gt;<a class="code" href="a00202.html#afeeb150a9699ade5eccc7589fcae3fe0">SetInterpLimiterVar</a>(FluxC,u,x+offset,d,solver,mpi);<a class="code" href="a00231.html#add9cf96ae374934d245a1dc1ab697a42">CHECKERR</a>(ierr);</div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;      offset += dim[d] + 2*ghosts;</div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;    }</div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;  }</div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;</div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;  <span class="keywordflow">return</span>(0);</div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;}</div>
<div class="ttc" id="a00248_html_a60ace5964c051fa481e6a1e6f1ef75d7"><div class="ttname"><a href="a00248.html#a60ace5964c051fa481e6a1e6f1ef75d7">MPIExchangeBoundariesnD</a></div><div class="ttdeci">int MPIExchangeBoundariesnD(int, int, int *, int, void *, double *)</div><div class="ttdef"><b>Definition:</b> <a href="a00383_source.html#l00042">MPIExchangeBoundariesnD.c:42</a></div></div>
<div class="ttc" id="a00202_html_a9a61d44b50cc9043a19bdc3c0f591d99"><div class="ttname"><a href="a00202.html#a9a61d44b50cc9043a19bdc3c0f591d99">HyPar::flag_nonlinearinterp</a></div><div class="ttdeci">int flag_nonlinearinterp</div><div class="ttdef"><b>Definition:</b> <a href="a00238_source.html#l00406">hypar.h:406</a></div></div>
<div class="ttc" id="a00231_html_a68f50121fb9a7daeaf60e50cdef82ef3"><div class="ttname"><a href="a00231.html#a68f50121fb9a7daeaf60e50cdef82ef3">_DECLARE_IERR_</a></div><div class="ttdeci">#define _DECLARE_IERR_</div><div class="ttdef"><b>Definition:</b> <a href="a00231_source.html#l00017">basic.h:17</a></div></div>
<div class="ttc" id="a00202_html_a711aad4cbe735871dd9e91ab575c878b"><div class="ttname"><a href="a00202.html#a711aad4cbe735871dd9e91ab575c878b">HyPar::x</a></div><div class="ttdeci">double * x</div><div class="ttdef"><b>Definition:</b> <a href="a00238_source.html#l00107">hypar.h:107</a></div></div>
<div class="ttc" id="a00202_html_a484873c74138512e41bc50d17b7d955a"><div class="ttname"><a href="a00202.html#a484873c74138512e41bc50d17b7d955a">HyPar::ndims</a></div><div class="ttdeci">int ndims</div><div class="ttdef"><b>Definition:</b> <a href="a00238_source.html#l00026">hypar.h:26</a></div></div>
<div class="ttc" id="a00231_html_ad6ab74942c9de13cf0b4c12eb0d91780"><div class="ttname"><a href="a00231.html#ad6ab74942c9de13cf0b4c12eb0d91780">IERR</a></div><div class="ttdeci">#define IERR</div><div class="ttdef"><b>Definition:</b> <a href="a00231_source.html#l00016">basic.h:16</a></div></div>
<div class="ttc" id="a00202_html_a38e0371f331cecbe63a77fa03e202afe"><div class="ttname"><a href="a00202.html#a38e0371f331cecbe63a77fa03e202afe">HyPar::dim_local</a></div><div class="ttdeci">int * dim_local</div><div class="ttdef"><b>Definition:</b> <a href="a00238_source.html#l00037">hypar.h:37</a></div></div>
<div class="ttc" id="a00202_html_aafc992b5fa79d5a4036024615d03bce6"><div class="ttname"><a href="a00202.html#aafc992b5fa79d5a4036024615d03bce6">HyPar::ghosts</a></div><div class="ttdeci">int ghosts</div><div class="ttdef"><b>Definition:</b> <a href="a00238_source.html#l00052">hypar.h:52</a></div></div>
<div class="ttc" id="a00231_html_add9cf96ae374934d245a1dc1ab697a42"><div class="ttname"><a href="a00231.html#add9cf96ae374934d245a1dc1ab697a42">CHECKERR</a></div><div class="ttdeci">#define CHECKERR(ierr)</div><div class="ttdef"><b>Definition:</b> <a href="a00231_source.html#l00018">basic.h:18</a></div></div>
<div class="ttc" id="a00202_html_ae8f6d2fd6490d3153cb4133bf183a404"><div class="ttname"><a href="a00202.html#ae8f6d2fd6490d3153cb4133bf183a404">HyPar::nvars</a></div><div class="ttdeci">int nvars</div><div class="ttdef"><b>Definition:</b> <a href="a00238_source.html#l00029">hypar.h:29</a></div></div>
<div class="ttc" id="a00205_html_a00663"><div class="ttname"><a href="a00205.html#a00663">MPIVariables</a></div><div class="ttdoc">Structure of MPI-related variables. </div><div class="ttdef"><b>Definition:</b> <a href="a00205_source.html#l00024">mpivars_struct.h:24</a></div></div>
<div class="ttc" id="a00202_html_aee7ff3b51db01ee6ed4038ff5311ed24"><div class="ttname"><a href="a00202.html#aee7ff3b51db01ee6ed4038ff5311ed24">HyPar::fluxC</a></div><div class="ttdeci">double * fluxC</div><div class="ttdef"><b>Definition:</b> <a href="a00238_source.html#l00128">hypar.h:128</a></div></div>
<div class="ttc" id="a00202_html_a83d97dfc50e6bfefd0db6503d365d5bd"><div class="ttname"><a href="a00202.html#a83d97dfc50e6bfefd0db6503d365d5bd">HyPar::ApplyIBConditions</a></div><div class="ttdeci">int(* ApplyIBConditions)(void *, void *, double *, double)</div><div class="ttdef"><b>Definition:</b> <a href="a00238_source.html#l00212">hypar.h:212</a></div></div>
<div class="ttc" id="a00202_html_afeeb150a9699ade5eccc7589fcae3fe0"><div class="ttname"><a href="a00202.html#afeeb150a9699ade5eccc7589fcae3fe0">HyPar::SetInterpLimiterVar</a></div><div class="ttdeci">int(* SetInterpLimiterVar)(double *, double *, double *, int, void *, void *)</div><div class="ttdef"><b>Definition:</b> <a href="a00238_source.html#l00229">hypar.h:229</a></div></div>
<div class="ttc" id="a00202_html_aa4de7bdc1e62417caf51b9c45184268d"><div class="ttname"><a href="a00202.html#aa4de7bdc1e62417caf51b9c45184268d">HyPar::ApplyBoundaryConditions</a></div><div class="ttdeci">int(* ApplyBoundaryConditions)(void *, void *, double *, double *, double)</div><div class="ttdef"><b>Definition:</b> <a href="a00238_source.html#l00209">hypar.h:209</a></div></div>
<div class="ttc" id="a00202_html"><div class="ttname"><a href="a00202.html">HyPar</a></div><div class="ttdoc">Structure containing all solver-specific variables and functions. </div><div class="ttdef"><b>Definition:</b> <a href="a00238_source.html#l00023">hypar.h:23</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a4b6010d35e9ab1ebfb78602241b7fb0a"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int gpuHyperbolicFunction </td>
          <td>(</td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>hyp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>u</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>s</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>m</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>t</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>LimFlag</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int(*)(double *, double *, int, void *, double)&#160;</td>
          <td class="paramname"><em>FluxFunction</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int(*)(double *, double *, double *, double *, double *, double *, int, void *, double)&#160;</td>
          <td class="paramname"><em>UpwindFunction</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>This function computes the hyperbolic term of the governing equations, expressed as follows:- </p>
<p class="formulaDsp">
\begin{equation} {\bf F} \left({\bf u}\right) = \sum_{d=0}^{D-1} \frac {\partial {\bf f}_d\left({\bf u}\right)} {\partial x_d} \end{equation}
</p>
<p> using a conservative finite-difference discretization is space: </p>
<p class="formulaDsp">
\begin{equation} \hat{\bf F} \left({\bf u}\right) = \sum_{d=0}^{D-1} \frac {1} {\Delta x_d} \left[ \hat{\bf f}_{d,j+1/2} - \hat{\bf f}_{d,j-1/2} \right] \end{equation}
</p>
<p> where \(d\) denotes the spatial dimension, \(D\) denotes the total number of spatial dimensions, the hat denotes the discretized quantity, and \(j\) is the grid coordinate along dimension \(d\). The approximation to the flux function \({\bf f}_d\) at the interfaces \(j\pm1/2\), denoted by \(\hat{\bf f}_{d,j\pm 1/2}\), are computed using the function <a class="el" href="a00311.html#ae6e53860597b32435f6ad086401e11a1">ReconstructHyperbolic()</a>. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">hyp</td><td>Array to hold the computed hyperbolic term (shares the same layout as u </td></tr>
    <tr><td class="paramname">u</td><td>Solution array </td></tr>
    <tr><td class="paramname">s</td><td>Solver object of type <a class="el" href="a00202.html" title="Structure containing all solver-specific variables and functions. ">HyPar</a> </td></tr>
    <tr><td class="paramname">m</td><td>MPI object of type <a class="el" href="a00205.html#a00663" title="Structure of MPI-related variables. ">MPIVariables</a> </td></tr>
    <tr><td class="paramname">t</td><td>Current simulation time </td></tr>
    <tr><td class="paramname">LimFlag</td><td>Flag to indicate if the nonlinear coefficients for solution-dependent interpolation method should be recomputed (see <a class="el" href="a00311.html#ae6e53860597b32435f6ad086401e11a1">ReconstructHyperbolic()</a> for an explanation on why this is needed) </td></tr>
    <tr><td class="paramname">FluxFunction</td><td>Function pointer to the flux function for the hyperbolic term </td></tr>
    <tr><td class="paramname">UpwindFunction</td><td>Function pointer to the upwinding function for the hyperbolic term </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="a00311_source.html#l00473">473</a> of file <a class="el" href="a00311_source.html">HyperbolicFunction_GPU.cu</a>.</p>
<div class="fragment"><div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;{</div>
<div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;    <a class="code" href="a00202.html">HyPar</a>         *solver = (<a class="code" href="a00202.html">HyPar</a>*)        s;</div>
<div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;    <a class="code" href="a00205.html#a00663">MPIVariables</a>  *mpi    = (<a class="code" href="a00205.html#a00663">MPIVariables</a>*) m;</div>
<div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;    <span class="keywordtype">int</span>           d;</div>
<div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;    <span class="keywordtype">double</span>        *FluxI  = solver-&gt;<a class="code" href="a00202.html#a983929b7b1511ff3e7800597adef6a91">fluxI</a>; <span class="comment">/* interface flux     */</span></div>
<div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;    <span class="keywordtype">double</span>        *FluxC  = solver-&gt;<a class="code" href="a00202.html#aee7ff3b51db01ee6ed4038ff5311ed24">fluxC</a>; <span class="comment">/* cell centered flux */</span></div>
<div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;</div>
<div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;    <span class="keywordtype">int</span>     ndims     = solver-&gt;<a class="code" href="a00202.html#a484873c74138512e41bc50d17b7d955a">ndims</a>;</div>
<div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;    <span class="keywordtype">int</span>     nvars     = solver-&gt;<a class="code" href="a00202.html#ae8f6d2fd6490d3153cb4133bf183a404">nvars</a>;</div>
<div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;    <span class="keywordtype">int</span>     ghosts    = solver-&gt;<a class="code" href="a00202.html#aafc992b5fa79d5a4036024615d03bce6">ghosts</a>;</div>
<div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;    <span class="keywordtype">int</span>     *dim      = solver-&gt;<a class="code" href="a00202.html#a38e0371f331cecbe63a77fa03e202afe">dim_local</a>;</div>
<div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;    <span class="keywordtype">int</span>     size      = solver-&gt;<a class="code" href="a00202.html#a20ee1fd00a220b98513127884a5558cf">npoints_local_wghosts</a>;</div>
<div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;    <span class="keywordtype">double</span>  *x        = solver-&gt;<a class="code" href="a00202.html#a12356f3dd3ff93b8a46d248bf1f074e7">gpu_x</a>;</div>
<div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;    <span class="keywordtype">double</span>  *dxinv    = solver-&gt;<a class="code" href="a00202.html#a7a147598c79bd4c442a294cac219ca82">gpu_dxinv</a>;</div>
<div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;    <span class="keywordtype">double</span>  *FluxI_p1, *FluxI_p2;</div>
<div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;</div>
<div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;    LimFlag = (LimFlag &amp;&amp; solver-&gt;<a class="code" href="a00202.html#a9a61d44b50cc9043a19bdc3c0f591d99">flag_nonlinearinterp</a> &amp;&amp; solver-&gt;<a class="code" href="a00202.html#afeeb150a9699ade5eccc7589fcae3fe0">SetInterpLimiterVar</a>);</div>
<div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;</div>
<div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;    <a class="code" href="a00230.html#a5211607a9910a4d3fd4c7001794c91ee">gpuMemset</a>(hyp, 0, size*nvars*<span class="keyword">sizeof</span>(<span class="keywordtype">double</span>));</div>
<div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;    <a class="code" href="a00230.html#a5211607a9910a4d3fd4c7001794c91ee">gpuMemset</a>(solver-&gt;<a class="code" href="a00202.html#aab84e51d0d957c60e7890c1d96c4579b">StageBoundaryBuffer</a>, 0, solver-&gt;<a class="code" href="a00202.html#a80b7df4626f7c6b2952f6c270aff213e">StageBoundaryBuffer_size</a>*<span class="keyword">sizeof</span>(<span class="keywordtype">double</span>));</div>
<div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;    <a class="code" href="a00230.html#a5211607a9910a4d3fd4c7001794c91ee">gpuMemset</a>(solver-&gt;<a class="code" href="a00202.html#ac3326fc53477d445133072e3f1fe6b59">StageBoundaryIntegral</a>, 0, 2*ndims*nvars*<span class="keyword">sizeof</span>(<span class="keywordtype">double</span>));</div>
<div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;</div>
<div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;    <span class="keywordflow">if</span> (!FluxFunction) <span class="keywordflow">return</span>(0); <span class="comment">/* zero hyperbolic term */</span></div>
<div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;    <span class="comment">/*solver-&gt;count_hyp++;*/</span></div>
<div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;</div>
<div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;    <span class="keywordtype">int</span> npoints_grid = 1; <span class="keywordflow">for</span> (d = 0; d &lt; ndims; d++) npoints_grid *= dim[d];</div>
<div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;    <span class="keywordtype">int</span> nblocks = (npoints_grid - 1) / <a class="code" href="a00232.html#aceca9611b1e048e233f2d9cc02f70796">GPU_THREADS_PER_BLOCK</a> + 1;</div>
<div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;    <span class="keywordtype">int</span> offset = 0;</div>
<div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;</div>
<div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;<span class="preprocessor">#if defined(GPU_STAT)</span></div>
<div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;<span class="preprocessor"></span>    cudaEvent_t start, stop;</div>
<div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;    <span class="keywordtype">float</span> milliseconds = 0;</div>
<div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;</div>
<div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;    checkCuda( cudaEventCreate(&amp;start) );</div>
<div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;    checkCuda( cudaEventCreate(&amp;stop) );</div>
<div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;<span class="preprocessor"></span></div>
<div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;    <span class="keywordflow">for</span> (d = 0; d &lt; ndims; d++) {</div>
<div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;        <span class="keywordtype">int</span> npoints_dim_interface = 1; <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;ndims; i++) npoints_dim_interface *= (i==d) ? (dim[i]+1) : dim[i];</div>
<div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;        <span class="comment">/* evaluate cell-centered flux */</span></div>
<div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;        FluxFunction(FluxC,u,d,solver,t);</div>
<div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;        <span class="comment">/* compute interface fluxes */</span></div>
<div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;        <a class="code" href="a00311.html#ae6e53860597b32435f6ad086401e11a1">ReconstructHyperbolic</a>(FluxI,FluxC,u,x+offset,d,solver,mpi,t,LimFlag,UpwindFunction);</div>
<div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;</div>
<div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;        FluxI_p1 = solver-&gt;<a class="code" href="a00202.html#aab84e51d0d957c60e7890c1d96c4579b">StageBoundaryBuffer</a>+(solver-&gt;<a class="code" href="a00202.html#a5de5f995ed280640a28ef2cee85b5877">gpu_npoints_boundary_offset</a>[d]*nvars);</div>
<div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;        FluxI_p2 = solver-&gt;<a class="code" href="a00202.html#aab84e51d0d957c60e7890c1d96c4579b">StageBoundaryBuffer</a>+(solver-&gt;<a class="code" href="a00202.html#a5de5f995ed280640a28ef2cee85b5877">gpu_npoints_boundary_offset</a>[d]+solver-&gt;<a class="code" href="a00202.html#a6ee825f6a1705dd150485b67e2ecfbf3">gpu_npoints_boundary</a>[d])*nvars;</div>
<div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;</div>
<div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;<span class="preprocessor">#if defined(GPU_STAT)</span></div>
<div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;<span class="preprocessor"></span>        checkCuda( cudaEventRecord(start, 0) );</div>
<div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;<span class="preprocessor"></span>        <span class="keywordflow">if</span> (ndims == 3) {</div>
<div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;          HyperbolicFunction_dim3_kernel&lt;&lt;&lt;nblocks, GPU_THREADS_PER_BLOCK&gt;&gt;&gt;(</div>
<div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;              npoints_grid, size, npoints_dim_interface, d, nvars, ghosts, offset,</div>
<div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;              solver-&gt;<a class="code" href="a00202.html#aada0460ecc47924f438072324b8806f5">gpu_dim_local</a>, FluxI, dxinv,</div>
<div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;              hyp, FluxI_p1, FluxI_p2</div>
<div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;          );</div>
<div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;          fprintf(stderr,<span class="stringliteral">&quot;gpuHyperbolicFunction(): Not implemented for ndims = %d!\n&quot;</span>, ndims);</div>
<div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;          exit(1);</div>
<div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;        }</div>
<div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;        cudaDeviceSynchronize();</div>
<div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;</div>
<div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;<span class="preprocessor">#if defined(GPU_STAT)</span></div>
<div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;<span class="preprocessor"></span>        checkCuda( cudaEventRecord(stop, 0) );</div>
<div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;        checkCuda( cudaEventSynchronize(stop) );</div>
<div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;        checkCuda( cudaEventElapsedTime(&amp;milliseconds, start, stop) );</div>
<div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;        printf(<span class="stringliteral">&quot;%-50s GPU time = %.6f dir = %d bandwidth (GB/s) = %.2f\n&quot;</span>,</div>
<div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;                <span class="stringliteral">&quot;HyperbolicFunction&quot;</span>, milliseconds*1e-3, d, (1e-6*2*npoints_grid*nvars*<span class="keyword">sizeof</span>(<span class="keywordtype">double</span>))/milliseconds);</div>
<div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;</div>
<div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;        checkCuda( cudaEventRecord(start, 0) );</div>
<div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;<span class="preprocessor"></span></div>
<div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;        StageBoundaryIntegral_kernel&lt;GPU_THREADS_PER_BLOCK&gt;&lt;&lt;&lt;1, <a class="code" href="a00232.html#aceca9611b1e048e233f2d9cc02f70796">GPU_THREADS_PER_BLOCK</a>, GPU_THREADS_PER_BLOCK*nvars*<span class="keyword">sizeof</span>(double)&gt;&gt;&gt;(</div>
<div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;          solver-&gt;<a class="code" href="a00202.html#a6ee825f6a1705dd150485b67e2ecfbf3">gpu_npoints_boundary</a>[d], nvars, -1, FluxI_p1,</div>
<div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;          solver-&gt;<a class="code" href="a00202.html#ac3326fc53477d445133072e3f1fe6b59">StageBoundaryIntegral</a> + 2*d*nvars</div>
<div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;        );</div>
<div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;        StageBoundaryIntegral_kernel&lt;GPU_THREADS_PER_BLOCK&gt;&lt;&lt;&lt;1, <a class="code" href="a00232.html#aceca9611b1e048e233f2d9cc02f70796">GPU_THREADS_PER_BLOCK</a>, GPU_THREADS_PER_BLOCK*nvars*<span class="keyword">sizeof</span>(double)&gt;&gt;&gt;(</div>
<div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;          solver-&gt;<a class="code" href="a00202.html#a6ee825f6a1705dd150485b67e2ecfbf3">gpu_npoints_boundary</a>[d], nvars, 1, FluxI_p2,</div>
<div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;          solver-&gt;<a class="code" href="a00202.html#ac3326fc53477d445133072e3f1fe6b59">StageBoundaryIntegral</a> + (2*d+1)*nvars</div>
<div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;        );</div>
<div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;        cudaDeviceSynchronize();</div>
<div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;</div>
<div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;<span class="preprocessor">#if defined(GPU_STAT)</span></div>
<div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;<span class="preprocessor"></span>        checkCuda( cudaEventRecord(stop, 0) );</div>
<div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;        checkCuda( cudaEventSynchronize(stop) );</div>
<div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;        checkCuda( cudaEventElapsedTime(&amp;milliseconds, start, stop) );</div>
<div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;        printf(<span class="stringliteral">&quot;%-50s GPU time = %.6f dir = %d bandwidth (GB/s) = %.2f\n&quot;</span>,</div>
<div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;                <span class="stringliteral">&quot;StageBoundaryIntegral&quot;</span>, milliseconds*1e-3, d, (1e-6*2*solver-&gt;<a class="code" href="a00202.html#a6ee825f6a1705dd150485b67e2ecfbf3">gpu_npoints_boundary</a>[d]*nvars*<span class="keyword">sizeof</span>(<span class="keywordtype">double</span>))/milliseconds);</div>
<div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;<span class="preprocessor"></span>        offset += dim[d] + 2*ghosts;</div>
<div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;    }</div>
<div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;</div>
<div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;    <span class="keywordflow">if</span> (solver-&gt;<a class="code" href="a00202.html#ae83b1b0117b6a805ead2e4728945814c">flag_ib</a>) <a class="code" href="a00230.html#afd6620a5112f7aeb8391dc20e0f3b048">gpuArrayBlockMultiply</a>(hyp, solver-&gt;<a class="code" href="a00202.html#a992b70a21ce15afa8e06a4e3997cab8b">gpu_iblank</a>, size, nvars);</div>
<div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;</div>
<div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;<span class="preprocessor">#if defined(GPU_STAT)</span></div>
<div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;<span class="preprocessor"></span>    checkCuda(cudaEventDestroy(start));</div>
<div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;    checkCuda(cudaEventDestroy(stop));</div>
<div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;<span class="preprocessor"></span></div>
<div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160;    <span class="keywordflow">return</span>(0);</div>
<div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160;}</div>
<div class="ttc" id="a00202_html_aada0460ecc47924f438072324b8806f5"><div class="ttname"><a href="a00202.html#aada0460ecc47924f438072324b8806f5">HyPar::gpu_dim_local</a></div><div class="ttdeci">int * gpu_dim_local</div><div class="ttdef"><b>Definition:</b> <a href="a00238_source.html#l00450">hypar.h:450</a></div></div>
<div class="ttc" id="a00202_html_a9a61d44b50cc9043a19bdc3c0f591d99"><div class="ttname"><a href="a00202.html#a9a61d44b50cc9043a19bdc3c0f591d99">HyPar::flag_nonlinearinterp</a></div><div class="ttdeci">int flag_nonlinearinterp</div><div class="ttdef"><b>Definition:</b> <a href="a00238_source.html#l00406">hypar.h:406</a></div></div>
<div class="ttc" id="a00311_html_ae6e53860597b32435f6ad086401e11a1"><div class="ttname"><a href="a00311.html#ae6e53860597b32435f6ad086401e11a1">ReconstructHyperbolic</a></div><div class="ttdeci">static int ReconstructHyperbolic(double *, double *, double *, double *, int, void *, void *, double, int, int(*)(double *, double *, double *, double *, double *, double *, int, void *, double))</div><div class="ttdef"><b>Definition:</b> <a href="a00311_source.html#l00629">HyperbolicFunction_GPU.cu:629</a></div></div>
<div class="ttc" id="a00202_html_a7a147598c79bd4c442a294cac219ca82"><div class="ttname"><a href="a00202.html#a7a147598c79bd4c442a294cac219ca82">HyPar::gpu_dxinv</a></div><div class="ttdeci">double * gpu_dxinv</div><div class="ttdef"><b>Definition:</b> <a href="a00238_source.html#l00453">hypar.h:453</a></div></div>
<div class="ttc" id="a00202_html_a6ee825f6a1705dd150485b67e2ecfbf3"><div class="ttname"><a href="a00202.html#a6ee825f6a1705dd150485b67e2ecfbf3">HyPar::gpu_npoints_boundary</a></div><div class="ttdeci">int gpu_npoints_boundary[3]</div><div class="ttdef"><b>Definition:</b> <a href="a00238_source.html#l00448">hypar.h:448</a></div></div>
<div class="ttc" id="a00230_html_a5211607a9910a4d3fd4c7001794c91ee"><div class="ttname"><a href="a00230.html#a5211607a9910a4d3fd4c7001794c91ee">gpuMemset</a></div><div class="ttdeci">void gpuMemset(void *, int, size_t)</div><div class="ttdef"><b>Definition:</b> <a href="a00270_source.html#l00131">ArrayImplementations_GPU.cu:131</a></div></div>
<div class="ttc" id="a00202_html_ac3326fc53477d445133072e3f1fe6b59"><div class="ttname"><a href="a00202.html#ac3326fc53477d445133072e3f1fe6b59">HyPar::StageBoundaryIntegral</a></div><div class="ttdeci">double * StageBoundaryIntegral</div><div class="ttdef"><b>Definition:</b> <a href="a00238_source.html#l00377">hypar.h:377</a></div></div>
<div class="ttc" id="a00202_html_a80b7df4626f7c6b2952f6c270aff213e"><div class="ttname"><a href="a00202.html#a80b7df4626f7c6b2952f6c270aff213e">HyPar::StageBoundaryBuffer_size</a></div><div class="ttdeci">int StageBoundaryBuffer_size</div><div class="ttdef"><b>Definition:</b> <a href="a00238_source.html#l00456">hypar.h:456</a></div></div>
<div class="ttc" id="a00202_html_a484873c74138512e41bc50d17b7d955a"><div class="ttname"><a href="a00202.html#a484873c74138512e41bc50d17b7d955a">HyPar::ndims</a></div><div class="ttdeci">int ndims</div><div class="ttdef"><b>Definition:</b> <a href="a00238_source.html#l00026">hypar.h:26</a></div></div>
<div class="ttc" id="a00202_html_a38e0371f331cecbe63a77fa03e202afe"><div class="ttname"><a href="a00202.html#a38e0371f331cecbe63a77fa03e202afe">HyPar::dim_local</a></div><div class="ttdeci">int * dim_local</div><div class="ttdef"><b>Definition:</b> <a href="a00238_source.html#l00037">hypar.h:37</a></div></div>
<div class="ttc" id="a00202_html_aafc992b5fa79d5a4036024615d03bce6"><div class="ttname"><a href="a00202.html#aafc992b5fa79d5a4036024615d03bce6">HyPar::ghosts</a></div><div class="ttdeci">int ghosts</div><div class="ttdef"><b>Definition:</b> <a href="a00238_source.html#l00052">hypar.h:52</a></div></div>
<div class="ttc" id="a00202_html_a20ee1fd00a220b98513127884a5558cf"><div class="ttname"><a href="a00202.html#a20ee1fd00a220b98513127884a5558cf">HyPar::npoints_local_wghosts</a></div><div class="ttdeci">int npoints_local_wghosts</div><div class="ttdef"><b>Definition:</b> <a href="a00238_source.html#l00042">hypar.h:42</a></div></div>
<div class="ttc" id="a00202_html_ae8f6d2fd6490d3153cb4133bf183a404"><div class="ttname"><a href="a00202.html#ae8f6d2fd6490d3153cb4133bf183a404">HyPar::nvars</a></div><div class="ttdeci">int nvars</div><div class="ttdef"><b>Definition:</b> <a href="a00238_source.html#l00029">hypar.h:29</a></div></div>
<div class="ttc" id="a00230_html_afd6620a5112f7aeb8391dc20e0f3b048"><div class="ttname"><a href="a00230.html#afd6620a5112f7aeb8391dc20e0f3b048">gpuArrayBlockMultiply</a></div><div class="ttdeci">void gpuArrayBlockMultiply(double *, const double *, int, int)</div><div class="ttdef"><b>Definition:</b> <a href="a00270_source.html#l00193">ArrayImplementations_GPU.cu:193</a></div></div>
<div class="ttc" id="a00202_html_a12356f3dd3ff93b8a46d248bf1f074e7"><div class="ttname"><a href="a00202.html#a12356f3dd3ff93b8a46d248bf1f074e7">HyPar::gpu_x</a></div><div class="ttdeci">double * gpu_x</div><div class="ttdef"><b>Definition:</b> <a href="a00238_source.html#l00452">hypar.h:452</a></div></div>
<div class="ttc" id="a00205_html_a00663"><div class="ttname"><a href="a00205.html#a00663">MPIVariables</a></div><div class="ttdoc">Structure of MPI-related variables. </div><div class="ttdef"><b>Definition:</b> <a href="a00205_source.html#l00024">mpivars_struct.h:24</a></div></div>
<div class="ttc" id="a00202_html_aab84e51d0d957c60e7890c1d96c4579b"><div class="ttname"><a href="a00202.html#aab84e51d0d957c60e7890c1d96c4579b">HyPar::StageBoundaryBuffer</a></div><div class="ttdeci">double * StageBoundaryBuffer</div><div class="ttdef"><b>Definition:</b> <a href="a00238_source.html#l00457">hypar.h:457</a></div></div>
<div class="ttc" id="a00202_html_a983929b7b1511ff3e7800597adef6a91"><div class="ttname"><a href="a00202.html#a983929b7b1511ff3e7800597adef6a91">HyPar::fluxI</a></div><div class="ttdeci">double * fluxI</div><div class="ttdef"><b>Definition:</b> <a href="a00238_source.html#l00136">hypar.h:136</a></div></div>
<div class="ttc" id="a00202_html_aee7ff3b51db01ee6ed4038ff5311ed24"><div class="ttname"><a href="a00202.html#aee7ff3b51db01ee6ed4038ff5311ed24">HyPar::fluxC</a></div><div class="ttdeci">double * fluxC</div><div class="ttdef"><b>Definition:</b> <a href="a00238_source.html#l00128">hypar.h:128</a></div></div>
<div class="ttc" id="a00202_html_a992b70a21ce15afa8e06a4e3997cab8b"><div class="ttname"><a href="a00202.html#a992b70a21ce15afa8e06a4e3997cab8b">HyPar::gpu_iblank</a></div><div class="ttdeci">double * gpu_iblank</div><div class="ttdef"><b>Definition:</b> <a href="a00238_source.html#l00451">hypar.h:451</a></div></div>
<div class="ttc" id="a00202_html_ae83b1b0117b6a805ead2e4728945814c"><div class="ttname"><a href="a00202.html#ae83b1b0117b6a805ead2e4728945814c">HyPar::flag_ib</a></div><div class="ttdeci">int flag_ib</div><div class="ttdef"><b>Definition:</b> <a href="a00238_source.html#l00436">hypar.h:436</a></div></div>
<div class="ttc" id="a00202_html_afeeb150a9699ade5eccc7589fcae3fe0"><div class="ttname"><a href="a00202.html#afeeb150a9699ade5eccc7589fcae3fe0">HyPar::SetInterpLimiterVar</a></div><div class="ttdeci">int(* SetInterpLimiterVar)(double *, double *, double *, int, void *, void *)</div><div class="ttdef"><b>Definition:</b> <a href="a00238_source.html#l00229">hypar.h:229</a></div></div>
<div class="ttc" id="a00202_html"><div class="ttname"><a href="a00202.html">HyPar</a></div><div class="ttdoc">Structure containing all solver-specific variables and functions. </div><div class="ttdef"><b>Definition:</b> <a href="a00238_source.html#l00023">hypar.h:23</a></div></div>
<div class="ttc" id="a00232_html_aceca9611b1e048e233f2d9cc02f70796"><div class="ttname"><a href="a00232.html#aceca9611b1e048e233f2d9cc02f70796">GPU_THREADS_PER_BLOCK</a></div><div class="ttdeci">#define GPU_THREADS_PER_BLOCK</div><div class="ttdef"><b>Definition:</b> <a href="a00232_source.html#l00007">basic_gpu.h:7</a></div></div>
<div class="ttc" id="a00202_html_a5de5f995ed280640a28ef2cee85b5877"><div class="ttname"><a href="a00202.html#a5de5f995ed280640a28ef2cee85b5877">HyPar::gpu_npoints_boundary_offset</a></div><div class="ttdeci">int gpu_npoints_boundary_offset[3]</div><div class="ttdef"><b>Definition:</b> <a href="a00238_source.html#l00447">hypar.h:447</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="aa9bbe45f664e0a173a109d10b3614c62"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int InitializeSolvers </td>
          <td>(</td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>s</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>nsims</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>This function initializes all solvers-specific function pointers depending on user input. The specific functions used for spatial discretization, time integration, and solution output are set here. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">s</td><td>Array of simulation objects of type <a class="el" href="a00218.html#a00667" title="Structure defining a simulation. ">SimulationObject</a> </td></tr>
    <tr><td class="paramname">nsims</td><td>number of simulation objects </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="a00598_source.html#l00048">48</a> of file <a class="el" href="a00598_source.html">InitializeSolvers.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;{</div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;  <a class="code" href="a00218.html#a00667">SimulationObject</a> *sim = (<a class="code" href="a00218.html#a00667">SimulationObject</a>*) s;</div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;  <span class="keywordtype">int</span> ns;</div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;  <a class="code" href="a00231.html#a68f50121fb9a7daeaf60e50cdef82ef3">_DECLARE_IERR_</a>;</div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;</div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;  <span class="keywordflow">if</span> (nsims == 0) <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;</div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;  <span class="keywordflow">if</span> (!sim[0].mpi.rank) {</div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;    printf(<span class="stringliteral">&quot;Initializing solvers.\n&quot;</span>);</div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;  }</div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;</div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;  <span class="keywordflow">for</span> (ns = 0; ns &lt; nsims; ns++) {</div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;</div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;    <a class="code" href="a00202.html">HyPar</a>           *solver   = &amp;(sim[ns].<a class="code" href="a00218.html#a523947ce4fa7128c4c767163953253b9">solver</a>);</div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;    <a class="code" href="a00205.html#a00663">MPIVariables</a>    *mpi      = &amp;(sim[ns].<a class="code" href="a00218.html#a4afd2c7b3eb8fda452474ebdbe71c8c0">mpi</a>);</div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;</div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;    solver-&gt;<a class="code" href="a00202.html#aa4de7bdc1e62417caf51b9c45184268d">ApplyBoundaryConditions</a> = <a class="code" href="a00302.html#ab68722a270954b6816a785ad4923ba45">ApplyBoundaryConditions</a>;</div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;    solver-&gt;<a class="code" href="a00202.html#a83d97dfc50e6bfefd0db6503d365d5bd">ApplyIBConditions</a> = <a class="code" href="a00303.html#a63bad563b5163bdada0672cec6d535c0">ApplyIBConditions</a>;</div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;    solver-&gt;<a class="code" href="a00202.html#a662e256e081a2b74f971d02c747892b8">SourceFunction</a> = <a class="code" href="a00319.html#a930d3b66826111c93dc222f5f6382744">SourceFunction</a>;</div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;<span class="preprocessor">#if defined(HAVE_CUDA)</span></div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;<span class="preprocessor"></span>    <span class="keywordflow">if</span> (solver-&gt;<a class="code" href="a00202.html#ae4ab67b8e83747d09dc53c42e218eb4e">use_gpu</a>) {</div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;      solver-&gt;<a class="code" href="a00202.html#aa245f8c9e6af37e47c5867dccbbc208b">HyperbolicFunction</a> = <a class="code" href="a00311.html#a1e78fb9da89089d6cc5837ab14916e7f">gpuHyperbolicFunction</a>;</div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;<span class="preprocessor"></span>      solver-&gt;<a class="code" href="a00202.html#aa245f8c9e6af37e47c5867dccbbc208b">HyperbolicFunction</a> = <a class="code" href="a00310.html#a0096c47175c007dbe805b34129835b84">HyperbolicFunction</a>;</div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;<span class="preprocessor">#if defined(HAVE_CUDA)</span></div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;<span class="preprocessor"></span>    }</div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;<span class="preprocessor"></span>    solver-&gt;<a class="code" href="a00202.html#a0fda913c8c0424880302e9296cc0e813">VolumeIntegralFunction</a>      = <a class="code" href="a00320.html#a74a4527b7a6060acc1808d9c945b117f">VolumeIntegral</a>;</div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;    solver-&gt;<a class="code" href="a00202.html#a479abc98a0ca73359a33089ba5d37863">BoundaryIntegralFunction</a>    = <a class="code" href="a00304.html#abf698222199fe88976002228400c428d">BoundaryIntegral</a>;</div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;    solver-&gt;<a class="code" href="a00202.html#a2108550c80e1666f11c684fcb4f1ca89">CalculateConservationError</a>  = <a class="code" href="a00305.html#aef9a903e2e2870dbadbae56ab1b62eb7">CalculateConservationError</a>;</div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;    solver-&gt;<a class="code" href="a00202.html#a228697ae6a0f0fe7a928a9ddad45da54">NonlinearInterp</a>             = <a class="code" href="a00313.html#af2e57e55724c44c535903d432a9d6193">NonLinearInterpolation</a>;</div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;</div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;    <span class="comment">/* choose the type of parabolic discretization */</span></div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;    solver-&gt;<a class="code" href="a00202.html#a75e8be4ea8c1ae2e99fc1e802e69a573">ParabolicFunction</a>         = NULL;</div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;    solver-&gt;<a class="code" href="a00202.html#a4b350316573a1d93caf01c5f1d43a45f">SecondDerivativePar</a>       = NULL;</div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;    solver-&gt;<a class="code" href="a00202.html#add4554e1a8a541607b867db7ec38d7a9">FirstDerivativePar</a>        = NULL;</div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;    solver-&gt;<a class="code" href="a00202.html#a13a0f9420009a55a3689f407a2c8efea">InterpolateInterfacesPar</a>  = NULL;</div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;</div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;<span class="preprocessor">#if defined(HAVE_CUDA)</span></div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;<span class="preprocessor"></span>    <span class="keywordflow">if</span> (solver-&gt;<a class="code" href="a00202.html#ae4ab67b8e83747d09dc53c42e218eb4e">use_gpu</a>) {</div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;</div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;      <span class="keywordflow">if</span> (!strcmp(solver-&gt;<a class="code" href="a00202.html#ad45d57b33d578bf602574a221bf53d93">spatial_type_par</a>,<a class="code" href="a00238.html#a9f4de86b900c9aa5f097c2746e17612a">_NC_2STAGE_</a>)) {</div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;  </div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;        solver-&gt;<a class="code" href="a00202.html#a75e8be4ea8c1ae2e99fc1e802e69a573">ParabolicFunction</a> = <a class="code" href="a00317.html#a153eb91ec9b118a7b8c971facbc8d920">ParabolicFunctionNC2Stage</a>;</div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;</div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;        <span class="keywordflow">if</span> (!strcmp(solver-&gt;<a class="code" href="a00202.html#a170f2f6cc8ac86b78fcb376c2392e290">spatial_scheme_par</a>,<a class="code" href="a00237.html#aac4d00dd8bef7592948a7e563021c02a">_FOURTH_ORDER_CENTRAL_</a>)) {</div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;          solver-&gt;<a class="code" href="a00202.html#add4554e1a8a541607b867db7ec38d7a9">FirstDerivativePar</a> = <a class="code" href="a00237.html#a343e390144d16452cc790099e69e6c47">gpuFirstDerivativeFourthOrderCentral</a>;</div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;          fprintf(stderr,<span class="stringliteral">&quot;ERROR (domain %d): scheme %s is not supported on GPU!&quot;</span>,</div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;                  ns, solver-&gt;<a class="code" href="a00202.html#a170f2f6cc8ac86b78fcb376c2392e290">spatial_scheme_par</a>);</div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;          <span class="keywordflow">return</span> 1;</div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;        }</div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;  </div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;      }</div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;</div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;<span class="preprocessor"></span></div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;      <span class="keywordflow">if</span> (!strcmp(solver-&gt;<a class="code" href="a00202.html#ad45d57b33d578bf602574a221bf53d93">spatial_type_par</a>,<a class="code" href="a00238.html#a18ee8cd9b4297a259b08aa4cdfe30aa1">_NC_1STAGE_</a>)) {</div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;  </div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;        solver-&gt;<a class="code" href="a00202.html#a75e8be4ea8c1ae2e99fc1e802e69a573">ParabolicFunction</a> = <a class="code" href="a00316.html#a2faa78314e07ca739b7652ceb22ef083">ParabolicFunctionNC1Stage</a>;</div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;        <span class="keywordflow">if</span> (!strcmp(solver-&gt;<a class="code" href="a00202.html#a170f2f6cc8ac86b78fcb376c2392e290">spatial_scheme_par</a>,<a class="code" href="a00237.html#a89694dcc7c48314c98b9636759bb8bee">_SECOND_ORDER_CENTRAL_</a>)) {</div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;          solver-&gt;<a class="code" href="a00202.html#a4b350316573a1d93caf01c5f1d43a45f">SecondDerivativePar</a>      = <a class="code" href="a00259.html#a36b168a9f6846e2b4bc027989c8f3e65">SecondDerivativeSecondOrderCentral</a>;</div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;        } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcmp(solver-&gt;<a class="code" href="a00202.html#a170f2f6cc8ac86b78fcb376c2392e290">spatial_scheme_par</a>,<a class="code" href="a00237.html#aac4d00dd8bef7592948a7e563021c02a">_FOURTH_ORDER_CENTRAL_</a>)) {</div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;          solver-&gt;<a class="code" href="a00202.html#a4b350316573a1d93caf01c5f1d43a45f">SecondDerivativePar</a>      = <a class="code" href="a00259.html#a7fa2be45147cb91831760e66b631e15c">SecondDerivativeFourthOrderCentral</a>;</div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;          fprintf(stderr,<span class="stringliteral">&quot;Error (domain %d): %s is not a supported &quot;</span>,</div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;                  ns, solver-&gt;<a class="code" href="a00202.html#a170f2f6cc8ac86b78fcb376c2392e290">spatial_scheme_par</a>);</div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;          fprintf(stderr,<span class="stringliteral">&quot;spatial scheme of type %s for the parabolic terms.\n&quot;</span>,</div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;                  solver-&gt;<a class="code" href="a00202.html#ad45d57b33d578bf602574a221bf53d93">spatial_type_par</a>);</div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;        }</div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;  </div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;      } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcmp(solver-&gt;<a class="code" href="a00202.html#ad45d57b33d578bf602574a221bf53d93">spatial_type_par</a>,<a class="code" href="a00238.html#a9f4de86b900c9aa5f097c2746e17612a">_NC_2STAGE_</a>)) {</div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;  </div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;        solver-&gt;<a class="code" href="a00202.html#a75e8be4ea8c1ae2e99fc1e802e69a573">ParabolicFunction</a> = <a class="code" href="a00317.html#a153eb91ec9b118a7b8c971facbc8d920">ParabolicFunctionNC2Stage</a>;</div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;        <span class="keywordflow">if</span> (!strcmp(solver-&gt;<a class="code" href="a00202.html#a170f2f6cc8ac86b78fcb376c2392e290">spatial_scheme_par</a>,<a class="code" href="a00237.html#a89694dcc7c48314c98b9636759bb8bee">_SECOND_ORDER_CENTRAL_</a>)) {</div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;          solver-&gt;<a class="code" href="a00202.html#add4554e1a8a541607b867db7ec38d7a9">FirstDerivativePar</a>       = <a class="code" href="a00237.html#ad06a8db0245d2502016fb6c7b77ef37f">FirstDerivativeFirstOrder</a>;</div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;          <span class="comment">/* why first order? see ParabolicFunctionNC2Stage.c. 2nd order central</span></div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;<span class="comment">             approximation to the 2nd derivative can be expressed as a conjugation</span></div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;<span class="comment">             of 1st order approximations to the 1st derivative (one forward and</span></div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;<span class="comment">             one backward) -- this prevents odd-even decoupling */</span></div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;        } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcmp(solver-&gt;<a class="code" href="a00202.html#a170f2f6cc8ac86b78fcb376c2392e290">spatial_scheme_par</a>,<a class="code" href="a00237.html#aac4d00dd8bef7592948a7e563021c02a">_FOURTH_ORDER_CENTRAL_</a>)) {</div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;          solver-&gt;<a class="code" href="a00202.html#add4554e1a8a541607b867db7ec38d7a9">FirstDerivativePar</a>       = <a class="code" href="a00237.html#a08c28e6bc4493172df7b7867e1f3d815">FirstDerivativeFourthOrderCentral</a>;</div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;          <span class="comment">/* why 4th order? I could not derive the decomposition of the</span></div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;<span class="comment">             4th order central approximation to the 2nd derivative! Some problems</span></div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;<span class="comment">             may show odd-even decoupling */</span></div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;          fprintf(stderr,<span class="stringliteral">&quot;Error (domain %d): %s is not a supported &quot;</span>,</div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;                  ns, solver-&gt;<a class="code" href="a00202.html#a170f2f6cc8ac86b78fcb376c2392e290">spatial_scheme_par</a>);</div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;          fprintf(stderr,<span class="stringliteral">&quot;spatial scheme of type %s for the parabolic terms.\n&quot;</span>,</div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;                solver-&gt;<a class="code" href="a00202.html#ad45d57b33d578bf602574a221bf53d93">spatial_type_par</a>);</div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;        }</div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;  </div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;      } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcmp(solver-&gt;<a class="code" href="a00202.html#ad45d57b33d578bf602574a221bf53d93">spatial_type_par</a>,<a class="code" href="a00238.html#a7bc6f9c42df5610bc5d844ad95c74fb8">_NC_1_5STAGE_</a>)) {</div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;  </div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;        solver-&gt;<a class="code" href="a00202.html#a75e8be4ea8c1ae2e99fc1e802e69a573">ParabolicFunction</a> = <a class="code" href="a00315.html#af9331a439bf243524c027eba50fdbbfd">ParabolicFunctionNC1_5Stage</a>;</div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;        <span class="keywordflow">if</span> (!strcmp(solver-&gt;<a class="code" href="a00202.html#a170f2f6cc8ac86b78fcb376c2392e290">spatial_scheme_par</a>,<a class="code" href="a00237.html#a89694dcc7c48314c98b9636759bb8bee">_SECOND_ORDER_CENTRAL_</a>)) {</div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;          solver-&gt;<a class="code" href="a00202.html#add4554e1a8a541607b867db7ec38d7a9">FirstDerivativePar</a>       = <a class="code" href="a00237.html#a27d213967bae3d2b969d07a967525541">FirstDerivativeSecondOrderCentral</a>;</div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;          solver-&gt;<a class="code" href="a00202.html#a4b350316573a1d93caf01c5f1d43a45f">SecondDerivativePar</a>      = <a class="code" href="a00259.html#a36b168a9f6846e2b4bc027989c8f3e65">SecondDerivativeSecondOrderCentral</a>;</div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;        } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcmp(solver-&gt;<a class="code" href="a00202.html#a170f2f6cc8ac86b78fcb376c2392e290">spatial_scheme_par</a>,<a class="code" href="a00237.html#aac4d00dd8bef7592948a7e563021c02a">_FOURTH_ORDER_CENTRAL_</a>)) {</div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;          solver-&gt;<a class="code" href="a00202.html#add4554e1a8a541607b867db7ec38d7a9">FirstDerivativePar</a>       = <a class="code" href="a00237.html#a08c28e6bc4493172df7b7867e1f3d815">FirstDerivativeFourthOrderCentral</a>;</div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;          solver-&gt;<a class="code" href="a00202.html#a4b350316573a1d93caf01c5f1d43a45f">SecondDerivativePar</a>      = <a class="code" href="a00259.html#a7fa2be45147cb91831760e66b631e15c">SecondDerivativeFourthOrderCentral</a>;</div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;          fprintf(stderr,<span class="stringliteral">&quot;Error (domain %d): %s is not a supported &quot;</span>,</div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;                  ns, solver-&gt;<a class="code" href="a00202.html#a170f2f6cc8ac86b78fcb376c2392e290">spatial_scheme_par</a>);</div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;          fprintf(stderr,<span class="stringliteral">&quot;spatial scheme of type %s for the parabolic terms.\n&quot;</span>,</div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;                solver-&gt;<a class="code" href="a00202.html#ad45d57b33d578bf602574a221bf53d93">spatial_type_par</a>);</div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;        }</div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;  </div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;      } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcmp(solver-&gt;<a class="code" href="a00202.html#ad45d57b33d578bf602574a221bf53d93">spatial_type_par</a>,<a class="code" href="a00238.html#aabd653aa5d489ae2d0d8140290f6f026">_CONS_1STAGE_</a>)) {</div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;  </div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;        solver-&gt;<a class="code" href="a00202.html#a75e8be4ea8c1ae2e99fc1e802e69a573">ParabolicFunction</a> = <a class="code" href="a00314.html#a5e79cc5efd6d3e4c93717a67e0fbf918">ParabolicFunctionCons1Stage</a>;</div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;        <span class="keywordflow">if</span> (!strcmp(solver-&gt;<a class="code" href="a00202.html#a170f2f6cc8ac86b78fcb376c2392e290">spatial_scheme_par</a>,<a class="code" href="a00237.html#a89694dcc7c48314c98b9636759bb8bee">_SECOND_ORDER_CENTRAL_</a>)) {</div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;          solver-&gt;<a class="code" href="a00202.html#a13a0f9420009a55a3689f407a2c8efea">InterpolateInterfacesPar</a> = <a class="code" href="a00191.html#ae8bfe856abd743f5af925dc03e708ee3">Interp2PrimSecondOrder</a>;</div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;          fprintf(stderr,<span class="stringliteral">&quot;Error (domain %d): %s is not a supported &quot;</span>,</div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;                  ns, solver-&gt;<a class="code" href="a00202.html#a170f2f6cc8ac86b78fcb376c2392e290">spatial_scheme_par</a>);</div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;          fprintf(stderr,<span class="stringliteral">&quot;spatial scheme of type %s for the parabolic terms.\n&quot;</span>,</div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;                solver-&gt;<a class="code" href="a00202.html#ad45d57b33d578bf602574a221bf53d93">spatial_type_par</a>);</div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;        }</div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;  </div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;      } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;  </div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;        fprintf(stderr,<span class="stringliteral">&quot;Error (domain %d): %s is not a supported &quot;</span>,</div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;                ns, solver-&gt;<a class="code" href="a00202.html#ad45d57b33d578bf602574a221bf53d93">spatial_type_par</a>);</div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;        fprintf(stderr,<span class="stringliteral">&quot;spatial discretization type for the parabolic terms.\n&quot;</span>);</div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;        <span class="keywordflow">return</span>(1);</div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;  </div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;      }</div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;</div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;<span class="preprocessor">#if defined(HAVE_CUDA)</span></div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;<span class="preprocessor"></span>    }</div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;<span class="preprocessor"></span></div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;    <span class="comment">/* Spatial interpolation for hyperbolic term */</span></div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;    solver-&gt;<a class="code" href="a00202.html#a29c46b81ad574e4dfbad5a7211487dcb">interp</a>                = NULL;</div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;    solver-&gt;<a class="code" href="a00202.html#a56318721d534e74a96b440f8542a0232">compact</a>               = NULL;</div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;    solver-&gt;<a class="code" href="a00202.html#a1dbfa1e479a373073b6ebf72401a7f0f">lusolver</a>              = NULL;</div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;    solver-&gt;<a class="code" href="a00202.html#afeeb150a9699ade5eccc7589fcae3fe0">SetInterpLimiterVar</a>   = NULL;</div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;    solver-&gt;<a class="code" href="a00202.html#a9a61d44b50cc9043a19bdc3c0f591d99">flag_nonlinearinterp</a>  = 1;</div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;    <span class="keywordflow">if</span> (strcmp(solver-&gt;<a class="code" href="a00202.html#a9591ba0fadb863561474e2ba251d2594">interp_type</a>,<a class="code" href="a00191.html#aa7752b40155314f9f2c063d4d9d8339d">_CHARACTERISTIC_</a>) &amp;&amp; strcmp(solver-&gt;<a class="code" href="a00202.html#a9591ba0fadb863561474e2ba251d2594">interp_type</a>,<a class="code" href="a00191.html#ac1f614645aa891fde12c0ce4354de45d">_COMPONENTS_</a>)) {</div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;      fprintf(stderr,<span class="stringliteral">&quot;Error in InitializeSolvers() (domain %d): %s is not a &quot;</span>,</div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;              ns, solver-&gt;<a class="code" href="a00202.html#a9591ba0fadb863561474e2ba251d2594">interp_type</a>);</div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;      fprintf(stderr,<span class="stringliteral">&quot;supported interpolation type.\n&quot;</span>);</div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;      <span class="keywordflow">return</span>(1);</div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;    }</div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;</div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;<span class="preprocessor">#if defined(HAVE_CUDA)</span></div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;<span class="preprocessor"></span>    <span class="keywordflow">if</span> (solver-&gt;<a class="code" href="a00202.html#ae4ab67b8e83747d09dc53c42e218eb4e">use_gpu</a>) {</div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;</div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;      <span class="keywordflow">if</span> (!strcmp(solver-&gt;<a class="code" href="a00202.html#ad29846eeb9c83b329a8d7c1fe69d46b2">spatial_scheme_hyp</a>,<a class="code" href="a00191.html#acfeff1b158131390b7129f4a857b15ff">_FIFTH_ORDER_WENO_</a>)) {</div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;  </div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;        <span class="comment">/* Fifth order WENO scheme */</span></div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;        <span class="keywordflow">if</span> ((solver-&gt;<a class="code" href="a00202.html#ae8f6d2fd6490d3153cb4133bf183a404">nvars</a> &gt; 1) &amp;&amp; (!strcmp(solver-&gt;<a class="code" href="a00202.html#a9591ba0fadb863561474e2ba251d2594">interp_type</a>,<a class="code" href="a00191.html#aa7752b40155314f9f2c063d4d9d8339d">_CHARACTERISTIC_</a>))) {</div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;          fprintf(stderr,</div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;                  <span class="stringliteral">&quot;Error (domain %d): characteristic-based WENO5 is not yet implemented on GPUs.\n&quot;</span>,</div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;                  ns );</div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;          <span class="keywordflow">return</span> 1;</div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;          solver-&gt;<a class="code" href="a00202.html#a17e1cfc7de4fe33c6ee88f2cc42883e7">InterpolateInterfacesHyp</a> = <a class="code" href="a00191.html#ad39d37cc5b7241e8f9178d61c32d9832">gpuInterp1PrimFifthOrderWENO</a>;</div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;        }</div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;        solver-&gt;<a class="code" href="a00202.html#a29c46b81ad574e4dfbad5a7211487dcb">interp</a> = (<a class="code" href="a00191.html#a00670">WENOParameters</a>*) calloc(1,<span class="keyword">sizeof</span>(<a class="code" href="a00191.html#a00670">WENOParameters</a>));</div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;        <a class="code" href="a00231.html#ad6ab74942c9de13cf0b4c12eb0d91780">IERR</a> <a class="code" href="a00191.html#aecbe557b2ccc254cdbbd312fc91717be">WENOInitialize</a>(solver,mpi,solver-&gt;<a class="code" href="a00202.html#ad29846eeb9c83b329a8d7c1fe69d46b2">spatial_scheme_hyp</a>,solver-&gt;<a class="code" href="a00202.html#a9591ba0fadb863561474e2ba251d2594">interp_type</a>); <a class="code" href="a00231.html#add9cf96ae374934d245a1dc1ab697a42">CHECKERR</a>(ierr);</div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;        solver-&gt;<a class="code" href="a00202.html#a9a61d44b50cc9043a19bdc3c0f591d99">flag_nonlinearinterp</a> = !(((<a class="code" href="a00191.html#a00670">WENOParameters</a>*)solver-&gt;<a class="code" href="a00202.html#a29c46b81ad574e4dfbad5a7211487dcb">interp</a>)-&gt;no_limiting);</div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;  </div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;      } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;</div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;        fprintf(stderr,</div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;                <span class="stringliteral">&quot;Error (domain %d): %s is a not a supported spatial interpolation scheme on GPUs.\n&quot;</span>,</div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;                ns, solver-&gt;<a class="code" href="a00202.html#ad29846eeb9c83b329a8d7c1fe69d46b2">spatial_scheme_hyp</a>);</div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;        <span class="keywordflow">return</span> 1;</div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;      }</div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;</div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;<span class="preprocessor"></span></div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;      <span class="keywordflow">if</span> (!strcmp(solver-&gt;<a class="code" href="a00202.html#ad29846eeb9c83b329a8d7c1fe69d46b2">spatial_scheme_hyp</a>,<a class="code" href="a00191.html#a19cc54d502757bfed14b373b443f144c">_FIRST_ORDER_UPWIND_</a>)) {</div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;  </div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;        <span class="comment">/* First order upwind scheme */</span></div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;        <span class="keywordflow">if</span> ((solver-&gt;<a class="code" href="a00202.html#ae8f6d2fd6490d3153cb4133bf183a404">nvars</a> &gt; 1) &amp;&amp; (!strcmp(solver-&gt;<a class="code" href="a00202.html#a9591ba0fadb863561474e2ba251d2594">interp_type</a>,<a class="code" href="a00191.html#aa7752b40155314f9f2c063d4d9d8339d">_CHARACTERISTIC_</a>))) {</div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;          solver-&gt;<a class="code" href="a00202.html#a17e1cfc7de4fe33c6ee88f2cc42883e7">InterpolateInterfacesHyp</a> = <a class="code" href="a00191.html#a759e07ba8a484c2c6971fc7c6a81a95a">Interp1PrimFirstOrderUpwindChar</a>;</div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;          solver-&gt;<a class="code" href="a00202.html#a17e1cfc7de4fe33c6ee88f2cc42883e7">InterpolateInterfacesHyp</a> = <a class="code" href="a00191.html#a0a067c9c4745556845b9bcb7f049b59b">Interp1PrimFirstOrderUpwind</a>;</div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;        }</div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;  </div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;      } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcmp(solver-&gt;<a class="code" href="a00202.html#ad29846eeb9c83b329a8d7c1fe69d46b2">spatial_scheme_hyp</a>,<a class="code" href="a00237.html#a89694dcc7c48314c98b9636759bb8bee">_SECOND_ORDER_CENTRAL_</a>)) {</div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;  </div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;        <span class="comment">/* Second order central scheme */</span></div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;        <span class="keywordflow">if</span> ((solver-&gt;<a class="code" href="a00202.html#ae8f6d2fd6490d3153cb4133bf183a404">nvars</a> &gt; 1) &amp;&amp; (!strcmp(solver-&gt;<a class="code" href="a00202.html#a9591ba0fadb863561474e2ba251d2594">interp_type</a>,<a class="code" href="a00191.html#aa7752b40155314f9f2c063d4d9d8339d">_CHARACTERISTIC_</a>))) {</div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;          solver-&gt;<a class="code" href="a00202.html#a17e1cfc7de4fe33c6ee88f2cc42883e7">InterpolateInterfacesHyp</a> = <a class="code" href="a00191.html#a963c82116a2a1d6084af3d519b61b896">Interp1PrimSecondOrderCentralChar</a>;</div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;          solver-&gt;<a class="code" href="a00202.html#a17e1cfc7de4fe33c6ee88f2cc42883e7">InterpolateInterfacesHyp</a> = <a class="code" href="a00191.html#a697d5c94aa331054c5286492e7fa39c7">Interp1PrimSecondOrderCentral</a>;</div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;        }</div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;  </div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;      } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcmp(solver-&gt;<a class="code" href="a00202.html#ad29846eeb9c83b329a8d7c1fe69d46b2">spatial_scheme_hyp</a>,<a class="code" href="a00191.html#a32a14b9aa17be670a383e3d539da2afa">_SECOND_ORDER_MUSCL_</a>)) {</div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;  </div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;        <span class="comment">/* Second order MUSCL scheme */</span></div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;        <span class="keywordflow">if</span> ((solver-&gt;<a class="code" href="a00202.html#ae8f6d2fd6490d3153cb4133bf183a404">nvars</a> &gt; 1) &amp;&amp; (!strcmp(solver-&gt;<a class="code" href="a00202.html#a9591ba0fadb863561474e2ba251d2594">interp_type</a>,<a class="code" href="a00191.html#aa7752b40155314f9f2c063d4d9d8339d">_CHARACTERISTIC_</a>))) {</div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;          solver-&gt;<a class="code" href="a00202.html#a17e1cfc7de4fe33c6ee88f2cc42883e7">InterpolateInterfacesHyp</a> = <a class="code" href="a00191.html#a9cde00a0c916f0cda162b1c03d3f7b6b">Interp1PrimSecondOrderMUSCLChar</a>;</div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;          solver-&gt;<a class="code" href="a00202.html#a17e1cfc7de4fe33c6ee88f2cc42883e7">InterpolateInterfacesHyp</a> = <a class="code" href="a00191.html#a25df96c0eccca13167d28045d187db36">Interp1PrimSecondOrderMUSCL</a>;</div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;        }</div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;        solver-&gt;<a class="code" href="a00202.html#a29c46b81ad574e4dfbad5a7211487dcb">interp</a> = (<a class="code" href="a00206.html">MUSCLParameters</a>*) calloc(1,<span class="keyword">sizeof</span>(<a class="code" href="a00206.html">MUSCLParameters</a>));</div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;        <a class="code" href="a00231.html#ad6ab74942c9de13cf0b4c12eb0d91780">IERR</a> <a class="code" href="a00191.html#a22e0ae19117192cae9978a7a741d15a5">MUSCLInitialize</a>(solver,mpi); <a class="code" href="a00231.html#add9cf96ae374934d245a1dc1ab697a42">CHECKERR</a>(ierr);</div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;  </div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;      } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcmp(solver-&gt;<a class="code" href="a00202.html#ad29846eeb9c83b329a8d7c1fe69d46b2">spatial_scheme_hyp</a>,<a class="code" href="a00191.html#a21f7f383e497570fcb71c43f243539d3">_THIRD_ORDER_MUSCL_</a>)) {</div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;  </div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;        <span class="comment">/* Third order MUSCL scheme */</span></div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;        <span class="keywordflow">if</span> ((solver-&gt;<a class="code" href="a00202.html#ae8f6d2fd6490d3153cb4133bf183a404">nvars</a> &gt; 1) &amp;&amp; (!strcmp(solver-&gt;<a class="code" href="a00202.html#a9591ba0fadb863561474e2ba251d2594">interp_type</a>,<a class="code" href="a00191.html#aa7752b40155314f9f2c063d4d9d8339d">_CHARACTERISTIC_</a>))) {</div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;          solver-&gt;<a class="code" href="a00202.html#a17e1cfc7de4fe33c6ee88f2cc42883e7">InterpolateInterfacesHyp</a> = <a class="code" href="a00191.html#a985d08c4fb9bcb71875c697f9e00d6eb">Interp1PrimThirdOrderMUSCLChar</a>;</div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;          solver-&gt;<a class="code" href="a00202.html#a17e1cfc7de4fe33c6ee88f2cc42883e7">InterpolateInterfacesHyp</a> = <a class="code" href="a00191.html#ae7eb6a81a164ca0fa2ace3cab2697847">Interp1PrimThirdOrderMUSCL</a>;</div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;        }</div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;        solver-&gt;<a class="code" href="a00202.html#a29c46b81ad574e4dfbad5a7211487dcb">interp</a> = (<a class="code" href="a00206.html">MUSCLParameters</a>*) calloc(1,<span class="keyword">sizeof</span>(<a class="code" href="a00206.html">MUSCLParameters</a>));</div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;        <a class="code" href="a00231.html#ad6ab74942c9de13cf0b4c12eb0d91780">IERR</a> <a class="code" href="a00191.html#a22e0ae19117192cae9978a7a741d15a5">MUSCLInitialize</a>(solver,mpi); <a class="code" href="a00231.html#add9cf96ae374934d245a1dc1ab697a42">CHECKERR</a>(ierr);</div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;  </div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;      } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcmp(solver-&gt;<a class="code" href="a00202.html#ad29846eeb9c83b329a8d7c1fe69d46b2">spatial_scheme_hyp</a>,<a class="code" href="a00237.html#aac4d00dd8bef7592948a7e563021c02a">_FOURTH_ORDER_CENTRAL_</a>)) {</div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;  </div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;        <span class="comment">/* Fourth order central scheme */</span></div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;        <span class="keywordflow">if</span> ((solver-&gt;<a class="code" href="a00202.html#ae8f6d2fd6490d3153cb4133bf183a404">nvars</a> &gt; 1) &amp;&amp; (!strcmp(solver-&gt;<a class="code" href="a00202.html#a9591ba0fadb863561474e2ba251d2594">interp_type</a>,<a class="code" href="a00191.html#aa7752b40155314f9f2c063d4d9d8339d">_CHARACTERISTIC_</a>))) {</div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;          solver-&gt;<a class="code" href="a00202.html#a17e1cfc7de4fe33c6ee88f2cc42883e7">InterpolateInterfacesHyp</a> = <a class="code" href="a00191.html#aa59d0f26584fa405034c2eac2e338c94">Interp1PrimFourthOrderCentralChar</a>;</div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;          solver-&gt;<a class="code" href="a00202.html#a17e1cfc7de4fe33c6ee88f2cc42883e7">InterpolateInterfacesHyp</a> = <a class="code" href="a00191.html#a98098e68334c1a9cabe5b721aa8fbe59">Interp1PrimFourthOrderCentral</a>;</div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;        }</div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;  </div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;      } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcmp(solver-&gt;<a class="code" href="a00202.html#ad29846eeb9c83b329a8d7c1fe69d46b2">spatial_scheme_hyp</a>,<a class="code" href="a00191.html#a7bc4a755992e5f68efe365591b7a2c02">_FIFTH_ORDER_UPWIND_</a>)) {</div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;  </div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;        <span class="comment">/* Fifth order upwind scheme */</span></div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;        <span class="keywordflow">if</span> ((solver-&gt;<a class="code" href="a00202.html#ae8f6d2fd6490d3153cb4133bf183a404">nvars</a> &gt; 1) &amp;&amp; (!strcmp(solver-&gt;<a class="code" href="a00202.html#a9591ba0fadb863561474e2ba251d2594">interp_type</a>,<a class="code" href="a00191.html#aa7752b40155314f9f2c063d4d9d8339d">_CHARACTERISTIC_</a>))) {</div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;          solver-&gt;<a class="code" href="a00202.html#a17e1cfc7de4fe33c6ee88f2cc42883e7">InterpolateInterfacesHyp</a> = <a class="code" href="a00191.html#ade9ece6e934d70cdf29090494440f505">Interp1PrimFifthOrderUpwindChar</a>;</div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;          solver-&gt;<a class="code" href="a00202.html#a17e1cfc7de4fe33c6ee88f2cc42883e7">InterpolateInterfacesHyp</a> = <a class="code" href="a00191.html#aea7c973ffe0c37bca0703c1bf6175aaa">Interp1PrimFifthOrderUpwind</a>;</div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;        }</div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;  </div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;      } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcmp(solver-&gt;<a class="code" href="a00202.html#ad29846eeb9c83b329a8d7c1fe69d46b2">spatial_scheme_hyp</a>,<a class="code" href="a00191.html#ae832e2314ee85139cec9df4ea82aafa2">_FIFTH_ORDER_COMPACT_UPWIND_</a>)) {</div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;  </div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;        <span class="comment">/* Fifth order compact upwind scheme */</span></div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;        <span class="keywordflow">if</span> ((solver-&gt;<a class="code" href="a00202.html#ae8f6d2fd6490d3153cb4133bf183a404">nvars</a> &gt; 1) &amp;&amp; (!strcmp(solver-&gt;<a class="code" href="a00202.html#a9591ba0fadb863561474e2ba251d2594">interp_type</a>,<a class="code" href="a00191.html#aa7752b40155314f9f2c063d4d9d8339d">_CHARACTERISTIC_</a>))) {</div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;          solver-&gt;<a class="code" href="a00202.html#a17e1cfc7de4fe33c6ee88f2cc42883e7">InterpolateInterfacesHyp</a> = <a class="code" href="a00191.html#a28b8d3ce17676cec19de4f91f989042d">Interp1PrimFifthOrderCompactUpwindChar</a>;</div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;          solver-&gt;<a class="code" href="a00202.html#a17e1cfc7de4fe33c6ee88f2cc42883e7">InterpolateInterfacesHyp</a> = <a class="code" href="a00191.html#a3ac2a77b9fa5a50499c285e49cf91344">Interp1PrimFifthOrderCompactUpwind</a>;</div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;        }</div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;        solver-&gt;<a class="code" href="a00202.html#a56318721d534e74a96b440f8542a0232">compact</a> = (<a class="code" href="a00191.html#a00650">CompactScheme</a>*) calloc(1,<span class="keyword">sizeof</span>(<a class="code" href="a00191.html#a00650">CompactScheme</a>));</div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;        <a class="code" href="a00231.html#ad6ab74942c9de13cf0b4c12eb0d91780">IERR</a> <a class="code" href="a00191.html#af255a582e14c5820cf12f9f95b4e28fd">CompactSchemeInitialize</a>(solver,mpi,solver-&gt;<a class="code" href="a00202.html#a9591ba0fadb863561474e2ba251d2594">interp_type</a>);</div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;        solver-&gt;<a class="code" href="a00202.html#a1dbfa1e479a373073b6ebf72401a7f0f">lusolver</a> = (<a class="code" href="a00222.html#a00668">TridiagLU</a>*) calloc (1,<span class="keyword">sizeof</span>(<a class="code" href="a00222.html#a00668">TridiagLU</a>));</div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;        <a class="code" href="a00231.html#ad6ab74942c9de13cf0b4c12eb0d91780">IERR</a> <a class="code" href="a00222.html#a52d21dfe1d76916811879bf0d7a29d72">tridiagLUInit</a>(solver-&gt;<a class="code" href="a00202.html#a1dbfa1e479a373073b6ebf72401a7f0f">lusolver</a>,&amp;mpi-&gt;<a class="code" href="a00205.html#adad7a6f85831f3ac84d854b6c80aef43">world</a>);<a class="code" href="a00231.html#add9cf96ae374934d245a1dc1ab697a42">CHECKERR</a>(ierr);</div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;  </div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;      } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcmp(solver-&gt;<a class="code" href="a00202.html#ad29846eeb9c83b329a8d7c1fe69d46b2">spatial_scheme_hyp</a>,<a class="code" href="a00191.html#acfeff1b158131390b7129f4a857b15ff">_FIFTH_ORDER_WENO_</a>)) {</div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;  </div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;        <span class="comment">/* Fifth order WENO scheme */</span></div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;        <span class="keywordflow">if</span> ((solver-&gt;<a class="code" href="a00202.html#ae8f6d2fd6490d3153cb4133bf183a404">nvars</a> &gt; 1) &amp;&amp; (!strcmp(solver-&gt;<a class="code" href="a00202.html#a9591ba0fadb863561474e2ba251d2594">interp_type</a>,<a class="code" href="a00191.html#aa7752b40155314f9f2c063d4d9d8339d">_CHARACTERISTIC_</a>))) {</div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;          solver-&gt;<a class="code" href="a00202.html#a17e1cfc7de4fe33c6ee88f2cc42883e7">InterpolateInterfacesHyp</a> = <a class="code" href="a00191.html#abf3b032fdc8c0e84b86909db9e0b93c3">Interp1PrimFifthOrderWENOChar</a>;</div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;          solver-&gt;<a class="code" href="a00202.html#a17e1cfc7de4fe33c6ee88f2cc42883e7">InterpolateInterfacesHyp</a> = <a class="code" href="a00191.html#af2195885ad055989a1b2b11655843343">Interp1PrimFifthOrderWENO</a>;</div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;        }</div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;        solver-&gt;<a class="code" href="a00202.html#a29c46b81ad574e4dfbad5a7211487dcb">interp</a> = (<a class="code" href="a00191.html#a00670">WENOParameters</a>*) calloc(1,<span class="keyword">sizeof</span>(<a class="code" href="a00191.html#a00670">WENOParameters</a>));</div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;        <a class="code" href="a00231.html#ad6ab74942c9de13cf0b4c12eb0d91780">IERR</a> <a class="code" href="a00191.html#aecbe557b2ccc254cdbbd312fc91717be">WENOInitialize</a>(solver,mpi,solver-&gt;<a class="code" href="a00202.html#ad29846eeb9c83b329a8d7c1fe69d46b2">spatial_scheme_hyp</a>,solver-&gt;<a class="code" href="a00202.html#a9591ba0fadb863561474e2ba251d2594">interp_type</a>); <a class="code" href="a00231.html#add9cf96ae374934d245a1dc1ab697a42">CHECKERR</a>(ierr);</div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;        solver-&gt;<a class="code" href="a00202.html#a9a61d44b50cc9043a19bdc3c0f591d99">flag_nonlinearinterp</a> = !(((<a class="code" href="a00191.html#a00670">WENOParameters</a>*)solver-&gt;<a class="code" href="a00202.html#a29c46b81ad574e4dfbad5a7211487dcb">interp</a>)-&gt;no_limiting);</div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;  </div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;      } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcmp(solver-&gt;<a class="code" href="a00202.html#ad29846eeb9c83b329a8d7c1fe69d46b2">spatial_scheme_hyp</a>,<a class="code" href="a00191.html#a175a82b8ae2b24c0ba51e1b1dd68c0e5">_FIFTH_ORDER_CRWENO_</a>)) {</div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;  </div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;        <span class="comment">/* Fifth order CRWENO scheme */</span></div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;        <span class="keywordflow">if</span> ((solver-&gt;<a class="code" href="a00202.html#ae8f6d2fd6490d3153cb4133bf183a404">nvars</a> &gt; 1) &amp;&amp; (!strcmp(solver-&gt;<a class="code" href="a00202.html#a9591ba0fadb863561474e2ba251d2594">interp_type</a>,<a class="code" href="a00191.html#aa7752b40155314f9f2c063d4d9d8339d">_CHARACTERISTIC_</a>))) {</div>
<div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;          solver-&gt;<a class="code" href="a00202.html#a17e1cfc7de4fe33c6ee88f2cc42883e7">InterpolateInterfacesHyp</a> = <a class="code" href="a00191.html#ae2b27971cc952cf3b4959128bef6174b">Interp1PrimFifthOrderCRWENOChar</a>;</div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;          solver-&gt;<a class="code" href="a00202.html#a17e1cfc7de4fe33c6ee88f2cc42883e7">InterpolateInterfacesHyp</a> = <a class="code" href="a00191.html#a33b1e24c12129941b0027a83c543a654">Interp1PrimFifthOrderCRWENO</a>;</div>
<div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;        }</div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;        solver-&gt;<a class="code" href="a00202.html#a29c46b81ad574e4dfbad5a7211487dcb">interp</a> = (<a class="code" href="a00191.html#a00670">WENOParameters</a>*) calloc(1,<span class="keyword">sizeof</span>(<a class="code" href="a00191.html#a00670">WENOParameters</a>));</div>
<div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;        <a class="code" href="a00231.html#ad6ab74942c9de13cf0b4c12eb0d91780">IERR</a> <a class="code" href="a00191.html#aecbe557b2ccc254cdbbd312fc91717be">WENOInitialize</a>(solver,mpi,solver-&gt;<a class="code" href="a00202.html#ad29846eeb9c83b329a8d7c1fe69d46b2">spatial_scheme_hyp</a>,solver-&gt;<a class="code" href="a00202.html#a9591ba0fadb863561474e2ba251d2594">interp_type</a>); <a class="code" href="a00231.html#add9cf96ae374934d245a1dc1ab697a42">CHECKERR</a>(ierr);</div>
<div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;        solver-&gt;<a class="code" href="a00202.html#a9a61d44b50cc9043a19bdc3c0f591d99">flag_nonlinearinterp</a> = !(((<a class="code" href="a00191.html#a00670">WENOParameters</a>*)solver-&gt;<a class="code" href="a00202.html#a29c46b81ad574e4dfbad5a7211487dcb">interp</a>)-&gt;no_limiting);</div>
<div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;        solver-&gt;<a class="code" href="a00202.html#a56318721d534e74a96b440f8542a0232">compact</a> = (<a class="code" href="a00191.html#a00650">CompactScheme</a>*) calloc(1,<span class="keyword">sizeof</span>(<a class="code" href="a00191.html#a00650">CompactScheme</a>));</div>
<div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;        <a class="code" href="a00231.html#ad6ab74942c9de13cf0b4c12eb0d91780">IERR</a> <a class="code" href="a00191.html#af255a582e14c5820cf12f9f95b4e28fd">CompactSchemeInitialize</a>(solver,mpi,solver-&gt;<a class="code" href="a00202.html#a9591ba0fadb863561474e2ba251d2594">interp_type</a>);</div>
<div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;        solver-&gt;<a class="code" href="a00202.html#a1dbfa1e479a373073b6ebf72401a7f0f">lusolver</a> = (<a class="code" href="a00222.html#a00668">TridiagLU</a>*) calloc (1,<span class="keyword">sizeof</span>(<a class="code" href="a00222.html#a00668">TridiagLU</a>));</div>
<div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;        <a class="code" href="a00231.html#ad6ab74942c9de13cf0b4c12eb0d91780">IERR</a> <a class="code" href="a00222.html#a52d21dfe1d76916811879bf0d7a29d72">tridiagLUInit</a>(solver-&gt;<a class="code" href="a00202.html#a1dbfa1e479a373073b6ebf72401a7f0f">lusolver</a>,&amp;mpi-&gt;<a class="code" href="a00205.html#adad7a6f85831f3ac84d854b6c80aef43">world</a>);<a class="code" href="a00231.html#add9cf96ae374934d245a1dc1ab697a42">CHECKERR</a>(ierr);</div>
<div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;  </div>
<div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;      } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcmp(solver-&gt;<a class="code" href="a00202.html#ad29846eeb9c83b329a8d7c1fe69d46b2">spatial_scheme_hyp</a>,<a class="code" href="a00191.html#a6d34f5e8aae80a0d2a27ea20368dfef1">_FIFTH_ORDER_HCWENO_</a>)) {</div>
<div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;  </div>
<div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;        <span class="comment">/* Fifth order HCWENO scheme */</span></div>
<div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;        <span class="keywordflow">if</span> ((solver-&gt;<a class="code" href="a00202.html#ae8f6d2fd6490d3153cb4133bf183a404">nvars</a> &gt; 1) &amp;&amp; (!strcmp(solver-&gt;<a class="code" href="a00202.html#a9591ba0fadb863561474e2ba251d2594">interp_type</a>,<a class="code" href="a00191.html#aa7752b40155314f9f2c063d4d9d8339d">_CHARACTERISTIC_</a>))) {</div>
<div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;          solver-&gt;<a class="code" href="a00202.html#a17e1cfc7de4fe33c6ee88f2cc42883e7">InterpolateInterfacesHyp</a> = <a class="code" href="a00191.html#a91fbe118c8c01fe1d5efa3cea4930589">Interp1PrimFifthOrderHCWENOChar</a>;</div>
<div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;          solver-&gt;<a class="code" href="a00202.html#a17e1cfc7de4fe33c6ee88f2cc42883e7">InterpolateInterfacesHyp</a> = <a class="code" href="a00191.html#ad9c611137cfce1c622c2e9838fb523c8">Interp1PrimFifthOrderHCWENO</a>;</div>
<div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;        }</div>
<div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;        solver-&gt;<a class="code" href="a00202.html#a29c46b81ad574e4dfbad5a7211487dcb">interp</a> = (<a class="code" href="a00191.html#a00670">WENOParameters</a>*) calloc(1,<span class="keyword">sizeof</span>(<a class="code" href="a00191.html#a00670">WENOParameters</a>));</div>
<div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;        <a class="code" href="a00231.html#ad6ab74942c9de13cf0b4c12eb0d91780">IERR</a> <a class="code" href="a00191.html#aecbe557b2ccc254cdbbd312fc91717be">WENOInitialize</a>(solver,mpi,solver-&gt;<a class="code" href="a00202.html#ad29846eeb9c83b329a8d7c1fe69d46b2">spatial_scheme_hyp</a>,solver-&gt;<a class="code" href="a00202.html#a9591ba0fadb863561474e2ba251d2594">interp_type</a>); <a class="code" href="a00231.html#add9cf96ae374934d245a1dc1ab697a42">CHECKERR</a>(ierr);</div>
<div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;        solver-&gt;<a class="code" href="a00202.html#a9a61d44b50cc9043a19bdc3c0f591d99">flag_nonlinearinterp</a> = !(((<a class="code" href="a00191.html#a00670">WENOParameters</a>*)solver-&gt;<a class="code" href="a00202.html#a29c46b81ad574e4dfbad5a7211487dcb">interp</a>)-&gt;no_limiting);</div>
<div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;        solver-&gt;<a class="code" href="a00202.html#a56318721d534e74a96b440f8542a0232">compact</a> = (<a class="code" href="a00191.html#a00650">CompactScheme</a>*) calloc(1,<span class="keyword">sizeof</span>(<a class="code" href="a00191.html#a00650">CompactScheme</a>));</div>
<div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;        <a class="code" href="a00231.html#ad6ab74942c9de13cf0b4c12eb0d91780">IERR</a> <a class="code" href="a00191.html#af255a582e14c5820cf12f9f95b4e28fd">CompactSchemeInitialize</a>(solver,mpi,solver-&gt;<a class="code" href="a00202.html#a9591ba0fadb863561474e2ba251d2594">interp_type</a>);</div>
<div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;        solver-&gt;<a class="code" href="a00202.html#a1dbfa1e479a373073b6ebf72401a7f0f">lusolver</a> = (<a class="code" href="a00222.html#a00668">TridiagLU</a>*) calloc (1,<span class="keyword">sizeof</span>(<a class="code" href="a00222.html#a00668">TridiagLU</a>));</div>
<div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;        <a class="code" href="a00231.html#ad6ab74942c9de13cf0b4c12eb0d91780">IERR</a> <a class="code" href="a00222.html#a52d21dfe1d76916811879bf0d7a29d72">tridiagLUInit</a>(solver-&gt;<a class="code" href="a00202.html#a1dbfa1e479a373073b6ebf72401a7f0f">lusolver</a>,&amp;mpi-&gt;<a class="code" href="a00205.html#adad7a6f85831f3ac84d854b6c80aef43">world</a>);<a class="code" href="a00231.html#add9cf96ae374934d245a1dc1ab697a42">CHECKERR</a>(ierr);</div>
<div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;  </div>
<div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;      } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;</div>
<div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;        fprintf(stderr,<span class="stringliteral">&quot;Error (domain %d): %s is a not a supported spatial interpolation scheme.\n&quot;</span>,</div>
<div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;                ns, solver-&gt;<a class="code" href="a00202.html#ad29846eeb9c83b329a8d7c1fe69d46b2">spatial_scheme_hyp</a>);</div>
<div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;        <span class="keywordflow">return</span>(1);</div>
<div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;      }</div>
<div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;</div>
<div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;<span class="preprocessor">#if defined(HAVE_CUDA)</span></div>
<div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;<span class="preprocessor"></span>    }</div>
<div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;<span class="preprocessor"></span></div>
<div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;    <span class="comment">/* Time integration */</span></div>
<div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;    solver-&gt;<a class="code" href="a00202.html#a1d36fea92472416e32e039b86dea0b18">time_integrator</a> = NULL;</div>
<div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;<span class="preprocessor">#ifdef with_petsc</span></div>
<div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;<span class="preprocessor"></span>    <span class="keywordflow">if</span> (solver-&gt;<a class="code" href="a00202.html#ad195de8c64c407718e42cda9246be0d2">use_petscTS</a>) {</div>
<div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;      <span class="comment">/* dummy -- not used */</span></div>
<div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;      solver-&gt;<a class="code" href="a00202.html#a7de550a63022232e0039dc46a08114b0">TimeIntegrate</a> = <a class="code" href="a00265.html#a5fe3d9828c6afcbc00cf6fdd940ebe4b">TimeForwardEuler</a>;</div>
<div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;      solver-&gt;<a class="code" href="a00202.html#adec095311615891040de11341c01a77f">msti</a> = NULL;</div>
<div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;      <span class="keywordflow">if</span> (!strcmp(solver-&gt;<a class="code" href="a00202.html#a138e751362d14724df8e6ab27c4a5e55">time_scheme</a>,<a class="code" href="a00197.html#af9b1e641532cff8859c5c5a8377f5feb">_FORWARD_EULER_</a>)) {</div>
<div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;        solver-&gt;<a class="code" href="a00202.html#a7de550a63022232e0039dc46a08114b0">TimeIntegrate</a> = <a class="code" href="a00265.html#a5fe3d9828c6afcbc00cf6fdd940ebe4b">TimeForwardEuler</a>;</div>
<div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;        solver-&gt;<a class="code" href="a00202.html#adec095311615891040de11341c01a77f">msti</a> = NULL;</div>
<div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;      } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcmp(solver-&gt;<a class="code" href="a00202.html#a138e751362d14724df8e6ab27c4a5e55">time_scheme</a>,<a class="code" href="a00197.html#a50d4bf1e7e4825cc062fca99a770e5ce">_RK_</a>)) {</div>
<div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;        solver-&gt;<a class="code" href="a00202.html#a7de550a63022232e0039dc46a08114b0">TimeIntegrate</a> = <a class="code" href="a00265.html#aca6ebec6e6998f0c509bb38fa91f3321">TimeRK</a>;</div>
<div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;        solver-&gt;<a class="code" href="a00202.html#adec095311615891040de11341c01a77f">msti</a> = (<a class="code" href="a00197.html#a00652">ExplicitRKParameters</a>*) calloc (1,<span class="keyword">sizeof</span>(<a class="code" href="a00197.html#a00652">ExplicitRKParameters</a>));</div>
<div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;        <a class="code" href="a00231.html#ad6ab74942c9de13cf0b4c12eb0d91780">IERR</a> <a class="code" href="a00265.html#a966855c31cad0395c350b9a77add7ab8">TimeExplicitRKInitialize</a>(solver-&gt;<a class="code" href="a00202.html#a138e751362d14724df8e6ab27c4a5e55">time_scheme</a>,solver-&gt;<a class="code" href="a00202.html#a61750696383420ba8bcc7d9e44a538e2">time_scheme_type</a>,</div>
<div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;                                      solver-&gt;<a class="code" href="a00202.html#adec095311615891040de11341c01a77f">msti</a>,mpi); <a class="code" href="a00231.html#add9cf96ae374934d245a1dc1ab697a42">CHECKERR</a>(ierr);</div>
<div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;      } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcmp(solver-&gt;<a class="code" href="a00202.html#a138e751362d14724df8e6ab27c4a5e55">time_scheme</a>,<a class="code" href="a00197.html#aad9619c099daeb3e6b1b7ef9e03e38d8">_GLM_GEE_</a>)) {</div>
<div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;        solver-&gt;<a class="code" href="a00202.html#a7de550a63022232e0039dc46a08114b0">TimeIntegrate</a> = <a class="code" href="a00265.html#a7b76988ab950d39d505042dc1f09b875">TimeGLMGEE</a>;</div>
<div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;        solver-&gt;<a class="code" href="a00202.html#adec095311615891040de11341c01a77f">msti</a> = (<a class="code" href="a00197.html#a00659">GLMGEEParameters</a>*) calloc (1,<span class="keyword">sizeof</span>(<a class="code" href="a00197.html#a00659">GLMGEEParameters</a>));</div>
<div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;        <a class="code" href="a00231.html#ad6ab74942c9de13cf0b4c12eb0d91780">IERR</a> <a class="code" href="a00265.html#ad7d778f0d388a120492e4901c3319d51">TimeGLMGEEInitialize</a>(solver-&gt;<a class="code" href="a00202.html#a138e751362d14724df8e6ab27c4a5e55">time_scheme</a>,solver-&gt;<a class="code" href="a00202.html#a61750696383420ba8bcc7d9e44a538e2">time_scheme_type</a>,</div>
<div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;                                  solver-&gt;<a class="code" href="a00202.html#adec095311615891040de11341c01a77f">msti</a>,mpi); <a class="code" href="a00231.html#add9cf96ae374934d245a1dc1ab697a42">CHECKERR</a>(ierr);</div>
<div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;      } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;        fprintf(stderr,<span class="stringliteral">&quot;Error (domain %d): %s is a not a supported time-integration scheme.\n&quot;</span>,</div>
<div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;                ns, solver-&gt;<a class="code" href="a00202.html#a138e751362d14724df8e6ab27c4a5e55">time_scheme</a>);</div>
<div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;        <span class="keywordflow">return</span>(1);</div>
<div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;      }</div>
<div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;    }</div>
<div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;<span class="preprocessor">#else</span></div>
<div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;<span class="preprocessor"></span>    <span class="keywordflow">if</span> (!strcmp(solver-&gt;<a class="code" href="a00202.html#a138e751362d14724df8e6ab27c4a5e55">time_scheme</a>,<a class="code" href="a00197.html#af9b1e641532cff8859c5c5a8377f5feb">_FORWARD_EULER_</a>)) {</div>
<div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;      solver-&gt;<a class="code" href="a00202.html#a7de550a63022232e0039dc46a08114b0">TimeIntegrate</a> = <a class="code" href="a00265.html#a5fe3d9828c6afcbc00cf6fdd940ebe4b">TimeForwardEuler</a>;</div>
<div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;      solver-&gt;<a class="code" href="a00202.html#adec095311615891040de11341c01a77f">msti</a> = NULL;</div>
<div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcmp(solver-&gt;<a class="code" href="a00202.html#a138e751362d14724df8e6ab27c4a5e55">time_scheme</a>,<a class="code" href="a00197.html#a50d4bf1e7e4825cc062fca99a770e5ce">_RK_</a>)) {</div>
<div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;      solver-&gt;<a class="code" href="a00202.html#a7de550a63022232e0039dc46a08114b0">TimeIntegrate</a> = <a class="code" href="a00265.html#aca6ebec6e6998f0c509bb38fa91f3321">TimeRK</a>;</div>
<div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;      solver-&gt;<a class="code" href="a00202.html#adec095311615891040de11341c01a77f">msti</a> = (<a class="code" href="a00197.html#a00652">ExplicitRKParameters</a>*) calloc (1,<span class="keyword">sizeof</span>(<a class="code" href="a00197.html#a00652">ExplicitRKParameters</a>));</div>
<div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;      <a class="code" href="a00231.html#ad6ab74942c9de13cf0b4c12eb0d91780">IERR</a> <a class="code" href="a00265.html#a966855c31cad0395c350b9a77add7ab8">TimeExplicitRKInitialize</a>(solver-&gt;<a class="code" href="a00202.html#a138e751362d14724df8e6ab27c4a5e55">time_scheme</a>,solver-&gt;<a class="code" href="a00202.html#a61750696383420ba8bcc7d9e44a538e2">time_scheme_type</a>,</div>
<div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;                                    solver-&gt;<a class="code" href="a00202.html#adec095311615891040de11341c01a77f">msti</a>,mpi); <a class="code" href="a00231.html#add9cf96ae374934d245a1dc1ab697a42">CHECKERR</a>(ierr);</div>
<div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcmp(solver-&gt;<a class="code" href="a00202.html#a138e751362d14724df8e6ab27c4a5e55">time_scheme</a>,<a class="code" href="a00197.html#aad9619c099daeb3e6b1b7ef9e03e38d8">_GLM_GEE_</a>)) {</div>
<div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;      solver-&gt;<a class="code" href="a00202.html#a7de550a63022232e0039dc46a08114b0">TimeIntegrate</a> = <a class="code" href="a00265.html#a7b76988ab950d39d505042dc1f09b875">TimeGLMGEE</a>;</div>
<div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;      solver-&gt;<a class="code" href="a00202.html#adec095311615891040de11341c01a77f">msti</a> = (<a class="code" href="a00197.html#a00659">GLMGEEParameters</a>*) calloc (1,<span class="keyword">sizeof</span>(<a class="code" href="a00197.html#a00659">GLMGEEParameters</a>));</div>
<div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;      <a class="code" href="a00231.html#ad6ab74942c9de13cf0b4c12eb0d91780">IERR</a> <a class="code" href="a00265.html#ad7d778f0d388a120492e4901c3319d51">TimeGLMGEEInitialize</a>(solver-&gt;<a class="code" href="a00202.html#a138e751362d14724df8e6ab27c4a5e55">time_scheme</a>,solver-&gt;<a class="code" href="a00202.html#a61750696383420ba8bcc7d9e44a538e2">time_scheme_type</a>,</div>
<div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;                                solver-&gt;<a class="code" href="a00202.html#adec095311615891040de11341c01a77f">msti</a>,mpi); <a class="code" href="a00231.html#add9cf96ae374934d245a1dc1ab697a42">CHECKERR</a>(ierr);</div>
<div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;      fprintf(stderr,<span class="stringliteral">&quot;Error (domain %d): %s is a not a supported time-integration scheme.\n&quot;</span>,</div>
<div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;              ns, solver-&gt;<a class="code" href="a00202.html#a138e751362d14724df8e6ab27c4a5e55">time_scheme</a>);</div>
<div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;      <span class="keywordflow">return</span>(1);</div>
<div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;    }</div>
<div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;<span class="preprocessor"></span></div>
<div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;    <span class="comment">/* Solution output function */</span></div>
<div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;    solver-&gt;<a class="code" href="a00202.html#a9018a1befab4079332620f40375a9661">WriteOutput</a>    = NULL; <span class="comment">/* default - no output */</span></div>
<div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;    solver-&gt;<a class="code" href="a00202.html#a0805db42e429173752189696c3c96909">filename_index</a> = NULL;</div>
<div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;    strcpy(solver-&gt;<a class="code" href="a00202.html#a2f63f9a875bb76e6107cb2e7c725d935">op_fname_root</a>, <span class="stringliteral">&quot;op&quot;</span>);</div>
<div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;<span class="preprocessor">#ifdef with_librom</span></div>
<div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;<span class="preprocessor"></span>    strcpy(solver-&gt;<a class="code" href="a00202.html#af5db0aad0268af0ba82e1281d44bb73a">op_rom_fname_root</a>, <span class="stringliteral">&quot;op_rom&quot;</span>);</div>
<div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;<span class="preprocessor"></span>    strcpy(solver-&gt;<a class="code" href="a00202.html#a5d741833915983fdcb695f262a73ae7e">aux_op_fname_root</a>, <span class="stringliteral">&quot;ts0&quot;</span>);</div>
<div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;    <span class="keywordflow">if</span> (!strcmp(solver-&gt;<a class="code" href="a00202.html#a5f89e286a9eaffdb66d966fa6a290d3f">output_mode</a>,<span class="stringliteral">&quot;serial&quot;</span>)) {</div>
<div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;      solver-&gt;<a class="code" href="a00202.html#af474ca4577de91b658e4399ad0a6d7b3">index_length</a> = 5;</div>
<div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;      solver-&gt;<a class="code" href="a00202.html#a0805db42e429173752189696c3c96909">filename_index</a> = (<span class="keywordtype">char</span>*) calloc (solver-&gt;<a class="code" href="a00202.html#af474ca4577de91b658e4399ad0a6d7b3">index_length</a>+1,<span class="keyword">sizeof</span>(<span class="keywordtype">char</span>));</div>
<div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;      <span class="keywordtype">int</span> i; <span class="keywordflow">for</span> (i=0; i&lt;solver-&gt;<a class="code" href="a00202.html#af474ca4577de91b658e4399ad0a6d7b3">index_length</a>; i++) solver-&gt;<a class="code" href="a00202.html#a0805db42e429173752189696c3c96909">filename_index</a>[i] = <span class="charliteral">&#39;0&#39;</span>;</div>
<div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;      solver-&gt;<a class="code" href="a00202.html#a0805db42e429173752189696c3c96909">filename_index</a>[solver-&gt;<a class="code" href="a00202.html#af474ca4577de91b658e4399ad0a6d7b3">index_length</a>] = (<span class="keywordtype">char</span>) 0;</div>
<div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;      <span class="keywordflow">if</span> (!strcmp(solver-&gt;<a class="code" href="a00202.html#a51a3b8c19b86e9e1df5be02b05a6613c">op_file_format</a>,<span class="stringliteral">&quot;text&quot;</span>)) {</div>
<div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;        solver-&gt;<a class="code" href="a00202.html#a9018a1befab4079332620f40375a9661">WriteOutput</a> = <a class="code" href="a00239.html#a3355a71faf3d87f6715ad627db08ac9e">WriteText</a>;</div>
<div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;        strcpy(solver-&gt;<a class="code" href="a00202.html#a25f6a0c8fded2ee6bd9593c737bc3a51">solnfilename_extn</a>,<span class="stringliteral">&quot;.dat&quot;</span>);</div>
<div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;      } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcmp(solver-&gt;<a class="code" href="a00202.html#a51a3b8c19b86e9e1df5be02b05a6613c">op_file_format</a>,<span class="stringliteral">&quot;tecplot2d&quot;</span>)) {</div>
<div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;        solver-&gt;<a class="code" href="a00202.html#a9018a1befab4079332620f40375a9661">WriteOutput</a> = <a class="code" href="a00239.html#a265b0583afb79edd2f2f5d5087e5c3bf">WriteTecplot2D</a>;</div>
<div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;        strcpy(solver-&gt;<a class="code" href="a00202.html#a25f6a0c8fded2ee6bd9593c737bc3a51">solnfilename_extn</a>,<span class="stringliteral">&quot;.dat&quot;</span>);</div>
<div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;      } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcmp(solver-&gt;<a class="code" href="a00202.html#a51a3b8c19b86e9e1df5be02b05a6613c">op_file_format</a>,<span class="stringliteral">&quot;tecplot3d&quot;</span>)) {</div>
<div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;        solver-&gt;<a class="code" href="a00202.html#a9018a1befab4079332620f40375a9661">WriteOutput</a> = <a class="code" href="a00239.html#a5bdb048ecc5ae7ab61622e4764f3133e">WriteTecplot3D</a>;</div>
<div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;        strcpy(solver-&gt;<a class="code" href="a00202.html#a25f6a0c8fded2ee6bd9593c737bc3a51">solnfilename_extn</a>,<span class="stringliteral">&quot;.dat&quot;</span>);</div>
<div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;      } <span class="keywordflow">else</span> <span class="keywordflow">if</span> ((!strcmp(solver-&gt;<a class="code" href="a00202.html#a51a3b8c19b86e9e1df5be02b05a6613c">op_file_format</a>,<span class="stringliteral">&quot;binary&quot;</span>)) || (!strcmp(solver-&gt;<a class="code" href="a00202.html#a51a3b8c19b86e9e1df5be02b05a6613c">op_file_format</a>,<span class="stringliteral">&quot;bin&quot;</span>))) {</div>
<div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;        solver-&gt;<a class="code" href="a00202.html#a9018a1befab4079332620f40375a9661">WriteOutput</a> = <a class="code" href="a00239.html#a067f454c26d85d6cfb4d7d878b3783c9">WriteBinary</a>;</div>
<div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;        strcpy(solver-&gt;<a class="code" href="a00202.html#a25f6a0c8fded2ee6bd9593c737bc3a51">solnfilename_extn</a>,<span class="stringliteral">&quot;.bin&quot;</span>);</div>
<div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;      } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcmp(solver-&gt;<a class="code" href="a00202.html#a51a3b8c19b86e9e1df5be02b05a6613c">op_file_format</a>,<span class="stringliteral">&quot;none&quot;</span>)) {</div>
<div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;        solver-&gt;<a class="code" href="a00202.html#a9018a1befab4079332620f40375a9661">WriteOutput</a> = NULL;</div>
<div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;      } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;        fprintf(stderr,<span class="stringliteral">&quot;Error (domain %d): %s is not a supported file format.\n&quot;</span>,</div>
<div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;                ns, solver-&gt;<a class="code" href="a00202.html#a51a3b8c19b86e9e1df5be02b05a6613c">op_file_format</a>);</div>
<div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;        <span class="keywordflow">return</span>(1);</div>
<div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;      }</div>
<div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;      <span class="keywordflow">if</span> ((!strcmp(solver-&gt;<a class="code" href="a00202.html#a4e93cb107e180ef982b74cef7726b70f">op_overwrite</a>,<span class="stringliteral">&quot;no&quot;</span>)) &amp;&amp; solver-&gt;<a class="code" href="a00202.html#aafb41b96563d9966e8e9f458751f2960">restart_iter</a>) {</div>
<div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;        <span class="comment">/* if it&#39;s a restart run, fast-forward the filename */</span></div>
<div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;        <span class="keywordtype">int</span> t;</div>
<div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;        <span class="keywordflow">for</span> (t=0; t&lt;solver-&gt;<a class="code" href="a00202.html#aafb41b96563d9966e8e9f458751f2960">restart_iter</a>; t++)</div>
<div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;          <span class="keywordflow">if</span> ((t+1)%solver-&gt;<a class="code" href="a00202.html#a6ff746b30ee55a3bbb9f3306c145f27a">file_op_iter</a> == 0) <a class="code" href="a00312.html#a9fda82ed752188f3af821e2c30f63c21">IncrementFilenameIndex</a>(solver-&gt;<a class="code" href="a00202.html#a0805db42e429173752189696c3c96909">filename_index</a>,solver-&gt;<a class="code" href="a00202.html#af474ca4577de91b658e4399ad0a6d7b3">index_length</a>);</div>
<div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;      }</div>
<div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcmp(solver-&gt;<a class="code" href="a00202.html#a5f89e286a9eaffdb66d966fa6a290d3f">output_mode</a>,<span class="stringliteral">&quot;parallel&quot;</span>)) {</div>
<div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;      <span class="keywordflow">if</span> (!strcmp(solver-&gt;<a class="code" href="a00202.html#a51a3b8c19b86e9e1df5be02b05a6613c">op_file_format</a>,<span class="stringliteral">&quot;none&quot;</span>)) solver-&gt;<a class="code" href="a00202.html#a9018a1befab4079332620f40375a9661">WriteOutput</a> = NULL;</div>
<div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;      <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;        <span class="comment">/* only binary file writing supported in parallel mode */</span></div>
<div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;        <span class="comment">/* use post-processing scripts to convert              */</span></div>
<div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;        solver-&gt;<a class="code" href="a00202.html#a9018a1befab4079332620f40375a9661">WriteOutput</a> = <a class="code" href="a00239.html#a067f454c26d85d6cfb4d7d878b3783c9">WriteBinary</a>;</div>
<div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;        strcpy(solver-&gt;<a class="code" href="a00202.html#a25f6a0c8fded2ee6bd9593c737bc3a51">solnfilename_extn</a>,<span class="stringliteral">&quot;.bin&quot;</span>);</div>
<div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;      }</div>
<div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;      fprintf(stderr,<span class="stringliteral">&quot;Error (domain %d): %s is not a supported output mode.\n&quot;</span>,</div>
<div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;              ns, solver-&gt;<a class="code" href="a00202.html#a5f89e286a9eaffdb66d966fa6a290d3f">output_mode</a>);</div>
<div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;      fprintf(stderr,<span class="stringliteral">&quot;Should be \&quot;serial\&quot; or \&quot;parallel\&quot;.    \n&quot;</span>);</div>
<div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;      <span class="keywordflow">return</span>(1);</div>
<div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;    }</div>
<div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;</div>
<div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;  }</div>
<div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;</div>
<div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;  <span class="keywordflow">return</span>(0);</div>
<div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;}</div>
<div class="ttc" id="a00202_html_add4554e1a8a541607b867db7ec38d7a9"><div class="ttname"><a href="a00202.html#add4554e1a8a541607b867db7ec38d7a9">HyPar::FirstDerivativePar</a></div><div class="ttdeci">int(* FirstDerivativePar)(double *, double *, int, int, void *, void *)</div><div class="ttdef"><b>Definition:</b> <a href="a00238_source.html#l00238">hypar.h:238</a></div></div>
<div class="ttc" id="a00202_html_ad45d57b33d578bf602574a221bf53d93"><div class="ttname"><a href="a00202.html#ad45d57b33d578bf602574a221bf53d93">HyPar::spatial_type_par</a></div><div class="ttdeci">char spatial_type_par[_MAX_STRING_SIZE_]</div><div class="ttdef"><b>Definition:</b> <a href="a00238_source.html#l00096">hypar.h:96</a></div></div>
<div class="ttc" id="a00237_html_ad06a8db0245d2502016fb6c7b77ef37f"><div class="ttname"><a href="a00237.html#ad06a8db0245d2502016fb6c7b77ef37f">FirstDerivativeFirstOrder</a></div><div class="ttdeci">int FirstDerivativeFirstOrder(double *, double *, int, int, void *, void *)</div><div class="ttdef"><b>Definition:</b> <a href="a00298_source.html#l00037">FirstDerivativeFirstOrder.c:37</a></div></div>
<div class="ttc" id="a00237_html_a08c28e6bc4493172df7b7867e1f3d815"><div class="ttname"><a href="a00237.html#a08c28e6bc4493172df7b7867e1f3d815">FirstDerivativeFourthOrderCentral</a></div><div class="ttdeci">int FirstDerivativeFourthOrderCentral(double *, double *, int, int, void *, void *)</div><div class="ttdef"><b>Definition:</b> <a href="a00299_source.html#l00036">FirstDerivativeFourthOrder.c:36</a></div></div>
<div class="ttc" id="a00202_html_af5db0aad0268af0ba82e1281d44bb73a"><div class="ttname"><a href="a00202.html#af5db0aad0268af0ba82e1281d44bb73a">HyPar::op_rom_fname_root</a></div><div class="ttdeci">char op_rom_fname_root[_MAX_STRING_SIZE_]</div><div class="ttdef"><b>Definition:</b> <a href="a00238_source.html#l00402">hypar.h:402</a></div></div>
<div class="ttc" id="a00222_html_a00668"><div class="ttname"><a href="a00222.html#a00668">TridiagLU</a></div><div class="ttdef"><b>Definition:</b> <a href="a00222_source.html#l00084">tridiagLU.h:84</a></div></div>
<div class="ttc" id="a00237_html_a27d213967bae3d2b969d07a967525541"><div class="ttname"><a href="a00237.html#a27d213967bae3d2b969d07a967525541">FirstDerivativeSecondOrderCentral</a></div><div class="ttdeci">int FirstDerivativeSecondOrderCentral(double *, double *, int, int, void *, void *)</div><div class="ttdef"><b>Definition:</b> <a href="a00301_source.html#l00036">FirstDerivativeSecondOrder.c:36</a></div></div>
<div class="ttc" id="a00202_html_a56318721d534e74a96b440f8542a0232"><div class="ttname"><a href="a00202.html#a56318721d534e74a96b440f8542a0232">HyPar::compact</a></div><div class="ttdeci">void * compact</div><div class="ttdef"><b>Definition:</b> <a href="a00238_source.html#l00359">hypar.h:359</a></div></div>
<div class="ttc" id="a00191_html_a98098e68334c1a9cabe5b721aa8fbe59"><div class="ttname"><a href="a00191.html#a98098e68334c1a9cabe5b721aa8fbe59">Interp1PrimFourthOrderCentral</a></div><div class="ttdeci">int Interp1PrimFourthOrderCentral(double *, double *, double *, double *, int, int, void *, void *, int)</div><div class="ttdoc">4th order central reconstruction (component-wise) on a uniform grid </div><div class="ttdef"><b>Definition:</b> <a href="a00349_source.html#l00062">Interp1PrimFourthOrderCentral.c:62</a></div></div>
<div class="ttc" id="a00191_html_a00670"><div class="ttname"><a href="a00191.html#a00670">WENOParameters</a></div><div class="ttdoc">Structure of variables/parameters needed by the WENO-type scheme. </div><div class="ttdef"><b>Definition:</b> <a href="a00191_source.html#l00194">interpolation.h:194</a></div></div>
<div class="ttc" id="a00191_html_a00650"><div class="ttname"><a href="a00191.html#a00650">CompactScheme</a></div><div class="ttdoc">Structure of variables/parameters needed by the compact schemes. </div><div class="ttdef"><b>Definition:</b> <a href="a00191_source.html#l00560">interpolation.h:560</a></div></div>
<div class="ttc" id="a00202_html_a9a61d44b50cc9043a19bdc3c0f591d99"><div class="ttname"><a href="a00202.html#a9a61d44b50cc9043a19bdc3c0f591d99">HyPar::flag_nonlinearinterp</a></div><div class="ttdeci">int flag_nonlinearinterp</div><div class="ttdef"><b>Definition:</b> <a href="a00238_source.html#l00406">hypar.h:406</a></div></div>
<div class="ttc" id="a00191_html_a22e0ae19117192cae9978a7a741d15a5"><div class="ttname"><a href="a00191.html#a22e0ae19117192cae9978a7a741d15a5">MUSCLInitialize</a></div><div class="ttdeci">int MUSCLInitialize(void *, void *)</div><div class="ttdef"><b>Definition:</b> <a href="a00358_source.html#l00017">MUSCLInitialize.c:17</a></div></div>
<div class="ttc" id="a00314_html_a5e79cc5efd6d3e4c93717a67e0fbf918"><div class="ttname"><a href="a00314.html#a5e79cc5efd6d3e4c93717a67e0fbf918">ParabolicFunctionCons1Stage</a></div><div class="ttdeci">int ParabolicFunctionCons1Stage(double *par, double *u, void *s, void *m, double t)</div><div class="ttdef"><b>Definition:</b> <a href="a00314_source.html#l00034">ParabolicFunctionCons1Stage.c:34</a></div></div>
<div class="ttc" id="a00191_html_ad9c611137cfce1c622c2e9838fb523c8"><div class="ttname"><a href="a00191.html#ad9c611137cfce1c622c2e9838fb523c8">Interp1PrimFifthOrderHCWENO</a></div><div class="ttdeci">int Interp1PrimFifthOrderHCWENO(double *, double *, double *, double *, int, int, void *, void *, int)</div><div class="ttdoc">5th order hybrid compact-WENO reconstruction (component-wise) on a uniform grid </div><div class="ttdef"><b>Definition:</b> <a href="a00340_source.html#l00063">Interp1PrimFifthOrderHCWENO.c:63</a></div></div>
<div class="ttc" id="a00191_html_aa7752b40155314f9f2c063d4d9d8339d"><div class="ttname"><a href="a00191.html#aa7752b40155314f9f2c063d4d9d8339d">_CHARACTERISTIC_</a></div><div class="ttdeci">#define _CHARACTERISTIC_</div><div class="ttdef"><b>Definition:</b> <a href="a00191_source.html#l00033">interpolation.h:33</a></div></div>
<div class="ttc" id="a00202_html_a170f2f6cc8ac86b78fcb376c2392e290"><div class="ttname"><a href="a00202.html#a170f2f6cc8ac86b78fcb376c2392e290">HyPar::spatial_scheme_par</a></div><div class="ttdeci">char spatial_scheme_par[_MAX_STRING_SIZE_]</div><div class="ttdef"><b>Definition:</b> <a href="a00238_source.html#l00099">hypar.h:99</a></div></div>
<div class="ttc" id="a00265_html_ad7d778f0d388a120492e4901c3319d51"><div class="ttname"><a href="a00265.html#ad7d778f0d388a120492e4901c3319d51">TimeGLMGEEInitialize</a></div><div class="ttdeci">int TimeGLMGEEInitialize(char *, char *, void *, void *)</div><div class="ttdef"><b>Definition:</b> <a href="a00631_source.html#l00024">TimeGLMGEEInitialize.c:24</a></div></div>
<div class="ttc" id="a00202_html_a9018a1befab4079332620f40375a9661"><div class="ttname"><a href="a00202.html#a9018a1befab4079332620f40375a9661">HyPar::WriteOutput</a></div><div class="ttdeci">int(* WriteOutput)(int, int, int *, double *, double *, char *, int *)</div><div class="ttdef"><b>Definition:</b> <a href="a00238_source.html#l00206">hypar.h:206</a></div></div>
<div class="ttc" id="a00218_html_a00667"><div class="ttname"><a href="a00218.html#a00667">SimulationObject</a></div><div class="ttdoc">Structure defining a simulation. </div><div class="ttdef"><b>Definition:</b> <a href="a00218_source.html#l00023">simulation_object.h:23</a></div></div>
<div class="ttc" id="a00305_html_aef9a903e2e2870dbadbae56ab1b62eb7"><div class="ttname"><a href="a00305.html#aef9a903e2e2870dbadbae56ab1b62eb7">CalculateConservationError</a></div><div class="ttdeci">int CalculateConservationError(void *s, void *m)</div><div class="ttdef"><b>Definition:</b> <a href="a00305_source.html#l00016">CalculateConservationError.c:16</a></div></div>
<div class="ttc" id="a00202_html_ae4ab67b8e83747d09dc53c42e218eb4e"><div class="ttname"><a href="a00202.html#ae4ab67b8e83747d09dc53c42e218eb4e">HyPar::use_gpu</a></div><div class="ttdeci">int use_gpu</div><div class="ttdef"><b>Definition:</b> <a href="a00238_source.html#l00444">hypar.h:444</a></div></div>
<div class="ttc" id="a00202_html_a61750696383420ba8bcc7d9e44a538e2"><div class="ttname"><a href="a00202.html#a61750696383420ba8bcc7d9e44a538e2">HyPar::time_scheme_type</a></div><div class="ttdeci">char time_scheme_type[_MAX_STRING_SIZE_]</div><div class="ttdef"><b>Definition:</b> <a href="a00238_source.html#l00081">hypar.h:81</a></div></div>
<div class="ttc" id="a00197_html_af9b1e641532cff8859c5c5a8377f5feb"><div class="ttname"><a href="a00197.html#af9b1e641532cff8859c5c5a8377f5feb">_FORWARD_EULER_</a></div><div class="ttdeci">#define _FORWARD_EULER_</div><div class="ttdef"><b>Definition:</b> <a href="a00197_source.html#l00014">timeintegration_struct.h:14</a></div></div>
<div class="ttc" id="a00197_html_aad9619c099daeb3e6b1b7ef9e03e38d8"><div class="ttname"><a href="a00197.html#aad9619c099daeb3e6b1b7ef9e03e38d8">_GLM_GEE_</a></div><div class="ttdeci">#define _GLM_GEE_</div><div class="ttdef"><b>Definition:</b> <a href="a00197_source.html#l00018">timeintegration_struct.h:18</a></div></div>
<div class="ttc" id="a00191_html_a25df96c0eccca13167d28045d187db36"><div class="ttname"><a href="a00191.html#a25df96c0eccca13167d28045d187db36">Interp1PrimSecondOrderMUSCL</a></div><div class="ttdeci">int Interp1PrimSecondOrderMUSCL(double *, double *, double *, double *, int, int, void *, void *, int)</div><div class="ttdoc">2nd order MUSCL scheme (component-wise) on a uniform grid </div><div class="ttdef"><b>Definition:</b> <a href="a00353_source.html#l00076">Interp1PrimSecondOrderMUSCL.c:76</a></div></div>
<div class="ttc" id="a00316_html_a2faa78314e07ca739b7652ceb22ef083"><div class="ttname"><a href="a00316.html#a2faa78314e07ca739b7652ceb22ef083">ParabolicFunctionNC1Stage</a></div><div class="ttdeci">int ParabolicFunctionNC1Stage(double *par, double *u, void *s, void *m, double t)</div><div class="ttdef"><b>Definition:</b> <a href="a00316_source.html#l00031">ParabolicFunctionNC1Stage.c:31</a></div></div>
<div class="ttc" id="a00191_html_a697d5c94aa331054c5286492e7fa39c7"><div class="ttname"><a href="a00191.html#a697d5c94aa331054c5286492e7fa39c7">Interp1PrimSecondOrderCentral</a></div><div class="ttdeci">int Interp1PrimSecondOrderCentral(double *, double *, double *, double *, int, int, void *, void *, int)</div><div class="ttdoc">2nd order central reconstruction (component-wise) on a uniform grid </div><div class="ttdef"><b>Definition:</b> <a href="a00351_source.html#l00062">Interp1PrimSecondOrderCentral.c:62</a></div></div>
<div class="ttc" id="a00303_html_a63bad563b5163bdada0672cec6d535c0"><div class="ttname"><a href="a00303.html#a63bad563b5163bdada0672cec6d535c0">ApplyIBConditions</a></div><div class="ttdeci">int ApplyIBConditions(void *s, void *m, double *x, double waqt)</div><div class="ttdef"><b>Definition:</b> <a href="a00303_source.html#l00014">ApplyIBConditions.c:14</a></div></div>
<div class="ttc" id="a00191_html_ad39d37cc5b7241e8f9178d61c32d9832"><div class="ttname"><a href="a00191.html#ad39d37cc5b7241e8f9178d61c32d9832">gpuInterp1PrimFifthOrderWENO</a></div><div class="ttdeci">int gpuInterp1PrimFifthOrderWENO(double *, double *, double *, double *, int, int, void *, void *, int)</div><div class="ttdoc">5th order WENO reconstruction (component-wise) on a uniform grid </div><div class="ttdef"><b>Definition:</b> <a href="a00345_source.html#l00352">Interp1PrimFifthOrderWENO_GPU.cu:352</a></div></div>
<div class="ttc" id="a00239_html_a3355a71faf3d87f6715ad627db08ac9e"><div class="ttname"><a href="a00239.html#a3355a71faf3d87f6715ad627db08ac9e">WriteText</a></div><div class="ttdeci">int WriteText(int, int, int *, double *, double *, char *, int *)</div><div class="ttdef"><b>Definition:</b> <a href="a00370_source.html#l00027">WriteText.c:27</a></div></div>
<div class="ttc" id="a00202_html_a6ff746b30ee55a3bbb9f3306c145f27a"><div class="ttname"><a href="a00202.html#a6ff746b30ee55a3bbb9f3306c145f27a">HyPar::file_op_iter</a></div><div class="ttdeci">int file_op_iter</div><div class="ttdef"><b>Definition:</b> <a href="a00238_source.html#l00171">hypar.h:171</a></div></div>
<div class="ttc" id="a00239_html_a067f454c26d85d6cfb4d7d878b3783c9"><div class="ttname"><a href="a00239.html#a067f454c26d85d6cfb4d7d878b3783c9">WriteBinary</a></div><div class="ttdeci">int WriteBinary(int, int, int *, double *, double *, char *, int *)</div><div class="ttdef"><b>Definition:</b> <a href="a00367_source.html#l00034">WriteBinary.c:34</a></div></div>
<div class="ttc" id="a00191_html_a759e07ba8a484c2c6971fc7c6a81a95a"><div class="ttname"><a href="a00191.html#a759e07ba8a484c2c6971fc7c6a81a95a">Interp1PrimFirstOrderUpwindChar</a></div><div class="ttdeci">int Interp1PrimFirstOrderUpwindChar(double *, double *, double *, double *, int, int, void *, void *, int)</div><div class="ttdoc">1st order upwind reconstruction (characteristic-based) on a uniform grid </div><div class="ttdef"><b>Definition:</b> <a href="a00348_source.html#l00077">Interp1PrimFirstOrderUpwindChar.c:77</a></div></div>
<div class="ttc" id="a00231_html_a68f50121fb9a7daeaf60e50cdef82ef3"><div class="ttname"><a href="a00231.html#a68f50121fb9a7daeaf60e50cdef82ef3">_DECLARE_IERR_</a></div><div class="ttdeci">#define _DECLARE_IERR_</div><div class="ttdef"><b>Definition:</b> <a href="a00231_source.html#l00017">basic.h:17</a></div></div>
<div class="ttc" id="a00191_html_ade9ece6e934d70cdf29090494440f505"><div class="ttname"><a href="a00191.html#ade9ece6e934d70cdf29090494440f505">Interp1PrimFifthOrderUpwindChar</a></div><div class="ttdeci">int Interp1PrimFifthOrderUpwindChar(double *, double *, double *, double *, int, int, void *, void *, int)</div><div class="ttdoc">5th order upwind reconstruction (characteristic-based) on a uniform grid </div><div class="ttdef"><b>Definition:</b> <a href="a00343_source.html#l00084">Interp1PrimFifthOrderUpwindChar.c:84</a></div></div>
<div class="ttc" id="a00191_html_a0a067c9c4745556845b9bcb7f049b59b"><div class="ttname"><a href="a00191.html#a0a067c9c4745556845b9bcb7f049b59b">Interp1PrimFirstOrderUpwind</a></div><div class="ttdeci">int Interp1PrimFirstOrderUpwind(double *, double *, double *, double *, int, int, void *, void *, int)</div><div class="ttdoc">1st order upwind reconstruction (component-wise) on a uniform grid </div><div class="ttdef"><b>Definition:</b> <a href="a00347_source.html#l00061">Interp1PrimFirstOrderUpwind.c:61</a></div></div>
<div class="ttc" id="a00310_html_a0096c47175c007dbe805b34129835b84"><div class="ttname"><a href="a00310.html#a0096c47175c007dbe805b34129835b84">HyperbolicFunction</a></div><div class="ttdeci">int HyperbolicFunction(double *hyp, double *u, void *s, void *m, double t, int LimFlag, int(*FluxFunction)(double *, double *, int, void *, double), int(*UpwindFunction)(double *, double *, double *, double *, double *, double *, int, void *, double))</div><div class="ttdef"><b>Definition:</b> <a href="a00310_source.html#l00031">HyperbolicFunction.c:31</a></div></div>
<div class="ttc" id="a00315_html_af9331a439bf243524c027eba50fdbbfd"><div class="ttname"><a href="a00315.html#af9331a439bf243524c027eba50fdbbfd">ParabolicFunctionNC1_5Stage</a></div><div class="ttdeci">int ParabolicFunctionNC1_5Stage(double *par, double *u, void *s, void *m, double t)</div><div class="ttdef"><b>Definition:</b> <a href="a00315_source.html#l00035">ParabolicFunctionNC1.5Stage.c:35</a></div></div>
<div class="ttc" id="a00191_html_a9cde00a0c916f0cda162b1c03d3f7b6b"><div class="ttname"><a href="a00191.html#a9cde00a0c916f0cda162b1c03d3f7b6b">Interp1PrimSecondOrderMUSCLChar</a></div><div class="ttdeci">int Interp1PrimSecondOrderMUSCLChar(double *, double *, double *, double *, int, int, void *, void *, int)</div><div class="ttdoc">2nd order MUSCL scheme (characteristic-based) on a uniform grid </div><div class="ttdef"><b>Definition:</b> <a href="a00354_source.html#l00092">Interp1PrimSecondOrderMUSCLChar.c:92</a></div></div>
<div class="ttc" id="a00202_html_a25f6a0c8fded2ee6bd9593c737bc3a51"><div class="ttname"><a href="a00202.html#a25f6a0c8fded2ee6bd9593c737bc3a51">HyPar::solnfilename_extn</a></div><div class="ttdeci">char solnfilename_extn[_MAX_STRING_SIZE_]</div><div class="ttdef"><b>Definition:</b> <a href="a00238_source.html#l00198">hypar.h:198</a></div></div>
<div class="ttc" id="a00191_html_a19cc54d502757bfed14b373b443f144c"><div class="ttname"><a href="a00191.html#a19cc54d502757bfed14b373b443f144c">_FIRST_ORDER_UPWIND_</a></div><div class="ttdeci">#define _FIRST_ORDER_UPWIND_</div><div class="ttdef"><b>Definition:</b> <a href="a00191_source.html#l00012">interpolation.h:12</a></div></div>
<div class="ttc" id="a00304_html_abf698222199fe88976002228400c428d"><div class="ttname"><a href="a00304.html#abf698222199fe88976002228400c428d">BoundaryIntegral</a></div><div class="ttdeci">int BoundaryIntegral(void *s, void *m)</div><div class="ttdef"><b>Definition:</b> <a href="a00304_source.html#l00017">BoundaryIntegral.c:17</a></div></div>
<div class="ttc" id="a00197_html_a50d4bf1e7e4825cc062fca99a770e5ce"><div class="ttname"><a href="a00197.html#a50d4bf1e7e4825cc062fca99a770e5ce">_RK_</a></div><div class="ttdeci">#define _RK_</div><div class="ttdef"><b>Definition:</b> <a href="a00197_source.html#l00016">timeintegration_struct.h:16</a></div></div>
<div class="ttc" id="a00238_html_a18ee8cd9b4297a259b08aa4cdfe30aa1"><div class="ttname"><a href="a00238.html#a18ee8cd9b4297a259b08aa4cdfe30aa1">_NC_1STAGE_</a></div><div class="ttdeci">#define _NC_1STAGE_</div><div class="ttdef"><b>Definition:</b> <a href="a00238_source.html#l00465">hypar.h:465</a></div></div>
<div class="ttc" id="a00202_html_a228697ae6a0f0fe7a928a9ddad45da54"><div class="ttname"><a href="a00202.html#a228697ae6a0f0fe7a928a9ddad45da54">HyPar::NonlinearInterp</a></div><div class="ttdeci">int(* NonlinearInterp)(double *, void *, void *, double, int(*)(double *, double *, int, void *, double))</div><div class="ttdef"><b>Definition:</b> <a href="a00238_source.html#l00223">hypar.h:223</a></div></div>
<div class="ttc" id="a00202_html_a51a3b8c19b86e9e1df5be02b05a6613c"><div class="ttname"><a href="a00202.html#a51a3b8c19b86e9e1df5be02b05a6613c">HyPar::op_file_format</a></div><div class="ttdeci">char op_file_format[_MAX_STRING_SIZE_]</div><div class="ttdef"><b>Definition:</b> <a href="a00238_source.html#l00186">hypar.h:186</a></div></div>
<div class="ttc" id="a00191_html_af2195885ad055989a1b2b11655843343"><div class="ttname"><a href="a00191.html#af2195885ad055989a1b2b11655843343">Interp1PrimFifthOrderWENO</a></div><div class="ttdeci">int Interp1PrimFifthOrderWENO(double *, double *, double *, double *, int, int, void *, void *, int)</div><div class="ttdoc">5th order WENO reconstruction (component-wise) on a uniform grid </div><div class="ttdef"><b>Definition:</b> <a href="a00344_source.html#l00074">Interp1PrimFifthOrderWENO.c:74</a></div></div>
<div class="ttc" id="a00206_html"><div class="ttname"><a href="a00206.html">MUSCLParameters</a></div><div class="ttdoc">Structure of variables/parameters needed by the MUSCL scheme. </div><div class="ttdef"><b>Definition:</b> <a href="a00191_source.html#l00175">interpolation.h:175</a></div></div>
<div class="ttc" id="a00202_html_a4b350316573a1d93caf01c5f1d43a45f"><div class="ttname"><a href="a00202.html#a4b350316573a1d93caf01c5f1d43a45f">HyPar::SecondDerivativePar</a></div><div class="ttdeci">int(* SecondDerivativePar)(double *, double *, int, void *, void *)</div><div class="ttdef"><b>Definition:</b> <a href="a00238_source.html#l00242">hypar.h:242</a></div></div>
<div class="ttc" id="a00231_html_ad6ab74942c9de13cf0b4c12eb0d91780"><div class="ttname"><a href="a00231.html#ad6ab74942c9de13cf0b4c12eb0d91780">IERR</a></div><div class="ttdeci">#define IERR</div><div class="ttdef"><b>Definition:</b> <a href="a00231_source.html#l00016">basic.h:16</a></div></div>
<div class="ttc" id="a00202_html_a5f89e286a9eaffdb66d966fa6a290d3f"><div class="ttname"><a href="a00202.html#a5f89e286a9eaffdb66d966fa6a290d3f">HyPar::output_mode</a></div><div class="ttdeci">char output_mode[_MAX_STRING_SIZE_]</div><div class="ttdef"><b>Definition:</b> <a href="a00238_source.html#l00183">hypar.h:183</a></div></div>
<div class="ttc" id="a00191_html_acfeff1b158131390b7129f4a857b15ff"><div class="ttname"><a href="a00191.html#acfeff1b158131390b7129f4a857b15ff">_FIFTH_ORDER_WENO_</a></div><div class="ttdeci">#define _FIFTH_ORDER_WENO_</div><div class="ttdef"><b>Definition:</b> <a href="a00191_source.html#l00026">interpolation.h:26</a></div></div>
<div class="ttc" id="a00191_html_a963c82116a2a1d6084af3d519b61b896"><div class="ttname"><a href="a00191.html#a963c82116a2a1d6084af3d519b61b896">Interp1PrimSecondOrderCentralChar</a></div><div class="ttdeci">int Interp1PrimSecondOrderCentralChar(double *, double *, double *, double *, int, int, void *, void *, int)</div><div class="ttdoc">2nd order central reconstruction (characteristic-based) on a uniform grid </div><div class="ttdef"><b>Definition:</b> <a href="a00352_source.html#l00079">Interp1PrimSecondOrderCentralChar.c:79</a></div></div>
<div class="ttc" id="a00191_html_aecbe557b2ccc254cdbbd312fc91717be"><div class="ttname"><a href="a00191.html#aecbe557b2ccc254cdbbd312fc91717be">WENOInitialize</a></div><div class="ttdeci">int WENOInitialize(void *, void *, char *, char *)</div><div class="ttdef"><b>Definition:</b> <a href="a00363_source.html#l00034">WENOInitialize.c:34</a></div></div>
<div class="ttc" id="a00218_html_a4afd2c7b3eb8fda452474ebdbe71c8c0"><div class="ttname"><a href="a00218.html#a4afd2c7b3eb8fda452474ebdbe71c8c0">SimulationObject::mpi</a></div><div class="ttdeci">MPIVariables mpi</div><div class="ttdef"><b>Definition:</b> <a href="a00218_source.html#l00025">simulation_object.h:25</a></div></div>
<div class="ttc" id="a00191_html_a21f7f383e497570fcb71c43f243539d3"><div class="ttname"><a href="a00191.html#a21f7f383e497570fcb71c43f243539d3">_THIRD_ORDER_MUSCL_</a></div><div class="ttdeci">#define _THIRD_ORDER_MUSCL_</div><div class="ttdef"><b>Definition:</b> <a href="a00191_source.html#l00018">interpolation.h:18</a></div></div>
<div class="ttc" id="a00265_html_a5fe3d9828c6afcbc00cf6fdd940ebe4b"><div class="ttname"><a href="a00265.html#a5fe3d9828c6afcbc00cf6fdd940ebe4b">TimeForwardEuler</a></div><div class="ttdeci">int TimeForwardEuler(void *)</div><div class="ttdef"><b>Definition:</b> <a href="a00627_source.html#l00025">TimeForwardEuler.c:25</a></div></div>
<div class="ttc" id="a00191_html_ae7eb6a81a164ca0fa2ace3cab2697847"><div class="ttname"><a href="a00191.html#ae7eb6a81a164ca0fa2ace3cab2697847">Interp1PrimThirdOrderMUSCL</a></div><div class="ttdeci">int Interp1PrimThirdOrderMUSCL(double *, double *, double *, double *, int, int, void *, void *, int)</div><div class="ttdoc">3rd order MUSCL scheme with Koren&amp;#39;s limiter (component-wise) on a uniform grid </div><div class="ttdef"><b>Definition:</b> <a href="a00355_source.html#l00075">Interp1PrimThirdOrderMUSCL.c:75</a></div></div>
<div class="ttc" id="a00191_html_ae832e2314ee85139cec9df4ea82aafa2"><div class="ttname"><a href="a00191.html#ae832e2314ee85139cec9df4ea82aafa2">_FIFTH_ORDER_COMPACT_UPWIND_</a></div><div class="ttdeci">#define _FIFTH_ORDER_COMPACT_UPWIND_</div><div class="ttdef"><b>Definition:</b> <a href="a00191_source.html#l00024">interpolation.h:24</a></div></div>
<div class="ttc" id="a00237_html_a89694dcc7c48314c98b9636759bb8bee"><div class="ttname"><a href="a00237.html#a89694dcc7c48314c98b9636759bb8bee">_SECOND_ORDER_CENTRAL_</a></div><div class="ttdeci">#define _SECOND_ORDER_CENTRAL_</div><div class="ttdef"><b>Definition:</b> <a href="a00237_source.html#l00012">firstderivative.h:12</a></div></div>
<div class="ttc" id="a00191_html_aa59d0f26584fa405034c2eac2e338c94"><div class="ttname"><a href="a00191.html#aa59d0f26584fa405034c2eac2e338c94">Interp1PrimFourthOrderCentralChar</a></div><div class="ttdeci">int Interp1PrimFourthOrderCentralChar(double *, double *, double *, double *, int, int, void *, void *, int)</div><div class="ttdoc">4th order central reconstruction (characteristic-based) on a uniform grid </div><div class="ttdef"><b>Definition:</b> <a href="a00350_source.html#l00079">Interp1PrimFourthOrderCentralChar.c:79</a></div></div>
<div class="ttc" id="a00202_html_a479abc98a0ca73359a33089ba5d37863"><div class="ttname"><a href="a00202.html#a479abc98a0ca73359a33089ba5d37863">HyPar::BoundaryIntegralFunction</a></div><div class="ttdeci">int(* BoundaryIntegralFunction)(void *, void *)</div><div class="ttdef"><b>Definition:</b> <a href="a00238_source.html#l00385">hypar.h:385</a></div></div>
<div class="ttc" id="a00202_html_ad195de8c64c407718e42cda9246be0d2"><div class="ttname"><a href="a00202.html#ad195de8c64c407718e42cda9246be0d2">HyPar::use_petscTS</a></div><div class="ttdeci">int use_petscTS</div><div class="ttdef"><b>Definition:</b> <a href="a00238_source.html#l00390">hypar.h:390</a></div></div>
<div class="ttc" id="a00231_html_add9cf96ae374934d245a1dc1ab697a42"><div class="ttname"><a href="a00231.html#add9cf96ae374934d245a1dc1ab697a42">CHECKERR</a></div><div class="ttdeci">#define CHECKERR(ierr)</div><div class="ttdef"><b>Definition:</b> <a href="a00231_source.html#l00018">basic.h:18</a></div></div>
<div class="ttc" id="a00191_html_a28b8d3ce17676cec19de4f91f989042d"><div class="ttname"><a href="a00191.html#a28b8d3ce17676cec19de4f91f989042d">Interp1PrimFifthOrderCompactUpwindChar</a></div><div class="ttdeci">int Interp1PrimFifthOrderCompactUpwindChar(double *, double *, double *, double *, int, int, void *, void *, int)</div><div class="ttdoc">5th order compact upwind reconstruction (characteristic-based) on a uniform grid </div><div class="ttdef"><b>Definition:</b> <a href="a00337_source.html#l00090">Interp1PrimFifthOrderCompactUpwindChar.c:90</a></div></div>
<div class="ttc" id="a00202_html_a1d36fea92472416e32e039b86dea0b18"><div class="ttname"><a href="a00202.html#a1d36fea92472416e32e039b86dea0b18">HyPar::time_integrator</a></div><div class="ttdeci">void * time_integrator</div><div class="ttdef"><b>Definition:</b> <a href="a00238_source.html#l00165">hypar.h:165</a></div></div>
<div class="ttc" id="a00191_html_aea7c973ffe0c37bca0703c1bf6175aaa"><div class="ttname"><a href="a00191.html#aea7c973ffe0c37bca0703c1bf6175aaa">Interp1PrimFifthOrderUpwind</a></div><div class="ttdeci">int Interp1PrimFifthOrderUpwind(double *, double *, double *, double *, int, int, void *, void *, int)</div><div class="ttdoc">5th order upwind reconstruction (component-wise) on a uniform grid </div><div class="ttdef"><b>Definition:</b> <a href="a00342_source.html#l00068">Interp1PrimFifthOrderUpwind.c:68</a></div></div>
<div class="ttc" id="a00191_html_a7bc4a755992e5f68efe365591b7a2c02"><div class="ttname"><a href="a00191.html#a7bc4a755992e5f68efe365591b7a2c02">_FIFTH_ORDER_UPWIND_</a></div><div class="ttdeci">#define _FIFTH_ORDER_UPWIND_</div><div class="ttdef"><b>Definition:</b> <a href="a00191_source.html#l00022">interpolation.h:22</a></div></div>
<div class="ttc" id="a00191_html_ae8bfe856abd743f5af925dc03e708ee3"><div class="ttname"><a href="a00191.html#ae8bfe856abd743f5af925dc03e708ee3">Interp2PrimSecondOrder</a></div><div class="ttdeci">int Interp2PrimSecondOrder(double *, double *, int, void *, void *)</div><div class="ttdoc">2nd order component-wise interpolation of the 2nd primitive on a uniform grid </div><div class="ttdef"><b>Definition:</b> <a href="a00357_source.html#l00056">Interp2PrimSecondOrder.c:56</a></div></div>
<div class="ttc" id="a00202_html_ad29846eeb9c83b329a8d7c1fe69d46b2"><div class="ttname"><a href="a00202.html#ad29846eeb9c83b329a8d7c1fe69d46b2">HyPar::spatial_scheme_hyp</a></div><div class="ttdeci">char spatial_scheme_hyp[_MAX_STRING_SIZE_]</div><div class="ttdef"><b>Definition:</b> <a href="a00238_source.html#l00084">hypar.h:84</a></div></div>
<div class="ttc" id="a00191_html_a32a14b9aa17be670a383e3d539da2afa"><div class="ttname"><a href="a00191.html#a32a14b9aa17be670a383e3d539da2afa">_SECOND_ORDER_MUSCL_</a></div><div class="ttdeci">#define _SECOND_ORDER_MUSCL_</div><div class="ttdef"><b>Definition:</b> <a href="a00191_source.html#l00016">interpolation.h:16</a></div></div>
<div class="ttc" id="a00202_html_a5d741833915983fdcb695f262a73ae7e"><div class="ttname"><a href="a00202.html#a5d741833915983fdcb695f262a73ae7e">HyPar::aux_op_fname_root</a></div><div class="ttdeci">char aux_op_fname_root[_MAX_STRING_SIZE_]</div><div class="ttdef"><b>Definition:</b> <a href="a00238_source.html#l00203">hypar.h:203</a></div></div>
<div class="ttc" id="a00197_html_a00652"><div class="ttname"><a href="a00197.html#a00652">ExplicitRKParameters</a></div><div class="ttdoc">Structure containing the parameters for an explicit Runge-Kutta method. </div><div class="ttdef"><b>Definition:</b> <a href="a00197_source.html#l00177">timeintegration_struct.h:177</a></div></div>
<div class="ttc" id="a00197_html_a00659"><div class="ttname"><a href="a00197.html#a00659">GLMGEEParameters</a></div><div class="ttdoc">Structure containing the parameters for the General Linear Methods with Global Error Estimators (GLM-...</div><div class="ttdef"><b>Definition:</b> <a href="a00197_source.html#l00267">timeintegration_struct.h:267</a></div></div>
<div class="ttc" id="a00202_html_ae8f6d2fd6490d3153cb4133bf183a404"><div class="ttname"><a href="a00202.html#ae8f6d2fd6490d3153cb4133bf183a404">HyPar::nvars</a></div><div class="ttdeci">int nvars</div><div class="ttdef"><b>Definition:</b> <a href="a00238_source.html#l00029">hypar.h:29</a></div></div>
<div class="ttc" id="a00237_html_aac4d00dd8bef7592948a7e563021c02a"><div class="ttname"><a href="a00237.html#aac4d00dd8bef7592948a7e563021c02a">_FOURTH_ORDER_CENTRAL_</a></div><div class="ttdeci">#define _FOURTH_ORDER_CENTRAL_</div><div class="ttdef"><b>Definition:</b> <a href="a00237_source.html#l00014">firstderivative.h:14</a></div></div>
<div class="ttc" id="a00202_html_a138e751362d14724df8e6ab27c4a5e55"><div class="ttname"><a href="a00202.html#a138e751362d14724df8e6ab27c4a5e55">HyPar::time_scheme</a></div><div class="ttdeci">char time_scheme[_MAX_STRING_SIZE_]</div><div class="ttdef"><b>Definition:</b> <a href="a00238_source.html#l00078">hypar.h:78</a></div></div>
<div class="ttc" id="a00191_html_a33b1e24c12129941b0027a83c543a654"><div class="ttname"><a href="a00191.html#a33b1e24c12129941b0027a83c543a654">Interp1PrimFifthOrderCRWENO</a></div><div class="ttdeci">int Interp1PrimFifthOrderCRWENO(double *, double *, double *, double *, int, int, void *, void *, int)</div><div class="ttdoc">5th order CRWENO reconstruction (component-wise) on a uniform grid </div><div class="ttdef"><b>Definition:</b> <a href="a00338_source.html#l00078">Interp1PrimFifthOrderCRWENO.c:78</a></div></div>
<div class="ttc" id="a00205_html_a00663"><div class="ttname"><a href="a00205.html#a00663">MPIVariables</a></div><div class="ttdoc">Structure of MPI-related variables. </div><div class="ttdef"><b>Definition:</b> <a href="a00205_source.html#l00024">mpivars_struct.h:24</a></div></div>
<div class="ttc" id="a00259_html_a36b168a9f6846e2b4bc027989c8f3e65"><div class="ttname"><a href="a00259.html#a36b168a9f6846e2b4bc027989c8f3e65">SecondDerivativeSecondOrderCentral</a></div><div class="ttdeci">int SecondDerivativeSecondOrderCentral(double *, double *, int, void *, void *)</div><div class="ttdef"><b>Definition:</b> <a href="a00589_source.html#l00034">SecondDerivativeSecondOrder.c:34</a></div></div>
<div class="ttc" id="a00312_html_a9fda82ed752188f3af821e2c30f63c21"><div class="ttname"><a href="a00312.html#a9fda82ed752188f3af821e2c30f63c21">IncrementFilenameIndex</a></div><div class="ttdeci">void IncrementFilenameIndex(char *f, int len)</div><div class="ttdef"><b>Definition:</b> <a href="a00312_source.html#l00046">IncrementFilename.c:46</a></div></div>
<div class="ttc" id="a00320_html_a74a4527b7a6060acc1808d9c945b117f"><div class="ttname"><a href="a00320.html#a74a4527b7a6060acc1808d9c945b117f">VolumeIntegral</a></div><div class="ttdeci">int VolumeIntegral(double *VolumeIntegral, double *u, void *s, void *m)</div><div class="ttdef"><b>Definition:</b> <a href="a00320_source.html#l00014">VolumeIntegral.c:14</a></div></div>
<div class="ttc" id="a00202_html_a0fda913c8c0424880302e9296cc0e813"><div class="ttname"><a href="a00202.html#a0fda913c8c0424880302e9296cc0e813">HyPar::VolumeIntegralFunction</a></div><div class="ttdeci">int(* VolumeIntegralFunction)(double *, double *, void *, void *)</div><div class="ttdef"><b>Definition:</b> <a href="a00238_source.html#l00383">hypar.h:383</a></div></div>
<div class="ttc" id="a00265_html_a966855c31cad0395c350b9a77add7ab8"><div class="ttname"><a href="a00265.html#a966855c31cad0395c350b9a77add7ab8">TimeExplicitRKInitialize</a></div><div class="ttdeci">int TimeExplicitRKInitialize(char *, char *, void *, void *)</div><div class="ttdef"><b>Definition:</b> <a href="a00626_source.html#l00017">TimeExplicitRKInitialize.c:17</a></div></div>
<div class="ttc" id="a00302_html_ab68722a270954b6816a785ad4923ba45"><div class="ttname"><a href="a00302.html#ab68722a270954b6816a785ad4923ba45">ApplyBoundaryConditions</a></div><div class="ttdeci">int ApplyBoundaryConditions(void *s, void *m, double *x, double *xref, double waqt)</div><div class="ttdoc">Applies the boundary conditions specified for each boundary zone. </div><div class="ttdef"><b>Definition:</b> <a href="a00302_source.html#l00028">ApplyBoundaryConditions.c:28</a></div></div>
<div class="ttc" id="a00239_html_a5bdb048ecc5ae7ab61622e4764f3133e"><div class="ttname"><a href="a00239.html#a5bdb048ecc5ae7ab61622e4764f3133e">WriteTecplot3D</a></div><div class="ttdeci">int WriteTecplot3D(int, int, int *, double *, double *, char *, int *)</div><div class="ttdef"><b>Definition:</b> <a href="a00369_source.html#l00019">WriteTecplot3D.c:19</a></div></div>
<div class="ttc" id="a00237_html_a343e390144d16452cc790099e69e6c47"><div class="ttname"><a href="a00237.html#a343e390144d16452cc790099e69e6c47">gpuFirstDerivativeFourthOrderCentral</a></div><div class="ttdeci">int gpuFirstDerivativeFourthOrderCentral(double *, double *, int, int, void *, void *)</div><div class="ttdef"><b>Definition:</b> <a href="a00300_source.html#l00351">FirstDerivativeFourthOrder_GPU.cu:351</a></div></div>
<div class="ttc" id="a00202_html_a4e93cb107e180ef982b74cef7726b70f"><div class="ttname"><a href="a00202.html#a4e93cb107e180ef982b74cef7726b70f">HyPar::op_overwrite</a></div><div class="ttdeci">char op_overwrite[_MAX_STRING_SIZE_]</div><div class="ttdef"><b>Definition:</b> <a href="a00238_source.html#l00191">hypar.h:191</a></div></div>
<div class="ttc" id="a00238_html_a7bc6f9c42df5610bc5d844ad95c74fb8"><div class="ttname"><a href="a00238.html#a7bc6f9c42df5610bc5d844ad95c74fb8">_NC_1_5STAGE_</a></div><div class="ttdeci">#define _NC_1_5STAGE_</div><div class="ttdef"><b>Definition:</b> <a href="a00238_source.html#l00471">hypar.h:471</a></div></div>
<div class="ttc" id="a00202_html_aa245f8c9e6af37e47c5867dccbbc208b"><div class="ttname"><a href="a00202.html#aa245f8c9e6af37e47c5867dccbbc208b">HyPar::HyperbolicFunction</a></div><div class="ttdeci">int(* HyperbolicFunction)(double *, double *, void *, void *, double, int, int(*)(double *, double *, int, void *, double), int(*)(double *, double *, double *, double *, double *, double *, int, void *, double))</div><div class="ttdef"><b>Definition:</b> <a href="a00238_source.html#l00245">hypar.h:245</a></div></div>
<div class="ttc" id="a00191_html_ac1f614645aa891fde12c0ce4354de45d"><div class="ttname"><a href="a00191.html#ac1f614645aa891fde12c0ce4354de45d">_COMPONENTS_</a></div><div class="ttdeci">#define _COMPONENTS_</div><div class="ttdef"><b>Definition:</b> <a href="a00191_source.html#l00034">interpolation.h:34</a></div></div>
<div class="ttc" id="a00202_html_a13a0f9420009a55a3689f407a2c8efea"><div class="ttname"><a href="a00202.html#a13a0f9420009a55a3689f407a2c8efea">HyPar::InterpolateInterfacesPar</a></div><div class="ttdeci">int(* InterpolateInterfacesPar)(double *, double *, int, void *, void *)</div><div class="ttdef"><b>Definition:</b> <a href="a00238_source.html#l00234">hypar.h:234</a></div></div>
<div class="ttc" id="a00313_html_af2e57e55724c44c535903d432a9d6193"><div class="ttname"><a href="a00313.html#af2e57e55724c44c535903d432a9d6193">NonLinearInterpolation</a></div><div class="ttdeci">int NonLinearInterpolation(double *u, void *s, void *m, double t, int(*FluxFunction)(double *, double *, int, void *, double))</div><div class="ttdef"><b>Definition:</b> <a href="a00313_source.html#l00028">NonLinearInterpolation.c:28</a></div></div>
<div class="ttc" id="a00202_html_a83d97dfc50e6bfefd0db6503d365d5bd"><div class="ttname"><a href="a00202.html#a83d97dfc50e6bfefd0db6503d365d5bd">HyPar::ApplyIBConditions</a></div><div class="ttdeci">int(* ApplyIBConditions)(void *, void *, double *, double)</div><div class="ttdef"><b>Definition:</b> <a href="a00238_source.html#l00212">hypar.h:212</a></div></div>
<div class="ttc" id="a00202_html_a17e1cfc7de4fe33c6ee88f2cc42883e7"><div class="ttname"><a href="a00202.html#a17e1cfc7de4fe33c6ee88f2cc42883e7">HyPar::InterpolateInterfacesHyp</a></div><div class="ttdeci">int(* InterpolateInterfacesHyp)(double *, double *, double *, double *, int, int, void *, void *, int)</div><div class="ttdef"><b>Definition:</b> <a href="a00238_source.html#l00219">hypar.h:219</a></div></div>
<div class="ttc" id="a00191_html_af255a582e14c5820cf12f9f95b4e28fd"><div class="ttname"><a href="a00191.html#af255a582e14c5820cf12f9f95b4e28fd">CompactSchemeInitialize</a></div><div class="ttdeci">int CompactSchemeInitialize(void *, void *, char *)</div><div class="ttdef"><b>Definition:</b> <a href="a00335_source.html#l00017">CompactSchemeInitialize.c:17</a></div></div>
<div class="ttc" id="a00222_html_a52d21dfe1d76916811879bf0d7a29d72"><div class="ttname"><a href="a00222.html#a52d21dfe1d76916811879bf0d7a29d72">tridiagLUInit</a></div><div class="ttdeci">int tridiagLUInit(void *, void *)</div><div class="ttdef"><b>Definition:</b> <a href="a00644_source.html#l00039">tridiagLUInit.c:39</a></div></div>
<div class="ttc" id="a00319_html_a930d3b66826111c93dc222f5f6382744"><div class="ttname"><a href="a00319.html#a930d3b66826111c93dc222f5f6382744">SourceFunction</a></div><div class="ttdeci">int SourceFunction(double *source, double *u, void *s, void *m, double t)</div><div class="ttdef"><b>Definition:</b> <a href="a00319_source.html#l00022">SourceFunction.c:22</a></div></div>
<div class="ttc" id="a00202_html_a9591ba0fadb863561474e2ba251d2594"><div class="ttname"><a href="a00202.html#a9591ba0fadb863561474e2ba251d2594">HyPar::interp_type</a></div><div class="ttdeci">char interp_type[_MAX_STRING_SIZE_]</div><div class="ttdef"><b>Definition:</b> <a href="a00238_source.html#l00088">hypar.h:88</a></div></div>
<div class="ttc" id="a00202_html_af474ca4577de91b658e4399ad0a6d7b3"><div class="ttname"><a href="a00202.html#af474ca4577de91b658e4399ad0a6d7b3">HyPar::index_length</a></div><div class="ttdeci">int index_length</div><div class="ttdef"><b>Definition:</b> <a href="a00238_source.html#l00196">hypar.h:196</a></div></div>
<div class="ttc" id="a00265_html_a7b76988ab950d39d505042dc1f09b875"><div class="ttname"><a href="a00265.html#a7b76988ab950d39d505042dc1f09b875">TimeGLMGEE</a></div><div class="ttdeci">int TimeGLMGEE(void *)</div><div class="ttdef"><b>Definition:</b> <a href="a00629_source.html#l00045">TimeGLMGEE.c:45</a></div></div>
<div class="ttc" id="a00202_html_a75e8be4ea8c1ae2e99fc1e802e69a573"><div class="ttname"><a href="a00202.html#a75e8be4ea8c1ae2e99fc1e802e69a573">HyPar::ParabolicFunction</a></div><div class="ttdeci">int(* ParabolicFunction)(double *, double *, void *, void *, double)</div><div class="ttdef"><b>Definition:</b> <a href="a00238_source.html#l00251">hypar.h:251</a></div></div>
<div class="ttc" id="a00239_html_a265b0583afb79edd2f2f5d5087e5c3bf"><div class="ttname"><a href="a00239.html#a265b0583afb79edd2f2f5d5087e5c3bf">WriteTecplot2D</a></div><div class="ttdeci">int WriteTecplot2D(int, int, int *, double *, double *, char *, int *)</div><div class="ttdef"><b>Definition:</b> <a href="a00368_source.html#l00019">WriteTecplot2D.c:19</a></div></div>
<div class="ttc" id="a00202_html_a29c46b81ad574e4dfbad5a7211487dcb"><div class="ttname"><a href="a00202.html#a29c46b81ad574e4dfbad5a7211487dcb">HyPar::interp</a></div><div class="ttdeci">void * interp</div><div class="ttdef"><b>Definition:</b> <a href="a00238_source.html#l00357">hypar.h:357</a></div></div>
<div class="ttc" id="a00191_html_abf3b032fdc8c0e84b86909db9e0b93c3"><div class="ttname"><a href="a00191.html#abf3b032fdc8c0e84b86909db9e0b93c3">Interp1PrimFifthOrderWENOChar</a></div><div class="ttdeci">int Interp1PrimFifthOrderWENOChar(double *, double *, double *, double *, int, int, void *, void *, int)</div><div class="ttdoc">5th order WENO reconstruction (characteristic-based) on a uniform grid </div><div class="ttdef"><b>Definition:</b> <a href="a00346_source.html#l00086">Interp1PrimFifthOrderWENOChar.c:86</a></div></div>
<div class="ttc" id="a00202_html_a0805db42e429173752189696c3c96909"><div class="ttname"><a href="a00202.html#a0805db42e429173752189696c3c96909">HyPar::filename_index</a></div><div class="ttdeci">char * filename_index</div><div class="ttdef"><b>Definition:</b> <a href="a00238_source.html#l00194">hypar.h:194</a></div></div>
<div class="ttc" id="a00191_html_a6d34f5e8aae80a0d2a27ea20368dfef1"><div class="ttname"><a href="a00191.html#a6d34f5e8aae80a0d2a27ea20368dfef1">_FIFTH_ORDER_HCWENO_</a></div><div class="ttdeci">#define _FIFTH_ORDER_HCWENO_</div><div class="ttdef"><b>Definition:</b> <a href="a00191_source.html#l00030">interpolation.h:30</a></div></div>
<div class="ttc" id="a00191_html_a985d08c4fb9bcb71875c697f9e00d6eb"><div class="ttname"><a href="a00191.html#a985d08c4fb9bcb71875c697f9e00d6eb">Interp1PrimThirdOrderMUSCLChar</a></div><div class="ttdeci">int Interp1PrimThirdOrderMUSCLChar(double *, double *, double *, double *, int, int, void *, void *, int)</div><div class="ttdoc">3rd order MUSCL scheme with Koren&amp;#39;s limiter (characteristic-based) on a uniform grid ...</div><div class="ttdef"><b>Definition:</b> <a href="a00356_source.html#l00091">Interp1PrimThirdOrderMUSCLChar.c:91</a></div></div>
<div class="ttc" id="a00202_html_a1dbfa1e479a373073b6ebf72401a7f0f"><div class="ttname"><a href="a00202.html#a1dbfa1e479a373073b6ebf72401a7f0f">HyPar::lusolver</a></div><div class="ttdeci">void * lusolver</div><div class="ttdef"><b>Definition:</b> <a href="a00238_source.html#l00363">hypar.h:363</a></div></div>
<div class="ttc" id="a00202_html_aafb41b96563d9966e8e9f458751f2960"><div class="ttname"><a href="a00202.html#aafb41b96563d9966e8e9f458751f2960">HyPar::restart_iter</a></div><div class="ttdeci">int restart_iter</div><div class="ttdef"><b>Definition:</b> <a href="a00238_source.html#l00058">hypar.h:58</a></div></div>
<div class="ttc" id="a00202_html_afeeb150a9699ade5eccc7589fcae3fe0"><div class="ttname"><a href="a00202.html#afeeb150a9699ade5eccc7589fcae3fe0">HyPar::SetInterpLimiterVar</a></div><div class="ttdeci">int(* SetInterpLimiterVar)(double *, double *, double *, int, void *, void *)</div><div class="ttdef"><b>Definition:</b> <a href="a00238_source.html#l00229">hypar.h:229</a></div></div>
<div class="ttc" id="a00205_html_adad7a6f85831f3ac84d854b6c80aef43"><div class="ttname"><a href="a00205.html#adad7a6f85831f3ac84d854b6c80aef43">MPIVariables::world</a></div><div class="ttdeci">MPI_Comm world</div><div class="ttdef"><b>Definition:</b> <a href="a00205_source.html#l00037">mpivars_struct.h:37</a></div></div>
<div class="ttc" id="a00191_html_a91fbe118c8c01fe1d5efa3cea4930589"><div class="ttname"><a href="a00191.html#a91fbe118c8c01fe1d5efa3cea4930589">Interp1PrimFifthOrderHCWENOChar</a></div><div class="ttdeci">int Interp1PrimFifthOrderHCWENOChar(double *, double *, double *, double *, int, int, void *, void *, int)</div><div class="ttdoc">5th order hybrid compact-WENO reconstruction (characteristic-based) on a uniform grid ...</div><div class="ttdef"><b>Definition:</b> <a href="a00341_source.html#l00079">Interp1PrimFifthOrderHCWENOChar.c:79</a></div></div>
<div class="ttc" id="a00202_html_aa4de7bdc1e62417caf51b9c45184268d"><div class="ttname"><a href="a00202.html#aa4de7bdc1e62417caf51b9c45184268d">HyPar::ApplyBoundaryConditions</a></div><div class="ttdeci">int(* ApplyBoundaryConditions)(void *, void *, double *, double *, double)</div><div class="ttdef"><b>Definition:</b> <a href="a00238_source.html#l00209">hypar.h:209</a></div></div>
<div class="ttc" id="a00202_html_a7de550a63022232e0039dc46a08114b0"><div class="ttname"><a href="a00202.html#a7de550a63022232e0039dc46a08114b0">HyPar::TimeIntegrate</a></div><div class="ttdeci">int(* TimeIntegrate)(void *)</div><div class="ttdef"><b>Definition:</b> <a href="a00238_source.html#l00215">hypar.h:215</a></div></div>
<div class="ttc" id="a00202_html_a2108550c80e1666f11c684fcb4f1ca89"><div class="ttname"><a href="a00202.html#a2108550c80e1666f11c684fcb4f1ca89">HyPar::CalculateConservationError</a></div><div class="ttdeci">int(* CalculateConservationError)(void *, void *)</div><div class="ttdef"><b>Definition:</b> <a href="a00238_source.html#l00387">hypar.h:387</a></div></div>
<div class="ttc" id="a00202_html_adec095311615891040de11341c01a77f"><div class="ttname"><a href="a00202.html#adec095311615891040de11341c01a77f">HyPar::msti</a></div><div class="ttdeci">void * msti</div><div class="ttdef"><b>Definition:</b> <a href="a00238_source.html#l00361">hypar.h:361</a></div></div>
<div class="ttc" id="a00238_html_aabd653aa5d489ae2d0d8140290f6f026"><div class="ttname"><a href="a00238.html#aabd653aa5d489ae2d0d8140290f6f026">_CONS_1STAGE_</a></div><div class="ttdeci">#define _CONS_1STAGE_</div><div class="ttdef"><b>Definition:</b> <a href="a00238_source.html#l00473">hypar.h:473</a></div></div>
<div class="ttc" id="a00311_html_a1e78fb9da89089d6cc5837ab14916e7f"><div class="ttname"><a href="a00311.html#a1e78fb9da89089d6cc5837ab14916e7f">gpuHyperbolicFunction</a></div><div class="ttdeci">int gpuHyperbolicFunction(double *hyp, double *u, void *s, void *m, double t, int LimFlag, int(*FluxFunction)(double *, double *, int, void *, double), int(*UpwindFunction)(double *, double *, double *, double *, double *, double *, int, void *, double))</div><div class="ttdef"><b>Definition:</b> <a href="a00311_source.html#l00473">HyperbolicFunction_GPU.cu:473</a></div></div>
<div class="ttc" id="a00317_html_a153eb91ec9b118a7b8c971facbc8d920"><div class="ttname"><a href="a00317.html#a153eb91ec9b118a7b8c971facbc8d920">ParabolicFunctionNC2Stage</a></div><div class="ttdeci">int ParabolicFunctionNC2Stage(double *par, double *u, void *s, void *m, double t)</div><div class="ttdef"><b>Definition:</b> <a href="a00317_source.html#l00040">ParabolicFunctionNC2Stage.c:40</a></div></div>
<div class="ttc" id="a00265_html_aca6ebec6e6998f0c509bb38fa91f3321"><div class="ttname"><a href="a00265.html#aca6ebec6e6998f0c509bb38fa91f3321">TimeRK</a></div><div class="ttdeci">int TimeRK(void *)</div><div class="ttdef"><b>Definition:</b> <a href="a00637_source.html#l00035">TimeRK.c:35</a></div></div>
<div class="ttc" id="a00191_html_ae2b27971cc952cf3b4959128bef6174b"><div class="ttname"><a href="a00191.html#ae2b27971cc952cf3b4959128bef6174b">Interp1PrimFifthOrderCRWENOChar</a></div><div class="ttdeci">int Interp1PrimFifthOrderCRWENOChar(double *, double *, double *, double *, int, int, void *, void *, int)</div><div class="ttdoc">5th order CRWENO reconstruction (characteristic-based) on a uniform grid </div><div class="ttdef"><b>Definition:</b> <a href="a00339_source.html#l00093">Interp1PrimFifthOrderCRWENOChar.c:93</a></div></div>
<div class="ttc" id="a00191_html_a175a82b8ae2b24c0ba51e1b1dd68c0e5"><div class="ttname"><a href="a00191.html#a175a82b8ae2b24c0ba51e1b1dd68c0e5">_FIFTH_ORDER_CRWENO_</a></div><div class="ttdeci">#define _FIFTH_ORDER_CRWENO_</div><div class="ttdef"><b>Definition:</b> <a href="a00191_source.html#l00028">interpolation.h:28</a></div></div>
<div class="ttc" id="a00202_html"><div class="ttname"><a href="a00202.html">HyPar</a></div><div class="ttdoc">Structure containing all solver-specific variables and functions. </div><div class="ttdef"><b>Definition:</b> <a href="a00238_source.html#l00023">hypar.h:23</a></div></div>
<div class="ttc" id="a00259_html_a7fa2be45147cb91831760e66b631e15c"><div class="ttname"><a href="a00259.html#a7fa2be45147cb91831760e66b631e15c">SecondDerivativeFourthOrderCentral</a></div><div class="ttdeci">int SecondDerivativeFourthOrderCentral(double *, double *, int, void *, void *)</div><div class="ttdef"><b>Definition:</b> <a href="a00588_source.html#l00034">SecondDerivativeFourthOrder.c:34</a></div></div>
<div class="ttc" id="a00202_html_a2f63f9a875bb76e6107cb2e7c725d935"><div class="ttname"><a href="a00202.html#a2f63f9a875bb76e6107cb2e7c725d935">HyPar::op_fname_root</a></div><div class="ttdeci">char op_fname_root[_MAX_STRING_SIZE_]</div><div class="ttdef"><b>Definition:</b> <a href="a00238_source.html#l00201">hypar.h:201</a></div></div>
<div class="ttc" id="a00218_html_a523947ce4fa7128c4c767163953253b9"><div class="ttname"><a href="a00218.html#a523947ce4fa7128c4c767163953253b9">SimulationObject::solver</a></div><div class="ttdeci">HyPar solver</div><div class="ttdef"><b>Definition:</b> <a href="a00218_source.html#l00026">simulation_object.h:26</a></div></div>
<div class="ttc" id="a00202_html_a662e256e081a2b74f971d02c747892b8"><div class="ttname"><a href="a00202.html#a662e256e081a2b74f971d02c747892b8">HyPar::SourceFunction</a></div><div class="ttdeci">int(* SourceFunction)(double *, double *, void *, void *, double)</div><div class="ttdef"><b>Definition:</b> <a href="a00238_source.html#l00254">hypar.h:254</a></div></div>
<div class="ttc" id="a00191_html_a3ac2a77b9fa5a50499c285e49cf91344"><div class="ttname"><a href="a00191.html#a3ac2a77b9fa5a50499c285e49cf91344">Interp1PrimFifthOrderCompactUpwind</a></div><div class="ttdeci">int Interp1PrimFifthOrderCompactUpwind(double *, double *, double *, double *, int, int, void *, void *, int)</div><div class="ttdoc">5th order compact upwind reconstruction (component-wise) on a uniform grid </div><div class="ttdef"><b>Definition:</b> <a href="a00336_source.html#l00072">Interp1PrimFifthOrderCompactUpwind.c:72</a></div></div>
<div class="ttc" id="a00238_html_a9f4de86b900c9aa5f097c2746e17612a"><div class="ttname"><a href="a00238.html#a9f4de86b900c9aa5f097c2746e17612a">_NC_2STAGE_</a></div><div class="ttdeci">#define _NC_2STAGE_</div><div class="ttdef"><b>Definition:</b> <a href="a00238_source.html#l00467">hypar.h:467</a></div></div>
</div><!-- fragment -->
</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- Start of StatCounter Code for Default Guide -->
<script type="text/javascript">
var sc_project=10897352; 
var sc_invisible=1; 
var sc_security="83042f57"; 
var scJsHost = (("https:" == document.location.protocol) ?
"https://secure." : "http://www.");
document.write("<sc"+"ript type='text/javascript' src='" +
scJsHost+
"statcounter.com/counter/counter.js'></"+"script>");
</script>
<noscript><div class="statcounter"><a title="website
statistics" href="http://statcounter.com/"
target="_blank"><img class="statcounter"
src="//c.statcounter.com/10897352/0/83042f57/1/"
alt="website statistics"></a></div></noscript>
<!-- End of StatCounter Code for Default Guide -->
